<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/145080" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>Thank you for participating in our round ! We hope you enjoyed our problems. Feel free to discuss them in the comment section :)</p><p>/!\ The solution codes will be available in a few minutes</p><p>UPD: The solution codes have been added ! UPD2: The solution codes links are fixed ! Sorry for the inconvenience.</p><p><a href="https://codeforces.com/contest/2128/problem/A" title="Codeforces Round 1039 (Div. 2)">2128A - Recycling Center</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let's say a bag is expensive if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-msubsup" id="MJXp-Span-2"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">c</span></span></span><script type="math/tex" id="MathJax-Element-1">a_i > c</script> and free if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-msubsup" id="MJXp-Span-8"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-10" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">c</span></span></span><script type="math/tex" id="MathJax-Element-2">a_i \leq c</script>.</p><p>First, observe that as long as there is at least one free bag remaining, we should destroy a free bag. We will perform all expensive destructions at the end. The goal is to perform as much free destructions as possible.</p><p>When there are multiple free bags, which one to choose? The bigger a bag is, the less time you have to destroy it before it becomes expensive. Hence, at each second, you should destroy the biggest remaining free bag.</p><p>This process can be naively simulated in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mrow" id="MJXp-Span-14"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-15">O</span></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-19" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-3">\mathcal{O}(n^2)</script>, which was sufficient under given constraints. If you sort the array beforehand and keep the current multiplier in a separate variable (instead of multiplying all weights), it can be done in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mrow" id="MJXp-Span-22"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-23">O</span></span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">n</span><span class="MJXp-mi" id="MJXp-Span-26">log</span><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">n</span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-4">\mathcal{O}(n \log n)</script> time.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><p><a href="https://codeforces.com/contest/2128/submission/331199790" title="Submission 331199790 by bestial-42-centroids">331199790</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem</b><div class="spoiler-content" style="display: block;"><p>Amazing 
<style data-nocturne="true" type="text/css">

</style>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11024">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="295">295</span>
            </i>
        </a>
    </span>

    <script>
        $(function() {
            const likeFormUtil = {};
            likeFormUtil.getCount = function ($count) {
                return Number($count.attr("data-value"));
            };
            likeFormUtil.setCount = function ($count, value) {
                $count.attr("data-value", value);
                $count.text(value);
            };
            likeFormUtil.like = function ($likeForm) {
                $likeForm.find(".likeState").addClass("liked");
                const $likeCount = $likeForm.find(".likeCount");
                likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) + 1);
            };
            likeFormUtil.unLike = function ($likeForm) {
                if ($likeForm.find(".likeState").hasClass("liked")) {
                    $likeForm.find(".likeState").removeClass("liked");
                    const $likeCount = $likeForm.find(".likeCount");
                    likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) - 1);
                }
            };
            likeFormUtil.dislike = function ($likeForm) {
                $likeForm.find(".dislikeState").addClass("disliked");
                const $dislikeCount = $likeForm.find(".dislikeCount");
                likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) + 1);
            };
            likeFormUtil.unDislike = function ($likeForm) {
                if ($likeForm.find(".dislikeState").hasClass("disliked")) {
                    $likeForm.find(".dislikeState").removeClass("disliked");
                    const $dislikeCount = $likeForm.find(".dislikeCount");
                    likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) - 1);
                }
            };
            likeFormUtil.disable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", function () {
                    return false;
                });
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", function () {
                    return false;
                });
            };
            likeFormUtil.enable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", onLike);
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", onDislike);
            };
            likeFormUtil.applyLikeableInformation = function(likeableInformation) {
                const id = likeableInformation.likeable.id;
                console.log(id);
                const $likeForm = $(".likeActionLink[data-likeableId='" + id + "']").closest(".likeForm");
                console.log($likeForm);
                likeFormUtil.setCount($likeForm.find(".likeCount"), likeableInformation.likeCount);
                likeFormUtil.setCount($likeForm.find(".dislikeCount"), likeableInformation.dislikeCount);
                if (likeableInformation.liked) {
                    $likeForm.find(".likeState").addClass("liked");
                } else {
                    $likeForm.find(".likeState").removeClass("liked");
                }
                if (likeableInformation.disliked) {
                    $likeForm.find(".likeState").addClass("disliked");
                } else {
                    $likeForm.find(".likeState").removeClass("disliked");
                }
            }
            likeFormUtil.applyLikeableInformations = function(likeableInformations) {
                likeableInformations.forEach((applyLikeableInformation) => {
                    likeFormUtil.applyLikeableInformation(applyLikeableInformation);
                });
            }

            function onLike() {
                const $likeActionLink = $(this);
                const likeableId = $likeActionLink.attr("data-likeableId");
                const $likeForm = $likeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "like",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["liked"]) {
                            Codeforces.showMessage('Added to liked');
                        } else {
                            Codeforces.showMessage('Removed from liked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            function onDislike() {
                const $dislikeActionLink = $(this);
                const likeableId = $dislikeActionLink.attr("data-likeableId");
                const $likeForm = $dislikeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "dislike",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["disliked"]) {
                            Codeforces.showMessage('Added to disliked');
                        } else {
                            Codeforces.showMessage('Removed from disliked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            $(".likeActionLink").click(onLike);
            $(".dislikeActionLink").click(onDislike);

            $(".likeCount").add(".dislikeCount").each(function () {
                const $count = $(this);
                likeFormUtil.setCount($count, likeFormUtil.getCount($count));
            });
        });
    </script>

<script data-nocturne="true"> $(function () {
}); </script>

</p><p>Good 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11025">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="130">130</span>
            </i>
        </a>
    </span>


</p><p>Ok 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11026">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="60">60</span>
            </i>
        </a>
    </span>


</p><p>Bad 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11027">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="24">24</span>
            </i>
        </a>
    </span>


</p><p>Terrible 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11028">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="69">69</span>
            </i>
        </a>
    </span>


 </p></div></div><p><a href="https://codeforces.com/contest/2128/problem/B" title="Codeforces Round 1039 (Div. 2)">2128B - Deque Process</a></p> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><p>Instead of taking either the leftmost or rightmost element, think about taking either the minimum or maximum element.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><p>It's possible to ensure that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-30"><span class="MJXp-msubsup" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-33" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-37" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-39"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-41" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-45" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-5">q_1 < q_2 > q_3 < q_4 > q_5 \ldots</script></p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let's number turns from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-51"><span class="MJXp-mn" id="MJXp-Span-52">1</span></span></span><script type="math/tex" id="MathJax-Element-6">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-53"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">n</span></span></span><script type="math/tex" id="MathJax-Element-7">n</script>. On odd turns, we take the minimum element and on even turns, we take the maximum element. We claim that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-55"><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-58" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-60"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-62" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-66" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-70" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-72"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-74" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-8">q_1 < q_2 > q_3 < q_4 > q_5 \ldots</script> (which is actually stronger than what the statement asked).</p><p><strong>Proof:</strong> consider taking the minimum on an odd turn : <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-82"><span class="MJXp-msubsup" id="MJXp-Span-83"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-85" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-91" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-93"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-95" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-9">q_i = \min(p_l, p_r)</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">l</span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">r</span></span></span><script type="math/tex" id="MathJax-Element-10">l, r</script> were the endpoints of the remaining array at turn <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">i</span></span></span><script type="math/tex" id="MathJax-Element-11">i</script>. Suppose without loss of generality the minimum was on the left, i.e. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-103"><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-106" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-110" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-114" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-12">q_i = p_l < p_r</script>. Then at the next turn, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-115"><span class="MJXp-msubsup" id="MJXp-Span-116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-118" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-13">p_r</script> is still available: </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-119"><span class="MJXp-msubsup" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-122" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">i</span><span class="MJXp-mo" id="MJXp-Span-124">+</span><span class="MJXp-mn" id="MJXp-Span-125">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-131" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">l</span><span class="MJXp-mo" id="MJXp-Span-133">+</span><span class="MJXp-mn" id="MJXp-Span-134">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-138" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-143" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-147" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-148" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-151" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-14">q_{i+1} = \max(p_{l+1}, p_r) \geq p_r > p_l = q_i</script></center><p>For example, if the remaining array at an odd turn is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-152"><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-154">5</span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0.111em; margin-right: 0.111em;">?</span><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-160">10</span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-15">[5, ?, \ldots, 10]</script>, we take the minimum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-162"><span class="MJXp-mn" id="MJXp-Span-163">5</span></span></span><script type="math/tex" id="MathJax-Element-16">5</script>, and then no matter what the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-164"><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0.111em; margin-right: 0.111em;">?</span></span></span><script type="math/tex" id="MathJax-Element-17">?</script> is, we take at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-166"><span class="MJXp-mn" id="MJXp-Span-167">10</span></span></span><script type="math/tex" id="MathJax-Element-18">10</script> which is greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-168"><span class="MJXp-mn" id="MJXp-Span-169">5</span></span></span><script type="math/tex" id="MathJax-Element-19">5</script>. This proves <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-msubsup" id="MJXp-Span-171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-173" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-177" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">i</span><span class="MJXp-mo" id="MJXp-Span-179">+</span><span class="MJXp-mn" id="MJXp-Span-180">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-20">q_i < q_{i+1}</script> when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">i</span></span></span><script type="math/tex" id="MathJax-Element-21">i</script> is odd. Similarly, we can prove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-183"><span class="MJXp-msubsup" id="MJXp-Span-184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-186" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-190" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">i</span><span class="MJXp-mo" id="MJXp-Span-192">+</span><span class="MJXp-mn" id="MJXp-Span-193">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-22">q_i > q_{i+1}</script> when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">i</span></span></span><script type="math/tex" id="MathJax-Element-23">i</script> is even.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><p><a href="https://codeforces.com/contest/2128/submission/331199677" title="Submission 331199677 by bestial-42-centroids">331199677</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem</b><div class="spoiler-content" style="display: block;"><p>Amazing 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11029">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="271">271</span>
            </i>
        </a>
    </span>


</p><p>Good 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11030">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="101">101</span>
            </i>
        </a>
    </span>


</p><p>Ok 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11031">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="57">57</span>
            </i>
        </a>
    </span>


</p><p>Bad 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11032">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="31">31</span>
            </i>
        </a>
    </span>


</p><p>Terrible 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11033">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="90">90</span>
            </i>
        </a>
    </span>


 </p></div></div><p><a href="https://codeforces.com/contest/2128/problem/C" title="Codeforces Round 1039 (Div. 2)">2128C - Leftmost Below</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>Try to come up with a sufficient condition first, then prove it's necessary. Doing some examples with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">n</span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-199">3</span></span></span><script type="math/tex" id="MathJax-Element-24">n = 3</script> might be useful.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-200"><span class="MJXp-msubsup" id="MJXp-Span-201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-203" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-209" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-215" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">i</span><span class="MJXp-mo" id="MJXp-Span-217">−</span><span class="MJXp-mn" id="MJXp-Span-218">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-25">m_i = \min(b_1, \ldots, b_{i-1})</script> for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-220"><span class="MJXp-mn" id="MJXp-Span-221">2</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">i</span><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">n</span></span></span><script type="math/tex" id="MathJax-Element-26">2 \leq i \leq n</script>, which can be computed in linear time. We claim we can achieve <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">a</span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">b</span></span></span><script type="math/tex" id="MathJax-Element-27">a = b</script> if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-msubsup" id="MJXp-Span-231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-233" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-237" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-241" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-28">b_i - m_i < m_i</script> for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-242"><span class="MJXp-mn" id="MJXp-Span-243">2</span><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">i</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">n</span></span></span><script type="math/tex" id="MathJax-Element-29">2 \leq i \leq n</script>.</p><p><strong>Proof that it's sufficient:</strong> we can build the array from left to right. For every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">i</span></span></span><script type="math/tex" id="MathJax-Element-30">i</script>, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-msubsup" id="MJXp-Span-251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-253" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-257" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-31">b_i < m_i</script> then we directly add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-258"><span class="MJXp-msubsup" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-261" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-32">b_i</script>. Otherwise, we first add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-262"><span class="MJXp-msubsup" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-265" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-269" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-33">b_i - m_i</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-270"><span class="MJXp-msubsup" id="MJXp-Span-271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-273" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-34">m_i</script>.</p><p><strong>Proof that it's necessary:</strong> suppose we managed to reach <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">b</span></span></span><script type="math/tex" id="MathJax-Element-35">b</script>. At every step, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-276"><span class="MJXp-msubsup" id="MJXp-Span-277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-279" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-283" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-36">a_i \leq b_i</script> for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">i</span></span></span><script type="math/tex" id="MathJax-Element-37">i</script>. Consider the last operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">x</span></span></span><script type="math/tex" id="MathJax-Element-38">x</script> that incremented <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-288"><span class="MJXp-msubsup" id="MJXp-Span-289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-291" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-39">a_i</script>. Then, by the definition of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">i</span></span></span><script type="math/tex" id="MathJax-Element-40">i</script>, we must have </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-294"><span class="MJXp-msubsup" id="MJXp-Span-295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-297" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">x</span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-302" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-305" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-311" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">i</span><span class="MJXp-mo" id="MJXp-Span-313">−</span><span class="MJXp-mn" id="MJXp-Span-314">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-321" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-327" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">i</span><span class="MJXp-mo" id="MJXp-Span-329">−</span><span class="MJXp-mn" id="MJXp-Span-330">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-41">a_i < x \leq \min(a_1, \ldots, a_{i-1}) \leq \min(b_1, \ldots, b_{i-1}).</script></center><p>Hence, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-333"><span class="MJXp-msubsup" id="MJXp-Span-334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-336" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-340" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">x</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-344">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">x</span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-347">1</span><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-349">2</span><span class="MJXp-msubsup" id="MJXp-Span-350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-352" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-354">1</span></span></span><script type="math/tex" id="MathJax-Element-42">b_i = a_i + x \leq 2x-1 \leq 2m_i - 1</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><p><a href="https://codeforces.com/contest/2128/submission/331199604" title="Submission 331199604 by bestial-42-centroids">331199604</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem</b><div class="spoiler-content" style="display: block;"><p>Amazing 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11055">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="295">295</span>
            </i>
        </a>
    </span>


</p><p>Good 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11034">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="97">97</span>
            </i>
        </a>
    </span>


</p><p>Ok 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11035">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="43">43</span>
            </i>
        </a>
    </span>


</p><p>Bad 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11036">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="21">21</span>
            </i>
        </a>
    </span>


</p><p>Terrible 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11037">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="78">78</span>
            </i>
        </a>
    </span>


 </p></div></div><p><a href="https://codeforces.com/contest/2128/problem/D" title="Codeforces Round 1039 (Div. 2)">2128D - Sum of LDS</a></p> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-355"><span class="MJXp-msubsup" id="MJXp-Span-356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-358" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-364" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-368" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">i</span><span class="MJXp-mo" id="MJXp-Span-370">+</span><span class="MJXp-mn" id="MJXp-Span-371">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-372" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-43">b_i = \max(a_i, a_{i+1})</script>, show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-373"><span class="MJXp-msubsup" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-376" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-380" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-381" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-386" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">n</span><span class="MJXp-mo" id="MJXp-Span-388">−</span><span class="MJXp-mn" id="MJXp-Span-389">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-44">b_1 \geq b_2 \geq \ldots \geq b_{n-1}</script>. </p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-390"><span class="MJXp-msubsup" id="MJXp-Span-391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-393" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-394" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-397" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">i</span><span class="MJXp-mo" id="MJXp-Span-399">+</span><span class="MJXp-mn" id="MJXp-Span-400">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-45">a_i < a_{i+1}</script>, show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-401"><span class="MJXp-msubsup" id="MJXp-Span-402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-404" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">i</span><span class="MJXp-mo" id="MJXp-Span-406">+</span><span class="MJXp-mn" id="MJXp-Span-407">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-413" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">i</span><span class="MJXp-mo" id="MJXp-Span-415">+</span><span class="MJXp-mn" id="MJXp-Span-416">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-420" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">i</span><span class="MJXp-mo" id="MJXp-Span-422">+</span><span class="MJXp-mn" id="MJXp-Span-423">3</span></span></span><span class="MJXp-mo" id="MJXp-Span-424" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-425" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-428" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-46">a_{i+1} > \max(a_{i+2}, a_{i+3}, \ldots a_{n})</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-431"><span class="MJXp-mrow" id="MJXp-Span-432"><span class="MJXp-msubsup" id="MJXp-Span-433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-435" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-438" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-441" style="vertical-align: -0.4em;">m</span></span></span></span></span><script type="math/tex" id="MathJax-Element-47">{i_1, \ldots, i_m}</script> be the set of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">i</span><span class="MJXp-mo" id="MJXp-Span-444" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-446">1</span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">n</span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-48">i \in [1, n]</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-450"><span class="MJXp-msubsup" id="MJXp-Span-451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-453" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-457" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">i</span><span class="MJXp-mo" id="MJXp-Span-459">+</span><span class="MJXp-mn" id="MJXp-Span-460">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-49">a_i > a_{i+1}</script>. Let us show that the sequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-461"><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-465" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-471" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-50">(i_1, \ldots, i_m)</script> is an LDS:</p> <ul>   <li>It is a decreasing subsequence: let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">k</span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-477">1</span><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">m</span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-481">1</span><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-51">k \in [1, m -1]</script>. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-483"><span class="MJXp-msubsup" id="MJXp-Span-484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485" style="margin-right: 0.05em;">i</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-486" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">k</span><span class="MJXp-mo" id="MJXp-Span-488">+</span><span class="MJXp-mn" id="MJXp-Span-489">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492" style="margin-right: 0.05em;">i</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-493" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-496">1</span></span></span><script type="math/tex" id="MathJax-Element-52">i_{k+1} = i_{k}+1</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-497"><span class="MJXp-msubsup" id="MJXp-Span-498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-500" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-503" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-504" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-507" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-508">(</span><span class="MJXp-msubsup" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-511" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-512">)</span><span class="MJXp-mo" id="MJXp-Span-513">+</span><span class="MJXp-mn" id="MJXp-Span-514">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-518" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520" style="margin-right: 0.05em;">i</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-521" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">k</span><span class="MJXp-mo" id="MJXp-Span-523">+</span><span class="MJXp-mn" id="MJXp-Span-524">1</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-53">a_{i_k} > a_{(i_k) + 1} = a_{i_{k+1}}</script>. Else, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-525"><span class="MJXp-msubsup" id="MJXp-Span-526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-528" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-529">(</span><span class="MJXp-msubsup" id="MJXp-Span-530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-532" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-533">)</span><span class="MJXp-mo" id="MJXp-Span-534">+</span><span class="MJXp-mn" id="MJXp-Span-535">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-541" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-544" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-545" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-548" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-549">(</span><span class="MJXp-msubsup" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-552" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-553">)</span><span class="MJXp-mo" id="MJXp-Span-554">+</span><span class="MJXp-mn" id="MJXp-Span-555">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-54">a_{(i_k) + 2} < \max(a_{i_k}, a_{(i_k)+1})</script>, but <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-557"><span class="MJXp-msubsup" id="MJXp-Span-558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-560" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-562">1</span></span></span><script type="math/tex" id="MathJax-Element-55">i_k + 1</script> is such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-563"><span class="MJXp-msubsup" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-566" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568" style="margin-right: 0.05em;">i</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-569" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-571">+</span><span class="MJXp-mn" id="MJXp-Span-572">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-576" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-577"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578" style="margin-right: 0.05em;">i</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-579" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">k</span><span class="MJXp-mo" id="MJXp-Span-581">+</span><span class="MJXp-mn" id="MJXp-Span-582">1</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-56">a_{i_{k}+2} \geq a_{i_{k+1}}</script>, so <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-583"><span class="MJXp-msubsup" id="MJXp-Span-584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-586" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-587">(</span><span class="MJXp-msubsup" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-590" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-591">)</span><span class="MJXp-mo" id="MJXp-Span-592">+</span><span class="MJXp-mn" id="MJXp-Span-593">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-597" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-600" style="vertical-align: -0.4em;">k</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-57">a_{(i_k) + 2} < a_{i_k}</script>. We have also <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-601"><span class="MJXp-msubsup" id="MJXp-Span-602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-604" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-607" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-608">+</span><span class="MJXp-mn" id="MJXp-Span-609">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-613" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-616" style="vertical-align: -0.4em;">k</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-58">a_{i_k + 1} < a_{i_k}</script> by definition so we can easily prove by induction on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">j</span><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-620">0</span></span></span><script type="math/tex" id="MathJax-Element-59">j > 0</script> that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-621"><span class="MJXp-msubsup" id="MJXp-Span-622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-624" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-627" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-628">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-633" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-636" style="vertical-align: -0.4em;">k</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-60">a_{i_k + j} < a_{i_k}</script> where it makes sense.</li>   <li>It's optimal : let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">E</span></span></span><script type="math/tex" id="MathJax-Element-61">E</script> be the set of indexes taken by a LDS. For each i such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-639"><span class="MJXp-msubsup" id="MJXp-Span-640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-642" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-646" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">i</span><span class="MJXp-mo" id="MJXp-Span-648">+</span><span class="MJXp-mn" id="MJXp-Span-649">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-62">a_i \leq a_{i+1}</script>, at least one of the elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-650"><span class="MJXp-mrow" id="MJXp-Span-651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">i</span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">i</span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-656">1</span></span></span></span><script type="math/tex" id="MathJax-Element-63">{i, i+1}</script> does not belong to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">E</span></span></span><script type="math/tex" id="MathJax-Element-64">E</script>. Now, these sets are disjoint : if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-659"><span class="MJXp-msubsup" id="MJXp-Span-660"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-662" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-666" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">i</span><span class="MJXp-mo" id="MJXp-Span-668">+</span><span class="MJXp-mn" id="MJXp-Span-669">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-65">a_i < a_{i+1}</script> we cannot have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-670"><span class="MJXp-msubsup" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-673" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">i</span><span class="MJXp-mo" id="MJXp-Span-675">+</span><span class="MJXp-mn" id="MJXp-Span-676">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-680" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">i</span><span class="MJXp-mo" id="MJXp-Span-682">+</span><span class="MJXp-mn" id="MJXp-Span-683">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-66">a_{i+2} < a_{i+1}</script> (otherwise the condition <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-684"><span class="MJXp-mo" id="MJXp-Span-685" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-689" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-693" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">i</span><span class="MJXp-mo" id="MJXp-Span-695">+</span><span class="MJXp-mn" id="MJXp-Span-696">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-701" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">i</span><span class="MJXp-mo" id="MJXp-Span-703">+</span><span class="MJXp-mn" id="MJXp-Span-704">2</span></span></span></span></span><script type="math/tex" id="MathJax-Element-67">\max(a_i, a_{i+1}) > a_{i+2}</script> is not met. So <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-705"><span class="MJXp-mrow" id="MJXp-Span-706"><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">E</span><span class="MJXp-mrow" id="MJXp-Span-709"><span class="MJXp-mo" id="MJXp-Span-710" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">m</span></span></span><script type="math/tex" id="MathJax-Element-68">|E| \leq m</script>.</li> </ul><p>To calculate the sum of the LDS of the sub-arrays, it is therefore sufficient to count for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">i</span></span></span><script type="math/tex" id="MathJax-Element-69">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-715"><span class="MJXp-msubsup" id="MJXp-Span-716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-718" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-722" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">i</span><span class="MJXp-mo" id="MJXp-Span-724">+</span><span class="MJXp-mn" id="MJXp-Span-725">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-70">a_i < a_{i+1}</script> the number of sub-arrays <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">a</span><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">l</span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">r</span><span class="MJXp-mo" id="MJXp-Span-732" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-71">a[l,r]</script> which contain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">i</span></span></span><script type="math/tex" id="MathJax-Element-72">i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">i</span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-738">1</span></span></span><script type="math/tex" id="MathJax-Element-73">i + 1</script>. It's <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-739"><span class="MJXp-mo" id="MJXp-Span-740" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">i</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-743">1</span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-745" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">n</span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">i</span><span class="MJXp-mo" id="MJXp-Span-750" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-751">1</span><span class="MJXp-mo" id="MJXp-Span-752" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-74">(i+1) \cdot (n - i - 1)</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-753"><span class="MJXp-mn" id="MJXp-Span-754">0</span></span></span><script type="math/tex" id="MathJax-Element-75">0</script>-indexation : a necessary and sufficient condition is that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">l</span><span class="MJXp-mo" id="MJXp-Span-757" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">i</span></span></span><script type="math/tex" id="MathJax-Element-76">l \leq i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">r</span><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">i</span><span class="MJXp-mo" id="MJXp-Span-763" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-764">1</span></span></span><script type="math/tex" id="MathJax-Element-77">r \geq i + 1</script>.</p><p>Note that there also exists a dp approach, see <a href="https://codeforces.com/blog/entry/145080?#comment-1297950">this comment</a>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><p><a href="https://codeforces.com/contest/2128/submission/331199533" title="Submission 331199533 by bestial-42-centroids">331199533</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem</b><div class="spoiler-content" style="display: block;"><p>Amazing 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11056">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="311">311</span>
            </i>
        </a>
    </span>


</p><p>Good 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11038">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="68">68</span>
            </i>
        </a>
    </span>


</p><p>Ok 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11039">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="24">24</span>
            </i>
        </a>
    </span>


</p><p>Bad 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11040">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


</p><p>Terrible 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11041">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="82">82</span>
            </i>
        </a>
    </span>


 </p></div></div><p><a href="https://codeforces.com/contest/2128/problem/E1" title="Codeforces Round 1039 (Div. 2)">2128E1 - Submedians (Easy Version)</a></p> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><p>You can use binary search on the answer. Why ?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><p>Let's start with a, perhaps, more natural task: finding whether or not <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-765"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">v</span></span></span><script type="math/tex" id="MathJax-Element-78">v</script> is a submedian. To do so, we create an array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-767"><span class="MJXp-mtext" id="MJXp-Span-768">big</span></span></span><script type="math/tex" id="MathJax-Element-79">\text{big}</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-769"><span class="MJXp-mtext" id="MJXp-Span-770">big</span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">i</span><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-775">1</span><span class="MJXp-mtext" id="MJXp-Span-776">&nbsp;if&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-777">a</span><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">i</span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">v</span><span class="MJXp-mtext" id="MJXp-Span-783">&nbsp;else&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-784" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-785">1</span></span></span><script type="math/tex" id="MathJax-Element-80">\text{big}[i] = 1 \text{ if } \text{a}[i] \geq v \text{ else } -1</script></p><p>We also create an array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-786"><span class="MJXp-mtext" id="MJXp-Span-787">small</span></span></span><script type="math/tex" id="MathJax-Element-81">\text{small}</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-788"><span class="MJXp-mtext" id="MJXp-Span-789">small</span><span class="MJXp-mo" id="MJXp-Span-790" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">i</span><span class="MJXp-mo" id="MJXp-Span-792" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-794">1</span><span class="MJXp-mtext" id="MJXp-Span-795">&nbsp;if&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-796">a</span><span class="MJXp-mo" id="MJXp-Span-797" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">i</span><span class="MJXp-mo" id="MJXp-Span-799" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-800" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">v</span><span class="MJXp-mtext" id="MJXp-Span-802">&nbsp;else&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-804">1</span></span></span><script type="math/tex" id="MathJax-Element-82">\text{small}[i] = 1 \text{ if } \text{a}[i] \leq v \text{ else } -1</script></p><p>Knowing whether v is a submedian or not requires using both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-805"><span class="MJXp-mrow" id="MJXp-Span-806"><span class="MJXp-mi" id="MJXp-Span-807">b</span><span class="MJXp-mi" id="MJXp-Span-808">i</span><span class="MJXp-mi" id="MJXp-Span-809">g</span></span></span></span><script type="math/tex" id="MathJax-Element-83">\mathrm{big}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-810"><span class="MJXp-mrow" id="MJXp-Span-811"><span class="MJXp-mi" id="MJXp-Span-812">s</span><span class="MJXp-mi" id="MJXp-Span-813">m</span><span class="MJXp-mi" id="MJXp-Span-814">a</span><span class="MJXp-mi" id="MJXp-Span-815">l</span><span class="MJXp-mi" id="MJXp-Span-816">l</span></span></span></span><script type="math/tex" id="MathJax-Element-84">\mathrm{small}</script> ; when you want to know if the largest submedian is larger than or equal to v, do you actually need both arrays?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint3</b><div class="spoiler-content" style="display: block;"><p>Solve the relaxed problem where we only consider the first three constraints (and neglect the constraint on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-817"><span class="MJXp-mrow" id="MJXp-Span-818"><span class="MJXp-mi" id="MJXp-Span-819">s</span><span class="MJXp-mi" id="MJXp-Span-820">m</span><span class="MJXp-mi" id="MJXp-Span-821">a</span><span class="MJXp-mi" id="MJXp-Span-822">l</span><span class="MJXp-mi" id="MJXp-Span-823">l</span></span></span></span><script type="math/tex" id="MathJax-Element-85">\mathrm{small}</script>) i.e finding the largest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">v</span></span></span><script type="math/tex" id="MathJax-Element-86">v</script> such that:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-826"><span class="MJXp-mn" id="MJXp-Span-827">1</span><span class="MJXp-mo" id="MJXp-Span-828" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">l</span><span class="MJXp-mo" id="MJXp-Span-830" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">r</span><span class="MJXp-mo" id="MJXp-Span-832" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">n</span></span></span><script type="math/tex" id="MathJax-Element-87">1 \leq l \leq r \leq n</script>,</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">r</span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">l</span><span class="MJXp-mo" id="MJXp-Span-838" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-839">1</span><span class="MJXp-mo" id="MJXp-Span-840" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">k</span></span></span><script type="math/tex" id="MathJax-Element-88">r - l + 1 \geq k</script>,</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-842"><span class="MJXp-mtext" id="MJXp-Span-843">big</span><span class="MJXp-mo" id="MJXp-Span-844" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">l</span><span class="MJXp-mo" id="MJXp-Span-846" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-850">big</span><span class="MJXp-mo" id="MJXp-Span-851" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">r</span><span class="MJXp-mo" id="MJXp-Span-853" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-854" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-855">0</span></span></span><script type="math/tex" id="MathJax-Element-89">\text{big}[l] + \dots + \text{big}[r] \geq 0</script></li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Hint4</b><div class="spoiler-content" style="display: block;"><p>Use binary search and prefix sums to rewrite the constraint on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-856"><span class="MJXp-mtext" id="MJXp-Span-857">big</span></span></span><script type="math/tex" id="MathJax-Element-90">\text{big}</script></p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 5</b><div class="spoiler-content" style="display: block;"><p>Is the resulting value a submedian ?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>First, note that the predicate ``there exists a submedian <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-858"><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">v</span></span></span><script type="math/tex" id="MathJax-Element-91">\geq v</script>'' is monotonic. That is, if there exists a submedian <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-861"><span class="MJXp-mo" id="MJXp-Span-862" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">v</span></span></span><script type="math/tex" id="MathJax-Element-92">\geq v</script>, then for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-864"><span class="MJXp-msup" id="MJXp-Span-865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866" style="margin-right: 0.05em;">v</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-867" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">v</span></span></span><script type="math/tex" id="MathJax-Element-93">v' < v</script>, there exists a submedian <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-870"><span class="MJXp-mo" id="MJXp-Span-871" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">v</span></span></span><script type="math/tex" id="MathJax-Element-94">\geq v</script>. Thus, we can binary search to find the largest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">v</span></span></span><script type="math/tex" id="MathJax-Element-95">v</script> such that there exists a submedian <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-875"><span class="MJXp-mo" id="MJXp-Span-876" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">v</span></span></span><script type="math/tex" id="MathJax-Element-96">\geq v</script>. Such a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">v</span></span></span><script type="math/tex" id="MathJax-Element-97">v</script> will be the largest submedian.</p><p>Now, what is left is to check is, for a fixed <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-880"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">v</span></span></span><script type="math/tex" id="MathJax-Element-98">v</script>, whether or not there exists a submedian <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-882"><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">v</span></span></span><script type="math/tex" id="MathJax-Element-99">\geq v</script>. </p><p>Let's start with a, perhaps, more natural task: finding whether or not <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">v</span></span></span><script type="math/tex" id="MathJax-Element-100">v</script> is a submedian. To do so, we create an array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-887"><span class="MJXp-mtext" id="MJXp-Span-888">big</span></span></span><script type="math/tex" id="MathJax-Element-101">\text{big}</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-889"><span class="MJXp-mtext" id="MJXp-Span-890">big</span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">i</span><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-894" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-895">1</span><span class="MJXp-mtext" id="MJXp-Span-896">&nbsp;if&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-897">a</span><span class="MJXp-mo" id="MJXp-Span-898" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">i</span><span class="MJXp-mo" id="MJXp-Span-900" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">v</span><span class="MJXp-mtext" id="MJXp-Span-903">&nbsp;else&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-905">1</span></span></span><script type="math/tex" id="MathJax-Element-102">\text{big}[i] = 1 \text{ if } \text{a}[i] \geq v \text{ else } -1</script></p><p>We also create an array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-906"><span class="MJXp-mtext" id="MJXp-Span-907">small</span></span></span><script type="math/tex" id="MathJax-Element-103">\text{small}</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-908"><span class="MJXp-mtext" id="MJXp-Span-909">small</span><span class="MJXp-mo" id="MJXp-Span-910" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">i</span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-914">1</span><span class="MJXp-mtext" id="MJXp-Span-915">&nbsp;if&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-916">a</span><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">i</span><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">v</span><span class="MJXp-mtext" id="MJXp-Span-922">&nbsp;else&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-923" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-924">1</span></span></span><script type="math/tex" id="MathJax-Element-104">\text{small}[i] = 1 \text{ if } \text{a}[i] \leq v \text{ else } -1</script></p><p>Using these notations, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">v</span></span></span><script type="math/tex" id="MathJax-Element-105">v</script> is a submedian iff there exists <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mo" id="MJXp-Span-928" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">l</span><span class="MJXp-mo" id="MJXp-Span-930" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">r</span><span class="MJXp-mo" id="MJXp-Span-932" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-106">(l, r)</script> such that:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-933"><span class="MJXp-mn" id="MJXp-Span-934">1</span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">l</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">r</span><span class="MJXp-mo" id="MJXp-Span-939" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">n</span></span></span><script type="math/tex" id="MathJax-Element-107">1 \leq l \leq r \leq n</script>,</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">r</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">l</span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-946">1</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">k</span></span></span><script type="math/tex" id="MathJax-Element-108">r - l + 1 \geq k</script>,</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-949"><span class="MJXp-mtext" id="MJXp-Span-950">big</span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">l</span><span class="MJXp-mo" id="MJXp-Span-953" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-954" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-956" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-957">big</span><span class="MJXp-mo" id="MJXp-Span-958" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">r</span><span class="MJXp-mo" id="MJXp-Span-960" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-961" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-962">0</span></span></span><script type="math/tex" id="MathJax-Element-109">\text{big}[l] + \dots + \text{big}[r] \geq 0</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-963"><span class="MJXp-mtext" id="MJXp-Span-964">small</span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">l</span><span class="MJXp-mo" id="MJXp-Span-967" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-968" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-970" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-971">small</span><span class="MJXp-mo" id="MJXp-Span-972" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">r</span><span class="MJXp-mo" id="MJXp-Span-974" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-976">0</span></span></span><script type="math/tex" id="MathJax-Element-110">\text{small}[l] + \dots + \text{small}[r] \geq 0</script></li> </ul><p>Let's try to solve a relaxed problem where we only consider the first three constraints (and neglect the constraint on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-977"><span class="MJXp-mtext" id="MJXp-Span-978">small</span></span></span><script type="math/tex" id="MathJax-Element-111">\text{small}</script> i.e finding the largest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">v</span></span></span><script type="math/tex" id="MathJax-Element-112">v</script> such that:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-981"><span class="MJXp-mn" id="MJXp-Span-982">1</span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">l</span><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">r</span><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">n</span></span></span><script type="math/tex" id="MathJax-Element-113">1 \leq l \leq r \leq n</script>,</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">r</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">l</span><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-994">1</span><span class="MJXp-mo" id="MJXp-Span-995" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">k</span></span></span><script type="math/tex" id="MathJax-Element-114">r - l + 1 \geq k</script>,</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-997"><span class="MJXp-mtext" id="MJXp-Span-998">big</span><span class="MJXp-mo" id="MJXp-Span-999" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">l</span><span class="MJXp-mo" id="MJXp-Span-1001" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1002" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-1004" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1005">big</span><span class="MJXp-mo" id="MJXp-Span-1006" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">r</span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1009" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1010">0</span></span></span><script type="math/tex" id="MathJax-Element-115">\text{big}[l] + \dots + \text{big}[r] \geq 0</script></li> </ul><p>Such a problem is standard and can be easily solved in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1011"><span class="MJXp-mrow" id="MJXp-Span-1012"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1013">O</span></span><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">n</span><span class="MJXp-mi" id="MJXp-Span-1016">log</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">n</span><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-116">\mathcal{O}(n \log n)</script> by binary search and prefix sums. Indeed, for a fixed <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">v</span></span></span><script type="math/tex" id="MathJax-Element-117">v</script>, we can iterate over the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">r</span></span></span><script type="math/tex" id="MathJax-Element-118">r</script>. Now: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1024"><span class="MJXp-mtext" id="MJXp-Span-1025">big</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">l</span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1029" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1030" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1032">big</span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">r</span><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1036" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1037">0</span></span></span><script type="math/tex" id="MathJax-Element-119">\text{big}[l] + \dots + \text{big}[r] \geq 0</script> iff <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1038"><span class="MJXp-mtext" id="MJXp-Span-1039">pref</span><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">r</span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1044">pref</span><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">l</span><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1048">1</span><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1051">0</span></span></span><script type="math/tex" id="MathJax-Element-120">\text{pref}[r] - \text{pref}[l-1] \geq 0</script> i.e <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1052"><span class="MJXp-mtext" id="MJXp-Span-1053">pref</span><span class="MJXp-mo" id="MJXp-Span-1054" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">r</span><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1057" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mtext" id="MJXp-Span-1058">pref</span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">l</span><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1062">1</span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-121">\text{pref}[r] \geq \text{pref}[l-1]</script> so taking <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">l</span></span></span><script type="math/tex" id="MathJax-Element-122">l</script> that minimizes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1066"><span class="MJXp-mtext" id="MJXp-Span-1067">pref</span><span class="MJXp-mo" id="MJXp-Span-1068" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">l</span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1071">1</span><span class="MJXp-mo" id="MJXp-Span-1072" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-123">\text{pref}[l-1]</script> is optimal. Thus, it is enough to maintain such an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">l</span></span></span><script type="math/tex" id="MathJax-Element-124">l</script> in constant time (when you increase <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">r</span></span></span><script type="math/tex" id="MathJax-Element-125">r</script>, there is only one new candidate for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">l</span></span></span><script type="math/tex" id="MathJax-Element-126">l</script>).</p><p>Now, I claim that the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">v</span></span></span><script type="math/tex" id="MathJax-Element-127">v</script> we get happens to be the largest submedian. Indeed, if it doesn't satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1081"><span class="MJXp-mtext" id="MJXp-Span-1082">small</span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">l</span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1086" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-1088" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1089">small</span><span class="MJXp-mo" id="MJXp-Span-1090" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">r</span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1094">0</span></span></span><script type="math/tex" id="MathJax-Element-128">\text{small}[l] + \dots + \text{small}[r] \geq 0</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1095"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">v</span><span class="MJXp-mo" id="MJXp-Span-1097" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1098">1</span></span></span><script type="math/tex" id="MathJax-Element-129">v + 1</script> would still satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1099"><span class="MJXp-mtext" id="MJXp-Span-1100">big</span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">l</span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1104" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1105" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-1106" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1107">big</span><span class="MJXp-mo" id="MJXp-Span-1108" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">r</span><span class="MJXp-mo" id="MJXp-Span-1110" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1111" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1112">0</span></span></span><script type="math/tex" id="MathJax-Element-130">\text{big}[l] + \dots + \text{big}[r] \geq 0</script> which contradicts the maximality of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">v</span></span></span><script type="math/tex" id="MathJax-Element-131">v</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><p><a href="https://codeforces.com/contest/2128/submission/331199376" title="Submission 331199376 by bestial-42-centroids">331199376</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem</b><div class="spoiler-content" style="display: block;"><p>Amazing 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11057">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="165">165</span>
            </i>
        </a>
    </span>


</p><p>Good 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11042">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="34">34</span>
            </i>
        </a>
    </span>


</p><p>Ok 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11043">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="32">32</span>
            </i>
        </a>
    </span>


</p><p>Bad 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11044">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


</p><p>Terrible 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11045">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="64">64</span>
            </i>
        </a>
    </span>


 </p></div></div><p><a href="https://codeforces.com/contest/2128/problem/E2" title="Codeforces Round 1039 (Div. 2)">2128E2 - Submedians (Hard Version)</a></p> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><p>The set of submedians is a range. Try to prove it.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><p>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1115"><span class="MJXp-msubsup" id="MJXp-Span-1116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1118" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-1120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1122" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-132">l_1 \leq r_1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1123"><span class="MJXp-msubsup" id="MJXp-Span-1124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1126" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1127" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1130" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-133">l_2, r_2</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1131"><span class="MJXp-mrow" id="MJXp-Span-1132"><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1136" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1137" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1140" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1141"><span class="MJXp-mo" id="MJXp-Span-1142" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1144"><span class="MJXp-mo" id="MJXp-Span-1145" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1148" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1152" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1153"><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1155" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1156">1</span></span></span><script type="math/tex" id="MathJax-Element-134">|l_1 - l_2| + |r_1 - r_2| \leq 1</script>, both subarrays share at least one median. How to prove it ? Knowing this fact, how to prove Hint 1 ?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint3</b><div class="spoiler-content" style="display: block;"><p>Find a discretely ``continuous'' path from the subarray of the minimum submedian, to the subarray of the maximum submedian</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Read the editorial of E1 first.</p><p>In such problems, it can be useful to try an easier version, for example, finding maximal/minimal values (which is why the subtask is helpful).</p><p>Now, one can observe that if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">x</span><span class="MJXp-mo" id="MJXp-Span-1159" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">y</span></span></span><script type="math/tex" id="MathJax-Element-135">x \leq y</script> are submedians, then any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">z</span></span></span><script type="math/tex" id="MathJax-Element-136">z</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">x</span><span class="MJXp-mo" id="MJXp-Span-1165" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">z</span><span class="MJXp-mo" id="MJXp-Span-1167" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">y</span></span></span><script type="math/tex" id="MathJax-Element-137">x \leq z \leq y</script> is also a submedian ! One can prove this using the intermediate value theorem. Let's fix <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">x</span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">z</span><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">y</span></span></span><script type="math/tex" id="MathJax-Element-138">x \leq z \leq y</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1175"><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1179" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1183" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-139">[l_1, r_1]</script> (resp. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1185"><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1189" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1190" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1193" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1194" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-140">[l_2, r_2]</script>) be a range where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">x</span></span></span><script type="math/tex" id="MathJax-Element-141">x</script> (resp. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">y</span></span></span><script type="math/tex" id="MathJax-Element-142">y</script>) is a submedian. wlog, assume <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1199"><span class="MJXp-msubsup" id="MJXp-Span-1200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1202" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1206" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-143">l_1 < l_2</script>. Start by sweeping <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1207"><span class="MJXp-msubsup" id="MJXp-Span-1208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1210" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-144">r_1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1211"><span class="MJXp-msubsup" id="MJXp-Span-1212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1214" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-145">l_2</script>. Then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1215"><span class="MJXp-msubsup" id="MJXp-Span-1216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1218" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-146">r_1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1219"><span class="MJXp-msubsup" id="MJXp-Span-1220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1222" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-147">r_2</script>. And finally, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1223"><span class="MJXp-msubsup" id="MJXp-Span-1224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1226" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-148">l_1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1227"><span class="MJXp-msubsup" id="MJXp-Span-1228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1230" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-149">l_2</script>. Then one of the ranges that we covered has submedian <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">z</span></span></span><script type="math/tex" id="MathJax-Element-150">z</script>. Intuitively, when incrementing one of the ends of a range, the +1/-1 in the arrays big and small are not changing that much (the norm 1 distance is bounded by 2) so we can think of using the intermediate value theorem (see proof below). Also, note that at any time, the covered range is of length at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">k</span></span></span><script type="math/tex" id="MathJax-Element-151">k</script>.</p><p>Thus, it is enough to find the smallest and largest submedians (using the solution of E1) and maintain the set of submedians while sweeping. One way to do that is to use a fenwick tree to simulate an ordered set (or you can also use two range sum point update queries to simulate the \text{big} and \text{small} arrays). Alternatively, you can use two sets (one with the lower half of the values of the current range, and one with the upper half). </p><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1235"><span class="MJXp-mo" id="MJXp-Span-1236" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">l</span><span class="MJXp-mo" id="MJXp-Span-1238" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">r</span><span class="MJXp-mo" id="MJXp-Span-1240" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-152">[l, r]</script> that our algorithm covers, we consider the point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1241"><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1243"><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">i</span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1248" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">l</span><span class="MJXp-mo" id="MJXp-Span-1250" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">r</span><span class="MJXp-mo" id="MJXp-Span-1252" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">a</span><span class="MJXp-mo" id="MJXp-Span-1255" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">i</span><span class="MJXp-mo" id="MJXp-Span-1257" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1258" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">z</span></span><span class="MJXp-mrow" id="MJXp-Span-1260"><span class="MJXp-mo" id="MJXp-Span-1261" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1263"><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">i</span><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1268" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">l</span><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">r</span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1273" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">a</span><span class="MJXp-mo" id="MJXp-Span-1275" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">i</span><span class="MJXp-mo" id="MJXp-Span-1277" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1278" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">z</span></span><span class="MJXp-mrow" id="MJXp-Span-1280"><span class="MJXp-mo" id="MJXp-Span-1281" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1282" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-1283"><span class="MJXp-mo" id="MJXp-Span-1284" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">i</span><span class="MJXp-mo" id="MJXp-Span-1287" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1288" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">l</span><span class="MJXp-mo" id="MJXp-Span-1290" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">r</span><span class="MJXp-mo" id="MJXp-Span-1292" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1293" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">a</span><span class="MJXp-mo" id="MJXp-Span-1295" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">i</span><span class="MJXp-mo" id="MJXp-Span-1297" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1298" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">z</span></span><span class="MJXp-mrow" id="MJXp-Span-1300"><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1303"><span class="MJXp-mo" id="MJXp-Span-1304" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">i</span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1308" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">l</span><span class="MJXp-mo" id="MJXp-Span-1310" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">r</span><span class="MJXp-mo" id="MJXp-Span-1312" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1313" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">a</span><span class="MJXp-mo" id="MJXp-Span-1315" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">i</span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1318" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">z</span></span><span class="MJXp-mrow" id="MJXp-Span-1320"><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1322" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-153">(|{i \in [l,r] \mid a[i] \geq z}| - |{i \in [l,r] \mid a[i] < z}|, |{i \in [l,r] \mid a[i] \leq z}| - |{i \in [l,r] \mid a[i] > z}|)</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1323"><span class="MJXp-mrow" id="MJXp-Span-1324"><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">A</span><span class="MJXp-mrow" id="MJXp-Span-1327"><span class="MJXp-mo" id="MJXp-Span-1328" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-154">|A|</script> is the cardinal of set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">A</span></span></span><script type="math/tex" id="MathJax-Element-155">A</script>. Essentially, you can think of this point as an encoding of both conditions on small and big for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">z</span></span></span><script type="math/tex" id="MathJax-Element-156">z</script> to be a submedian.</p><p>Note that, when moving one end of the range, each coordinate of the point changes by at most 1 (in absolute value). Also note that, by a simple computation, the sum of both coordinates is positive (it is equal to twice the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">i</span></span></span><script type="math/tex" id="MathJax-Element-157">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">a</span><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">i</span><span class="MJXp-mo" id="MJXp-Span-1339" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1340" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">z</span></span></span><script type="math/tex" id="MathJax-Element-158">a[i] = z</script>).</p><p>I claim that one of these points will have positive coordinates (thus, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">z</span></span></span><script type="math/tex" id="MathJax-Element-159">z</script> will be a submedian). Indeed: our path starts at a point with (negative first coordinate, positive second coordinate) and ends at a point with (positive first coordinate, negative second coordinate). Each move allows moving to a point at distance at most 2. However, you can see on the drawing below that one must pass through points with positive coordinates to achieve this (otherwise, you would be stuck in (negative first coordinate, positive second coordinate)).</p><p><img alt=" " src="https://codeforces.com/predownloaded/df/01/df015913e2b2e53b4cb2d1ab6649f3218d244483.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>In red, the area with points such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">x</span><span class="MJXp-mo" id="MJXp-Span-1346" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">y</span><span class="MJXp-mo" id="MJXp-Span-1348" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1349">0</span></span></span><script type="math/tex" id="MathJax-Element-160">x+y \geq 0</script>, below the green line are forbidden points. The blue points are our starting and ending points. Finally, the arrows are the possible moves after incrementing/decrementing one end of the range. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><p>Fenwick tree solution: <a href="https://codeforces.com/contest/2128/submission/331199080" title="Submission 331199080 by bestial-42-centroids">331199080</a> Two sets solution: <a href="https://codeforces.com/contest/2128/submission/331198693" title="Submission 331198693 by bestial-42-centroids">331198693</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem</b><div class="spoiler-content" style="display: block;"><p>Amazing 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11058">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="153">153</span>
            </i>
        </a>
    </span>


</p><p>Good 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11046">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


</p><p>Ok 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11047">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="6">6</span>
            </i>
        </a>
    </span>


</p><p>Bad 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11048">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="0">0</span>
            </i>
        </a>
    </span>


</p><p>Terrible 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11049">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


 </p></div></div><p><a href="https://codeforces.com/contest/2128/problem/F" title="Codeforces Round 1039 (Div. 2)">2128F - Strict Triangle</a></p><p>We shorten <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1350"><span class="MJXp-msubsup" id="MJXp-Span-1351"><span class="MJXp-mtext" id="MJXp-Span-1352" style="margin-right: 0.05em;">dist</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1353" style="vertical-align: -0.4em;">w</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-161-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1573"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1574"><span class="msubsup" id="MathJax-Span-1575"><span style="display: inline-block; position: relative; width: 2.221em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1001.57em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mtext" id="MathJax-Span-1576" style="font-family: MathJax_Main;">dist</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 1.626em;"><span class="mi" id="MathJax-Span-1577" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-161">\text{dist}_w</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">d</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-162-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1578"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1579"><span class="mi" id="MathJax-Span-1580" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-162">d</script>. We denote <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1356"><span class="MJXp-msubsup" id="MJXp-Span-1357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1359" style="vertical-align: -0.4em;">L</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-163-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1581"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1582"><span class="msubsup" id="MathJax-Span-1583"><span style="display: inline-block; position: relative; width: 1.085em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1584" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-1585" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-163">d_L</script> as the distance when every edge has weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1360"><span class="MJXp-msubsup" id="MJXp-Span-1361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1363" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-164-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1586"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1587"><span class="msubsup" id="MathJax-Span-1588"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1589" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mi" id="MathJax-Span-1590" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-164">l_i</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1364"><span class="MJXp-msubsup" id="MJXp-Span-1365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1367" style="vertical-align: -0.4em;">R</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-165-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1591"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1592"><span class="msubsup" id="MathJax-Span-1593"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1594" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-1595" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-165">d_R</script> as the distance when every edge has weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1368"><span class="MJXp-msubsup" id="MJXp-Span-1369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1371" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-166-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1596"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1597"><span class="msubsup" id="MathJax-Span-1598"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1599" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-1600" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-166">r_i</script>.</p> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint1a</b><div class="spoiler-content" style="display: block;"><p>Say an edge is green if its weight is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1372"><span class="MJXp-msubsup" id="MJXp-Span-1373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1375" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-167">l_i</script> and red if its weight is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1376"><span class="MJXp-msubsup" id="MJXp-Span-1377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1379" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-168">r_i</script>. If the answer is YES, prove there exists a solution that colors a path from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1380"><span class="MJXp-mn" id="MJXp-Span-1381">1</span></span></span><script type="math/tex" id="MathJax-Element-169">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">n</span></span></span><script type="math/tex" id="MathJax-Element-170">n</script> in green and the rest of the edges in red.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint1b</b><div class="spoiler-content" style="display: block;"><p>Consider an arbitrary solution <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">w</span></span></span><script type="math/tex" id="MathJax-Element-171">w</script> and let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">P</span></span></span><script type="math/tex" id="MathJax-Element-172">P</script> be the shortest path from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1388"><span class="MJXp-mn" id="MJXp-Span-1389">1</span></span></span><script type="math/tex" id="MathJax-Element-173">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">n</span></span></span><script type="math/tex" id="MathJax-Element-174">n</script> with respect to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">w</span></span></span><script type="math/tex" id="MathJax-Element-175">w</script>. Decreasing the weight of an edge in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">P</span></span></span><script type="math/tex" id="MathJax-Element-176">P</script> will decrease <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">d</span><span class="MJXp-mo" id="MJXp-Span-1398" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1399">1</span><span class="MJXp-mo" id="MJXp-Span-1400" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">n</span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-177">d(1, n)</script> by exactly one and will decrease <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">d</span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1406">1</span><span class="MJXp-mo" id="MJXp-Span-1407" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">k</span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1410" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">d</span><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">k</span><span class="MJXp-mo" id="MJXp-Span-1414" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">n</span><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-178">d(1, k) + d(k, n)</script> by at most one. Increasing the weight of an edge outside <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">P</span></span></span><script type="math/tex" id="MathJax-Element-179">P</script> will not increase <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">d</span><span class="MJXp-mo" id="MJXp-Span-1421" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1422">1</span><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">n</span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-180">d(1, n)</script> and will not decrease <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">d</span><span class="MJXp-mo" id="MJXp-Span-1428" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1429">1</span><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">k</span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1433" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">d</span><span class="MJXp-mo" id="MJXp-Span-1435" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">k</span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">n</span><span class="MJXp-mo" id="MJXp-Span-1439" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-181">d(1, k) + d(k, n)</script>. By repeating these operations, we can make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">P</span></span></span><script type="math/tex" id="MathJax-Element-182">P</script> green and the rest red.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint2a</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">P</span></span></span><script type="math/tex" id="MathJax-Element-183">P</script> be the chosen green path. Find a necessary condition for the corresponding weight assignment to be correct. Then, prove if it's sufficient.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2b</b><div class="spoiler-content" style="display: block;"><p>The condition is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1444"><span class="MJXp-msubsup" id="MJXp-Span-1445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1447" style="vertical-align: -0.4em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-1448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">u</span><span class="MJXp-mo" id="MJXp-Span-1450" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">v</span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1456" style="vertical-align: -0.4em;">R</span></span><span class="MJXp-mo" id="MJXp-Span-1457" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">u</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">k</span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1462" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1465" style="vertical-align: -0.4em;">R</span></span><span class="MJXp-mo" id="MJXp-Span-1466" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">k</span><span class="MJXp-mo" id="MJXp-Span-1468" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">v</span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-184">d_L(u, v) < d_R(u, k) + d_R(k, v)</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">u</span><span class="MJXp-mo" id="MJXp-Span-1473" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">v</span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">P</span></span></span><script type="math/tex" id="MathJax-Element-185">u, v \in P</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2c</b><div class="spoiler-content" style="display: block;"><p>It's obviously necessary; otherwise, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1477"><span class="MJXp-mn" id="MJXp-Span-1478">1</span><span class="MJXp-msubsup" id="MJXp-Span-1479"><span class="MJXp-mo" id="MJXp-Span-1480" style="margin-left: 0.333em; margin-right: 0.05em;">→</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1481" style="vertical-align: -0.4em;">L</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">u</span><span class="MJXp-msubsup" id="MJXp-Span-1483"><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0.333em; margin-right: 0.05em;">→</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1485" style="vertical-align: -0.4em;">R</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">k</span><span class="MJXp-msubsup" id="MJXp-Span-1487"><span class="MJXp-mo" id="MJXp-Span-1488" style="margin-left: 0.333em; margin-right: 0.05em;">→</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1489" style="vertical-align: -0.4em;">R</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">v</span><span class="MJXp-msubsup" id="MJXp-Span-1491"><span class="MJXp-mo" id="MJXp-Span-1492" style="margin-left: 0.333em; margin-right: 0.05em;">→</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1493" style="vertical-align: -0.4em;">L</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">n</span></span></span><script type="math/tex" id="MathJax-Element-186">1 \rightarrow_L u \rightarrow_R k \rightarrow_R v \rightarrow_L n</script> would have length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">d</span><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1498">1</span><span class="MJXp-mo" id="MJXp-Span-1499" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">n</span><span class="MJXp-mo" id="MJXp-Span-1501" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-187">d(1, n)</script>. Conversely, if there exists a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1502"><span class="MJXp-mn" id="MJXp-Span-1503">1</span><span class="MJXp-mo" id="MJXp-Span-1504" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">n</span></span></span><script type="math/tex" id="MathJax-Element-188">1-n</script> shortest path going through <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">k</span></span></span><script type="math/tex" id="MathJax-Element-189">k</script>, if you consider the last node in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">P</span></span></span><script type="math/tex" id="MathJax-Element-190">P</script> you visited before reaching <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">k</span></span></span><script type="math/tex" id="MathJax-Element-191">k</script> and the first node in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1512"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">P</span></span></span><script type="math/tex" id="MathJax-Element-192">P</script> you visited after reaching <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">k</span></span></span><script type="math/tex" id="MathJax-Element-193">k</script>, this pair of nodes will violate the condition.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint3</b><div class="spoiler-content" style="display: block;"><p>Try to build a correct path using a Dijkstra-like algorithm. It might be helpful to have an intuitive understanding of the condition found in the previous hint in order to <strong>quantify with a single integer how good the current path is</strong>. Imagine you're a robber going from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1516"><span class="MJXp-mn" id="MJXp-Span-1517">1</span></span></span><script type="math/tex" id="MathJax-Element-194">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">n</span></span></span><script type="math/tex" id="MathJax-Element-195">n</script> and you don't want to be caught by cops.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint4</b><div class="spoiler-content" style="display: block;"><p>Imagine nodes are cities, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">k</span></span></span><script type="math/tex" id="MathJax-Element-196">k</script> is a police station, and you're some robber. Traversing the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">i</span></span></span><script type="math/tex" id="MathJax-Element-197">i</script>-th edge takes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1524"><span class="MJXp-msubsup" id="MJXp-Span-1525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1527" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-198">l_i</script> seconds for the robber, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1528"><span class="MJXp-msubsup" id="MJXp-Span-1529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1531" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-199">r_i</script> seconds for the citizens and the cops.</p><p>Each time you go through a city, the citizens of this city will run to the police station to warn the cops. Once the cops are warned, they start dispatching in all directions as fast as they can to catch up to you.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint5</b><div class="spoiler-content" style="display: block;"><p>The current danger can be represented by an integer timer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">x</span></span></span><script type="math/tex" id="MathJax-Element-200">x</script>. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">x</span><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1537">0</span></span></span><script type="math/tex" id="MathJax-Element-201">x < 0</script>, it means the cops will be warned in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1538"><span class="MJXp-mo" id="MJXp-Span-1539" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">x</span></span></span><script type="math/tex" id="MathJax-Element-202">-x</script> seconds. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">x</span><span class="MJXp-mo" id="MJXp-Span-1543" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1544">0</span></span></span><script type="math/tex" id="MathJax-Element-203">x \geq 0</script>, it means the cops have been warned since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1545"><span class="MJXp-mn" id="MJXp-Span-1546">0</span></span></span><script type="math/tex" id="MathJax-Element-204">0</script> seconds. It's the only information you need to remember.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint6</b><div class="spoiler-content" style="display: block;"><p>Try to find for each node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">u</span></span></span><script type="math/tex" id="MathJax-Element-205">u</script> what is the corresponding minimum timer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1549"><span class="MJXp-msubsup" id="MJXp-Span-1550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1552" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-206">t_u</script>. As the robber runs through the graph, the timer always increases, so you can do this with Dijkstra.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Please read all the hints first.</p><p>We first make a classical Dijkstra from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">k</span></span></span><script type="math/tex" id="MathJax-Element-207">k</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">r</span></span></span><script type="math/tex" id="MathJax-Element-208">r</script>-weighted edges. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1557"><span class="MJXp-msubsup" id="MJXp-Span-1558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1560" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-209">d_u</script> be the distance between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">u</span></span></span><script type="math/tex" id="MathJax-Element-210">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">k</span></span></span><script type="math/tex" id="MathJax-Element-211">k</script> for citizens/cops.</p><p>We then make a modified Dijkstra, starting from the situation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1565"><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1567">1</span><span class="MJXp-mo" id="MJXp-Span-1568" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1571" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1572" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-212">(1, t_1)</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1573"><span class="MJXp-msubsup" id="MJXp-Span-1574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1576" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580" style="margin-right: 0.05em;">d</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1581" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-213">t_1 = -d_1</script> (meaning the cops will be warned in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1582"><span class="MJXp-msubsup" id="MJXp-Span-1583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584" style="margin-right: 0.05em;">d</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1585" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-214">d_1</script> seconds).</p><p>When you traverse the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">i</span></span></span><script type="math/tex" id="MathJax-Element-215">i</script>-th edge to go from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1588"><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">u</span><span class="MJXp-mo" id="MJXp-Span-1591" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">t</span><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-216">(u, t)</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">v</span></span></span><script type="math/tex" id="MathJax-Element-217">v</script>, the new timer will be </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1596"><span class="MJXp-msup" id="MJXp-Span-1597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1599" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1600" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1601" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">t</span><span class="MJXp-mo" id="MJXp-Span-1604" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1607" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1609" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1612" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1614" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-218">t' = \max(t + l_i, -d_v).</script></center><p>We have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1615"><span class="MJXp-msup" id="MJXp-Span-1616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1618" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1619" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">t</span><span class="MJXp-mo" id="MJXp-Span-1621" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1624" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-219">t' \geq t+l_i</script> because the previous timer continued to advance while the robber was traversing the edge, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1625"><span class="MJXp-msup" id="MJXp-Span-1626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1628" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1629" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1633" style="vertical-align: -0.4em;">v</span></span></span></span><script type="math/tex" id="MathJax-Element-220">t' \geq -d_v</script> because a new citizen started running from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">v</span></span></span><script type="math/tex" id="MathJax-Element-221">v</script> to the police station.</p><p>Each time, we take the situation with the minimum timer from the priority queue. If the node has already been processed, or if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1636"><span class="MJXp-msubsup" id="MJXp-Span-1637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1639" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-1641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1643" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-222">d_u \leq t_u</script> (meaning the cops can catch up to the robber in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">v</span></span></span><script type="math/tex" id="MathJax-Element-223">v</script>), the situation is skipped. The answer is YES if and only if we processed the node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">n</span></span></span><script type="math/tex" id="MathJax-Element-224">n</script>.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1648"><span class="MJXp-mrow" id="MJXp-Span-1649"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1650">O</span></span><span class="MJXp-mo" id="MJXp-Span-1651" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">n</span><span class="MJXp-mo" id="MJXp-Span-1654" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">m</span><span class="MJXp-mo" id="MJXp-Span-1656" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1657">log</span><span class="MJXp-mo" id="MJXp-Span-1658" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1659" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">n</span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">m</span><span class="MJXp-mo" id="MJXp-Span-1663" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1664" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-225">\mathcal{O}((n + m) \log (n+m))</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><p><a href="https://codeforces.com/contest/2128/submission/331198575" title="Submission 331198575 by bestial-42-centroids">331198575</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem</b><div class="spoiler-content" style="display: block;"><p>Amazing 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11050">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="58">58</span>
            </i>
        </a>
    </span>


</p><p>Good 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11051">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</p><p>Ok 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11052">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</p><p>Bad 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11053">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</p><p>Terrible 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11054">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


 </p></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2128" class="notice" style="text-decoration: none;">Codeforces Round 1039 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>