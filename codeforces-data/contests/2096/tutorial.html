<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/142070" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p><a href="https://codeforces.com/blog/entry/142069">Sorry about problem H.</a></p><p>Thank you for understanding, and we hope you enjoyed the rest of the problems :D</p> <hr> <h3><a href="https://codeforces.com/contest/2096/problem/A">2096A - Wonderful Sticks</a></h3><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/SanguineChameleon" title="Grandmaster SanguineChameleon">SanguineChameleon</a> <br></p> <div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Create your own test cases and solve them! What can you observe?</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>What is the length of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">n</span></span></span><script type="math/tex" id="MathJax-Element-1">n</script>-th stick?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><ul>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-msubsup" id="MJXp-Span-4"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-6" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">n</span><span class="MJXp-mo" id="MJXp-Span-8">−</span><span class="MJXp-mn" id="MJXp-Span-9">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-11"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-12">&lt;</span></span></span></span><script type="math/tex" id="MathJax-Element-2">s_{n - 1} = \texttt{<}</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-16" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-18">1</span></span></span><script type="math/tex" id="MathJax-Element-3">a_n = 1</script>, because the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">n</span></span></span><script type="math/tex" id="MathJax-Element-4">n</script>-th stick must be shorter than all the other sticks.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-msubsup" id="MJXp-Span-22"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-24" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">n</span><span class="MJXp-mo" id="MJXp-Span-26">−</span><span class="MJXp-mn" id="MJXp-Span-27">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-29"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-30">&gt;</span></span></span></span><script type="math/tex" id="MathJax-Element-5">s_{n - 1} = \texttt{>}</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-msubsup" id="MJXp-Span-32"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-34" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">n</span></span></span><script type="math/tex" id="MathJax-Element-6">a_n = n</script>, because the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">n</span></span></span><script type="math/tex" id="MathJax-Element-7">n</script>-th stick must be longer than all the other sticks.</li> </ul></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>Can we do something similar for the remaining sticks?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>Yes! Remove the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-39"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">n</span></span></span><script type="math/tex" id="MathJax-Element-8">n</script>-th stick, and then solve for the remaining <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">n</span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-44">1</span></span></span><script type="math/tex" id="MathJax-Element-9">n - 1</script> sticks.</p><p>We can make similar observations about the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-45"><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">n</span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-49">1</span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-10">(n - 1)</script>-th stick.</p><p>Then, remove the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-51"><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">n</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-55">1</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-11">(n - 1)</script>-th stick, and solve for the remaining <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-57"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">n</span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-60">2</span></span></span><script type="math/tex" id="MathJax-Element-12">n - 2</script> sticks, and so on.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Step 4</b><div class="spoiler-content" style="display: block;"><p>So the algorithm is as follows:</p> <ol>   <li>Initialize an array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">b</span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-65">1</span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-67">2</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">n</span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-13">b = [1, 2, \ldots, n]</script>. This represents the lengths of the remaining sticks.</li>   <li>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">i</span></span></span><script type="math/tex" id="MathJax-Element-14">i</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-75"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">n</span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-78">1</span></span></span><script type="math/tex" id="MathJax-Element-15">n - 1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-79"><span class="MJXp-mn" id="MJXp-Span-80">1</span></span></span><script type="math/tex" id="MathJax-Element-16">1</script>:   <ul>     <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-msubsup" id="MJXp-Span-82"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-84" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-86"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-87">&lt;</span></span></span></span><script type="math/tex" id="MathJax-Element-17">s_i = \texttt{<}</script>, then set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-97"><span class="MJXp-msubsup" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-100" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">i</span><span class="MJXp-mo" id="MJXp-Span-102">+</span><span class="MJXp-mn" id="MJXp-Span-103">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-104" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-105" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">b</span><span class="MJXp-mo" id="MJXp-Span-108" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-18">a_{i + 1} = \min(b)</script>.</li>     <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-112" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-114"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-115">&gt;</span></span></span></span><script type="math/tex" id="MathJax-Element-19">s_i = \texttt{>}</script>, then set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-116"><span class="MJXp-msubsup" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-119" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">i</span><span class="MJXp-mo" id="MJXp-Span-121">+</span><span class="MJXp-mn" id="MJXp-Span-122">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">b</span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-20">a_{i + 1} = \max(b)</script>.</li>     <li>Now remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-msubsup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-131" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">i</span><span class="MJXp-mo" id="MJXp-Span-133">+</span><span class="MJXp-mn" id="MJXp-Span-134">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-21">a_{i + 1}</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">b</span></span></span><script type="math/tex" id="MathJax-Element-22">b</script>, and continue.</li>   </ul></li>   <li>In the end, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-137"><span class="MJXp-mn" id="MJXp-Span-138">1</span></span></span><script type="math/tex" id="MathJax-Element-23">1</script> remaining element in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">b</span></span></span><script type="math/tex" id="MathJax-Element-24">b</script>. This is the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-141"><span class="MJXp-msubsup" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-144" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-25">a_1</script>.</li> </ol><p>The time complexity of this solution is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">O</span><span class="MJXp-mo" id="MJXp-Span-147" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-150" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-26">O(n^2)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 5 (Optional)</b><div class="spoiler-content" style="display: block;"><p>We can notice that at any point, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">b</span></span></span><script type="math/tex" id="MathJax-Element-27">b</script> has the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-154"><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">l</span><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">l</span><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-160">1</span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">r</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-28">[l, l + 1, \ldots, r]</script>.</p><p>So we can represent <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">b</span></span></span><script type="math/tex" id="MathJax-Element-29">b</script> using two integers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">l</span></span></span><script type="math/tex" id="MathJax-Element-30">l</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">r</span></span></span><script type="math/tex" id="MathJax-Element-31">r</script>:</p> <ul>   <li>When we remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-172"><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">b</span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-32">\min(b)</script>, we increase <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">l</span></span></span><script type="math/tex" id="MathJax-Element-33">l</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-179"><span class="MJXp-mn" id="MJXp-Span-180">1</span></span></span><script type="math/tex" id="MathJax-Element-34">1</script>.</li>   <li>When we remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-181"><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">b</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-35">\max(b)</script>, we decrease <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">r</span></span></span><script type="math/tex" id="MathJax-Element-36">r</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-188"><span class="MJXp-mn" id="MJXp-Span-189">1</span></span></span><script type="math/tex" id="MathJax-Element-37">1</script>.</li> </ul><p>Now the time complexity of our solution is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">O</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">n</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-38">O(n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> test</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">string</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'&lt;'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">;</span><span class="pln">
            l</span><span class="pun">++;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'&gt;'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
            r</span><span class="pun">--;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">;</span><span class="pln">

    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="kwd">nullptr</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        test</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <hr> <h3><a href="https://codeforces.com/contest/2096/problem/B">2096B - Wonderful Gloves</a></h3><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/SanguineChameleon" title="Grandmaster SanguineChameleon">SanguineChameleon</a> <br></p> <div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Let's look at the third test case in the example. We have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">k</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-198">2</span></span></span><script type="math/tex" id="MathJax-Element-39">k = 2</script>, and the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">x</span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-202">303</span></span></span><script type="math/tex" id="MathJax-Element-40">x = 303</script>. If we take out <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-203"><span class="MJXp-mn" id="MJXp-Span-204">302</span></span></span><script type="math/tex" id="MathJax-Element-41">302</script> gloves, then it's possible that we only have matching pairs of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-205"><span class="MJXp-mn" id="MJXp-Span-206">1</span></span></span><script type="math/tex" id="MathJax-Element-42">1</script> color.</p><p>How can we generalize this fact for any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">k</span></span></span><script type="math/tex" id="MathJax-Element-43">k</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">x</span></span></span><script type="math/tex" id="MathJax-Element-44">x</script>?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>If we take out <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-211"><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">x</span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-215">1</span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-45">(x - 1)</script> gloves or fewer, then it's possible that we only have at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-217"><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">k</span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-221">1</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-46">(k - 1)</script> matching pairs of different colors.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>So we can solve the problem as follows:</p> <ul>   <li>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">y</span></span></span><script type="math/tex" id="MathJax-Element-47">y</script> be the maximum number of gloves we can take out so that there are at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-225"><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">k</span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-229">1</span><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-48">(k - 1)</script> matching pairs of different colors. Then the answer to the problem is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">x</span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">y</span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-236">1</span></span></span><script type="math/tex" id="MathJax-Element-49">x = y + 1</script>.</li> </ul><p>Set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">m</span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">k</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-242">1</span></span></span><script type="math/tex" id="MathJax-Element-50">m = k - 1</script>. Now we need to find the maximum number of gloves so that there are at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">m</span></span></span><script type="math/tex" id="MathJax-Element-51">m</script> matching pairs of different colors.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>Try solving it for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">m</span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-248">0</span></span></span><script type="math/tex" id="MathJax-Element-52">m = 0</script> first.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 4</b><div class="spoiler-content" style="display: block;"><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">m</span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-252">0</span></span></span><script type="math/tex" id="MathJax-Element-53">m = 0</script>, we want to find the maximum number of gloves so that there are no matching pairs.</p><p>Therefore, for each color <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">i</span></span></span><script type="math/tex" id="MathJax-Element-54">i</script>, we can either take all the left gloves, or all the right gloves. So we should choose the type with more gloves.</p><p>Formally, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-msubsup" id="MJXp-Span-256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-258" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-264" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-268" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-55">a_i = \max(l_i, r_i)</script>. Then the maximum number of gloves we can take is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">y</span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-275" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-279" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-281" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-285" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-56">y = a_1 + a_2 + \ldots + a_n</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 5</b><div class="spoiler-content" style="display: block;"><p>Now, using the solution for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">m</span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-289">0</span></span></span><script type="math/tex" id="MathJax-Element-57">m = 0</script>, solve it for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">m</span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-293">1</span></span></span><script type="math/tex" id="MathJax-Element-58">m = 1</script>. Then solve it for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">m</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-297">2</span></span></span><script type="math/tex" id="MathJax-Element-59">m = 2</script>, and so on.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 6</b><div class="spoiler-content" style="display: block;"><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">m</span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-301">0</span></span></span><script type="math/tex" id="MathJax-Element-60">m = 0</script>, we take <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-302"><span class="MJXp-msubsup" id="MJXp-Span-303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-305" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-61">a_i</script> gloves of color <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">i</span></span></span><script type="math/tex" id="MathJax-Element-62">i</script>. So we're left with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-308"><span class="MJXp-msubsup" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-311" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-317" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-321" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-63">b_i = \min(l_i, r_i)</script> gloves of color <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">i</span></span></span><script type="math/tex" id="MathJax-Element-64">i</script> that we haven't taken.</p><p>To get from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">m</span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-328">0</span></span></span><script type="math/tex" id="MathJax-Element-65">m = 0</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">m</span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-332">1</span></span></span><script type="math/tex" id="MathJax-Element-66">m = 1</script>, we can additionally form matching pairs of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-333"><span class="MJXp-mn" id="MJXp-Span-334">1</span></span></span><script type="math/tex" id="MathJax-Element-67">1</script> color. Therefore, we can choose a color <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">i</span></span></span><script type="math/tex" id="MathJax-Element-68">i</script>, and take the remaining <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-337"><span class="MJXp-msubsup" id="MJXp-Span-338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-340" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-69">b_i</script> gloves. So we should choose the color <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">i</span></span></span><script type="math/tex" id="MathJax-Element-70">i</script> with the maximum value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-343"><span class="MJXp-msubsup" id="MJXp-Span-344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-346" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-71">b_i</script>.</p><p>In other words, for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">m</span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-350">1</span></span></span><script type="math/tex" id="MathJax-Element-72">m = 1</script>, the maximum number of gloves we can take is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">y</span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-356" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-360" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-366" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-369" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-372" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-376" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-382" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-73">y = a_1 + a_2 + \ldots + a_n + \max(b_1, b_2, \ldots, b_n)</script>.</p><p>To get from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">m</span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-387">0</span></span></span><script type="math/tex" id="MathJax-Element-74">m = 0</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">m</span><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-391">2</span></span></span><script type="math/tex" id="MathJax-Element-75">m = 2</script>, we can additionally form matching pairs of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-392"><span class="MJXp-mn" id="MJXp-Span-393">2</span></span></span><script type="math/tex" id="MathJax-Element-76">2</script> different colors. Therefore, we can choose two different colors <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">i</span></span></span><script type="math/tex" id="MathJax-Element-77">i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">j</span></span></span><script type="math/tex" id="MathJax-Element-78">j</script>, and take the remaining <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-398"><span class="MJXp-msubsup" id="MJXp-Span-399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-401" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-402" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-405" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-79">b_i + b_j</script> gloves. So we should choose the two colors <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">i</span></span></span><script type="math/tex" id="MathJax-Element-80">i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">j</span></span></span><script type="math/tex" id="MathJax-Element-81">j</script> with the maximum value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-410"><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-413" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-417" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-82">b_i + b_j</script>.</p><p>We can generalize this idea for any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">m</span></span></span><script type="math/tex" id="MathJax-Element-83">m</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 7</b><div class="spoiler-content" style="display: block;"><p>So the algorithm is as follows:</p> <ol>   <li>Set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">m</span><span class="MJXp-mo" id="MJXp-Span-422" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">k</span><span class="MJXp-mo" id="MJXp-Span-424" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-425">1</span></span></span><script type="math/tex" id="MathJax-Element-84">m = k - 1</script>.</li>   <li>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">i</span></span></span><script type="math/tex" id="MathJax-Element-85">i</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-428"><span class="MJXp-mn" id="MJXp-Span-429">1</span></span></span><script type="math/tex" id="MathJax-Element-86">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">n</span></span></span><script type="math/tex" id="MathJax-Element-87">n</script>, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-432"><span class="MJXp-msubsup" id="MJXp-Span-433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-435" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-438" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-441" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-445" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-88">a_i = \max(l_i, r_i)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-447"><span class="MJXp-msubsup" id="MJXp-Span-448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-450" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-451" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-456" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-457" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-460" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-89">b_i = \min(l_i, r_i)</script>.</li>   <li>Set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">y</span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-467" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-471" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-477" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-90">y = a_1 + a_2 + \ldots + a_n</script>.</li>   <li>Sort the values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-478"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">b</span></span></span><script type="math/tex" id="MathJax-Element-91">b</script> in descending order.</li>   <li>Add the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">m</span></span></span><script type="math/tex" id="MathJax-Element-92">m</script> largest values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">b</span></span></span><script type="math/tex" id="MathJax-Element-93">b</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">y</span></span></span><script type="math/tex" id="MathJax-Element-94">y</script>.</li>   <li>The answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">x</span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">y</span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-491">1</span></span></span><script type="math/tex" id="MathJax-Element-95">x = y + 1</script>.</li> </ol><p>The time complexity of this solution is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">O</span><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">n</span><span class="MJXp-mi" id="MJXp-Span-496">log</span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">n</span><span class="MJXp-mo" id="MJXp-Span-499" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-96">O(n \log n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> test</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> m </span><span class="pun">=</span><span class="pln"> k </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">

    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> l</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> r</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> r</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">),</span><span class="pln"> b</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">l</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> r</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">l</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> r</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        y </span><span class="pun">+=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    sort</span><span class="pun">(</span><span class="pln">b</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> b</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">(),</span><span class="pln"> greater</span><span class="pun">&lt;&gt;());</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        y </span><span class="pun">+=</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> y </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> x </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="kwd">nullptr</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        test</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <hr> <h3><a href="https://codeforces.com/contest/2096/problem/C">2096C - Wonderful City</a></h3><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/thenymphsofdelphi" title="International Grandmaster thenymphsofdelphi">thenymphsofdelphi</a> <br></p> <div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>We are given an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">n</span><span class="MJXp-mo" id="MJXp-Span-502" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">n</span></span></span><script type="math/tex" id="MathJax-Element-97">n \times n</script> matrix of positive integers. There are two types of operations we can perform:</p> <ul>   <li>When we hire worker <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">i</span></span></span><script type="math/tex" id="MathJax-Element-98">i</script> from company A, let's call it <em>row operation</em> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">i</span></span></span><script type="math/tex" id="MathJax-Element-99">i</script>.</li>   <li>When we hire worker <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">j</span></span></span><script type="math/tex" id="MathJax-Element-100">j</script> from company B, let's call it <em>column operation</em> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">j</span></span></span><script type="math/tex" id="MathJax-Element-101">j</script>.</li> </ul><p>Each row and column operation can be performed at most once.</p><p>After performing the operations, the matrix must satisfy the following:</p> <ul>   <li><strong>Horizontal Condition:</strong> No two horizontally adjacent elements are the same.</li>   <li><strong>Vertical Condition:</strong> No two vertically adjacent elements are the same.</li> </ul><p>Suppose the matrix does not satisfy the Horizontal Condition, so there is a position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-512"><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">i</span><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">j</span><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-102">(i, j)</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-518"><span class="MJXp-msubsup" id="MJXp-Span-519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-521" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">i</span><span class="MJXp-mo" id="MJXp-Span-523">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-528" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">i</span><span class="MJXp-mo" id="MJXp-Span-530">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">j</span><span class="MJXp-mo" id="MJXp-Span-532">+</span><span class="MJXp-mn" id="MJXp-Span-533">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-103">h_{i,j} = h_{i, j + 1}</script>.</p><p>What operations can we perform to fix this? Don't worry about other positions for now. We just want <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-534"><span class="MJXp-msubsup" id="MJXp-Span-535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-537" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">i</span><span class="MJXp-mo" id="MJXp-Span-539">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-541" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-544" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">i</span><span class="MJXp-mo" id="MJXp-Span-546">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">j</span><span class="MJXp-mo" id="MJXp-Span-548">+</span><span class="MJXp-mn" id="MJXp-Span-549">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-104">h_{i,j} \neq h_{i, j + 1}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>We can either:</p> <ul>   <li>Only perform column operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">j</span></span></span><script type="math/tex" id="MathJax-Element-105">j</script>, and increase <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-552"><span class="MJXp-msubsup" id="MJXp-Span-553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-555" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">i</span><span class="MJXp-mo" id="MJXp-Span-557">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-106">h_{i, j}</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-559"><span class="MJXp-mn" id="MJXp-Span-560">1</span></span></span><script type="math/tex" id="MathJax-Element-107">1</script>;</li>   <li>Or only perform column operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-561"><span class="MJXp-mo" id="MJXp-Span-562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">j</span><span class="MJXp-mo" id="MJXp-Span-564" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-565">1</span><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-108">(j + 1)</script>, and increase <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-567"><span class="MJXp-msubsup" id="MJXp-Span-568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-570" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">i</span><span class="MJXp-mo" id="MJXp-Span-572">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">j</span><span class="MJXp-mo" id="MJXp-Span-574">+</span><span class="MJXp-mn" id="MJXp-Span-575">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-109">h_{i, j + 1}</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-576"><span class="MJXp-mn" id="MJXp-Span-577">1</span></span></span><script type="math/tex" id="MathJax-Element-110">1</script>.</li> </ul><p>Notice that when we perform row operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">i</span></span></span><script type="math/tex" id="MathJax-Element-111">i</script>, we increase both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-580"><span class="MJXp-msubsup" id="MJXp-Span-581"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-583" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">i</span><span class="MJXp-mo" id="MJXp-Span-585">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-112">h_{i, j}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-587"><span class="MJXp-msubsup" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-590" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">i</span><span class="MJXp-mo" id="MJXp-Span-592">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">j</span><span class="MJXp-mo" id="MJXp-Span-594">+</span><span class="MJXp-mn" id="MJXp-Span-595">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-113">h_{i, j + 1}</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-596"><span class="MJXp-mn" id="MJXp-Span-597">1</span></span></span><script type="math/tex" id="MathJax-Element-114">1</script>. Therefore, the difference between the two elements does not change.</p><p>Formally, when we perform row operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">i</span></span></span><script type="math/tex" id="MathJax-Element-115">i</script>, the value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">d</span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-605" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">i</span><span class="MJXp-mo" id="MJXp-Span-607">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-609" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-612" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">i</span><span class="MJXp-mo" id="MJXp-Span-614">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">j</span><span class="MJXp-mo" id="MJXp-Span-616">+</span><span class="MJXp-mn" id="MJXp-Span-617">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-116">d = h_{i, j} - h_{i, j + 1}</script> does not change.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>From our previous observations, we see that:</p> <ul>   <li>Only column operations affect the Horizontal Condition.</li>   <li>Only row operations affect the Vertical Condition.</li> </ul><p>So we can solve for the Horizontal Condition and the Vertical Condition independently.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 4</b><div class="spoiler-content" style="display: block;"><p>Using DP, we will calculate:</p> <ul>   <li>The minimum total cost of the row operations required to satisfy the Vertical Condition.</li>   <li>The minimum total cost of the column operations required to satisfy the Horizontal Condition.</li> </ul><p>To get the answer, we add the two costs.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 5</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-618"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">p</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">i</span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">x</span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-117">dp(i, x)</script> be the minimum total cost of the row operations required so that:</p> <ul>   <li>The first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">i</span></span></span><script type="math/tex" id="MathJax-Element-118">i</script> rows of the matrix satisfy the Vertical Condition.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">x</span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-631">0</span></span></span><script type="math/tex" id="MathJax-Element-119">x = 0</script>, then we do not perform row operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">i</span></span></span><script type="math/tex" id="MathJax-Element-120">i</script>.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">x</span><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-637">1</span></span></span><script type="math/tex" id="MathJax-Element-121">x = 1</script>, then we perform row operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">i</span></span></span><script type="math/tex" id="MathJax-Element-122">i</script>.</li> </ul><p>If it is impossible, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">p</span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">i</span><span class="MJXp-mo" id="MJXp-Span-645" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">x</span><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-648" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-649">∞</span></span></span><script type="math/tex" id="MathJax-Element-123">dp(i, x) = \infty</script>.</p><p>Our base cases are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">p</span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-654">1</span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-656">0</span><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-658" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-659">0</span></span></span><script type="math/tex" id="MathJax-Element-124">dp(1, 0) = 0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-660"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">p</span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-664">1</span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-666">1</span><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-668" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-671" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-125">dp(1, 1) = a_1</script>.</p><p>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-672"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">i</span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-675">1</span></span></span><script type="math/tex" id="MathJax-Element-126">i > 1</script>, initialize <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-676"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">p</span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">i</span><span class="MJXp-mo" id="MJXp-Span-681" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">x</span><span class="MJXp-mo" id="MJXp-Span-683" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-127">dp(i, x)</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-684"><span class="MJXp-mi" id="MJXp-Span-685">∞</span></span></span><script type="math/tex" id="MathJax-Element-128">\infty</script>. Our <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-686"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">p</span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">i</span><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">x</span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-129">dp(i, x)</script> will depend on some <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">p</span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">i</span><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-700">1</span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">y</span><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-130">dp(i - 1, y)</script>.</p><p>Now we need to check if row <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-704"><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706">i</span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-708">1</span><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-131">(i - 1)</script> and row <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">i</span></span></span><script type="math/tex" id="MathJax-Element-132">i</script> satisfy the Vertical Condition:</p> <ul>   <li>The elements in row <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">i</span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-715">1</span></span></span><script type="math/tex" id="MathJax-Element-133">i - 1</script> are: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-716"><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-720" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">i</span><span class="MJXp-mo" id="MJXp-Span-722">−</span><span class="MJXp-mn" id="MJXp-Span-723">1</span><span class="MJXp-mo" id="MJXp-Span-724">,</span><span class="MJXp-mn" id="MJXp-Span-725">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">y</span><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-729" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-731"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-733" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">i</span><span class="MJXp-mo" id="MJXp-Span-735">−</span><span class="MJXp-mn" id="MJXp-Span-736">1</span><span class="MJXp-mo" id="MJXp-Span-737">,</span><span class="MJXp-mn" id="MJXp-Span-738">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">y</span><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-745" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-748" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">i</span><span class="MJXp-mo" id="MJXp-Span-750">−</span><span class="MJXp-mn" id="MJXp-Span-751">1</span><span class="MJXp-mo" id="MJXp-Span-752">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">y</span><span class="MJXp-mo" id="MJXp-Span-756" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-134">(h_{i - 1, 1} + y), (h_{i - 1, 2} + y), \ldots, (h_{i - 1, n} + y)</script>.</li>   <li>The elements in row <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">i</span></span></span><script type="math/tex" id="MathJax-Element-135">i</script> are: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-759"><span class="MJXp-mo" id="MJXp-Span-760" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-761"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-763" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">i</span><span class="MJXp-mo" id="MJXp-Span-765">,</span><span class="MJXp-mn" id="MJXp-Span-766">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">x</span><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-774" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">i</span><span class="MJXp-mo" id="MJXp-Span-776">,</span><span class="MJXp-mn" id="MJXp-Span-777">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">x</span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-782" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-784" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-787" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">i</span><span class="MJXp-mo" id="MJXp-Span-789">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">x</span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-136">(h_{i, 1} + x), (h_{i, 2} + x), \ldots, (h_{i, n} + x)</script>.</li> </ul><p>If no two vertically adjacent elements are the same, then:</p> <ul>   <li>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">x</span><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-797">0</span></span></span><script type="math/tex" id="MathJax-Element-137">x = 0</script>, set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">p</span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">i</span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">x</span><span class="MJXp-mo" id="MJXp-Span-805" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-807" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-808" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">p</span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">i</span><span class="MJXp-mo" id="MJXp-Span-813" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">x</span><span class="MJXp-mo" id="MJXp-Span-815" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-816" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">p</span><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">i</span><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-822">1</span><span class="MJXp-mo" id="MJXp-Span-823" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">y</span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-826" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-138">dp(i, x) = \min(dp(i, x), dp(i - 1, y))</script>.</li>   <li>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">x</span><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-830">1</span></span></span><script type="math/tex" id="MathJax-Element-139">x = 1</script>, set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">p</span><span class="MJXp-mo" id="MJXp-Span-834" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">i</span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">x</span><span class="MJXp-mo" id="MJXp-Span-838" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-839" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-840" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">p</span><span class="MJXp-mo" id="MJXp-Span-844" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">i</span><span class="MJXp-mo" id="MJXp-Span-846" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">x</span><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">p</span><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">i</span><span class="MJXp-mo" id="MJXp-Span-854" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-855">1</span><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">y</span><span class="MJXp-mo" id="MJXp-Span-858" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-862" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-140">dp(i, x) = \min(dp(i, x), dp(i - 1, y) + a_i)</script>.</li> </ul><p>The minimum total cost required so that the entire matrix satisfies the Vertical Condition is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-864"><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-866" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">p</span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">n</span><span class="MJXp-mo" id="MJXp-Span-871" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-872">0</span><span class="MJXp-mo" id="MJXp-Span-873" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-874" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">p</span><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">n</span><span class="MJXp-mo" id="MJXp-Span-879" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-880">1</span><span class="MJXp-mo" id="MJXp-Span-881" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-141">\min(dp(n, 0), dp(n, 1))</script>.</p><p>Similarly, we can solve for the Horizontal Condition.</p><p>The time complexity of this solution is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">O</span><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-888" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-142">O(n^2)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 6 (Optional)</b><div class="spoiler-content" style="display: block;"><p>To avoid repetition, we can solve for the Horizontal Condition by transposing the matrix and treating it as the Vertical Condition instead.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> INF </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> solveHor</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pun">&gt;&amp;</span><span class="pln"> h</span><span class="pun">,</span><span class="pln"> vector</span><span class="str">&lt;int&gt;</span><span class="pun">&amp;</span><span class="pln"> a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="pun">&lt;</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">&gt;&gt;</span><span class="pln"> dp</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> vector</span><span class="pun">&lt;</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">&gt;(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> INF</span><span class="pun">));</span><span class="pln">
    dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">

    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> x</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> y </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> y</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">bool</span><span class="pln"> ok </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
                </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    ok </span><span class="pun">&amp;=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">h</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> y </span><span class="pun">!=</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ok</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                        dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">x</span><span class="pun">],</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">y</span><span class="pun">]);</span><span class="pln">
                    </span><span class="pun">}</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                        dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">x</span><span class="pun">],</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">y</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
                    </span><span class="pun">}</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> transpose</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pun">&gt;&amp;</span><span class="pln"> h</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            swap</span><span class="pun">(</span><span class="pln">h</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">],</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> test</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">

    vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pun">&gt;</span><span class="pln"> h</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> vector</span><span class="str">&lt;int&gt;</span><span class="pun">(</span><span class="pln">n</span><span class="pun">));</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            cin </span><span class="pun">&gt;&gt;</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> b</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> horCost </span><span class="pun">=</span><span class="pln"> solveHor</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> h</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">);</span><span class="pln">
    transpose</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> h</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> verCost </span><span class="pun">=</span><span class="pln"> solveHor</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> h</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> totalCost </span><span class="pun">=</span><span class="pln"> horCost </span><span class="pun">+</span><span class="pln"> verCost</span><span class="pun">;</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">totalCost </span><span class="pun">&gt;=</span><span class="pln"> INF</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> totalCost </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="kwd">nullptr</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        test</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <hr> <h3><a href="https://codeforces.com/contest/2096/problem/D">2096D - Wonderful Lightbulbs</a></h3><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/thenymphsofdelphi" title="International Grandmaster thenymphsofdelphi">thenymphsofdelphi</a> <br></p> <div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>What can we say about the number of lightbulbs that are turned on for any valid configuration in the input?</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Can the number of lightbulbs that are turned on be even?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>The number of lightbulbs that are turned on is always odd.</p><p>This is because we start with exactly one lightbulb turned on. Every operation changes the state of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-890"><span class="MJXp-mn" id="MJXp-Span-891">4</span></span></span><script type="math/tex" id="MathJax-Element-143">4</script> lightbulbs, which is an even number. So no matter what operations we perform, we will always have an odd number of lightbulbs turned on.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>Let's use the idea of parity to come up with stricter conditions. </p></div></div> <div class="spoiler"><b class="spoiler-title">Step 4</b><div class="spoiler-content" style="display: block;"><p>Consider the lightbulbs on the vertical line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">x</span><span class="MJXp-mo" id="MJXp-Span-894" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">c</span></span></span><script type="math/tex" id="MathJax-Element-144">x = c</script>. What can we say about the number of lightbulbs that are turned on?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>Suppose the treasure is buried at position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-896"><span class="MJXp-mo" id="MJXp-Span-897" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">s</span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">t</span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-145">(s, t)</script>.</p> <ul>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">c</span><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">s</span></span></span><script type="math/tex" id="MathJax-Element-146">c = s</script>, then the line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">x</span><span class="MJXp-mo" id="MJXp-Span-908" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">c</span></span></span><script type="math/tex" id="MathJax-Element-147">x = c</script> has an odd number of lightbulbs turned on.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-910"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">c</span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">s</span></span></span><script type="math/tex" id="MathJax-Element-148">c \neq s</script>, then the line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">x</span><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">c</span></span></span><script type="math/tex" id="MathJax-Element-149">x = c</script> has an even number of lightbulbs turned on.</li> </ul><p>This is because every operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-918"><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">u</span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">v</span><span class="MJXp-mo" id="MJXp-Span-923" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-150">(u, v)</script> changes the state of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-924"><span class="MJXp-mn" id="MJXp-Span-925">4</span></span></span><script type="math/tex" id="MathJax-Element-151">4</script> lightbulbs: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-926"><span class="MJXp-mo" id="MJXp-Span-927" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">u</span><span class="MJXp-mo" id="MJXp-Span-929" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">v</span><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-152">(u, v)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-932"><span class="MJXp-mo" id="MJXp-Span-933" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">u</span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">v</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-938">1</span><span class="MJXp-mo" id="MJXp-Span-939" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-153">(u, v + 1)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-940"><span class="MJXp-mo" id="MJXp-Span-941" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">u</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-944">1</span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">v</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-948">1</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-154">(u + 1, v - 1)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-950"><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">u</span><span class="MJXp-mo" id="MJXp-Span-953" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-954">1</span><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">v</span><span class="MJXp-mo" id="MJXp-Span-957" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-155">(u + 1, v)</script>.</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-958"><span class="MJXp-mn" id="MJXp-Span-959">2</span></span></span><script type="math/tex" id="MathJax-Element-156">2</script> of them are on the vertical line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">x</span><span class="MJXp-mo" id="MJXp-Span-962" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">u</span></span></span><script type="math/tex" id="MathJax-Element-157">x = u</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-964"><span class="MJXp-mn" id="MJXp-Span-965">2</span></span></span><script type="math/tex" id="MathJax-Element-158">2</script> of them are on the vertical line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">x</span><span class="MJXp-mo" id="MJXp-Span-968" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">u</span><span class="MJXp-mo" id="MJXp-Span-970" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-971">1</span></span></span><script type="math/tex" id="MathJax-Element-159">x = u + 1</script>.</li> </ul></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Step 5</b><div class="spoiler-content" style="display: block;"><p>From our previous observations, we can uniquely determine the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">s</span></span></span><script type="math/tex" id="MathJax-Element-160">s</script>. Can we do the same for the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">t</span></span></span><script type="math/tex" id="MathJax-Element-161">t</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 6</b><div class="spoiler-content" style="display: block;"><p>Consider the lightbulbs on the diagonal line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">x</span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">y</span><span class="MJXp-mo" id="MJXp-Span-980" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">c</span></span></span><script type="math/tex" id="MathJax-Element-162">x + y = c</script>. What can we say about the number of lightbulbs that are turned on?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>Suppose the treasure is buried at position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-982"><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">s</span><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">t</span><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-163">(s, t)</script>.</p> <ul>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">c</span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">s</span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">t</span></span></span><script type="math/tex" id="MathJax-Element-164">c = s + t</script>, then the line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">x</span><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">y</span><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">c</span></span></span><script type="math/tex" id="MathJax-Element-165">x + y = c</script> has an odd number of lightbulbs turned on.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">c</span><span class="MJXp-mo" id="MJXp-Span-1002" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">s</span><span class="MJXp-mo" id="MJXp-Span-1004" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">t</span></span></span><script type="math/tex" id="MathJax-Element-166">c \neq s + t</script>, then the line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">x</span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">y</span><span class="MJXp-mo" id="MJXp-Span-1010" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">c</span></span></span><script type="math/tex" id="MathJax-Element-167">x + y = c</script> has an even number of lightbulbs turned on.</li> </ul><p>This is because every operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1012"><span class="MJXp-mo" id="MJXp-Span-1013" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">u</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">v</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-168">(u, v)</script> changes the state of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1018"><span class="MJXp-mn" id="MJXp-Span-1019">4</span></span></span><script type="math/tex" id="MathJax-Element-169">4</script> lightbulbs: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1020"><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">u</span><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">v</span><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-170">(u, v)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1026"><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">u</span><span class="MJXp-mo" id="MJXp-Span-1029" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">v</span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1032">1</span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-171">(u, v + 1)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1034"><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">u</span><span class="MJXp-mo" id="MJXp-Span-1037" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1038">1</span><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">v</span><span class="MJXp-mo" id="MJXp-Span-1041" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1042">1</span><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-172">(u + 1, v - 1)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1044"><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">u</span><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1048">1</span><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">v</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-173">(u + 1, v)</script>.</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1052"><span class="MJXp-mn" id="MJXp-Span-1053">2</span></span></span><script type="math/tex" id="MathJax-Element-174">2</script> of them are on the diagonal line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">x</span><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">y</span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">u</span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">v</span></span></span><script type="math/tex" id="MathJax-Element-175">x + y = u + v</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1062"><span class="MJXp-mn" id="MJXp-Span-1063">2</span></span></span><script type="math/tex" id="MathJax-Element-176">2</script> of them are on the diagonal line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">x</span><span class="MJXp-mo" id="MJXp-Span-1066" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">y</span><span class="MJXp-mo" id="MJXp-Span-1068" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">u</span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">v</span><span class="MJXp-mo" id="MJXp-Span-1072" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1073">1</span></span></span><script type="math/tex" id="MathJax-Element-177">x + y = u + v + 1</script>.</li> </ul></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Step 7</b><div class="spoiler-content" style="display: block;"><p>So, to summarize, we find two lines:</p> <ul>   <li>The vertical line that has an odd number of lightbulbs turned on</li>   <li>The diagonal line that has an odd number of lightbulbs turned on</li> </ul><p>The intersection of these two lines is the position of the treasure.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> test</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">

    map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> cntVer</span><span class="pun">,</span><span class="pln"> cntDiag</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x </span><span class="pun">&gt;&gt;</span><span class="pln"> y</span><span class="pun">;</span><span class="pln">
        cntVer</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]++;</span><span class="pln">
        cntDiag</span><span class="pun">[</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> y</span><span class="pun">]++;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> cnt</span><span class="pun">]:</span><span class="pln"> cntVer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            s </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> cnt</span><span class="pun">]:</span><span class="pln"> cntDiag</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            t </span><span class="pun">=</span><span class="pln"> c </span><span class="pun">-</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> t </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="kwd">nullptr</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        test</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <hr> <h3><a href="https://codeforces.com/contest/2096/problem/E">2096E - Wonderful Teddy Bears</a></h3><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/SanguineChameleon" title="Grandmaster SanguineChameleon">SanguineChameleon</a> <br></p> <div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>First, we'll treat all the black teddy bears as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1074"><span class="MJXp-mn" id="MJXp-Span-1075">0</span></span></span><script type="math/tex" id="MathJax-Element-178">0</script> and all the pink teddy bears as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1076"><span class="MJXp-mn" id="MJXp-Span-1077">1</span></span></span><script type="math/tex" id="MathJax-Element-179">1</script>.</p><p>So we are given a binary array of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">n</span></span></span><script type="math/tex" id="MathJax-Element-180">n</script>. In one operation, we can choose three consecutive elements and sort them in ascending order. Now we need to find the minimum number of operations required to sort the array.</p><p>There are four possible types of operations, depending on the values of the elements:</p> <ul>   <li>Operation A: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1080"><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1082">0</span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1084">1</span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1086">0</span><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1088" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-1089" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1090">0</span><span class="MJXp-mo" id="MJXp-Span-1091" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1092">0</span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1094">1</span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-181">(0, 1, 0) \rightarrow (0, 0, 1)</script></li>   <li>Operation B: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1096"><span class="MJXp-mo" id="MJXp-Span-1097" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1098">1</span><span class="MJXp-mo" id="MJXp-Span-1099" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1100">0</span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1102">0</span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1104" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-1105" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1106">0</span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1108">0</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1110">1</span><span class="MJXp-mo" id="MJXp-Span-1111" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-182">(1, 0, 0) \rightarrow (0, 0, 1)</script></li>   <li>Operation C: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1112"><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1114">1</span><span class="MJXp-mo" id="MJXp-Span-1115" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1116">0</span><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1118">1</span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1120" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1122">0</span><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1124">1</span><span class="MJXp-mo" id="MJXp-Span-1125" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1126">1</span><span class="MJXp-mo" id="MJXp-Span-1127" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-183">(1, 0, 1) \rightarrow (0, 1, 1)</script></li>   <li>Operation D: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1128"><span class="MJXp-mo" id="MJXp-Span-1129" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1130">1</span><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1132">1</span><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1134">0</span><span class="MJXp-mo" id="MJXp-Span-1135" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-1137" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1138">0</span><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1140">1</span><span class="MJXp-mo" id="MJXp-Span-1141" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1142">1</span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-184">(1, 1, 0) \rightarrow (0, 1, 1)</script></li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Let's think of a greedy solution first. Which operations are better than others?</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>We can evaluate an operation by how much it reduces the number of inversions in the array:</p> <ul>   <li>Operation A reduces the number of inversions by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1144"><span class="MJXp-mn" id="MJXp-Span-1145">1</span></span></span><script type="math/tex" id="MathJax-Element-185">1</script>.</li>   <li>Operation B reduces the number of inversions by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1146"><span class="MJXp-mn" id="MJXp-Span-1147">2</span></span></span><script type="math/tex" id="MathJax-Element-186">2</script>.</li>   <li>Operation C reduces the number of inversions by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1148"><span class="MJXp-mn" id="MJXp-Span-1149">1</span></span></span><script type="math/tex" id="MathJax-Element-187">1</script>.</li>   <li>Operation D reduces the number of inversions by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1150"><span class="MJXp-mn" id="MJXp-Span-1151">2</span></span></span><script type="math/tex" id="MathJax-Element-188">2</script>.</li> </ul><p>Therefore, ideally, we'd only perform operations B and D.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">x</span></span></span><script type="math/tex" id="MathJax-Element-189">x</script> be the number of inversions in the original array. Then the answer is at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1154"><span class="MJXp-mrow" id="MJXp-Span-1155"><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌈</span></span><span class="MJXp-mfrac" id="MJXp-Span-1157" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">x</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1159">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌉</span></span></span></span></span><script type="math/tex" id="MathJax-Element-190">\left\lceil \frac{x}{2} \right\rceil</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 4</b><div class="spoiler-content" style="display: block;"><p>Suppose we keep performing operations B and D until we can no longer do so. What will the array look like?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>The array will have the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1161"><span class="MJXp-mo" id="MJXp-Span-1162" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1163">0</span><span class="MJXp-mo" id="MJXp-Span-1164" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1165">0</span><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1167" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1169">0</span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1171">0</span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1173">1</span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1175">0</span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1177">1</span><span class="MJXp-mo" id="MJXp-Span-1178" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1179">0</span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1181" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mn" id="MJXp-Span-1182">1</span><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1184">0</span><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1186">1</span><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1188">0</span><span class="MJXp-mo" id="MJXp-Span-1189" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1190">1</span><span class="MJXp-mo" id="MJXp-Span-1191" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1192">1</span><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1194" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1196">1</span><span class="MJXp-mo" id="MJXp-Span-1197" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1198">1</span><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-191">[0, 0, \ldots, 0, 0, 1, 0, 1, 0, \ldots 1, 0, 1, 0, 1, 1, \ldots, 1, 1]</script>.</p><p>In other words, the array will consist of:</p> <ol>   <li>A (possibly empty) sequence of consecutive <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1200"><span class="MJXp-mn" id="MJXp-Span-1201">0</span></span></span><script type="math/tex" id="MathJax-Element-192">0</script>'s;</li>   <li>A (possibly empty) sequence of alternating <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1202"><span class="MJXp-mn" id="MJXp-Span-1203">1</span></span></span><script type="math/tex" id="MathJax-Element-193">1</script>'s and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1204"><span class="MJXp-mn" id="MJXp-Span-1205">0</span></span></span><script type="math/tex" id="MathJax-Element-194">0</script>'s;</li>   <li>And a (possibly empty) sequence of consecutive <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1206"><span class="MJXp-mn" id="MJXp-Span-1207">1</span></span></span><script type="math/tex" id="MathJax-Element-195">1</script>'s.</li> </ol></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Step 5</b><div class="spoiler-content" style="display: block;"><p>Since the array has a sequence of alternating <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1208"><span class="MJXp-mn" id="MJXp-Span-1209">1</span></span></span><script type="math/tex" id="MathJax-Element-196">1</script>'s and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1210"><span class="MJXp-mn" id="MJXp-Span-1211">0</span></span></span><script type="math/tex" id="MathJax-Element-197">0</script>'s, we should think about parity.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 6</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">a</span></span></span><script type="math/tex" id="MathJax-Element-198">a</script> be the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1214"><span class="MJXp-mn" id="MJXp-Span-1215">0</span></span></span><script type="math/tex" id="MathJax-Element-199">0</script>'s in the entire array, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">b</span></span></span><script type="math/tex" id="MathJax-Element-200">b</script> be the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1218"><span class="MJXp-mn" id="MJXp-Span-1219">0</span></span></span><script type="math/tex" id="MathJax-Element-201">0</script>'s in the even positions.</p><p>When the array is sorted, all the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1220"><span class="MJXp-mn" id="MJXp-Span-1221">0</span></span></span><script type="math/tex" id="MathJax-Element-202">0</script>'s will be at the beginning of the array. So in the end, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">b</span><span class="MJXp-mo" id="MJXp-Span-1224" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1225"><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-1227" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">a</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1229">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span></span></span><script type="math/tex" id="MathJax-Element-203">b = \left\lfloor \frac{a}{2} \right\rfloor</script>.</p><p>Consider how each type of operation changes the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">b</span></span></span><script type="math/tex" id="MathJax-Element-204">b</script>:</p> <ul>   <li>Operation A either increases or decreases the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">b</span></span></span><script type="math/tex" id="MathJax-Element-205">b</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1235"><span class="MJXp-mn" id="MJXp-Span-1236">1</span></span></span><script type="math/tex" id="MathJax-Element-206">1</script>.</li>   <li>Operation B does not change the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">b</span></span></span><script type="math/tex" id="MathJax-Element-207">b</script>.</li>   <li>Operation C either increases or decreases the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">b</span></span></span><script type="math/tex" id="MathJax-Element-208">b</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1241"><span class="MJXp-mn" id="MJXp-Span-1242">1</span></span></span><script type="math/tex" id="MathJax-Element-209">1</script>.</li>   <li>Operation D does not change the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">b</span></span></span><script type="math/tex" id="MathJax-Element-210">b</script>.</li> </ul><p>Therefore, we can only use operations A and C to change the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">b</span></span></span><script type="math/tex" id="MathJax-Element-211">b</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 7</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">d</span><span class="MJXp-mo" id="MJXp-Span-1249" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1250" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mspace" id="MJXp-Span-1251" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1252"><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-1254" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">a</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1256">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1257" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span><span class="MJXp-mo" id="MJXp-Span-1258" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">b</span><span class="MJXp-mspace" id="MJXp-Span-1260" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1261" style="margin-left: 0em; margin-right: 0em;">|</span></span></span><script type="math/tex" id="MathJax-Element-212">d = \lvert \, \left\lfloor \frac{a}{2} \right\rfloor - b \, \rvert</script>. Then we need at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">d</span></span></span><script type="math/tex" id="MathJax-Element-213">d</script> operations of type A or type C.</p><p>After these <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">d</span></span></span><script type="math/tex" id="MathJax-Element-214">d</script> operations, the array will have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1266"><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">x</span><span class="MJXp-mo" id="MJXp-Span-1269" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">d</span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-215">(x - d)</script> inversions. We can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1272"><span class="MJXp-mo" id="MJXp-Span-1273" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">x</span><span class="MJXp-mo" id="MJXp-Span-1275" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">d</span><span class="MJXp-mo" id="MJXp-Span-1277" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-216">(x - d)</script> must be even.</p><p>Then, we perform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1278"><span class="MJXp-mfrac" id="MJXp-Span-1279" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">x</span><span class="MJXp-mo" id="MJXp-Span-1281">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">d</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1283">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-217">\frac{x - d}{2}</script> operations of type B or type D to reduce the number of inversions to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1284"><span class="MJXp-mn" id="MJXp-Span-1285">0</span></span></span><script type="math/tex" id="MathJax-Element-218">0</script>.</p><p>So the answer to the problem is: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">d</span><span class="MJXp-mo" id="MJXp-Span-1288" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1289" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">x</span><span class="MJXp-mo" id="MJXp-Span-1291">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">d</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1293">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1294" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1295" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">x</span><span class="MJXp-mo" id="MJXp-Span-1297">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">d</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1299">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-219">d + \frac{x - d}{2} = \frac{x + d}{2}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> test</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">

    </span><span class="kwd">string</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">

    </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> b </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'B'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            a</span><span class="pun">++;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                b</span><span class="pun">++;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'P'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            x </span><span class="pun">+=</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> d </span><span class="pun">=</span><span class="pln"> abs</span><span class="pun">(</span><span class="pln">a </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> b</span><span class="pun">);</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> d</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="kwd">nullptr</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        test</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <hr> <h3><a href="https://codeforces.com/contest/2096/problem/F">2096F - Wonderful Impostors</a></h3><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/SanguineChameleon" title="Grandmaster SanguineChameleon">SanguineChameleon</a> <br></p> <div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Let's call a set of statements <em>satisfiable</em> if it's possible that all of them are true.</p><p>How do we check if a set of statements is satisfiable?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>For each statement of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1300"><span class="MJXp-mn" id="MJXp-Span-1301">0</span><span class="MJXp-mspace" id="MJXp-Span-1302" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1305" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mspace" id="MJXp-Span-1306" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1309" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-220">0\,a_l\,a_r</script>, assign all viewers from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1310"><span class="MJXp-msubsup" id="MJXp-Span-1311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1313" style="vertical-align: -0.4em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-221">a_l</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1314"><span class="MJXp-msubsup" id="MJXp-Span-1315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1317" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-222">a_r</script> as crewmates. Then, assign the rest of the viewers as impostors. Now check if all statements of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1318"><span class="MJXp-mn" id="MJXp-Span-1319">1</span><span class="MJXp-mspace" id="MJXp-Span-1320" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1323" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mspace" id="MJXp-Span-1324" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1327" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-223">1\,b_l\,b_r</script> are true. </p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>When a segment of statements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1328"><span class="MJXp-mo" id="MJXp-Span-1329" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1332" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1336" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-224">[s_l, s_r]</script> is satisfiable, what can we say about other segments of statements?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1338"><span class="MJXp-mo" id="MJXp-Span-1339" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1342" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1343" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1346" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1347" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-225">[s_l, s_r]</script> is satisfiable, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1348"><span class="MJXp-mo" id="MJXp-Span-1349" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1352" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1353" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1354">1</span><span class="MJXp-mo" id="MJXp-Span-1355" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1358" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1359" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-226">[s_l + 1, s_r]</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1360"><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1364" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1365" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1368" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1369" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1370">1</span><span class="MJXp-mo" id="MJXp-Span-1371" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-227">[s_l, s_r - 1]</script> are also satisfiable.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>We'll use the two pointers method. For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1372"><span class="MJXp-msubsup" id="MJXp-Span-1373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1375" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-228">s_r</script>, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">w</span><span class="MJXp-mo" id="MJXp-Span-1380" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1383" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1384" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-229">low(s_r)</script> be the smallest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1385"><span class="MJXp-msubsup" id="MJXp-Span-1386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1388" style="vertical-align: -0.4em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-230">s_l</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1389"><span class="MJXp-mo" id="MJXp-Span-1390" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1393" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1397" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1398" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-231">[s_l, s_r]</script> is satisfiable. To answer a question <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1399"><span class="MJXp-msubsup" id="MJXp-Span-1400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1402" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mspace" id="MJXp-Span-1403" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1406" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-232">s_l\,s_r</script>, we just check that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1407"><span class="MJXp-msubsup" id="MJXp-Span-1408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1410" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1411" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">w</span><span class="MJXp-mo" id="MJXp-Span-1415" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1418" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1419" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-233">s_l \geq low(s_r)</script>.</p><p>When we increment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1420"><span class="MJXp-msubsup" id="MJXp-Span-1421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1423" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-234">s_r</script>, we will add statement <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1424"><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1428" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1429" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1430">1</span><span class="MJXp-mo" id="MJXp-Span-1431" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-235">(s_r + 1)</script>. So we must increment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1432"><span class="MJXp-msubsup" id="MJXp-Span-1433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1435" style="vertical-align: -0.4em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-236">s_l</script> and remove statements from the beginning of the segment until <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1436"><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1440" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1441" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1444" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1445" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1446">1</span><span class="MJXp-mo" id="MJXp-Span-1447" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-237">[s_l, s_r + 1]</script> is satisfiable.</p><p>Now we need to efficiently check if we can add a new statement to our current set of statements.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 4</b><div class="spoiler-content" style="display: block;"><p>Let's rephrase how to determine if a set of statements is satisfiable.</p> <ul>   <li><p>For statements of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1448"><span class="MJXp-mn" id="MJXp-Span-1449">0</span><span class="MJXp-mspace" id="MJXp-Span-1450" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1453" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mspace" id="MJXp-Span-1454" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1457" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-238">0\,a_l\,a_r</script>, we'll call <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1458"><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1462" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1463" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1466" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-239">[a_l, a_r]</script> a <em><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1468"><span class="MJXp-mn" id="MJXp-Span-1469">0</span></span></span><script type="math/tex" id="MathJax-Element-240">0</script>-segment</em>.</p></li>   <li><p>Similarly, for statements of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1470"><span class="MJXp-mn" id="MJXp-Span-1471">1</span><span class="MJXp-mspace" id="MJXp-Span-1472" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1475" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mspace" id="MJXp-Span-1476" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1479" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-241">1\,b_l\,b_r</script>, we'll call <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1480"><span class="MJXp-mo" id="MJXp-Span-1481" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1484" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1488" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-242">[b_l, b_r]</script> a <em><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1490"><span class="MJXp-mn" id="MJXp-Span-1491">1</span></span></span><script type="math/tex" id="MathJax-Element-243">1</script>-segment</em>.</p></li>   <li><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1492"><span class="MJXp-mn" id="MJXp-Span-1493">0</span></span></span><script type="math/tex" id="MathJax-Element-244">0</script>-segments overlap and form a larger segment, we'll call it a <em><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1494"><span class="MJXp-mn" id="MJXp-Span-1495">0</span></span></span><script type="math/tex" id="MathJax-Element-245">0</script>-component</em>.</p></li> </ul><p>Then, a set of statements is satisfiable if there does not exist a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1496"><span class="MJXp-mn" id="MJXp-Span-1497">1</span></span></span><script type="math/tex" id="MathJax-Element-246">1</script>-segment that is fully covered by a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1498"><span class="MJXp-mn" id="MJXp-Span-1499">0</span></span></span><script type="math/tex" id="MathJax-Element-247">0</script>-component.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 5</b><div class="spoiler-content" style="display: block;"><p>When we add a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1500"><span class="MJXp-mn" id="MJXp-Span-1501">1</span></span></span><script type="math/tex" id="MathJax-Element-248">1</script>-segment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1502"><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1506" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1510" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1511" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-249">[b_l, b_r]</script>, we need to check if it will be fully covered by a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1512"><span class="MJXp-mn" id="MJXp-Span-1513">0</span></span></span><script type="math/tex" id="MathJax-Element-250">0</script>-component.</p><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">i</span></span></span><script type="math/tex" id="MathJax-Element-251">i</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1516"><span class="MJXp-mn" id="MJXp-Span-1517">1</span></span></span><script type="math/tex" id="MathJax-Element-252">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">n</span></span></span><script type="math/tex" id="MathJax-Element-253">n</script>, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">t</span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">i</span><span class="MJXp-mo" id="MJXp-Span-1528" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-254">count(i)</script> be the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1529"><span class="MJXp-mn" id="MJXp-Span-1530">0</span></span></span><script type="math/tex" id="MathJax-Element-255">0</script>-segments that contain viewer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">i</span></span></span><script type="math/tex" id="MathJax-Element-256">i</script>.</p><p>Then, we can add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1533"><span class="MJXp-mo" id="MJXp-Span-1534" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1537" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1541" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1542" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-257">[b_l, b_r]</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1543"><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1545" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550">t</span><span class="MJXp-mo" id="MJXp-Span-1551" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1554" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1555" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">t</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1565" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1567">1</span><span class="MJXp-mo" id="MJXp-Span-1568" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1571" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">t</span><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1580" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1582" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1583" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1584">0</span></span></span><script type="math/tex" id="MathJax-Element-258">\min(count(b_l), count(b_l + 1), \ldots, count(b_r)) = 0</script>.</p><p>The values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">t</span><span class="MJXp-mo" id="MJXp-Span-1591" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">i</span><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-259">count(i)</script> can be maintained using a segment tree.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 6</b><div class="spoiler-content" style="display: block;"><p>When we add a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1594"><span class="MJXp-mn" id="MJXp-Span-1595">0</span></span></span><script type="math/tex" id="MathJax-Element-260">0</script>-segment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1596"><span class="MJXp-mo" id="MJXp-Span-1597" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1600" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1601" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1604" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1605" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-261">[a_l, a_r]</script>, it might merge several <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1606"><span class="MJXp-mn" id="MJXp-Span-1607">0</span></span></span><script type="math/tex" id="MathJax-Element-262">0</script>-components. So first we need to find the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1608"><span class="MJXp-mn" id="MJXp-Span-1609">0</span></span></span><script type="math/tex" id="MathJax-Element-263">0</script>-component <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1610"><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1614" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1618" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1619" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-264">[c_l, c_r]</script> that contains <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1620"><span class="MJXp-mo" id="MJXp-Span-1621" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1624" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1625" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1628" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1629" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-265">[a_l, a_r]</script>:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1630"><span class="MJXp-msubsup" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1633" style="vertical-align: -0.4em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-266">c_l</script> is the smallest value such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1634"><span class="MJXp-mo" id="MJXp-Span-1635" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1636" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">t</span><span class="MJXp-mo" id="MJXp-Span-1642" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1645" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1646" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">t</span><span class="MJXp-mo" id="MJXp-Span-1653" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1656" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1657" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1658">1</span><span class="MJXp-mo" id="MJXp-Span-1659" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1662" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">t</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1671" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1673" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1674" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-1675">0</span></span></span><script type="math/tex" id="MathJax-Element-267">\min(count(c_l), count(c_l + 1), \ldots, count(a_l)) > 0</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1676"><span class="MJXp-msubsup" id="MJXp-Span-1677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1679" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-268">c_r</script> is the largest value such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1680"><span class="MJXp-mo" id="MJXp-Span-1681" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1682" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">t</span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1691" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1692" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1693" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">t</span><span class="MJXp-mo" id="MJXp-Span-1699" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1702" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1703" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1704">1</span><span class="MJXp-mo" id="MJXp-Span-1705" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1707" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1708" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713">t</span><span class="MJXp-mo" id="MJXp-Span-1714" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1715"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1717" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1718" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1719" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1720" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-1721">0</span></span></span><script type="math/tex" id="MathJax-Element-269">\min(count(a_r), count(a_r + 1), \ldots, count(c_r)) > 0</script>.</li> </ul><p>Both of these values can be found by performing a walk on the segment tree.</p><p>Now we need to check if there's a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1722"><span class="MJXp-mn" id="MJXp-Span-1723">1</span></span></span><script type="math/tex" id="MathJax-Element-270">1</script>-segment that's fully covered by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1724"><span class="MJXp-mo" id="MJXp-Span-1725" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1728" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1729" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1732" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1733" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-271">[c_l, c_r]</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 7</b><div class="spoiler-content" style="display: block;"><p>Sort all the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1734"><span class="MJXp-mn" id="MJXp-Span-1735">1</span></span></span><script type="math/tex" id="MathJax-Element-272">1</script>-segments in the input by ascending value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1736"><span class="MJXp-msubsup" id="MJXp-Span-1737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1739" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-273">b_r</script>.</p><p>Then, for all segments that satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1740"><span class="MJXp-msubsup" id="MJXp-Span-1741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1743" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1744" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-1745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1747" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-274">b_r \leq c_r</script>, find the one with largest value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1748"><span class="MJXp-msubsup" id="MJXp-Span-1749"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1751" style="vertical-align: -0.4em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-275">b_l</script>. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1752"><span class="MJXp-msubsup" id="MJXp-Span-1753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1755" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-1757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1759" style="vertical-align: -0.4em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-276">b_l \geq c_l</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1760"><span class="MJXp-mo" id="MJXp-Span-1761" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1764" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1765" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1768" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1769" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-277">[b_l, b_r]</script> is fully covered by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1770"><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1774" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1775" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1778" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1779" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-278">[c_l, c_r]</script>.</p><p>We can maintain another segment tree with prefix-max queries.</p></div></div> <hr> <h3><a href="https://codeforces.com/contest/2096/problem/G">2096G - Wonderful Guessing Game</a></h3><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/SanguineChameleon" title="Grandmaster SanguineChameleon">SanguineChameleon</a> <br></p> <div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>First, try solving it if Alice doesn't ignore any queries.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>We can represent the queries using a table. Let's look at the second test case in the example:</p> <table class="bordertable">   <thead>     <tr>       <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1780"><span class="MJXp-mn" id="MJXp-Span-1781">1</span></span></span><script type="math/tex" id="MathJax-Element-279">1</script> </th>       <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1782"><span class="MJXp-mn" id="MJXp-Span-1783">2</span></span></span><script type="math/tex" id="MathJax-Element-280">2</script> </th>       <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1784"><span class="MJXp-mn" id="MJXp-Span-1785">3</span></span></span><script type="math/tex" id="MathJax-Element-281">3</script> </th>       <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1786"><span class="MJXp-mn" id="MJXp-Span-1787">4</span></span></span><script type="math/tex" id="MathJax-Element-282">4</script> </th>       <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1788"><span class="MJXp-mn" id="MJXp-Span-1789">5</span></span></span><script type="math/tex" id="MathJax-Element-283">5</script> </th>     </tr>   </thead>   <tbody>     <tr>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1790"><span class="MJXp-mrow" id="MJXp-Span-1791"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1792">R</span></span></span></span><script type="math/tex" id="MathJax-Element-284">\texttt{R}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1793"><span class="MJXp-mrow" id="MJXp-Span-1794"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1795">L</span></span></span></span><script type="math/tex" id="MathJax-Element-285">\texttt{L}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1796"><span class="MJXp-mrow" id="MJXp-Span-1797"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1798">L</span></span></span></span><script type="math/tex" id="MathJax-Element-286">\texttt{L}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1799"><span class="MJXp-mrow" id="MJXp-Span-1800"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1801">R</span></span></span></span><script type="math/tex" id="MathJax-Element-287">\texttt{R}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1802"><span class="MJXp-mrow" id="MJXp-Span-1803"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1804">N</span></span></span></span><script type="math/tex" id="MathJax-Element-288">\texttt{N}</script> </td>     </tr>     <tr>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1805"><span class="MJXp-mrow" id="MJXp-Span-1806"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1807">R</span></span></span></span><script type="math/tex" id="MathJax-Element-289">\texttt{R}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1808"><span class="MJXp-mrow" id="MJXp-Span-1809"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1810">N</span></span></span></span><script type="math/tex" id="MathJax-Element-290">\texttt{N}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1811"><span class="MJXp-mrow" id="MJXp-Span-1812"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1813">R</span></span></span></span><script type="math/tex" id="MathJax-Element-291">\texttt{R}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1814"><span class="MJXp-mrow" id="MJXp-Span-1815"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1816">L</span></span></span></span><script type="math/tex" id="MathJax-Element-292">\texttt{L}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1817"><span class="MJXp-mrow" id="MJXp-Span-1818"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1819">L</span></span></span></span><script type="math/tex" id="MathJax-Element-293">\texttt{L}</script> </td>     </tr>     <tr>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1820"><span class="MJXp-mrow" id="MJXp-Span-1821"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1822">L</span></span></span></span><script type="math/tex" id="MathJax-Element-294">\texttt{L}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1823"><span class="MJXp-mrow" id="MJXp-Span-1824"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1825">N</span></span></span></span><script type="math/tex" id="MathJax-Element-295">\texttt{N}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1826"><span class="MJXp-mrow" id="MJXp-Span-1827"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1828">R</span></span></span></span><script type="math/tex" id="MathJax-Element-296">\texttt{R}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1829"><span class="MJXp-mrow" id="MJXp-Span-1830"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1831">R</span></span></span></span><script type="math/tex" id="MathJax-Element-297">\texttt{R}</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1832"><span class="MJXp-mrow" id="MJXp-Span-1833"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1834">L</span></span></span></span><script type="math/tex" id="MathJax-Element-298">\texttt{L}</script> </td>     </tr>   </tbody> </table><p>Each row is a query. Column <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">x</span></span></span><script type="math/tex" id="MathJax-Element-299">x</script> contains Alice's responses if her number was <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1837"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">x</span></span></span><script type="math/tex" id="MathJax-Element-300">x</script>. </p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>Let's treat <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1839"><span class="MJXp-mrow" id="MJXp-Span-1840"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1841">L</span></span></span></span><script type="math/tex" id="MathJax-Element-301">\texttt{L}</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1842"><span class="MJXp-mo" id="MJXp-Span-1843" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1844">1</span></span></span><script type="math/tex" id="MathJax-Element-302">-1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1845"><span class="MJXp-mrow" id="MJXp-Span-1846"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1847">R</span></span></span></span><script type="math/tex" id="MathJax-Element-303">\texttt{R}</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1848"><span class="MJXp-mn" id="MJXp-Span-1849">1</span></span></span><script type="math/tex" id="MathJax-Element-304">1</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1850"><span class="MJXp-mrow" id="MJXp-Span-1851"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1852">N</span></span></span></span><script type="math/tex" id="MathJax-Element-305">\texttt{N}</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1853"><span class="MJXp-mn" id="MJXp-Span-1854">0</span></span></span><script type="math/tex" id="MathJax-Element-306">0</script>.</p> <table class="bordertable">   <thead>     <tr>       <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1855"><span class="MJXp-mn" id="MJXp-Span-1856">1</span></span></span><script type="math/tex" id="MathJax-Element-307">1</script> </th>       <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1857"><span class="MJXp-mn" id="MJXp-Span-1858">2</span></span></span><script type="math/tex" id="MathJax-Element-308">2</script> </th>       <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1859"><span class="MJXp-mn" id="MJXp-Span-1860">3</span></span></span><script type="math/tex" id="MathJax-Element-309">3</script> </th>       <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1861"><span class="MJXp-mn" id="MJXp-Span-1862">4</span></span></span><script type="math/tex" id="MathJax-Element-310">4</script> </th>       <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1863"><span class="MJXp-mn" id="MJXp-Span-1864">5</span></span></span><script type="math/tex" id="MathJax-Element-311">5</script> </th>     </tr>   </thead>   <tbody>     <tr>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1865"><span class="MJXp-mn" id="MJXp-Span-1866">1</span></span></span><script type="math/tex" id="MathJax-Element-312">1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1867"><span class="MJXp-mo" id="MJXp-Span-1868" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1869">1</span></span></span><script type="math/tex" id="MathJax-Element-313">-1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1870"><span class="MJXp-mo" id="MJXp-Span-1871" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1872">1</span></span></span><script type="math/tex" id="MathJax-Element-314">-1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1873"><span class="MJXp-mn" id="MJXp-Span-1874">1</span></span></span><script type="math/tex" id="MathJax-Element-315">1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1875"><span class="MJXp-mn" id="MJXp-Span-1876">0</span></span></span><script type="math/tex" id="MathJax-Element-316">0</script> </td>     </tr>     <tr>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1877"><span class="MJXp-mn" id="MJXp-Span-1878">1</span></span></span><script type="math/tex" id="MathJax-Element-317">1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1879"><span class="MJXp-mn" id="MJXp-Span-1880">0</span></span></span><script type="math/tex" id="MathJax-Element-318">0</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1881"><span class="MJXp-mn" id="MJXp-Span-1882">1</span></span></span><script type="math/tex" id="MathJax-Element-319">1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1883"><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1885">1</span></span></span><script type="math/tex" id="MathJax-Element-320">-1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1886"><span class="MJXp-mo" id="MJXp-Span-1887" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1888">1</span></span></span><script type="math/tex" id="MathJax-Element-321">-1</script> </td>     </tr>     <tr>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1889"><span class="MJXp-mo" id="MJXp-Span-1890" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1891">1</span></span></span><script type="math/tex" id="MathJax-Element-322">-1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1892"><span class="MJXp-mn" id="MJXp-Span-1893">0</span></span></span><script type="math/tex" id="MathJax-Element-323">0</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1894"><span class="MJXp-mn" id="MJXp-Span-1895">1</span></span></span><script type="math/tex" id="MathJax-Element-324">1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1896"><span class="MJXp-mn" id="MJXp-Span-1897">1</span></span></span><script type="math/tex" id="MathJax-Element-325">1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1898"><span class="MJXp-mo" id="MJXp-Span-1899" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1900">1</span></span></span><script type="math/tex" id="MathJax-Element-326">-1</script> </td>     </tr>   </tbody> </table><p>Then, our strategy works if each row has a sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1901"><span class="MJXp-mn" id="MJXp-Span-1902">0</span></span></span><script type="math/tex" id="MathJax-Element-327">0</script> and all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">n</span></span></span><script type="math/tex" id="MathJax-Element-328">n</script> columns are distinct.</p><p>Since there are only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1905"><span class="MJXp-mn" id="MJXp-Span-1906">3</span></span></span><script type="math/tex" id="MathJax-Element-329">3</script> possible values, we need at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908">q</span><span class="MJXp-mo" id="MJXp-Span-1909" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1910"><span class="MJXp-mo" id="MJXp-Span-1911" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.08em;">⌈</span></span><span class="MJXp-msubsup" id="MJXp-Span-1912"><span class="MJXp-mi" id="MJXp-Span-1913" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1914" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1915" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1916" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">n</span><span class="MJXp-mo" id="MJXp-Span-1918" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1919" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.08em;">⌉</span></span></span></span></span><script type="math/tex" id="MathJax-Element-330">q = \left\lceil \log_3(n) \right\rceil</script> queries. In fact, this lower bound can be achieved.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 4</b><div class="spoiler-content" style="display: block;"><p>We generate all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1920"><span class="MJXp-msubsup" id="MJXp-Span-1921"><span class="MJXp-mn" id="MJXp-Span-1922" style="margin-right: 0.05em;">3</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1923" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">q</span></span></span></span></span><script type="math/tex" id="MathJax-Element-331">3^{q}</script> possible columns: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1925"><span class="MJXp-mo" id="MJXp-Span-1926" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1929" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1930" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1933" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1934" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1935" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1936" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1938" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1939" style="vertical-align: -0.4em;">q</span></span><span class="MJXp-mo" id="MJXp-Span-1940" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-332">[x_1, x_2, \ldots, x_q]</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1941"><span class="MJXp-msubsup" id="MJXp-Span-1942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1944" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1945" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span></span></span><script type="math/tex" id="MathJax-Element-333">x_i \in</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1946"><span class="MJXp-mtext" id="MJXp-Span-1947">{</span></span></span><script type="math/tex" id="MathJax-Element-334">\text{\{}</script><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1948"><span class="MJXp-mo" id="MJXp-Span-1949" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1950">1</span><span class="MJXp-mo" id="MJXp-Span-1951" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1952">0</span><span class="MJXp-mo" id="MJXp-Span-1953" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1954">1</span></span></span><script type="math/tex" id="MathJax-Element-335">-1, 0, 1</script><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1955"><span class="MJXp-mtext" id="MJXp-Span-1956">}</span></span></span><script type="math/tex" id="MathJax-Element-336">\text{\}}</script>.</p><p>Now we need to choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958">n</span></span></span><script type="math/tex" id="MathJax-Element-337">n</script> of them so that they sum to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1959"><span class="MJXp-mn" id="MJXp-Span-1960">0</span></span></span><script type="math/tex" id="MathJax-Element-338">0</script>.</p><p>To do this, we can choose one pair of columns at a time: </p> <ul>   <li>First, we choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1961"><span class="MJXp-mo" id="MJXp-Span-1962" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1963"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1965" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1966" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1969" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1970" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1971" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1972" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1975" style="vertical-align: -0.4em;">q</span></span><span class="MJXp-mo" id="MJXp-Span-1976" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-339">[x_1, x_2, \ldots, x_q]</script>;</li>   <li>Then, we choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1977"><span class="MJXp-mo" id="MJXp-Span-1978" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-1979" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1982" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1983" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1984" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1986" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1987" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1988" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1989" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1990" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1991" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1993" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1994" style="vertical-align: -0.4em;">q</span></span><span class="MJXp-mo" id="MJXp-Span-1995" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-340">[-x_1, -x_2, \ldots, -x_q]</script>.</li> </ul><p>We see that each pair of columns sums to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1996"><span class="MJXp-mn" id="MJXp-Span-1997">0</span></span></span><script type="math/tex" id="MathJax-Element-341">0</script>.</p><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999">n</span></span></span><script type="math/tex" id="MathJax-Element-342">n</script> is odd, we can include <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2000"><span class="MJXp-mo" id="MJXp-Span-2001" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2002">0</span><span class="MJXp-mo" id="MJXp-Span-2003" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2004">0</span><span class="MJXp-mo" id="MJXp-Span-2005" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2006" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2007" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2008">0</span><span class="MJXp-mo" id="MJXp-Span-2009" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-343">[0, 0, \ldots, 0]</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 5</b><div class="spoiler-content" style="display: block;"><p>Now let's try to solve the original problem. For our strategy to work, it must satisfy the following:</p> <ul>   <li>Each row has a sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2010"><span class="MJXp-mn" id="MJXp-Span-2011">0</span></span></span><script type="math/tex" id="MathJax-Element-344">0</script>.</li>   <li>No two columns are the same.</li>   <li>No two columns differ by exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2012"><span class="MJXp-mn" id="MJXp-Span-2013">1</span></span></span><script type="math/tex" id="MathJax-Element-345">1</script> element.</li> </ul><p>To achieve this, we only need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2014"><span class="MJXp-mn" id="MJXp-Span-2015">1</span></span></span><script type="math/tex" id="MathJax-Element-346">1</script> additional query.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 6</b><div class="spoiler-content" style="display: block;"><p>Here's another way to think about it:</p> <ul>   <li>For each column, no matter which element is ignored, we should be able to uniquely determine the missing value.</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Step 7</b><div class="spoiler-content" style="display: block;"><p>We use the same solution as before, but with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2016"><span class="MJXp-mn" id="MJXp-Span-2017">1</span></span></span><script type="math/tex" id="MathJax-Element-347">1</script> more element:</p> <ul>   <li>For each column <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2018"><span class="MJXp-mo" id="MJXp-Span-2019" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2021" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2022" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2023" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2026" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2027" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2028" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2029" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2031" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2032" style="vertical-align: -0.4em;">q</span></span><span class="MJXp-mo" id="MJXp-Span-2033" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-348">[x_1, x_2, \ldots, x_q]</script>, add an element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2034"><span class="MJXp-msubsup" id="MJXp-Span-2035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2037" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038">q</span><span class="MJXp-mo" id="MJXp-Span-2039">+</span><span class="MJXp-mn" id="MJXp-Span-2040">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-349">x_{q + 1}</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2041"><span class="MJXp-mo" id="MJXp-Span-2042" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2044" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2045" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2046" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2047"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2049" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2050" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2051" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2052" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2055" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056">q</span><span class="MJXp-mo" id="MJXp-Span-2057">+</span><span class="MJXp-mn" id="MJXp-Span-2058">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2059" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-2060"><span class="MJXp-mspace" id="MJXp-Span-2061" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-2062">mod</span><span class="MJXp-mspace" id="MJXp-Span-2063" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2064" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-2065">3</span><span class="MJXp-mo" id="MJXp-Span-2066" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2067">0</span></span></span><script type="math/tex" id="MathJax-Element-350">(x_1 + x_2 + \ldots + x_{q + 1})\mod 3 = 0</script>.</li> </ul><p>Because the sum of each column is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2068"><span class="MJXp-mn" id="MJXp-Span-2069">0</span></span></span><script type="math/tex" id="MathJax-Element-351">0</script> modulo <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2070"><span class="MJXp-mn" id="MJXp-Span-2071">3</span></span></span><script type="math/tex" id="MathJax-Element-352">3</script>, we can uniquely recover any missing element.</p></div></div> <hr> <h3><a href="https://codeforces.com/contest/2096/problem/H">2096H - Wonderful XOR Problem</a></h3><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/SanguineChameleon" title="Grandmaster SanguineChameleon">SanguineChameleon</a> <br></p> <div class="spoiler"><b class="spoiler-title">Step 0</b><div class="spoiler-content" style="display: block;"><p>Is this FFT?</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 1.1</b><div class="spoiler-content" style="display: block;"><p>Let's consider the XOR convolution. Given two polynomials <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2072"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073">A</span><span class="MJXp-mo" id="MJXp-Span-2074" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2075">x</span><span class="MJXp-mo" id="MJXp-Span-2076" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-353">A(x)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2078">B</span><span class="MJXp-mo" id="MJXp-Span-2079" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080">x</span><span class="MJXp-mo" id="MJXp-Span-2081" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-354">B(x)</script> with degree at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2082"><span class="MJXp-mo" id="MJXp-Span-2083" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2084"><span class="MJXp-mn" id="MJXp-Span-2085" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2086" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2087">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2089">1</span><span class="MJXp-mo" id="MJXp-Span-2090" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-355">(2^{m} - 1)</script>, the XOR convolution <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">C</span><span class="MJXp-mo" id="MJXp-Span-2093" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2094">x</span><span class="MJXp-mo" id="MJXp-Span-2095" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2096" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2097">A</span><span class="MJXp-mo" id="MJXp-Span-2098" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2099">x</span><span class="MJXp-mo" id="MJXp-Span-2100" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2101" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2102">B</span><span class="MJXp-mo" id="MJXp-Span-2103" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2104">x</span><span class="MJXp-mo" id="MJXp-Span-2105" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-356">C(x) = A(x) \star B(x)</script> is defined as follows:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2106"><span class="MJXp-mstyle" id="MJXp-Span-2107"><span class="MJXp-mo" id="MJXp-Span-2108" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2110" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2111" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2112" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2113">C</span><span class="MJXp-mo" id="MJXp-Span-2114" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2115">x</span><span class="MJXp-mo" id="MJXp-Span-2116" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2117" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2118"><span class=""><span class="MJXp-mo" id="MJXp-Span-2119" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2120" style="margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-2121">0</span><span class="MJXp-mo" id="MJXp-Span-2122">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2123">i</span><span class="MJXp-mo" id="MJXp-Span-2124">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2125"><span class="MJXp-mn" id="MJXp-Span-2126" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2127" style="vertical-align: 0.5em;">m</span></span><span class="MJXp-mspace" id="MJXp-Span-2128" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-2129">0</span><span class="MJXp-mo" id="MJXp-Span-2130">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">j</span><span class="MJXp-mo" id="MJXp-Span-2132">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2133"><span class="MJXp-mn" id="MJXp-Span-2134" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2135" style="vertical-align: 0.5em;">m</span></span><span class="MJXp-mspace" id="MJXp-Span-2136" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2137">i</span><span class="MJXp-mo" id="MJXp-Span-2138">⊕</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139">j</span><span class="MJXp-mo" id="MJXp-Span-2140">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2141">k</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2142" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2144" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2145" style="vertical-align: 0.5em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2146" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147">A</span><span class="MJXp-mo" id="MJXp-Span-2148" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149">x</span><span class="MJXp-mo" id="MJXp-Span-2150" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2151" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-2152" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2154" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2155" style="vertical-align: 0.5em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-2156" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2157">B</span><span class="MJXp-mo" id="MJXp-Span-2158" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2159">x</span><span class="MJXp-mo" id="MJXp-Span-2160" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-357">\displaystyle [x^k]C(x) = \sum_{0 \leq i < 2^m \\ 0 \leq j < 2^m \\ i \oplus j = k} [x^i]A(x) \cdot [x^j]B(x)</script></center></div></div> <div class="spoiler"><b class="spoiler-title">Step 1.2</b><div class="spoiler-content" style="display: block;"><p>To efficiently compute the XOR convolution, we can use FWHT.</p><p>First, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2162">s</span><span class="MJXp-mo" id="MJXp-Span-2163" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164">k</span><span class="MJXp-mo" id="MJXp-Span-2165" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2166">i</span><span class="MJXp-mo" id="MJXp-Span-2167" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2168" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2169" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2170" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2171">1</span><span class="MJXp-msubsup" id="MJXp-Span-2172"><span class="MJXp-mo" id="MJXp-Span-2173" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2174" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-2175">popcount</span><span class="MJXp-mo" id="MJXp-Span-2176">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2177">k</span><span class="MJXp-mspace" id="MJXp-Span-2178" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-2179">&amp;</span><span class="MJXp-mspace" id="MJXp-Span-2180" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">i</span><span class="MJXp-mo" id="MJXp-Span-2182">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-358">s(k, i) = (-1)^{\text{popcount}(k\,\&\,i)}</script>.</p><p>Then, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2184">F</span><span class="MJXp-mo" id="MJXp-Span-2185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186">A</span><span class="MJXp-mo" id="MJXp-Span-2187" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2188">x</span><span class="MJXp-mo" id="MJXp-Span-2189" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2190" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-359">F(A(x))</script> is defined as follows:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2191"><span class="MJXp-mstyle" id="MJXp-Span-2192"><span class="MJXp-mo" id="MJXp-Span-2193" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2196" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2197" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198">F</span><span class="MJXp-mo" id="MJXp-Span-2199" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2200">A</span><span class="MJXp-mo" id="MJXp-Span-2201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202">x</span><span class="MJXp-mo" id="MJXp-Span-2203" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2204" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2205" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2206"><span class=""><span class="MJXp-mo" id="MJXp-Span-2207" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2208" style="margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-2209">0</span><span class="MJXp-mo" id="MJXp-Span-2210">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2211">i</span><span class="MJXp-mo" id="MJXp-Span-2212">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2213"><span class="MJXp-mn" id="MJXp-Span-2214" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2215" style="vertical-align: 0.5em;">m</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2216" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2218" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2219" style="vertical-align: 0.5em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2220" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2221">A</span><span class="MJXp-mo" id="MJXp-Span-2222" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223">x</span><span class="MJXp-mo" id="MJXp-Span-2224" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2225" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2226">s</span><span class="MJXp-mo" id="MJXp-Span-2227" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2228">k</span><span class="MJXp-mo" id="MJXp-Span-2229" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2230">i</span><span class="MJXp-mo" id="MJXp-Span-2231" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-360">\displaystyle [x^k]F(A(x)) = \sum_{0 \leq i < 2^m} [x^i]A(x) \cdot s(k, i)</script></center><p>Given <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2232"><span class="MJXp-msubsup" id="MJXp-Span-2233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2235" style="vertical-align: 0.5em;"><span class="MJXp-mspace" id="MJXp-Span-2236" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-2237">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-2238" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239">x</span><span class="MJXp-mo" id="MJXp-Span-2240" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2241" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242">F</span><span class="MJXp-mo" id="MJXp-Span-2243" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244">A</span><span class="MJXp-mo" id="MJXp-Span-2245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2246">x</span><span class="MJXp-mo" id="MJXp-Span-2247" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2248" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-361">A^{\,\prime}(x) = F(A(x))</script>, we can uniquely determine <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2250">A</span><span class="MJXp-mo" id="MJXp-Span-2251" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252">x</span><span class="MJXp-mo" id="MJXp-Span-2253" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2254" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2256" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2257" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2258">−</span><span class="MJXp-mn" id="MJXp-Span-2259">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2260" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2262" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2263" style="vertical-align: 0.5em;"><span class="MJXp-mspace" id="MJXp-Span-2264" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-2265">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-2266" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2267">x</span><span class="MJXp-mo" id="MJXp-Span-2268" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2269" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-362">A(x) = F^{-1}(A^{\,\prime}(x))</script> using the inverse of FWHT.</p><p>To compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2271">F</span><span class="MJXp-mo" id="MJXp-Span-2272" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273">A</span><span class="MJXp-mo" id="MJXp-Span-2274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2275">x</span><span class="MJXp-mo" id="MJXp-Span-2276" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2277" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-363">F(A(x))</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2278"><span class="MJXp-msubsup" id="MJXp-Span-2279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2281" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2282">−</span><span class="MJXp-mn" id="MJXp-Span-2283">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2284" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2286" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2287" style="vertical-align: 0.5em;"><span class="MJXp-mspace" id="MJXp-Span-2288" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-2289">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-2290" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2291">x</span><span class="MJXp-mo" id="MJXp-Span-2292" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2293" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-364">F^{-1}(A^{\,\prime}(x))</script>, we can use SOS DP.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 1.3</b><div class="spoiler-content" style="display: block;"><p>Define the dot product <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2295">D</span><span class="MJXp-mo" id="MJXp-Span-2296" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2297">x</span><span class="MJXp-mo" id="MJXp-Span-2298" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2299" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2300">A</span><span class="MJXp-mo" id="MJXp-Span-2301" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2302">x</span><span class="MJXp-mo" id="MJXp-Span-2303" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2304" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305">B</span><span class="MJXp-mo" id="MJXp-Span-2306" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">x</span><span class="MJXp-mo" id="MJXp-Span-2308" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-365">D(x) = A(x) \cdot B(x)</script> as follows: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2309"><span class="MJXp-mstyle" id="MJXp-Span-2310"><span class="MJXp-mo" id="MJXp-Span-2311" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2313" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2314" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2315" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316">D</span><span class="MJXp-mo" id="MJXp-Span-2317" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318">x</span><span class="MJXp-mo" id="MJXp-Span-2319" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2320" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2321" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2323" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2324" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2325" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2326">A</span><span class="MJXp-mo" id="MJXp-Span-2327" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2328">x</span><span class="MJXp-mo" id="MJXp-Span-2329" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2330" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-2331" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2334" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2335" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336">B</span><span class="MJXp-mo" id="MJXp-Span-2337" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2338">x</span><span class="MJXp-mo" id="MJXp-Span-2339" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-366">\displaystyle [x^k]D(x) = [x^k]A(x) \cdot [x^k]B(x)</script></p><p>We can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">F</span><span class="MJXp-mo" id="MJXp-Span-2342" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343">A</span><span class="MJXp-mo" id="MJXp-Span-2344" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345">x</span><span class="MJXp-mo" id="MJXp-Span-2346" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2347" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2348">B</span><span class="MJXp-mo" id="MJXp-Span-2349" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2350">x</span><span class="MJXp-mo" id="MJXp-Span-2351" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2352" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2353" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354">F</span><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">A</span><span class="MJXp-mo" id="MJXp-Span-2357" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2358">x</span><span class="MJXp-mo" id="MJXp-Span-2359" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2360" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2361" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2362">F</span><span class="MJXp-mo" id="MJXp-Span-2363" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364">B</span><span class="MJXp-mo" id="MJXp-Span-2365" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">x</span><span class="MJXp-mo" id="MJXp-Span-2367" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2368" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-367">F(A(x) \star B(x)) = F(A(x)) \cdot F(B(x))</script> for any two polynomials <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2370">A</span><span class="MJXp-mo" id="MJXp-Span-2371" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2372">x</span><span class="MJXp-mo" id="MJXp-Span-2373" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-368">A(x)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375">B</span><span class="MJXp-mo" id="MJXp-Span-2376" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377">x</span><span class="MJXp-mo" id="MJXp-Span-2378" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-369">B(x)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2.1</b><div class="spoiler-content" style="display: block;"><p>Let's solve the problem. For each interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2379"><span class="MJXp-mo" id="MJXp-Span-2380" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2382" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2383" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2384" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2386" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2387" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2388" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-370">[l_i, r_i]</script>, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2389"><span class="MJXp-msubsup" id="MJXp-Span-2390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2391" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2392" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2393" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2394">x</span><span class="MJXp-mo" id="MJXp-Span-2395" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2396" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2399" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2402" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2403" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2405" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2406" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2409" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2410">+</span><span class="MJXp-mn" id="MJXp-Span-2411">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2412" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2413" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2414" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2416" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2417" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2419" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2420" style="vertical-align: -0.4em;">i</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-371">A_i(x) = x^{l_i} + x^{l_i + 1} + \ldots + x^{r_i}</script>.</p><p>We want to find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2421"><span class="MJXp-msubsup" id="MJXp-Span-2422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2423" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2424" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2425" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426">x</span><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2428" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-msubsup" id="MJXp-Span-2429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2431" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2432" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2433">x</span><span class="MJXp-mo" id="MJXp-Span-2434" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2435" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-mo" id="MJXp-Span-2436" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2437" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-msubsup" id="MJXp-Span-2438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2439" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2440" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2441" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442">x</span><span class="MJXp-mo" id="MJXp-Span-2443" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-372">A_1(x) \star A_2(x) \star \ldots \star A_n(x)</script>. To do this, we'll compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2444"><span class="MJXp-msubsup" id="MJXp-Span-2445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2446" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2447" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2448">−</span><span class="MJXp-mn" id="MJXp-Span-2449">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2450" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2451">F</span><span class="MJXp-mo" id="MJXp-Span-2452" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2455" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2456" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2457">x</span><span class="MJXp-mo" id="MJXp-Span-2458" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2459" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2460" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2461">F</span><span class="MJXp-mo" id="MJXp-Span-2462" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2464" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2465" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2466" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2467">x</span><span class="MJXp-mo" id="MJXp-Span-2468" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2469" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2470" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-2471" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2472" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2473">F</span><span class="MJXp-mo" id="MJXp-Span-2474" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2477" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2478" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2479">x</span><span class="MJXp-mo" id="MJXp-Span-2480" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2481" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2482" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-373">F^{-1}(F(A_1(x)) \cdot F(A_2(x)) \cdot \ldots \cdot F(A_n(x)))</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2.2</b><div class="spoiler-content" style="display: block;"><p>We can note that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2483"><span class="MJXp-mstyle" id="MJXp-Span-2484"><span class="MJXp-mo" id="MJXp-Span-2485" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2487" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2488" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2489" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2490">F</span><span class="MJXp-mo" id="MJXp-Span-2491" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2494" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2496">x</span><span class="MJXp-mo" id="MJXp-Span-2497" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2498" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2499" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2500"><span class=""><span class="MJXp-mo" id="MJXp-Span-2501" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2502" style="margin-left: 0px;"><span class="MJXp-msubsup" id="MJXp-Span-2503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2504" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2505" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2506">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507">j</span><span class="MJXp-mo" id="MJXp-Span-2508">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2510" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2511" style="vertical-align: -0.4em;">i</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2512">s</span><span class="MJXp-mo" id="MJXp-Span-2513" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514">k</span><span class="MJXp-mo" id="MJXp-Span-2515" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2516">j</span><span class="MJXp-mo" id="MJXp-Span-2517" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-374">\displaystyle [x^k]F(A_i(x)) = \sum_{l_i \leq j \leq r_i} s(k, j)</script></p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2519">f</span><span class="MJXp-mo" id="MJXp-Span-2520" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2521">k</span><span class="MJXp-mo" id="MJXp-Span-2522" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2523">r</span><span class="MJXp-mo" id="MJXp-Span-2524" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2525" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-2526"><span class="MJXp-munderover" id="MJXp-Span-2527"><span class=""><span class="MJXp-mo" id="MJXp-Span-2528" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2529" style="margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-2530">0</span><span class="MJXp-mo" id="MJXp-Span-2531">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2532">j</span><span class="MJXp-mo" id="MJXp-Span-2533">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2534">r</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2535">s</span><span class="MJXp-mo" id="MJXp-Span-2536" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2537">k</span><span class="MJXp-mo" id="MJXp-Span-2538" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539">j</span><span class="MJXp-mo" id="MJXp-Span-2540" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-375">f(k, r) = \displaystyle \sum_{0 \leq j \leq r} s(k, j)</script>. Then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2541"><span class="MJXp-mstyle" id="MJXp-Span-2542"><span class="MJXp-mo" id="MJXp-Span-2543" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2544"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2545" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2546" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2547" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2548">F</span><span class="MJXp-mo" id="MJXp-Span-2549" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2551" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2552" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2553" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2554">x</span><span class="MJXp-mo" id="MJXp-Span-2555" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2556" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2557" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558">f</span><span class="MJXp-mo" id="MJXp-Span-2559" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2560">k</span><span class="MJXp-mo" id="MJXp-Span-2561" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2564" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2565" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2566" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2567">f</span><span class="MJXp-mo" id="MJXp-Span-2568" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2569">k</span><span class="MJXp-mo" id="MJXp-Span-2570" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2572" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2573" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2574" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2575">1</span><span class="MJXp-mo" id="MJXp-Span-2576" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-376">\displaystyle [x^k]F(A_i(x)) = f(k, r_i) - f(k, l_i - 1)</script>.</p><p>Now we need to find a way to compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2577"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2578">f</span><span class="MJXp-mo" id="MJXp-Span-2579" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2580">k</span><span class="MJXp-mo" id="MJXp-Span-2581" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2582">r</span><span class="MJXp-mo" id="MJXp-Span-2583" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-377">f(k, r)</script> efficiently.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2.3</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2585">p</span></span></span><script type="math/tex" id="MathJax-Element-378">p</script> be the (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2586"><span class="MJXp-mn" id="MJXp-Span-2587">0</span></span></span><script type="math/tex" id="MathJax-Element-379">0</script>-indexed) position of the least significant bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2589">k</span></span></span><script type="math/tex" id="MathJax-Element-380">k</script>.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2591">c</span><span class="MJXp-mo" id="MJXp-Span-2592" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2593"><span class="MJXp-mo" id="MJXp-Span-2594" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-2595" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2596">r</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2597"><span class="MJXp-mn" id="MJXp-Span-2598" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2599" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2600">p</span><span class="MJXp-mo" id="MJXp-Span-2601">+</span><span class="MJXp-mn" id="MJXp-Span-2602">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2603" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌋</span></span></span></span></span><script type="math/tex" id="MathJax-Element-381">c = \left\lfloor \frac{r}{2^{p + 1}} \right\rfloor</script>. Then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2605">f</span><span class="MJXp-mo" id="MJXp-Span-2606" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2607">k</span><span class="MJXp-mo" id="MJXp-Span-2608" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2609">r</span><span class="MJXp-mo" id="MJXp-Span-2610" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2611" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-2612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2613">f</span><span class="MJXp-mo" id="MJXp-Span-2614" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2615">k</span><span class="MJXp-mo" id="MJXp-Span-2616" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2617">c</span><span class="MJXp-mo" id="MJXp-Span-2618" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2619"><span class="MJXp-mn" id="MJXp-Span-2620" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2621" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2622">p</span><span class="MJXp-mo" id="MJXp-Span-2623">+</span><span class="MJXp-mn" id="MJXp-Span-2624">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2625" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2626">1</span><span class="MJXp-mo" id="MJXp-Span-2627" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2628" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-2629"><span class=""><span class="MJXp-mo" id="MJXp-Span-2630" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2631" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2632">c</span><span class="MJXp-mo" id="MJXp-Span-2633">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2634"><span class="MJXp-mn" id="MJXp-Span-2635" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2636" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2637">p</span><span class="MJXp-mo" id="MJXp-Span-2638">+</span><span class="MJXp-mn" id="MJXp-Span-2639">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2640">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2641">j</span><span class="MJXp-mo" id="MJXp-Span-2642">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2643">r</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2644">s</span><span class="MJXp-mo" id="MJXp-Span-2645" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2646">k</span><span class="MJXp-mo" id="MJXp-Span-2647" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2648">j</span><span class="MJXp-mo" id="MJXp-Span-2649" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-382">f(k, r) = \displaystyle f(k, c \cdot 2^{p+1} - 1) + \sum_{c \cdot 2^{p + 1} \leq j \leq r} s(k, j)</script></p><p>Due to cancellation of terms, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2651">f</span><span class="MJXp-mo" id="MJXp-Span-2652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2653">k</span><span class="MJXp-mo" id="MJXp-Span-2654" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2655">c</span><span class="MJXp-mo" id="MJXp-Span-2656" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2657"><span class="MJXp-mn" id="MJXp-Span-2658" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2659" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2660">p</span><span class="MJXp-mo" id="MJXp-Span-2661">+</span><span class="MJXp-mn" id="MJXp-Span-2662">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2663" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2664">1</span><span class="MJXp-mo" id="MJXp-Span-2665" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2666" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2667">0</span></span></span><script type="math/tex" id="MathJax-Element-383">f(k, c \cdot 2^{p+1} - 1) = 0</script>.</p><p>We can also see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2669">s</span><span class="MJXp-mo" id="MJXp-Span-2670" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2671">k</span><span class="MJXp-mo" id="MJXp-Span-2672" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2673">j</span><span class="MJXp-mo" id="MJXp-Span-2674" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2675" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2676">s</span><span class="MJXp-mo" id="MJXp-Span-2677" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2678"><span class="MJXp-mn" id="MJXp-Span-2679" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2680" style="vertical-align: 0.5em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-2681" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2682">j</span><span class="MJXp-mo" id="MJXp-Span-2683" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2684" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685">s</span><span class="MJXp-mrow" id="MJXp-Span-2686"><span class="MJXp-mo" id="MJXp-Span-2687" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2688"><span class="MJXp-mo" id="MJXp-Span-2689" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-2690" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2691">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2692"><span class="MJXp-mn" id="MJXp-Span-2693" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2694" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2695">p</span><span class="MJXp-mo" id="MJXp-Span-2696">+</span><span class="MJXp-mn" id="MJXp-Span-2697">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2698" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌋</span></span></span><span class="MJXp-mo" id="MJXp-Span-2699" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2700"><span class="MJXp-mo" id="MJXp-Span-2701" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-2702" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2703">j</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2704"><span class="MJXp-mn" id="MJXp-Span-2705" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2706" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2707">p</span><span class="MJXp-mo" id="MJXp-Span-2708">+</span><span class="MJXp-mn" id="MJXp-Span-2709">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2710" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌋</span></span></span><span class="MJXp-mo" id="MJXp-Span-2711" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2712" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2713">s</span><span class="MJXp-mo" id="MJXp-Span-2714" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2715"><span class="MJXp-mn" id="MJXp-Span-2716" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2717" style="vertical-align: 0.5em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-2718" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2719">j</span><span class="MJXp-mo" id="MJXp-Span-2720" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2721" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2722">s</span><span class="MJXp-mrow" id="MJXp-Span-2723"><span class="MJXp-mo" id="MJXp-Span-2724" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2725"><span class="MJXp-mo" id="MJXp-Span-2726" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-2727" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2728">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2729"><span class="MJXp-mn" id="MJXp-Span-2730" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2731" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2732">p</span><span class="MJXp-mo" id="MJXp-Span-2733">+</span><span class="MJXp-mn" id="MJXp-Span-2734">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2735" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌋</span></span></span><span class="MJXp-mo" id="MJXp-Span-2736" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2737">c</span><span class="MJXp-mo" id="MJXp-Span-2738" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-384">s(k, j) = s(2^p, j) \cdot s\left(\left\lfloor \frac{k}{2^{p + 1}} \right\rfloor, \left\lfloor \frac{j}{2^{p + 1}} \right\rfloor\right) = s(2^p, j) \cdot s\left(\left\lfloor \frac{k}{2^{p + 1}} \right\rfloor, c\right)</script></p><p>Therefore, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2739"><span class="MJXp-mstyle" id="MJXp-Span-2740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2741">f</span><span class="MJXp-mo" id="MJXp-Span-2742" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2743">k</span><span class="MJXp-mo" id="MJXp-Span-2744" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2745">r</span><span class="MJXp-mo" id="MJXp-Span-2746" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2747" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2748"><span class="MJXp-mo" id="MJXp-Span-2749" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.764em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.058em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-2750"><span class=""><span class="MJXp-mo" id="MJXp-Span-2751" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2752" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2753">c</span><span class="MJXp-mo" id="MJXp-Span-2754">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2755"><span class="MJXp-mn" id="MJXp-Span-2756" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2757" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2758">p</span><span class="MJXp-mo" id="MJXp-Span-2759">+</span><span class="MJXp-mn" id="MJXp-Span-2760">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2761">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2762">j</span><span class="MJXp-mo" id="MJXp-Span-2763">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2764">r</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2765">s</span><span class="MJXp-mo" id="MJXp-Span-2766" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2767"><span class="MJXp-mn" id="MJXp-Span-2768" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2769" style="vertical-align: 0.5em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-2770" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2771">j</span><span class="MJXp-mo" id="MJXp-Span-2772" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2773" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.764em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.058em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2774" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2775">s</span><span class="MJXp-mrow" id="MJXp-Span-2776"><span class="MJXp-mo" id="MJXp-Span-2777" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2778"><span class="MJXp-mo" id="MJXp-Span-2779" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-2780" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2781">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2782"><span class="MJXp-mn" id="MJXp-Span-2783" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2784" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2785">p</span><span class="MJXp-mo" id="MJXp-Span-2786">+</span><span class="MJXp-mn" id="MJXp-Span-2787">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2788" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌋</span></span></span><span class="MJXp-mo" id="MJXp-Span-2789" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2790">c</span><span class="MJXp-mo" id="MJXp-Span-2791" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">)</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-385">\displaystyle f(k, r) = \left(\sum_{c \cdot 2^{p + 1} \leq j \leq r} s(2^p, j)\right) \cdot s\left(\left\lfloor \frac{k}{2^{p + 1}} \right\rfloor, c\right)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2.4</b><div class="spoiler-content" style="display: block;"><p>Returning to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2793">F</span><span class="MJXp-mo" id="MJXp-Span-2794" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2796" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2797" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2798" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2799">x</span><span class="MJXp-mo" id="MJXp-Span-2800" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2801" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-386">F(A_i(x))</script>, we get:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2802"><span class="MJXp-mstyle" id="MJXp-Span-2803"><span class="MJXp-mo" id="MJXp-Span-2804" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2806" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2807" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2808" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2809">F</span><span class="MJXp-mo" id="MJXp-Span-2810" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2812" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2813" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2814" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2815">x</span><span class="MJXp-mo" id="MJXp-Span-2816" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2817" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2818" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2820" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2821" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2822" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2823">s</span><span class="MJXp-mo" id="MJXp-Span-2824" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2826" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2827" style="vertical-align: 0.5em;"><span class="MJXp-mspace" id="MJXp-Span-2828" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-2829">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-2830" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2832" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2833" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2834" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2835" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2837" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2838" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2839" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2840">s</span><span class="MJXp-mo" id="MJXp-Span-2841" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2843" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2844" style="vertical-align: 0.5em;"><span class="MJXp-mspace" id="MJXp-Span-2845" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-2846">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-2847" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2849" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2850" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2851" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-387">\displaystyle [x^k]F(A_i(x)) = a_i \cdot s(k^{\,\prime}, c_i) + b_i \cdot s(k^{\,\prime}, d_i)</script></center><p>where:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2852"><span class="MJXp-msubsup" id="MJXp-Span-2853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2854" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2855" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-388">a_i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2856"><span class="MJXp-msubsup" id="MJXp-Span-2857"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2858" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2859" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-389">b_i</script> are constants independent of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2861">k</span></span></span><script type="math/tex" id="MathJax-Element-390">k</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2862"><span class="MJXp-msubsup" id="MJXp-Span-2863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2864" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2865" style="vertical-align: 0.5em;"><span class="MJXp-mspace" id="MJXp-Span-2866" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-2867">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-2868" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2869"><span class="MJXp-mo" id="MJXp-Span-2870" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-2871" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2872">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2873"><span class="MJXp-mn" id="MJXp-Span-2874" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2875" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2876">p</span><span class="MJXp-mo" id="MJXp-Span-2877">+</span><span class="MJXp-mn" id="MJXp-Span-2878">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2879" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌋</span></span></span></span></span><script type="math/tex" id="MathJax-Element-391">k^{\,\prime} = \left\lfloor \frac{k}{2^{p + 1}} \right\rfloor</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2880"><span class="MJXp-msubsup" id="MJXp-Span-2881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2882" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2883" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2884" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2885"><span class="MJXp-mo" id="MJXp-Span-2886" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-2887" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2889" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2890" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2891"><span class="MJXp-mn" id="MJXp-Span-2892" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2893" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2894">p</span><span class="MJXp-mo" id="MJXp-Span-2895">+</span><span class="MJXp-mn" id="MJXp-Span-2896">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2897" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">⌋</span></span></span></span></span><script type="math/tex" id="MathJax-Element-392">c_i = \left\lfloor \frac{r_i}{2^{p + 1}} \right\rfloor</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2898"><span class="MJXp-msubsup" id="MJXp-Span-2899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2900" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2901" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2902" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2903"><span class="MJXp-mo" id="MJXp-Span-2904" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-2905" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2907" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2908" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2909">−</span><span class="MJXp-mn" id="MJXp-Span-2910">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2911"><span class="MJXp-mn" id="MJXp-Span-2912" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2913" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2914">p</span><span class="MJXp-mo" id="MJXp-Span-2915">+</span><span class="MJXp-mn" id="MJXp-Span-2916">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2917" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">⌋</span></span></span></span></span><script type="math/tex" id="MathJax-Element-393">d_i = \left\lfloor \frac{l_i - 1}{2^{p + 1}} \right\rfloor</script>.</li> </ul><p>But wait! This is just <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2918"><span class="MJXp-mo" id="MJXp-Span-2919" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2921" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2922" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2924" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2925" style="vertical-align: 0.5em;"><span class="MJXp-mspace" id="MJXp-Span-2926" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-2927">′</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2928" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2929">F</span><span class="MJXp-mo" id="MJXp-Span-2930" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2932" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2933" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2934" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2936" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2937" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2939" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2940" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2941" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2943" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2944" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2945" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2946"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2947" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2948" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2950" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2951" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2952" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-394">[x^{k^{\,\prime}}]F(a_i \cdot x^{c_i} + b_i \cdot x^{d_i})</script>. So we'll let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2953"><span class="MJXp-msubsup" id="MJXp-Span-2954"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2955" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2956" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2957" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2958">x</span><span class="MJXp-mo" id="MJXp-Span-2959" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2960" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2962" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2963" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2964" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2965"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2966" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2967" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2968"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2969" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2970" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2971" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2973" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2974" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2975" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2977" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2978" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2980" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2981" style="vertical-align: -0.4em;">i</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-395">B_i(x) = a_i \cdot x^{c_i} + b_i \cdot x^{d_i}</script>.</p><p>Therefore,</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2982"><span class="MJXp-mo" id="MJXp-Span-2983" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2985" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2986" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2987" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2988" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2989">F</span><span class="MJXp-mo" id="MJXp-Span-2990" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2992" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2993" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2994" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2995">x</span><span class="MJXp-mo" id="MJXp-Span-2996" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2997" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2998" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2999">F</span><span class="MJXp-mo" id="MJXp-Span-3000" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3002" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3003" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3004" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3005">x</span><span class="MJXp-mo" id="MJXp-Span-3006" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3007" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3008" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-3009" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3010" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3011">F</span><span class="MJXp-mo" id="MJXp-Span-3012" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3014" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3015" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-3016" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3017">x</span><span class="MJXp-mo" id="MJXp-Span-3018" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3019" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3020" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3021" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3022" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3024" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3025" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-3026"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3027" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3028" style="vertical-align: 0.5em;"><span class="MJXp-mspace" id="MJXp-Span-3029" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-3030">′</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3031" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3032">F</span><span class="MJXp-mo" id="MJXp-Span-3033" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3035" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3036" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3037" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3038">x</span><span class="MJXp-mo" id="MJXp-Span-3039" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3040" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-msubsup" id="MJXp-Span-3041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3042" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3043" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3044" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3045">x</span><span class="MJXp-mo" id="MJXp-Span-3046" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3047" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-mo" id="MJXp-Span-3048" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3049" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-msubsup" id="MJXp-Span-3050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3051" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3052" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-3053" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3054">x</span><span class="MJXp-mo" id="MJXp-Span-3055" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3056" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-396">[x^k](F(A_1(x)) \cdot F(A_2(x)) \cdot \ldots \cdot F(A_n(x))) = [x^{k^{\,\prime}}]F(B_1(x) \star B_2(x) \star \ldots \star B_n(x))</script></center><p>Now we need to find a way to compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3058">F</span><span class="MJXp-mo" id="MJXp-Span-3059" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3061" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3062" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3063" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3064">x</span><span class="MJXp-mo" id="MJXp-Span-3065" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3066" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-msubsup" id="MJXp-Span-3067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3068" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3069" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3070" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3071">x</span><span class="MJXp-mo" id="MJXp-Span-3072" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3073" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-mo" id="MJXp-Span-3074" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3075" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-msubsup" id="MJXp-Span-3076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3077" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3078" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-3079" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3080">x</span><span class="MJXp-mo" id="MJXp-Span-3081" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3082" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-397">F(B_1(x) \star B_2(x) \star \ldots \star B_n(x))</script> efficiently.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3.1</b><div class="spoiler-content" style="display: block;"><p>First, we can normalize each polynomial: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3084">a</span><span class="MJXp-mo" id="MJXp-Span-3085" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3086"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3087" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3088" style="vertical-align: 0.5em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-3089" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3090">b</span><span class="MJXp-mo" id="MJXp-Span-3091" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3093" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3094" style="vertical-align: 0.5em;">d</span></span><span class="MJXp-mo" id="MJXp-Span-3095" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3096" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3097">a</span><span class="MJXp-mo" id="MJXp-Span-3098" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3099">b</span><span class="MJXp-mo" id="MJXp-Span-3100" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3102" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3103" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3104">c</span><span class="MJXp-mspace" id="MJXp-Span-3105" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3106">⊕</span><span class="MJXp-mspace" id="MJXp-Span-3107" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3108">d</span></span></span><span class="MJXp-mo" id="MJXp-Span-3109" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3110" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-msubsup" id="MJXp-Span-3111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3112" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3113" style="vertical-align: 0.5em;">c</span></span></span></span><script type="math/tex" id="MathJax-Element-398">a \cdot x^c + b \cdot x^d = (a + b \cdot x^{c\,\oplus\,d}) \star x^c</script></p><p>Now all polynomials have the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3114"><span class="MJXp-msubsup" id="MJXp-Span-3115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3116" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3117" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3118" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3120" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3121" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3122" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3124" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3125" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-3126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3127" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3128" style="vertical-align: -0.4em;">i</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-399">a_i + b_i \cdot x^{c_i}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3.2</b><div class="spoiler-content" style="display: block;"><p>Next, we can convolve polynomials with matching powers of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3130">x</span></span></span><script type="math/tex" id="MathJax-Element-400">x</script>:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3131"><span class="MJXp-mo" id="MJXp-Span-3132" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3134" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3135" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3136" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3138" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3139" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3140" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3142" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3143" style="vertical-align: 0.5em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-3144" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3145" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-mo" id="MJXp-Span-3146" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3148" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3149" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3150" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3152" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3153" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3154" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3156" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3157" style="vertical-align: 0.5em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-3158" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3159" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3160" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3162" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3163" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-3164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3165" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3166" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3167" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3169" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3170" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-3171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3172" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3173" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3174" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3175" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-3176" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3178" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3179" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-3180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3181" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3182" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3183" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3185" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3186" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-3187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3188" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3189" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3190" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3191" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3193" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3194" style="vertical-align: 0.5em;">c</span></span></span></span><script type="math/tex" id="MathJax-Element-401">(a_1 + b_1 \cdot x^c) \star (a_2 + b_2 \cdot x^c) = (a_1 a_2 + b_1 b_2) + (a_1 b_2 + b_1 a_2) \cdot x^c </script></center><p>Now the expression is of the form:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3196">F</span><span class="MJXp-mo" id="MJXp-Span-3197" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-3198" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3200" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3201" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3202" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3204" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3205" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3206" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3208" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3209" style="vertical-align: 0.5em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3210" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3211" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-mo" id="MJXp-Span-3212" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3214" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3215" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3216" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3218" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3219" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3220" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3222" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3223" style="vertical-align: 0.5em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3224" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3225" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-mo" id="MJXp-Span-3226" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3227" style="margin-left: 0.267em; margin-right: 0.267em;">⋆</span><span class="MJXp-mo" id="MJXp-Span-3228" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3230" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3231" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3232"><span class="MJXp-mn" id="MJXp-Span-3233" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3234" style="vertical-align: 0.5em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-3235">−</span><span class="MJXp-mn" id="MJXp-Span-3236">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3237" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3239" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3240" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3241"><span class="MJXp-mn" id="MJXp-Span-3242" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3243" style="vertical-align: 0.5em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-3244">−</span><span class="MJXp-mn" id="MJXp-Span-3245">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3246" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3248" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3249" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-3250"><span class="MJXp-mn" id="MJXp-Span-3251" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3252" style="vertical-align: 0.5em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-3253">−</span><span class="MJXp-mn" id="MJXp-Span-3254">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3255" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3256" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3257" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3258">F</span><span class="MJXp-mo" id="MJXp-Span-3259" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3261" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3262" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3263" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3264" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3265">F</span><span class="MJXp-mo" id="MJXp-Span-3266" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3268" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3269" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3270" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3271" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-3272" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3273" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3274">F</span><span class="MJXp-mo" id="MJXp-Span-3275" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3277" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3278" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3279"><span class="MJXp-mn" id="MJXp-Span-3280" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3281" style="vertical-align: 0.5em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-3282">−</span><span class="MJXp-mn" id="MJXp-Span-3283">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3284" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-402">F((a_0 + b_0 \cdot x^0) \star (a_1 + b_1 \cdot x^1) \star \ldots \star (a_{2^m - 1} + b_{2^m - 1} \cdot x^{2^m - 1})) = F(B_0) \cdot F(B_1) \cdot \ldots \cdot F(B_{2^m - 1})</script></center></div></div> <div class="spoiler"><b class="spoiler-title">Step 3.3</b><div class="spoiler-content" style="display: block;"><p>Finally, we have:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3285"><span class="MJXp-mstyle" id="MJXp-Span-3286"><span class="MJXp-mo" id="MJXp-Span-3287" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3289" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3290" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-3291" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3292" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3293">F</span><span class="MJXp-mo" id="MJXp-Span-3294" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3296" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3297" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3298" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3299" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3300">F</span><span class="MJXp-mo" id="MJXp-Span-3301" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3303" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3304" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3305" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3306" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-3307" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3308" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3309">F</span><span class="MJXp-mo" id="MJXp-Span-3310" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3312" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3313" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3314"><span class="MJXp-mn" id="MJXp-Span-3315" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3316" style="vertical-align: 0.5em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-3317">−</span><span class="MJXp-mn" id="MJXp-Span-3318">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3319" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3320" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3321" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3322"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3328" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-msubsup" id="MJXp-Span-3329"><span class="MJXp-mn" id="MJXp-Span-3330" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3331" style="vertical-align: 0.5em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-3332">−</span><span class="MJXp-mn" id="MJXp-Span-3333">1</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-3323" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3324" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3325">i</span><span class="MJXp-mo" id="MJXp-Span-3326">=</span><span class="MJXp-mn" id="MJXp-Span-3327">0</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3334" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3336" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3337" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3338" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3340" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3341" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3342" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3343">s</span><span class="MJXp-mo" id="MJXp-Span-3344" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3345">k</span><span class="MJXp-mo" id="MJXp-Span-3346" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3347">i</span><span class="MJXp-mo" id="MJXp-Span-3348" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3349" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-403">\displaystyle [x^k] (F(B_0) \cdot F(B_1) \cdot \ldots \cdot F(B_{2^m - 1})) = \prod_{i = 0}^{2^m - 1} (a_i + b_i \cdot s(k, i))</script></center><p>This can be computed using SOS DP.</p></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2096" class="notice" style="text-decoration: none;">Neowise Labs Contest 1 (Codeforces Round 1018, Div. 1 + Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>