{
  "contestId": 2126,
  "index": "G2",
  "title": "Big Wins! (hard version)",
  "timeLimit": "4 seconds",
  "memoryLimit": "256 megabytes",
  "rating": 2400,
  "tags": [
    "binary search",
    "data structures",
    "divide and conquer",
    "dsu",
    "trees",
    "two pointers"
  ],
  "statementHtml": "<p><span class=\"tex-font-style-bf\">This is the hard version of the problem. The difference between the versions is that in this version <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1\" style=\"width: 3.736em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.817em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1002.82em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"msubsup\" id=\"MathJax-Span-3\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-5\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-7\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub><mo>≤</mo><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-1\">a_i \\leq n</script>.</span></p>\n<p>You are given an array of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-8\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-9\"><span class=\"mi\" id=\"MathJax-Span-10\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-2\">n</script> integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-11\" style=\"width: 7.47em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.63em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.572em, 1005.63em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-12\"><span class=\"msubsup\" id=\"MathJax-Span-13\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-14\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-15\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-16\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-17\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-18\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-19\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-20\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-21\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-22\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-23\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-24\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-25\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-3\">a_1, a_2, \\dots, a_n</script>.</p>\n<p>Your task is to find a subarray <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-26\" style=\"width: 3.033em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.17em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-27\"><span class=\"mi\" id=\"MathJax-Span-28\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-29\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-30\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-31\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-32\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-33\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi><mo stretchy=\"false\">[</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-4\">a[l, r]</script> (a continuous sequence of elements <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-34\" style=\"width: 8.065em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.117em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.572em, 1006.12em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-35\"><span class=\"msubsup\" id=\"MathJax-Span-36\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-37\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-38\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">l</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-39\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-40\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.734em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-41\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"texatom\" id=\"MathJax-Span-42\"><span class=\"mrow\" id=\"MathJax-Span-43\"><span class=\"mi\" id=\"MathJax-Span-44\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-45\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">+</span><span class=\"mn\" id=\"MathJax-Span-46\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-47\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-48\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-49\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-50\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-51\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-52\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">r</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>l</mi></msub><mo>,</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>r</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-5\">a_l, a_{l + 1}, \\dots, a_r</script>) for which the value of the expression <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;med&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;min&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-53\" style=\"width: 14.288em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.825em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1010.72em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-54\"><span class=\"mtext\" id=\"MathJax-Span-55\" style=\"font-family: MathJax_Main;\">med</span><span class=\"mo\" id=\"MathJax-Span-56\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-58\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-59\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-60\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-61\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-62\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-63\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-64\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mo\" id=\"MathJax-Span-65\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">min</span><span class=\"mo\" id=\"MathJax-Span-66\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-67\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-68\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-69\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-70\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-71\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-72\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-73\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>med</mtext><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">[</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>−</mo><mo movablelimits=\"true\" form=\"prefix\">min</mo><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">[</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">\\text{med}(a[l, r]) - \\min(a[l, r])</script> is maximized.</p>\n<p>Here: </p>\n<p>For example, consider the array <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-94\" style=\"width: 10.068em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.633em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1007.52em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-95\"><span class=\"mi\" id=\"MathJax-Span-96\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-97\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-98\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">[</span><span class=\"mn\" id=\"MathJax-Span-99\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-100\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-101\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-102\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-103\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-104\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-105\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">5</span><span class=\"mo\" id=\"MathJax-Span-106\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-107\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-108\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-109\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-110\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi><mo>=</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">a=[1, 4, 1, 5, 3, 3]</script> and choose the subarray <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-111\" style=\"width: 10.23em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.741em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1007.63em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-112\"><span class=\"mi\" id=\"MathJax-Span-113\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-114\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-115\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-116\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-117\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">5</span><span class=\"mo\" id=\"MathJax-Span-118\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-119\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-120\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">[</span><span class=\"mn\" id=\"MathJax-Span-121\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-122\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-123\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-124\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-125\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">5</span><span class=\"mo\" id=\"MathJax-Span-126\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-127\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-128\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mn>5</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mo stretchy=\"false\">[</mo><mn>4</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">a[2, 5] = [4, 1, 5, 3]</script>. In sorted form, it looks like <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-129\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-130\"><span class=\"mo\" id=\"MathJax-Span-131\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-132\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-133\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-134\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-135\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-136\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-137\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-138\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">5</span><span class=\"mo\" id=\"MathJax-Span-139\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">[1, 3, 4, 5]</script>.</p>\n<p>In this example, the value <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;med&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;min&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-184\" style=\"width: 13.314em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.068em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1010.01em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-185\"><span class=\"mtext\" id=\"MathJax-Span-186\" style=\"font-family: MathJax_Main;\">med</span><span class=\"mo\" id=\"MathJax-Span-187\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mo\" id=\"MathJax-Span-188\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">min</span><span class=\"mo\" id=\"MathJax-Span-189\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-190\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">4</span><span class=\"mo\" id=\"MathJax-Span-191\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-192\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-193\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-194\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">3</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>med</mtext><mo>−</mo><mo movablelimits=\"true\" form=\"prefix\">min</mo><mo>=</mo><mn>4</mn><mo>−</mo><mn>1</mn><mo>=</mo><mn>3</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">\\text{med} - \\min = 4 - 1 = 3</script>.</p>",
  "inputSpecHtml": "<p>The first line contains an integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-195\" style=\"width: 0.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.33em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-196\"><span class=\"mi\" id=\"MathJax-Span-197\" style=\"font-family: MathJax_Math-italic;\">t</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-198\" style=\"width: 6.496em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.927em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1004.93em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-199\"><span class=\"mn\" id=\"MathJax-Span-200\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-201\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-202\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">t</span><span class=\"mo\" id=\"MathJax-Span-203\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-204\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-205\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-206\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">4</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><msup><mn>10</mn><mn>4</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">1 \\le t \\le 10^4</script>) — the number of test cases.</p><p>The first line of each test case contains one integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-207\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-208\"><span class=\"mi\" id=\"MathJax-Span-209\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-210\" style=\"width: 8.444em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.388em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1006.39em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-211\"><span class=\"mn\" id=\"MathJax-Span-212\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-213\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-214\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-215\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-216\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2</span><span class=\"mo\" id=\"MathJax-Span-217\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-218\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-219\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-220\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">5</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mn>2</mn><mo>⋅</mo><msup><mn>10</mn><mn>5</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-23\">1 \\leq n \\leq 2 \\cdot 10^5</script>) — the length of the array.</p><p>The second line of each test case contains <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-221\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-222\"><span class=\"mi\" id=\"MathJax-Span-223\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-24\">n</script> integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-224\" style=\"width: 7.47em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.63em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.572em, 1005.63em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-225\"><span class=\"msubsup\" id=\"MathJax-Span-226\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-227\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-228\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-229\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-230\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-231\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-232\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-233\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-234\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-235\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-236\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-237\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-238\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">a_1, a_2, \\dots, a_n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-239\" style=\"width: 6.117em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.602em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.6em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-240\"><span class=\"mn\" id=\"MathJax-Span-241\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-242\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-243\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-244\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-245\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-246\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-247\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><msub><mi>a</mi><mi>i</mi></msub><mo>≤</mo><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">1 \\leq a_i \\leq n</script>) — the elements of the array.</p><p>It is guaranteed that the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-248\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-249\"><span class=\"mi\" id=\"MathJax-Span-250\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">n</script> across all test cases does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-251\" style=\"width: 3.52em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.654em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1002.65em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-252\"><span class=\"mn\" id=\"MathJax-Span-253\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-254\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-255\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-256\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-257\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">5</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>2</mn><mo>⋅</mo><msup><mn>10</mn><mn>5</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">2 \\cdot 10^5</script>.</p>",
  "outputSpecHtml": "<p>For each test case, output one integer — the maximum possible value of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;med&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;min&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-258\" style=\"width: 6.226em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.71em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1004.71em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-259\"><span class=\"mtext\" id=\"MathJax-Span-260\" style=\"font-family: MathJax_Main;\">med</span><span class=\"mo\" id=\"MathJax-Span-261\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mo\" id=\"MathJax-Span-262\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">min</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>med</mtext><mo>−</mo><mo movablelimits=\"true\" form=\"prefix\">min</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">\\text{med} - \\min</script> among all subarrays of the array.</p>",
  "noteHtml": "<p>In the first example, consider the array: <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-263\" style=\"width: 10.176em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.687em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1007.58em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-264\"><span class=\"mi\" id=\"MathJax-Span-265\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-266\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-267\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">[</span><span class=\"mn\" id=\"MathJax-Span-268\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-269\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-270\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-271\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-272\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-273\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-274\" style=\"font-family: MathJax_Main;\">5</span><span class=\"mo\" id=\"MathJax-Span-275\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-276\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-277\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-278\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-279\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-280\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-281\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi><mo>=</mo><mo stretchy=\"false\">[</mo><mn>3</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>2</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>5</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>3</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">a=[3,\\ 2,\\ 5,\\ 3,\\ 1]</script> you can choose the subarray <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-282\" style=\"width: 3.682em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.762em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.65em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-283\"><span class=\"mi\" id=\"MathJax-Span-284\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-285\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-286\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-287\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-288\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-289\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-290\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>3</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">a[2,\\ 3]</script>, that is, the elements <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-291\" style=\"width: 3.033em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.17em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-292\"><span class=\"mo\" id=\"MathJax-Span-293\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-294\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-295\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-296\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-297\" style=\"font-family: MathJax_Main;\">5</span><span class=\"mo\" id=\"MathJax-Span-298\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>5</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-32\">[2,\\ 5]</script>.</p><ul> <li> The length of the subarray is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-299\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-300\"><span class=\"mn\" id=\"MathJax-Span-301\" style=\"font-family: MathJax_Main;\">2</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>2</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">2</script>. </li><li> The median is the element at position <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2308;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2309;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-302\" style=\"width: 5.035em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.791em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.788em, 1003.74em, 4.548em, -999.997em); top: -3.406em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-303\"><span class=\"mrow\" id=\"MathJax-Span-304\"><span class=\"mo\" id=\"MathJax-Span-305\" style=\"vertical-align: 0em;\"><span style=\"font-family: MathJax_Size3;\">⌈</span></span><span class=\"mstyle\" id=\"MathJax-Span-306\"><span class=\"mrow\" id=\"MathJax-Span-307\"><span class=\"mfrac\" id=\"MathJax-Span-308\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.268em;\"><span class=\"mn\" id=\"MathJax-Span-309\" style=\"font-family: MathJax_Main;\">3</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.268em;\"><span class=\"mn\" id=\"MathJax-Span-310\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(0.869em, 1000.6em, 1.247em, -999.997em); top: -1.296em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.598em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.085em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-311\" style=\"vertical-align: 0em;\"><span style=\"font-family: MathJax_Size3;\">⌉</span></span></span><span class=\"mo\" id=\"MathJax-Span-312\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-313\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2</span></span><span style=\"display: inline-block; width: 0px; height: 3.412em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.354em; border-left: 0px solid; width: 0px; height: 3.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow><mo>⌈</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>3</mn><mn>2</mn></mfrac></mstyle><mo>⌉</mo></mrow><mo>=</mo><mn>2</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-34\">\\left\\lceil \\dfrac{3}{2} \\right\\rceil = 2</script> in the sorted subarray. After sorting, we get <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-314\" style=\"width: 3.033em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.17em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-315\"><span class=\"mo\" id=\"MathJax-Span-316\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-317\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-318\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-319\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-320\" style=\"font-family: MathJax_Main;\">5</span><span class=\"mo\" id=\"MathJax-Span-321\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>5</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-35\">[2,\\ 5]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;med&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-322\" style=\"width: 4.873em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.682em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1003.63em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-323\"><span class=\"mtext\" id=\"MathJax-Span-324\" style=\"font-family: MathJax_Main;\">med</span><span class=\"mo\" id=\"MathJax-Span-325\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-326\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">5</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>med</mtext><mo>=</mo><mn>5</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-36\">\\text{med} = 5</script>. </li><li> The minimum element of the subarray: <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;min&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-327\" style=\"width: 4.602em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.466em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1003.41em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-328\"><span class=\"mo\" id=\"MathJax-Span-329\" style=\"font-family: MathJax_Main;\">min</span><span class=\"mo\" id=\"MathJax-Span-330\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-331\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo movablelimits=\"true\" form=\"prefix\">min</mo><mo>=</mo><mn>2</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-37\">\\min = 2</script>. </li></ul><p>Therefore, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;med&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;min&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-332\" style=\"width: 13.314em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.068em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1010.01em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-333\"><span class=\"mtext\" id=\"MathJax-Span-334\" style=\"font-family: MathJax_Main;\">med</span><span class=\"mo\" id=\"MathJax-Span-335\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mo\" id=\"MathJax-Span-336\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">min</span><span class=\"mo\" id=\"MathJax-Span-337\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-338\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">5</span><span class=\"mo\" id=\"MathJax-Span-339\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-340\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">2</span><span class=\"mo\" id=\"MathJax-Span-341\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-342\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">3</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>med</mtext><mo>−</mo><mo movablelimits=\"true\" form=\"prefix\">min</mo><mo>=</mo><mn>5</mn><mo>−</mo><mn>2</mn><mo>=</mo><mn>3</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">\\text{med} - \\min = 5 - 2 = 3</script>, which is the maximum answer.</p><p>In the second test, the array: <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-343\" style=\"width: 8.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.496em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1006.39em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-344\"><span class=\"mi\" id=\"MathJax-Span-345\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-346\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-347\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">[</span><span class=\"mn\" id=\"MathJax-Span-348\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-349\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-350\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-351\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-352\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-353\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-354\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-355\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-356\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-357\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-358\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi><mo>=</mo><mo stretchy=\"false\">[</mo><mn>4</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>1</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>1</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>3</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\">a=[4,\\ 1,\\ 1,\\ 3]</script> you can choose the subarray <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-359\" style=\"width: 3.682em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.762em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.65em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-360\"><span class=\"mi\" id=\"MathJax-Span-361\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-362\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-363\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-364\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-365\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-366\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-367\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>2</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">a[1,\\ 2]</script>, that is, the elements <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-368\" style=\"width: 3.033em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.17em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-369\"><span class=\"mo\" id=\"MathJax-Span-370\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-371\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-372\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-373\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-374\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-375\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>4</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">[4,\\ 1]</script>.</p><ul> <li> The length of the subarray is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-376\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-377\"><span class=\"mn\" id=\"MathJax-Span-378\" style=\"font-family: MathJax_Main;\">2</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>2</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">2</script>. </li><li> The median is the element at position <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2308;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2309;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-379\" style=\"width: 5.035em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.791em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.788em, 1003.74em, 4.548em, -999.997em); top: -3.406em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-380\"><span class=\"mrow\" id=\"MathJax-Span-381\"><span class=\"mo\" id=\"MathJax-Span-382\" style=\"vertical-align: 0em;\"><span style=\"font-family: MathJax_Size3;\">⌈</span></span><span class=\"mstyle\" id=\"MathJax-Span-383\"><span class=\"mrow\" id=\"MathJax-Span-384\"><span class=\"mfrac\" id=\"MathJax-Span-385\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.268em;\"><span class=\"mn\" id=\"MathJax-Span-386\" style=\"font-family: MathJax_Main;\">3</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.268em;\"><span class=\"mn\" id=\"MathJax-Span-387\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(0.869em, 1000.6em, 1.247em, -999.997em); top: -1.296em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.598em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.085em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-388\" style=\"vertical-align: 0em;\"><span style=\"font-family: MathJax_Size3;\">⌉</span></span></span><span class=\"mo\" id=\"MathJax-Span-389\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-390\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2</span></span><span style=\"display: inline-block; width: 0px; height: 3.412em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.354em; border-left: 0px solid; width: 0px; height: 3.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow><mo>⌈</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>3</mn><mn>2</mn></mfrac></mstyle><mo>⌉</mo></mrow><mo>=</mo><mn>2</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\">\\left\\lceil \\dfrac{3}{2} \\right\\rceil = 2</script> in the sorted subarray. After sorting, we get <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-391\" style=\"width: 3.033em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.17em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-392\"><span class=\"mo\" id=\"MathJax-Span-393\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-394\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-395\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mtext\" id=\"MathJax-Span-396\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">&nbsp;</span><span class=\"mn\" id=\"MathJax-Span-397\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-398\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mtext>&nbsp;</mtext><mn>4</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">[1,\\ 4]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;med&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-399\" style=\"width: 4.873em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.682em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1003.63em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-400\"><span class=\"mtext\" id=\"MathJax-Span-401\" style=\"font-family: MathJax_Main;\">med</span><span class=\"mo\" id=\"MathJax-Span-402\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-403\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">4</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>med</mtext><mo>=</mo><mn>4</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">\\text{med} = 4</script>. </li><li> The minimum element of the subarray: <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-46-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;min&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-404\" style=\"width: 4.602em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.466em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1003.41em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-405\"><span class=\"mo\" id=\"MathJax-Span-406\" style=\"font-family: MathJax_Main;\">min</span><span class=\"mo\" id=\"MathJax-Span-407\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-408\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo movablelimits=\"true\" form=\"prefix\">min</mo><mo>=</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-46\">\\min = 1</script>. </li></ul><p>Therefore, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-47-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;med&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;min&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-409\" style=\"width: 13.314em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.068em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1010.01em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-410\"><span class=\"mtext\" id=\"MathJax-Span-411\" style=\"font-family: MathJax_Main;\">med</span><span class=\"mo\" id=\"MathJax-Span-412\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mo\" id=\"MathJax-Span-413\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">min</span><span class=\"mo\" id=\"MathJax-Span-414\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-415\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">4</span><span class=\"mo\" id=\"MathJax-Span-416\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-417\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-418\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-419\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">3</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>med</mtext><mo>−</mo><mo movablelimits=\"true\" form=\"prefix\">min</mo><mo>=</mo><mn>4</mn><mo>−</mo><mn>1</mn><mo>=</mo><mn>3</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-47\">\\text{med} - \\min = 4 - 1 = 3</script>.</p><p>It can be proven that both of these subarrays are optimal and yield the maximum value of the expression <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-48-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;med&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;min&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-420\" style=\"width: 6.226em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.71em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1004.71em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-421\"><span class=\"mtext\" id=\"MathJax-Span-422\" style=\"font-family: MathJax_Main;\">med</span><span class=\"mo\" id=\"MathJax-Span-423\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mo\" id=\"MathJax-Span-424\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">min</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>med</mtext><mo>−</mo><mo movablelimits=\"true\" form=\"prefix\">min</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-48\">\\text{med} - \\min</script>.</p>",
  "samples": [
    {
      "input": "553 2 5 3 144 1 1 376 1 3 4 6 2 744 2 3 151 2 3 4 5",
      "output": "3\n3\n5\n2\n2"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2126/problem/G2",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>Goal: maximise  <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-346-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3261\" style=\"width: 24.678em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 18.672em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1018.56em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3262\"><span class=\"mi\" id=\"MathJax-Span-3263\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3264\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3265\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3266\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3267\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3268\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3269\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3270\" style=\"font-family: MathJax_Math-italic;\">s</span><span class=\"mi\" id=\"MathJax-Span-3271\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mi\" id=\"MathJax-Span-3272\" style=\"font-family: MathJax_Math-italic;\">b</span><span class=\"mi\" id=\"MathJax-Span-3273\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3274\" style=\"font-family: MathJax_Math-italic;\">r</span><span class=\"mi\" id=\"MathJax-Span-3275\" style=\"font-family: MathJax_Math-italic;\">r</span><span class=\"mi\" id=\"MathJax-Span-3276\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3277\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3278\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-3279\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mo\" id=\"MathJax-Span-3280\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">−</span><span class=\"mo\" id=\"MathJax-Span-3281\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3282\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mi\" id=\"MathJax-Span-3283\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3284\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mi\" id=\"MathJax-Span-3285\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3286\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3287\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mi\" id=\"MathJax-Span-3288\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mo\" id=\"MathJax-Span-3289\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3290\" style=\"font-family: MathJax_Math-italic;\">s</span><span class=\"mi\" id=\"MathJax-Span-3291\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mi\" id=\"MathJax-Span-3292\" style=\"font-family: MathJax_Math-italic;\">b</span><span class=\"mi\" id=\"MathJax-Span-3293\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3294\" style=\"font-family: MathJax_Math-italic;\">r</span><span class=\"mi\" id=\"MathJax-Span-3295\" style=\"font-family: MathJax_Math-italic;\">r</span><span class=\"mi\" id=\"MathJax-Span-3296\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3297\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3298\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-346\">median(subarray) − minimum(subarray)</script>. Treat the minimum as the \"left pointer\" <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-347-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3299\" style=\"width: 1.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.464em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1001.46em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3300\"><span class=\"mi\" id=\"MathJax-Span-3301\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3302\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-347\">mn</script> that we increase from <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-348-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3303\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3304\"><span class=\"mn\" id=\"MathJax-Span-3305\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-348\">1</script> up to max <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-349-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3306\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3307\"><span class=\"msubsup\" id=\"MathJax-Span-3308\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3309\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-3310\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-349\">a_i</script>. For every fixed <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-350-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3311\" style=\"width: 1.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.464em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1001.46em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3312\"><span class=\"mi\" id=\"MathJax-Span-3313\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3314\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-350\">mn</script> we try to push a second pointer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-351-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3315\" style=\"width: 2.438em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.843em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1001.84em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3316\"><span class=\"mi\" id=\"MathJax-Span-3317\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3318\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3319\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-351\">med</script> (the candidate median) as high as possible while some subarray exists whose minimum is exactly <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-352-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3320\" style=\"width: 1.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.464em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1001.46em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3321\"><span class=\"mi\" id=\"MathJax-Span-3322\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3323\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-352\">mn</script> and whose median is at least <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-353-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3324\" style=\"width: 2.438em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.843em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1001.84em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3325\"><span class=\"mi\" id=\"MathJax-Span-3326\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3327\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3328\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-353\">med</script>. The answer is the largest difference <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-354-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3329\" style=\"width: 6.28em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.765em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1004.76em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3330\"><span class=\"mi\" id=\"MathJax-Span-3331\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3332\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3333\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3334\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mo\" id=\"MathJax-Span-3335\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">−</span><span class=\"mo\" id=\"MathJax-Span-3336\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3337\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mi\" id=\"MathJax-Span-3338\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-354\">med − mn</script> reached during this sweep.</p><p>Fix a value <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-355-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3339\" style=\"width: 1.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.464em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1001.46em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3340\"><span class=\"mi\" id=\"MathJax-Span-3341\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3342\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-355\">mn</script>. Any subarray whose minimum equals <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-356-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3343\" style=\"width: 1.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.464em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1001.46em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3344\"><span class=\"mi\" id=\"MathJax-Span-3345\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3346\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-356\">mn</script> must contain at least one position <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-357-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3347\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3348\"><span class=\"mi\" id=\"MathJax-Span-3349\" style=\"font-family: MathJax_Math-italic;\">u</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-357\">u</script> with <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-358-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3350\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1003.9em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3351\"><span class=\"msubsup\" id=\"MathJax-Span-3352\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3353\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-3354\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">u</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3355\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mo\" id=\"MathJax-Span-3356\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">=</span><span class=\"mo\" id=\"MathJax-Span-3357\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3358\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mi\" id=\"MathJax-Span-3359\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-358\">a_u = mn</script>, and the whole subarray must lie inside the maximal span where that <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-359-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3360\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3361\"><span class=\"mi\" id=\"MathJax-Span-3362\" style=\"font-family: MathJax_Math-italic;\">u</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-359\">u</script> is the strict minimum. Those spans are computed once by the usual monotone stack: <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-360-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3363\" style=\"width: 2.384em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.788em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1001.73em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3364\"><span class=\"msubsup\" id=\"MathJax-Span-3365\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3366\" style=\"font-family: MathJax_Math-italic;\">l</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-3367\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">u</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3368\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-360\">l_u =</script> first index to the left that has <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-361-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3369\" style=\"width: 9.256em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.983em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1006.93em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3370\"><span class=\"mi\" id=\"MathJax-Span-3371\" style=\"font-family: MathJax_Math-italic;\">v</span><span class=\"mi\" id=\"MathJax-Span-3372\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3373\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mi\" id=\"MathJax-Span-3374\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mi\" id=\"MathJax-Span-3375\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mo\" id=\"MathJax-Span-3376\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">&lt;</span><span class=\"mo\" id=\"MathJax-Span-3377\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3378\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3379\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-3380\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mo\" id=\"MathJax-Span-3381\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-3382\" style=\"font-family: MathJax_Main;\">+</span><span class=\"mo\" id=\"MathJax-Span-3383\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mn\" id=\"MathJax-Span-3384\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-361\">value < a[u] + 1</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-362-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3385\" style=\"width: 2.6em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.572em, 1001.9em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3386\"><span class=\"msubsup\" id=\"MathJax-Span-3387\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3388\" style=\"font-family: MathJax_Math-italic;\">r</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-3389\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">u</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3390\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-362\">r_u = </script>first index to the right that has <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-363-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3391\" style=\"width: 8.39em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.334em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1006.28em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3392\"><span class=\"mi\" id=\"MathJax-Span-3393\" style=\"font-family: MathJax_Math-italic;\">v</span><span class=\"mi\" id=\"MathJax-Span-3394\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3395\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mi\" id=\"MathJax-Span-3396\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mi\" id=\"MathJax-Span-3397\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mo\" id=\"MathJax-Span-3398\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">&lt;</span><span class=\"mo\" id=\"MathJax-Span-3399\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"msubsup\" id=\"MathJax-Span-3400\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3401\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-3402\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">u</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3403\" style=\"font-family: MathJax_Main;\">−</span><span class=\"mo\" id=\"MathJax-Span-3404\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mn\" id=\"MathJax-Span-3405\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-363\">value < a_u - 1</script>.</p><p>For a potential median <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-364-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3406\" style=\"width: 1.356em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1001.03em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3407\"><span class=\"mi\" id=\"MathJax-Span-3408\" style=\"font-family: MathJax_Math-italic;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-364\">M</script> define an array <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-365-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3409\" style=\"width: 2.925em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.221em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1002.22em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3410\"><span class=\"mi\" id=\"MathJax-Span-3411\" style=\"font-family: MathJax_Math-italic;\">s</span><span class=\"mi\" id=\"MathJax-Span-3412\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3413\" style=\"font-family: MathJax_Math-italic;\">g<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3414\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3415\" style=\"font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-3416\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-365\">sign_i</script> = <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-366-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3417\" style=\"width: 1.734em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1001.25em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3418\"><span class=\"mo\" id=\"MathJax-Span-3419\" style=\"font-family: MathJax_Main;\">+</span><span class=\"mn\" id=\"MathJax-Span-3420\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-366\">+1</script> if <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-367-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3421\" style=\"width: 4.386em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.304em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1003.3em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3422\"><span class=\"msubsup\" id=\"MathJax-Span-3423\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3424\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-3425\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3426\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mo\" id=\"MathJax-Span-3427\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">≥</span><span class=\"mo\" id=\"MathJax-Span-3428\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3429\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-367\">a_i ≥ M</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-368-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3430\" style=\"width: 1.734em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1001.25em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3431\"><span class=\"mo\" id=\"MathJax-Span-3432\" style=\"font-family: MathJax_Main;\">−</span><span class=\"mn\" id=\"MathJax-Span-3433\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-368\">−1</script> otherwise. Inside any interval its median is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-369-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3434\" style=\"width: 2.817em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.113em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1002.11em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3435\"><span class=\"mo\" id=\"MathJax-Span-3436\" style=\"font-family: MathJax_Main;\">≥</span><span class=\"mo\" id=\"MathJax-Span-3437\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3438\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">M<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-369\">≥ M</script> exactly when the total sum of sign over that interval is positive (at least half the elements are high). Therefore, for a particular position <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-370-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3439\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3440\"><span class=\"mi\" id=\"MathJax-Span-3441\" style=\"font-family: MathJax_Math-italic;\">u</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-370\">u</script> to serve as the minimum we need</p><p><span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-371-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3442\" style=\"width: 34.797em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 26.356em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1026.3em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3443\"><span class=\"mi\" id=\"MathJax-Span-3444\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3445\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3446\" style=\"font-family: MathJax_Math-italic;\">x</span><span class=\"mi\" id=\"MathJax-Span-3447\" style=\"font-family: MathJax_Math-italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3448\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mi\" id=\"MathJax-Span-3449\" style=\"font-family: MathJax_Math-italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3450\" style=\"font-family: MathJax_Math-italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3451\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3452\" style=\"font-family: MathJax_Math-italic;\">x</span><span class=\"mo\" id=\"MathJax-Span-3453\" style=\"font-family: MathJax_Main;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3454\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3455\" style=\"font-family: MathJax_Math-italic;\">l</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-3456\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">u</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3457\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-3458\" style=\"padding-left: 0.165em;\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3459\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">u</span><span class=\"mo\" id=\"MathJax-Span-3460\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-3461\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3462\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-3463\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3464\" style=\"font-family: MathJax_Math-italic; padding-left: 0.219em;\">s</span><span class=\"mi\" id=\"MathJax-Span-3465\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3466\" style=\"font-family: MathJax_Math-italic;\">g<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3467\"><span style=\"display: inline-block; position: relative; width: 1.085em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3468\" style=\"font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-3469\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">u</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3470\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3471\" style=\"font-family: MathJax_Math-italic; padding-left: 0.219em;\">m</span><span class=\"mi\" id=\"MathJax-Span-3472\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3473\" style=\"font-family: MathJax_Math-italic;\">x</span><span class=\"mi\" id=\"MathJax-Span-3474\" style=\"font-family: MathJax_Math-italic;\">P<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.111em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3475\" style=\"font-family: MathJax_Math-italic;\">r</span><span class=\"mi\" id=\"MathJax-Span-3476\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3477\" style=\"font-family: MathJax_Math-italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3478\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3479\" style=\"font-family: MathJax_Math-italic;\">x</span><span class=\"mo\" id=\"MathJax-Span-3480\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3481\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mo\" id=\"MathJax-Span-3482\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-3483\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3484\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-3485\" style=\"padding-left: 0.165em;\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"msubsup\" id=\"MathJax-Span-3486\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3487\" style=\"font-family: MathJax_Math-italic;\">r</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-3488\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">u</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3489\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-3490\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≥</span><span class=\"mo\" id=\"MathJax-Span-3491\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mn\" id=\"MathJax-Span-3492\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-371\">maxSuffix(l_u, u−1) + sign_u + maxPrefix(u+1, r_u) ≥ 0</script>.</p><p>Here <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-372-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3493\" style=\"width: 6.929em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.252em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1005.2em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3494\"><span class=\"mi\" id=\"MathJax-Span-3495\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3496\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3497\" style=\"font-family: MathJax_Math-italic;\">x</span><span class=\"mi\" id=\"MathJax-Span-3498\" style=\"font-family: MathJax_Math-italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3499\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mi\" id=\"MathJax-Span-3500\" style=\"font-family: MathJax_Math-italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3501\" style=\"font-family: MathJax_Math-italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3502\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3503\" style=\"font-family: MathJax_Math-italic;\">x</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-372\">maxSuffix</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-373-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3504\" style=\"width: 6.821em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.143em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1005.09em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3505\"><span class=\"mi\" id=\"MathJax-Span-3506\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3507\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3508\" style=\"font-family: MathJax_Math-italic;\">x</span><span class=\"mi\" id=\"MathJax-Span-3509\" style=\"font-family: MathJax_Math-italic;\">P<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.111em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3510\" style=\"font-family: MathJax_Math-italic;\">r</span><span class=\"mi\" id=\"MathJax-Span-3511\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3512\" style=\"font-family: MathJax_Math-italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3513\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3514\" style=\"font-family: MathJax_Math-italic;\">x</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-373\">maxPrefix</script> are, respectively, the largest suffix sum ending at <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-374-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3515\" style=\"width: 3.033em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1002.22em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3516\"><span class=\"mi\" id=\"MathJax-Span-3517\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mo\" id=\"MathJax-Span-3518\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-3519\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-374\">u−1</script> and the largest prefix sum starting at <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-375-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3520\" style=\"width: 3.033em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1002.22em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3521\"><span class=\"mi\" id=\"MathJax-Span-3522\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mo\" id=\"MathJax-Span-3523\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-3524\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-375\">u+1</script>, measured in the sign array.</p><p>All max-prefix / max-suffix / total-sum queries can be answered in <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-376-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3525\" style=\"width: 4.927em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.736em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1003.63em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3526\"><span class=\"mi\" id=\"MathJax-Span-3527\" style=\"font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-3528\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3529\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mi\" id=\"MathJax-Span-3530\" style=\"font-family: MathJax_Math-italic;\">o</span><span class=\"mi\" id=\"MathJax-Span-3531\" style=\"font-family: MathJax_Math-italic;\">g<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3532\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3533\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">n</span><span class=\"mo\" id=\"MathJax-Span-3534\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-376\">O(log n)</script> with a segment-tree that stores at each node (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-377-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3535\" style=\"width: 22.351em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.94em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1016.94em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3536\"><span class=\"mi\" id=\"MathJax-Span-3537\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3538\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mi\" id=\"MathJax-Span-3539\" style=\"font-family: MathJax_Math-italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3540\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-3541\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">b</span><span class=\"mi\" id=\"MathJax-Span-3542\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3543\" style=\"font-family: MathJax_Math-italic;\">s</span><span class=\"mi\" id=\"MathJax-Span-3544\" style=\"font-family: MathJax_Math-italic;\">t</span><span class=\"mi\" id=\"MathJax-Span-3545\" style=\"font-family: MathJax_Math-italic;\">P<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.111em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3546\" style=\"font-family: MathJax_Math-italic;\">r</span><span class=\"mi\" id=\"MathJax-Span-3547\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3548\" style=\"font-family: MathJax_Math-italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3549\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3550\" style=\"font-family: MathJax_Math-italic;\">x</span><span class=\"mo\" id=\"MathJax-Span-3551\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-3552\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">b</span><span class=\"mi\" id=\"MathJax-Span-3553\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3554\" style=\"font-family: MathJax_Math-italic;\">s</span><span class=\"mi\" id=\"MathJax-Span-3555\" style=\"font-family: MathJax_Math-italic;\">t</span><span class=\"mi\" id=\"MathJax-Span-3556\" style=\"font-family: MathJax_Math-italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3557\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mi\" id=\"MathJax-Span-3558\" style=\"font-family: MathJax_Math-italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3559\" style=\"font-family: MathJax_Math-italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3560\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3561\" style=\"font-family: MathJax_Math-italic;\">x</span><span class=\"mo\" id=\"MathJax-Span-3562\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-3563\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">t</span><span class=\"mi\" id=\"MathJax-Span-3564\" style=\"font-family: MathJax_Math-italic;\">o</span><span class=\"mi\" id=\"MathJax-Span-3565\" style=\"font-family: MathJax_Math-italic;\">t</span><span class=\"mi\" id=\"MathJax-Span-3566\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3567\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mi\" id=\"MathJax-Span-3568\" style=\"font-family: MathJax_Math-italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3569\" style=\"font-family: MathJax_Math-italic;\">u</span><span class=\"mi\" id=\"MathJax-Span-3570\" style=\"font-family: MathJax_Math-italic;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-377\">ans, bestPrefix, bestSuffix, totalSum</script>). Merging two children follows the standard Kadane-style formulas.</p><p>Algorithm loop. Initialise the segment tree with <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-378-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3571\" style=\"width: 6.117em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.602em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1004.55em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3572\"><span class=\"mi\" id=\"MathJax-Span-3573\" style=\"font-family: MathJax_Math-italic;\">s</span><span class=\"mi\" id=\"MathJax-Span-3574\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3575\" style=\"font-family: MathJax_Math-italic;\">g<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3576\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3577\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mo\" id=\"MathJax-Span-3578\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">≡</span><span class=\"mo\" id=\"MathJax-Span-3579\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mo\" id=\"MathJax-Span-3580\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">+</span><span class=\"mn\" id=\"MathJax-Span-3581\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-378\">sign ≡ +1</script>, so total sum everywhere is positive; set <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-379-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3582\" style=\"width: 5.035em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.791em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1003.74em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3583\"><span class=\"mi\" id=\"MathJax-Span-3584\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3585\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3586\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3587\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mo\" id=\"MathJax-Span-3588\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">=</span><span class=\"mo\" id=\"MathJax-Span-3589\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mn\" id=\"MathJax-Span-3590\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-379\">med = 1</script>. For <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-380-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3591\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1003.85em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3592\"><span class=\"mi\" id=\"MathJax-Span-3593\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3594\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3595\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3596\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">←</span><span class=\"mn\" id=\"MathJax-Span-3597\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-380\">med←1</script> we must exclude from the tree every position whose value is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-381-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3598\" style=\"width: 3.953em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.979em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1002.98em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3599\"><span class=\"mo\" id=\"MathJax-Span-3600\" style=\"font-family: MathJax_Main;\">&lt;</span><span class=\"mo\" id=\"MathJax-Span-3601\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3602\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mi\" id=\"MathJax-Span-3603\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3604\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-381\">< med</script>, by updating that point to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-382-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3605\" style=\"width: 1.734em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1001.25em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3606\"><span class=\"mo\" id=\"MathJax-Span-3607\" style=\"font-family: MathJax_Main;\">−</span><span class=\"mn\" id=\"MathJax-Span-3608\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-382\">−1</script>. Now iterate <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-383-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3609\" style=\"width: 1.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.464em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1001.46em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3610\"><span class=\"mi\" id=\"MathJax-Span-3611\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3612\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-383\">mn</script> from <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-384-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3613\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3614\"><span class=\"mn\" id=\"MathJax-Span-3615\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-384\">1</script> upward:</p><p> - for every index <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-385-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3616\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3617\"><span class=\"mi\" id=\"MathJax-Span-3618\" style=\"font-family: MathJax_Math-italic;\">u</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-385\">u</script> with <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-386-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3619\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1003.9em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3620\"><span class=\"msubsup\" id=\"MathJax-Span-3621\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3622\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-3623\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">u</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3624\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mo\" id=\"MathJax-Span-3625\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">=</span><span class=\"mo\" id=\"MathJax-Span-3626\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3627\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mi\" id=\"MathJax-Span-3628\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-386\">a_u = mn</script> evaluate the inequality above.</p><p> - while the inequality is satisfied for all such indices, increment <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-387-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3629\" style=\"width: 2.438em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.843em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1001.84em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3630\"><span class=\"mi\" id=\"MathJax-Span-3631\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3632\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3633\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-387\">med</script> by <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-388-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3634\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3635\"><span class=\"mn\" id=\"MathJax-Span-3636\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-388\">1</script> and for every position whose value just became <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-389-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3637\" style=\"width: 3.953em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.979em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1002.98em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3638\"><span class=\"mo\" id=\"MathJax-Span-3639\" style=\"font-family: MathJax_Main;\">&lt;</span><span class=\"mo\" id=\"MathJax-Span-3640\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3641\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mi\" id=\"MathJax-Span-3642\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3643\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-389\">< med</script> perform one point-update to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-390-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3644\" style=\"width: 1.734em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1001.25em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3645\"><span class=\"mo\" id=\"MathJax-Span-3646\" style=\"font-family: MathJax_Main;\">−</span><span class=\"mn\" id=\"MathJax-Span-3647\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-390\">−1</script> in the segment tree.</p><p> - when the test fails for some <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-391-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3648\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3649\"><span class=\"mi\" id=\"MathJax-Span-3650\" style=\"font-family: MathJax_Math-italic;\">u</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-391\">u</script>, stop raising med.</p><p> - record <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-392-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3651\" style=\"width: 16.507em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.503em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1012.39em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3652\"><span class=\"mi\" id=\"MathJax-Span-3653\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3654\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mi\" id=\"MathJax-Span-3655\" style=\"font-family: MathJax_Math-italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3656\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3657\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">m</span><span class=\"mi\" id=\"MathJax-Span-3658\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3659\" style=\"font-family: MathJax_Math-italic;\">x</span><span class=\"mo\" id=\"MathJax-Span-3660\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3661\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3662\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mi\" id=\"MathJax-Span-3663\" style=\"font-family: MathJax_Math-italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3664\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-3665\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mi\" id=\"MathJax-Span-3666\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3667\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3668\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mo\" id=\"MathJax-Span-3669\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">−</span><span class=\"mo\" id=\"MathJax-Span-3670\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3671\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mi\" id=\"MathJax-Span-3672\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3673\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-392\">ans = max(ans, med − mn)</script>.</p><p>Because med only increases and never exceeds <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-393-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3674\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3675\"><span class=\"mi\" id=\"MathJax-Span-3676\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-393\">n</script>, the total number of tree updates is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-394-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3677\" style=\"width: 2.871em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3678\"><span class=\"mi\" id=\"MathJax-Span-3679\" style=\"font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-3680\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3681\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3682\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-394\">O(n)</script> and every update / query costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-395-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3683\" style=\"width: 4.927em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.736em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1003.63em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3684\"><span class=\"mi\" id=\"MathJax-Span-3685\" style=\"font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-3686\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3687\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mi\" id=\"MathJax-Span-3688\" style=\"font-family: MathJax_Math-italic;\">o</span><span class=\"mi\" id=\"MathJax-Span-3689\" style=\"font-family: MathJax_Math-italic;\">g<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3690\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3691\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">n</span><span class=\"mo\" id=\"MathJax-Span-3692\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-395\">O(log n)</script>, so the whole run is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-396-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3693\" style=\"width: 6.172em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.656em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1004.55em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3694\"><span class=\"mi\" id=\"MathJax-Span-3695\" style=\"font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-3696\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3697\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3698\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3699\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">l</span><span class=\"mi\" id=\"MathJax-Span-3700\" style=\"font-family: MathJax_Math-italic;\">o</span><span class=\"mi\" id=\"MathJax-Span-3701\" style=\"font-family: MathJax_Math-italic;\">g<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3702\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3703\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">n</span><span class=\"mo\" id=\"MathJax-Span-3704\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-396\">O(n log n)</script>. Memory is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-397-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3705\" style=\"width: 2.871em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3706\"><span class=\"mi\" id=\"MathJax-Span-3707\" style=\"font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-3708\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3709\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3710\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-397\">O(n)</script>.</p><p>Why correct. For each mn the inner while moves med upward greedily until the moment no subarray with minimum mn can keep the <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-398-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3711\" style=\"width: 8.661em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.55em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1006.55em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3712\"><span class=\"mi\" id=\"MathJax-Span-3713\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3714\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3715\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3716\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-3717\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-3718\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3719\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≥</span><span class=\"mo\" id=\"MathJax-Span-3720\"><span style=\"font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 76%; font-style: normal; font-weight: normal;\"> </span></span><span class=\"mi\" id=\"MathJax-Span-3721\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mi\" id=\"MathJax-Span-3722\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3723\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-398\">median ≥ med</script>; thus the last valid value of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-399-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3724\" style=\"width: 2.438em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.843em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1001.84em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3725\"><span class=\"mi\" id=\"MathJax-Span-3726\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3727\" style=\"font-family: MathJax_Math-italic;\">e</span><span class=\"mi\" id=\"MathJax-Span-3728\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-399\">med</script> realises the true maximum for this <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-400-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-3729\" style=\"width: 1.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.464em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1001.46em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3730\"><span class=\"mi\" id=\"MathJax-Span-3731\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-3732\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-400\">mn</script>. The outer sweep examines every possible minimum, hence the largest gap ever recorded is the global optimum.</p></div></div></div></div>"
}