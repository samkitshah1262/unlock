<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/141425" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>Thank you for participating! I hope you enjoyed the problems.</p><p><a href="https://codeforces.com/contest/2086/problem/A" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086A - Cloudberry Jam</a></p><p>Idea: <a class="rated-user user-gray" href="https://codeforces.com/profile/Galina_Basalova" title="Newbie Galina_Basalova">Galina_Basalova</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2086/problem/A" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086A - Cloudberry Jam</a></h3><div class="ttypography"><div class="problem-statement"><div><p>As stated in the problem, to prepare one $$$3$$$kg jar of jam, $$$2$$$ kg of berries are required; therefore, to prepare $$$n$$$ jars, you need to take $$$2 \cdot n$$$ kg of cloudberries.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (Galina_Basalova)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> n </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2086/problem/B" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086B - Large Array and Segments</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/FelixArg" title="International Master FelixArg">FelixArg</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2086/problem/B" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086B - Large Array and Segments</a></h3><div class="ttypography"><div class="problem-statement"><div><p>In this problem, the array $$$b$$$ is obtained by copying the array $$$a$$$ exactly $$$k$$$ times.</p><p>Notice that all elements of the array $$$a$$$ are positive; therefore, the elements of the array $$$b$$$ are also positive. From this, we can conclude that the optimal $$$r$$$ for any $$$l$$$ that maximizes the sum over the segment [$$$l, r$$$] is always equal to $$$n \cdot k$$$. It also follows that the maximum sum for $$$l$$$ is less than the maximum sum for $$$l - 1$$$. The condition of monotonicity holds, so we can perform a binary search to find the first such $$$l$$$ for which the maximum sum is $$$&lt; x$$$.</p><p>How do we write a check for such a binary search? Given a position $$$m$$$, we need to calculate the maximum sum for it. To do this, we find how many "full arrays $$$a$$$" fit into the suffix $$$[m, n \cdot k]$$$: there are $$$\lfloor \frac{n \cdot k - m + 1}{n} \rfloor$$$ of them. In addition to this, there are $$$suff = (n \cdot k - m + 1) \bmod n$$$ elements from the suffix of the array $$$a$$$ on this segment, so the total sum of the elements of the array $$$b$$$ over the segment [$$$m, n \cdot k$$$] can be found using the formula:</p><p>$$$$$$ \lfloor \frac{n \cdot k - m + 1}{n} \rfloor \cdot \sum_{i=1}^{n} a_{i} + \sum_{i = n - suff + 1}^{n} a_{i}$$$$$$</p><p>At this point, we can write a solution that works in $$$O(n \cdot (\log n + \log k))$$$. If we pre-calculate all suffix sums for the array $$$a$$$, then the formula above can be calculated in $$$O(1)$$$, so the solution can be optimized to $$$O(n + \log k)$$$.</p><p>There are also other solutions with $$$O(n + k)$$$ complexity that also get <span class="tex-font-style-tt">Accepted</span>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (FelixArg)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">accumulate</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> a</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">(),</span><span class="pln"> </span><span class="lit">0ll</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> k </span><span class="pun">&lt;</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">*</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">l </span><span class="pun">&lt;=</span><span class="pln"> r</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> m </span><span class="pun">=</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> l</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> cnt_a </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">*</span><span class="pln"> k </span><span class="pun">-</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> suff </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">*</span><span class="pln"> k </span><span class="pun">-</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> sum </span><span class="pun">=</span><span class="pln"> cnt_a </span><span class="pun">*</span><span class="pln"> accumulate</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> a</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">(),</span><span class="pln"> </span><span class="lit">0ll</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> suff</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
            sum </span><span class="pun">+=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sum </span><span class="pun">&lt;</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
            r </span><span class="pun">=</span><span class="pln"> m </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
            l </span><span class="pun">=</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> r </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--){</span><span class="pln">
	    solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2086/problem/C" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086C - Disappearing Permutation</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/FelixArg" title="International Master FelixArg">FelixArg</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2086/problem/C" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086C - Disappearing Permutation</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's take a closer look at how the <span class="tex-font-style-it">fixing the array</span> operation works:</p><p>Suppose we have a missing number $$$p_{d_{i}}$$$, we know that the final permutation must contain this number, and the only place we can put the number $$$p_{d_{i}}$$$ is position $$$p_{d_{i}}$$$. However, if we place the number there, we might lose $$$p_{p_{d_{i}}}$$$, which also needs to be placed in the final permutation, and the only place we can put it is position $$$p_{p_{d_{i}}}$$$, but we might again lose some number, and so on. This process will end when we place a number in the position of an already missing number.</p><p>This process can be implemented either recursively or iteratively, and we are only interested in the set of positions we need to fix.</p><p>Let's denote the set of all positions to be fixed as $$$X$$$. Then we can observe the following: if the current query $$$d_{i}$$$ is contained in $$$X$$$, then the union of the sets of fixable positions for $$$d_{i}$$$ and $$$X$$$ is equal to $$$X$$$. If the query $$$d_{i}$$$ is not contained in $$$X$$$, then it adds some positions to the set $$$X$$$.</p><p>Based on this observation, we can write a solution. I will outline the main points of the solution:</p><ul> <li> we maintain the set $$$X$$$; </li><li> when the query comes with $$$d_{i}$$$ that is contained in $$$X$$$, we do nothing and simply output the size of the set $$$X$$$; </li><li> when the query comes with $$$d_{i}$$$ that is not contained in $$$X$$$, then we add all the positions that are necessary to fix the array if $$$d_{i}$$$ is missing, and output the size of the set $$$X$$$. </li></ul><p>The final implementation may have a complexity of $$$O(n)$$$ or $$$O(n \log n)$$$.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (FelixArg)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> p</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]--;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">set</span><span class="str">&lt;int&gt;</span><span class="pln"> X</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> d</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> d</span><span class="pun">;</span><span class="pln">
        d</span><span class="pun">--;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">X</span><span class="pun">.</span><span class="pln">contains</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)){</span><span class="pln">
            X</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">d</span><span class="pun">);</span><span class="pln">
            d </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">d</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> X</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> 
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">

	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--){</span><span class="pln">
	    solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2086/problem/D" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086D - Even String</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/FelixArg" title="International Master FelixArg">FelixArg</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2086/problem/D" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086D - Even String</a></h3><div class="ttypography"><div class="problem-statement"><div><p>From the statement, it follows that all identical letters in $$$s$$$ must be positioned either at even indices or at odd indices simultaneously.</p><p>Let's examine how the ways to construct the string $$$s$$$ are formed:</p><ol> <li> A subset of letters that we take for the odd positions (the remaining letters will be at the even positions); </li><li> The number of ways to create a string with a fixed subset of letters at the odd positions. </li></ol><p>Let $$$S$$$ denote the sum of the array $$$c$$$. We also denote $$$odd = \lceil\frac{S}{2}\rceil$$$ as the number of odd positions, and $$$even = \lfloor\frac{S}{2}\rfloor$$$ as the number of even positions.</p><p>For now, let's ignore the second point and calculate how many ways there are to distribute the letters such that we can create at least one suitable string $$$s$$$. That is, we need to count the number of ways to choose a set of letters that will occupy the odd positions. This resembles a modification of the classical <a href="https://en.wikipedia.org/wiki/Knapsack_problem">knapsack problem</a>, which can be solved using dynamic programming. Let $$$\text{dp}[i]$$$ denote the number of ways to take a subset of letters such that the number of letters taken equals $$$i$$$. The base case of the dynamic programming is $$$\text{dp}[i] = 0$$$, and the entire dynamic can be computed using two nested loops:</p><pre class="lstlisting"><code class="prettyprint prettyprinted" style=""><span class="pln">dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><br><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">26</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><br><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">){</span><br><span class="pln">        </span><span class="kwd">continue</span><span class="pun">;</span><br><span class="pln">    </span><span class="pun">}</span><br><span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">--){</span><br><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> s</span><span class="pun">){</span><br><span class="pln">            dp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><br><span class="pln">        </span><span class="pun">}</span><br><span class="pln">    </span><span class="pun">}</span><br><span class="pun">}</span><br></code></pre><p>The number we're interested in will be in $$$\text{dp}[odd]$$$.</p><p>Now we need to understand what to do with point $$$2$$$. Notice that if we have fixed a subset of letters $$$X$$$ at the odd positions, then the number of ways to create the string is equal to the product of the multinomial coefficients:</p><p>$$$$$$ \frac{odd!}{\prod_{i \in X} c_{i}!} \cdot \frac{even!}{\prod_{i \notin X} c_{i}!}$$$$$$</p><p>Notice that this product is a constant, meaning it does not depend on the specific subset $$$X$$$:</p><p>$$$$$$ \frac{odd! \cdot even!}{\prod_{i = 0}^{26} c_{i}!} $$$$$$</p><p>Thus, the answer to the entire problem is simply the product:</p><p>$$$$$$ \frac{odd! \cdot even!}{\prod_{i = 0}^{26} c_{i}!} \cdot \text{dp}[odd] $$$$$$</p><p>The total complexity complexity is $$$O(S \cdot 26)$$$.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (FelixArg)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MOD </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998</span><span class="str">'244'</span><span class="lit">353</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> bpow</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">p</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
			res </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res </span><span class="pun">*</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		x </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> fact</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
		res </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res </span><span class="pun">*</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> c</span><span class="pun">(</span><span class="lit">26</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">26</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
 
	</span><span class="kwd">int</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> accumulate</span><span class="pun">(</span><span class="pln">c</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> c</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">(),</span><span class="pln"> </span><span class="lit">0ll</span><span class="pun">);</span><span class="pln">
	
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> dp</span><span class="pun">(</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
 
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">26</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">--){</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> s</span><span class="pun">){</span><span class="pln">
				dp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
 
	</span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">s </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> fact</span><span class="pun">(</span><span class="pln">s </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD </span><span class="pun">*</span><span class="pln"> fact</span><span class="pun">((</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">26</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
		ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ans </span><span class="pun">*</span><span class="pln"> bpow</span><span class="pun">(</span><span class="pln">fact</span><span class="pun">(</span><span class="pln">c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]),</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
 
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--){</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2086/problem/E" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086E - Zebra-like Numbers</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/FelixArg" title="International Master FelixArg">FelixArg</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2086/problem/E" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086E - Zebra-like Numbers</a></h3><div class="ttypography"><div class="problem-statement"><div><p>First, let's see how many <span class="tex-font-style-it">zebra-Like</span> numbers less than or equal to $$$10^{18}$$$ exist. It turns out there are only $$$30$$$ of them, and based on some <span class="tex-font-style-it">zebra-like</span> number $$$z_{i}$$$, the next one can be calculated using the formula $$$z_{i + 1} = 4 \cdot z_{i} + 1$$$.</p><p>Then, we have to be able to quickly calculate the <span class="tex-font-style-it">zebra value</span> for an arbitrary number $$$x$$$. Since each subsequent <span class="tex-font-style-it">zebra-like</span> number is approximately $$$4$$$ times larger than the previous one, intuitively, it seems like a greedy algorithm should be optimal: for any number $$$x$$$, we can determine its <span class="tex-font-style-it">zebra value</span> by subtracting the largest <span class="tex-font-style-it">zebra-like</span> number that does not exceed $$$x$$$, until $$$x$$$ becomes $$$0$$$.</p><p>Let's prove the correctness of the greedy algorithm:</p><p>Assume that $$$y$$$ is the smallest number for which the greedy algorithm does not work, meaning that in the optimal decomposition of $$$y$$$ into <span class="tex-font-style-it">zebra-like</span> numbers, the largest <span class="tex-font-style-it">zebra-like</span> number $$$z_{i}$$$ that does not exceed $$$y$$$ does not appear at all.</p><p>If the greedy algorithm works for all numbers less than $$$y$$$, then in the decomposition of the number $$$y$$$, there must be at least one number $$$z_{i - 1}$$$. And since $$$y - z_{i - 1}$$$ can be decomposed greedily and will contain at least $$$3$$$ numbers $$$z_{i - 1}$$$, we will end up with at least $$$4$$$ numbers $$$z_{i - 1}$$$ in the decomposition.</p><p>Moreover, there will be at least $$$5$$$ numbers in the decomposition because $$$4 \cdot z_{i - 1} &lt; z_{i}$$$, which means it is also less than $$$y$$$. Therefore, if the fifth number is $$$1$$$, we simply combine $$$4 \cdot z_{i - 1}$$$ with $$$1$$$ to obtain $$$z_{i}$$$; otherwise, we decompose the fifth number into $$$4$$$ smaller numbers plus $$$1$$$, and we also combine this $$$1$$$ with $$$4 \cdot z_{i - 1}$$$ to get $$$z_{i}$$$.</p><p>Thus, the new decomposition of the number $$$y$$$ into <span class="tex-font-style-it">zebra-like</span> numbers will have no more numbers than the old one, but it will include the number $$$z_i$$$ — the maximum <span class="tex-font-style-it">zebra-like</span> number that does not exceed $$$y$$$. This means that $$$y$$$ can be decomposed greedily.</p><p>We have reached a contradiction; therefore, the greedy algorithm works for any positive number.</p><p>Now, let's express the greedy decomposition of the number $$$x$$$ in a more convenient form. We will represent the decomposition as a string $$$s$$$ of length $$$30$$$ consisting of digits, where the $$$i$$$-th character will denote how many <span class="tex-font-style-it">zebra</span> numbers $$$z_{i}$$$ are present in this decomposition.</p><p>Let's take a closer look at what such a string might look like:</p><ul> <li> $$$s_{i} \in \{0, 1, 2, 3, 4\}$$$; </li><li> if $$$s_{i} = 4$$$, then for any $$$j &lt; i$$$, the character $$$s_{j} = 0$$$ (this follows from the proof of the greedy algorithm). </li></ul><p>Moreover, any number generates a unique string of this form. This is very similar to representing a number in a new numeric system, which we will call <span class="tex-font-style-it">zebroid</span>.</p><p>In summary, the problem has been reduced to counting the number of numbers in the interval $$$[l, r]$$$ such that the sum of the digits in the <span class="tex-font-style-it">zebroid</span> numeral system equals $$$x$$$. This is a standard problem that can be solved using dynamic programming on digits. Instead of counting the suitable numbers in the interval $$$[l, r]$$$, we will count the suitable numbers in the intervals $$$[1, l]$$$ and $$$[1, r]$$$ and subtract the first from the second to get the answer. Let $$$\text{dp}[\text{ind}][\text{sum}][\text{num_less_m}][\text{was_4}]$$$ be the number of numbers in the interval $$$[1, m]$$$ such that:</p><ul> <li> they have $$$\text{ind} + 1$$$ digits; </li><li> the sum of the digits equals $$$\text{sum}$$$; </li><li> $$$\text{num_less_m} = 0$$$ if the prefix of $$$\text{ind} + 1$$$ digits of the number $$$m$$$ is lexicographically greater than these numbers, otherwise $$$\text{num_less_m} = 1$$$; </li><li> $$$\text{was_4} = 0$$$ if there has not been a $$$4$$$ in the $$$\text{ind} + 1$$$ digits of these numbers yet, otherwise $$$\text{was_4} = 1$$$. </li></ul><p>Transitions in this dynamic programming are not very difficult — they are basically appending a new digit at the end.</p><p>The complexity of the solution is $$$O(\log^2 A)$$$, if we estimate the number of <span class="tex-font-style-it">zebra-like</span> numbers up to $$$A = 10^{18}$$$ as $$$\log A$$$.</p><p><span class="tex-font-style-bf">Alternative solution (BledDest)</span></p><p>First, let's prove that we can decompose numbers into zebra-like numbers greedily, constantly subtracting the maximum zebra-like number we can (the proof is the same as in the first solution).</p><p>After that, we will learn to calculate the following dynamic programming: $$$dp_{i,j}$$$ — the number of numbers from $$$0$$$ to $$$i-1$$$ with a zebra value of exactly $$$j$$$. The base states of the dynamic programming will be as follows:</p><ul> <li> $$$dp_{0,x} = 0$$$ (since there are no numbers in the interval); </li><li> $$$dp_{1,0} = 1$$$ (since the number $$$0$$$ has a zebra value of $$$0$$$); </li><li> $$$dp_{1,i} = 0$$$ for $$$i \ne 0$$$ (similarly); </li><li> $$$dp_{i,j} = 0$$$ for $$$i &lt; 0$$$ (numbers cannot have negative zebra value). Additionally, the same can be done for $$$j$$$ greater than the number of zebra-like numbers multiplied by $$$4$$$ (since there cannot be more than $$$4$$$ identical zebra-like numbers in the decomposition of a number). </li></ul><p>Okay, now let's consider the transitions in this dynamic programming. Suppose we want to calculate $$$dp_{i,j}$$$. We find the largest zebra-like number $$$k$$$ that is less than $$$i$$$. Then for all numbers from $$$k$$$ to $$$i-1$$$, the maximum zebra number in the decomposition is $$$k$$$, and if we subtract it from them, we get the interval of numbers from $$$0$$$ to $$$i-k-1$$$. Therefore, $$$dp_{i,j} = dp_{k,j} + dp_{i-k,j-1}$$$.</p><p>Intuitively, it seems that there are not many states in this dynamic programming, so it can be calculated "lazily", and we can store all already computed values in a <span class="tex-font-style-tt">map</span>. But let's prove this.</p><p>$$$j$$$ will be on the order of $$$\log A$$$, so let's estimate the number of different values of $$$i$$$ that we will need. We will divide them into two categories — zebra-like numbers $$$i$$$ and all others.</p><p>If $$$i$$$ is a zebra-like number, then the previous zebra number is $$$k = \frac{i - 1}{4}$$$. Therefore, $$$dp_{i,j} = dp_{k,j} + dp_{i-k,j-1} = \dots = dp_{k,j} + dp_{k,j-1} + dp_{k,j-2} + dp_{k,j-3} + dp_{1,j-4}$$$. Thus, the states where $$$i$$$ is a zebra-like number generate $$$O(1)$$$ new states, and in total, the states where $$$i$$$ is zebra-like and the states generated by them will require only $$$O(\log A)$$$ different values of $$$i$$$.</p><p>If $$$i$$$ is not a zebra-like number, one of the transitions leads to a state with a zebra-like number, and the other does not. That is, from each state, there is a "chain" of states with values of $$$i$$$ that are not zebra-like numbers, and the length of such a chain is $$$O(\log A)$$$ (since every $$$O(1)$$$ steps in the chain effectively take $$$i$$$ modulo some zebra-like number), so there will be a total of $$$O(\log A)$$$ values of $$$i$$$ that are not zebra numbers.</p><p>Thus, the total number of states in the dynamic programming will be $$$O(\log^2 A)$$$, so the entire solution will work in $$$O(\log^2 A \log \log A)$$$ for each test case.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (FelixArg)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> dp</span><span class="pun">[</span><span class="lit">40</span><span class="pun">][</span><span class="lit">120</span><span class="pun">][</span><span class="lit">2</span><span class="pun">][</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> count</span><span class="pun">(</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pun">&amp;</span><span class="pln"> num</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> m </span><span class="pun">=</span><span class="pln"> num</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
	memset</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">));</span><span class="pln">
 
	dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++){</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> k </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln"> k</span><span class="pun">++){</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> k </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
					</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">num</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> k</span><span class="pun">){</span><span class="pln">
					dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
					dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
					</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">){</span><span class="pln">
						dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
						dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
					</span><span class="pun">}</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">num</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> k</span><span class="pun">){</span><span class="pln">
					dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
					dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
					</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">){</span><span class="pln">
						dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
						dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
					</span><span class="pun">}</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
					dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
					</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">){</span><span class="pln">
						dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
					</span><span class="pun">}</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">num</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">4</span><span class="pun">){</span><span class="pln">
					dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
					dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">				
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
					dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">					
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
	</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
	l</span><span class="pun">--;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">90</span><span class="pun">){</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
 
	vector</span><span class="pun">&lt;</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">&gt;</span><span class="pln"> zeb</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">60</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
		cur </span><span class="pun">^=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
		zeb</span><span class="pun">.</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> m </span><span class="pun">=</span><span class="pln"> zeb</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
 
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> num_l</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> m </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--){</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">l </span><span class="pun">&gt;=</span><span class="pln"> zeb</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]){</span><span class="pln">
			cnt</span><span class="pun">++;</span><span class="pln">
			l </span><span class="pun">-=</span><span class="pln"> zeb</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		num_l</span><span class="pun">.</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
 
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> num_r</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> m </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--){</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">r </span><span class="pun">&gt;=</span><span class="pln"> zeb</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]){</span><span class="pln">
			cnt</span><span class="pun">++;</span><span class="pln">
			r </span><span class="pun">-=</span><span class="pln"> zeb</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		num_r</span><span class="pun">.</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
 
	count</span><span class="pun">(</span><span class="pln">num_r</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">m</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">m</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">m</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">m</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
	count</span><span class="pun">(</span><span class="pln">num_l</span><span class="pun">);</span><span class="pln">
	ans </span><span class="pun">-=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">m</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">m</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">m</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">m</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--){</span><span class="pln">
	    solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Solution (BledDest)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
vector</span><span class="pun">&lt;</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">&gt;</span><span class="pln"> z</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> precalc</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    z </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">1ll</span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">z</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">)</span><span class="pln">
        z</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="lit">4</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> z</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
map</span><span class="pun">&lt;</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">&gt;,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">&gt;</span><span class="pln"> dp</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">(</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> x</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(</span><span class="pln">make_pair</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">make_pair</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)];</span><span class="pln">
    </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">&amp;</span><span class="pln"> d </span><span class="pun">=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">make_pair</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> z</span><span class="pun">.</span><span class="pln">size</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> d </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> d </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">r </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> d </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">r </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> d </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> d </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">auto</span><span class="pln"> it </span><span class="pun">=</span><span class="pln"> lower_bound</span><span class="pun">(</span><span class="pln">z</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> z</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">(),</span><span class="pln"> r</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">--</span><span class="pln">it</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*</span><span class="pln">it</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> d </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">(</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> 
</span><span class="pun">{</span><span class="pln">
    precalc</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">(</span><span class="pln">r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2086/problem/F" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086F - Online Palindrome</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/Valentin_E" title="Master Valentin_E">Valentin_E</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2086/problem/F" title="Educational Codeforces Round 177 (Rated for Div. 2)">2086F - Online Palindrome</a></h3><div class="ttypography"><div class="problem-statement"><div><p>From the problem statement, it can be understood that at each step, when we have an odd number of characters, the string $$$t$$$ must be a palindrome, since the length of the string $$$s$$$ is not provided. Therefore, we need to come up with a strategy for swaps to ensure this condition is met.</p><p>The first thought is to try a brute-force approach of the following kind:</p><p>When the current step is odd (i.e., $$$|t| \bmod 2 = 1$$$), let's obtain the next character $$$s_{i}$$$, add it to the end of $$$t$$$, and perform some swap. After this, two conditions must be satisfied:</p><ul> <li> if we then add the character "<span class="tex-font-style-tt">a</span>", the string $$$t$$$ can be turned into a palindrome with no more than one swap; </li><li> if we then add the character "<span class="tex-font-style-tt">b</span>", the string $$$t$$$ can be turned into a palindrome with no more than one swap. </li></ul><p>If the step is even, let's obtain the next character $$$s_{i}$$$, add it to the end of $$$t$$$, and perform a swap so that $$$t$$$ becomes a palindrome.</p><p>If we try to submit this solution, we will get <span class="tex-font-style-tt">WA</span>, as there can be situations where both conditions for the odd step are not satisfied simultaneously. This is due to the fact that we allow the construction of any palindromes.</p><p>Based on this, we conclude that any palindrome is not suitable for us, and we need to maintain some template palindrome. The most challenging part of this problem is to find such a template.</p><p>Next, I will describe how the template should look:</p><ul> <li> if there is more than one letter "<span class="tex-font-style-tt">a</span>", then we place the letter "<span class="tex-font-style-tt">a</span>" as the first and last character; </li><li> if there is more than one letter "<span class="tex-font-style-tt">b</span>", then we place the letter "<span class="tex-font-style-tt">b</span>" as the second and second-to-last character; </li><li> if there is more than one letter "<span class="tex-font-style-tt">a</span>", then we place the letter "<span class="tex-font-style-tt">a</span>" as the third and third-to-last character; </li><li> we alternate this way while possible; </li><li> then we fill all paired positions with the letter that has more than one left; </li><li> the center is filled unambiguously. </li></ul><p>All palindromes that start with the letter "<span class="tex-font-style-tt">b</span>" and have the same form are also suitable for us. For example, the following strings fit the template:</p><ul> <li> "<span class="tex-font-style-tt">a</span>"; </li><li> "<span class="tex-font-style-tt">bab</span>"; </li><li> "<span class="tex-font-style-tt">abbabba</span>"; </li><li> "<span class="tex-font-style-tt">abababaaaaabababa</span>"; </li></ul><p>For this template, there are transitions (i.e., swaps such that from a template of length $$$x$$$ we can transition to a template of length $$$x + 2$$$ by adding any possible pair of characters), however, deriving them manually is quite complicated, as there are many situations.</p><p>However, this can be added to our brute-force approach for the odd step. Once again, here's how it will look:</p><ul> <li> obtain the next character from the input; </li><li> iterate through a pair of characters in the string that we want to swap; </li><li> for each iterated pair, consider two variants of the second incoming character. Check if we can obtain the expected template from the current string with no more than one swap; this can be checked unambiguously with a linear pass through the string and the expected template, looking at the differing positions; </li><li> if for the checked permutation we can transition to the template with any next letter, then we perform that permutation. </li></ul><p>For the even step, we can simply find the necessary swap in a linear manner.</p><p>Thus, the asymptotic complexity of this solution is $$$O(|s|^{4})$$$.</p><p>As an appendix, I will list examples of transitions by pairs of characters in the template:</p><ul> <li> "<span class="tex-font-style-tt">aaa</span>" + "<span class="tex-font-style-tt">aa</span>" $$$\to$$$ "<span class="tex-font-style-tt">aaaaa</span>"; </li><li> "<span class="tex-font-style-tt">aaa</span>" + "<span class="tex-font-style-tt">ab</span>" $$$\to$$$ "<span class="tex-font-style-tt">aabaa</span>"; </li><li> "<span class="tex-font-style-tt">aaa</span>" + "<span class="tex-font-style-tt">bb</span>" $$$\to$$$ "<span class="tex-font-style-tt">ababa</span>"; </li></ul><ul> <li> "<span class="tex-font-style-tt">bab</span>" + "<span class="tex-font-style-tt">aa</span>" $$$\to$$$ "<span class="tex-font-style-tt">ababa</span>"; </li><li> "<span class="tex-font-style-tt">bab</span>" + "<span class="tex-font-style-tt">ab</span>" $$$\to$$$ "<span class="tex-font-style-tt">abbba</span>"; </li><li> "<span class="tex-font-style-tt">bab</span>" + "<span class="tex-font-style-tt">bb</span>" $$$\to$$$ "<span class="tex-font-style-tt">bbabb</span>"; </li></ul><ul> <li> "<span class="tex-font-style-tt">ababa</span>" + "<span class="tex-font-style-tt">aa</span>" $$$\to$$$ "<span class="tex-font-style-tt">abaaaba</span>"; </li><li> "<span class="tex-font-style-tt">ababa</span>" + "<span class="tex-font-style-tt">ab</span>" $$$\to$$$ "<span class="tex-font-style-tt">abababa</span>"; </li><li> "<span class="tex-font-style-tt">ababa</span>" + "<span class="tex-font-style-tt">bb</span>" $$$\to$$$ "<span class="tex-font-style-tt">abbabba</span>"; </li></ul><ul> <li> "<span class="tex-font-style-tt">abbba</span>" + "<span class="tex-font-style-tt">aa</span>" $$$\to$$$ "<span class="tex-font-style-tt">abababa</span>"; </li><li> "<span class="tex-font-style-tt">abbba</span>" + "<span class="tex-font-style-tt">ab</span>" $$$\to$$$ "<span class="tex-font-style-tt">abbabba</span>"; </li><li> "<span class="tex-font-style-tt">abbba</span>" + "<span class="tex-font-style-tt">bb</span>" $$$\to$$$ "<span class="tex-font-style-tt">abbbbba</span>"; </li></ul><ul> <li> "<span class="tex-font-style-tt">bbabb</span>" + "<span class="tex-font-style-tt">aa</span>" $$$\to$$$ "<span class="tex-font-style-tt">abbabba</span>"; </li><li> "<span class="tex-font-style-tt">bbabb</span>" + "<span class="tex-font-style-tt">ab</span>" $$$\to$$$ "<span class="tex-font-style-tt">abbbbba</span>"; </li><li> "<span class="tex-font-style-tt">bbabb</span>" + "<span class="tex-font-style-tt">bb</span>" $$$\to$$$ "<span class="tex-font-style-tt">bbbabbb</span>"; </li></ul><ul> <li> "<span class="tex-font-style-tt">ababbbbbbbaba</span>" + "<span class="tex-font-style-tt">aa</span>" $$$\to$$$ "<span class="tex-font-style-tt">abababbbbbababa</span>"; </li><li> "<span class="tex-font-style-tt">ababbbbbbbaba</span>" + "<span class="tex-font-style-tt">ab</span>" $$$\to$$$ "<span class="tex-font-style-tt">ababbbbabbbbaba</span>"; </li><li> "<span class="tex-font-style-tt">ababbbbbbbaba</span>" + "<span class="tex-font-style-tt">bb</span>" $$$\to$$$ "<span class="tex-font-style-tt">ababbbbbbbbbaba</span>"; </li></ul><ul> <li> "<span class="tex-font-style-tt">ababbbabbbaba</span>" + "<span class="tex-font-style-tt">aa</span>" $$$\to$$$ "<span class="tex-font-style-tt">abababbabbababa</span>"; </li><li> "<span class="tex-font-style-tt">ababbbabbbaba</span>" + "<span class="tex-font-style-tt">ab</span>" $$$\to$$$ "<span class="tex-font-style-tt">abababbbbbababa</span>"; </li><li> "<span class="tex-font-style-tt">ababbbabbbaba</span>" + "<span class="tex-font-style-tt">bb</span>" $$$\to$$$ "<span class="tex-font-style-tt">ababbbbabbbbaba</span>"; </li></ul><ul> <li> "<span class="tex-font-style-tt">ababaaaaababa</span>" + "<span class="tex-font-style-tt">aa</span>" $$$\to$$$ "<span class="tex-font-style-tt">ababaaaaaaababa</span>"; </li><li> "<span class="tex-font-style-tt">ababaaaaababa</span>" + "<span class="tex-font-style-tt">ab</span>" $$$\to$$$ "<span class="tex-font-style-tt">ababaaabaaababa</span>"; </li><li> "<span class="tex-font-style-tt">ababaaaaababa</span>" + "<span class="tex-font-style-tt">bb</span>" $$$\to$$$ "<span class="tex-font-style-tt">abababaaabababa</span>"; </li></ul><ul> <li> "<span class="tex-font-style-tt">ababaabaababa</span>" + "<span class="tex-font-style-tt">aa</span>" $$$\to$$$ "<span class="tex-font-style-tt">ababaaabaaababa</span>"; </li><li> "<span class="tex-font-style-tt">ababaabaababa</span>" + "<span class="tex-font-style-tt">ab</span>" $$$\to$$$ "<span class="tex-font-style-tt">abababaaabababa</span>"; </li><li> "<span class="tex-font-style-tt">ababaabaababa</span>" + "<span class="tex-font-style-tt">bb</span>" $$$\to$$$ "<span class="tex-font-style-tt">abababababababa</span>"; </li></ul></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (FelixArg)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
 
</span><span class="kwd">bool</span><span class="pln"> is_palindrom</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">string</span><span class="pun">&amp;</span><span class="pln"> s</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]){</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">bool</span><span class="pln"> check_pattern</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">string</span><span class="pun">&amp;</span><span class="pln"> s</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">char</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> </span><span class="str">'a'</span><span class="pun">,</span><span class="pln"> b </span><span class="pun">=</span><span class="pln"> </span><span class="str">'b'</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> cnt_a </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> cnt_b </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> a</span><span class="pun">){</span><span class="pln">
            cnt_a</span><span class="pun">++;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
            cnt_b</span><span class="pun">++;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt_a </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
        swap</span><span class="pun">(</span><span class="pln">cnt_a</span><span class="pun">,</span><span class="pln"> cnt_b</span><span class="pun">);</span><span class="pln">
        swap</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> b</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">is_palindrom</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)){</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    cnt_b</span><span class="pun">--;</span><span class="pln">
    cnt_a </span><span class="pun">/=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    cnt_b </span><span class="pun">/=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
 
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt_a </span><span class="pun">&gt;</span><span class="pln"> cnt_b</span><span class="pun">){</span><span class="pln">
        swap</span><span class="pun">(</span><span class="pln">cnt_a</span><span class="pun">,</span><span class="pln"> cnt_b</span><span class="pun">);</span><span class="pln">
        swap</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> a</span><span class="pun">){</span><span class="pln">
        cnt_a</span><span class="pun">--;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
        cnt_b</span><span class="pun">--;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt_a </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">){</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> a</span><span class="pun">){</span><span class="pln">
            cnt_a</span><span class="pun">--;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
            cnt_b</span><span class="pun">--;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> find_valid_move_odd</span><span class="pun">(</span><span class="kwd">string</span><span class="pln"> s</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++){</span><span class="pln">
            swap</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">check_pattern</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)){</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">};</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            swap</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> find_valid_move_even</span><span class="pun">(</span><span class="kwd">string</span><span class="pln"> s</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> i </span><span class="pun">!=</span><span class="pln"> j</span><span class="pun">){</span><span class="pln">
                </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> j </span><span class="pun">&amp;&amp;</span><span class="pln"> i </span><span class="pun">!=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
                </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            swap</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
            s </span><span class="pun">+=</span><span class="pln"> </span><span class="str">'a'</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> k </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> k</span><span class="pun">--){</span><span class="pln">
                </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln"> l</span><span class="pun">++){</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> k </span><span class="pun">!=</span><span class="pln"> l</span><span class="pun">){</span><span class="pln">
                        </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
                    </span><span class="pun">}</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">==</span><span class="pln"> l </span><span class="pun">&amp;&amp;</span><span class="pln"> k </span><span class="pun">!=</span><span class="pln"> n</span><span class="pun">){</span><span class="pln">
                        </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
                    </span><span class="pun">}</span><span class="pln">                
                    swap</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]);</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> check_pattern</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)){</span><span class="pln">
                        cnt</span><span class="pun">++;</span><span class="pln">
                        swap</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]);</span><span class="pln">
                        </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
                    </span><span class="pun">}</span><span class="pln">
                    swap</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]);</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
                    </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            s</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
                s </span><span class="pun">+=</span><span class="pln"> </span><span class="str">'b'</span><span class="pun">;</span><span class="pln">
                </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> k </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> k</span><span class="pun">--){</span><span class="pln">
                    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln"> l</span><span class="pun">++){</span><span class="pln">
                        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> k </span><span class="pun">!=</span><span class="pln"> l</span><span class="pun">){</span><span class="pln">
                            </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
                        </span><span class="pun">}</span><span class="pln">
                        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">==</span><span class="pln"> l </span><span class="pun">&amp;&amp;</span><span class="pln"> k </span><span class="pun">!=</span><span class="pln"> n</span><span class="pun">){</span><span class="pln">
                            </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
                        </span><span class="pun">}</span><span class="pln">   
                        swap</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]);</span><span class="pln">
                        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> check_pattern</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)){</span><span class="pln">
                            </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">};</span><span class="pln">
                        </span><span class="pun">}</span><span class="pln">
                        swap</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]);</span><span class="pln">
                    </span><span class="pun">}</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
                s</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            swap</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">string</span><span class="pln"> t </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">char</span><span class="pln"> ch</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> ch</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
 
        t </span><span class="pun">+=</span><span class="pln"> ch</span><span class="pun">;</span><span class="pln">
 
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> find_valid_move_odd</span><span class="pun">(</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
            swap</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]);</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> find_valid_move_even</span><span class="pun">(</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
            swap</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]);</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Solution (awoo)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">100</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">bool</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">N</span><span class="pun">][</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> nxt</span><span class="pun">[</span><span class="pln">N</span><span class="pun">][</span><span class="pln">N</span><span class="pun">][</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
bitset</span><span class="pun">&lt;</span><span class="pln">N</span><span class="pun">&gt;</span><span class="pln"> cur</span><span class="pun">;</span><span class="pln">
bitset</span><span class="pun">&lt;</span><span class="pln">N</span><span class="pun">&gt;</span><span class="pln"> form</span><span class="pun">[</span><span class="pln">N</span><span class="pun">][</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	</span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> N</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="pln"> N</span><span class="pun">)</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> len </span><span class="pun">&lt;</span><span class="pln"> N</span><span class="pun">;</span><span class="pln"> len </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> len </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> len </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> nx </span><span class="pun">=</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> ny </span><span class="pun">=</span><span class="pln"> y</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">nx </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ny </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">nx </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
					nx </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">++</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ny </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
					form</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">y</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> form</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">y</span><span class="pun">][</span><span class="pln">len </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
					ny </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">++</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ny </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">){</span><span class="pln">
				form</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">y</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln"> len </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> len </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> len </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> len </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
			cur </span><span class="pun">=</span><span class="pln"> form</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">y</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
				cur</span><span class="pun">[</span><span class="pln">len</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">bool</span><span class="pln"> found </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> len </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
					</span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
						</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cur</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> cur</span><span class="pun">[</span><span class="pln">r</span><span class="pun">])</span><span class="pln"> cur</span><span class="pun">[</span><span class="pln">l</span><span class="pun">].</span><span class="pln">flip</span><span class="pun">(),</span><span class="pln"> cur</span><span class="pun">[</span><span class="pln">r</span><span class="pun">].</span><span class="pln">flip</span><span class="pun">();</span><span class="pln">
						</span><span class="kwd">bool</span><span class="pln"> ok </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
						</span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">d</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
							cur</span><span class="pun">[</span><span class="pln">len </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">;</span><span class="pln">
							</span><span class="kwd">int</span><span class="pln"> nx </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">d </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
							</span><span class="kwd">int</span><span class="pln"> ny </span><span class="pun">=</span><span class="pln"> y </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">d </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
							</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">cur </span><span class="pun">^</span><span class="pln"> form</span><span class="pun">[</span><span class="pln">nx</span><span class="pun">][</span><span class="pln">ny</span><span class="pun">]).</span><span class="pln">count</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
								ok </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
								</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
							</span><span class="pun">}</span><span class="pln">
						</span><span class="pun">}</span><span class="pln">
						</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ok</span><span class="pun">){</span><span class="pln">
							found </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
							nxt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">y</span><span class="pun">][</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">};</span><span class="pln">
						</span><span class="pun">}</span><span class="pln">
						</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cur</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> cur</span><span class="pun">[</span><span class="pln">r</span><span class="pun">])</span><span class="pln"> cur</span><span class="pun">[</span><span class="pln">l</span><span class="pun">].</span><span class="pln">flip</span><span class="pun">(),</span><span class="pln"> cur</span><span class="pun">[</span><span class="pln">r</span><span class="pun">].</span><span class="pln">flip</span><span class="pun">();</span><span class="pln">
						</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">found</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">}</span><span class="pln">
					</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">found</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">found</span><span class="pun">){</span><span class="pln">
					dp</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">y</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">string</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
	cur</span><span class="pun">.</span><span class="pln">reset</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">==</span><span class="pln"> </span><span class="str">"0"</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="str">'a'</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> py </span><span class="pun">=</span><span class="pln"> cur</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(),</span><span class="pln"> px </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> py</span><span class="pun">;</span><span class="pln">
		cur</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> nx </span><span class="pun">=</span><span class="pln"> px </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> ny </span><span class="pun">=</span><span class="pln"> py </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">auto</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> nxt</span><span class="pun">[</span><span class="pln">px</span><span class="pun">][</span><span class="pln">py</span><span class="pun">][</span><span class="pln">c</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res</span><span class="pun">.</span><span class="pln">first </span><span class="pun">!=</span><span class="pln"> res</span><span class="pun">.</span><span class="pln">second</span><span class="pun">){</span><span class="pln">
				l </span><span class="pun">=</span><span class="pln"> res</span><span class="pun">.</span><span class="pln">first</span><span class="pun">;</span><span class="pln">
				r </span><span class="pun">=</span><span class="pln"> res</span><span class="pun">.</span><span class="pln">second</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">assert</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">nx</span><span class="pun">][</span><span class="pln">ny</span><span class="pun">]);</span><span class="pln">
			bitset</span><span class="pun">&lt;</span><span class="pln">N</span><span class="pun">&gt;</span><span class="pln"> dif </span><span class="pun">=</span><span class="pln"> cur </span><span class="pun">^</span><span class="pln"> form</span><span class="pun">[</span><span class="pln">nx</span><span class="pun">][</span><span class="pln">ny</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">assert</span><span class="pun">(</span><span class="pln">dif</span><span class="pun">.</span><span class="pln">count</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dif</span><span class="pun">.</span><span class="pln">count</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
				l </span><span class="pun">=</span><span class="pln"> dif</span><span class="pun">.</span><span class="typ">_Find_first</span><span class="pun">();</span><span class="pln">
				r </span><span class="pun">=</span><span class="pln"> dif</span><span class="pun">.</span><span class="typ">_Find_next</span><span class="pun">(</span><span class="pln">l</span><span class="pun">);</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
			cout </span><span class="pun">&lt;&lt;</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cur</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> cur</span><span class="pun">[</span><span class="pln">r</span><span class="pun">])</span><span class="pln"> cur</span><span class="pun">[</span><span class="pln">l</span><span class="pun">].</span><span class="pln">flip</span><span class="pun">(),</span><span class="pln"> cur</span><span class="pun">[</span><span class="pln">r</span><span class="pun">].</span><span class="pln">flip</span><span class="pun">();</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2086" class="notice" style="text-decoration: none;">Educational Codeforces Round 177 (Rated for Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>