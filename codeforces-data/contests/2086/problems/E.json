{
  "contestId": 2086,
  "index": "E",
  "title": "Zebra-like Numbers",
  "timeLimit": "2 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 2400,
  "tags": [
    "bitmasks",
    "brute force",
    "constructive algorithms",
    "dfs and similar",
    "dp",
    "greedy",
    "math"
  ],
  "statementHtml": "<p>We call a positive integer <span class=\"tex-font-style-it\">zebra-like</span> if its binary representation has alternating bits up to the most significant bit, and the least significant bit is equal to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mn\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-1\">1</script>. For example, the numbers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-4\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mn\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-2\">1</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-7\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-8\"><span class=\"mn\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Main;\">5</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-3\">5</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-10\" style=\"width: 1.301em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.92em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-11\"><span class=\"mn\" id=\"MathJax-Span-12\" style=\"font-family: MathJax_Main;\">21</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-4\">21</script> are <span class=\"tex-font-style-it\">zebra-like</span>, as their binary representations <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-13\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-14\"><span class=\"mn\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-5\">1</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-16\" style=\"width: 2.005em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-17\"><span class=\"mn\" id=\"MathJax-Span-18\" style=\"font-family: MathJax_Main;\">101</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-6\">101</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-19\" style=\"width: 3.304em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.492em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1002.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-20\"><span class=\"mn\" id=\"MathJax-Span-21\" style=\"font-family: MathJax_Main;\">10101</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-7\">10101</script> meet the requirements, while the number <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-22\" style=\"width: 1.301em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.92em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-23\"><span class=\"mn\" id=\"MathJax-Span-24\" style=\"font-family: MathJax_Main;\">10</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-8\">10</script> is not <span class=\"tex-font-style-it\">zebra-like</span>, as the least significant bit of its binary representation <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-25\" style=\"width: 2.654em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1001.95em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-26\"><span class=\"mn\" id=\"MathJax-Span-27\" style=\"font-family: MathJax_Main;\">1010</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-9\">1010</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-28\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-29\"><span class=\"mn\" id=\"MathJax-Span-30\" style=\"font-family: MathJax_Main;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-10\">0</script>.</p>\n<p>We define the <span class=\"tex-font-style-it\">zebra value</span> of a positive integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-31\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-32\"><span class=\"mi\" id=\"MathJax-Span-33\" style=\"font-family: MathJax_Math-italic;\">e</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-11\">e</script> as the minimum integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-34\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-35\"><span class=\"mi\" id=\"MathJax-Span-36\" style=\"font-family: MathJax_Math-italic;\">p</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-12\">p</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-37\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-38\"><span class=\"mi\" id=\"MathJax-Span-39\" style=\"font-family: MathJax_Math-italic;\">e</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-13\">e</script> can be expressed as the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-40\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-41\"><span class=\"mi\" id=\"MathJax-Span-42\" style=\"font-family: MathJax_Math-italic;\">p</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-14\">p</script> <span class=\"tex-font-style-it\">zebra-like</span> numbers (possibly the same, possibly different)</p>\n<p>Given three integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-43\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-44\"><span class=\"mi\" id=\"MathJax-Span-45\" style=\"font-family: MathJax_Math-italic;\">l</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-15\">l</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-46\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-47\"><span class=\"mi\" id=\"MathJax-Span-48\" style=\"font-family: MathJax_Math-italic;\">r</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-16\">r</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-49\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-50\"><span class=\"mi\" id=\"MathJax-Span-51\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-17\">k</script>, calculate the number of integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-52\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-53\"><span class=\"mi\" id=\"MathJax-Span-54\" style=\"font-family: MathJax_Math-italic;\">x</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-18\">x</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-55\" style=\"width: 5.252em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.953em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1003.95em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-56\"><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-58\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-59\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">x</span><span class=\"mo\" id=\"MathJax-Span-60\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-61\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">r</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-19\">l \\le x \\le r</script> and the <span class=\"tex-font-style-it\">zebra value</span> of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-62\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-63\"><span class=\"mi\" id=\"MathJax-Span-64\" style=\"font-family: MathJax_Math-italic;\">x</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-20\">x</script> equals <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-65\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-66\"><span class=\"mi\" id=\"MathJax-Span-67\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-21\">k</script>.</p>",
  "inputSpecHtml": "<p>Each test consists of several test cases. The first line contains a single integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-68\" style=\"width: 0.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.33em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-69\"><span class=\"mi\" id=\"MathJax-Span-70\" style=\"font-family: MathJax_Math-italic;\">t</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-22\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-71\" style=\"width: 6.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.035em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.98em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-72\"><span class=\"mn\" id=\"MathJax-Span-73\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-74\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-75\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">t</span><span class=\"mo\" id=\"MathJax-Span-76\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-77\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">100</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-23\">1 \\le t \\le 100</script>)&nbsp;— the number of test cases. The description of test cases follows.</p><p>The only line of each test case contains three integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-78\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-79\"><span class=\"mi\" id=\"MathJax-Span-80\" style=\"font-family: MathJax_Math-italic;\">l</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-24\">l</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-81\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-82\"><span class=\"mi\" id=\"MathJax-Span-83\" style=\"font-family: MathJax_Math-italic;\">r</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-25\">r</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-84\" style=\"width: 9.256em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.983em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1006.98em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-85\"><span class=\"mn\" id=\"MathJax-Span-86\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-87\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-88\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">l</span><span class=\"mo\" id=\"MathJax-Span-89\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-90\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">r</span><span class=\"mo\" id=\"MathJax-Span-91\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-92\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.788em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-93\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"texatom\" id=\"MathJax-Span-94\"><span class=\"mrow\" id=\"MathJax-Span-95\"><span class=\"mn\" id=\"MathJax-Span-96\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">18</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-26\">1 \\le l \\le r \\le 10^{18}</script>) and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-97\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-98\"><span class=\"mi\" id=\"MathJax-Span-99\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-27\">k</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-100\" style=\"width: 7.254em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.468em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1005.47em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-101\"><span class=\"mn\" id=\"MathJax-Span-102\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-103\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-104\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">k</span><span class=\"mo\" id=\"MathJax-Span-105\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-106\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.788em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-107\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"texatom\" id=\"MathJax-Span-108\"><span class=\"mrow\" id=\"MathJax-Span-109\"><span class=\"mn\" id=\"MathJax-Span-110\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">18</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-28\">1 \\le k \\le 10^{18}</script>).</p>",
  "outputSpecHtml": "<p>For each test case, output a single integer&nbsp;— the number of integers in <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-111\" style=\"width: 2.33em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.734em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1001.63em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-112\"><span class=\"mo\" id=\"MathJax-Span-113\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-114\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-115\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-116\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-117\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-29\">[l, r]</script> with <span class=\"tex-font-style-it\">zebra value</span> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-118\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-119\"><span class=\"mi\" id=\"MathJax-Span-120\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-30\">k</script>.</p>",
  "noteHtml": "<p>In the first test case, there are <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-121\" style=\"width: 1.301em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.92em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-122\"><span class=\"mn\" id=\"MathJax-Span-123\" style=\"font-family: MathJax_Main;\">13</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-31\">13</script> suitable numbers: <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-124\" style=\"width: 22.892em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.319em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1017.26em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-125\"><span class=\"mn\" id=\"MathJax-Span-126\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-127\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-128\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">7</span><span class=\"mo\" id=\"MathJax-Span-129\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-130\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">11</span><span class=\"mo\" id=\"MathJax-Span-131\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-132\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">15</span><span class=\"mo\" id=\"MathJax-Span-133\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-134\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">23</span><span class=\"mo\" id=\"MathJax-Span-135\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-136\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">27</span><span class=\"mo\" id=\"MathJax-Span-137\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-138\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">31</span><span class=\"mo\" id=\"MathJax-Span-139\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-140\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">43</span><span class=\"mo\" id=\"MathJax-Span-141\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-142\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">47</span><span class=\"mo\" id=\"MathJax-Span-143\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-144\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">63</span><span class=\"mo\" id=\"MathJax-Span-145\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-146\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">87</span><span class=\"mo\" id=\"MathJax-Span-147\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-148\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">91</span><span class=\"mo\" id=\"MathJax-Span-149\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-150\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">95</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-32\">3, 7, 11, 15, 23, 27, 31, 43, 47, 63, 87, 91, 95</script>. </p><p>Each of them can be represented as a sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-151\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-152\"><span class=\"mn\" id=\"MathJax-Span-153\" style=\"font-family: MathJax_Main;\">3</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-33\">3</script> <span class=\"tex-font-style-it\">zebra-like</span> numbers.</p>",
  "samples": [
    {
      "input": "51 100 31 1 115 77 22 10 1001234567 123456789101112131 12",
      "output": "13\n1\n3\n0\n4246658701"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2086/problem/E",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>First, let's see how many <span class=\"tex-font-style-it\">zebra-Like</span> numbers less than or equal to $$$10^{18}$$$ exist. It turns out there are only $$$30$$$ of them, and based on some <span class=\"tex-font-style-it\">zebra-like</span> number $$$z_{i}$$$, the next one can be calculated using the formula $$$z_{i + 1} = 4 \\cdot z_{i} + 1$$$.</p><p>Then, we have to be able to quickly calculate the <span class=\"tex-font-style-it\">zebra value</span> for an arbitrary number $$$x$$$. Since each subsequent <span class=\"tex-font-style-it\">zebra-like</span> number is approximately $$$4$$$ times larger than the previous one, intuitively, it seems like a greedy algorithm should be optimal: for any number $$$x$$$, we can determine its <span class=\"tex-font-style-it\">zebra value</span> by subtracting the largest <span class=\"tex-font-style-it\">zebra-like</span> number that does not exceed $$$x$$$, until $$$x$$$ becomes $$$0$$$.</p><p>Let's prove the correctness of the greedy algorithm:</p><p>Assume that $$$y$$$ is the smallest number for which the greedy algorithm does not work, meaning that in the optimal decomposition of $$$y$$$ into <span class=\"tex-font-style-it\">zebra-like</span> numbers, the largest <span class=\"tex-font-style-it\">zebra-like</span> number $$$z_{i}$$$ that does not exceed $$$y$$$ does not appear at all.</p><p>If the greedy algorithm works for all numbers less than $$$y$$$, then in the decomposition of the number $$$y$$$, there must be at least one number $$$z_{i - 1}$$$. And since $$$y - z_{i - 1}$$$ can be decomposed greedily and will contain at least $$$3$$$ numbers $$$z_{i - 1}$$$, we will end up with at least $$$4$$$ numbers $$$z_{i - 1}$$$ in the decomposition.</p><p>Moreover, there will be at least $$$5$$$ numbers in the decomposition because $$$4 \\cdot z_{i - 1} &lt; z_{i}$$$, which means it is also less than $$$y$$$. Therefore, if the fifth number is $$$1$$$, we simply combine $$$4 \\cdot z_{i - 1}$$$ with $$$1$$$ to obtain $$$z_{i}$$$; otherwise, we decompose the fifth number into $$$4$$$ smaller numbers plus $$$1$$$, and we also combine this $$$1$$$ with $$$4 \\cdot z_{i - 1}$$$ to get $$$z_{i}$$$.</p><p>Thus, the new decomposition of the number $$$y$$$ into <span class=\"tex-font-style-it\">zebra-like</span> numbers will have no more numbers than the old one, but it will include the number $$$z_i$$$ — the maximum <span class=\"tex-font-style-it\">zebra-like</span> number that does not exceed $$$y$$$. This means that $$$y$$$ can be decomposed greedily.</p><p>We have reached a contradiction; therefore, the greedy algorithm works for any positive number.</p><p>Now, let's express the greedy decomposition of the number $$$x$$$ in a more convenient form. We will represent the decomposition as a string $$$s$$$ of length $$$30$$$ consisting of digits, where the $$$i$$$-th character will denote how many <span class=\"tex-font-style-it\">zebra</span> numbers $$$z_{i}$$$ are present in this decomposition.</p><p>Let's take a closer look at what such a string might look like:</p><ul> <li> $$$s_{i} \\in \\{0, 1, 2, 3, 4\\}$$$; </li><li> if $$$s_{i} = 4$$$, then for any $$$j &lt; i$$$, the character $$$s_{j} = 0$$$ (this follows from the proof of the greedy algorithm). </li></ul><p>Moreover, any number generates a unique string of this form. This is very similar to representing a number in a new numeric system, which we will call <span class=\"tex-font-style-it\">zebroid</span>.</p><p>In summary, the problem has been reduced to counting the number of numbers in the interval $$$[l, r]$$$ such that the sum of the digits in the <span class=\"tex-font-style-it\">zebroid</span> numeral system equals $$$x$$$. This is a standard problem that can be solved using dynamic programming on digits. Instead of counting the suitable numbers in the interval $$$[l, r]$$$, we will count the suitable numbers in the intervals $$$[1, l]$$$ and $$$[1, r]$$$ and subtract the first from the second to get the answer. Let $$$\\text{dp}[\\text{ind}][\\text{sum}][\\text{num_less_m}][\\text{was_4}]$$$ be the number of numbers in the interval $$$[1, m]$$$ such that:</p><ul> <li> they have $$$\\text{ind} + 1$$$ digits; </li><li> the sum of the digits equals $$$\\text{sum}$$$; </li><li> $$$\\text{num_less_m} = 0$$$ if the prefix of $$$\\text{ind} + 1$$$ digits of the number $$$m$$$ is lexicographically greater than these numbers, otherwise $$$\\text{num_less_m} = 1$$$; </li><li> $$$\\text{was_4} = 0$$$ if there has not been a $$$4$$$ in the $$$\\text{ind} + 1$$$ digits of these numbers yet, otherwise $$$\\text{was_4} = 1$$$. </li></ul><p>Transitions in this dynamic programming are not very difficult — they are basically appending a new digit at the end.</p><p>The complexity of the solution is $$$O(\\log^2 A)$$$, if we estimate the number of <span class=\"tex-font-style-it\">zebra-like</span> numbers up to $$$A = 10^{18}$$$ as $$$\\log A$$$.</p><p><span class=\"tex-font-style-bf\">Alternative solution (BledDest)</span></p><p>First, let's prove that we can decompose numbers into zebra-like numbers greedily, constantly subtracting the maximum zebra-like number we can (the proof is the same as in the first solution).</p><p>After that, we will learn to calculate the following dynamic programming: $$$dp_{i,j}$$$ — the number of numbers from $$$0$$$ to $$$i-1$$$ with a zebra value of exactly $$$j$$$. The base states of the dynamic programming will be as follows:</p><ul> <li> $$$dp_{0,x} = 0$$$ (since there are no numbers in the interval); </li><li> $$$dp_{1,0} = 1$$$ (since the number $$$0$$$ has a zebra value of $$$0$$$); </li><li> $$$dp_{1,i} = 0$$$ for $$$i \\ne 0$$$ (similarly); </li><li> $$$dp_{i,j} = 0$$$ for $$$i &lt; 0$$$ (numbers cannot have negative zebra value). Additionally, the same can be done for $$$j$$$ greater than the number of zebra-like numbers multiplied by $$$4$$$ (since there cannot be more than $$$4$$$ identical zebra-like numbers in the decomposition of a number). </li></ul><p>Okay, now let's consider the transitions in this dynamic programming. Suppose we want to calculate $$$dp_{i,j}$$$. We find the largest zebra-like number $$$k$$$ that is less than $$$i$$$. Then for all numbers from $$$k$$$ to $$$i-1$$$, the maximum zebra number in the decomposition is $$$k$$$, and if we subtract it from them, we get the interval of numbers from $$$0$$$ to $$$i-k-1$$$. Therefore, $$$dp_{i,j} = dp_{k,j} + dp_{i-k,j-1}$$$.</p><p>Intuitively, it seems that there are not many states in this dynamic programming, so it can be calculated \"lazily\", and we can store all already computed values in a <span class=\"tex-font-style-tt\">map</span>. But let's prove this.</p><p>$$$j$$$ will be on the order of $$$\\log A$$$, so let's estimate the number of different values of $$$i$$$ that we will need. We will divide them into two categories — zebra-like numbers $$$i$$$ and all others.</p><p>If $$$i$$$ is a zebra-like number, then the previous zebra number is $$$k = \\frac{i - 1}{4}$$$. Therefore, $$$dp_{i,j} = dp_{k,j} + dp_{i-k,j-1} = \\dots = dp_{k,j} + dp_{k,j-1} + dp_{k,j-2} + dp_{k,j-3} + dp_{1,j-4}$$$. Thus, the states where $$$i$$$ is a zebra-like number generate $$$O(1)$$$ new states, and in total, the states where $$$i$$$ is zebra-like and the states generated by them will require only $$$O(\\log A)$$$ different values of $$$i$$$.</p><p>If $$$i$$$ is not a zebra-like number, one of the transitions leads to a state with a zebra-like number, and the other does not. That is, from each state, there is a \"chain\" of states with values of $$$i$$$ that are not zebra-like numbers, and the length of such a chain is $$$O(\\log A)$$$ (since every $$$O(1)$$$ steps in the chain effectively take $$$i$$$ modulo some zebra-like number), so there will be a total of $$$O(\\log A)$$$ values of $$$i$$$ that are not zebra numbers.</p><p>Thus, the total number of states in the dynamic programming will be $$$O(\\log^2 A)$$$, so the entire solution will work in $$$O(\\log^2 A \\log \\log A)$$$ for each test case.</p></div></div></div></div>"
}