{
  "contestId": 2086,
  "index": "D",
  "title": "Even String",
  "timeLimit": "2 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 1700,
  "tags": [
    "brute force",
    "combinatorics",
    "dp",
    "math",
    "strings"
  ],
  "statementHtml": "<p>You would like to construct a string <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2\">s</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">s</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-1\">s</script>, consisting of lowercase Latin letters, such that the following condition holds:</p>\n<p>Constructing any string is too easy, so you will be given an array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-38\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-39\">c</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-38\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-39\"><span class=\"mi\" id=\"MathJax-Span-40\" style=\"font-family: MathJax_Math-italic;\">c</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-6\">c</script> of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-40\"><span class=\"MJXp-mn\" id=\"MJXp-Span-41\">26</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-41\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-42\"><span class=\"mn\" id=\"MathJax-Span-43\" style=\"font-family: MathJax_Main;\">26</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-7\">26</script> numbers&nbsp;— the required number of occurrences of each individual letter in the string <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-42\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-43\">s</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-44\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-45\"><span class=\"mi\" id=\"MathJax-Span-46\" style=\"font-family: MathJax_Math-italic;\">s</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-8\">s</script>. So, for every <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-44\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-45\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-46\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">∈</span><span class=\"MJXp-mo\" id=\"MJXp-Span-47\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-48\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-49\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-50\">26</span><span class=\"MJXp-mo\" id=\"MJXp-Span-51\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-47\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-48\"><span class=\"mi\" id=\"MathJax-Span-49\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-50\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">∈</span><span class=\"mo\" id=\"MathJax-Span-51\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">[</span><span class=\"mn\" id=\"MathJax-Span-52\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-53\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-54\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">26</span><span class=\"mo\" id=\"MathJax-Span-55\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-9\">i \\in [1, 26]</script>, the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-52\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-53\">i</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-56\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-57\"><span class=\"mi\" id=\"MathJax-Span-58\" style=\"font-family: MathJax_Math-italic;\">i</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-10\">i</script>-th letter of the Latin alphabet should occur exactly <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-54\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-55\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-56\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-57\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-59\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-60\"><span class=\"msubsup\" id=\"MathJax-Span-61\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-62\" style=\"font-family: MathJax_Math-italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-63\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-11\">c_i</script> times.</p>\n<p>Your task is to count the number of distinct strings <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-58\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-59\">s</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-64\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-65\"><span class=\"mi\" id=\"MathJax-Span-66\" style=\"font-family: MathJax_Math-italic;\">s</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-12\">s</script> that satisfy all these conditions. Since the answer can be huge, output it modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-60\"><span class=\"MJXp-mn\" id=\"MJXp-Span-61\">998</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-62\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-63\">244</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-64\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-65\">353</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-67\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-68\"><span class=\"mn\" id=\"MathJax-Span-69\" style=\"font-family: MathJax_Main;\">998</span><span class=\"mspace\" id=\"MathJax-Span-70\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-71\" style=\"font-family: MathJax_Main;\">244</span><span class=\"mspace\" id=\"MathJax-Span-72\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-73\" style=\"font-family: MathJax_Main;\">353</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-13\">998\\,244\\,353</script>.</p>",
  "inputSpecHtml": "<p>Each test consists of several test cases. The first line contains a single integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-66\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-67\">t</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-74\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-75\"><span class=\"mi\" id=\"MathJax-Span-76\" style=\"font-family: MathJax_Math-italic;\">t</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-14\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-68\"><span class=\"MJXp-mn\" id=\"MJXp-Span-69\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-70\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-71\">t</span><span class=\"MJXp-mo\" id=\"MJXp-Span-72\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-73\"><span class=\"MJXp-mn\" id=\"MJXp-Span-74\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-75\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-76\">4</span></span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-77\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-78\"><span class=\"mn\" id=\"MathJax-Span-79\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-80\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-81\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">t</span><span class=\"mo\" id=\"MathJax-Span-82\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-83\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-84\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"texatom\" id=\"MathJax-Span-85\"><span class=\"mrow\" id=\"MathJax-Span-86\"><span class=\"mn\" id=\"MathJax-Span-87\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">4</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-15\">1 \\le t \\le 10^{4}</script>)— the number of test cases. The description of test cases follows.</p><p>Each test case contains <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-77\"><span class=\"MJXp-mn\" id=\"MJXp-Span-78\">26</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-88\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-89\"><span class=\"mn\" id=\"MathJax-Span-90\" style=\"font-family: MathJax_Main;\">26</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-16\">26</script> integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-79\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-80\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-81\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-82\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-83\">i</span></span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-91\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-92\"><span class=\"msubsup\" id=\"MathJax-Span-93\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-94\" style=\"font-family: MathJax_Math-italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"texatom\" id=\"MathJax-Span-95\"><span class=\"mrow\" id=\"MathJax-Span-96\"><span class=\"mi\" id=\"MathJax-Span-97\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-17\">c_{i}</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-84\"><span class=\"MJXp-mn\" id=\"MJXp-Span-85\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-86\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-87\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-88\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-89\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-90\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-91\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-92\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-93\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-94\"><span class=\"MJXp-mn\" id=\"MJXp-Span-95\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-96\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-97\">5</span></span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-98\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-99\"><span class=\"mn\" id=\"MathJax-Span-100\" style=\"font-family: MathJax_Main;\">0</span><span class=\"mo\" id=\"MathJax-Span-101\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-102\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-103\" style=\"font-family: MathJax_Math-italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"texatom\" id=\"MathJax-Span-104\"><span class=\"mrow\" id=\"MathJax-Span-105\"><span class=\"mi\" id=\"MathJax-Span-106\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-107\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-108\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">5</span><span class=\"mo\" id=\"MathJax-Span-109\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-110\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-111\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"texatom\" id=\"MathJax-Span-112\"><span class=\"mrow\" id=\"MathJax-Span-113\"><span class=\"mn\" id=\"MathJax-Span-114\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">5</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-18\">0 \\le c_{i} \\le 5 \\cdot 10^{5}</script>)— the elements of the array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-98\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-99\">c</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-115\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-116\"><span class=\"mi\" id=\"MathJax-Span-117\" style=\"font-family: MathJax_Math-italic;\">c</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-19\">c</script>.</p><p>Additional constraints on the input data:</p><ul> <li> The sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-100\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-101\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-102\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-103\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-104\">i</span></span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-118\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-119\"><span class=\"msubsup\" id=\"MathJax-Span-120\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-121\" style=\"font-family: MathJax_Math-italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"texatom\" id=\"MathJax-Span-122\"><span class=\"mrow\" id=\"MathJax-Span-123\"><span class=\"mi\" id=\"MathJax-Span-124\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-20\">c_{i}</script> for every test case is positive; </li><li> The sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-105\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-106\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-107\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-108\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-109\">i</span></span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-125\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-126\"><span class=\"msubsup\" id=\"MathJax-Span-127\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-128\" style=\"font-family: MathJax_Math-italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"texatom\" id=\"MathJax-Span-129\"><span class=\"mrow\" id=\"MathJax-Span-130\"><span class=\"mi\" id=\"MathJax-Span-131\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-21\">c_{i}</script> over all test cases does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-110\"><span class=\"MJXp-mn\" id=\"MJXp-Span-111\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-112\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-113\"><span class=\"MJXp-mn\" id=\"MJXp-Span-114\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-115\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-116\">5</span></span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-132\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-133\"><span class=\"mn\" id=\"MathJax-Span-134\" style=\"font-family: MathJax_Main;\">5</span><span class=\"mo\" id=\"MathJax-Span-135\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-136\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-137\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"texatom\" id=\"MathJax-Span-138\"><span class=\"mrow\" id=\"MathJax-Span-139\"><span class=\"mn\" id=\"MathJax-Span-140\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">5</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-22\">5 \\cdot 10^{5}</script>. </li></ul>",
  "outputSpecHtml": "<p>For each test case, print one integer — the number of suitable strings <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-117\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-118\">s</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-141\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-142\"><span class=\"mi\" id=\"MathJax-Span-143\" style=\"font-family: MathJax_Math-italic;\">s</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-23\">s</script>, taken modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-119\"><span class=\"MJXp-mn\" id=\"MJXp-Span-120\">998</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-121\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-122\">244</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-123\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-124\">353</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-144\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-145\"><span class=\"mn\" id=\"MathJax-Span-146\" style=\"font-family: MathJax_Main;\">998</span><span class=\"mspace\" id=\"MathJax-Span-147\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-148\" style=\"font-family: MathJax_Main;\">244</span><span class=\"mspace\" id=\"MathJax-Span-149\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-150\" style=\"font-family: MathJax_Main;\">353</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-24\">998\\,244\\,353</script>.</p>",
  "noteHtml": "<p>In the first test case, there are <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-125\"><span class=\"MJXp-mn\" id=\"MJXp-Span-126\">4</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-151\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-152\"><span class=\"mn\" id=\"MathJax-Span-153\" style=\"font-family: MathJax_Main;\">4</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-25\">4</script> suitable strings: \"<span class=\"tex-font-style-tt\">abak</span>\", \"<span class=\"tex-font-style-tt\">akab</span>\", \"<span class=\"tex-font-style-tt\">baka</span>\" and \"<span class=\"tex-font-style-tt\">kaba</span>\".</p>",
  "samples": [
    {
      "input": "52 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 03 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 1 00 0 0 0 0 0 0 0 0 0 0 0 1 0 3 0 0 0 0 0 0 0 0 0 0 01 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 01 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 233527 233827",
      "output": "4\n960\n0\n1\n789493841"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2086/problem/D",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>From the statement, it follows that all identical letters in $$$s$$$ must be positioned either at even indices or at odd indices simultaneously.</p><p>Let's examine how the ways to construct the string $$$s$$$ are formed:</p><ol> <li> A subset of letters that we take for the odd positions (the remaining letters will be at the even positions); </li><li> The number of ways to create a string with a fixed subset of letters at the odd positions. </li></ol><p>Let $$$S$$$ denote the sum of the array $$$c$$$. We also denote $$$odd = \\lceil\\frac{S}{2}\\rceil$$$ as the number of odd positions, and $$$even = \\lfloor\\frac{S}{2}\\rfloor$$$ as the number of even positions.</p><p>For now, let's ignore the second point and calculate how many ways there are to distribute the letters such that we can create at least one suitable string $$$s$$$. That is, we need to count the number of ways to choose a set of letters that will occupy the odd positions. This resembles a modification of the classical <a href=\"https://en.wikipedia.org/wiki/Knapsack_problem\">knapsack problem</a>, which can be solved using dynamic programming. Let $$$\\text{dp}[i]$$$ denote the number of ways to take a subset of letters such that the number of letters taken equals $$$i$$$. The base case of the dynamic programming is $$$\\text{dp}[i] = 0$$$, and the entire dynamic can be computed using two nested loops:</p><pre class=\"lstlisting\"><code class=\"prettyprint prettyprinted\" style=\"\"><span class=\"pln\">dp</span><span class=\"pun\">[</span><span class=\"lit\">0</span><span class=\"pun\">]</span><span class=\"pln\"> </span><span class=\"pun\">=</span><span class=\"pln\"> </span><span class=\"lit\">1</span><span class=\"pun\">;</span><br><span class=\"kwd\">for</span><span class=\"pln\"> </span><span class=\"pun\">(</span><span class=\"kwd\">int</span><span class=\"pln\"> i </span><span class=\"pun\">=</span><span class=\"pln\"> </span><span class=\"lit\">0</span><span class=\"pun\">;</span><span class=\"pln\"> i </span><span class=\"pun\">&lt;</span><span class=\"pln\"> </span><span class=\"lit\">26</span><span class=\"pun\">;</span><span class=\"pln\"> i</span><span class=\"pun\">++){</span><br><span class=\"pln\">    </span><span class=\"kwd\">if</span><span class=\"pln\"> </span><span class=\"pun\">(</span><span class=\"pln\">c</span><span class=\"pun\">[</span><span class=\"pln\">i</span><span class=\"pun\">]</span><span class=\"pln\"> </span><span class=\"pun\">==</span><span class=\"pln\"> </span><span class=\"lit\">0</span><span class=\"pun\">){</span><br><span class=\"pln\">        </span><span class=\"kwd\">continue</span><span class=\"pun\">;</span><br><span class=\"pln\">    </span><span class=\"pun\">}</span><br><span class=\"pln\">    </span><span class=\"kwd\">for</span><span class=\"pln\"> </span><span class=\"pun\">(</span><span class=\"kwd\">int</span><span class=\"pln\"> j </span><span class=\"pun\">=</span><span class=\"pln\"> s</span><span class=\"pun\">;</span><span class=\"pln\"> j </span><span class=\"pun\">&gt;=</span><span class=\"pln\"> </span><span class=\"lit\">0</span><span class=\"pun\">;</span><span class=\"pln\"> j</span><span class=\"pun\">--){</span><br><span class=\"pln\">        </span><span class=\"kwd\">if</span><span class=\"pln\"> </span><span class=\"pun\">(</span><span class=\"pln\">j </span><span class=\"pun\">+</span><span class=\"pln\"> c</span><span class=\"pun\">[</span><span class=\"pln\">i</span><span class=\"pun\">]</span><span class=\"pln\"> </span><span class=\"pun\">&lt;=</span><span class=\"pln\"> s</span><span class=\"pun\">){</span><br><span class=\"pln\">            dp</span><span class=\"pun\">[</span><span class=\"pln\">j </span><span class=\"pun\">+</span><span class=\"pln\"> c</span><span class=\"pun\">[</span><span class=\"pln\">i</span><span class=\"pun\">]]</span><span class=\"pln\"> </span><span class=\"pun\">=</span><span class=\"pln\"> </span><span class=\"pun\">(</span><span class=\"pln\">dp</span><span class=\"pun\">[</span><span class=\"pln\">j </span><span class=\"pun\">+</span><span class=\"pln\"> c</span><span class=\"pun\">[</span><span class=\"pln\">i</span><span class=\"pun\">]]</span><span class=\"pln\"> </span><span class=\"pun\">+</span><span class=\"pln\"> dp</span><span class=\"pun\">[</span><span class=\"pln\">j</span><span class=\"pun\">])</span><span class=\"pln\"> </span><span class=\"pun\">%</span><span class=\"pln\"> MOD</span><span class=\"pun\">;</span><br><span class=\"pln\">        </span><span class=\"pun\">}</span><br><span class=\"pln\">    </span><span class=\"pun\">}</span><br><span class=\"pun\">}</span><br></code></pre><p>The number we're interested in will be in $$$\\text{dp}[odd]$$$.</p><p>Now we need to understand what to do with point $$$2$$$. Notice that if we have fixed a subset of letters $$$X$$$ at the odd positions, then the number of ways to create the string is equal to the product of the multinomial coefficients:</p><p>$$$$$$ \\frac{odd!}{\\prod_{i \\in X} c_{i}!} \\cdot \\frac{even!}{\\prod_{i \\notin X} c_{i}!}$$$$$$</p><p>Notice that this product is a constant, meaning it does not depend on the specific subset $$$X$$$:</p><p>$$$$$$ \\frac{odd! \\cdot even!}{\\prod_{i = 0}^{26} c_{i}!} $$$$$$</p><p>Thus, the answer to the entire problem is simply the product:</p><p>$$$$$$ \\frac{odd! \\cdot even!}{\\prod_{i = 0}^{26} c_{i}!} \\cdot \\text{dp}[odd] $$$$$$</p><p>The total complexity complexity is $$$O(S \\cdot 26)$$$.</p></div></div></div></div>"
}