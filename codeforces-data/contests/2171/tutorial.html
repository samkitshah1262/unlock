<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/148567" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>I hope you all enjoyed the contest! Special thanks to</p> <ul>   <li><a class="rated-user user-orange" href="https://codeforces.com/profile/djm03178" title="Master djm03178">djm03178</a> for suggesting the inclusion of C1, and for helping with test writing on all problems, especially F</li>   <li><a class="rated-user user-orange" href="https://codeforces.com/profile/satyam343" title="Master satyam343">satyam343</a> for helping me solve H</li>   <li><a class="rated-user user-legendary" href="https://codeforces.com/profile/Dominater069" title="Legendary Grandmaster Dominater069"><span class="legendary-user-first-letter">D</span>ominater069</a> for providing the idea for one of the solutions to E</li>   <li><a class="rated-user user-red" href="https://codeforces.com/profile/Intellegent" title="Grandmaster Intellegent">Intellegent</a> for providing one of the proofs for the solution to D, and for providing the idea for one of the solutions to F</li> </ul> <div class="spoiler"><b class="spoiler-title">Rate the contest!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>
<style data-nocturne="true" type="text/css">

</style>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13681">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="292">292</span>
            </i>
        </a>
    </span>

    <script>
        $(function() {
            const likeFormUtil = {};
            likeFormUtil.getCount = function ($count) {
                return Number($count.attr("data-value"));
            };
            likeFormUtil.setCount = function ($count, value) {
                $count.attr("data-value", value);
                $count.text(value);
            };
            likeFormUtil.like = function ($likeForm) {
                $likeForm.find(".likeState").addClass("liked");
                const $likeCount = $likeForm.find(".likeCount");
                likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) + 1);
            };
            likeFormUtil.unLike = function ($likeForm) {
                if ($likeForm.find(".likeState").hasClass("liked")) {
                    $likeForm.find(".likeState").removeClass("liked");
                    const $likeCount = $likeForm.find(".likeCount");
                    likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) - 1);
                }
            };
            likeFormUtil.dislike = function ($likeForm) {
                $likeForm.find(".dislikeState").addClass("disliked");
                const $dislikeCount = $likeForm.find(".dislikeCount");
                likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) + 1);
            };
            likeFormUtil.unDislike = function ($likeForm) {
                if ($likeForm.find(".dislikeState").hasClass("disliked")) {
                    $likeForm.find(".dislikeState").removeClass("disliked");
                    const $dislikeCount = $likeForm.find(".dislikeCount");
                    likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) - 1);
                }
            };
            likeFormUtil.disable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", function () {
                    return false;
                });
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", function () {
                    return false;
                });
            };
            likeFormUtil.enable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", onLike);
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", onDislike);
            };
            likeFormUtil.applyLikeableInformation = function(likeableInformation) {
                const id = likeableInformation.likeable.id;
                console.log(id);
                const $likeForm = $(".likeActionLink[data-likeableId='" + id + "']").closest(".likeForm");
                console.log($likeForm);
                likeFormUtil.setCount($likeForm.find(".likeCount"), likeableInformation.likeCount);
                likeFormUtil.setCount($likeForm.find(".dislikeCount"), likeableInformation.dislikeCount);
                if (likeableInformation.liked) {
                    $likeForm.find(".likeState").addClass("liked");
                } else {
                    $likeForm.find(".likeState").removeClass("liked");
                }
                if (likeableInformation.disliked) {
                    $likeForm.find(".likeState").addClass("disliked");
                } else {
                    $likeForm.find(".likeState").removeClass("disliked");
                }
            }
            likeFormUtil.applyLikeableInformations = function(likeableInformations) {
                likeableInformations.forEach((applyLikeableInformation) => {
                    likeFormUtil.applyLikeableInformation(applyLikeableInformation);
                });
            }

            function onLike() {
                const $likeActionLink = $(this);
                const likeableId = $likeActionLink.attr("data-likeableId");
                const $likeForm = $likeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "like",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["liked"]) {
                            Codeforces.showMessage('Added to liked');
                        } else {
                            Codeforces.showMessage('Removed from liked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            function onDislike() {
                const $dislikeActionLink = $(this);
                const likeableId = $dislikeActionLink.attr("data-likeableId");
                const $likeForm = $dislikeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "dislike",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["disliked"]) {
                            Codeforces.showMessage('Added to disliked');
                        } else {
                            Codeforces.showMessage('Removed from disliked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            $(".likeActionLink").click(onLike);
            $(".dislikeActionLink").click(onDislike);

            $(".likeCount").add(".dislikeCount").each(function () {
                const $count = $(this);
                likeFormUtil.setCount($count, likeFormUtil.getCount($count));
            });
        });
    </script>

<script data-nocturne="true"> $(function () {
}); </script>

 Excellent contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13682">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="40">40</span>
            </i>
        </a>
    </span>


 Good contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13683">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


 Average contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13684">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="4">4</span>
            </i>
        </a>
    </span>


 Bad contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13685">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="20">20</span>
            </i>
        </a>
    </span>


 Horrible contest</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13686">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


 Trivial contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13687">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="24">24</span>
            </i>
        </a>
    </span>


 Easy contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13688">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="164">164</span>
            </i>
        </a>
    </span>


 Average contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13689">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="136">136</span>
            </i>
        </a>
    </span>


 Hard contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13690">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


 Impossible contest</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2171/problem/A">A — Shizuku Hoshikawa and Farm Legs</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">n</span></span></span><script type="math/tex" id="MathJax-Element-1">n</script> is odd, there are clearly zero possible configurations.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Suppose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">n</span></span></span><script type="math/tex" id="MathJax-Element-2">n</script> is even. Then consider the number of legs that belong to cows. This can be any multiple of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mn" id="MJXp-Span-6">4</span></span></span><script type="math/tex" id="MathJax-Element-3">4</script> that is less than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">n</span></span></span><script type="math/tex" id="MathJax-Element-4">n</script>. The remaining legs will belong to chickens. Thus, the answer is equal to the number of nonnegative multiples of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mn" id="MJXp-Span-10">4</span></span></span><script type="math/tex" id="MathJax-Element-5">4</script> which are less than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">n</span></span></span><script type="math/tex" id="MathJax-Element-6">n</script>, which is given by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-15" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-17">4</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-20">1</span></span></span><script type="math/tex" id="MathJax-Element-7">\lfloor \frac{n}{4} \rfloor + 1</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> n</span><span class="pun">/</span><span class="lit">4</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13691">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="20">20</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13692">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="189">189</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13693">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="54">54</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13694">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="4">4</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13695">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="4">4</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13696">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="215">215</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13697">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="58">58</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13698">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="4">4</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13699">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13700">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2171/problem/B">B — Yuu Koito and Minimum Absolute Sum</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>The given expression is equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mrow" id="MJXp-Span-22"><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-25"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-27" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-31" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-37" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-39"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-41" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-51"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-53" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">n</span><span class="MJXp-mo" id="MJXp-Span-55">−</span><span class="MJXp-mn" id="MJXp-Span-56">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-58"><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-8">|(a_2 - a_1) + (a_3 - a_2) + \dots + (a_n - a_{n-1})|</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>This simplifies to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-60"><span class="MJXp-mrow" id="MJXp-Span-61"><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-65" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-70"><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-9">|a_n - a_1|</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>We want to minimize the absolute difference between the first and last elements. To do so, if one of them is set and the other one isn't, we will set them to be equal. Now, the remaining blank elements do not affect the given expression, so we can set them all to be zero.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> abs</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" \n"</span><span class="pun">[</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13701">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="184">184</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13702">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="60">60</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13703">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="22">22</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13704">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="4">4</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13705">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13706">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="26">26</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13707">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="132">132</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13708">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="74">74</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13709">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="39">39</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13710">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2171/problem/C2">C1/C2 — Renako Amaori and XOR Game</a></h4> <div class="spoiler"><b class="spoiler-title">Solution (Easy Version)</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>The <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-mrow" id="MJXp-Span-73"><span class="MJXp-mi" id="MJXp-Span-74">X</span><span class="MJXp-mi" id="MJXp-Span-75">O</span><span class="MJXp-mi" id="MJXp-Span-76">R</span></span></span></span><script type="math/tex" id="MathJax-Element-10">\mathrm{XOR}</script> of all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-77"><span class="MJXp-mn" id="MJXp-Span-78">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">n</span></span></span><script type="math/tex" id="MathJax-Element-11">2n</script> elements is invariant. Note that this is also equal to the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mrow" id="MJXp-Span-81"><span class="MJXp-mi" id="MJXp-Span-82">X</span><span class="MJXp-mi" id="MJXp-Span-83">O</span><span class="MJXp-mi" id="MJXp-Span-84">R</span></span></span></span><script type="math/tex" id="MathJax-Element-12">\mathrm{XOR}</script> between Ajisai and Mai's final scores. Therefore, if this value is zero, the game ends in a tie. Otherwise, Ajisai and Mai's final scores will differ, so the game does not end in a tie.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Suppose the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-85"><span class="MJXp-mrow" id="MJXp-Span-86"><span class="MJXp-mi" id="MJXp-Span-87">X</span><span class="MJXp-mi" id="MJXp-Span-88">O</span><span class="MJXp-mi" id="MJXp-Span-89">R</span></span></span></span><script type="math/tex" id="MathJax-Element-13">\mathrm{XOR}</script> of all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-90"><span class="MJXp-mn" id="MJXp-Span-91">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">n</span></span></span><script type="math/tex" id="MathJax-Element-14">2n</script> elements is nonzero. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-93"><span class="MJXp-msubsup" id="MJXp-Span-94"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-96" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-100" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-15">a_i = b_i</script>, then the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">i</span></span></span><script type="math/tex" id="MathJax-Element-16">i</script>-th turn is useless. Now, consider the <strong>largest</strong> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">i</span></span></span><script type="math/tex" id="MathJax-Element-17">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-msubsup" id="MJXp-Span-106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-108" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-112" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-18">a_i \neq b_i</script>. This person can control whose score is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-mn" id="MJXp-Span-114">0</span></span></span><script type="math/tex" id="MathJax-Element-19">0</script> and whose score is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-115"><span class="MJXp-mn" id="MJXp-Span-116">1</span></span></span><script type="math/tex" id="MathJax-Element-20">1</script>. Since all future turns are useless, they win. Therefore, if the largest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">i</span></span></span><script type="math/tex" id="MathJax-Element-21">i</script> satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-119"><span class="MJXp-msubsup" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-122" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-126" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-22">a_i \neq b_i</script> is odd, Ajisai wins. Otherwise, Mai wins.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> idx</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">),</span><span class="pln"> b</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        x </span><span class="pun">^=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        x </span><span class="pun">^=</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">x</span><span class="pun">){</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"Tie"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
            idx </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">idx </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="str">"Mai"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"Ajisai"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (Hard Version)</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>The <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-127"><span class="MJXp-mrow" id="MJXp-Span-128"><span class="MJXp-mi" id="MJXp-Span-129">X</span><span class="MJXp-mi" id="MJXp-Span-130">O</span><span class="MJXp-mi" id="MJXp-Span-131">R</span></span></span></span><script type="math/tex" id="MathJax-Element-23">\mathrm{XOR}</script> of all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-mn" id="MJXp-Span-133">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">n</span></span></span><script type="math/tex" id="MathJax-Element-24">2n</script> elements is equal to the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-135"><span class="MJXp-mrow" id="MJXp-Span-136"><span class="MJXp-mi" id="MJXp-Span-137">X</span><span class="MJXp-mi" id="MJXp-Span-138">O</span><span class="MJXp-mi" id="MJXp-Span-139">R</span></span></span></span><script type="math/tex" id="MathJax-Element-25">\mathrm{XOR}</script> between Ajisai and Mai's final scores. Therefore, we know exactly what bits their scores will differ in.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>The most significant of these bits dictates who wins the game. Therefore, we can apply the solution from the easy version to the most significant bit of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-140"><span class="MJXp-mrow" id="MJXp-Span-141"><span class="MJXp-mi" id="MJXp-Span-142">X</span><span class="MJXp-mi" id="MJXp-Span-143">O</span><span class="MJXp-mi" id="MJXp-Span-144">R</span></span></span></span><script type="math/tex" id="MathJax-Element-26">\mathrm{XOR}</script> of all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-mn" id="MJXp-Span-146">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">n</span></span></span><script type="math/tex" id="MathJax-Element-27">2n</script> elements.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> bit</span><span class="pun">,</span><span class="pln"> idx</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">),</span><span class="pln"> b</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        x </span><span class="pun">^=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        x </span><span class="pun">^=</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">x</span><span class="pun">){</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"Tie"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="lit">20</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
            bit </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">((</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]^</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])&amp;</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">bit</span><span class="pun">)</span><span class="pln">
            idx </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">idx </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="str">"Mai"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"Ajisai"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Bonus</b><div class="spoiler-content" style="display: block;"><p>Can you find the difference between the players' scores, where the winner tries to maximize this value and the loser tries to minimize this value? I don't have a solution, but I suspect this may be impossible in polynomial time. Leave a comment if you have either a solution or a proof that it's impossible.</p></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13711">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="306">306</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13712">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="53">53</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13713">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13714">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13715">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="23">23</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13716">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13717">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="24">24</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13718">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="130">130</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13719">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="227">227</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13720">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2171/problem/F">D/F — Rae Taylor and Trees</a></h4> <div class="spoiler"><b class="spoiler-title">Solution (Easy Version)</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-148"><span class="MJXp-msubsup" id="MJXp-Span-149"><span class="MJXp-mrow" id="MJXp-Span-150" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-151">p</span><span class="MJXp-mi" id="MJXp-Span-152">r</span><span class="MJXp-mi" id="MJXp-Span-153">e</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-154" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-28">\mathrm{pre}_i</script> denote the <strong>minimum</strong> of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-155"><span class="MJXp-msubsup" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-158" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-164" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-29">p_1, \dots, p_i</script>, and let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-165"><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mrow" id="MJXp-Span-167" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-168">s</span><span class="MJXp-mi" id="MJXp-Span-169">u</span><span class="MJXp-mi" id="MJXp-Span-170">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-171" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-30">\mathrm{suf}_i</script> denote the <strong>maximum</strong> of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-172"><span class="MJXp-msubsup" id="MJXp-Span-173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-175" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-177" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-181" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-31">p_i, \dots, p_n</script>. Then if there exists some <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">i</span></span></span><script type="math/tex" id="MathJax-Element-32">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-184"><span class="MJXp-msubsup" id="MJXp-Span-185"><span class="MJXp-mrow" id="MJXp-Span-186" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-187">p</span><span class="MJXp-mi" id="MJXp-Span-188">r</span><span class="MJXp-mi" id="MJXp-Span-189">e</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-190" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">i</span><span class="MJXp-mo" id="MJXp-Span-192">−</span><span class="MJXp-mn" id="MJXp-Span-193">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-195"><span class="MJXp-mrow" id="MJXp-Span-196" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-197">s</span><span class="MJXp-mi" id="MJXp-Span-198">u</span><span class="MJXp-mi" id="MJXp-Span-199">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-200" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-33">\mathrm{pre}_{i-1} > \mathrm{suf}_i</script>, then the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-201"><span class="MJXp-mrow" id="MJXp-Span-202"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-203">No</span></span></span></span><script type="math/tex" id="MathJax-Element-34">\texttt{No}</script>. This is because there is no edge from any value in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-204"><span class="MJXp-msubsup" id="MJXp-Span-205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-207" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-213" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">i</span><span class="MJXp-mo" id="MJXp-Span-215">−</span><span class="MJXp-mn" id="MJXp-Span-216">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-35">p_1, \dots, p_{i-1}</script> to any value in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-217"><span class="MJXp-msubsup" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-220" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-226" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-36">p_i, \dots, p_n</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Otherwise, suppose that for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">i</span></span></span><script type="math/tex" id="MathJax-Element-37">i</script>, we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-229"><span class="MJXp-msubsup" id="MJXp-Span-230"><span class="MJXp-mrow" id="MJXp-Span-231" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-232">p</span><span class="MJXp-mi" id="MJXp-Span-233">r</span><span class="MJXp-mi" id="MJXp-Span-234">e</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-235" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">i</span><span class="MJXp-mo" id="MJXp-Span-237">−</span><span class="MJXp-mn" id="MJXp-Span-238">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-240"><span class="MJXp-mrow" id="MJXp-Span-241" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-242">s</span><span class="MJXp-mi" id="MJXp-Span-243">u</span><span class="MJXp-mi" id="MJXp-Span-244">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-245" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-38">\mathrm{pre}_{i-1} < \mathrm{suf}_i</script>. Then for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">i</span></span></span><script type="math/tex" id="MathJax-Element-39">i</script>, we have that there exists a path from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-msubsup" id="MJXp-Span-249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-251" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">i</span><span class="MJXp-mo" id="MJXp-Span-253">−</span><span class="MJXp-mn" id="MJXp-Span-254">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-40">p_{i-1}</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-msubsup" id="MJXp-Span-256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-258" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-41">p_i</script>, by going from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-259"><span class="MJXp-msubsup" id="MJXp-Span-260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-262" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">i</span><span class="MJXp-mo" id="MJXp-Span-264">−</span><span class="MJXp-mn" id="MJXp-Span-265">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-42">p_{i-1}</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-266"><span class="MJXp-msubsup" id="MJXp-Span-267"><span class="MJXp-mrow" id="MJXp-Span-268" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-269">p</span><span class="MJXp-mi" id="MJXp-Span-270">r</span><span class="MJXp-mi" id="MJXp-Span-271">e</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-272" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">i</span><span class="MJXp-mo" id="MJXp-Span-274">−</span><span class="MJXp-mn" id="MJXp-Span-275">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-43">\mathrm{pre}_{i-1}</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-276"><span class="MJXp-msubsup" id="MJXp-Span-277"><span class="MJXp-mrow" id="MJXp-Span-278" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-279">s</span><span class="MJXp-mi" id="MJXp-Span-280">u</span><span class="MJXp-mi" id="MJXp-Span-281">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-282" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-44">\mathrm{suf}_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-283"><span class="MJXp-msubsup" id="MJXp-Span-284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-286" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-45">p_i</script>. Since the graph consisting of these paths is connected, it must have some spanning tree, so the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-287"><span class="MJXp-mrow" id="MJXp-Span-288"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-289">Yes</span></span></span></span><script type="math/tex" id="MathJax-Element-46">\texttt{Yes}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> p</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> pre</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">),</span><span class="pln"> suf</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln">
        suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]){</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"No"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"Yes"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (Hard Version)</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Suppose that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-msubsup" id="MJXp-Span-291"><span class="MJXp-mrow" id="MJXp-Span-292" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-293">p</span><span class="MJXp-mi" id="MJXp-Span-294">r</span><span class="MJXp-mi" id="MJXp-Span-295">e</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-296" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">i</span><span class="MJXp-mo" id="MJXp-Span-298">−</span><span class="MJXp-mn" id="MJXp-Span-299">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-301"><span class="MJXp-mrow" id="MJXp-Span-302" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-303">s</span><span class="MJXp-mi" id="MJXp-Span-304">u</span><span class="MJXp-mi" id="MJXp-Span-305">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-306" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-47">\mathrm{pre}_{i-1} < \mathrm{suf}_i</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">i</span></span></span><script type="math/tex" id="MathJax-Element-48">i</script>. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-309"><span class="MJXp-msubsup" id="MJXp-Span-310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-312" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-318" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">n</span></span></span><script type="math/tex" id="MathJax-Element-49">s_1 < \dots < s_k = n</script> denote the indices satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-321"><span class="MJXp-msubsup" id="MJXp-Span-322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-324" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-326"><span class="MJXp-mrow" id="MJXp-Span-327" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-328">s</span><span class="MJXp-mi" id="MJXp-Span-329">u</span><span class="MJXp-mi" id="MJXp-Span-330">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-331" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-50">p_i = \mathrm{suf}_i</script>, that is, the suffix maxes of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">p</span></span></span><script type="math/tex" id="MathJax-Element-51">p</script>. Then let's partition <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">p</span></span></span><script type="math/tex" id="MathJax-Element-52">p</script> into blocks ending at each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-336"><span class="MJXp-msubsup" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-339" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-53">s_i</script>. Now, consider a block consisting of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">p</span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">l</span><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">r</span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-54">p[l, r]</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">l</span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-352" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">i</span><span class="MJXp-mo" id="MJXp-Span-354">−</span><span class="MJXp-mn" id="MJXp-Span-355">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-357">1</span></span></span><script type="math/tex" id="MathJax-Element-55">l=s_{i-1}+1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">r</span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-363" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-56">r=s_i</script>. We have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-364"><span class="MJXp-msubsup" id="MJXp-Span-365"><span class="MJXp-mrow" id="MJXp-Span-366" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-367">s</span><span class="MJXp-mi" id="MJXp-Span-368">u</span><span class="MJXp-mi" id="MJXp-Span-369">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-370" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-372"><span class="MJXp-mrow" id="MJXp-Span-373" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-374">s</span><span class="MJXp-mi" id="MJXp-Span-375">u</span><span class="MJXp-mi" id="MJXp-Span-376">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-377" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-381" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-57">\mathrm{suf}_l = \mathrm{suf}_r = p_r</script> by construction, which means that all values in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">p</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">l</span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">r</span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-389">1</span><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-58">p[l, r-1]</script> are less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-391"><span class="MJXp-msubsup" id="MJXp-Span-392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-394" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-59">p_r</script>. So we can connect all of these values to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-395"><span class="MJXp-msubsup" id="MJXp-Span-396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-398" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-60">p_r</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Now, each block is connected, so it suffices to connect the blocks to each other. We have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-399"><span class="MJXp-msubsup" id="MJXp-Span-400"><span class="MJXp-mrow" id="MJXp-Span-401" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-402">p</span><span class="MJXp-mi" id="MJXp-Span-403">r</span><span class="MJXp-mi" id="MJXp-Span-404">e</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-405" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">l</span><span class="MJXp-mo" id="MJXp-Span-407">−</span><span class="MJXp-mn" id="MJXp-Span-408">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-410"><span class="MJXp-mrow" id="MJXp-Span-411" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-412">s</span><span class="MJXp-mi" id="MJXp-Span-413">u</span><span class="MJXp-mi" id="MJXp-Span-414">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-415" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-416" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-419" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-61">\mathrm{pre}_{l-1} < \mathrm{suf}_l = p_r</script>, so we can connect <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-420"><span class="MJXp-msubsup" id="MJXp-Span-421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-423" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-62">p_r</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-424"><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mrow" id="MJXp-Span-426" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-427">p</span><span class="MJXp-mi" id="MJXp-Span-428">r</span><span class="MJXp-mi" id="MJXp-Span-429">e</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-430" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">l</span><span class="MJXp-mo" id="MJXp-Span-432">−</span><span class="MJXp-mn" id="MJXp-Span-433">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-63">\mathrm{pre}_{l-1}</script>. By induction, we see that all blocks are now connected, since each block is connected to some previous block.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> p</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> pre</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">);</span><span class="pln">
    vector</span><span class="pun">&lt;</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;&gt;</span><span class="pln"> suf</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln">
        suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> </span><span class="pun">{</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> i</span><span class="pun">});</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">first</span><span class="pun">){</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"No"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"Yes"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> l</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> suf</span><span class="pun">[</span><span class="pln">l</span><span class="pun">].</span><span class="pln">second</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">l</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">r</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">l </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> pre</span><span class="pun">[</span><span class="pln">l</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        l </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Bonus</b><div class="spoiler-content" style="display: block;"><p>Can you count the number of satisfactory trees? I don't have a solution to this version; leave a comment if you find one.</p></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13721">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="247">247</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13722">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="26">26</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13723">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13724">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13725">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13726">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13727">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="15">15</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13728">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="116">116</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13729">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="151">151</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13730">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2171/problem/E">E — Anisphia Wynn Palettia and Good Permutations</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">x</span></span></span><script type="math/tex" id="MathJax-Element-64">x</script>'s denote elements which all share a common divisor, and let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-436"><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0.267em; margin-right: 0.267em;">−</span></span></span><script type="math/tex" id="MathJax-Element-65">-</script>'s denote any elements. Then an array of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-438"><span class="MJXp-mo" id="MJXp-Span-439" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">x</span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">x</span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">x</span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">x</span><span class="MJXp-mo" id="MJXp-Span-451" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-66">[-, x, x, -, x, x, \dots]</script> will have no bad indices. Let's call an array of this form "perfect".</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Suppose the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">x</span></span></span><script type="math/tex" id="MathJax-Element-67">x</script>'s are even elements. We have roughly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-456"><span class="MJXp-mfrac" id="MJXp-Span-457" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-459">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-68">\frac{n}{2}</script> even elements, which means we can form a perfect array of length roughly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-460"><span class="MJXp-mfrac" id="MJXp-Span-461" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-462">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-464">4</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-69">\frac{3n}{4}</script>. Now, we have roughly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-465"><span class="MJXp-mfrac" id="MJXp-Span-466" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-468">6</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-70">\frac{n}{6}</script> elements which are odd multiples of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-469"><span class="MJXp-mn" id="MJXp-Span-470">3</span></span></span><script type="math/tex" id="MathJax-Element-71">3</script>, which means we can form a disjoint perfect array of length roughly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-471"><span class="MJXp-mfrac" id="MJXp-Span-472" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-474">4</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-72">\frac{n}{4}</script>. By concatenating these two arrays, we achieve a roughly full permutation with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">O</span><span class="MJXp-mo" id="MJXp-Span-477" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-478">1</span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-73">O(1)</script> bad indices. See the next section for a proof of the bound on bad indices.</p></div></div> <div class="spoiler"><b class="spoiler-title">Bound on bad indices</b><div class="spoiler-content" style="display: block;"><p>Instead of counting bad indices, we will count good indices. We form a perfect array of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-480"><span class="MJXp-mn" id="MJXp-Span-481">3</span><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-483" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-485">4</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-74">3\lfloor \frac{n}{4} \rfloor</script>, where all indices are good except for potentially the last one. We also form a perfect array of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-487"><span class="MJXp-mn" id="MJXp-Span-488">3</span><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-490" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">n</span><span class="MJXp-mo" id="MJXp-Span-492">+</span><span class="MJXp-mn" id="MJXp-Span-493">3</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-494">12</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-75">3\lfloor \frac{n+3}{12} \rfloor</script> because we gain a new triple for every pair of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-496"><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-498">3</span><span class="MJXp-mo" id="MJXp-Span-499" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-500">9</span><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-502"><span class="MJXp-mspace" id="MJXp-Span-503" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-504" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-505">mod</span><span class="MJXp-mspace" id="MJXp-Span-506" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-507">12</span><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-76">\{3, 9\} \pmod{12}</script>. Again, all indices are good except for potentially the last one. Therefore, we achieve <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-509"><span class="MJXp-mn" id="MJXp-Span-510">3</span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-512" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-514">4</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-516" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-517">3</span><span class="MJXp-mo" id="MJXp-Span-518" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-519" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">n</span><span class="MJXp-mo" id="MJXp-Span-521">+</span><span class="MJXp-mn" id="MJXp-Span-522">3</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-523">12</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-524" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-526">2</span></span></span><script type="math/tex" id="MathJax-Element-77">3\lfloor \frac{n}{4}\rfloor + 3\lfloor \frac{n+3}{12} \rfloor - 2</script> good indices. It can be verified for every residue class <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-529"><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-531">12</span></span></span><script type="math/tex" id="MathJax-Element-78">\bmod 12</script> that this is lower bounded by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">n</span><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-535">6</span></span></span><script type="math/tex" id="MathJax-Element-79">n-6</script>. Since there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">n</span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-539">2</span></span></span><script type="math/tex" id="MathJax-Element-80">n-2</script> indices in total, we have at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-540"><span class="MJXp-mn" id="MJXp-Span-541">4</span></span></span><script type="math/tex" id="MathJax-Element-81">4</script> bad indices.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="lit">3</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">i </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln">
            a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">i </span><span class="pun">%</span><span class="pln"> </span><span class="lit">3</span><span class="pun">))</span><span class="pln">
            a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln">
            a</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
        a</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
        a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
        a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
        a</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
        a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
        a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">:</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">:</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">:</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">2</span><span class="pun">])</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Bonus</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">f</span><span class="MJXp-mo" id="MJXp-Span-544" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">n</span><span class="MJXp-mo" id="MJXp-Span-546" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-82">f(n)</script> denote the minimum number of bad indices across all permutations of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">n</span></span></span><script type="math/tex" id="MathJax-Element-83">n</script>. Can you find the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-549"><span class="MJXp-mo" id="MJXp-Span-550" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">f</span><span class="MJXp-mo" id="MJXp-Span-552" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">n</span><span class="MJXp-mo" id="MJXp-Span-554" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-84">\max f(n)</script>? I suspect the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-555"><span class="MJXp-mn" id="MJXp-Span-556">2</span></span></span><script type="math/tex" id="MathJax-Element-85">2</script>, but I don't have a formal proof. Furthermore, can you find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">f</span><span class="MJXp-mo" id="MJXp-Span-559" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">n</span><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-86">f(n)</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">n</span></span></span><script type="math/tex" id="MathJax-Element-87">n</script>?</p><p>Update: I've heard from several people that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-564"><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">f</span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">n</span><span class="MJXp-mo" id="MJXp-Span-569" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-570" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-571">1</span></span></span><script type="math/tex" id="MathJax-Element-88">\max f(n) = 1</script>. Feel free to post a comment with a proof, if you'd like.</p><p>Update:</p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>A construction commented by <a class="rated-user user-cyan" href="https://codeforces.com/profile/d1amondzz" title="Specialist d1amondzz">d1amondzz</a> seems to prove an upper bound of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">f</span><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-575">3</span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">f</span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-580">5</span><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-583">1</span></span></span><script type="math/tex" id="MathJax-Element-89">f(3), f(5) \leq 1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">f</span><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">n</span><span class="MJXp-mo" id="MJXp-Span-588" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-590">0</span></span></span><script type="math/tex" id="MathJax-Element-90">f(n) = 0</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">n</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mn" id="MJXp-Span-594">3</span><span class="MJXp-mo" id="MJXp-Span-595" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-596">5</span></span></span><script type="math/tex" id="MathJax-Element-91">n\neq 3, 5</script>. I think several other comments may have alluded to a similar solution as well. The general idea is that for the largest prefix of primes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-597"><span class="MJXp-msubsup" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-600" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-604" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-608" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-92">p_1, ..., p_k</script> satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-609"><span class="MJXp-msubsup" id="MJXp-Span-610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-612" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">k</span><span class="MJXp-mo" id="MJXp-Span-614">−</span><span class="MJXp-mn" id="MJXp-Span-615">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-619" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-620" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">n</span></span></span><script type="math/tex" id="MathJax-Element-93">p_{k-1}\cdot p_k \leq n</script>, we can construct an array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">q</span></span></span><script type="math/tex" id="MathJax-Element-94">q</script> as follows: for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-624"><span class="MJXp-msubsup" id="MJXp-Span-625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-627" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-95">p_i</script>, first append <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-628"><span class="MJXp-msubsup" id="MJXp-Span-629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-631" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-96">p_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">q</span></span></span><script type="math/tex" id="MathJax-Element-97">q</script>, then append all elements with smallest prime factor <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-634"><span class="MJXp-msubsup" id="MJXp-Span-635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-637" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-98">p_i</script>, ending with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-638"><span class="MJXp-msubsup" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-641" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-645" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">i</span><span class="MJXp-mo" id="MJXp-Span-647">+</span><span class="MJXp-mn" id="MJXp-Span-648">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-99">p_i\cdot p_{i+1}</script>. Then all adjacent elements are not coprime, so as long as this array is of size at least roughly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-649"><span class="MJXp-mfrac" id="MJXp-Span-650" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-651">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-652">3</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">n</span></span></span><script type="math/tex" id="MathJax-Element-100">\frac{2}{3}n</script>, we can intersperse it with the remaining elements to achieve no bad indices. All composites are included in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">q</span></span></span><script type="math/tex" id="MathJax-Element-101">q</script>, because if a composite number has smallest prime factor at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-656"><span class="MJXp-msubsup" id="MJXp-Span-657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-659" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">k</span><span class="MJXp-mo" id="MJXp-Span-661">+</span><span class="MJXp-mn" id="MJXp-Span-662">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-102">p_{k+1}</script>, then its value is at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-663"><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-667" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">k</span><span class="MJXp-mo" id="MJXp-Span-669">+</span><span class="MJXp-mn" id="MJXp-Span-670">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-671"><span class="MJXp-mo" id="MJXp-Span-672" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-673" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-677" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-681" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">k</span><span class="MJXp-mo" id="MJXp-Span-683">+</span><span class="MJXp-mn" id="MJXp-Span-684">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-685" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">n</span></span></span><script type="math/tex" id="MathJax-Element-103">(p_{k+1})^2 > p_k\cdot p_{k+1} > n</script> by construction of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">k</span></span></span><script type="math/tex" id="MathJax-Element-104">k</script>. So we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">q</span></span></span><script type="math/tex" id="MathJax-Element-105">q</script> is of length asympototically at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">n</span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-694" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-696">log</span><span class="MJXp-mo" id="MJXp-Span-697"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">n</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-106">n-\frac{n}{\log n}</script>, which is asymptotically at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">n</span></span></span><script type="math/tex" id="MathJax-Element-107">cn</script> for any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">c</span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-705">1</span></span></span><script type="math/tex" id="MathJax-Element-108">c<1</script>. We can furthermore verify that this construction works for all small <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">n</span></span></span><script type="math/tex" id="MathJax-Element-109">n</script> except for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-708"><span class="MJXp-mn" id="MJXp-Span-709">3</span></span></span><script type="math/tex" id="MathJax-Element-110">3</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-710"><span class="MJXp-mn" id="MJXp-Span-711">5</span></span></span><script type="math/tex" id="MathJax-Element-111">5</script>.</p><p>As for the lower bound, it's easy to see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">f</span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-715">3</span><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-718">1</span></span></span><script type="math/tex" id="MathJax-Element-112">f(3) \geq 1</script> since all pairs are coprime, and that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">f</span><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-722">5</span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-725">1</span></span></span><script type="math/tex" id="MathJax-Element-113">f(5) \geq 1</script> since the only pair that is not coprime is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mo" id="MJXp-Span-727" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-728">2</span><span class="MJXp-mo" id="MJXp-Span-729" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-730">4</span><span class="MJXp-mo" id="MJXp-Span-731" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-114">\{2, 4\}</script>, but we cannot have that these elements appear in all triples. Therefore, we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">f</span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-735">3</span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">f</span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-740">5</span><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-743">1</span></span></span><script type="math/tex" id="MathJax-Element-115">f(3) = f(5) = 1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-744"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">f</span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">n</span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-749" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-750">0</span></span></span><script type="math/tex" id="MathJax-Element-116">f(n) = 0</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">n</span><span class="MJXp-mo" id="MJXp-Span-753" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mn" id="MJXp-Span-754">3</span><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-756">5</span></span></span><script type="math/tex" id="MathJax-Element-117">n\neq 3, 5</script>.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13731">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="115">115</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13732">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="30">30</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13733">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="12">12</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13734">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="10">10</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13735">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="30">30</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13736">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13737">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13738">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="57">57</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13739">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="105">105</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13740">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="15">15</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2171/problem/G">G — Sakura Adachi and Optimal Sequences</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Let's fix the number of double operations we use; call this integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">k</span></span></span><script type="math/tex" id="MathJax-Element-118">k</script>. Now, we can treat each value independently.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Consider a specific pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-759"><span class="MJXp-msubsup" id="MJXp-Span-760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-762" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-763" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-766" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-119">a_i, b_i</script>. If we don't apply any addition operations, we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-767"><span class="MJXp-msubsup" id="MJXp-Span-768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-770" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-120">a_i</script> becomes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-771"><span class="MJXp-msubsup" id="MJXp-Span-772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-774" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-776"><span class="MJXp-mn" id="MJXp-Span-777" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-778" style="vertical-align: 0.5em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-121">a_i \cdot 2^k</script>. Clearly we need that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-779"><span class="MJXp-msubsup" id="MJXp-Span-780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-782" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-784"><span class="MJXp-mn" id="MJXp-Span-785" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-786" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-790" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-122">a_i \cdot 2^k \leq b_i</script>. Now, observe that applying an addition operation before applying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">j</span></span></span><script type="math/tex" id="MathJax-Element-123">j</script> of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">k</span></span></span><script type="math/tex" id="MathJax-Element-124">k</script> double operations is equivalent to adding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-795"><span class="MJXp-msubsup" id="MJXp-Span-796"><span class="MJXp-mn" id="MJXp-Span-797" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-798" style="vertical-align: 0.5em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-125">2^j</script> to our final sum. We need to add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-799"><span class="MJXp-msubsup" id="MJXp-Span-800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-802" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-806" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-807" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mn" id="MJXp-Span-809" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-810" style="vertical-align: 0.5em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-126">b_i - a_i \cdot 2^k</script>, so in total, we apply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-811"><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-813" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-814"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-816" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-817">−</span><span class="MJXp-msubsup" id="MJXp-Span-818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-820" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-821">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-822"><span class="MJXp-mn" id="MJXp-Span-823" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-824" style="vertical-align: 0.5em;">k</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-825"><span class="MJXp-mn" id="MJXp-Span-826" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-827" style="vertical-align: 0.5em;">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-828" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-830" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-831" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-834" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-835"><span class="MJXp-mn" id="MJXp-Span-836" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-837" style="vertical-align: 0.5em;">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-838" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-839" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-842" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-127">\lfloor \frac{b_i - a_i \cdot 2^k}{2^k} \rfloor = \lfloor \frac{b_i}{2^k} \rfloor - a_i</script> addition operations at the beginning, each adding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-843"><span class="MJXp-msubsup" id="MJXp-Span-844"><span class="MJXp-mn" id="MJXp-Span-845" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-846" style="vertical-align: 0.5em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-128">2^k</script> to our sum. Then, we apply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-847"><span class="MJXp-mrow" id="MJXp-Span-848"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-849">popcount</span></span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-851" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-854" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-858" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-860"><span class="MJXp-mn" id="MJXp-Span-861" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-862" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-864"><span class="MJXp-mspace" id="MJXp-Span-865" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-866" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-867">mod</span><span class="MJXp-mspace" id="MJXp-Span-868" style="width: 0.333em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-869"><span class="MJXp-mn" id="MJXp-Span-870" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-871" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-872" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-873" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-874" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-875"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-876">popcount</span></span><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-880" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-881"><span class="MJXp-mspace" id="MJXp-Span-882" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-884">mod</span><span class="MJXp-mspace" id="MJXp-Span-885" style="width: 0.333em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-886"><span class="MJXp-mn" id="MJXp-Span-887" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-888" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-890" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-129">\texttt{popcount}((b_i - a_i \cdot 2^k)\pmod{2^k}) = \texttt{popcount}(b_i\pmod{2^k})</script> addition operations later, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-891"><span class="MJXp-mrow" id="MJXp-Span-892"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-893">popcount</span></span><span class="MJXp-mo" id="MJXp-Span-894" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">x</span><span class="MJXp-mo" id="MJXp-Span-896" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-130">\texttt{popcount}(x)</script> denotes the number of set bits in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">x</span></span></span><script type="math/tex" id="MathJax-Element-131">x</script>. This is because, if the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">j</span></span></span><script type="math/tex" id="MathJax-Element-132">j</script>-th bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-901"><span class="MJXp-msubsup" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-904" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-905" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-908" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-910"><span class="MJXp-mn" id="MJXp-Span-911" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-912" style="vertical-align: 0.5em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-133">b_i - a_i \cdot 2^k</script> is set for some <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">j</span><span class="MJXp-mo" id="MJXp-Span-915" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">k</span></span></span><script type="math/tex" id="MathJax-Element-134">j<k</script>, we would like to apply an operation before applying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">j</span></span></span><script type="math/tex" id="MathJax-Element-135">j</script> of the double operations so we can add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-919"><span class="MJXp-msubsup" id="MJXp-Span-920"><span class="MJXp-mn" id="MJXp-Span-921" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-922" style="vertical-align: 0.5em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-136">2^j</script> to our sum.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>We would like to choose the largest number of double operations possible, since a double operation increases all values by at least one. Furthermore, since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">n</span><span class="MJXp-mo" id="MJXp-Span-925" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-926">2</span></span></span><script type="math/tex" id="MathJax-Element-137">n\geq 2</script>, a double operation is strictly more effective than an addition operation. However, we still need to satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-msubsup" id="MJXp-Span-928"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-930" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-932"><span class="MJXp-mn" id="MJXp-Span-933" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-934" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-938" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-138">a_i \cdot 2^k \leq b_i</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">i</span></span></span><script type="math/tex" id="MathJax-Element-139">i</script>. Therefore, we will choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">k</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-944" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-msubsup" id="MJXp-Span-945"><span class="MJXp-mi" id="MJXp-Span-946" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-947" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-948" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-949"><span class="MJXp-mfrac" id="MJXp-Span-950" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-953" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-954"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-956" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-140">k=\min \log_2{\frac{b_i}{a_i}}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 4</b><div class="spoiler-content" style="display: block;"><p>Between each double operation, the addition operations can be rearranged. Let's consider all of the addition operations applied before applying exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">j</span></span></span><script type="math/tex" id="MathJax-Element-141">j</script> double operations; denote these values <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-959"><span class="MJXp-msubsup" id="MJXp-Span-960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-962" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-963" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-968" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-142">c_1, \dots, c_n</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-969"><span class="MJXp-msubsup" id="MJXp-Span-970"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-972" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-143">c_i</script> is the number of addition operations performed on element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-973"><span class="MJXp-msubsup" id="MJXp-Span-974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-976" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-144">a_i</script>. Then we can multiply our number of sequences by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-977"><span class="MJXp-mrow" id="MJXp-Span-978"><span class="MJXp-mrow" id="MJXp-Span-979"><span class="MJXp-TeXmathchoice" id="MJXp-Span-980"><span class="MJXp-mstyle" id="MJXp-Span-981"><span class="MJXp-mrow" id="MJXp-Span-982"><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-984"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-985"><span class="MJXp-mo" id="MJXp-Span-986">∑</span><span class="MJXp-msubsup" id="MJXp-Span-987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-989" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-990"><span class="MJXp-msubsup" id="MJXp-Span-991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-993" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-994">,</span><span class="MJXp-mo" id="MJXp-Span-995">…</span><span class="MJXp-mo" id="MJXp-Span-996">,</span><span class="MJXp-msubsup" id="MJXp-Span-997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-999" style="vertical-align: -0.4em;">n</span></span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1000"><span class="MJXp-mstyle" id="MJXp-Span-1001"><span class="MJXp-mrow" id="MJXp-Span-1002"><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-145">{\sum c_i \choose c_1, \dots, c_n}</script>, the multinomial coefficient of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1004"><span class="MJXp-msubsup" id="MJXp-Span-1005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1007" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-146">c_i</script>. This is equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1008"><span class="MJXp-mfrac" id="MJXp-Span-1009" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1010">(</span><span class="MJXp-mo" id="MJXp-Span-1011">∑</span><span class="MJXp-msubsup" id="MJXp-Span-1012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1014" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1015">)</span><span class="MJXp-mo" id="MJXp-Span-1016">!</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1017">∏</span><span class="MJXp-mo" id="MJXp-Span-1018">(</span><span class="MJXp-msubsup" id="MJXp-Span-1019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1021" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1022">!</span><span class="MJXp-mo" id="MJXp-Span-1023">)</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-147">\frac{(\sum c_i)!}{\prod (c_i!)}</script>. To simplify implementation, note that for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">j</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">k</span></span></span><script type="math/tex" id="MathJax-Element-148">j<k</script>, all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1028"><span class="MJXp-msubsup" id="MJXp-Span-1029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1031" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-149">c_i</script> are either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1032"><span class="MJXp-mn" id="MJXp-Span-1033">0</span></span></span><script type="math/tex" id="MathJax-Element-150">0</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1034"><span class="MJXp-mn" id="MJXp-Span-1035">1</span></span></span><script type="math/tex" id="MathJax-Element-151">1</script>, so the denominator is only nontrivial for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">j</span><span class="MJXp-mo" id="MJXp-Span-1038" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">k</span></span></span><script type="math/tex" id="MathJax-Element-152">j=k</script>. The final answer is the product of these values across all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1040"><span class="MJXp-mn" id="MJXp-Span-1041">0</span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">j</span><span class="MJXp-mo" id="MJXp-Span-1044" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">k</span></span></span><script type="math/tex" id="MathJax-Element-153">0\leq j\leq k</script>. See the next section for intuition on multinomial coefficients and some of the details on its implementation.</p></div></div> <div class="spoiler"><b class="spoiler-title">Multinomial coefficients</b><div class="spoiler-content" style="display: block;"><p>The intuition behind the formula for multinomial coefficients is as follows: let's say <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">n</span><span class="MJXp-mo" id="MJXp-Span-1048" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1049">3</span></span></span><script type="math/tex" id="MathJax-Element-154">n=3</script>, and we want to find the number of ways to color <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1050"><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1054" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-155">\sum c_i</script> balls such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1055"><span class="MJXp-msubsup" id="MJXp-Span-1056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1058" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-156">c_1</script> are red, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1059"><span class="MJXp-msubsup" id="MJXp-Span-1060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1062" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-157">c_2</script> are green, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1063"><span class="MJXp-msubsup" id="MJXp-Span-1064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1066" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-158">c_3</script> are blue. Let's call our positions "red <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1067"><span class="MJXp-mn" id="MJXp-Span-1068">1</span></span></span><script type="math/tex" id="MathJax-Element-159">1</script>" <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1069"><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-160">\dots</script> "red <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1071"><span class="MJXp-msubsup" id="MJXp-Span-1072"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1074" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-161">c_1</script>" <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1075"><span class="MJXp-mo" id="MJXp-Span-1076" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-162">\dots</script> "blue <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-msubsup" id="MJXp-Span-1078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1080" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-163">c_3</script>". Now, it's clear that there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1081"><span class="MJXp-mo" id="MJXp-Span-1082" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-1084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1086" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1088" style="margin-left: 0.111em; margin-right: 0em;">!</span></span></span><script type="math/tex" id="MathJax-Element-164">(\sum c_i)!</script> ways to assign each ball to a position, because we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1089"><span class="MJXp-mo" id="MJXp-Span-1090" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1093" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-165">\sum c_i</script> choices of balls to assign to "red <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1094"><span class="MJXp-mn" id="MJXp-Span-1095">1</span></span></span><script type="math/tex" id="MathJax-Element-166">1</script>", then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1096"><span class="MJXp-mo" id="MJXp-Span-1097" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-1098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1100" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1102">1</span></span></span><script type="math/tex" id="MathJax-Element-167">\sum c_i - 1</script> remaining choices of balls to assign to "red <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1103"><span class="MJXp-mn" id="MJXp-Span-1104">2</span></span></span><script type="math/tex" id="MathJax-Element-168">2</script>", and so forth, until we only have one choice of balls to assign to "blue <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1105"><span class="MJXp-msubsup" id="MJXp-Span-1106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1108" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-169">c_3</script>". However, this overcounts, because there is no difference between assigning ball <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1109"><span class="MJXp-mn" id="MJXp-Span-1110">1</span></span></span><script type="math/tex" id="MathJax-Element-170">1</script> to "red <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1111"><span class="MJXp-mn" id="MJXp-Span-1112">1</span></span></span><script type="math/tex" id="MathJax-Element-171">1</script>" and ball <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1113"><span class="MJXp-mn" id="MJXp-Span-1114">2</span></span></span><script type="math/tex" id="MathJax-Element-172">2</script> to "red <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1115"><span class="MJXp-mn" id="MJXp-Span-1116">2</span></span></span><script type="math/tex" id="MathJax-Element-173">2</script>", and vice versa. We are overcounting the red assignments by a factor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1117"><span class="MJXp-msubsup" id="MJXp-Span-1118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1120" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0.111em; margin-right: 0em;">!</span></span></span><script type="math/tex" id="MathJax-Element-174">c_1!</script>, because every valid selection of red balls achieves <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1122"><span class="MJXp-msubsup" id="MJXp-Span-1123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1125" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0.111em; margin-right: 0em;">!</span></span></span><script type="math/tex" id="MathJax-Element-175">c_1!</script> assignments of red balls to positions. Similar reasoning holds for the green and blue balls, so in total, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1127"><span class="MJXp-mfrac" id="MJXp-Span-1128" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1129">(</span><span class="MJXp-mo" id="MJXp-Span-1130">∑</span><span class="MJXp-msubsup" id="MJXp-Span-1131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1133" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1134">)</span><span class="MJXp-mo" id="MJXp-Span-1135">!</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1136">∏</span><span class="MJXp-mo" id="MJXp-Span-1137">(</span><span class="MJXp-msubsup" id="MJXp-Span-1138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1140" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1141">!</span><span class="MJXp-mo" id="MJXp-Span-1142">)</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-176">\frac{(\sum c_i)!}{\prod (c_i!)}</script> different sequences.</p><p>Multinomial coefficients can be computed by precomputing factorials. For the numerator, note that if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1143"><span class="MJXp-mo" id="MJXp-Span-1144" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-1145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1147" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1148" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-1149"><span class="MJXp-mn" id="MJXp-Span-1150" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1151" style="vertical-align: 0.5em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1153">3</span></span></span><script type="math/tex" id="MathJax-Element-177">\sum c_i \geq 10^6+3</script> then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1154"><span class="MJXp-mo" id="MJXp-Span-1155" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-1157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1159" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0.111em; margin-right: 0em;">!</span><span class="MJXp-mo" id="MJXp-Span-1162" style="margin-left: 0.333em; margin-right: 0.333em;">≡</span><span class="MJXp-mn" id="MJXp-Span-1163">0</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1164"><span class="MJXp-mspace" id="MJXp-Span-1165" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1167">mod</span><span class="MJXp-mspace" id="MJXp-Span-1168" style="width: 0.333em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1169"><span class="MJXp-mn" id="MJXp-Span-1170" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1171" style="vertical-align: 0.5em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1173">3</span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-178">(\sum c_i)! \equiv 0\pmod{10^6+3}</script> because we have a factor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1175"><span class="MJXp-msubsup" id="MJXp-Span-1176"><span class="MJXp-mn" id="MJXp-Span-1177" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1178" style="vertical-align: 0.5em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1179" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1180">3</span></span></span><script type="math/tex" id="MathJax-Element-179">10^6+3</script>, so we only need to precompute factorials up to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1181"><span class="MJXp-msubsup" id="MJXp-Span-1182"><span class="MJXp-mn" id="MJXp-Span-1183" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1184" style="vertical-align: 0.5em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1186">2</span></span></span><script type="math/tex" id="MathJax-Element-180">10^6+2</script>. For the denominator, we can divide by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1187"><span class="MJXp-msubsup" id="MJXp-Span-1188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1190" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1191" style="margin-left: 0.111em; margin-right: 0em;">!</span></span></span><script type="math/tex" id="MathJax-Element-181">c_i!</script> by multiplying by the modular inverse of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1192"><span class="MJXp-msubsup" id="MJXp-Span-1193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1195" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1196" style="margin-left: 0.111em; margin-right: 0em;">!</span></span></span><script type="math/tex" id="MathJax-Element-182">c_i!</script> modulo <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1197"><span class="MJXp-msubsup" id="MJXp-Span-1198"><span class="MJXp-mn" id="MJXp-Span-1199" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1200" style="vertical-align: 0.5em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1202">3</span></span></span><script type="math/tex" id="MathJax-Element-183">10^6+3</script>. Crucially, note that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1203"><span class="MJXp-msubsup" id="MJXp-Span-1204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1206" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1207" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1208"><span class="MJXp-mn" id="MJXp-Span-1209" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1210" style="vertical-align: 0.5em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1211" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1212">3</span></span></span><script type="math/tex" id="MathJax-Element-184">c_i < 10^6+3</script> because the number of addition operations you can apply is at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1213"><span class="MJXp-msubsup" id="MJXp-Span-1214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1216" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1217" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1220" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1221" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1222"><span class="MJXp-mn" id="MJXp-Span-1223" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1224" style="vertical-align: 0.5em;">6</span></span></span></span><script type="math/tex" id="MathJax-Element-185">b_i - a_i < 10^6</script>, so modular inverses are well-defined. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> mod </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e6</span><span class="pun">+</span><span class="lit">3</span><span class="pun">;</span><span class="pln">
 
vector</span><span class="str">&lt;int&gt;</span><span class="pln"> fact</span><span class="pun">(</span><span class="pln">mod</span><span class="pun">);</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> inv</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> a </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> a </span><span class="pun">:</span><span class="pln"> mod </span><span class="pun">-</span><span class="pln"> mod </span><span class="pun">/</span><span class="pln"> a </span><span class="pun">*</span><span class="pln"> inv</span><span class="pun">(</span><span class="pln">mod </span><span class="pun">%</span><span class="pln"> a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">),</span><span class="pln"> b</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> __lg</span><span class="pun">(</span><span class="pln">b</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        k </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">k</span><span class="pun">,</span><span class="pln"> __lg</span><span class="pun">(</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]));</span><span class="pln">
    x </span><span class="pun">=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> cnt</span><span class="pun">(</span><span class="pln">k</span><span class="pun">),</span><span class="pln"> c</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">&lt;</span><span class="pln">k</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++){</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">&lt;</span><span class="pln">k</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++){</span><span class="pln">
        x </span><span class="pun">+=</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
        ans </span><span class="pun">=</span><span class="pln"> ans </span><span class="pun">*</span><span class="pln"> fact</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">last</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> accumulate</span><span class="pun">(</span><span class="pln">c</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> c</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">(),</span><span class="pln"> </span><span class="lit">0LL</span><span class="pun">);</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">last</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> mod </span><span class="pun">?</span><span class="pln"> ans </span><span class="pun">*</span><span class="pln"> fact</span><span class="pun">[</span><span class="kwd">last</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">:</span><span class="pln"> c</span><span class="pun">){</span><span class="pln">
        x </span><span class="pun">+=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
        ans </span><span class="pun">=</span><span class="pln"> ans </span><span class="pun">*</span><span class="pln"> inv</span><span class="pun">(</span><span class="pln">fact</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> x </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    fact</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">mod</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> fact</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> fact</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13741">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="73">73</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13742">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13743">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13744">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="0">0</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13745">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13746">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13747">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13748">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="32">32</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13749">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="53">53</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13750">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2171/problem/H">H — Shiori Miyagi and Maximum Array Score</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Let's first try to solve this problem with inefficient time and memory, then we will later optimize it. For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1225"><span class="MJXp-mn" id="MJXp-Span-1226">1</span><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">i</span><span class="MJXp-mo" id="MJXp-Span-1229" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">n</span></span></span><script type="math/tex" id="MathJax-Element-186">1\leq i\leq n</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1231"><span class="MJXp-mn" id="MJXp-Span-1232">0</span><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">j</span><span class="MJXp-mo" id="MJXp-Span-1235" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">m</span><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">n</span></span></span><script type="math/tex" id="MathJax-Element-187">0\leq j\leq m-n</script>, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1239"><span class="MJXp-mrow" id="MJXp-Span-1240"><span class="MJXp-mi" id="MJXp-Span-1241">d</span><span class="MJXp-mi" id="MJXp-Span-1242">p</span></span><span class="MJXp-mo" id="MJXp-Span-1243" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">i</span><span class="MJXp-mo" id="MJXp-Span-1245" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">j</span><span class="MJXp-mo" id="MJXp-Span-1248" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-188">\mathrm{dp}[i][j]</script> denote the largest score achievable from the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">i</span></span></span><script type="math/tex" id="MathJax-Element-189">i</script> indices, while also satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1251"><span class="MJXp-msubsup" id="MJXp-Span-1252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1254" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1255" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">i</span><span class="MJXp-mo" id="MJXp-Span-1257" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">j</span></span></span><script type="math/tex" id="MathJax-Element-190">a_i = i+j</script>. Now, since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">a</span></span></span><script type="math/tex" id="MathJax-Element-191">a</script> must be strictly increasing, we equivalently have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1261"><span class="MJXp-msubsup" id="MJXp-Span-1262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1264" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1265" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">i</span></span></span><script type="math/tex" id="MathJax-Element-192">a_i - i</script> is monotonically increasing. Therefore, we can transition as follows: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1267"><span class="MJXp-mrow" id="MJXp-Span-1268"><span class="MJXp-mi" id="MJXp-Span-1269">d</span><span class="MJXp-mi" id="MJXp-Span-1270">p</span></span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">i</span><span class="MJXp-mo" id="MJXp-Span-1273" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1274" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">j</span><span class="MJXp-mo" id="MJXp-Span-1276" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1277" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1278"><span class="MJXp-mo" id="MJXp-Span-1279" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1280" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">k</span><span class="MJXp-mo" id="MJXp-Span-1282">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1284"><span class="MJXp-mi" id="MJXp-Span-1285">d</span><span class="MJXp-mi" id="MJXp-Span-1286">p</span></span><span class="MJXp-mo" id="MJXp-Span-1287" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">i</span><span class="MJXp-mo" id="MJXp-Span-1289" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1290">1</span><span class="MJXp-mo" id="MJXp-Span-1291" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1292" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">k</span><span class="MJXp-mo" id="MJXp-Span-1294" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1295" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">v</span><span class="MJXp-mo" id="MJXp-Span-1297" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">i</span><span class="MJXp-mo" id="MJXp-Span-1299" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">i</span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">j</span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-193">\mathrm{dp}[i][j] = \max_{k\leq j} \mathrm{dp}[i-1][k] + v(i, i+j)</script>, because we may choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1304"><span class="MJXp-msubsup" id="MJXp-Span-1305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1307" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">i</span><span class="MJXp-mo" id="MJXp-Span-1309">−</span><span class="MJXp-mn" id="MJXp-Span-1310">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-194">a_{i-1}</script> to be any value satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1311"><span class="MJXp-msubsup" id="MJXp-Span-1312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1314" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">i</span><span class="MJXp-mo" id="MJXp-Span-1316">−</span><span class="MJXp-mn" id="MJXp-Span-1317">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1318" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1319" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">i</span><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1322">1</span><span class="MJXp-mo" id="MJXp-Span-1323" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1324" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">j</span></span></span><script type="math/tex" id="MathJax-Element-195">a_{i-1} - (i-1) \leq j</script>, then we choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1326"><span class="MJXp-msubsup" id="MJXp-Span-1327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1329" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1330" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">i</span><span class="MJXp-mo" id="MJXp-Span-1332" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">j</span></span></span><script type="math/tex" id="MathJax-Element-196">a_i = i+j</script>, adding a score of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">v</span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">i</span><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">i</span><span class="MJXp-mo" id="MJXp-Span-1340" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">j</span><span class="MJXp-mo" id="MJXp-Span-1342" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-197">v(i, i+j)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Now, we will try to remove the first dimension; that is, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1343"><span class="MJXp-mrow" id="MJXp-Span-1344"><span class="MJXp-mi" id="MJXp-Span-1345">d</span><span class="MJXp-mi" id="MJXp-Span-1346">p</span></span><span class="MJXp-mo" id="MJXp-Span-1347" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">j</span><span class="MJXp-mo" id="MJXp-Span-1349" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-198">\mathrm{dp}[j]</script> denotes the largest score achievable while also satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1350"><span class="MJXp-msubsup" id="MJXp-Span-1351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1353" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1354" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">i</span><span class="MJXp-mo" id="MJXp-Span-1356" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">j</span></span></span><script type="math/tex" id="MathJax-Element-199">a_i = i+j</script>, where we will update this array as we iterate through all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">i</span></span></span><script type="math/tex" id="MathJax-Element-200">i</script>. We will store this in a data structure that supports quickly querying prefix maximums and increasing point values; in particular, either a Fenwick tree or a segment tree will work.</p><p>Suppose we are at some stage <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">i</span></span></span><script type="math/tex" id="MathJax-Element-201">i</script> and would like to update <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1362"><span class="MJXp-mrow" id="MJXp-Span-1363"><span class="MJXp-mi" id="MJXp-Span-1364">d</span><span class="MJXp-mi" id="MJXp-Span-1365">p</span></span><span class="MJXp-mo" id="MJXp-Span-1366" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">j</span><span class="MJXp-mo" id="MJXp-Span-1368" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-202">\mathrm{dp}[j]</script>. As before, we want to update it to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1369"><span class="MJXp-msubsup" id="MJXp-Span-1370"><span class="MJXp-mo" id="MJXp-Span-1371" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1372" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">k</span><span class="MJXp-mo" id="MJXp-Span-1374">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1376"><span class="MJXp-mi" id="MJXp-Span-1377">d</span><span class="MJXp-mi" id="MJXp-Span-1378">p</span></span><span class="MJXp-mo" id="MJXp-Span-1379" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">k</span><span class="MJXp-mo" id="MJXp-Span-1381" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1382" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">v</span><span class="MJXp-mo" id="MJXp-Span-1384" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">i</span><span class="MJXp-mo" id="MJXp-Span-1386" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">i</span><span class="MJXp-mo" id="MJXp-Span-1388" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">j</span><span class="MJXp-mo" id="MJXp-Span-1390" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-203">\max_{k\leq j} \mathrm{dp}[k] + v(i, i+j)</script>. We should process <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">j</span></span></span><script type="math/tex" id="MathJax-Element-204">j</script> in reverse order, as we want to ensure that we are accessing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1393"><span class="MJXp-mrow" id="MJXp-Span-1394"><span class="MJXp-mi" id="MJXp-Span-1395">d</span><span class="MJXp-mi" id="MJXp-Span-1396">p</span></span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">i</span><span class="MJXp-mo" id="MJXp-Span-1399" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1400">1</span><span class="MJXp-mo" id="MJXp-Span-1401" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">k</span><span class="MJXp-mo" id="MJXp-Span-1404" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-205">\mathrm{dp}[i-1][k]</script> instead of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1405"><span class="MJXp-mrow" id="MJXp-Span-1406"><span class="MJXp-mi" id="MJXp-Span-1407">d</span><span class="MJXp-mi" id="MJXp-Span-1408">p</span></span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">i</span><span class="MJXp-mo" id="MJXp-Span-1411" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">k</span><span class="MJXp-mo" id="MJXp-Span-1414" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-206">\mathrm{dp}[i][k]</script>.</p><p>However, we only have to update <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1415"><span class="MJXp-mrow" id="MJXp-Span-1416"><span class="MJXp-mi" id="MJXp-Span-1417">d</span><span class="MJXp-mi" id="MJXp-Span-1418">p</span></span><span class="MJXp-mo" id="MJXp-Span-1419" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">j</span><span class="MJXp-mo" id="MJXp-Span-1421" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-207">\mathrm{dp}[j]</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">v</span><span class="MJXp-mo" id="MJXp-Span-1424" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">i</span><span class="MJXp-mo" id="MJXp-Span-1426" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">i</span><span class="MJXp-mo" id="MJXp-Span-1428" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">j</span><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-208">v(i, i+j)</script> is nonzero. This is because, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">v</span><span class="MJXp-mo" id="MJXp-Span-1433" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">i</span><span class="MJXp-mo" id="MJXp-Span-1435" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">i</span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">j</span><span class="MJXp-mo" id="MJXp-Span-1439" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-209">v(i, i+j)</script> is zero, then we are updating <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1440"><span class="MJXp-mrow" id="MJXp-Span-1441"><span class="MJXp-mi" id="MJXp-Span-1442">d</span><span class="MJXp-mi" id="MJXp-Span-1443">p</span></span><span class="MJXp-mo" id="MJXp-Span-1444" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">j</span><span class="MJXp-mo" id="MJXp-Span-1446" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-210">\mathrm{dp}[j]</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1447"><span class="MJXp-msubsup" id="MJXp-Span-1448"><span class="MJXp-mo" id="MJXp-Span-1449" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1450" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">k</span><span class="MJXp-mo" id="MJXp-Span-1452">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1454"><span class="MJXp-mi" id="MJXp-Span-1455">d</span><span class="MJXp-mi" id="MJXp-Span-1456">p</span></span><span class="MJXp-mo" id="MJXp-Span-1457" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">k</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-211">\max_{k\leq j} \mathrm{dp}[k]</script>. However, since we are only querying prefix maximums, any query involving <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461">j</span></span></span><script type="math/tex" id="MathJax-Element-212">j</script> will implicitly query all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">k</span><span class="MJXp-mo" id="MJXp-Span-1464" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">j</span></span></span><script type="math/tex" id="MathJax-Element-213">k\leq j</script> anyways, so it is not necessary to explicitly update <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1466"><span class="MJXp-mrow" id="MJXp-Span-1467"><span class="MJXp-mi" id="MJXp-Span-1468">d</span><span class="MJXp-mi" id="MJXp-Span-1469">p</span></span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">j</span><span class="MJXp-mo" id="MJXp-Span-1472" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-214">\mathrm{dp}[j]</script>. Our final answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1473"><span class="MJXp-mo" id="MJXp-Span-1474" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mrow" id="MJXp-Span-1475"><span class="MJXp-mi" id="MJXp-Span-1476">d</span><span class="MJXp-mi" id="MJXp-Span-1477">p</span></span><span class="MJXp-mo" id="MJXp-Span-1478" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">j</span><span class="MJXp-mo" id="MJXp-Span-1480" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-215">\max \mathrm{dp}[j]</script>. See the next section for runtime analysis.</p></div></div> <div class="spoiler"><b class="spoiler-title">Runtime analysis</b><div class="spoiler-content" style="display: block;"><p>For simplicity of analysis, assume <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">m</span><span class="MJXp-mo" id="MJXp-Span-1483" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">n</span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">c</span></span></span><script type="math/tex" id="MathJax-Element-216">m - n \geq c</script> for some reasonable <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">c</span></span></span><script type="math/tex" id="MathJax-Element-217">c</script>, to avoid pathological cases where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1489"><span class="MJXp-mi" id="MJXp-Span-1490">log</span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1492" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">m</span><span class="MJXp-mo" id="MJXp-Span-1494" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">n</span><span class="MJXp-mo" id="MJXp-Span-1496" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-218">\log (m-n)</script> is undefined or zero.</p><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">i</span></span></span><script type="math/tex" id="MathJax-Element-219">i</script>, we are updating <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">O</span><span class="MJXp-mo" id="MJXp-Span-1501" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1502" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">m</span><span class="MJXp-mo" id="MJXp-Span-1504">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-220">O(\frac{m-n}{i})</script> values. Therefore, in total, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">O</span><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1511" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mfrac" id="MJXp-Span-1512" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">m</span><span class="MJXp-mo" id="MJXp-Span-1514">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1517" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1518" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">O</span><span class="MJXp-mo" id="MJXp-Span-1520" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1521" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">m</span><span class="MJXp-mo" id="MJXp-Span-1523" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">n</span><span class="MJXp-mo" id="MJXp-Span-1525" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">H</span><span class="MJXp-mo" id="MJXp-Span-1527" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">n</span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-221">O(\sum \frac{m-n}{i}) = O((m-n)H(n))</script> updates. Since harmonic numbers are known to grow logarithmically, this is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">O</span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1534" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">m</span><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">n</span><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1539">log</span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">n</span><span class="MJXp-mo" id="MJXp-Span-1542" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-222">O((m-n)\log n)</script>. Each update takes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">O</span><span class="MJXp-mo" id="MJXp-Span-1545" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1546">log</span><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">m</span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">n</span><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1553" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-223">O(\log (m-n))</script> time, as it involves a query and an update on a Fenwick tree or segment tree of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">m</span><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">n</span><span class="MJXp-mo" id="MJXp-Span-1558" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1559">1</span></span></span><script type="math/tex" id="MathJax-Element-224">m-n+1</script>. So the updates in total take <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">O</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1563" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">m</span><span class="MJXp-mo" id="MJXp-Span-1565" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566">n</span><span class="MJXp-mo" id="MJXp-Span-1567" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1568">log</span><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">n</span><span class="MJXp-mi" id="MJXp-Span-1571">log</span><span class="MJXp-mo" id="MJXp-Span-1572" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1573"><span class="MJXp-mo" id="MJXp-Span-1574" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">m</span><span class="MJXp-mo" id="MJXp-Span-1576" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">n</span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-225">O((m-n)\log n\log{(m-n)})</script> time.</p><p>However, we also need to compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">v</span><span class="MJXp-mo" id="MJXp-Span-1582" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">i</span><span class="MJXp-mo" id="MJXp-Span-1584" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">i</span><span class="MJXp-mo" id="MJXp-Span-1586" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">j</span><span class="MJXp-mo" id="MJXp-Span-1588" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-226">v(i, i+j)</script> for each update. This will take <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">O</span><span class="MJXp-mo" id="MJXp-Span-1591" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593">v</span><span class="MJXp-mo" id="MJXp-Span-1594" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">i</span><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">i</span><span class="MJXp-mo" id="MJXp-Span-1598" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">j</span><span class="MJXp-mo" id="MJXp-Span-1600" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1601" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-227">O(\sum v(i, i+j))</script> time. For a fixed <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">i</span></span></span><script type="math/tex" id="MathJax-Element-228">i</script>, we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">O</span><span class="MJXp-mo" id="MJXp-Span-1606" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1607" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608">m</span><span class="MJXp-mo" id="MJXp-Span-1609">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1612" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-229">O(\frac{m-n}{i})</script> values satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">v</span><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616">i</span><span class="MJXp-mo" id="MJXp-Span-1617" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618">i</span><span class="MJXp-mo" id="MJXp-Span-1619" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">j</span><span class="MJXp-mo" id="MJXp-Span-1621" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1622" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1623">1</span></span></span><script type="math/tex" id="MathJax-Element-230">v(i, i+j) \geq 1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">O</span><span class="MJXp-mo" id="MJXp-Span-1626" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1627" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">m</span><span class="MJXp-mo" id="MJXp-Span-1629">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1633" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1634" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-231">O(\frac{m-n}{i^2})</script> values satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">v</span><span class="MJXp-mo" id="MJXp-Span-1637" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">i</span><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">i</span><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">j</span><span class="MJXp-mo" id="MJXp-Span-1643" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1644" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1645">2</span></span></span><script type="math/tex" id="MathJax-Element-232">v(i, i+j) \geq 2</script>, and so forth. Therefore, for a fixed <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">i</span></span></span><script type="math/tex" id="MathJax-Element-233">i</script>, we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1648"><span class="MJXp-mo" id="MJXp-Span-1649" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">v</span><span class="MJXp-mo" id="MJXp-Span-1651" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">i</span><span class="MJXp-mo" id="MJXp-Span-1653" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">i</span><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">j</span><span class="MJXp-mo" id="MJXp-Span-1657" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1658" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">O</span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mfrac" id="MJXp-Span-1662" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">m</span><span class="MJXp-mo" id="MJXp-Span-1664">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1668" style="vertical-align: 0.5em;">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1669" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1670" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671">O</span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1673" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">m</span><span class="MJXp-mo" id="MJXp-Span-1675">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mfrac" id="MJXp-Span-1679" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1680">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682" style="margin-right: 0.05em;">i</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1683" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">k</span><span class="MJXp-mo" id="MJXp-Span-1685">−</span><span class="MJXp-mn" id="MJXp-Span-1686">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1687" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">O</span><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1691" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">m</span><span class="MJXp-mo" id="MJXp-Span-1693">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1696" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mfrac" id="MJXp-Span-1697" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1698">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1699">1</span><span class="MJXp-mo" id="MJXp-Span-1700">−</span><span class="MJXp-mfrac" id="MJXp-Span-1701" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1702">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703">i</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1704" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1705" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">O</span><span class="MJXp-mo" id="MJXp-Span-1707" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1708" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">m</span><span class="MJXp-mo" id="MJXp-Span-1710">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1713" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mfrac" id="MJXp-Span-1714" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">i</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">i</span><span class="MJXp-mo" id="MJXp-Span-1717">−</span><span class="MJXp-mn" id="MJXp-Span-1718">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1719" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1720" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721">O</span><span class="MJXp-mo" id="MJXp-Span-1722" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1723" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">m</span><span class="MJXp-mo" id="MJXp-Span-1725" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726">n</span><span class="MJXp-mo" id="MJXp-Span-1727" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1728" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mfrac" id="MJXp-Span-1729" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1730">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">i</span><span class="MJXp-mo" id="MJXp-Span-1732">−</span><span class="MJXp-mn" id="MJXp-Span-1733">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1734" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-234">\sum v(i, i+j) = O(\sum \frac{m-n}{i^k}) = O(\frac{m-n}{i}\sum \frac{1}{i^{k-1}}) = O(\frac{m-n}{i} \cdot \frac{1}{1-\frac{1}{i}}) = O(\frac{m-n}{i} \cdot \frac{i}{i-1}) = O((m-n) \cdot \frac{1}{i-1})</script>. Across all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">i</span><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1738">2</span></span></span><script type="math/tex" id="MathJax-Element-235">i\geq 2</script>, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">O</span><span class="MJXp-mo" id="MJXp-Span-1741" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1742" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">m</span><span class="MJXp-mo" id="MJXp-Span-1744" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745">n</span><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">H</span><span class="MJXp-mo" id="MJXp-Span-1748" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">n</span><span class="MJXp-mo" id="MJXp-Span-1750" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1751">1</span><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1753" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1754" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">O</span><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">m</span><span class="MJXp-mo" id="MJXp-Span-1759" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760">n</span><span class="MJXp-mo" id="MJXp-Span-1761" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1762">log</span><span class="MJXp-mo" id="MJXp-Span-1763" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">n</span><span class="MJXp-mo" id="MJXp-Span-1765" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-236">O((m-n)H(n-1)) = O((m-n)\log n)</script>. This is dominated by the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767">O</span><span class="MJXp-mo" id="MJXp-Span-1768" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1769" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">m</span><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">n</span><span class="MJXp-mo" id="MJXp-Span-1773" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1774">log</span><span class="MJXp-mo" id="MJXp-Span-1775" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">n</span><span class="MJXp-mi" id="MJXp-Span-1777">log</span><span class="MJXp-mo" id="MJXp-Span-1778" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1779"><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">m</span><span class="MJXp-mo" id="MJXp-Span-1782" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">n</span><span class="MJXp-mo" id="MJXp-Span-1784" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1785" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-237">O((m-n)\log n\log{(m-n)})</script> term from the updates.</p><p>Finally, we have an additional <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">n</span></span></span><script type="math/tex" id="MathJax-Element-238">n</script> term, as we have to iterate through all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">i</span><span class="MJXp-mo" id="MJXp-Span-1790" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">n</span></span></span><script type="math/tex" id="MathJax-Element-239">i\leq n</script>. Our total runtime is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">O</span><span class="MJXp-mo" id="MJXp-Span-1794" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1795" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">m</span><span class="MJXp-mo" id="MJXp-Span-1797" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">n</span><span class="MJXp-mo" id="MJXp-Span-1799" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1800">log</span><span class="MJXp-mo" id="MJXp-Span-1801" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">n</span><span class="MJXp-mi" id="MJXp-Span-1803">log</span><span class="MJXp-mo" id="MJXp-Span-1804" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1805"><span class="MJXp-mo" id="MJXp-Span-1806" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807">m</span><span class="MJXp-mo" id="MJXp-Span-1808" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">n</span><span class="MJXp-mo" id="MJXp-Span-1810" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1811" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">n</span><span class="MJXp-mo" id="MJXp-Span-1813" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-240">O((m-n)\log n\log{(m-n)} + n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> mx</span><span class="pun">(</span><span class="pln">m</span><span class="pun">-</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">function</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)&gt;</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[&amp;](</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">)-&gt;</span><span class="kwd">int</span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> ret </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(;</span><span class="pln"> i</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">=(</span><span class="pln">i</span><span class="pun">&amp;</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            ret </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">ret</span><span class="pun">,</span><span class="pln"> mx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">function</span><span class="pun">&lt;</span><span class="kwd">void</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">)&gt;</span><span class="pln"> update </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[&amp;](</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> val</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">-</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">|=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            mx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">mx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> val</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">function</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">)&gt;</span><span class="pln"> v </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[](</span><span class="kwd">int</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">)-&gt;</span><span class="kwd">int</span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(!(</span><span class="pln">x </span><span class="pun">%</span><span class="pln"> b</span><span class="pun">)){</span><span class="pln">
            ans</span><span class="pun">++;</span><span class="pln">
            x </span><span class="pun">/=</span><span class="pln"> b</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=(</span><span class="pln">m</span><span class="pun">-</span><span class="pln">n</span><span class="pun">+</span><span class="pln">i</span><span class="pun">)/</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">&gt;=</span><span class="pln">i</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">-=</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
            update</span><span class="pun">(</span><span class="pln">j</span><span class="pun">-</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> query</span><span class="pun">(</span><span class="pln">j</span><span class="pun">-</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> v</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">));</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> query</span><span class="pun">(</span><span class="pln">m</span><span class="pun">-</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13751">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="28">28</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13752">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="19">19</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13753">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13754">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13755">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13756">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13757">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13758">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="6">6</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13759">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="41">41</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13760">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="12">12</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2171" class="notice" style="text-decoration: none;">Codeforces Round 1065 (Div. 3)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>