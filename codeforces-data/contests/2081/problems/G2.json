{
  "contestId": 2081,
  "index": "G2",
  "title": "Hard Formula (Hard Version)",
  "timeLimit": "10 seconds",
  "memoryLimit": "1024 megabytes",
  "rating": 3400,
  "tags": [
    "math"
  ],
  "statementHtml": "<p><span class=\"tex-font-style-bf\">This is the hard version of the problem. The difference between the versions is that in this version, the limit on <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-1\">n</script> and the <span class=\"tex-font-style-it\">time limit</span> are higher. You can hack only if you solved all versions of this problem.</span> </p>\n<p>You are given an integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-4\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-4\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mi\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-2\">n</script>, and you need to compute <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-16\"><span class=\"MJXp-mo\" id=\"MJXp-Span-17\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-18\"><span class=\"MJXp-mo\" id=\"MJXp-Span-19\" style=\"margin-left: 0.111em; margin-right: 0.05em;\">∑</span><span class=\"MJXp-script-box\" style=\"height: 1.86em; vertical-align: -0.64em;\"><span class=\" MJXp-script\"><span><span style=\"margin-bottom: -0.25em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-24\">n</span></span></span></span><span class=\" MJXp-script\"><span><span style=\"margin-top: -0.85em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-20\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-21\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-22\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-23\">1</span></span></span></span></span></span></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-25\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-26\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-27\">φ</span><span class=\"MJXp-mo\" id=\"MJXp-Span-28\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-29\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-30\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-31\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-32\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-33\"><span class=\"MJXp-mn\" id=\"MJXp-Span-34\" style=\"margin-right: 0.05em;\">2</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-35\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-36\">32</span></span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-7\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-8\"><span class=\"mo\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Main;\">(</span><span class=\"munderover\" id=\"MathJax-Span-10\"><span style=\"display: inline-block; position: relative; width: 2.384em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-11\" style=\"font-family: MathJax_Size1; vertical-align: 0em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.52em, 1000.49em, 4.169em, -999.997em); top: -4.489em; left: 1.085em;\"><span class=\"mi\" id=\"MathJax-Span-12\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.358em, 1001.36em, 4.169em, -999.997em); top: -3.731em; left: 1.085em;\"><span class=\"texatom\" id=\"MathJax-Span-13\"><span class=\"mrow\" id=\"MathJax-Span-14\"><span class=\"mi\" id=\"MathJax-Span-15\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">k</span><span class=\"mo\" id=\"MathJax-Span-16\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">=</span><span class=\"mn\" id=\"MathJax-Span-17\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-18\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">k</span><span class=\"mo\" id=\"MathJax-Span-19\" style=\"font-family: MathJax_Main; padding-left: 0.273em; padding-right: 0.273em;\">mod</span><span class=\"mi\" id=\"MathJax-Span-20\" style=\"font-family: MathJax_Math-italic;\">φ</span><span class=\"mo\" id=\"MathJax-Span-21\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-22\" style=\"font-family: MathJax_Math-italic;\">k</span><span class=\"mo\" id=\"MathJax-Span-23\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-24\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-25\" style=\"font-family: MathJax_Main; padding-left: 0.273em; padding-right: 0.273em;\">mod</span><span class=\"msubsup\" id=\"MathJax-Span-26\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-27\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"texatom\" id=\"MathJax-Span-28\"><span class=\"mrow\" id=\"MathJax-Span-29\"><span class=\"mn\" id=\"MathJax-Span-30\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">32</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-3\">(\\sum_{k=1}^n k\\bmod\\varphi(k))\\bmod 2^{32}</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-37\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-38\">φ</span><span class=\"MJXp-mo\" id=\"MJXp-Span-39\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-40\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-41\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-31\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-32\"><span class=\"mi\" id=\"MathJax-Span-33\" style=\"font-family: MathJax_Math-italic;\">φ</span><span class=\"mo\" id=\"MathJax-Span-34\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-35\" style=\"font-family: MathJax_Math-italic;\">k</span><span class=\"mo\" id=\"MathJax-Span-36\" style=\"font-family: MathJax_Main;\">)</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-4\">\\varphi(k)</script> equals the number of positive integers no greater than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-42\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-43\">k</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-37\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-38\"><span class=\"mi\" id=\"MathJax-Span-39\" style=\"font-family: MathJax_Math-italic;\">k</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-5\">k</script> that are coprime with <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-44\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-45\">k</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-40\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-41\"><span class=\"mi\" id=\"MathJax-Span-42\" style=\"font-family: MathJax_Math-italic;\">k</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-6\">k</script>.</p>",
  "inputSpecHtml": "<p>The only line contains a single integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-46\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-47\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-43\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-44\"><span class=\"mi\" id=\"MathJax-Span-45\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-7\">n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-48\"><span class=\"MJXp-mn\" id=\"MJXp-Span-49\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-50\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-51\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-52\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-53\"><span class=\"MJXp-mn\" id=\"MJXp-Span-54\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-55\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-56\">12</span></span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-46\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-47\"><span class=\"mn\" id=\"MathJax-Span-48\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-49\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-50\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-51\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-52\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.788em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-53\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"texatom\" id=\"MathJax-Span-54\"><span class=\"mrow\" id=\"MathJax-Span-55\"><span class=\"mn\" id=\"MathJax-Span-56\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">12</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-8\">1 \\le n \\le 10^{12}</script>).</p>",
  "outputSpecHtml": "<p>Print a single integer, representing <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-57\"><span class=\"MJXp-mo\" id=\"MJXp-Span-58\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-59\"><span class=\"MJXp-mo\" id=\"MJXp-Span-60\" style=\"margin-left: 0.111em; margin-right: 0.05em;\">∑</span><span class=\"MJXp-script-box\" style=\"height: 1.86em; vertical-align: -0.64em;\"><span class=\" MJXp-script\"><span><span style=\"margin-bottom: -0.25em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-65\">n</span></span></span></span><span class=\" MJXp-script\"><span><span style=\"margin-top: -0.85em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-61\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-62\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-63\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-64\">1</span></span></span></span></span></span></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-66\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-67\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-68\">φ</span><span class=\"MJXp-mo\" id=\"MJXp-Span-69\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-70\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-71\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-72\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-73\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-74\"><span class=\"MJXp-mn\" id=\"MJXp-Span-75\" style=\"margin-right: 0.05em;\">2</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-76\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-77\">32</span></span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-57\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-58\"><span class=\"mo\" id=\"MathJax-Span-59\" style=\"font-family: MathJax_Main;\">(</span><span class=\"munderover\" id=\"MathJax-Span-60\"><span style=\"display: inline-block; position: relative; width: 2.384em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-61\" style=\"font-family: MathJax_Size1; vertical-align: 0em;\">∑</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.52em, 1000.49em, 4.169em, -999.997em); top: -4.489em; left: 1.085em;\"><span class=\"mi\" id=\"MathJax-Span-62\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.358em, 1001.36em, 4.169em, -999.997em); top: -3.731em; left: 1.085em;\"><span class=\"texatom\" id=\"MathJax-Span-63\"><span class=\"mrow\" id=\"MathJax-Span-64\"><span class=\"mi\" id=\"MathJax-Span-65\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">k</span><span class=\"mo\" id=\"MathJax-Span-66\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">=</span><span class=\"mn\" id=\"MathJax-Span-67\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-68\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">k</span><span class=\"mo\" id=\"MathJax-Span-69\" style=\"font-family: MathJax_Main; padding-left: 0.273em; padding-right: 0.273em;\">mod</span><span class=\"mi\" id=\"MathJax-Span-70\" style=\"font-family: MathJax_Math-italic;\">φ</span><span class=\"mo\" id=\"MathJax-Span-71\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-72\" style=\"font-family: MathJax_Math-italic;\">k</span><span class=\"mo\" id=\"MathJax-Span-73\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-74\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-75\" style=\"font-family: MathJax_Main; padding-left: 0.273em; padding-right: 0.273em;\">mod</span><span class=\"msubsup\" id=\"MathJax-Span-76\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-77\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"texatom\" id=\"MathJax-Span-78\"><span class=\"mrow\" id=\"MathJax-Span-79\"><span class=\"mn\" id=\"MathJax-Span-80\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">32</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-9\">(\\sum_{k=1}^n k\\bmod\\varphi(k))\\bmod 2^{32}</script>.</p>",
  "noteHtml": "",
  "samples": [
    {
      "input": "5",
      "output": "2"
    },
    {
      "input": "10000000",
      "output": "2316623097"
    },
    {
      "input": "10000000000",
      "output": "282084447"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2081/problem/G2"
}