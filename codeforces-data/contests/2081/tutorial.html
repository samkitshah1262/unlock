<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/140702" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>Sorry for the late editorial. Our problem setters were so exhausted with the offline competition yesterday that they really need some good rest.</p><p>Despite the unexpected and unpleasant incidents that occurred, we are truly surprised and grateful that so many of you still participated in this competition! We sincerely hope you enjoyed it!</p><p>(Gratitude for all you guys from <a class="rated-user user-red" href="https://codeforces.com/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a>: I felt so heartbroken when I heard about the unexpected issues, but seeing so many people in the comments comforting us, sharing thoughtful and positive messages that showed genuine empathy, and continuing to fully support our competition even after the wasted time, I was deeply moved. Thank you all! Codeforces truly embodies such a positive and uplifting community spirit!)</p><p><a href="https://codeforces.com/contest/2082/problem/A" title="Codeforces Round 1010 (Div. 2, Unrated)">2082A - Binary Matrix</a> <br> Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>Do we really have to consider the problem on the whole matrix?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">r</span></span></span><script type="math/tex" id="MathJax-Element-1">r</script> be the number of rows where the bitwise XOR of all the numbers in it is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mn" id="MJXp-Span-4">1</span></span></span><script type="math/tex" id="MathJax-Element-2">1</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">c</span></span></span><script type="math/tex" id="MathJax-Element-3">c</script> be the number of columns where the bitwise XOR of all the numbers in it is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mn" id="MJXp-Span-8">1</span></span></span><script type="math/tex" id="MathJax-Element-4">1</script>. Our goal is to make both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">r</span></span></span><script type="math/tex" id="MathJax-Element-5">r</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">c</span></span></span><script type="math/tex" id="MathJax-Element-6">c</script> zero.</p><p>When we change an element in the matrix, both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">r</span></span></span><script type="math/tex" id="MathJax-Element-7">r</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">c</span></span></span><script type="math/tex" id="MathJax-Element-8">c</script> change by exactly one. Thus, it's not hard to see that the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">r</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">c</span><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-9">\max (r,c)</script>.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">O</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">m</span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-10">O(\sum nm)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">c</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">char</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">1009</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">bool</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">1009</span><span class="pun">][</span><span class="lit">1009</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ll read</span><span class="pun">(){</span><span class="pln">
	ll s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">)</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">^</span><span class="pln"> </span><span class="lit">48</span><span class="pun">),</span><span class="pln">ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	t </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">
		n </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">m </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">r </span><span class="pun">=</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			scanf</span><span class="pun">(</span><span class="str">"%s"</span><span class="pun">,</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">bool</span><span class="pln"> sum </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> sum </span><span class="pun">^=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sum</span><span class="pun">)</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">bool</span><span class="pln"> sum </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> sum </span><span class="pun">^=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sum</span><span class="pun">)</span><span class="pln"> c </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln">max</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln">c</span><span class="pun">));</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2082/problem/B" title="Codeforces Round 1010 (Div. 2, Unrated)">2082B - Floor or Ceil</a> <br> Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a>, <a class="rated-user user-red" href="https://codeforces.com/profile/FairyWinx" title="Grandmaster FairyWinx">FairyWinx</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">x</span></span></span><script type="math/tex" id="MathJax-Element-11">x</script> in binary form.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>What are all possible values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">x</span></span></span><script type="math/tex" id="MathJax-Element-12">x</script> after <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">n</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">m</span></span></span><script type="math/tex" id="MathJax-Element-13">n+m</script> operations?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let's consider how to find the maximum value first. </p><p>Consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">x</span></span></span><script type="math/tex" id="MathJax-Element-14">x</script> in binary form. Let the number formed by the last <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">n</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">m</span></span></span><script type="math/tex" id="MathJax-Element-15">n+m</script> bits of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">x</span></span></span><script type="math/tex" id="MathJax-Element-16">x</script> be denoted as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-49"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">r</span></span></span><script type="math/tex" id="MathJax-Element-17">r</script>, and the remaining higher bits form the number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-51"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">l</span></span></span><script type="math/tex" id="MathJax-Element-18">l</script> (for instance, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-53"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">x</span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-56">12</span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-59">1100</span><span class="MJXp-msubsup" id="MJXp-Span-60"><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-62" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-19">x=12=(1100)_2</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">n</span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-66">1</span></span></span><script type="math/tex" id="MathJax-Element-20">n=1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">m</span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-70">2</span></span></span><script type="math/tex" id="MathJax-Element-21">m=2</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">l</span><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-74">1</span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-77">1</span><span class="MJXp-msubsup" id="MJXp-Span-78"><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-80" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-22">l=1=(1)_2</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">r</span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-84">4</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-87">100</span><span class="MJXp-msubsup" id="MJXp-Span-88"><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-90" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-23">r=4=(100)_2</script>), then the final value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">x</span></span></span><script type="math/tex" id="MathJax-Element-24">x</script> after <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-93"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">n</span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">m</span></span></span><script type="math/tex" id="MathJax-Element-25">n+m</script> operations will be either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">l</span></span></span><script type="math/tex" id="MathJax-Element-26">l</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">l</span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-102">1</span></span></span><script type="math/tex" id="MathJax-Element-27">l+1</script>, depending on whether a carry-over occurs in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">r</span></span></span><script type="math/tex" id="MathJax-Element-28">r</script> during the last operation.</p><p>If there are no <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-mn" id="MJXp-Span-106">1</span></span></span><script type="math/tex" id="MathJax-Element-29">1</script>s in the higher <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">m</span></span></span><script type="math/tex" id="MathJax-Element-30">m</script> bits of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">r</span></span></span><script type="math/tex" id="MathJax-Element-31">r</script>, then the carry-over in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">r</span></span></span><script type="math/tex" id="MathJax-Element-32">r</script> during the last operation can never occur (operating on some small tests may give you a better understanding). Otherwise, we can choose to perform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">n</span></span></span><script type="math/tex" id="MathJax-Element-33">n</script> floor operations first followed by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">m</span></span></span><script type="math/tex" id="MathJax-Element-34">m</script> ceil operations, which can guarantee a carry-over in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">r</span></span></span><script type="math/tex" id="MathJax-Element-35">r</script> during the last operation.</p><p>This demonstrates that performing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">n</span></span></span><script type="math/tex" id="MathJax-Element-36">n</script> floor operations first followed by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">m</span></span></span><script type="math/tex" id="MathJax-Element-37">m</script> ceil operations will always yield the maximum value. Similarly, performing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">m</span></span></span><script type="math/tex" id="MathJax-Element-38">m</script> ceil operations first followed by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">n</span></span></span><script type="math/tex" id="MathJax-Element-39">n</script> floor operations will always produce the minimum value. We can simply simulate these operations because after <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">O</span><span class="MJXp-mo" id="MJXp-Span-129" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-130">log</span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">x</span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-40">O(\log x)</script> same operations, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">x</span></span></span><script type="math/tex" id="MathJax-Element-41">x</script> will remain unchanged.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">O</span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">T</span><span class="MJXp-mi" id="MJXp-Span-140">log</span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">x</span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-42">O(T\log x)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">,</span><span class="pln">x</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ll read</span><span class="pun">(){</span><span class="pln">
	ll s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">)</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">^</span><span class="pln"> </span><span class="lit">48</span><span class="pun">),</span><span class="pln">ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
ll F</span><span class="pun">(</span><span class="pln">ll x</span><span class="pun">,</span><span class="pln">ll n</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">--){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
		x </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
ll C</span><span class="pun">(</span><span class="pln">ll x</span><span class="pun">,</span><span class="pln">ll n</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">--){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
		x </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	t </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">
		x </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">n </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">m </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld %lld\n"</span><span class="pun">,</span><span class="pln">F</span><span class="pun">(</span><span class="pln">C</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln">m</span><span class="pun">),</span><span class="pln">n</span><span class="pun">),</span><span class="pln">C</span><span class="pun">(</span><span class="pln">F</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln">n</span><span class="pun">),</span><span class="pln">m</span><span class="pun">));</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2081/problem/A" title="Codeforces Round 1010 (Div. 1, Unrated)">2081A - Math Division</a> <br> Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">x</span></span></span><script type="math/tex" id="MathJax-Element-43">x</script> in binary form.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>What are all possible numbers of operations to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">x</span></span></span><script type="math/tex" id="MathJax-Element-44">x</script> equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-148"><span class="MJXp-mn" id="MJXp-Span-149">1</span></span></span><script type="math/tex" id="MathJax-Element-45">1</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>Consider using dynamic programming to calculate the answer.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Similar to the previous problem, the possible number of operations can only be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">n</span><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-153">1</span></span></span><script type="math/tex" id="MathJax-Element-46">n-1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">n</span></span></span><script type="math/tex" id="MathJax-Element-47">n</script>, depending on whether a carry-over occurs in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">x</span></span></span><script type="math/tex" id="MathJax-Element-48">x</script> during the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-158"><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">n</span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-162">1</span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-49">(n-1)</script> -th operation.</p><p>We can use dynamic programming to compute the probability of a carry-over occurring during the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-164"><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">n</span><span class="MJXp-mo" id="MJXp-Span-167" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-168">1</span><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-50">(n-1)</script> -th operation.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-msubsup" id="MJXp-Span-171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-173" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-51">f_i</script> denote the probability of a carry-over occurring at the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">i</span></span></span><script type="math/tex" id="MathJax-Element-52">i</script> -th least significant bit. The recurrence relation is: </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-176"><span class="MJXp-msubsup" id="MJXp-Span-177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-179" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-181"><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.306em;"><span class="MJXp-right MJXp-scale3" style="font-size: 6.222em; margin-left: -0.336em;">{</span></span><span class="MJXp-mtable" id="MJXp-Span-183"><span><span class="MJXp-mtr" id="MJXp-Span-184" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-185" style="text-align: left;"><span class="MJXp-mstyle" id="MJXp-Span-186"><span class="MJXp-mfrac" id="MJXp-Span-187" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-188">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-189">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-msubsup" id="MJXp-Span-191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-193" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">i</span><span class="MJXp-mo" id="MJXp-Span-195">−</span><span class="MJXp-mn" id="MJXp-Span-196">1</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-197" style="padding-left: 1em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-200" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-202">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-203" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-204" style="padding-top: 0.2em; text-align: left;"><span class="MJXp-mstyle" id="MJXp-Span-205"><span class="MJXp-mfrac" id="MJXp-Span-206" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-207">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-208">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-211">1</span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-215" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">i</span><span class="MJXp-mo" id="MJXp-Span-217">−</span><span class="MJXp-mn" id="MJXp-Span-218">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-223" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">i</span><span class="MJXp-mo" id="MJXp-Span-225">−</span><span class="MJXp-mn" id="MJXp-Span-226">1</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-227" style="padding-left: 1em; padding-top: 0.2em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-230" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-232">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0em; margin-right: 0em;"></span></span></span></span><script type="math/tex" id="MathJax-Element-53"> f_i = \begin{cases} \dfrac{1}{2} \times f_{i-1} & x_i = 0 \\ \dfrac{1}{2} \times (1 - f_{i-1}) + f_{i-1} & x_i = 1 \end{cases} </script></center><p>The final answer is given by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">n</span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-237">1</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-241" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">n</span><span class="MJXp-mo" id="MJXp-Span-243">−</span><span class="MJXp-mn" id="MJXp-Span-244">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-54">n-1+f_{n-1}</script>.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">O</span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">n</span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-55">O(\sum n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> ll inv2 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5e8</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln">mod </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e9</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">7</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">char</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">1000009</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ll read</span><span class="pun">(){</span><span class="pln">
	ll s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">)</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">^</span><span class="pln"> </span><span class="lit">48</span><span class="pun">),</span><span class="pln">ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	t </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">
		n </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%s"</span><span class="pun">,</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		ll ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ans </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'1'</span><span class="pun">))</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> inv2 </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> ans</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2081/problem/B" title="Codeforces Round 1010 (Div. 1, Unrated)">2081B - Balancing</a> <br> Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Let's only consider the comparison between adjacent pairs first. Call a pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-251"><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-255" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-259" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">i</span><span class="MJXp-mo" id="MJXp-Span-261">+</span><span class="MJXp-mn" id="MJXp-Span-262">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-56">(a_i,a_{i+1})</script> an inversion pair if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-264"><span class="MJXp-msubsup" id="MJXp-Span-265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-267" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-271" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">i</span><span class="MJXp-mo" id="MJXp-Span-273">+</span><span class="MJXp-mn" id="MJXp-Span-274">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-57">a_i>a_{i+1}</script>.</p><p>In each operation, how can the number of inversion pairs change?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Under what circumstances can we decrease the maximum number of inversion pairs in every operation?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let's only consider the comparison between adjacent pairs first. Call a pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-275"><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-279" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-283" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">i</span><span class="MJXp-mo" id="MJXp-Span-285">+</span><span class="MJXp-mn" id="MJXp-Span-286">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-58">(a_i,a_{i+1})</script> an inversion pair if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-288"><span class="MJXp-msubsup" id="MJXp-Span-289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-291" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-295" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">i</span><span class="MJXp-mo" id="MJXp-Span-297">+</span><span class="MJXp-mn" id="MJXp-Span-298">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-59">a_i>a_{i+1}</script>. Our goal is to decrease the number of inversion pairs to zero.</p><p>If we choose to replace <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-299"><span class="MJXp-msubsup" id="MJXp-Span-300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-302" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-306" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">l</span><span class="MJXp-mo" id="MJXp-Span-308">+</span><span class="MJXp-mn" id="MJXp-Span-309">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-310" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-315" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-60">a_l,a_{l+1},\ldots,a_r</script>, only the comparison between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-316"><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-320" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">l</span><span class="MJXp-mo" id="MJXp-Span-322">−</span><span class="MJXp-mn" id="MJXp-Span-323">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-327" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-61">(a_{l-1},a_l)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-329"><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-333" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-338" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">r</span><span class="MJXp-mo" id="MJXp-Span-340">+</span><span class="MJXp-mn" id="MJXp-Span-341">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-62">(a_{r},a_{r+1})</script> can change, which means we can eliminate at most two inversion pairs in one operation. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">s</span></span></span><script type="math/tex" id="MathJax-Element-63">s</script> be the number of inversion pairs in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-345"><span class="MJXp-msubsup" id="MJXp-Span-346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-348" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-352" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-358" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-64">a_1,a_2,\ldots,a_n</script>, then a lower bound of the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">l</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-362"><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌈</span></span><span class="MJXp-mstyle" id="MJXp-Span-364"><span class="MJXp-mfrac" id="MJXp-Span-365" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">s</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-367">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌉</span></span></span></span></span><script type="math/tex" id="MathJax-Element-65">l=\left\lceil\dfrac{s}{2}\right\rceil</script>.</p><h4><strong>Case 1: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">s</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-372">0</span></span></span><script type="math/tex" id="MathJax-Element-66">s>0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-373"><span class="MJXp-mn" id="MJXp-Span-374">2</span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">s</span></span></span><script type="math/tex" id="MathJax-Element-67">2\mid s</script></strong></h4><p>In order to obtain the lower bound <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">l</span></span></span><script type="math/tex" id="MathJax-Element-68">l</script>, each operation must eliminate exactly two inversion pairs. This necessitates that we cannot alter any numbers before the first element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-379"><span class="MJXp-msubsup" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-382" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-385" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-69">a_{p_1}</script> of the first inversion pair or after the second element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-386"><span class="MJXp-msubsup" id="MJXp-Span-387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-389" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-392" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-70">a_{p_2}</script> of the last inversion pair. (Why?)</p><p>An intuitive idea is that the difference between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-393"><span class="MJXp-msubsup" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-396" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-399" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-71">a_{p_1}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-400"><span class="MJXp-msubsup" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-403" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-406" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-72">a_{p_2}</script> should be as large as possible (more precisely, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-407"><span class="MJXp-msubsup" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-410" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-413" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-417" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-420" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-421" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-424" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-425" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-428" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-73">a_{p_2} - a_{p_1} \geq p_2 - p_1</script>), so that a strictly increasing sequence can be "accommodated" between them. It is not difficult to constructively prove by recursion that this condition is both necessary and sufficient. </p><p>In other words, when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-429"><span class="MJXp-msubsup" id="MJXp-Span-430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-432" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-435" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-439" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-442" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-446" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-450" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-74">a_{p_2} - a_{p_1} \geq p_2 - p_1</script>, the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">l</span></span></span><script type="math/tex" id="MathJax-Element-75">l</script>; otherwise, an additional operation is required, making the answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">l</span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-456">1</span></span></span><script type="math/tex" id="MathJax-Element-76">l+1</script>.</p><h4><strong>Case 2: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">s</span><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-460">0</span></span></span><script type="math/tex" id="MathJax-Element-77">s=0</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-464"><span class="MJXp-mn" id="MJXp-Span-465">2</span><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0.333em; margin-right: 0.333em;">∤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">s</span></span></span><script type="math/tex" id="MathJax-Element-78">2\not\mid s</script></strong></h4><p>It's not difficult to prove that the answer in this case is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">l</span></span></span><script type="math/tex" id="MathJax-Element-79">l</script>. (Why?)</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">O</span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">n</span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-80">O(\sum n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="lit">200009</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ll read</span><span class="pun">(){</span><span class="pln">
	ll s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">)</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">^</span><span class="pln"> </span><span class="lit">48</span><span class="pun">),</span><span class="pln">ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	t </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">
		n </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		ll ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">pos1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">pos2 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]){</span><span class="pln">
			ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">pos2 </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">pos1</span><span class="pun">)</span><span class="pln"> pos1 </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">ans </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos1 </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">pos2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">pos1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> pos2 </span><span class="pun">-</span><span class="pln"> pos1</span><span class="pun">))</span><span class="pln"> printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,(</span><span class="pln">ans </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln"> printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln">ans </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2081/problem/C" title="Codeforces Round 1010 (Div. 1, Unrated)">2081C - Quaternary Matrix</a> <br> Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Do we really have to consider the problem on the whole matrix?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Use greedy algorithm and guess some possible conclusions. Can you prove them (or construct some counterexamples) ?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>The problem can be rephrased as follows: Let the XOR sum of each row be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-476"><span class="MJXp-msubsup" id="MJXp-Span-477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-479" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-483" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-485" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-489" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-81"> r_1, r_2, \ldots, r_n </script>, and the XOR sum of each column be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-490"><span class="MJXp-msubsup" id="MJXp-Span-491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-493" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-497" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-498" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-499" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-503" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-82"> c_1, c_2, \ldots, c_m </script>. In each operation, we can choose any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-mn" id="MJXp-Span-505">1</span><span class="MJXp-mo" id="MJXp-Span-506" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">i</span><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">n</span></span></span><script type="math/tex" id="MathJax-Element-83"> 1 \le i \le n </script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-510"><span class="MJXp-mn" id="MJXp-Span-511">1</span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">j</span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">m</span></span></span><script type="math/tex" id="MathJax-Element-84"> 1 \le j \le m </script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-516"><span class="MJXp-mn" id="MJXp-Span-517">0</span><span class="MJXp-mo" id="MJXp-Span-518" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">x</span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-521">3</span></span></span><script type="math/tex" id="MathJax-Element-85"> 0 \le x \le 3 </script>, then let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-msubsup" id="MJXp-Span-523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-525" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-529" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">x</span></span></span><script type="math/tex" id="MathJax-Element-86"> r_i \leftarrow r_i \oplus x </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-532"><span class="MJXp-msubsup" id="MJXp-Span-533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-535" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-539" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">x</span></span></span><script type="math/tex" id="MathJax-Element-87"> c_j \leftarrow c_j \oplus x </script>. The goal is to determine the minimum number of operations required to make all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-542"><span class="MJXp-msubsup" id="MJXp-Span-543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-545" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-546" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-549" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-550" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-552" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-555" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-88"> r_1, r_2, \ldots, r_n </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-556"><span class="MJXp-msubsup" id="MJXp-Span-557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-559" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-563" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-564" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-569" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-89"> c_1, c_2, \ldots, c_m </script> zero. </p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-570"><span class="MJXp-msubsup" id="MJXp-Span-571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-573" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-574">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-576">0</span><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">x</span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-580">3</span><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-90"> R_x\ ( 0 \le x \le 3 )</script> denote the count of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">x</span></span></span><script type="math/tex" id="MathJax-Element-91"> x </script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-584"><span class="MJXp-msubsup" id="MJXp-Span-585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-587" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-588" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-591" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-592" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-597" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-92"> r_1, r_2, \ldots, r_n </script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-598"><span class="MJXp-msubsup" id="MJXp-Span-599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-601" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-93"> C_x </script> denote the count of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">x</span></span></span><script type="math/tex" id="MathJax-Element-94"> x </script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-604"><span class="MJXp-msubsup" id="MJXp-Span-605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-607" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-611" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-612" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-613" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-614" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-617" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-95"> c_1, c_2, \ldots, c_m </script>. A trivial upper bound for the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-618"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">s</span><span class="MJXp-mo" id="MJXp-Span-620" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-623" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-624" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-627" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-628" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-631" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-635" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-639" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-643" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-96"> s = R_1 + R_2 + R_3 + C_1 + C_2 + C_3 </script>, which corresponds to the scenario where each operation only zeros out one of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-644"><span class="MJXp-msubsup" id="MJXp-Span-645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-647" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-97"> r_i </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-648"><span class="MJXp-msubsup" id="MJXp-Span-649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-651" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-98"> c_j </script>. </p><p>To reduce the number of operations, we can consider grouping the non-zero elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-652"><span class="MJXp-msubsup" id="MJXp-Span-653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-655" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-658" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-661" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-665" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-668" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-671" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-99"> r_1, \ldots, r_n, c_1, \ldots, c_m </script> into disjoint groups where: </p> <ol>   <li>The XOR sum of each group is zero.</li>   <li>Each group contains at least one element from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-672"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">r</span></span></span><script type="math/tex" id="MathJax-Element-100"> r </script> and one from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">c</span></span></span><script type="math/tex" id="MathJax-Element-101"> c </script>.</li> </ol><p>For such a group, we can reduce the number of operations by one, as there always exists an operation which can zero out both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-676"><span class="MJXp-msubsup" id="MJXp-Span-677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-679" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-102"> r_i </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-680"><span class="MJXp-msubsup" id="MJXp-Span-681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-683" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-103"> c_j </script>. Thus, the goal is to maximize the number of such groups, and the minimum number of operations will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">s</span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-687">(number of groups formed)</span></span></span><script type="math/tex" id="MathJax-Element-104">s - \text{(number of groups formed)}</script>.</p><p>Define the following group types: </p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-688"><span class="MJXp-msubsup" id="MJXp-Span-689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-691" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-105"> P_2 </script>: Groups of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-692"><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-696" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-700" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-106">(R_1,C_1)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-706" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-710" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-107">(R_2,C_2)</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-712"><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-716" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-720" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-108">(R_3,C_3)</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-722"><span class="MJXp-msubsup" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-725" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-109"> P_3 </script>: Groups of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mo" id="MJXp-Span-727" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-730" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-731" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-734" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-738" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-110">(R_1,R_2,C_3)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-740"><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-744" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-745" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-748" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-749" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-752" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-753" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-111">(R_1,C_2,C_3)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-754"><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-758" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-762" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-763" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-766" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-112">(R_1,C_2,R_3)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-768"><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-772" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-776" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-780" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-113">(C_1,C_2,R_3)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-782"><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-784"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-786" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-790" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-794" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-795" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-114">(C_1,R_2,R_3)</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-796"><span class="MJXp-mo" id="MJXp-Span-797" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-800" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-804" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-805" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-808" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-115">(C_1,R_2,C_3)</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-810"><span class="MJXp-msubsup" id="MJXp-Span-811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-813" style="vertical-align: -0.4em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-116"> P_4 </script>: Groups of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-814"><span class="MJXp-mo" id="MJXp-Span-815" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-818" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-822" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-823" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-826" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-830" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-117">(R_1,R_1,C_2,C_2)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-832"><span class="MJXp-mo" id="MJXp-Span-833" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-836" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-837" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-840" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-844" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-845" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-848" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-118">(R_1,R_1,C_3,C_3)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-850"><span class="MJXp-mo" id="MJXp-Span-851" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-854" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-858" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-862" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-866" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-867" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-119">(R_2,R_2,C_1,C_1)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-868"><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-872" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-873" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-876" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-880" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-881" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-884" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-120">(R_2,R_2,C_3,C_3)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-886"><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-890" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-894" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-896"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-898" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-902" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-121">(R_3,R_3,C_1,C_1)</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-904"><span class="MJXp-mo" id="MJXp-Span-905" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-908" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-910"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-912" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-916" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-920" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-122">(R_3,R_3,C_2,C_2)</script>.</li> </ul><p><strong>Conclusion 1:</strong> There exists an optimal solution where all groups are of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-922"><span class="MJXp-msubsup" id="MJXp-Span-923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-925" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-123"> P_2 </script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-926"><span class="MJXp-msubsup" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-929" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-124"> P_3 </script>, or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-930"><span class="MJXp-msubsup" id="MJXp-Span-931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-933" style="vertical-align: -0.4em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-125"> P_4 </script>. </p> <div class="spoiler"><b class="spoiler-title">Brief Proof</b><div class="spoiler-content" style="display: block;"><ul>   <li>Each group must have size at least 2. Groups of size 2 or 3 can only be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-934"><span class="MJXp-msubsup" id="MJXp-Span-935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-937" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-126"> P_2 </script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-938"><span class="MJXp-msubsup" id="MJXp-Span-939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-941" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-127"> P_3 </script>.</li>   <li>Groups of size 4 not conforming to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-942"><span class="MJXp-msubsup" id="MJXp-Span-943"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-945" style="vertical-align: -0.4em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-128"> P_4 </script> (e.g., <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-946"><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-948"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-950" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-954" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-958" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-959" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-962" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-963" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-129"> (R_1, R_1, R_1, C_1) </script>) can be decomposed into at least one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-964"><span class="MJXp-msubsup" id="MJXp-Span-965"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-967" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-130"> P_2 </script>.</li>   <li>Larger groups can be decomposed into combinations of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-968"><span class="MJXp-msubsup" id="MJXp-Span-969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-971" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-131"> P_2 </script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-972"><span class="MJXp-msubsup" id="MJXp-Span-973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-975" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-132"> P_3 </script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-976"><span class="MJXp-msubsup" id="MJXp-Span-977"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-979" style="vertical-align: -0.4em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-133"> P_4 </script>.</li> </ul></div></div><p><strong>Conclusion 2:</strong> There exists an optimal solution where all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-980"><span class="MJXp-msubsup" id="MJXp-Span-981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-983" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-134"> P_3 </script> groups share the same structure, and so do all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-984"><span class="MJXp-msubsup" id="MJXp-Span-985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-987" style="vertical-align: -0.4em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-135"> P_4 </script> groups. </p> <div class="spoiler"><b class="spoiler-title">Brief Proof</b><div class="spoiler-content" style="display: block;"><ul>   <li>Two different <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-988"><span class="MJXp-msubsup" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-991" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-136"> P_3 </script> groups can be decomposed into at least two <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-992"><span class="MJXp-msubsup" id="MJXp-Span-993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-995" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-137"> P_2 </script> or at least one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-996"><span class="MJXp-msubsup" id="MJXp-Span-997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-999" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-138"> P_2 </script> and one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1000"><span class="MJXp-msubsup" id="MJXp-Span-1001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1003" style="vertical-align: -0.4em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-139"> P_4 </script>.</li>   <li>Two different <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1004"><span class="MJXp-msubsup" id="MJXp-Span-1005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1007" style="vertical-align: -0.4em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-140"> P_4 </script> groups can be decomposed into at least two <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1008"><span class="MJXp-msubsup" id="MJXp-Span-1009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1011" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-141"> P_2 </script> or at least two <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1012"><span class="MJXp-msubsup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1015" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-142"> P_3 </script>.</li> </ul></div></div><p><strong>Conclusion 3:</strong> There exists an optimal solution where the elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1016"><span class="MJXp-msubsup" id="MJXp-Span-1017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1019" style="vertical-align: -0.4em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-143"> P_4 </script> groups are a subset of those in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1020"><span class="MJXp-msubsup" id="MJXp-Span-1021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1023" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-144"> P_3 </script> groups (e.g., if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1024"><span class="MJXp-msubsup" id="MJXp-Span-1025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1027" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-145"> P_3 </script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1028"><span class="MJXp-mo" id="MJXp-Span-1029" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1032" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1036" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1037" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1040" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1041" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-146"> (R_1, R_2, C_3) </script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1042"><span class="MJXp-msubsup" id="MJXp-Span-1043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1045" style="vertical-align: -0.4em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-147"> P_4 </script> can only be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1046"><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1050" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1054" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1055" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1058" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1062" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-148"> (R_1, R_1, C_3, C_3) </script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1064"><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1068" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1072" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1073" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1076" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1080" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-149"> (R_2, R_2, C_3, C_3) </script>). The proof is analogous to Conclusion 2 and is left as an exercise. </p><p>Based on these conclusions, the optimal strategy is: first form as many <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1082"><span class="MJXp-msubsup" id="MJXp-Span-1083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1085" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-150">P_2</script> groups as possible; then form as many <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1086"><span class="MJXp-msubsup" id="MJXp-Span-1087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1089" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-151">P_3</script> groups as possible from the remaining elements; then form as many <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1090"><span class="MJXp-msubsup" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1093" style="vertical-align: -0.4em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-152">P_4</script> groups as possible from the remaining elements. </p><p>After grouping, each group can be zeroed out with one less operation. Note that the remaining ungrouped elements require individual operations. </p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">O</span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1097" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">m</span><span class="MJXp-mo" id="MJXp-Span-1100" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-153">O(\sum nm)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="lit">1009</span><span class="pun">][</span><span class="lit">1009</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">char</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">1009</span><span class="pun">];</span><span class="pln">
vector </span><span class="str">&lt;ll&gt;</span><span class="pln"> row</span><span class="pun">[</span><span class="lit">4</span><span class="pun">],</span><span class="pln">col</span><span class="pun">[</span><span class="lit">4</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ll read</span><span class="pun">(){</span><span class="pln">
	ll s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">)</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">^</span><span class="pln"> </span><span class="lit">48</span><span class="pun">),</span><span class="pln">ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	t </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">
		n </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">m </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">(),</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			scanf</span><span class="pun">(</span><span class="str">"%s"</span><span class="pun">,</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			ll sum </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> sum </span><span class="pun">^=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sum</span><span class="pun">)</span><span class="pln"> row</span><span class="pun">[</span><span class="pln">sum</span><span class="pun">].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			ll sum </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> sum </span><span class="pun">^=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sum</span><span class="pun">)</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">sum</span><span class="pun">].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">j</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		ll ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()){</span><span class="pln">
				ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
				a</span><span class="pun">[</span><span class="pln">row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()][</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
				row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">(),</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			ll j </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">%</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">k </span><span class="pun">=</span><span class="pln"> j </span><span class="pun">%</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">k</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()){</span><span class="pln">
				ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
				a</span><span class="pun">[</span><span class="pln">row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()][</span><span class="pln">col</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln">
				a</span><span class="pun">[</span><span class="pln">row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()][</span><span class="pln">col</span><span class="pun">[</span><span class="pln">k</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
				row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">(),</span><span class="pln">col</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">(),</span><span class="pln">col</span><span class="pun">[</span><span class="pln">k</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> row</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> row</span><span class="pun">[</span><span class="pln">k</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()){</span><span class="pln">
				ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
				a</span><span class="pun">[</span><span class="pln">row</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()][</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln">
				a</span><span class="pun">[</span><span class="pln">row</span><span class="pun">[</span><span class="pln">k</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()][</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
				col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">(),</span><span class="pln">row</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">(),</span><span class="pln">row</span><span class="pun">[</span><span class="pln">k</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">!=</span><span class="pln"> j</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">
				ll r1 </span><span class="pun">=</span><span class="pln"> row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">back</span><span class="pun">();</span><span class="pln"> row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
				ll r2 </span><span class="pun">=</span><span class="pln"> row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">back</span><span class="pun">();</span><span class="pln"> row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
				ll c1 </span><span class="pun">=</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">back</span><span class="pun">();</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
				ll c2 </span><span class="pun">=</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">back</span><span class="pun">();</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
				ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">
				a</span><span class="pun">[</span><span class="pln">r1</span><span class="pun">][</span><span class="pln">c1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
				a</span><span class="pun">[</span><span class="pln">r2</span><span class="pun">][</span><span class="pln">c1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">^</span><span class="pln"> j</span><span class="pun">);</span><span class="pln">
				a</span><span class="pun">[</span><span class="pln">r2</span><span class="pun">][</span><span class="pln">c2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">())</span><span class="pln"> ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> i</span><span class="pun">,</span><span class="pln">row</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">())</span><span class="pln"> ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">back</span><span class="pun">()]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> i</span><span class="pun">,</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">puts</span><span class="pun">(</span><span class="str">""</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> printf</span><span class="pun">(</span><span class="str">"%lld"</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2081/problem/D" title="Codeforces Round 1010 (Div. 1, Unrated)">2081D - MST in Modulo Graph</a> <br> Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/newbiewzs" title="International Master newbiewzs">newbiewzs</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>There are only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">O</span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">n</span><span class="MJXp-mi" id="MJXp-Span-1105">log</span><span class="MJXp-mo" id="MJXp-Span-1106" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">n</span><span class="MJXp-mo" id="MJXp-Span-1108" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-154">O(n\log n)</script> edges that are truly useful in the whole graph.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>First, for vertices with the same weight, they can naturally be treated as a single vertex. </p><p>We observe that in the interval of weights <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1109"><span class="MJXp-mo" id="MJXp-Span-1110" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">x</span><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1114" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">k</span><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1117">1</span><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">x</span><span class="MJXp-mo" id="MJXp-Span-1120" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1121">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">k</span><span class="MJXp-mo" id="MJXp-Span-1124" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1125">1</span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-155">(kx,(k+1)x)\ (k\ge 1)</script>, only the smallest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">y</span></span></span><script type="math/tex" id="MathJax-Element-156">y</script> is useful. It is because, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">x</span><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">y</span><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">z</span><span class="MJXp-mo" id="MJXp-Span-1135" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1136">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">x</span></span></span><script type="math/tex" id="MathJax-Element-157">x<y<z<2x</script>, connecting edges <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1138"><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">x</span><span class="MJXp-mo" id="MJXp-Span-1141" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">y</span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-158">(x,y)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1144"><span class="MJXp-mo" id="MJXp-Span-1145" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">y</span><span class="MJXp-mo" id="MJXp-Span-1147" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">z</span><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-159">(y,z)</script> will always be better than connecting <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1150"><span class="MJXp-mo" id="MJXp-Span-1151" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">x</span><span class="MJXp-mo" id="MJXp-Span-1153" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">y</span><span class="MJXp-mo" id="MJXp-Span-1155" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-160">(x,y)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1156"><span class="MJXp-mo" id="MJXp-Span-1157" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">x</span><span class="MJXp-mo" id="MJXp-Span-1159" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">z</span><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-161">(x,z)</script>. </p><p>Therefore, for a vertex with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">x</span></span></span><script type="math/tex" id="MathJax-Element-162">x</script>, we enumerate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">k</span><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">x</span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1169">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">x</span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-1175" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">x</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1178" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-1179" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">x</span></span></span><script type="math/tex" id="MathJax-Element-163">k = x , 2 x , \ldots , \lfloor \frac{n}{x}\rfloor\cdot x</script>. For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">k</span></span></span><script type="math/tex" id="MathJax-Element-164">k</script>, we connect <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">x</span></span></span><script type="math/tex" id="MathJax-Element-165">x</script> to the smallest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">y</span></span></span><script type="math/tex" id="MathJax-Element-166">y</script> that is greater than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">k</span></span></span><script type="math/tex" id="MathJax-Element-167">k</script>. </p><p>It can be proven that this approach guarantees a connected graph (since connecting only the first edge larger than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">x</span></span></span><script type="math/tex" id="MathJax-Element-168">x</script> already forms a connected structure). </p><p>This method generates <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">O</span><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">n</span><span class="MJXp-mi" id="MJXp-Span-1195">log</span><span class="MJXp-mo" id="MJXp-Span-1196" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">n</span><span class="MJXp-mo" id="MJXp-Span-1198" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-169">O(n\log n)</script> edges (due to the harmonic series property). Directly applying Kruskal's algorithm would result in a time complexity of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">O</span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">n</span><span class="MJXp-msubsup" id="MJXp-Span-1203"><span class="MJXp-mi" id="MJXp-Span-1204" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1205" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1206" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">n</span><span class="MJXp-mo" id="MJXp-Span-1208" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-170">O(n\log^2 n)</script>. With radix sort, this can be optimized to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">O</span><span class="MJXp-mo" id="MJXp-Span-1211" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">n</span><span class="MJXp-mi" id="MJXp-Span-1213">log</span><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">n</span><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-171">O(n\log n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;string.h&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;ctime&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;bitset&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;math.h&gt;</span><span class="pln">
</span><span class="com">//#include&lt;unordered_map&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">fi</span><span class="pln"> first
</span><span class="com">#define</span><span class="pln"> se second
</span><span class="com">#define</span><span class="pln"> mp make_pair
</span><span class="com">#define</span><span class="pln"> pii pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pb push_back
</span><span class="com">#define</span><span class="pln"> pil pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pll pair</span><span class="pun">&lt;</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">,</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> vi vector</span><span class="str">&lt;int&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> vl vector</span><span class="pun">&lt;</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> ci ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">)</span><span class="pln">
</span><span class="com">//#define int long long</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ull</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> read</span><span class="pun">(){</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> c</span><span class="pun">=</span><span class="pln">getchar</span><span class="pun">();</span><span class="pln">
	ll x</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">s</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">c</span><span class="pun">&lt;</span><span class="str">'0'</span><span class="pun">||</span><span class="pln">c</span><span class="pun">&gt;</span><span class="str">'9'</span><span class="pun">){</span><span class="pln">
	   </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">c</span><span class="pun">==</span><span class="str">'-'</span><span class="pun">)</span><span class="pln">x</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">c</span><span class="pun">=</span><span class="pln">getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">c</span><span class="pun">&gt;=</span><span class="str">'0'</span><span class="pun">&amp;&amp;</span><span class="pln">c</span><span class="pun">&lt;=</span><span class="str">'9'</span><span class="pun">){</span><span class="pln">
	   s</span><span class="pun">=</span><span class="pln">s</span><span class="pun">*</span><span class="lit">10</span><span class="pun">+</span><span class="pln">c</span><span class="pun">-</span><span class="str">'0'</span><span class="pun">;</span><span class="pln">c</span><span class="pun">=</span><span class="pln">getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s</span><span class="pun">*</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N</span><span class="pun">=</span><span class="lit">5e5</span><span class="pun">+</span><span class="lit">55</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> MAXN</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">tot</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">,</span><span class="pln">maxx</span><span class="pun">,</span><span class="pln">f</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">p</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">bj</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">pre</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">suf</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">struct</span><span class="pln"> node</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">from</span><span class="pun">,</span><span class="pln">to</span><span class="pun">,</span><span class="pln">dis</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">*</span><span class="lit">20</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> cmp</span><span class="pun">(</span><span class="pln">node x</span><span class="pun">,</span><span class="pln">node y</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">.</span><span class="pln">dis</span><span class="pun">&lt;</span><span class="pln">y</span><span class="pun">.</span><span class="pln">dis</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> find</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]!=</span><span class="pln">x</span><span class="pun">)</span><span class="kwd">return</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]=</span><span class="pln">find</span><span class="pun">(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]);</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> merge</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
	x</span><span class="pun">=</span><span class="pln">find</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln">y</span><span class="pun">=</span><span class="pln">find</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]&lt;</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">y</span><span class="pun">])</span><span class="pln">swap</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
	siz</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]+=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">y</span><span class="pun">];</span><span class="pln">
	f</span><span class="pun">[</span><span class="pln">y</span><span class="pun">]=</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	T</span><span class="pun">=</span><span class="pln">read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		tot</span><span class="pun">=</span><span class="pln">ans</span><span class="pun">=</span><span class="pln">maxx</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">MAXN</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			f</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">bj</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">MAXN</span><span class="pun">*</span><span class="lit">19</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
		a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">from</span><span class="pun">=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">to</span><span class="pun">=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">dis</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		
		
		
		n</span><span class="pun">=</span><span class="pln">read</span><span class="pun">();</span><span class="pln">
		MAXN</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">read</span><span class="pun">(),</span><span class="pln">bj</span><span class="pun">[</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">maxx</span><span class="pun">=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">maxx</span><span class="pun">,</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]),</span><span class="pln">MAXN</span><span class="pun">=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">MAXN</span><span class="pun">,</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		sort</span><span class="pun">(</span><span class="pln">p</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">p</span><span class="pun">+</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">maxx</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bj</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln"> pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">maxx</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">--){</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bj</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln"> suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]=</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]){</span><span class="pln">
				a</span><span class="pun">[++</span><span class="pln">tot</span><span class="pun">]={</span><span class="pln">i</span><span class="pun">,</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
				</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;=</span><span class="pln">maxx</span><span class="pun">;</span><span class="pln">k</span><span class="pun">++){</span><span class="pln">
				</span><span class="kwd">int</span><span class="pln"> tmy</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bj</span><span class="pun">[</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> k</span><span class="pun">!=</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
					a</span><span class="pun">[++</span><span class="pln">tot</span><span class="pun">]={</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]],</span><span class="pln">i</span><span class="pun">,</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
					</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">suf</span><span class="pun">[</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">]&lt;=(</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)*</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">tmy</span><span class="pun">=</span><span class="pln">suf</span><span class="pun">[</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">tmy</span><span class="pun">)</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">int</span><span class="pln"> cost</span><span class="pun">=</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-</span><span class="pln">tmy</span><span class="pun">);</span><span class="pln">
				a</span><span class="pun">[++</span><span class="pln">tot</span><span class="pun">]={</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">tmy</span><span class="pun">],</span><span class="pln">i</span><span class="pun">,</span><span class="pln">cost</span><span class="pun">};</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		sort</span><span class="pun">(</span><span class="pln">a</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">a</span><span class="pun">+</span><span class="pln">tot</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">cmp</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">,</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">tot</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">find</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">from</span><span class="pun">)!=</span><span class="pln">find</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">to</span><span class="pun">)){</span><span class="pln">
				merge</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">from</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">to</span><span class="pun">);</span><span class="pln">
				ans</span><span class="pun">+=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">dis</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2081/problem/E" title="Codeforces Round 1010 (Div. 1, Unrated)">2081E - Quantifier</a> <br> Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/chen_03" title="Master chen_03">chen_03</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Move each chip as deep as possible in descending order of labels. Can we simplify the operations after that?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Now we only need to move the chips upward and swap adjacent chips with the same color. What can we do after that?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>We can perform dynamic programming (DP) to calculate the numbers. What information do we need to record?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>We need to record the color and the length of the top monochromatic segment. How can we perform the DP in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1217"><span class="MJXp-mrow" id="MJXp-Span-1218"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1219">O</span></span><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1223" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1224" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-172">\mathcal{O}(m^2)</script> time complexity?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>First, in descending order of labels, move each chip to the deepest possible position successively. It can be shown that this allows each chip to reach the theoretically deepest position it can attain. Consequently, every final state can be obtained from this configuration by performing only upward moves of chips and swaps of adjacent chips with the same color.</p><p>Next comes the process of moving chips upward while performing dynamic programming (DP). Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1225"><span class="MJXp-msubsup" id="MJXp-Span-1226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1228" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-173">e_u</script> denote the edge from node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">u</span></span></span><script type="math/tex" id="MathJax-Element-174">u</script> to its parent. Assume we have decided the order of all the chips in subtree <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">u</span></span></span><script type="math/tex" id="MathJax-Element-175">u</script> (except the ones on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1233"><span class="MJXp-msubsup" id="MJXp-Span-1234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1236" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-176">e_u</script>), and we need to merge them with the original chips on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1237"><span class="MJXp-msubsup" id="MJXp-Span-1238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1240" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-177">e_u</script>. If the bottom chip on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1241"><span class="MJXp-msubsup" id="MJXp-Span-1242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1244" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-178">e_u</script> shares color with the subtree's top chip, we need to know the length of the subtree's topmost maximal monochromatic contiguous segment to calculate the number of ways to merge the two parts, i.e., if the length of the bottommost segment on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1245"><span class="MJXp-msubsup" id="MJXp-Span-1246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1248" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-179">e_u</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">x</span></span></span><script type="math/tex" id="MathJax-Element-180">x</script> and the length of the topmost segment of the subtree is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">y</span></span></span><script type="math/tex" id="MathJax-Element-181">y</script>, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1253"><span class="MJXp-mstyle" id="MJXp-Span-1254"><span class="MJXp-mrow" id="MJXp-Span-1255"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1256"><span class="MJXp-mstyle" id="MJXp-Span-1257"><span class="MJXp-mrow" id="MJXp-Span-1258"><span class="MJXp-mo" id="MJXp-Span-1259" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1260"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">x</span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">y</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">x</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1265"><span class="MJXp-mstyle" id="MJXp-Span-1266"><span class="MJXp-mrow" id="MJXp-Span-1267"><span class="MJXp-mo" id="MJXp-Span-1268" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-182">\dbinom{x+y}{x}</script> ways to combine them. So we need to record the color and the length of the top segment.</p><p><img alt=" " src="https://codeforces.com/predownloaded/33/7d/337d8e1dce892c9751c9f28d7dd59bce2c223749.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1269"><span class="MJXp-msubsup" id="MJXp-Span-1270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1272" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">u</span><span class="MJXp-mo" id="MJXp-Span-1274">,</span><span class="MJXp-mn" id="MJXp-Span-1275">0</span><span class="MJXp-mrow" id="MJXp-Span-1276"><span class="MJXp-mo" id="MJXp-Span-1277">/</span></span><span class="MJXp-mn" id="MJXp-Span-1278">1</span><span class="MJXp-mo" id="MJXp-Span-1279">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-183">f_{u,0/1,i}</script> denote the number of permutation schemes on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1281"><span class="MJXp-msubsup" id="MJXp-Span-1282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1284" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-184">e_u</script> after moving all the chips in subtree <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">u</span></span></span><script type="math/tex" id="MathJax-Element-185">u</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1287"><span class="MJXp-msubsup" id="MJXp-Span-1288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1290" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-186">e_u</script>, where:</p> <ul>   <li>The topmost chip on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1291"><span class="MJXp-msubsup" id="MJXp-Span-1292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1294" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-187">e_u</script> is black/white (0/1).</li>   <li>The length of the topmost maximal monochromatic contiguous segment on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1295"><span class="MJXp-msubsup" id="MJXp-Span-1296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1298" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-188">e_u</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">i</span></span></span><script type="math/tex" id="MathJax-Element-189">i</script>.</li> </ul><p>When calculating <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1301"><span class="MJXp-msubsup" id="MJXp-Span-1302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1304" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">u</span><span class="MJXp-mo" id="MJXp-Span-1306">,</span><span class="MJXp-mn" id="MJXp-Span-1307">0</span><span class="MJXp-mrow" id="MJXp-Span-1308"><span class="MJXp-mo" id="MJXp-Span-1309">/</span></span><span class="MJXp-mn" id="MJXp-Span-1310">1</span><span class="MJXp-mo" id="MJXp-Span-1311">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-190">f_{u,0/1,i}</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">i</span></span></span><script type="math/tex" id="MathJax-Element-191">i</script>, we first merge the DP states of all the subtrees of node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">u</span></span></span><script type="math/tex" id="MathJax-Element-192">u</script>, and then merge the original chips on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1317"><span class="MJXp-msubsup" id="MJXp-Span-1318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1320" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-193">e_u</script> into the resulting DP states.</p><p><strong>Subtree merging</strong>: Assume we merge two subtrees <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">v</span></span></span><script type="math/tex" id="MathJax-Element-194">v</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">w</span></span></span><script type="math/tex" id="MathJax-Element-195">w</script>. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">S</span></span></span><script type="math/tex" id="MathJax-Element-196">S</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">T</span></span></span><script type="math/tex" id="MathJax-Element-197">T</script> denote the number of chips on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1329"><span class="MJXp-msubsup" id="MJXp-Span-1330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1332" style="vertical-align: -0.4em;">v</span></span></span></span><script type="math/tex" id="MathJax-Element-198">e_v</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1333"><span class="MJXp-msubsup" id="MJXp-Span-1334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1336" style="vertical-align: -0.4em;">w</span></span></span></span><script type="math/tex" id="MathJax-Element-199">e_w</script> respectively, and let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1337"><span class="MJXp-msubsup" id="MJXp-Span-1338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1340" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1341">0</span><span class="MJXp-mrow" id="MJXp-Span-1342"><span class="MJXp-mo" id="MJXp-Span-1343">/</span></span><span class="MJXp-mn" id="MJXp-Span-1344">1</span><span class="MJXp-mo" id="MJXp-Span-1345">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-200">g_{0/1,i}</script> be a temporary DP array initialized to all zeros.</p><p>Let's consider two cases.</p><h4><strong>Case 1: Different colors at tops of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1347"><span class="MJXp-msubsup" id="MJXp-Span-1348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1350" style="vertical-align: -0.4em;">v</span></span></span></span><script type="math/tex" id="MathJax-Element-201">e_v</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1351"><span class="MJXp-msubsup" id="MJXp-Span-1352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1354" style="vertical-align: -0.4em;">w</span></span></span></span><script type="math/tex" id="MathJax-Element-202">e_w</script></strong></h4><p>Suppose the top chip comes from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1355"><span class="MJXp-msubsup" id="MJXp-Span-1356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1358" style="vertical-align: -0.4em;">v</span></span></span></span><script type="math/tex" id="MathJax-Element-203">e_v</script> after merging. Then the maximal monochromatic segment length from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1359"><span class="MJXp-msubsup" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1362" style="vertical-align: -0.4em;">w</span></span></span></span><script type="math/tex" id="MathJax-Element-204">e_w</script> becomes irrelevant, and therefore let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1363"><span class="MJXp-msubsup" id="MJXp-Span-1364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1366" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1367" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1368"><span class="MJXp-mo" id="MJXp-Span-1369" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">i</span><span class="MJXp-mo" id="MJXp-Span-1372">=</span><span class="MJXp-mn" id="MJXp-Span-1373">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1377" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">w</span><span class="MJXp-mo" id="MJXp-Span-1379">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">c</span><span class="MJXp-mo" id="MJXp-Span-1381">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-205">h_c=\sum_{i=1}^T f_{w,c,i}</script>. If the top chip of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1383"><span class="MJXp-msubsup" id="MJXp-Span-1384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1386" style="vertical-align: -0.4em;">w</span></span></span></span><script type="math/tex" id="MathJax-Element-206">e_w</script> would split the top segment of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1387"><span class="MJXp-msubsup" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1390" style="vertical-align: -0.4em;">v</span></span></span></span><script type="math/tex" id="MathJax-Element-207">e_v</script>, enumerate split positions. The split position should be strictly inside the top segment of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1391"><span class="MJXp-msubsup" id="MJXp-Span-1392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1394" style="vertical-align: -0.4em;">v</span></span></span></span><script type="math/tex" id="MathJax-Element-208">e_v</script>.</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1395"><span class="MJXp-msubsup" id="MJXp-Span-1396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1398" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">c</span><span class="MJXp-mo" id="MJXp-Span-1400">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1405" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">c</span><span class="MJXp-mo" id="MJXp-Span-1407">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mstyle" id="MJXp-Span-1410"><span class="MJXp-mrow" id="MJXp-Span-1411"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1412"><span class="MJXp-mstyle" id="MJXp-Span-1413"><span class="MJXp-mrow" id="MJXp-Span-1414"><span class="MJXp-mo" id="MJXp-Span-1415" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1416"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">S</span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">i</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">T</span><span class="MJXp-mo" id="MJXp-Span-1422" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1423">1</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">T</span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1426">1</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1427"><span class="MJXp-mstyle" id="MJXp-Span-1428"><span class="MJXp-mrow" id="MJXp-Span-1429"><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1433" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1434">1</span><span class="MJXp-mo" id="MJXp-Span-1435">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">c</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1437"><span class="MJXp-mo" id="MJXp-Span-1438" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">S</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">k</span><span class="MJXp-mo" id="MJXp-Span-1441">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">i</span><span class="MJXp-mo" id="MJXp-Span-1443">+</span><span class="MJXp-mn" id="MJXp-Span-1444">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1448" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">v</span><span class="MJXp-mo" id="MJXp-Span-1450">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">c</span><span class="MJXp-mo" id="MJXp-Span-1452">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">k</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1454">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1456">1</span><span class="MJXp-mo" id="MJXp-Span-1457" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">i</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">S</span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-209">g_{c,i}\leftarrow g_{c,i} + \dbinom{S-i+T-1}{T-1} h_{1-c} \sum_{k=i+1}^S f_{v,c,k}\ (1\le i\le S)</script></center><p>Otherwise, the position of the top chip of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1462"><span class="MJXp-msubsup" id="MJXp-Span-1463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1465" style="vertical-align: -0.4em;">w</span></span></span></span><script type="math/tex" id="MathJax-Element-210">e_w</script> becomes irrelevant.</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1466"><span class="MJXp-msubsup" id="MJXp-Span-1467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1469" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">c</span><span class="MJXp-mo" id="MJXp-Span-1471">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1473" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1476" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">c</span><span class="MJXp-mo" id="MJXp-Span-1478">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1480" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mstyle" id="MJXp-Span-1481"><span class="MJXp-mrow" id="MJXp-Span-1482"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1483"><span class="MJXp-mstyle" id="MJXp-Span-1484"><span class="MJXp-mrow" id="MJXp-Span-1485"><span class="MJXp-mo" id="MJXp-Span-1486" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1487"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">S</span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">i</span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">T</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">T</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1494"><span class="MJXp-mstyle" id="MJXp-Span-1495"><span class="MJXp-mrow" id="MJXp-Span-1496"><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1500" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1501">1</span><span class="MJXp-mo" id="MJXp-Span-1502">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">c</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1506" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">v</span><span class="MJXp-mo" id="MJXp-Span-1508">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">c</span><span class="MJXp-mo" id="MJXp-Span-1510">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-211">g_{c,i}\leftarrow g_{c,i} + \dbinom{S-i+T}{T} h_{1-c} f_{v,c,i}</script></center><p><img alt=" " src="https://codeforces.com/predownloaded/40/16/4016d5ba299b87d5130ca1161f6b2a7ddb68e991.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>With suffix sum optimization, this achieves <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1512"><span class="MJXp-mrow" id="MJXp-Span-1513"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1514">O</span></span><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1518" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-212">\mathcal{O}(m^2)</script> time complexity.</p><h4><strong>Case 2: Same color at tops</strong></h4><p>If there are only chips of this color on both edges:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1520"><span class="MJXp-msubsup" id="MJXp-Span-1521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1523" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">c</span><span class="MJXp-mo" id="MJXp-Span-1525">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">S</span><span class="MJXp-mo" id="MJXp-Span-1527">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1532" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">c</span><span class="MJXp-mo" id="MJXp-Span-1534">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">S</span><span class="MJXp-mo" id="MJXp-Span-1536">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mstyle" id="MJXp-Span-1539"><span class="MJXp-mrow" id="MJXp-Span-1540"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1541"><span class="MJXp-mstyle" id="MJXp-Span-1542"><span class="MJXp-mrow" id="MJXp-Span-1543"><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1545"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">S</span><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">T</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">T</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1550"><span class="MJXp-mstyle" id="MJXp-Span-1551"><span class="MJXp-mrow" id="MJXp-Span-1552"><span class="MJXp-mo" id="MJXp-Span-1553" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1556" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">v</span><span class="MJXp-mo" id="MJXp-Span-1558">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">c</span><span class="MJXp-mo" id="MJXp-Span-1560">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">S</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1564" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">w</span><span class="MJXp-mo" id="MJXp-Span-1566">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">c</span><span class="MJXp-mo" id="MJXp-Span-1568">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">T</span></span></span></span></span><script type="math/tex" id="MathJax-Element-213">g_{c,S+T}\leftarrow g_{c,S+T} + \dbinom{S+T}{T} f_{v,c,S} f_{w,c,T}</script></center><p>Otherwise, assume the topmost different-colored chip is from subtree <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1570"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">w</span></span></span><script type="math/tex" id="MathJax-Element-214">w</script> after merging. Enumerate insertion positions where this chip splits the top segment of the other (not necessarily strictly inside the segment).</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1572"><span class="MJXp-msubsup" id="MJXp-Span-1573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1575" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">c</span><span class="MJXp-mo" id="MJXp-Span-1577">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">i</span><span class="MJXp-mo" id="MJXp-Span-1579">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1584" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">c</span><span class="MJXp-mo" id="MJXp-Span-1586">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">i</span><span class="MJXp-mo" id="MJXp-Span-1588">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mstyle" id="MJXp-Span-1591"><span class="MJXp-mrow" id="MJXp-Span-1592"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1593"><span class="MJXp-mstyle" id="MJXp-Span-1594"><span class="MJXp-mrow" id="MJXp-Span-1595"><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1597"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">i</span><span class="MJXp-mo" id="MJXp-Span-1599" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">j</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">j</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1602"><span class="MJXp-mstyle" id="MJXp-Span-1603"><span class="MJXp-mrow" id="MJXp-Span-1604"><span class="MJXp-mo" id="MJXp-Span-1605" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1606"><span class="MJXp-mrow" id="MJXp-Span-1607"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1608"><span class="MJXp-mstyle" id="MJXp-Span-1609"><span class="MJXp-mrow" id="MJXp-Span-1610"><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1612"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">S</span><span class="MJXp-mo" id="MJXp-Span-1614" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">i</span><span class="MJXp-mo" id="MJXp-Span-1616" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">T</span><span class="MJXp-mo" id="MJXp-Span-1618" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619">j</span><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1621">1</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">T</span><span class="MJXp-mo" id="MJXp-Span-1623" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">j</span><span class="MJXp-mo" id="MJXp-Span-1625" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1626">1</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1627"><span class="MJXp-mstyle" id="MJXp-Span-1628"><span class="MJXp-mrow" id="MJXp-Span-1629"><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1633" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">w</span><span class="MJXp-mo" id="MJXp-Span-1635">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">c</span><span class="MJXp-mo" id="MJXp-Span-1637">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1639"><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">S</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">k</span><span class="MJXp-mo" id="MJXp-Span-1643">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">i</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1648" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">v</span><span class="MJXp-mo" id="MJXp-Span-1650">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">c</span><span class="MJXp-mo" id="MJXp-Span-1652">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">k</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1654">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1656">0</span><span class="MJXp-mo" id="MJXp-Span-1657" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">i</span><span class="MJXp-mo" id="MJXp-Span-1659" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">S</span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1662">&nbsp;</span><span class="MJXp-mn" id="MJXp-Span-1663">1</span><span class="MJXp-mo" id="MJXp-Span-1664" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">j</span><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">T</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-215">g_{c,i+j}\leftarrow g_{c,i+j} + \dbinom{i+j}{j} \dbinom{S-i+T-j-1}{T-j-1} f_{w,c,j} \sum_{k=i}^S f_{v,c,k}\ (0\le i\le S,\ 1\le j < T)</script></center><p>(Similar transition equation for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670">v</span></span></span><script type="math/tex" id="MathJax-Element-216">v</script>.)</p><p><img alt=" " src="https://codeforces.com/predownloaded/ba/a7/baa7bacb9c7ebae9c301f8579636327ff2e61990.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>With suffix sum optimization, this forms a tree knapsack DP with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1671"><span class="MJXp-mrow" id="MJXp-Span-1672"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1673">O</span></span><span class="MJXp-mo" id="MJXp-Span-1674" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1677" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-217">\mathcal{O}(m^2)</script> time complexity.</p> <hr><p>After computing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1679"><span class="MJXp-msubsup" id="MJXp-Span-1680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1682" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1683">0</span><span class="MJXp-mrow" id="MJXp-Span-1684"><span class="MJXp-mo" id="MJXp-Span-1685">/</span></span><span class="MJXp-mn" id="MJXp-Span-1686">1</span><span class="MJXp-mo" id="MJXp-Span-1687">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-218">g_{0/1,i}</script>, we can treat <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">g</span></span></span><script type="math/tex" id="MathJax-Element-219">g</script> as the DP states of a subtree, and continue to perform the process above.</p><p><strong>Merging original chips on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1691"><span class="MJXp-msubsup" id="MJXp-Span-1692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1694" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-220">e_u</script> into the results</strong>: We first account for internal permutations of original monochromatic segments. After that, if the bottom chip on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1695"><span class="MJXp-msubsup" id="MJXp-Span-1696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1698" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-221">e_u</script> shares color with merged subtrees' top chip (with segment lengths <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">x</span></span></span><script type="math/tex" id="MathJax-Element-222">x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">y</span></span></span><script type="math/tex" id="MathJax-Element-223">y</script>), multiply the DP state by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1703"><span class="MJXp-mstyle" id="MJXp-Span-1704"><span class="MJXp-mrow" id="MJXp-Span-1705"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1706"><span class="MJXp-mstyle" id="MJXp-Span-1707"><span class="MJXp-mrow" id="MJXp-Span-1708"><span class="MJXp-mo" id="MJXp-Span-1709" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1710"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">x</span><span class="MJXp-mo" id="MJXp-Span-1712" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713">y</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">x</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1715"><span class="MJXp-mstyle" id="MJXp-Span-1716"><span class="MJXp-mrow" id="MJXp-Span-1717"><span class="MJXp-mo" id="MJXp-Span-1718" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-224">\dbinom{x+y}{x}</script>.</p><p>Assuming <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">n</span></span></span><script type="math/tex" id="MathJax-Element-225">n</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1721"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1722">m</span></span></span><script type="math/tex" id="MathJax-Element-226">m</script> are of the same order, the overall time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1723"><span class="MJXp-mrow" id="MJXp-Span-1724"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1725">O</span></span><span class="MJXp-mo" id="MJXp-Span-1726" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1729" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1730" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-227">\mathcal{O}(m^2)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> eb emplace_back
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">=</span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">fa</span><span class="pun">[</span><span class="lit">5005</span><span class="pun">],</span><span class="pln">col</span><span class="pun">[</span><span class="lit">5005</span><span class="pun">],</span><span class="pln">d</span><span class="pun">[</span><span class="lit">5005</span><span class="pun">],</span><span class="pln">stk</span><span class="pun">[</span><span class="lit">5005</span><span class="pun">],</span><span class="pln">top</span><span class="pun">,</span><span class="pln">ct</span><span class="pun">[</span><span class="lit">5005</span><span class="pun">][</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> C</span><span class="pun">[</span><span class="lit">5005</span><span class="pun">][</span><span class="lit">5005</span><span class="pun">],</span><span class="pln">fac</span><span class="pun">[</span><span class="lit">5005</span><span class="pun">],</span><span class="pln">siz</span><span class="pun">[</span><span class="lit">5005</span><span class="pun">],</span><span class="pln">f</span><span class="pun">[</span><span class="lit">5005</span><span class="pun">][</span><span class="lit">2</span><span class="pun">][</span><span class="lit">5005</span><span class="pun">],</span><span class="pln">g</span><span class="pun">[</span><span class="lit">2</span><span class="pun">][</span><span class="lit">5005</span><span class="pun">],</span><span class="pln">ans</span><span class="pun">;</span><span class="pln">
vector</span><span class="str">&lt;int&gt;</span><span class="pln"> to</span><span class="pun">[</span><span class="lit">5005</span><span class="pun">],</span><span class="pln">vec</span><span class="pun">[</span><span class="lit">5005</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> diff</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> S</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln">T</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">A</span><span class="pun">,</span><span class="pln">B</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&lt;</span><span class="lit">2</span><span class="pun">;++</span><span class="pln">x</span><span class="pun">){</span><span class="pln">
		A</span><span class="pun">=</span><span class="pln">B</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">T</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="pln">B</span><span class="pun">=(</span><span class="pln">B</span><span class="pun">+</span><span class="pln">f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="pln">x</span><span class="pun">^</span><span class="lit">1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">])%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">S</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
			g</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">g</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]+((</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">A</span><span class="pun">*</span><span class="pln">C</span><span class="pun">[</span><span class="pln">S</span><span class="pun">+</span><span class="pln">T</span><span class="pun">-</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">T</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]+(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">x</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]*</span><span class="pln">C</span><span class="pun">[</span><span class="pln">S</span><span class="pun">+</span><span class="pln">T</span><span class="pun">-</span><span class="pln">i</span><span class="pun">][</span><span class="pln">T</span><span class="pun">])%</span><span class="pln">p</span><span class="pun">*</span><span class="pln">B</span><span class="pun">)%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
			A</span><span class="pun">=(</span><span class="pln">A</span><span class="pun">+</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">x</span><span class="pun">][</span><span class="pln">i</span><span class="pun">])%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> same1</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> S</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln">T</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">A</span><span class="pun">,</span><span class="pln">B</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&lt;</span><span class="lit">2</span><span class="pun">;++</span><span class="pln">x</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">S</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">A</span><span class="pun">=</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">x</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]))</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
			B</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">T</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;--</span><span class="pln">j</span><span class="pun">){</span><span class="pln">
				B</span><span class="pun">=(</span><span class="pln">B</span><span class="pun">+</span><span class="pln">f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="pln">x</span><span class="pun">][</span><span class="pln">j</span><span class="pun">])%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
				g</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">]=(</span><span class="pln">g</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">]+(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">A</span><span class="pun">*</span><span class="pln">B</span><span class="pun">%</span><span class="pln">p</span><span class="pun">*</span><span class="pln">C</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]%</span><span class="pln">p</span><span class="pun">*</span><span class="pln">C</span><span class="pun">[</span><span class="pln">S</span><span class="pun">-</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">+</span><span class="pln">T</span><span class="pun">-</span><span class="pln">j</span><span class="pun">][</span><span class="pln">T</span><span class="pun">-</span><span class="pln">j</span><span class="pun">])%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> same</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">){</span><span class="pln">
	same1</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">),</span><span class="pln">same1</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> S</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln">T</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&lt;</span><span class="lit">2</span><span class="pun">;++</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
		g</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">S</span><span class="pun">+</span><span class="pln">T</span><span class="pun">]=(</span><span class="pln">g</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">S</span><span class="pun">+</span><span class="pln">T</span><span class="pun">]+(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">x</span><span class="pun">][</span><span class="pln">S</span><span class="pun">]*</span><span class="pln">f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="pln">x</span><span class="pun">][</span><span class="pln">T</span><span class="pun">]%</span><span class="pln">p</span><span class="pun">*</span><span class="pln">C</span><span class="pun">[</span><span class="pln">S</span><span class="pun">+</span><span class="pln">T</span><span class="pun">][</span><span class="pln">T</span><span class="pun">])%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> merge</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">g</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">g</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	diff</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">),</span><span class="pln">diff</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln">u</span><span class="pun">),</span><span class="pln">same</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
	siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
		f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">g</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">i</span><span class="pun">],</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">g</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">){</span><span class="pln">
	siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> v</span><span class="pun">:</span><span class="pln">to</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]){</span><span class="pln">
		dfs</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">merge</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
				f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">i</span><span class="pun">],</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
			siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="pln">empty</span><span class="pun">())</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> prd</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">L</span><span class="pun">=</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="pln">size</span><span class="pun">(),</span><span class="pln">c</span><span class="pun">=</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">],</span><span class="pln">fir</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">lst</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">res</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">L</span><span class="pun">;</span><span class="pln">i</span><span class="pun">=</span><span class="pln">j</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">L </span><span class="pun">&amp;&amp;</span><span class="pln"> vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]==</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">j</span><span class="pun">])++</span><span class="pln">j</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln">fir</span><span class="pun">=</span><span class="pln">j</span><span class="pun">-</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">==</span><span class="pln">L</span><span class="pun">)</span><span class="pln">lst</span><span class="pun">=</span><span class="pln">j</span><span class="pun">-</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
		prd</span><span class="pun">=(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">prd</span><span class="pun">*</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">j</span><span class="pun">-</span><span class="pln">i</span><span class="pun">]%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+</span><span class="pln">L</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">L</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]][</span><span class="pln">lst</span><span class="pun">]=</span><span class="pln">prd</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">fir</span><span class="pun">==</span><span class="pln">L</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
			f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">c</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="pln">L</span><span class="pun">]=(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">c</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]*</span><span class="pln">C</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="pln">L</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]%</span><span class="pln">p</span><span class="pun">*</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">L</span><span class="pun">]%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
			res</span><span class="pun">=(</span><span class="pln">res</span><span class="pun">+</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">c</span><span class="pun">^</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">])%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
			f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">c</span><span class="pun">^</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">L</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">c</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">c</span><span class="pun">][</span><span class="pln">L</span><span class="pun">]=(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">res</span><span class="pun">*</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">L</span><span class="pun">]%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
			res</span><span class="pun">=(</span><span class="pln">res</span><span class="pun">+(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">c</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]*</span><span class="pln">C</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="pln">fir</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]+</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">c</span><span class="pun">^</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">])%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
			f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">L</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]][</span><span class="pln">lst</span><span class="pun">]=(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">res</span><span class="pun">*</span><span class="pln">prd</span><span class="pun">%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+=</span><span class="pln">L</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--){</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d%d"</span><span class="pun">,&amp;</span><span class="pln">n</span><span class="pun">,&amp;</span><span class="pln">m</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
			to</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">(),</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
			ct</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=</span><span class="pln">ct</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
			scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln">fa</span><span class="pun">+</span><span class="pln">i</span><span class="pun">),</span><span class="pln">to</span><span class="pun">[</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">eb</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln">col</span><span class="pun">+</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln">d</span><span class="pun">+</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">m</span><span class="pun">,</span><span class="pln">u</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
			top</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">u</span><span class="pun">=</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">u</span><span class="pun">)</span><span class="pln">stk</span><span class="pun">[++</span><span class="pln">top</span><span class="pun">]=</span><span class="pln">u</span><span class="pun">,</span><span class="pln">u</span><span class="pun">=</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">top</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;--</span><span class="pln">j</span><span class="pun">){</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">!</span><span class="pln">ct</span><span class="pun">[</span><span class="pln">stk</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]][</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]^</span><span class="lit">1</span><span class="pun">])</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
				vec</span><span class="pun">[</span><span class="pln">stk</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]].</span><span class="pln">eb</span><span class="pun">(</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]),++</span><span class="pln">ct</span><span class="pun">[</span><span class="pln">stk</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]][</span><span class="pln">col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
				</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		C</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=</span><span class="pln">fac</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">i</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="pln">
				C</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]=(</span><span class="pln">C</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">C</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">])%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
			C</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">i</span><span class="pun">%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		dfs</span><span class="pun">(</span><span class="lit">1</span><span class="pun">),</span><span class="pln">ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
			ans</span><span class="pun">=((</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">+</span><span class="pln">f</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]+</span><span class="pln">f</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">])%</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2081/problem/F" title="Codeforces Round 1010 (Div. 1, Unrated)">2081F - Hot Matrix</a> <br> Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/18Michael" title="Grandmaster 18Michael">18Michael</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>First, it is not difficult to observe that when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1731"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">n</span></span></span><script type="math/tex" id="MathJax-Element-228"> n </script> is odd, a solution exists if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734">n</span><span class="MJXp-mo" id="MJXp-Span-1735" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1736">1</span></span></span><script type="math/tex" id="MathJax-Element-229"> n = 1 </script>.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">n</span></span></span><script type="math/tex" id="MathJax-Element-230"> n </script> is even, a solution always exists.</p><p>Consider the following construction:</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">n</span><span class="MJXp-mo" id="MJXp-Span-1741" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1742">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">m</span></span></span><script type="math/tex" id="MathJax-Element-231"> n = 2m </script>. Use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1744"><span class="MJXp-mo" id="MJXp-Span-1745" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">x</span><span class="MJXp-mo" id="MJXp-Span-1747" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">y</span><span class="MJXp-mo" id="MJXp-Span-1749" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-232">(x, y)</script> to denote the cell in the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">x</span></span></span><script type="math/tex" id="MathJax-Element-233"> x </script>-th row and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753">y</span></span></span><script type="math/tex" id="MathJax-Element-234"> y </script>-th column of the matrix, and assume the top-left corner of the matrix is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1754"><span class="MJXp-mo" id="MJXp-Span-1755" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1756">1</span><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1758">1</span><span class="MJXp-mo" id="MJXp-Span-1759" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-235">(1, 1)</script>, while the bottom-right corner is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1760"><span class="MJXp-mo" id="MJXp-Span-1761" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762">n</span><span class="MJXp-mo" id="MJXp-Span-1763" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">n</span><span class="MJXp-mo" id="MJXp-Span-1765" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-236">(n, n)</script>.</p><p>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1766"><span class="MJXp-mo" id="MJXp-Span-1767" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">a</span><span class="MJXp-mo" id="MJXp-Span-1769" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">b</span><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-237">(a, b)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1772"><span class="MJXp-mo" id="MJXp-Span-1773" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">c</span><span class="MJXp-mo" id="MJXp-Span-1775" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">d</span><span class="MJXp-mo" id="MJXp-Span-1777" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-238">(c, d)</script>, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1778"><span class="MJXp-msubsup" id="MJXp-Span-1779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1781" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1782" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">c</span><span class="MJXp-mo" id="MJXp-Span-1784" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">a</span></span></span><script type="math/tex" id="MathJax-Element-239"> k_1 = c - a </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1786"><span class="MJXp-msubsup" id="MJXp-Span-1787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1789" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1790" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">d</span><span class="MJXp-mo" id="MJXp-Span-1792" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">b</span></span></span><script type="math/tex" id="MathJax-Element-240"> k_2 = d - b </script>. When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1794"><span class="MJXp-mrow" id="MJXp-Span-1795"><span class="MJXp-mo" id="MJXp-Span-1796" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1799" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1800"><span class="MJXp-mo" id="MJXp-Span-1801" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1802" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1803"><span class="MJXp-mo" id="MJXp-Span-1804" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1807" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1808"><span class="MJXp-mo" id="MJXp-Span-1809" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-241"> |k_1| = |k_2| </script>, denote <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1810"><span class="MJXp-mo" id="MJXp-Span-1811" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">a</span><span class="MJXp-mo" id="MJXp-Span-1813" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814">b</span><span class="MJXp-mo" id="MJXp-Span-1815" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1816" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mo" id="MJXp-Span-1817" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">c</span><span class="MJXp-mo" id="MJXp-Span-1819" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">d</span><span class="MJXp-mo" id="MJXp-Span-1821" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-242">(a, b) \sim (c, d)</script> as:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1822"><span class="MJXp-mo" id="MJXp-Span-1823" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824">a</span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">b</span><span class="MJXp-mo" id="MJXp-Span-1827" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1828" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1829" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1830">a</span><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1832">1</span><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">b</span><span class="MJXp-mo" id="MJXp-Span-1835" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1836">1</span><span class="MJXp-mo" id="MJXp-Span-1837" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1838" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1840" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1841" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">a</span><span class="MJXp-mo" id="MJXp-Span-1843" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1846" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1847" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">b</span><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1852" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1853" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-243">(a, b), (a+1, b+1), \dots, (a+k_1, b+k_2)</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1854"><span class="MJXp-msubsup" id="MJXp-Span-1855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1857" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1858" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1861" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1862" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1863">0</span></span></span><script type="math/tex" id="MathJax-Element-244"> k_1, k_2 \geq 0 </script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1864"><span class="MJXp-mo" id="MJXp-Span-1865" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">a</span><span class="MJXp-mo" id="MJXp-Span-1867" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">b</span><span class="MJXp-mo" id="MJXp-Span-1869" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1870" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1871" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872">a</span><span class="MJXp-mo" id="MJXp-Span-1873" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1874">1</span><span class="MJXp-mo" id="MJXp-Span-1875" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876">b</span><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1878">1</span><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1880" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1881" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1882" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1883" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1884">a</span><span class="MJXp-mo" id="MJXp-Span-1885" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1888" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1889" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890">b</span><span class="MJXp-mo" id="MJXp-Span-1891" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1894" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1895" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-245">(a, b), (a+1, b-1), \dots, (a+k_1, b+k_2)</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1896"><span class="MJXp-msubsup" id="MJXp-Span-1897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1899" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1900" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1901">0</span><span class="MJXp-mo" id="MJXp-Span-1902" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1905" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1906" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1907">0</span></span></span><script type="math/tex" id="MathJax-Element-246"> k_1 \geq 0, k_2 \leq 0 </script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1908"><span class="MJXp-mo" id="MJXp-Span-1909" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910">a</span><span class="MJXp-mo" id="MJXp-Span-1911" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912">b</span><span class="MJXp-mo" id="MJXp-Span-1913" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1914" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1915" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">a</span><span class="MJXp-mo" id="MJXp-Span-1917" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1918">1</span><span class="MJXp-mo" id="MJXp-Span-1919" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1920">b</span><span class="MJXp-mo" id="MJXp-Span-1921" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1922">1</span><span class="MJXp-mo" id="MJXp-Span-1923" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1924" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1925" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1926" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1927" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">a</span><span class="MJXp-mo" id="MJXp-Span-1929" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1932" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1933" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">b</span><span class="MJXp-mo" id="MJXp-Span-1935" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1938" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1939" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-247">(a, b), (a-1, b+1), \dots, (a+k_1, b+k_2)</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1940"><span class="MJXp-msubsup" id="MJXp-Span-1941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1943" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1944" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1945">0</span><span class="MJXp-mo" id="MJXp-Span-1946" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1949" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1950" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1951">0</span></span></span><script type="math/tex" id="MathJax-Element-248"> k_1 \leq 0, k_2 \geq 0 </script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1952"><span class="MJXp-mo" id="MJXp-Span-1953" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954">a</span><span class="MJXp-mo" id="MJXp-Span-1955" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1956">b</span><span class="MJXp-mo" id="MJXp-Span-1957" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1958" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1959" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1960">a</span><span class="MJXp-mo" id="MJXp-Span-1961" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1962">1</span><span class="MJXp-mo" id="MJXp-Span-1963" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964">b</span><span class="MJXp-mo" id="MJXp-Span-1965" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1966">1</span><span class="MJXp-mo" id="MJXp-Span-1967" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1968" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1969" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1970" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1971" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972">a</span><span class="MJXp-mo" id="MJXp-Span-1973" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1976" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1977" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978">b</span><span class="MJXp-mo" id="MJXp-Span-1979" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1982" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1983" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-249">(a, b), (a-1, b-1), \dots, (a+k_1, b+k_2)</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1984"><span class="MJXp-msubsup" id="MJXp-Span-1985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1986" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1987" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1988" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1990" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1991" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1992" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1993">0</span></span></span><script type="math/tex" id="MathJax-Element-250"> k_1, k_2 \leq 0 </script>.</li> </ul><p>For any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1994"><span class="MJXp-mn" id="MJXp-Span-1995">1</span><span class="MJXp-mo" id="MJXp-Span-1996" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1997">i</span><span class="MJXp-mo" id="MJXp-Span-1998" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999">m</span></span></span><script type="math/tex" id="MathJax-Element-251"> 1 \leq i \leq m </script>, we alternately fill the numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2000"><span class="MJXp-mn" id="MJXp-Span-2001">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2002">i</span><span class="MJXp-mo" id="MJXp-Span-2003" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2004">1</span></span></span><script type="math/tex" id="MathJax-Element-252"> 2i-1 </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2005"><span class="MJXp-mn" id="MJXp-Span-2006">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2007">i</span><span class="MJXp-mo" id="MJXp-Span-2008" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2009">2</span></span></span><script type="math/tex" id="MathJax-Element-253"> 2i-2 </script> in the cells along the paths <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2010"><span class="MJXp-mo" id="MJXp-Span-2011" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2012">1</span><span class="MJXp-mo" id="MJXp-Span-2013" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2014">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015">i</span><span class="MJXp-mo" id="MJXp-Span-2016" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2017" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mo" id="MJXp-Span-2018" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019">n</span><span class="MJXp-mo" id="MJXp-Span-2020" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2021">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022">i</span><span class="MJXp-mo" id="MJXp-Span-2023" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2024">1</span><span class="MJXp-mo" id="MJXp-Span-2025" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">n</span><span class="MJXp-mo" id="MJXp-Span-2027" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-254">(1, 2i) \sim (n-2i+1, n)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2028"><span class="MJXp-mo" id="MJXp-Span-2029" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030">n</span><span class="MJXp-mo" id="MJXp-Span-2031" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2032">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2033">i</span><span class="MJXp-mo" id="MJXp-Span-2034" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2035">2</span><span class="MJXp-mo" id="MJXp-Span-2036" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">n</span><span class="MJXp-mo" id="MJXp-Span-2038" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2039" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mo" id="MJXp-Span-2040" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2041">n</span><span class="MJXp-mo" id="MJXp-Span-2042" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043">n</span><span class="MJXp-mo" id="MJXp-Span-2044" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2045">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">i</span><span class="MJXp-mo" id="MJXp-Span-2047" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2048">2</span><span class="MJXp-mo" id="MJXp-Span-2049" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-255">(n-2i+2, n) \sim (n, n-2i+2)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2050"><span class="MJXp-mo" id="MJXp-Span-2051" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2052">n</span><span class="MJXp-mo" id="MJXp-Span-2053" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054">n</span><span class="MJXp-mo" id="MJXp-Span-2055" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2056">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057">i</span><span class="MJXp-mo" id="MJXp-Span-2058" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2059">1</span><span class="MJXp-mo" id="MJXp-Span-2060" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mo" id="MJXp-Span-2062" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2063">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2064">i</span><span class="MJXp-mo" id="MJXp-Span-2065" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2066">1</span><span class="MJXp-mo" id="MJXp-Span-2067" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-256">(n, n-2i+1) \sim (2i, 1)</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2068"><span class="MJXp-mo" id="MJXp-Span-2069" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2070">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2071">i</span><span class="MJXp-mo" id="MJXp-Span-2072" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2073">1</span><span class="MJXp-mo" id="MJXp-Span-2074" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2075">1</span><span class="MJXp-mo" id="MJXp-Span-2076" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2077" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mo" id="MJXp-Span-2078" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2079">1</span><span class="MJXp-mo" id="MJXp-Span-2080" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2081">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082">i</span><span class="MJXp-mo" id="MJXp-Span-2083" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2084">1</span><span class="MJXp-mo" id="MJXp-Span-2085" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-257">(2i-1, 1) \sim (1, 2i-1)</script>.</p><p>An illustration for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2086"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2087">n</span><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2089">10</span></span></span><script type="math/tex" id="MathJax-Element-258"> n = 10 </script>:</p><p><img alt=" " src="https://codeforces.com/predownloaded/58/4b/584b1dbb1044b5beb3457cc5bdfda8634e2c9f84.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>Next, we prove that this construction satisfies all the requirements of the problem:</p> <ul>   <li>Each row and column of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2090"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2091">A</span></span></span><script type="math/tex" id="MathJax-Element-259"> A </script> is a permutation of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2092"><span class="MJXp-mn" id="MJXp-Span-2093">0</span><span class="MJXp-mo" id="MJXp-Span-2094" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095">n</span><span class="MJXp-mo" id="MJXp-Span-2096" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2097">1</span></span></span><script type="math/tex" id="MathJax-Element-260"> 0 \sim n-1 </script>. </li> </ul> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2098"><span class="MJXp-mn" id="MJXp-Span-2099">1</span><span class="MJXp-mo" id="MJXp-Span-2100" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101">i</span><span class="MJXp-mo" id="MJXp-Span-2102" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2103">m</span></span></span><script type="math/tex" id="MathJax-Element-261"> 1 \leq i \leq m </script>, color the cells containing the numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2104"><span class="MJXp-mn" id="MJXp-Span-2105">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2106">i</span><span class="MJXp-mo" id="MJXp-Span-2107" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2108">1</span></span></span><script type="math/tex" id="MathJax-Element-262"> 2i-1 </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2109"><span class="MJXp-mn" id="MJXp-Span-2110">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111">i</span><span class="MJXp-mo" id="MJXp-Span-2112" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2113">2</span></span></span><script type="math/tex" id="MathJax-Element-263"> 2i-2 </script> black and white alternately along the paths described above. It can be shown that each row and column contains exactly one black and one white cell, ensuring that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2114"><span class="MJXp-mn" id="MJXp-Span-2115">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">i</span><span class="MJXp-mo" id="MJXp-Span-2117" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2118">1</span></span></span><script type="math/tex" id="MathJax-Element-264"> 2i-1 </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2119"><span class="MJXp-mn" id="MJXp-Span-2120">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2121">i</span><span class="MJXp-mo" id="MJXp-Span-2122" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2123">2</span></span></span><script type="math/tex" id="MathJax-Element-265"> 2i-2 </script> appear exactly once in each row and column. Thus, each row and column is a permutation of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2124"><span class="MJXp-mn" id="MJXp-Span-2125">0</span><span class="MJXp-mo" id="MJXp-Span-2126" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127">n</span><span class="MJXp-mo" id="MJXp-Span-2128" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2129">1</span></span></span><script type="math/tex" id="MathJax-Element-266"> 0 \sim n-1 </script>.</p></div></div> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2130"><span class="MJXp-msubsup" id="MJXp-Span-2131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2133" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134">i</span><span class="MJXp-mo" id="MJXp-Span-2135">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2136">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2137" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2140" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2141">i</span><span class="MJXp-mo" id="MJXp-Span-2142">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2143">n</span><span class="MJXp-mo" id="MJXp-Span-2144">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2145">j</span><span class="MJXp-mo" id="MJXp-Span-2146">+</span><span class="MJXp-mn" id="MJXp-Span-2147">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2148" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149">n</span><span class="MJXp-mo" id="MJXp-Span-2150" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2151">1</span></span></span><script type="math/tex" id="MathJax-Element-267"> a_{i,j} + a_{i,n-j+1} = n-1 </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2152"><span class="MJXp-msubsup" id="MJXp-Span-2153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2154" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2155" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156">i</span><span class="MJXp-mo" id="MJXp-Span-2157">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2158">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2159" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2162" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2163">n</span><span class="MJXp-mo" id="MJXp-Span-2164">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2165">i</span><span class="MJXp-mo" id="MJXp-Span-2166">+</span><span class="MJXp-mn" id="MJXp-Span-2167">1</span><span class="MJXp-mo" id="MJXp-Span-2168">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2169">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2170" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">n</span><span class="MJXp-mo" id="MJXp-Span-2172" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2173">1</span></span></span><script type="math/tex" id="MathJax-Element-268"> a_{i,j} + a_{n-i+1,j} = n-1 </script>. </li> </ul> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>From the filling process, the cells containing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2174"><span class="MJXp-mn" id="MJXp-Span-2175">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2176">i</span><span class="MJXp-mo" id="MJXp-Span-2177" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2178">1</span></span></span><script type="math/tex" id="MathJax-Element-269">2i-1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2179"><span class="MJXp-mn" id="MJXp-Span-2180">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">i</span><span class="MJXp-mo" id="MJXp-Span-2182" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2183">2</span></span></span><script type="math/tex" id="MathJax-Element-270">2i-2</script> and the cells containing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2185">n</span><span class="MJXp-mo" id="MJXp-Span-2186" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2187">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2188">i</span><span class="MJXp-mo" id="MJXp-Span-2189" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2190">1</span></span></span><script type="math/tex" id="MathJax-Element-271">n-2i+1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2192">n</span><span class="MJXp-mo" id="MJXp-Span-2193" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2194">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195">i</span></span></span><script type="math/tex" id="MathJax-Element-272">n-2i</script> are symmetric with respect to the midline between the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2197">m</span></span></span><script type="math/tex" id="MathJax-Element-273">m</script>-th and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2198"><span class="MJXp-mo" id="MJXp-Span-2199" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2200">m</span><span class="MJXp-mo" id="MJXp-Span-2201" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2202">1</span><span class="MJXp-mo" id="MJXp-Span-2203" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-274">(m+1)</script>-th rows, as well as the midline between the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2205">m</span></span></span><script type="math/tex" id="MathJax-Element-275">m</script>-th and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2206"><span class="MJXp-mo" id="MJXp-Span-2207" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2208">m</span><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2210">1</span><span class="MJXp-mo" id="MJXp-Span-2211" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-276">(m+1)</script>-th columns. This symmetry further ensures that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2212"><span class="MJXp-mn" id="MJXp-Span-2213">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2214">i</span><span class="MJXp-mo" id="MJXp-Span-2215" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2216">1</span></span></span><script type="math/tex" id="MathJax-Element-277"> 2i-1 </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2218">n</span><span class="MJXp-mo" id="MJXp-Span-2219" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2220">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2221">i</span></span></span><script type="math/tex" id="MathJax-Element-278"> n-2i </script> are symmetric, as are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2222"><span class="MJXp-mn" id="MJXp-Span-2223">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2224">i</span><span class="MJXp-mo" id="MJXp-Span-2225" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2226">2</span></span></span><script type="math/tex" id="MathJax-Element-279"> 2i-2 </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2228">n</span><span class="MJXp-mo" id="MJXp-Span-2229" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2230">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231">i</span><span class="MJXp-mo" id="MJXp-Span-2232" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2233">1</span></span></span><script type="math/tex" id="MathJax-Element-280"> n-2i+1 </script>. Therefore, both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2234"><span class="MJXp-msubsup" id="MJXp-Span-2235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2237" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2238">i</span><span class="MJXp-mo" id="MJXp-Span-2239">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2241" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2244" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2245">i</span><span class="MJXp-mo" id="MJXp-Span-2246">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247">n</span><span class="MJXp-mo" id="MJXp-Span-2248">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249">j</span><span class="MJXp-mo" id="MJXp-Span-2250">+</span><span class="MJXp-mn" id="MJXp-Span-2251">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2252" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253">n</span><span class="MJXp-mo" id="MJXp-Span-2254" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2255">1</span></span></span><script type="math/tex" id="MathJax-Element-281"> a_{i,j} + a_{i,n-j+1} = n-1 </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2256"><span class="MJXp-msubsup" id="MJXp-Span-2257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2258" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2259" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2260">i</span><span class="MJXp-mo" id="MJXp-Span-2261">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2262">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2263" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2265" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2266" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2267">n</span><span class="MJXp-mo" id="MJXp-Span-2268">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">i</span><span class="MJXp-mo" id="MJXp-Span-2270">+</span><span class="MJXp-mn" id="MJXp-Span-2271">1</span><span class="MJXp-mo" id="MJXp-Span-2272">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2274" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2275">n</span><span class="MJXp-mo" id="MJXp-Span-2276" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2277">1</span></span></span><script type="math/tex" id="MathJax-Element-282"> a_{i,j} + a_{n-i+1,j} = n-1 </script> are satisfied.</p></div></div> <ul>   <li>All ordered pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2278"><span class="MJXp-mo" id="MJXp-Span-2279" style="margin-left: 0em; margin-right: 0em;">⟨</span><span class="MJXp-msubsup" id="MJXp-Span-2280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2282" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2283">i</span><span class="MJXp-mo" id="MJXp-Span-2284">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2285">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2286" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2288" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2289" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2290">i</span><span class="MJXp-mo" id="MJXp-Span-2291">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2292">j</span><span class="MJXp-mo" id="MJXp-Span-2293">+</span><span class="MJXp-mn" id="MJXp-Span-2294">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2295" style="margin-left: 0em; margin-right: 0em;">⟩</span></span></span><script type="math/tex" id="MathJax-Element-283"> \langle a_{i,j}, a_{i,j+1} \rangle </script> (for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2296"><span class="MJXp-mn" id="MJXp-Span-2297">1</span><span class="MJXp-mo" id="MJXp-Span-2298" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2299">i</span><span class="MJXp-mo" id="MJXp-Span-2300" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2301">n</span><span class="MJXp-mo" id="MJXp-Span-2302" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2303">1</span><span class="MJXp-mo" id="MJXp-Span-2304" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305">j</span><span class="MJXp-mo" id="MJXp-Span-2306" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">n</span></span></span><script type="math/tex" id="MathJax-Element-284"> 1 \leq i \leq n, 1 \leq j < n </script>) are distinct, and all ordered pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2308"><span class="MJXp-mo" id="MJXp-Span-2309" style="margin-left: 0em; margin-right: 0em;">⟨</span><span class="MJXp-msubsup" id="MJXp-Span-2310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2311" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2312" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2313">i</span><span class="MJXp-mo" id="MJXp-Span-2314">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2315">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2316" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2319" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320">i</span><span class="MJXp-mo" id="MJXp-Span-2321">+</span><span class="MJXp-mn" id="MJXp-Span-2322">1</span><span class="MJXp-mo" id="MJXp-Span-2323">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2324">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2325" style="margin-left: 0em; margin-right: 0em;">⟩</span></span></span><script type="math/tex" id="MathJax-Element-285"> \langle a_{i,j}, a_{i+1,j} \rangle </script> (for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2326"><span class="MJXp-mn" id="MJXp-Span-2327">1</span><span class="MJXp-mo" id="MJXp-Span-2328" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2329">i</span><span class="MJXp-mo" id="MJXp-Span-2330" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2331">n</span><span class="MJXp-mo" id="MJXp-Span-2332" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2333">1</span><span class="MJXp-mo" id="MJXp-Span-2334" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2335">j</span><span class="MJXp-mo" id="MJXp-Span-2336" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2337">n</span></span></span><script type="math/tex" id="MathJax-Element-286"> 1 \leq i < n, 1 \leq j \leq n </script>) are distinct. </li> </ul> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2338"><span class="MJXp-mn" id="MJXp-Span-2339">1</span><span class="MJXp-mo" id="MJXp-Span-2340" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">i</span><span class="MJXp-mo" id="MJXp-Span-2342" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343">m</span></span></span><script type="math/tex" id="MathJax-Element-287"> 1 \leq i \leq m </script>, divide the cells containing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2344"><span class="MJXp-mn" id="MJXp-Span-2345">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2346">i</span><span class="MJXp-mo" id="MJXp-Span-2347" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2348">1</span></span></span><script type="math/tex" id="MathJax-Element-288"> 2i-1 </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2349"><span class="MJXp-mn" id="MJXp-Span-2350">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2351">i</span><span class="MJXp-mo" id="MJXp-Span-2352" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2353">2</span></span></span><script type="math/tex" id="MathJax-Element-289"> 2i-2 </script> into four categories:</p> <ul>   <li>First category: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2354"><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2356">1</span><span class="MJXp-mo" id="MJXp-Span-2357" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2358">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359">i</span><span class="MJXp-mo" id="MJXp-Span-2360" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2361" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mo" id="MJXp-Span-2362" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2363">n</span><span class="MJXp-mo" id="MJXp-Span-2364" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2365">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">i</span><span class="MJXp-mo" id="MJXp-Span-2367" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2368">1</span><span class="MJXp-mo" id="MJXp-Span-2369" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2370">n</span><span class="MJXp-mo" id="MJXp-Span-2371" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-290">(1, 2i) \sim (n-2i+1, n)</script></li>   <li>Second category: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2372"><span class="MJXp-mo" id="MJXp-Span-2373" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374">n</span><span class="MJXp-mo" id="MJXp-Span-2375" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2376">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377">i</span><span class="MJXp-mo" id="MJXp-Span-2378" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2379">2</span><span class="MJXp-mo" id="MJXp-Span-2380" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">n</span><span class="MJXp-mo" id="MJXp-Span-2382" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2383" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mo" id="MJXp-Span-2384" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385">n</span><span class="MJXp-mo" id="MJXp-Span-2386" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2387">n</span><span class="MJXp-mo" id="MJXp-Span-2388" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2389">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2390">i</span><span class="MJXp-mo" id="MJXp-Span-2391" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2392">2</span><span class="MJXp-mo" id="MJXp-Span-2393" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-291">(n-2i+2, n) \sim (n, n-2i+2)</script></li>   <li>Third category: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2394"><span class="MJXp-mo" id="MJXp-Span-2395" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2396">n</span><span class="MJXp-mo" id="MJXp-Span-2397" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398">n</span><span class="MJXp-mo" id="MJXp-Span-2399" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2400">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401">i</span><span class="MJXp-mo" id="MJXp-Span-2402" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2403">1</span><span class="MJXp-mo" id="MJXp-Span-2404" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2405" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mo" id="MJXp-Span-2406" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2407">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408">i</span><span class="MJXp-mo" id="MJXp-Span-2409" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2410">1</span><span class="MJXp-mo" id="MJXp-Span-2411" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-292">(n, n-2i+1) \sim (2i, 1)</script></li>   <li>Fourth category: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2412"><span class="MJXp-mo" id="MJXp-Span-2413" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2414">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415">i</span><span class="MJXp-mo" id="MJXp-Span-2416" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2417">1</span><span class="MJXp-mo" id="MJXp-Span-2418" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2419">1</span><span class="MJXp-mo" id="MJXp-Span-2420" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2421" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mo" id="MJXp-Span-2422" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2423">1</span><span class="MJXp-mo" id="MJXp-Span-2424" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2425">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426">i</span><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2428">1</span><span class="MJXp-mo" id="MJXp-Span-2429" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-293">(2i-1, 1) \sim (1, 2i-1)</script></li> </ul><p>For any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2430"><span class="MJXp-mn" id="MJXp-Span-2431">1</span><span class="MJXp-mo" id="MJXp-Span-2432" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2433">i</span><span class="MJXp-mo" id="MJXp-Span-2434" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435">j</span><span class="MJXp-mo" id="MJXp-Span-2436" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2437">m</span></span></span><script type="math/tex" id="MathJax-Element-294"> 1 \leq i < j \leq m </script>:</p> <ul>   <li>The first and third category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2438"><span class="MJXp-mn" id="MJXp-Span-2439">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2440">i</span><span class="MJXp-mo" id="MJXp-Span-2441" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2442">1</span><span class="MJXp-mo" id="MJXp-Span-2443" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2444">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2445">i</span><span class="MJXp-mo" id="MJXp-Span-2446" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2447">2</span></span></span><script type="math/tex" id="MathJax-Element-295"> 2i-1, 2i-2 </script> do not neighbor the first and third category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2448"><span class="MJXp-mn" id="MJXp-Span-2449">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2450">j</span><span class="MJXp-mo" id="MJXp-Span-2451" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2452">1</span><span class="MJXp-mo" id="MJXp-Span-2453" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2454">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2455">j</span><span class="MJXp-mo" id="MJXp-Span-2456" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2457">2</span></span></span><script type="math/tex" id="MathJax-Element-296"> 2j-1, 2j-2 </script> (since the sum of their coordinates is odd).</li>   <li>The second and fourth category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2458"><span class="MJXp-mn" id="MJXp-Span-2459">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2460">i</span><span class="MJXp-mo" id="MJXp-Span-2461" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2462">1</span><span class="MJXp-mo" id="MJXp-Span-2463" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2464">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2465">i</span><span class="MJXp-mo" id="MJXp-Span-2466" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2467">2</span></span></span><script type="math/tex" id="MathJax-Element-297"> 2i-1, 2i-2 </script> do not neighbor the second and fourth category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2468"><span class="MJXp-mn" id="MJXp-Span-2469">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2470">j</span><span class="MJXp-mo" id="MJXp-Span-2471" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2472">1</span><span class="MJXp-mo" id="MJXp-Span-2473" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2474">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2475">j</span><span class="MJXp-mo" id="MJXp-Span-2476" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2477">2</span></span></span><script type="math/tex" id="MathJax-Element-298"> 2j-1, 2j-2 </script> (since the sum of their coordinates is even).</li>   <li>The second and fourth category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2478"><span class="MJXp-mn" id="MJXp-Span-2479">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2480">i</span><span class="MJXp-mo" id="MJXp-Span-2481" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2482">1</span><span class="MJXp-mo" id="MJXp-Span-2483" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2484">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485">i</span><span class="MJXp-mo" id="MJXp-Span-2486" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2487">2</span></span></span><script type="math/tex" id="MathJax-Element-299"> 2i-1, 2i-2 </script> do not have row-wise neighbors with the first and third category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2488"><span class="MJXp-mn" id="MJXp-Span-2489">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2490">j</span><span class="MJXp-mo" id="MJXp-Span-2491" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2492">1</span><span class="MJXp-mo" id="MJXp-Span-2493" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2494">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2495">j</span><span class="MJXp-mo" id="MJXp-Span-2496" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2497">2</span></span></span><script type="math/tex" id="MathJax-Element-300"> 2j-1, 2j-2 </script>, and the first and third category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2498"><span class="MJXp-mn" id="MJXp-Span-2499">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2500">i</span><span class="MJXp-mo" id="MJXp-Span-2501" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2502">1</span><span class="MJXp-mo" id="MJXp-Span-2503" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2504">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2505">i</span><span class="MJXp-mo" id="MJXp-Span-2506" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2507">2</span></span></span><script type="math/tex" id="MathJax-Element-301"> 2i-1, 2i-2 </script> have exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2508"><span class="MJXp-mn" id="MJXp-Span-2509">2</span></span></span><script type="math/tex" id="MathJax-Element-302">2</script> pairs of row-wise neighbors with the second and fourth category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2510"><span class="MJXp-mn" id="MJXp-Span-2511">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2512">j</span><span class="MJXp-mo" id="MJXp-Span-2513" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2514">1</span><span class="MJXp-mo" id="MJXp-Span-2515" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2516">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2517">j</span><span class="MJXp-mo" id="MJXp-Span-2518" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2519">2</span></span></span><script type="math/tex" id="MathJax-Element-303"> 2j-1, 2j-2 </script> (this can be visualized and proven through diagrams).</li> </ul><p>Specifically:</p> <ul>   <li><p>The first category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2520"><span class="MJXp-mn" id="MJXp-Span-2521">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2522">i</span><span class="MJXp-mo" id="MJXp-Span-2523" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2524">1</span><span class="MJXp-mo" id="MJXp-Span-2525" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2526">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2527">i</span><span class="MJXp-mo" id="MJXp-Span-2528" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2529">2</span></span></span><script type="math/tex" id="MathJax-Element-304"> 2i-1, 2i-2 </script> and the second category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2530"><span class="MJXp-mn" id="MJXp-Span-2531">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2532">j</span><span class="MJXp-mo" id="MJXp-Span-2533" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2534">1</span><span class="MJXp-mo" id="MJXp-Span-2535" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2536">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2537">j</span><span class="MJXp-mo" id="MJXp-Span-2538" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2539">2</span></span></span><script type="math/tex" id="MathJax-Element-305"> 2j-1, 2j-2 </script> have exactly 2 pairs of row-wise neighbors:</p>   <ul>     <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2540"><span class="MJXp-msubsup" id="MJXp-Span-2541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2542" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2543" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2544">n</span><span class="MJXp-mo" id="MJXp-Span-2545">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2546">i</span><span class="MJXp-mo" id="MJXp-Span-2547">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2548">j</span><span class="MJXp-mo" id="MJXp-Span-2549">+</span><span class="MJXp-mn" id="MJXp-Span-2550">1</span><span class="MJXp-mo" id="MJXp-Span-2551">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2552">n</span><span class="MJXp-mo" id="MJXp-Span-2553">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2554">i</span><span class="MJXp-mo" id="MJXp-Span-2555">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2557" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2558">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2559">i</span><span class="MJXp-mo" id="MJXp-Span-2560" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2561">2</span><span class="MJXp-mo" id="MJXp-Span-2562" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2563" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2564" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2565">i</span><span class="MJXp-mo" id="MJXp-Span-2566" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2567">j</span><span class="MJXp-mo" id="MJXp-Span-2568" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2569">1</span><span class="MJXp-mo" id="MJXp-Span-2570" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2571" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2572">2</span><span class="MJXp-mo" id="MJXp-Span-2573" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2574" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2575"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2576" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2577" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2578">n</span><span class="MJXp-mo" id="MJXp-Span-2579">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2580">i</span><span class="MJXp-mo" id="MJXp-Span-2581">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2582">j</span><span class="MJXp-mo" id="MJXp-Span-2583">+</span><span class="MJXp-mn" id="MJXp-Span-2584">1</span><span class="MJXp-mo" id="MJXp-Span-2585">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2586">n</span><span class="MJXp-mo" id="MJXp-Span-2587">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2588">i</span><span class="MJXp-mo" id="MJXp-Span-2589">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2590">j</span><span class="MJXp-mo" id="MJXp-Span-2591">+</span><span class="MJXp-mn" id="MJXp-Span-2592">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2593" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2594">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595">j</span><span class="MJXp-mo" id="MJXp-Span-2596" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2597">2</span><span class="MJXp-mo" id="MJXp-Span-2598" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2599" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2600" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2601">i</span><span class="MJXp-mo" id="MJXp-Span-2602" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2603">j</span><span class="MJXp-mo" id="MJXp-Span-2604" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2605">1</span><span class="MJXp-mo" id="MJXp-Span-2606" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2607" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2608">2</span><span class="MJXp-mo" id="MJXp-Span-2609" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-306"> a_{n-i-j+1,n+i-j} = 2i-2 + ((i+j+1) \bmod 2), a_{n-i-j+1,n+i-j+1} = 2j-2 + ((i+j+1) \bmod 2) </script></li>     <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2610"><span class="MJXp-msubsup" id="MJXp-Span-2611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2612" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2613" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2614">n</span><span class="MJXp-mo" id="MJXp-Span-2615">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2616">i</span><span class="MJXp-mo" id="MJXp-Span-2617">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2618">j</span><span class="MJXp-mo" id="MJXp-Span-2619">+</span><span class="MJXp-mn" id="MJXp-Span-2620">2</span><span class="MJXp-mo" id="MJXp-Span-2621">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2622">n</span><span class="MJXp-mo" id="MJXp-Span-2623">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2624">i</span><span class="MJXp-mo" id="MJXp-Span-2625">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2626">j</span><span class="MJXp-mo" id="MJXp-Span-2627">+</span><span class="MJXp-mn" id="MJXp-Span-2628">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2629" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2630">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2631">i</span><span class="MJXp-mo" id="MJXp-Span-2632" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2633">2</span><span class="MJXp-mo" id="MJXp-Span-2634" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2635" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2636" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2637">i</span><span class="MJXp-mo" id="MJXp-Span-2638" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2639">j</span><span class="MJXp-mo" id="MJXp-Span-2640" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2641" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2642">2</span><span class="MJXp-mo" id="MJXp-Span-2643" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2644" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2646" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2647" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2648">n</span><span class="MJXp-mo" id="MJXp-Span-2649">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2650">i</span><span class="MJXp-mo" id="MJXp-Span-2651">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2652">j</span><span class="MJXp-mo" id="MJXp-Span-2653">+</span><span class="MJXp-mn" id="MJXp-Span-2654">2</span><span class="MJXp-mo" id="MJXp-Span-2655">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2656">n</span><span class="MJXp-mo" id="MJXp-Span-2657">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2658">i</span><span class="MJXp-mo" id="MJXp-Span-2659">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2660">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2661" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2662">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2663">j</span><span class="MJXp-mo" id="MJXp-Span-2664" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2665">2</span><span class="MJXp-mo" id="MJXp-Span-2666" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2667" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2668" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2669">i</span><span class="MJXp-mo" id="MJXp-Span-2670" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2671">j</span><span class="MJXp-mo" id="MJXp-Span-2672" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2673" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2674">2</span><span class="MJXp-mo" id="MJXp-Span-2675" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-307"> a_{n-i-j+2,n+i-j+1} = 2i-2 + ((i+j) \bmod 2), a_{n-i-j+2,n+i-j} = 2j-2 + ((i+j) \bmod 2) </script></li>   </ul></li>   <li><p>The first category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2676"><span class="MJXp-mn" id="MJXp-Span-2677">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2678">i</span><span class="MJXp-mo" id="MJXp-Span-2679" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2680">1</span><span class="MJXp-mo" id="MJXp-Span-2681" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2682">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2683">i</span><span class="MJXp-mo" id="MJXp-Span-2684" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2685">2</span></span></span><script type="math/tex" id="MathJax-Element-308"> 2i-1, 2i-2 </script> and the fourth category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2686"><span class="MJXp-mn" id="MJXp-Span-2687">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2688">j</span><span class="MJXp-mo" id="MJXp-Span-2689" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2690">1</span><span class="MJXp-mo" id="MJXp-Span-2691" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2692">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2693">j</span><span class="MJXp-mo" id="MJXp-Span-2694" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2695">2</span></span></span><script type="math/tex" id="MathJax-Element-309"> 2j-1, 2j-2 </script> have exactly 2 pairs of row-wise neighbors:</p>   <ul>     <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2696"><span class="MJXp-msubsup" id="MJXp-Span-2697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2698" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2699" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2700">j</span><span class="MJXp-mo" id="MJXp-Span-2701">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2702">i</span><span class="MJXp-mo" id="MJXp-Span-2703">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2704">i</span><span class="MJXp-mo" id="MJXp-Span-2705">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2706">j</span><span class="MJXp-mo" id="MJXp-Span-2707">−</span><span class="MJXp-mn" id="MJXp-Span-2708">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2709" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2710">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2711">i</span><span class="MJXp-mo" id="MJXp-Span-2712" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2713">2</span><span class="MJXp-mo" id="MJXp-Span-2714" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2715" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2716" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2717">i</span><span class="MJXp-mo" id="MJXp-Span-2718" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2719">j</span><span class="MJXp-mo" id="MJXp-Span-2720" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2721" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2722">2</span><span class="MJXp-mo" id="MJXp-Span-2723" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2724" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2726" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2727" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2728">j</span><span class="MJXp-mo" id="MJXp-Span-2729">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730">i</span><span class="MJXp-mo" id="MJXp-Span-2731">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2732">i</span><span class="MJXp-mo" id="MJXp-Span-2733">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2734">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2735" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2736">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2737">j</span><span class="MJXp-mo" id="MJXp-Span-2738" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2739">2</span><span class="MJXp-mo" id="MJXp-Span-2740" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2741" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2742" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2743">i</span><span class="MJXp-mo" id="MJXp-Span-2744" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2745">j</span><span class="MJXp-mo" id="MJXp-Span-2746" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2747">1</span><span class="MJXp-mo" id="MJXp-Span-2748" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2749" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2750">2</span><span class="MJXp-mo" id="MJXp-Span-2751" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-310"> a_{j-i,i+j-1} = 2i-2 + ((i+j) \bmod 2), a_{j-i,i+j} = 2j-2 + ((i+j+1) \bmod 2) </script></li>     <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2752"><span class="MJXp-msubsup" id="MJXp-Span-2753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2754" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2755" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2756">j</span><span class="MJXp-mo" id="MJXp-Span-2757">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2758">i</span><span class="MJXp-mo" id="MJXp-Span-2759">+</span><span class="MJXp-mn" id="MJXp-Span-2760">1</span><span class="MJXp-mo" id="MJXp-Span-2761">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2762">i</span><span class="MJXp-mo" id="MJXp-Span-2763">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2764">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2765" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2766">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2767">i</span><span class="MJXp-mo" id="MJXp-Span-2768" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2769">2</span><span class="MJXp-mo" id="MJXp-Span-2770" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2772" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2773">i</span><span class="MJXp-mo" id="MJXp-Span-2774" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2775">j</span><span class="MJXp-mo" id="MJXp-Span-2776" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2777">1</span><span class="MJXp-mo" id="MJXp-Span-2778" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2779" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2780">2</span><span class="MJXp-mo" id="MJXp-Span-2781" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2782" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2784" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2785" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2786">j</span><span class="MJXp-mo" id="MJXp-Span-2787">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2788">i</span><span class="MJXp-mo" id="MJXp-Span-2789">+</span><span class="MJXp-mn" id="MJXp-Span-2790">1</span><span class="MJXp-mo" id="MJXp-Span-2791">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2792">i</span><span class="MJXp-mo" id="MJXp-Span-2793">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2794">j</span><span class="MJXp-mo" id="MJXp-Span-2795">−</span><span class="MJXp-mn" id="MJXp-Span-2796">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2797" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2798">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2799">j</span><span class="MJXp-mo" id="MJXp-Span-2800" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2801">2</span><span class="MJXp-mo" id="MJXp-Span-2802" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2803" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2804" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2805">i</span><span class="MJXp-mo" id="MJXp-Span-2806" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2807">j</span><span class="MJXp-mo" id="MJXp-Span-2808" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2809" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2810">2</span><span class="MJXp-mo" id="MJXp-Span-2811" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-311"> a_{j-i+1,i+j} = 2i-2 + ((i+j+1) \bmod 2), a_{j-i+1,i+j-1} = 2j-2 + ((i+j) \bmod 2) </script></li>   </ul></li>   <li><p>The third category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2812"><span class="MJXp-mn" id="MJXp-Span-2813">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814">i</span><span class="MJXp-mo" id="MJXp-Span-2815" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2816">1</span><span class="MJXp-mo" id="MJXp-Span-2817" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2818">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2819">i</span><span class="MJXp-mo" id="MJXp-Span-2820" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2821">2</span></span></span><script type="math/tex" id="MathJax-Element-312"> 2i-1, 2i-2 </script> and the second category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2822"><span class="MJXp-mn" id="MJXp-Span-2823">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2824">j</span><span class="MJXp-mo" id="MJXp-Span-2825" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2826">1</span><span class="MJXp-mo" id="MJXp-Span-2827" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2828">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2829">j</span><span class="MJXp-mo" id="MJXp-Span-2830" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2831">2</span></span></span><script type="math/tex" id="MathJax-Element-313"> 2j-1, 2j-2 </script> have exactly 2 pairs of row-wise neighbors:</p>   <ul>     <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2832"><span class="MJXp-msubsup" id="MJXp-Span-2833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2834" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2835" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2836">n</span><span class="MJXp-mo" id="MJXp-Span-2837">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2838">i</span><span class="MJXp-mo" id="MJXp-Span-2839">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2840">j</span><span class="MJXp-mo" id="MJXp-Span-2841">+</span><span class="MJXp-mn" id="MJXp-Span-2842">1</span><span class="MJXp-mo" id="MJXp-Span-2843">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2844">n</span><span class="MJXp-mo" id="MJXp-Span-2845">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2846">i</span><span class="MJXp-mo" id="MJXp-Span-2847">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2848">j</span><span class="MJXp-mo" id="MJXp-Span-2849">+</span><span class="MJXp-mn" id="MJXp-Span-2850">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2851" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2852">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2853">i</span><span class="MJXp-mo" id="MJXp-Span-2854" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2855">2</span><span class="MJXp-mo" id="MJXp-Span-2856" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2857" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2858" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2859">i</span><span class="MJXp-mo" id="MJXp-Span-2860" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2861">j</span><span class="MJXp-mo" id="MJXp-Span-2862" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2863" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2864">2</span><span class="MJXp-mo" id="MJXp-Span-2865" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2866" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2869" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2870">n</span><span class="MJXp-mo" id="MJXp-Span-2871">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2872">i</span><span class="MJXp-mo" id="MJXp-Span-2873">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2874">j</span><span class="MJXp-mo" id="MJXp-Span-2875">+</span><span class="MJXp-mn" id="MJXp-Span-2876">1</span><span class="MJXp-mo" id="MJXp-Span-2877">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2878">n</span><span class="MJXp-mo" id="MJXp-Span-2879">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2880">i</span><span class="MJXp-mo" id="MJXp-Span-2881">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2882">j</span><span class="MJXp-mo" id="MJXp-Span-2883">+</span><span class="MJXp-mn" id="MJXp-Span-2884">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2885" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2886">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2887">j</span><span class="MJXp-mo" id="MJXp-Span-2888" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2889">2</span><span class="MJXp-mo" id="MJXp-Span-2890" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2891" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2892" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2893">i</span><span class="MJXp-mo" id="MJXp-Span-2894" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2895">j</span><span class="MJXp-mo" id="MJXp-Span-2896" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2897">1</span><span class="MJXp-mo" id="MJXp-Span-2898" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2899" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2900">2</span><span class="MJXp-mo" id="MJXp-Span-2901" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-314"> a_{n+i-j+1,n-i-j+2} = 2i-2 + ((i+j) \bmod 2), a_{n+i-j+1,n-i-j+1} = 2j-2 + ((i+j+1) \bmod 2) </script></li>     <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2902"><span class="MJXp-msubsup" id="MJXp-Span-2903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2904" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2905" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2906">n</span><span class="MJXp-mo" id="MJXp-Span-2907">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2908">i</span><span class="MJXp-mo" id="MJXp-Span-2909">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2910">j</span><span class="MJXp-mo" id="MJXp-Span-2911">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2912">n</span><span class="MJXp-mo" id="MJXp-Span-2913">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2914">i</span><span class="MJXp-mo" id="MJXp-Span-2915">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2916">j</span><span class="MJXp-mo" id="MJXp-Span-2917">+</span><span class="MJXp-mn" id="MJXp-Span-2918">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2919" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2920">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2921">i</span><span class="MJXp-mo" id="MJXp-Span-2922" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2923">2</span><span class="MJXp-mo" id="MJXp-Span-2924" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2925" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2926" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2927">i</span><span class="MJXp-mo" id="MJXp-Span-2928" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2929">j</span><span class="MJXp-mo" id="MJXp-Span-2930" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2931">1</span><span class="MJXp-mo" id="MJXp-Span-2932" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2933" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2934">2</span><span class="MJXp-mo" id="MJXp-Span-2935" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2936" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2938" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2939" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2940">n</span><span class="MJXp-mo" id="MJXp-Span-2941">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2942">i</span><span class="MJXp-mo" id="MJXp-Span-2943">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2944">j</span><span class="MJXp-mo" id="MJXp-Span-2945">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2946">n</span><span class="MJXp-mo" id="MJXp-Span-2947">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2948">i</span><span class="MJXp-mo" id="MJXp-Span-2949">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2950">j</span><span class="MJXp-mo" id="MJXp-Span-2951">+</span><span class="MJXp-mn" id="MJXp-Span-2952">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2953" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2954">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2955">j</span><span class="MJXp-mo" id="MJXp-Span-2956" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2957">2</span><span class="MJXp-mo" id="MJXp-Span-2958" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2959" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2960" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2961">i</span><span class="MJXp-mo" id="MJXp-Span-2962" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2963">j</span><span class="MJXp-mo" id="MJXp-Span-2964" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2965" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-2966">2</span><span class="MJXp-mo" id="MJXp-Span-2967" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-315"> a_{n+i-j,n-i-j+1} = 2i-2 + ((i+j+1) \bmod 2), a_{n+i-j,n-i-j+2} = 2j-2 + ((i+j) \bmod 2) </script></li>   </ul></li>   <li><p>The third category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2968"><span class="MJXp-mn" id="MJXp-Span-2969">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2970">i</span><span class="MJXp-mo" id="MJXp-Span-2971" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2972">1</span><span class="MJXp-mo" id="MJXp-Span-2973" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2974">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2975">i</span><span class="MJXp-mo" id="MJXp-Span-2976" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2977">2</span></span></span><script type="math/tex" id="MathJax-Element-316"> 2i-1, 2i-2 </script> and the fourth category cells of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2978"><span class="MJXp-mn" id="MJXp-Span-2979">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2980">j</span><span class="MJXp-mo" id="MJXp-Span-2981" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2982">1</span><span class="MJXp-mo" id="MJXp-Span-2983" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2984">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2985">j</span><span class="MJXp-mo" id="MJXp-Span-2986" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2987">2</span></span></span><script type="math/tex" id="MathJax-Element-317"> 2j-1, 2j-2 </script> have exactly 2 pairs of row-wise neighbors:</p>   <ul>     <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2988"><span class="MJXp-msubsup" id="MJXp-Span-2989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2990" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2991" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2992">i</span><span class="MJXp-mo" id="MJXp-Span-2993">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2994">j</span><span class="MJXp-mo" id="MJXp-Span-2995">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2996">j</span><span class="MJXp-mo" id="MJXp-Span-2997">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2998">i</span><span class="MJXp-mo" id="MJXp-Span-2999">+</span><span class="MJXp-mn" id="MJXp-Span-3000">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3001" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3002">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3003">i</span><span class="MJXp-mo" id="MJXp-Span-3004" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3005">2</span><span class="MJXp-mo" id="MJXp-Span-3006" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-3007" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-3008" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3009">i</span><span class="MJXp-mo" id="MJXp-Span-3010" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3011">j</span><span class="MJXp-mo" id="MJXp-Span-3012" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3013">1</span><span class="MJXp-mo" id="MJXp-Span-3014" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3015" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-3016">2</span><span class="MJXp-mo" id="MJXp-Span-3017" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3018" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3020" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3021" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3022">i</span><span class="MJXp-mo" id="MJXp-Span-3023">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3024">j</span><span class="MJXp-mo" id="MJXp-Span-3025">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3026">j</span><span class="MJXp-mo" id="MJXp-Span-3027">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3028">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-3029" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3030">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3031">j</span><span class="MJXp-mo" id="MJXp-Span-3032" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3033">2</span><span class="MJXp-mo" id="MJXp-Span-3034" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-3035" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-3036" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3037">i</span><span class="MJXp-mo" id="MJXp-Span-3038" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3039">j</span><span class="MJXp-mo" id="MJXp-Span-3040" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3041">1</span><span class="MJXp-mo" id="MJXp-Span-3042" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3043" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-3044">2</span><span class="MJXp-mo" id="MJXp-Span-3045" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-318"> a_{i+j,j-i+1} = 2i-2 + ((i+j+1) \bmod 2), a_{i+j,j-i} = 2j-2 + ((i+j+1) \bmod 2) </script></li>     <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3046"><span class="MJXp-msubsup" id="MJXp-Span-3047"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3048" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3049" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3050">i</span><span class="MJXp-mo" id="MJXp-Span-3051">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3052">j</span><span class="MJXp-mo" id="MJXp-Span-3053">−</span><span class="MJXp-mn" id="MJXp-Span-3054">1</span><span class="MJXp-mo" id="MJXp-Span-3055">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3056">j</span><span class="MJXp-mo" id="MJXp-Span-3057">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3058">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-3059" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3060">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3061">i</span><span class="MJXp-mo" id="MJXp-Span-3062" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3063">2</span><span class="MJXp-mo" id="MJXp-Span-3064" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-3065" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-3066" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3067">i</span><span class="MJXp-mo" id="MJXp-Span-3068" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3069">j</span><span class="MJXp-mo" id="MJXp-Span-3070" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3071" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-3072">2</span><span class="MJXp-mo" id="MJXp-Span-3073" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3074" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3076" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3077" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3078">i</span><span class="MJXp-mo" id="MJXp-Span-3079">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3080">j</span><span class="MJXp-mo" id="MJXp-Span-3081">−</span><span class="MJXp-mn" id="MJXp-Span-3082">1</span><span class="MJXp-mo" id="MJXp-Span-3083">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3084">j</span><span class="MJXp-mo" id="MJXp-Span-3085">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3086">i</span><span class="MJXp-mo" id="MJXp-Span-3087">+</span><span class="MJXp-mn" id="MJXp-Span-3088">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3089" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3090">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3091">j</span><span class="MJXp-mo" id="MJXp-Span-3092" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3093">2</span><span class="MJXp-mo" id="MJXp-Span-3094" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-3095" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-3096" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3097">i</span><span class="MJXp-mo" id="MJXp-Span-3098" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3099">j</span><span class="MJXp-mo" id="MJXp-Span-3100" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3101" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-3102">2</span><span class="MJXp-mo" id="MJXp-Span-3103" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-319"> a_{i+j-1,j-i} = 2i-2 + ((i+j) \bmod 2), a_{i+j-1,j-i+1} = 2j-2 + ((i+j) \bmod 2) </script></li>   </ul></li> </ul><p>From the above analysis and by enumerating the parity of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3105">i</span><span class="MJXp-mo" id="MJXp-Span-3106" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3107">j</span></span></span><script type="math/tex" id="MathJax-Element-320">i+j</script>, it is clear that all ordered pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3108"><span class="MJXp-mo" id="MJXp-Span-3109" style="margin-left: 0em; margin-right: 0em;">⟨</span><span class="MJXp-msubsup" id="MJXp-Span-3110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3111" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3112" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3113">i</span><span class="MJXp-mo" id="MJXp-Span-3114">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3115">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-3116" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3118" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3119" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3120">i</span><span class="MJXp-mo" id="MJXp-Span-3121">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3122">j</span><span class="MJXp-mo" id="MJXp-Span-3123">+</span><span class="MJXp-mn" id="MJXp-Span-3124">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3125" style="margin-left: 0em; margin-right: 0em;">⟩</span></span></span><script type="math/tex" id="MathJax-Element-321"> \langle a_{i,j}, a_{i,j+1} \rangle </script> (for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3126"><span class="MJXp-mn" id="MJXp-Span-3127">1</span><span class="MJXp-mo" id="MJXp-Span-3128" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3129">i</span><span class="MJXp-mo" id="MJXp-Span-3130" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3131">n</span><span class="MJXp-mo" id="MJXp-Span-3132" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3133">1</span><span class="MJXp-mo" id="MJXp-Span-3134" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3135">j</span><span class="MJXp-mo" id="MJXp-Span-3136" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3137">n</span></span></span><script type="math/tex" id="MathJax-Element-322"> 1 \leq i \leq n, 1 \leq j < n </script>) are distinct, and all ordered pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3138"><span class="MJXp-mo" id="MJXp-Span-3139" style="margin-left: 0em; margin-right: 0em;">⟨</span><span class="MJXp-msubsup" id="MJXp-Span-3140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3141" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3142" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3143">i</span><span class="MJXp-mo" id="MJXp-Span-3144">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3145">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-3146" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3148" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3149" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3150">i</span><span class="MJXp-mo" id="MJXp-Span-3151">+</span><span class="MJXp-mn" id="MJXp-Span-3152">1</span><span class="MJXp-mo" id="MJXp-Span-3153">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3154">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-3155" style="margin-left: 0em; margin-right: 0em;">⟩</span></span></span><script type="math/tex" id="MathJax-Element-323"> \langle a_{i,j}, a_{i+1,j} \rangle </script> (for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3156"><span class="MJXp-mn" id="MJXp-Span-3157">1</span><span class="MJXp-mo" id="MJXp-Span-3158" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3159">i</span><span class="MJXp-mo" id="MJXp-Span-3160" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3161">n</span><span class="MJXp-mo" id="MJXp-Span-3162" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3163">1</span><span class="MJXp-mo" id="MJXp-Span-3164" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3165">j</span><span class="MJXp-mo" id="MJXp-Span-3166" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3167">n</span></span></span><script type="math/tex" id="MathJax-Element-324"> 1 \leq i < n, 1 \leq j \leq n </script>) are distinct.</p></div></div><p>In conclusion, we have provided a construction for even <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3169">n</span></span></span><script type="math/tex" id="MathJax-Element-325"> n </script> and proven that it satisfies all the problem's requirements.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3171">O</span><span class="MJXp-mo" id="MJXp-Span-3172" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-3173" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-3174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3175" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3176" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3177" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-326">O(\sum n^2)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> </span><span class="typ">Test_num</span><span class="pun">,</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">3002</span><span class="pun">][</span><span class="lit">3002</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">n</span><span class="pun">&gt;=</span><span class="lit">3</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">))</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)(</span><span class="pln">puts</span><span class="pun">(</span><span class="str">"NO"</span><span class="pun">));</span><span class="pln">
	puts</span><span class="pun">(</span><span class="str">"YES"</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)(</span><span class="pln">puts</span><span class="pun">(</span><span class="str">"0"</span><span class="pun">));</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">+=</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="pln">a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="lit">2</span><span class="pun">-</span><span class="pln">j</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">+((</span><span class="pln">j</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)^</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">2</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="pln">a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">j</span><span class="pun">-</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">+((</span><span class="pln">j</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)^</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">-</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="pln">a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">+</span><span class="pln">j</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">+(</span><span class="pln">j</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">n</span><span class="pun">-</span><span class="pln">i</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="pln">a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">-</span><span class="pln">i</span><span class="pun">-</span><span class="pln">j</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">+(</span><span class="pln">j</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"%d%c"</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">],</span><span class="pln">j</span><span class="pun">==</span><span class="pln">n</span><span class="pun">?</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">:</span><span class="str">' '</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="typ">Test_num</span><span class="pun">);</span><span class="typ">Test_num</span><span class="pun">--;)</span><span class="pln">solve</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2081/problem/G1" title="Codeforces Round 1010 (Div. 1, Unrated)">2081G1 - Hard Formula</a> <br> Idea: <a class="rated-user user-blue" href="https://codeforces.com/profile/Prean" title="Expert Prean">Prean</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3178"><span class="MJXp-msup" id="MJXp-Span-3179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3180" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3181" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3182" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3183">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3184">p</span><span class="MJXp-mo" id="MJXp-Span-3185" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3186" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msup" id="MJXp-Span-3187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3188" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3189" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3190" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3191">n</span><span class="MJXp-mo" id="MJXp-Span-3192" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-327">g'(np)\neq g'(n)</script> , then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3194">p</span><span class="MJXp-mo" id="MJXp-Span-3195" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3196">n</span></span></span><script type="math/tex" id="MathJax-Element-328">p\le n</script> unless <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3198">n</span><span class="MJXp-mo" id="MJXp-Span-3199" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3200">2</span><span class="MJXp-mo" id="MJXp-Span-3201" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3202">p</span><span class="MJXp-mo" id="MJXp-Span-3203" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3204">3</span></span></span><script type="math/tex" id="MathJax-Element-329">n=2,p=3</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3206">n</span><span class="MJXp-mo" id="MJXp-Span-3207" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3208">1</span><span class="MJXp-mo" id="MJXp-Span-3209" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3210">p</span><span class="MJXp-mo" id="MJXp-Span-3211" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3212">2</span></span></span><script type="math/tex" id="MathJax-Element-330">n=1,p=2</script> .</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Think about the method of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3213"><span class="MJXp-mo" id="MJXp-Span-3214" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mn" id="MJXp-Span-3215">25</span></span></span><script type="math/tex" id="MathJax-Element-331">\min 25</script> sieve.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>We define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3216"><span class="MJXp-mstyle" id="MJXp-Span-3217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3218">g</span><span class="MJXp-mo" id="MJXp-Span-3219" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3220">n</span><span class="MJXp-mo" id="MJXp-Span-3221" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3222" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3223" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3224">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3225">φ</span><span class="MJXp-mo" id="MJXp-Span-3226" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3227">n</span><span class="MJXp-mo" id="MJXp-Span-3228" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3229" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3230"><span class=""><span class="MJXp-mo" id="MJXp-Span-3231" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3232" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3233">p</span><span class="MJXp-mrow" id="MJXp-Span-3234"><span class="MJXp-mo" id="MJXp-Span-3235">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3236">n</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3237" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3238">p</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3239">p</span><span class="MJXp-mo" id="MJXp-Span-3240" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3241">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3242" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msup" id="MJXp-Span-3243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3244" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3245" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3246" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3247">n</span><span class="MJXp-mo" id="MJXp-Span-3248" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3249" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3250" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3251">g</span><span class="MJXp-mo" id="MJXp-Span-3252" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3253">n</span><span class="MJXp-mo" id="MJXp-Span-3254" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3255" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span></span><script type="math/tex" id="MathJax-Element-332">\displaystyle g(n)=\frac n{\varphi(n)}=\prod_{p|n}\frac p{p-1},g'(n)=\lfloor g(n)\rfloor</script>.</p><p>It's easy to see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3257">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3258">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3259">s</span><span class="MJXp-mo" id="MJXp-Span-3260" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3261" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3262">N</span><span class="MJXp-mo" id="MJXp-Span-3263">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3264">N</span><span class="MJXp-mo" id="MJXp-Span-3265">+</span><span class="MJXp-mn" id="MJXp-Span-3266">1</span><span class="MJXp-mo" id="MJXp-Span-3267">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3268">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3269" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3270"><span class="MJXp-mo" id="MJXp-Span-3271" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3276">N</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3273">i</span><span class="MJXp-mo" id="MJXp-Span-3274">=</span><span class="MJXp-mn" id="MJXp-Span-3275">1</span></span></span></span></span></span></span><span class="MJXp-msup" id="MJXp-Span-3277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3278" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3279" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3280" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3281">i</span><span class="MJXp-mo" id="MJXp-Span-3282" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3283">φ</span><span class="MJXp-mo" id="MJXp-Span-3284" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3285">i</span><span class="MJXp-mo" id="MJXp-Span-3286" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-333">res=\frac{N(N+1)}2-\sum_{i=1}^Ng'(i)\varphi(i)</script>.</p><p>Let's consider how to calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3287"><span class="MJXp-msubsup" id="MJXp-Span-3288"><span class="MJXp-mo" id="MJXp-Span-3289" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3294">N</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3291">i</span><span class="MJXp-mo" id="MJXp-Span-3292">=</span><span class="MJXp-mn" id="MJXp-Span-3293">1</span></span></span></span></span></span></span><span class="MJXp-msup" id="MJXp-Span-3295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3296" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3297" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3298" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3299">i</span><span class="MJXp-mo" id="MJXp-Span-3300" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3301">φ</span><span class="MJXp-mo" id="MJXp-Span-3302" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3303">i</span><span class="MJXp-mo" id="MJXp-Span-3304" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-334">\sum_{i=1}^Ng'(i)\varphi(i)</script>.</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3305"><span class="MJXp-mrow" id="MJXp-Span-3306"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-3307">Key observation 1</span></span></span></span><script type="math/tex" id="MathJax-Element-335">\texttt{Key observation 1}</script>：if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3308"><span class="MJXp-msup" id="MJXp-Span-3309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3310" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3311" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3312" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3313">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3314">p</span><span class="MJXp-mo" id="MJXp-Span-3315" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3316" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msup" id="MJXp-Span-3317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3318" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3319" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3320" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3321">n</span><span class="MJXp-mo" id="MJXp-Span-3322" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-336">g'(np)\neq g'(n)</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3324">p</span><span class="MJXp-mo" id="MJXp-Span-3325" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3326">n</span></span></span><script type="math/tex" id="MathJax-Element-337">p\le n</script> unless <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3328">n</span><span class="MJXp-mo" id="MJXp-Span-3329" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3330">2</span><span class="MJXp-mo" id="MJXp-Span-3331" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3332">p</span><span class="MJXp-mo" id="MJXp-Span-3333" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3334">3</span></span></span><script type="math/tex" id="MathJax-Element-338">n=2,p=3</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3336">n</span><span class="MJXp-mo" id="MJXp-Span-3337" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3338">1</span><span class="MJXp-mo" id="MJXp-Span-3339" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3340">p</span><span class="MJXp-mo" id="MJXp-Span-3341" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3342">2</span></span></span><script type="math/tex" id="MathJax-Element-339">n=1,p=2</script>.</p> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3343"><span class="MJXp-mtable" id="MJXp-Span-3344"><span><span class="MJXp-mtr" id="MJXp-Span-3345" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3346" style="text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3347" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3348"></span><span class="MJXp-mo" id="MJXp-Span-3349" style="margin-left: 0.333em; margin-right: 0.333em;">∵</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3350">g</span><span class="MJXp-mo" id="MJXp-Span-3351" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3352">n</span><span class="MJXp-mo" id="MJXp-Span-3353" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3354" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mfrac" id="MJXp-Span-3355" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3356">p</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3357">p</span><span class="MJXp-mo" id="MJXp-Span-3358" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3359">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3360" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msup" id="MJXp-Span-3361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3362" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3363" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3364" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3365">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3366">p</span><span class="MJXp-mo" id="MJXp-Span-3367" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3368" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msup" id="MJXp-Span-3369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3370" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3371" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3372" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3373">n</span><span class="MJXp-mo" id="MJXp-Span-3374" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3375" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3376">1</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3377" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3378" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3379" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3380"></span><span class="MJXp-mo" id="MJXp-Span-3381" style="margin-left: 0.333em; margin-right: 0.333em;">∴</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3382">p</span><span class="MJXp-mo" id="MJXp-Span-3383" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mfrac" id="MJXp-Span-3384" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msup" id="MJXp-Span-3385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3386" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3387" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3388" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3389">n</span><span class="MJXp-mo" id="MJXp-Span-3390" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3391" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3392">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msup" id="MJXp-Span-3393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3394" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3395" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3396" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3397">n</span><span class="MJXp-mo" id="MJXp-Span-3398" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3399" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3400">1</span><span class="MJXp-mo" id="MJXp-Span-3401" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3402">g</span><span class="MJXp-mo" id="MJXp-Span-3403" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3404">n</span><span class="MJXp-mo" id="MJXp-Span-3405" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3406" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3407" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3408" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3409"></span><span class="MJXp-mo" id="MJXp-Span-3410" style="margin-left: 0.333em; margin-right: 0.333em;">∴</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3411">p</span><span class="MJXp-mo" id="MJXp-Span-3412" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mstyle" id="MJXp-Span-3413"><span class="MJXp-mfrac" id="MJXp-Span-3414" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-3415"><span class="MJXp-mo" id="MJXp-Span-3416" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mstyle" id="MJXp-Span-3417"><span class="MJXp-mfrac" id="MJXp-Span-3418" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3419">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3420">φ</span><span class="MJXp-mo" id="MJXp-Span-3421" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3422">n</span><span class="MJXp-mo" id="MJXp-Span-3423" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3424" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3425">φ</span><span class="MJXp-mo" id="MJXp-Span-3426" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3427">n</span><span class="MJXp-mo" id="MJXp-Span-3428" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3429" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3430">φ</span><span class="MJXp-mo" id="MJXp-Span-3431" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3432">n</span><span class="MJXp-mo" id="MJXp-Span-3433" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-3434"><span class="MJXp-mo" id="MJXp-Span-3435" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mstyle" id="MJXp-Span-3436"><span class="MJXp-mfrac" id="MJXp-Span-3437" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3438">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3439">φ</span><span class="MJXp-mo" id="MJXp-Span-3440" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3441">n</span><span class="MJXp-mo" id="MJXp-Span-3442" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3443" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3444">φ</span><span class="MJXp-mo" id="MJXp-Span-3445" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3446">n</span><span class="MJXp-mo" id="MJXp-Span-3447" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3448" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3449">φ</span><span class="MJXp-mo" id="MJXp-Span-3450" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3451">n</span><span class="MJXp-mo" id="MJXp-Span-3452" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3453" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3454">n</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3455" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3456" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3457" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mrow" id="MJXp-Span-3458"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-3459">let</span></span><span class="MJXp-mtext" id="MJXp-Span-3460">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3461">x</span><span class="MJXp-mo" id="MJXp-Span-3462" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3463"><span class="MJXp-mo" id="MJXp-Span-3464" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mstyle" id="MJXp-Span-3465"><span class="MJXp-mfrac" id="MJXp-Span-3466" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3467">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3468">φ</span><span class="MJXp-mo" id="MJXp-Span-3469" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3470">n</span><span class="MJXp-mo" id="MJXp-Span-3471" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3472" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3473">φ</span><span class="MJXp-mo" id="MJXp-Span-3474" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3475">n</span><span class="MJXp-mo" id="MJXp-Span-3476" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3477" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3478">φ</span><span class="MJXp-mo" id="MJXp-Span-3479" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3480">n</span><span class="MJXp-mo" id="MJXp-Span-3481" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3482" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3483">n</span><span class="MJXp-mo" id="MJXp-Span-3484" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-3485">1</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3486" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3487" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3488" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3489"></span><span class="MJXp-mo" id="MJXp-Span-3490" style="margin-left: 0.333em; margin-right: 0.333em;">∴</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3491">p</span><span class="MJXp-mo" id="MJXp-Span-3492" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mstyle" id="MJXp-Span-3493"><span class="MJXp-mfrac" id="MJXp-Span-3494" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3495">x</span><span class="MJXp-mo" id="MJXp-Span-3496" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3497">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3498">x</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3499" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3500">n</span><span class="MJXp-mo" id="MJXp-Span-3501" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3502">1</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-340"> \begin{aligned} &\because g(n)\cdot\frac p{p-1}\ge g'(np)\ge g'(n)+1\\ &\therefore p\le\frac{g'(n)+1}{g'(n)+1-g(n)}\\ &\therefore p\le\dfrac{\left\lfloor\dfrac n{\varphi(n)}\right\rfloor\varphi(n)+\varphi(n)}{\left\lfloor\dfrac n{\varphi(n)}\right\rfloor\varphi(n)+\varphi(n)-n}\\ &\texttt{let}\ x=\left\lfloor\dfrac n{\varphi(n)}\right\rfloor\varphi(n)+\varphi(n)-n\ge 1\\ &\therefore p\le\dfrac{x+n}x\le n+1\\ \end{aligned} </script></center><p>if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3504">p</span><span class="MJXp-mo" id="MJXp-Span-3505" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3506">n</span><span class="MJXp-mo" id="MJXp-Span-3507" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3508">1</span></span></span><script type="math/tex" id="MathJax-Element-341">p=n+1</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3509"><span class="MJXp-mstyle" id="MJXp-Span-3510"><span class="MJXp-mfrac" id="MJXp-Span-3511" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3512">x</span><span class="MJXp-mo" id="MJXp-Span-3513" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3514">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3515">x</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3516" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3517">n</span><span class="MJXp-mo" id="MJXp-Span-3518" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3519">1</span><span class="MJXp-mspace" id="MJXp-Span-3520" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3521" style="margin-left: 0.333em; margin-right: 0.333em;">⟹</span><span class="MJXp-mspace" id="MJXp-Span-3522" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3523">x</span><span class="MJXp-mo" id="MJXp-Span-3524" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3525">1</span><span class="MJXp-mspace" id="MJXp-Span-3526" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3527" style="margin-left: 0.333em; margin-right: 0.333em;">⟹</span><span class="MJXp-mspace" id="MJXp-Span-3528" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3529"><span class="MJXp-mo" id="MJXp-Span-3530" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-3531">1</span><span class="MJXp-mo" id="MJXp-Span-3532" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-3533"><span class="MJXp-mo" id="MJXp-Span-3534" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mstyle" id="MJXp-Span-3535"><span class="MJXp-mfrac" id="MJXp-Span-3536" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3537">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3538">ϕ</span><span class="MJXp-mo" id="MJXp-Span-3539" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3540">n</span><span class="MJXp-mo" id="MJXp-Span-3541" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3542" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span><span class="MJXp-mo" id="MJXp-Span-3543" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3544">φ</span><span class="MJXp-mo" id="MJXp-Span-3545" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3546">n</span><span class="MJXp-mo" id="MJXp-Span-3547" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3548" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3549">n</span><span class="MJXp-mo" id="MJXp-Span-3550" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3551">1</span><span class="MJXp-mspace" id="MJXp-Span-3552" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3553" style="margin-left: 0.333em; margin-right: 0.333em;">⟹</span><span class="MJXp-mspace" id="MJXp-Span-3554" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3555">φ</span><span class="MJXp-mo" id="MJXp-Span-3556" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3557">n</span><span class="MJXp-mo" id="MJXp-Span-3558" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3559" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3560">n</span><span class="MJXp-mo" id="MJXp-Span-3561" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3562">1</span></span></span><script type="math/tex" id="MathJax-Element-342">\dfrac{x+n}x=n+1\implies x=1\implies \left(1+\left\lfloor \dfrac n{\phi(n)}\right\rfloor\right)\varphi(n) = n+1 \implies \varphi(n)\mid n+1</script>.</p><p>if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3564">n</span><span class="MJXp-mo" id="MJXp-Span-3565" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-3566">2</span></span></span><script type="math/tex" id="MathJax-Element-343">n\gt 2</script> then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3568">φ</span><span class="MJXp-mo" id="MJXp-Span-3569" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3570">n</span><span class="MJXp-mo" id="MJXp-Span-3571" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3572" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-3573">2</span></span></span><script type="math/tex" id="MathJax-Element-344">\varphi(n)\ge 2</script>, but <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3575">φ</span><span class="MJXp-mo" id="MJXp-Span-3576" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3577">n</span><span class="MJXp-mo" id="MJXp-Span-3578" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3579" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3580">n</span><span class="MJXp-mo" id="MJXp-Span-3581" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3582">1</span><span class="MJXp-mo" id="MJXp-Span-3583" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3584">p</span></span></span><script type="math/tex" id="MathJax-Element-345">\varphi(n)\mid n+1=p</script>, which is contradict the fact that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3586">p</span></span></span><script type="math/tex" id="MathJax-Element-346">p</script> is a prime number.</p><p>The case of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3588">n</span><span class="MJXp-mo" id="MJXp-Span-3589" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3590">2</span></span></span><script type="math/tex" id="MathJax-Element-347">n\le 2</script> is easy to check.</p></div></div><p>Therefore, all the prime factors <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3592">p</span></span></span><script type="math/tex" id="MathJax-Element-348">p</script> that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3593"><span class="MJXp-mo" id="MJXp-Span-3594" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msqrt" id="MJXp-Span-3595"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3596">N</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-349">\gt \sqrt N</script> wouldn't change the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3597"><span class="MJXp-msup" id="MJXp-Span-3598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3599" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3600" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3601" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3602">n</span><span class="MJXp-mo" id="MJXp-Span-3603" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-350">g'(n)</script>.</p><p>Use a linear sieve to find all the prime numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3604"><span class="MJXp-mo" id="MJXp-Span-3605" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msqrt" id="MJXp-Span-3606"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3607">N</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-351">\le \sqrt N</script>, following the approach for handling composite numbers in the min25 sieve：</p><p>Let's define:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3609">s</span><span class="MJXp-mo" id="MJXp-Span-3610" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3611">n</span><span class="MJXp-mo" id="MJXp-Span-3612" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3613">k</span><span class="MJXp-mo" id="MJXp-Span-3614" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3615" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3616">φ</span><span class="MJXp-mo" id="MJXp-Span-3617" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3618">n</span><span class="MJXp-mo" id="MJXp-Span-3619" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3620"><span class="MJXp-mo" id="MJXp-Span-3621" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3622" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3623">k</span><span class="MJXp-mo" id="MJXp-Span-3624">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3625">p</span><span class="MJXp-mo" id="MJXp-Span-3626">≤</span><span class="MJXp-mo" id="MJXp-Span-3627">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-3628" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3629">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3630">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3631">⌋</span></span></span><span class="MJXp-msup" id="MJXp-Span-3632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3633" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3634" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3635" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3636">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3637">p</span><span class="MJXp-mo" id="MJXp-Span-3638" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3639" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3640">φ</span><span class="MJXp-mo" id="MJXp-Span-3641" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3642">p</span><span class="MJXp-mo" id="MJXp-Span-3643" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-352">s(n,k)=\varphi(n)\sum_{k\leq p\leq\lfloor\frac{N}{n}\rfloor}g'(np)\times\varphi(p)</script></center> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3645">S</span><span class="MJXp-mo" id="MJXp-Span-3646" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3647">n</span><span class="MJXp-mo" id="MJXp-Span-3648" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3649">k</span><span class="MJXp-mo" id="MJXp-Span-3650" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3651" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3652">s</span><span class="MJXp-mo" id="MJXp-Span-3653" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3654">n</span><span class="MJXp-mo" id="MJXp-Span-3655" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3656">k</span><span class="MJXp-mo" id="MJXp-Span-3657" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3658" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3659"><span class="MJXp-mo" id="MJXp-Span-3660" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3661" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3662">k</span><span class="MJXp-mo" id="MJXp-Span-3663">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3664">p</span><span class="MJXp-mo" id="MJXp-Span-3665">≤</span><span class="MJXp-msqrt" id="MJXp-Span-3666"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3667">N</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-3668">&amp;</span><span class="MJXp-msubsup" id="MJXp-Span-3669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3670" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3671" style="vertical-align: 0.5em;">e</span></span><span class="MJXp-mo" id="MJXp-Span-3672">≤</span><span class="MJXp-mo" id="MJXp-Span-3673">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-3674" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3675">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3676">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3677">⌋</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3678">S</span><span class="MJXp-mo" id="MJXp-Span-3679" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3680">n</span><span class="MJXp-msubsup" id="MJXp-Span-3681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3682" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3683" style="vertical-align: 0.5em;">e</span></span><span class="MJXp-mo" id="MJXp-Span-3684" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3685">p</span><span class="MJXp-mo" id="MJXp-Span-3686" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3687" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-3688" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3689">e</span><span class="MJXp-mo" id="MJXp-Span-3690" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mn" id="MJXp-Span-3691">1</span><span class="MJXp-mo" id="MJXp-Span-3692" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-msup" id="MJXp-Span-3693"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3694" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3695" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3696" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3697">n</span><span class="MJXp-msubsup" id="MJXp-Span-3698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3699" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3700" style="vertical-align: 0.5em;">e</span></span><span class="MJXp-mo" id="MJXp-Span-3701" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3702" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3703">φ</span><span class="MJXp-mo" id="MJXp-Span-3704" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3705">n</span><span class="MJXp-msubsup" id="MJXp-Span-3706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3707" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3708" style="vertical-align: 0.5em;">e</span></span><span class="MJXp-mo" id="MJXp-Span-3709" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-353">S(n,k)=s(n,k)+\sum_{k\leq p\leq\sqrt N\And p^e\leq\lfloor\frac{N}{n}\rfloor}S(np^e,p)+[e\neq 1]g'(np^e)\times\varphi(np^e)</script></center><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3711">p</span><span class="MJXp-mo" id="MJXp-Span-3712" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mfrac" id="MJXp-Span-3713" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3714">n</span><span class="MJXp-mo" id="MJXp-Span-3715">+</span><span class="MJXp-mo" id="MJXp-Span-3716">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3717">φ</span><span class="MJXp-mo" id="MJXp-Span-3718">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3719">n</span><span class="MJXp-mo" id="MJXp-Span-3720">)</span><span class="MJXp-mo" id="MJXp-Span-3721">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3722">n</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3723"><span class="MJXp-mspace" id="MJXp-Span-3724" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-3725">mod</span><span class="MJXp-mspace" id="MJXp-Span-3726" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-3727" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3728">φ</span><span class="MJXp-mo" id="MJXp-Span-3729">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3730">n</span><span class="MJXp-mo" id="MJXp-Span-3731">)</span><span class="MJXp-mo" id="MJXp-Span-3732">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3733">φ</span><span class="MJXp-mo" id="MJXp-Span-3734">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3735">n</span><span class="MJXp-mo" id="MJXp-Span-3736">)</span><span class="MJXp-mo" id="MJXp-Span-3737">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3738">n</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3739"><span class="MJXp-mspace" id="MJXp-Span-3740" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-3741">mod</span><span class="MJXp-mspace" id="MJXp-Span-3742" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-3743" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3744">φ</span><span class="MJXp-mo" id="MJXp-Span-3745">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3746">n</span><span class="MJXp-mo" id="MJXp-Span-3747">)</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-354">p\leq\frac{n+(\varphi(n)-n\mod\varphi(n))}{\varphi(n)-n\mod\varphi(n)}</script>, there is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3748"><span class="MJXp-msup" id="MJXp-Span-3749"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3750" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3751" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3752" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3753">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3754">p</span><span class="MJXp-mo" id="MJXp-Span-3755" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3756" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msup" id="MJXp-Span-3757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3758" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3759" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3760" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3761">n</span><span class="MJXp-mo" id="MJXp-Span-3762" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3763" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3764">1</span></span></span><script type="math/tex" id="MathJax-Element-355">g'(np)=g'(n)+1</script>, otherwise <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3765"><span class="MJXp-msup" id="MJXp-Span-3766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3767" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3768" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3769" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3770">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3771">p</span><span class="MJXp-mo" id="MJXp-Span-3772" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3773" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msup" id="MJXp-Span-3774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3775" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3776" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3777" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3778">n</span><span class="MJXp-mo" id="MJXp-Span-3779" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-356">g'(np)=g'(n)</script>.</p><p>Pre-calculate the prefix of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3781">φ</span><span class="MJXp-mo" id="MJXp-Span-3782" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3783">p</span><span class="MJXp-mo" id="MJXp-Span-3784" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-357">\varphi(p)</script> among prime numbers, we can calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3786">s</span><span class="MJXp-mo" id="MJXp-Span-3787" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3788">n</span><span class="MJXp-mo" id="MJXp-Span-3789" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3790">k</span><span class="MJXp-mo" id="MJXp-Span-3791" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-358">s(n,k)</script> like this:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3793">s</span><span class="MJXp-mo" id="MJXp-Span-3794" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3795">n</span><span class="MJXp-mo" id="MJXp-Span-3796" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3797">k</span><span class="MJXp-mo" id="MJXp-Span-3798" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3799" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3800">φ</span><span class="MJXp-mo" id="MJXp-Span-3801" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3802">n</span><span class="MJXp-mo" id="MJXp-Span-3803" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3804" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mrow" id="MJXp-Span-3805"><span class="MJXp-mo" id="MJXp-Span-3806" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.6em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.4em; margin-left: -0.17em;">(</span></span><span class="MJXp-msup" id="MJXp-Span-3807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3808" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3809" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3810" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3811">n</span><span class="MJXp-mo" id="MJXp-Span-3812" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3813"><span class="MJXp-mo" id="MJXp-Span-3814" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3815" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3816">k</span><span class="MJXp-mo" id="MJXp-Span-3817">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3818">p</span><span class="MJXp-mo" id="MJXp-Span-3819">≤</span><span class="MJXp-mo" id="MJXp-Span-3820">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-3821" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3822">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3823">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3824">⌋</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3825">φ</span><span class="MJXp-mo" id="MJXp-Span-3826" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3827">p</span><span class="MJXp-mo" id="MJXp-Span-3828" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3829" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3830"><span class="MJXp-mo" id="MJXp-Span-3831" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3832" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3833">k</span><span class="MJXp-mo" id="MJXp-Span-3834">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3835">p</span><span class="MJXp-mo" id="MJXp-Span-3836">≤</span><span class="MJXp-mo" id="MJXp-Span-3837">min</span><span class="MJXp-mrow" id="MJXp-Span-3838"><span class="MJXp-mo" id="MJXp-Span-3839" style="vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-3840" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3841">n</span><span class="MJXp-mo" id="MJXp-Span-3842">+</span><span class="MJXp-mo" id="MJXp-Span-3843">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3844">φ</span><span class="MJXp-mo" id="MJXp-Span-3845">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3846">n</span><span class="MJXp-mo" id="MJXp-Span-3847">)</span><span class="MJXp-mo" id="MJXp-Span-3848">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3849">n</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3850"><span class="MJXp-mspace" id="MJXp-Span-3851" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-3852">mod</span><span class="MJXp-mspace" id="MJXp-Span-3853" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-3854" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3855">φ</span><span class="MJXp-mo" id="MJXp-Span-3856">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3857">n</span><span class="MJXp-mo" id="MJXp-Span-3858">)</span><span class="MJXp-mo" id="MJXp-Span-3859">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3860">φ</span><span class="MJXp-mo" id="MJXp-Span-3861">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3862">n</span><span class="MJXp-mo" id="MJXp-Span-3863">)</span><span class="MJXp-mo" id="MJXp-Span-3864">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3865">n</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3866"><span class="MJXp-mspace" id="MJXp-Span-3867" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-3868">mod</span><span class="MJXp-mspace" id="MJXp-Span-3869" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-3870" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3871">φ</span><span class="MJXp-mo" id="MJXp-Span-3872">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3873">n</span><span class="MJXp-mo" id="MJXp-Span-3874">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3875">,</span><span class="MJXp-mo" id="MJXp-Span-3876">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-3877" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3878">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3879">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3880">⌋</span><span class="MJXp-mo" id="MJXp-Span-3881" style="vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3882">φ</span><span class="MJXp-mo" id="MJXp-Span-3883" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3884">p</span><span class="MJXp-mo" id="MJXp-Span-3885" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3886" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.6em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.4em; margin-left: -0.17em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-359">s(n,k)=\varphi(n)\times\left(g'(n)\sum_{k\leq p\leq\lfloor\frac{N}{n}\rfloor}\varphi(p)+\sum_{k\leq p\leq\min\left(\frac{n+(\varphi(n)-n\mod\varphi(n))}{\varphi(n)-n\mod\varphi(n)},\lfloor\frac{N}{n}\rfloor\right)}\varphi(p)\right)</script></center><p>The answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3887"><span class="MJXp-mfrac" id="MJXp-Span-3888" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3889">N</span><span class="MJXp-mo" id="MJXp-Span-3890">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3891">N</span><span class="MJXp-mo" id="MJXp-Span-3892">+</span><span class="MJXp-mn" id="MJXp-Span-3893">1</span><span class="MJXp-mo" id="MJXp-Span-3894">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3895">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3896" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3897">1</span><span class="MJXp-mo" id="MJXp-Span-3898" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3899">S</span><span class="MJXp-mo" id="MJXp-Span-3900" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3901">1</span><span class="MJXp-mo" id="MJXp-Span-3902" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3903">1</span><span class="MJXp-mo" id="MJXp-Span-3904" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-360">\frac{N(N+1)}{2}-1-S(1,1)</script>.</p><p>With time complexity <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3905"><span class="MJXp-mrow" id="MJXp-Span-3906"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3907">O</span></span><span class="MJXp-mrow" id="MJXp-Span-3908"><span class="MJXp-mo" id="MJXp-Span-3909" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-3910" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3912" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3913" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-3914">0.75</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3915">log</span><span class="MJXp-mo" id="MJXp-Span-3916"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3917">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3918" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-361">\mathcal O\left(\frac{n^{0.75}}{\log n}\right)</script>, it could pass the test cases of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3919"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3920">N</span><span class="MJXp-mo" id="MJXp-Span-3921" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-3922"><span class="MJXp-mn" id="MJXp-Span-3923" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3924" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-3925">11</span></span></span></span></span><script type="math/tex" id="MathJax-Element-362">N\le 10^{11}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;cmath&gt;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ull</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> M</span><span class="pun">=</span><span class="lit">1e6</span><span class="pun">+</span><span class="lit">5</span><span class="pun">;</span><span class="pln">
ull N</span><span class="pun">;</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> ANS</span><span class="pun">[</span><span class="lit">11</span><span class="pun">]={</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">6</span><span class="pun">,</span><span class="lit">8</span><span class="pun">};</span><span class="pln">
</span><span class="kwd">uint</span><span class="pln"> B</span><span class="pun">,</span><span class="pln">n4</span><span class="pun">,</span><span class="pln">top</span><span class="pun">,</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">M</span><span class="pun">],</span><span class="pln">F0</span><span class="pun">[</span><span class="pln">M</span><span class="pun">],</span><span class="pln">F1</span><span class="pun">[</span><span class="pln">M</span><span class="pun">],</span><span class="pln">G0</span><span class="pun">[</span><span class="pln">M</span><span class="pun">],</span><span class="pln">G1</span><span class="pun">[</span><span class="pln">M</span><span class="pun">],</span><span class="pln">SF</span><span class="pun">[</span><span class="pln">M</span><span class="pun">],</span><span class="pln">SG</span><span class="pun">[</span><span class="pln">M</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ull </span><span class="typ">Div</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">m</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">double</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)/</span><span class="pln">m</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ull min</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">b</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">&gt;</span><span class="pln">b</span><span class="pun">?</span><span class="pln">b</span><span class="pun">:</span><span class="pln">a</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> DFS</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">phi</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">=</span><span class="typ">Div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">g</span><span class="pun">=</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">*</span><span class="lit">1.</span><span class="pun">/</span><span class="pln">phi</span><span class="pun">),&amp;</span><span class="pln">R</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="typ">Div</span><span class="pun">((</span><span class="pln">g</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)*</span><span class="pln">phi</span><span class="pun">,(</span><span class="pln">g</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)*</span><span class="pln">phi</span><span class="pun">-</span><span class="pln">n</span><span class="pun">),</span><span class="pln">min</span><span class="pun">(</span><span class="pln">ull</span><span class="pun">(</span><span class="pln">B</span><span class="pun">),</span><span class="pln">T</span><span class="pun">));</span><span class="pln">
	</span><span class="kwd">uint</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">k</span><span class="pun">&gt;</span><span class="pln">top</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">=</span><span class="pln">T</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">?</span><span class="lit">0</span><span class="pun">:</span><span class="pln">g</span><span class="pun">*</span><span class="pln">phi</span><span class="pun">*(</span><span class="pln">SF</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]-</span><span class="pln">SG</span><span class="pun">[</span><span class="pln">B</span><span class="pun">]);</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]&gt;</span><span class="pln">T</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]&lt;=</span><span class="pln">R</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">=</span><span class="pln">g</span><span class="pun">*</span><span class="pln">phi</span><span class="pun">*((</span><span class="pln">n</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">?</span><span class="pln">SF</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">SG</span><span class="pun">[</span><span class="pln">T</span><span class="pun">])-</span><span class="pln">SG</span><span class="pun">[</span><span class="pln">R</span><span class="pun">])+(</span><span class="pln">g</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)*</span><span class="pln">phi</span><span class="pun">*(</span><span class="pln">SG</span><span class="pun">[</span><span class="pln">R</span><span class="pun">]-</span><span class="pln">SG</span><span class="pun">[</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]]);</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">=</span><span class="pln">g</span><span class="pun">*</span><span class="pln">phi</span><span class="pun">*((</span><span class="pln">n</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">?</span><span class="pln">SF</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">SG</span><span class="pun">[</span><span class="pln">T</span><span class="pun">])-</span><span class="pln">SG</span><span class="pun">[</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]]);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">top</span><span class="pun">;++</span><span class="pln">k</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">=</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">],&amp;</span><span class="pln">w</span><span class="pun">=</span><span class="pln">p</span><span class="pun">&lt;=</span><span class="pln">R</span><span class="pun">?</span><span class="pln">g</span><span class="pun">+</span><span class="lit">1</span><span class="pun">:</span><span class="pln">g</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="lit">1ull</span><span class="pun">*</span><span class="pln">p</span><span class="pun">*</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln">T</span><span class="pun">)</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ull x</span><span class="pun">=</span><span class="pln">n</span><span class="pun">,</span><span class="pln">tp</span><span class="pun">=</span><span class="pln">phi</span><span class="pun">*(</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">x</span><span class="pun">*</span><span class="pln">p</span><span class="pun">&lt;=</span><span class="pln">N</span><span class="pun">;</span><span class="pln">tp</span><span class="pun">*=</span><span class="pln">p</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">+=</span><span class="pln">DFS</span><span class="pun">(</span><span class="pln">x</span><span class="pun">*=</span><span class="pln">p</span><span class="pun">,</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">tp</span><span class="pun">)+</span><span class="pln">w</span><span class="pun">*</span><span class="pln">tp</span><span class="pun">;</span><span class="pln">
		ans</span><span class="pun">-=</span><span class="pln">w</span><span class="pun">*</span><span class="pln">phi</span><span class="pun">*(</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%llu"</span><span class="pun">,&amp;</span><span class="pln">N</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">N</span><span class="pun">&lt;=</span><span class="lit">10</span><span class="pun">)</span><span class="kwd">return</span><span class="pun">!</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln">ANS</span><span class="pun">[</span><span class="pln">N</span><span class="pun">]);</span><span class="pln">B</span><span class="pun">=</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">N</span><span class="pun">);</span><span class="pln">n4</span><span class="pun">=</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">B</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">w</span><span class="pun">=</span><span class="typ">Div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		F0</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">w</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">F1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">w</span><span class="pun">*(</span><span class="pln">w</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		G0</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">G1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">*(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1ull</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> p</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">p</span><span class="pun">&lt;=</span><span class="pln">n4</span><span class="pun">;++</span><span class="pln">p</span><span class="pun">)</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">G0</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]!=</span><span class="pln">G0</span><span class="pun">[</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]){</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">lim</span><span class="pun">=</span><span class="typ">Div</span><span class="pun">(</span><span class="pln">B</span><span class="pun">,</span><span class="pln">p</span><span class="pun">),&amp;</span><span class="pln">S0</span><span class="pun">=</span><span class="pln">G0</span><span class="pun">[</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],&amp;</span><span class="pln">S1</span><span class="pun">=</span><span class="pln">G1</span><span class="pun">[</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">];</span><span class="pln">pri</span><span class="pun">[++</span><span class="pln">top</span><span class="pun">]=</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">lim</span><span class="pun">;++</span><span class="pln">k</span><span class="pun">){</span><span class="pln">
			F0</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-=</span><span class="pln">F0</span><span class="pun">[</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">]-</span><span class="pln">S0</span><span class="pun">;</span><span class="pln">F1</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-=</span><span class="pln">p</span><span class="pun">*(</span><span class="pln">F1</span><span class="pun">[</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">]-</span><span class="pln">S1</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">lim</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">;++</span><span class="pln">k</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">=</span><span class="typ">Div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">);</span><span class="pln">F0</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-=</span><span class="pln">G0</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]-</span><span class="pln">S0</span><span class="pun">;</span><span class="pln">F1</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-=</span><span class="pln">p</span><span class="pun">*(</span><span class="pln">G1</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]-</span><span class="pln">S1</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">B</span><span class="pun">,</span><span class="pln">e</span><span class="pun">=</span><span class="pln">lim</span><span class="pun">;</span><span class="pln">e</span><span class="pun">&gt;=</span><span class="pln">p</span><span class="pun">;--</span><span class="pln">e</span><span class="pun">)</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> x</span><span class="pun">=</span><span class="pln">e</span><span class="pun">*</span><span class="pln">p</span><span class="pun">,</span><span class="pln">V0</span><span class="pun">=</span><span class="pln">G0</span><span class="pun">[</span><span class="pln">e</span><span class="pun">]-</span><span class="pln">S0</span><span class="pun">,</span><span class="pln">V1</span><span class="pun">=</span><span class="pln">p</span><span class="pun">*(</span><span class="pln">G1</span><span class="pun">[</span><span class="pln">e</span><span class="pun">]-</span><span class="pln">S1</span><span class="pun">);</span><span class="pln">k</span><span class="pun">&gt;=</span><span class="pln">x</span><span class="pun">;--</span><span class="pln">k</span><span class="pun">){</span><span class="pln">
			G0</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-=</span><span class="pln">V0</span><span class="pun">;</span><span class="pln">G1</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-=</span><span class="pln">V1</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> p</span><span class="pun">=</span><span class="pln">n4</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">p</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">;++</span><span class="pln">p</span><span class="pun">)</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">G0</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]!=</span><span class="pln">G0</span><span class="pun">[</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]){</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">lim</span><span class="pun">=</span><span class="typ">Div</span><span class="pun">(</span><span class="pln">B</span><span class="pun">,</span><span class="pln">p</span><span class="pun">),&amp;</span><span class="pln">T</span><span class="pun">=</span><span class="typ">Div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="lit">1ll</span><span class="pun">*</span><span class="pln">p</span><span class="pun">*</span><span class="pln">p</span><span class="pun">),&amp;</span><span class="pln">S0</span><span class="pun">=</span><span class="pln">G0</span><span class="pun">[</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],&amp;</span><span class="pln">S1</span><span class="pun">=</span><span class="pln">G1</span><span class="pun">[</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">];</span><span class="pln">pri</span><span class="pun">[++</span><span class="pln">top</span><span class="pun">]=</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">lim</span><span class="pun">;++</span><span class="pln">k</span><span class="pun">){</span><span class="pln">
			F0</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-=</span><span class="pln">F0</span><span class="pun">[</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">]-</span><span class="pln">S0</span><span class="pun">;</span><span class="pln">F1</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-=</span><span class="pln">p</span><span class="pun">*(</span><span class="pln">F1</span><span class="pun">[</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">]-</span><span class="pln">S1</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">lim</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">T</span><span class="pun">;++</span><span class="pln">k</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">=</span><span class="typ">Div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">k</span><span class="pun">*</span><span class="pln">p</span><span class="pun">);</span><span class="pln">F0</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-=</span><span class="pln">G0</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]-</span><span class="pln">S0</span><span class="pun">;</span><span class="pln">F1</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-=</span><span class="pln">p</span><span class="pun">*(</span><span class="pln">G1</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]-</span><span class="pln">S1</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">SF</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">F1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-</span><span class="pln">F0</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">SG</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">G1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-</span><span class="pln">G0</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
	printf</span><span class="pun">(</span><span class="str">"%u"</span><span class="pun">,</span><span class="pln">N</span><span class="pun">*(</span><span class="pln">N</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">-</span><span class="lit">1</span><span class="pun">-</span><span class="pln">DFS</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">));</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2081/problem/G2" title="Codeforces Round 1010 (Div. 1, Unrated)">2081G2 - Hard Formula (Hard Version)</a> <br> Idea: <a class="rated-user user-blue" href="https://codeforces.com/profile/Prean" title="Expert Prean">Prean</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Consider the DFS structure of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3926"><span class="MJXp-mo" id="MJXp-Span-3927" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mn" id="MJXp-Span-3928">25</span></span></span><script type="math/tex" id="MathJax-Element-363">\min 25</script> sieve.</p><p>What kind of nodes are important?</p><p>How many of nodes are important?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Consider using Du Sieve to get some important functions.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>For further optimization, let's consider the DFS tree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3929"><span class="MJXp-mo" id="MJXp-Span-3930" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mn" id="MJXp-Span-3931">25</span></span></span><script type="math/tex" id="MathJax-Element-364">\min25</script> sieve: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3933">N</span></span></span><script type="math/tex" id="MathJax-Element-365">N</script> vertices, rooted on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3934"><span class="MJXp-mn" id="MJXp-Span-3935">1</span></span></span><script type="math/tex" id="MathJax-Element-366">1</script>, the father of a node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3937">d</span></span></span><script type="math/tex" id="MathJax-Element-367">d</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3938"><span class="MJXp-mfrac" id="MJXp-Span-3939" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3940">d</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mtext" id="MJXp-Span-3941">maxp</span><span class="MJXp-mo" id="MJXp-Span-3942">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3943">d</span><span class="MJXp-mo" id="MJXp-Span-3944">)</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-368">\frac{d}{\text{maxp}(d)}</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3945"><span class="MJXp-mtext" id="MJXp-Span-3946">maxp</span><span class="MJXp-mo" id="MJXp-Span-3947" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3948">d</span><span class="MJXp-mo" id="MJXp-Span-3949" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-369">\text{maxp}(d)</script> denotes the maximum prime factor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3951">d</span></span></span><script type="math/tex" id="MathJax-Element-370">d</script>.</p><p>Consider all the positions <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3953">d</span></span></span><script type="math/tex" id="MathJax-Element-371">d</script> that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3954"><span class="MJXp-msup" id="MJXp-Span-3955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3956" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3957" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3958" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3959">d</span><span class="MJXp-mo" id="MJXp-Span-3960" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3961" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msup" id="MJXp-Span-3962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3963" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3964" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3965" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3966">f</span><span class="MJXp-msubsup" id="MJXp-Span-3967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3968" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3969" style="vertical-align: -0.4em;">d</span></span><span class="MJXp-mo" id="MJXp-Span-3970" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-372">g'(d)\neq g'(fa_d)</script>. Let's divide them into two cases:</p> <ol>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3972">d</span></span></span><script type="math/tex" id="MathJax-Element-373">d</script> is a leaf, which means <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3974">d</span><span class="MJXp-mo" id="MJXp-Span-3975" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3976">N</span><span class="MJXp-mo" id="MJXp-Span-3977" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3978">d</span><span class="MJXp-mo" id="MJXp-Span-3979" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi" id="MJXp-Span-3980">maxp</span><span class="MJXp-mo" id="MJXp-Span-3981" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3982" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3983">d</span><span class="MJXp-mo" id="MJXp-Span-3984" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-374">d\le N\lt d\times \operatorname{maxp}(d)</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3986">d</span></span></span><script type="math/tex" id="MathJax-Element-375">d</script> is not a leaf, which means <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3988">d</span><span class="MJXp-mo" id="MJXp-Span-3989" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi" id="MJXp-Span-3990">maxp</span><span class="MJXp-mo" id="MJXp-Span-3991" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3992" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3993">d</span><span class="MJXp-mo" id="MJXp-Span-3994" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3995" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3996">N</span></span></span><script type="math/tex" id="MathJax-Element-376">d\times \operatorname{maxp}(d)\le N</script>.</li> </ol><p>The answer could be calculated like this:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3997"><span class="MJXp-msubsup" id="MJXp-Span-3998"><span class="MJXp-mo" id="MJXp-Span-3999" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4000" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-4001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4002" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4003" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4004">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4005">d</span><span class="MJXp-mo" id="MJXp-Span-4006">)</span><span class="MJXp-mo" id="MJXp-Span-4007">≠</span><span class="MJXp-msup" id="MJXp-Span-4008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4009" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4010" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4011">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4012">f</span><span class="MJXp-msubsup" id="MJXp-Span-4013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4014" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4015" style="vertical-align: -0.4em;">d</span></span><span class="MJXp-mo" id="MJXp-Span-4016">)</span><span class="MJXp-mtext" id="MJXp-Span-4017">&nbsp;or&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4018">d</span><span class="MJXp-mo" id="MJXp-Span-4019">=</span><span class="MJXp-mn" id="MJXp-Span-4020">1</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4021">G</span><span class="MJXp-mo" id="MJXp-Span-4022" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-4023" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4024">d</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-4025"><span class="MJXp-mi" id="MJXp-Span-4026">m</span><span class="MJXp-mi" id="MJXp-Span-4027">a</span><span class="MJXp-mi" id="MJXp-Span-4028">x</span><span class="MJXp-mi" id="MJXp-Span-4029">p</span></span><span class="MJXp-mo" id="MJXp-Span-4030">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4031">d</span><span class="MJXp-mo" id="MJXp-Span-4032">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4033" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-4034"><span class="MJXp-mi" id="MJXp-Span-4035">m</span><span class="MJXp-mi" id="MJXp-Span-4036">a</span><span class="MJXp-mi" id="MJXp-Span-4037">x</span><span class="MJXp-mi" id="MJXp-Span-4038">p</span></span><span class="MJXp-mo" id="MJXp-Span-4039" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4040">d</span><span class="MJXp-mo" id="MJXp-Span-4041" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4042" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-377">\sum_{g'(d)\neq g'(fa_d)\text{ or }d=1}G(\frac{d}{\mathrm{maxp}(d)},\mathrm{maxp}(d))</script></center><p>where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4044">G</span><span class="MJXp-mo" id="MJXp-Span-4045" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4046">d</span><span class="MJXp-mo" id="MJXp-Span-4047" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4048">p</span><span class="MJXp-mo" id="MJXp-Span-4049" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-378">G(d,p)</script> denotes the sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4051">φ</span></span></span><script type="math/tex" id="MathJax-Element-379">\varphi</script> in the subtree of node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4053">d</span></span></span><script type="math/tex" id="MathJax-Element-380">d</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4055">G</span><span class="MJXp-mo" id="MJXp-Span-4056" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4057">d</span><span class="MJXp-mo" id="MJXp-Span-4058" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4059">p</span><span class="MJXp-mo" id="MJXp-Span-4060" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-381">G(d,p)</script> could be calculated like this:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4061"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4062">G</span><span class="MJXp-mo" id="MJXp-Span-4063" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4064">d</span><span class="MJXp-mo" id="MJXp-Span-4065" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4066">p</span><span class="MJXp-mo" id="MJXp-Span-4067" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4068" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4069">φ</span><span class="MJXp-mo" id="MJXp-Span-4070" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4071">d</span><span class="MJXp-mo" id="MJXp-Span-4072" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4073"><span class="MJXp-mo" id="MJXp-Span-4074" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.42em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -1.05em;"><span class="MJXp-mrow" id="MJXp-Span-4079"><span class="MJXp-mo" id="MJXp-Span-4080">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-4081" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4082">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4083">d</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4084">⌋</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.55em;"><span class="MJXp-mrow" id="MJXp-Span-4075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4076">i</span><span class="MJXp-mo" id="MJXp-Span-4077">=</span><span class="MJXp-mn" id="MJXp-Span-4078">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4085" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-4086"><span class="MJXp-mi" id="MJXp-Span-4087">m</span><span class="MJXp-mi" id="MJXp-Span-4088">i</span><span class="MJXp-mi" id="MJXp-Span-4089">n</span><span class="MJXp-mi" id="MJXp-Span-4090">p</span></span><span class="MJXp-mo" id="MJXp-Span-4091" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4092">i</span><span class="MJXp-mo" id="MJXp-Span-4093" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4094" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4095">p</span><span class="MJXp-mo" id="MJXp-Span-4096" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4097">φ</span><span class="MJXp-mo" id="MJXp-Span-4098" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4099">i</span><span class="MJXp-mo" id="MJXp-Span-4100" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-382">G(d,p)=\varphi(d)\sum_{i=1}^{\lfloor\frac{N}{d}\rfloor}[\mathrm{minp}(i)=p]\varphi(i)</script></center><p>We could use DFS to search all the nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4102">d</span></span></span><script type="math/tex" id="MathJax-Element-383">d</script> which satisfy case 2, and we can calculate its contribution to the answer during our DFS.</p><p>For a non-leaf node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4104">u</span></span></span><script type="math/tex" id="MathJax-Element-384">u</script>, let's consider its child nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4106">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4107">p</span></span></span><script type="math/tex" id="MathJax-Element-385">up</script> which satisfy case 1.</p><p>It's easy to see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4109">p</span></span></span><script type="math/tex" id="MathJax-Element-386">p</script> is in an interval, which allows <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4111">O</span><span class="MJXp-mo" id="MJXp-Span-4112" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4113">1</span><span class="MJXp-mo" id="MJXp-Span-4114" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-387">O(1)</script> calculation of the contributions of these nodes.</p><p>As a result, we get the number of nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4116">d</span></span></span><script type="math/tex" id="MathJax-Element-388">d</script>.</p> <div class="spoiler"><b class="spoiler-title">DFS Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">//pi[n] means the number of prime number &lt;=n</span><span class="pln">
</span><span class="com">//Sp[k] The prefix sum of phi(p) among the first k prime numbers</span><span class="pln">
</span><span class="com">//g[k]=(pri[k]-1.0)/pri[k]</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ull div</span><span class="pun">(</span><span class="pln">ull n</span><span class="pun">,</span><span class="pln">ull m</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> n</span><span class="pun">*</span><span class="lit">1.</span><span class="pun">/</span><span class="pln">m</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> check</span><span class="pun">(</span><span class="kwd">double</span><span class="pln"> P</span><span class="pun">,</span><span class="pln">ull n</span><span class="pun">,</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">){</span><span class="pln">
    ull x</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">P</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">&amp;&amp;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">&amp;&amp;</span><span class="pln">x</span><span class="pun">*</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]&lt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln">P</span><span class="pun">*=</span><span class="pln">g</span><span class="pun">[</span><span class="pln">k</span><span class="pun">],</span><span class="pln">x</span><span class="pun">*=</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">++];</span><span class="kwd">return</span><span class="pln"> P</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">bool</span><span class="pln"> DFS1</span><span class="pun">(</span><span class="pln">ull n</span><span class="pun">,</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">,</span><span class="pln">ull phi</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> ull T</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> w</span><span class="pun">=</span><span class="kwd">int</span><span class="pun">(</span><span class="lit">1.</span><span class="pun">*</span><span class="pln">n</span><span class="pun">/</span><span class="pln">phi</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> 
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">w</span><span class="pun">*</span><span class="pln">phi</span><span class="pun">*</span><span class="lit">1.</span><span class="pun">/</span><span class="pln">n</span><span class="pun">,</span><span class="pln">T</span><span class="pun">,</span><span class="pln">k</span><span class="pun">))</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
	</span><span class="com">//if the g' would not change in the subtree, return directly</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> R</span><span class="pun">=</span><span class="pln">pi</span><span class="pun">[</span><span class="pln">min</span><span class="pun">(</span><span class="pln">div</span><span class="pun">(</span><span class="pln">w</span><span class="pun">*</span><span class="pln">phi</span><span class="pun">,</span><span class="pln">w</span><span class="pun">*</span><span class="pln">phi</span><span class="pun">-</span><span class="pln">n</span><span class="pun">),</span><span class="pln">min</span><span class="pun">(</span><span class="pln">ull</span><span class="pun">(</span><span class="pln">B</span><span class="pun">),</span><span class="pln">T</span><span class="pun">))];</span><span class="pln">
    </span><span class="com">//g(n)*p/(p-1)&gt;=int(g(n))+1</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">;++</span><span class="pln">k</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">=</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">*</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln">T</span><span class="pun">)</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">R</span><span class="pun">)</span><span class="pln">d</span><span class="pun">[</span><span class="pln">k</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">nb</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">phi</span><span class="pun">)),</span><span class="pln">n</span><span class="pun">*</span><span class="pln">p</span><span class="pun">&lt;=</span><span class="pln">K</span><span class="pun">&amp;&amp;(</span><span class="pln">lim</span><span class="pun">=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">lim</span><span class="pun">,</span><span class="pln">k</span><span class="pun">));</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ull x</span><span class="pun">=</span><span class="pln">n</span><span class="pun">,</span><span class="pln">tp</span><span class="pun">=</span><span class="pln">phi</span><span class="pun">*(</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">x</span><span class="pun">*</span><span class="pln">p</span><span class="pun">&lt;=</span><span class="pln">N</span><span class="pun">;</span><span class="pln">tp</span><span class="pun">*=</span><span class="pln">p</span><span class="pun">)</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">DFS1</span><span class="pun">(</span><span class="pln">x</span><span class="pun">*=</span><span class="pln">p</span><span class="pun">,</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">tp</span><span class="pun">))</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
		</span><span class="com">//The subtree of np^e is isomorphic to the subtree of np^(e+1) , so if we didn't find in the previous one, we do not need to dfs into the latter one</span><span class="pln">
		</span><span class="com">//This will not effect the efficiency significantly since dfs is not the efficiency bottleneck</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">R</span><span class="pun">)</span><span class="pln">sum</span><span class="pun">+=</span><span class="pln">phi</span><span class="pun">*(</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">R</span><span class="pun">]-</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">k</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
	</span><span class="com">//The contribution of its child nodes which is leaf</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <table class="bordertable">   <thead>     <tr>       <th align="center"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4118">N</span></span></span><script type="math/tex" id="MathJax-Element-389">N</script> </th>       <th align="center">The number of non-leaf nodes satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4119"><span class="MJXp-msup" id="MJXp-Span-4120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4121" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4122" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4123" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4124">d</span><span class="MJXp-mo" id="MJXp-Span-4125" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4126" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msup" id="MJXp-Span-4127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4128" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4129" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4130" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4131">f</span><span class="MJXp-msubsup" id="MJXp-Span-4132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4133" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4134" style="vertical-align: -0.4em;">d</span></span><span class="MJXp-mo" id="MJXp-Span-4135" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-390">g'(d)\neq g'(fa_d)</script> </th>       <th align="center">Time to DFS (tested in i9-14900HX) </th>     </tr>   </thead>   <tbody>     <tr>       <td align="center"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4136"><span class="MJXp-msubsup" id="MJXp-Span-4137"><span class="MJXp-mn" id="MJXp-Span-4138" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4139" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-4140">10</span></span></span></span></span><script type="math/tex" id="MathJax-Element-391">10^{10}</script> </td>       <td align="center">78370 </td>       <td align="center">0.007s </td>     </tr>     <tr>       <td align="center"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4141"><span class="MJXp-msubsup" id="MJXp-Span-4142"><span class="MJXp-mn" id="MJXp-Span-4143" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4144" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-4145">11</span></span></span></span></span><script type="math/tex" id="MathJax-Element-392">10^{11}</script> </td>       <td align="center">285027 </td>       <td align="center">0.021s </td>     </tr>     <tr>       <td align="center"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4146"><span class="MJXp-msubsup" id="MJXp-Span-4147"><span class="MJXp-mn" id="MJXp-Span-4148" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4149" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-4150">12</span></span></span></span></span><script type="math/tex" id="MathJax-Element-393">10^{12}</script> </td>       <td align="center">1074403 </td>       <td align="center">0.085s </td>     </tr>     <tr>       <td align="center"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4151"><span class="MJXp-msubsup" id="MJXp-Span-4152"><span class="MJXp-mn" id="MJXp-Span-4153" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4154" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-4155">13</span></span></span></span></span><script type="math/tex" id="MathJax-Element-394">10^{13}</script> </td>       <td align="center">4010656 </td>       <td align="center">0.505s </td>     </tr>   </tbody> </table><p>Let's consider how to calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4157">G</span><span class="MJXp-mo" id="MJXp-Span-4158" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4159">d</span><span class="MJXp-mo" id="MJXp-Span-4160" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4161">p</span><span class="MJXp-mo" id="MJXp-Span-4162" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-395">G(d,p)</script>. Define:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4163"><span class="MJXp-msubsup" id="MJXp-Span-4164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4165" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4166" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-4167" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4168">x</span><span class="MJXp-mo" id="MJXp-Span-4169" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4170" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4171"><span class="MJXp-mo" id="MJXp-Span-4172" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4177">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4174">i</span><span class="MJXp-mo" id="MJXp-Span-4175">=</span><span class="MJXp-mn" id="MJXp-Span-4176">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4178" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-4179">minp</span><span class="MJXp-mo" id="MJXp-Span-4180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4181">i</span><span class="MJXp-mo" id="MJXp-Span-4182" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4183" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4184">k</span><span class="MJXp-mo" id="MJXp-Span-4185" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4186">φ</span><span class="MJXp-mo" id="MJXp-Span-4187" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4188">i</span><span class="MJXp-mo" id="MJXp-Span-4189" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-396">f_k(x)=\sum_{i=1}^n [\text{minp}(i)\ge k]\varphi(i)</script></center><p>where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4190"><span class="MJXp-mtext" id="MJXp-Span-4191">minp</span><span class="MJXp-mo" id="MJXp-Span-4192" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4193">i</span><span class="MJXp-mo" id="MJXp-Span-4194" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-397">\text{minp}(i)</script> denote the minimum prime number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4196">i</span></span></span><script type="math/tex" id="MathJax-Element-398">i</script>.</p><p>Then we can see that: </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4198">G</span><span class="MJXp-mo" id="MJXp-Span-4199" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4200">d</span><span class="MJXp-mo" id="MJXp-Span-4201" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4202">p</span><span class="MJXp-mo" id="MJXp-Span-4203" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4204" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4206" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4207" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-4208" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-4209" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-4210" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4211">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4212">d</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4213" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-4214" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4215" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-4216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4217" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4218" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4219">p</span><span class="MJXp-mo" id="MJXp-Span-4220">+</span><span class="MJXp-mn" id="MJXp-Span-4221">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4222" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-4223" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-4224" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4225">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4226">d</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4227" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-4228" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-399">G(d,p)=f_p(\lfloor\frac{N}{d}\rfloor)-f_{p+1}(\lfloor\frac{N}{d}\rfloor)</script></center><p>It's easy to see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4229"><span class="MJXp-msubsup" id="MJXp-Span-4230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4231" style="margin-right: 0.05em;">F</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4232" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-4233" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4234">x</span><span class="MJXp-mo" id="MJXp-Span-4235" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4236" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-4237" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4238">ζ</span><span class="MJXp-mo" id="MJXp-Span-4239">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4240">x</span><span class="MJXp-mo" id="MJXp-Span-4241">−</span><span class="MJXp-mn" id="MJXp-Span-4242">1</span><span class="MJXp-mo" id="MJXp-Span-4243">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4244">ζ</span><span class="MJXp-mo" id="MJXp-Span-4245">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4246">x</span><span class="MJXp-mo" id="MJXp-Span-4247">)</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-400">F_0(x)=\frac{\zeta(x-1)}{\zeta(x)}</script>, we can use Du Sieve to get all the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4248"><span class="MJXp-msubsup" id="MJXp-Span-4249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4250" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4251" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-4252" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-4253" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-4254" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4255">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4256">d</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4257" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-4258" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-401">f_0(\lfloor \frac Nd\rfloor)</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4260">O</span><span class="MJXp-mo" id="MJXp-Span-4261" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4263" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4264" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4265" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4266">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4267">3</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4268" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-402">O(N^{\frac 23})</script>.</p><p>According to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4269"><span class="MJXp-mrow" id="MJXp-Span-4270"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4271">Key observation 1</span></span></span></span><script type="math/tex" id="MathJax-Element-403">\texttt{Key observation 1}</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4272"><span class="MJXp-mi" id="MJXp-Span-4273">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4274">d</span><span class="MJXp-mo" id="MJXp-Span-4275" style="margin-left: 0.333em; margin-right: 0.333em;">∉</span><span class="MJXp-mrow" id="MJXp-Span-4276"><span class="MJXp-mn" id="MJXp-Span-4277">2</span><span class="MJXp-mo" id="MJXp-Span-4278" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-4279">6</span></span><span class="MJXp-mo" id="MJXp-Span-4280" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-4281"><span class="MJXp-mi" id="MJXp-Span-4282">m</span><span class="MJXp-mi" id="MJXp-Span-4283">a</span><span class="MJXp-mi" id="MJXp-Span-4284">x</span><span class="MJXp-mi" id="MJXp-Span-4285">p</span></span><span class="MJXp-mo" id="MJXp-Span-4286" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4287">d</span><span class="MJXp-mo" id="MJXp-Span-4288" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4289" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msqrt" id="MJXp-Span-4290"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4291">d</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-404">\forall d\notin{2,6},\mathrm{maxp}(d)\leq\sqrt d</script>.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4293">k</span><span class="MJXp-mo" id="MJXp-Span-4294" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4295"><span class="MJXp-mo" id="MJXp-Span-4296" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4297" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-4298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4299" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4300" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4301">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4302">d</span><span class="MJXp-mo" id="MJXp-Span-4303">)</span><span class="MJXp-mo" id="MJXp-Span-4304">≠</span><span class="MJXp-msup" id="MJXp-Span-4305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4306" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4307" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4308">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4309">f</span><span class="MJXp-msubsup" id="MJXp-Span-4310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4311" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4312" style="vertical-align: -0.4em;">d</span></span><span class="MJXp-mo" id="MJXp-Span-4313">)</span><span class="MJXp-mi" id="MJXp-Span-4314">&amp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4315">d</span><span class="MJXp-mo" id="MJXp-Span-4316">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4317">B</span></span></span><span class="MJXp-mo" id="MJXp-Span-4318" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-4319"><span class="MJXp-mi" id="MJXp-Span-4320">m</span><span class="MJXp-mi" id="MJXp-Span-4321">a</span><span class="MJXp-mi" id="MJXp-Span-4322">x</span><span class="MJXp-mi" id="MJXp-Span-4323">p</span></span><span class="MJXp-mo" id="MJXp-Span-4324" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4325">d</span><span class="MJXp-mo" id="MJXp-Span-4326" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4327" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-405">k=\max_{g'(d)\neq g'(fa_d)\And d\leq B}(\mathrm{maxp}(d))</script>, categorize these nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4329">d</span></span></span><script type="math/tex" id="MathJax-Element-406">d</script> again: </p> <ul>   <li>(i) <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4330"><span class="MJXp-mrow" id="MJXp-Span-4331"><span class="MJXp-mi" id="MJXp-Span-4332">m</span><span class="MJXp-mi" id="MJXp-Span-4333">a</span><span class="MJXp-mi" id="MJXp-Span-4334">x</span><span class="MJXp-mi" id="MJXp-Span-4335">p</span></span><span class="MJXp-mo" id="MJXp-Span-4336" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4337">d</span><span class="MJXp-mo" id="MJXp-Span-4338" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4339" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4340">k</span></span></span><script type="math/tex" id="MathJax-Element-407">\mathrm{maxp}(d)\leq k</script>, Then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4341"><span class="MJXp-mrow" id="MJXp-Span-4342"><span class="MJXp-mi" id="MJXp-Span-4343">m</span><span class="MJXp-mi" id="MJXp-Span-4344">a</span><span class="MJXp-mi" id="MJXp-Span-4345">x</span><span class="MJXp-mi" id="MJXp-Span-4346">p</span></span><span class="MJXp-mo" id="MJXp-Span-4347" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4348">d</span><span class="MJXp-mo" id="MJXp-Span-4349" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4350" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msqrt" id="MJXp-Span-4351"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4352">B</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-408">\mathrm{maxp}(d)\leq \sqrt B</script>.</li>   <li>(ii) <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4353"><span class="MJXp-mrow" id="MJXp-Span-4354"><span class="MJXp-mi" id="MJXp-Span-4355">m</span><span class="MJXp-mi" id="MJXp-Span-4356">a</span><span class="MJXp-mi" id="MJXp-Span-4357">x</span><span class="MJXp-mi" id="MJXp-Span-4358">p</span></span><span class="MJXp-mo" id="MJXp-Span-4359" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4360">d</span><span class="MJXp-mo" id="MJXp-Span-4361" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4362" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4363">k</span></span></span><script type="math/tex" id="MathJax-Element-409">\mathrm{maxp}(d)>k</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4365">B</span><span class="MJXp-mo" id="MJXp-Span-4366" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-4367"><span class="MJXp-mi" id="MJXp-Span-4368">m</span><span class="MJXp-mi" id="MJXp-Span-4369">a</span><span class="MJXp-mi" id="MJXp-Span-4370">x</span><span class="MJXp-msubsup" id="MJXp-Span-4371"><span class="MJXp-mi" id="MJXp-Span-4372" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4373" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4374" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4375">d</span><span class="MJXp-mo" id="MJXp-Span-4376" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-4377" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4378">d</span></span></span><script type="math/tex" id="MathJax-Element-410">B\leq\mathrm{maxp^2(d)}\leq d</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4379"><span class="MJXp-mo" id="MJXp-Span-4380" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-4381" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4382">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4383">d</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4384" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-4385" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mfrac" id="MJXp-Span-4386" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4387">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4388">B</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-411">\lfloor\frac{N}{d}\rfloor<\frac NB</script>.</li> </ul><p>For those <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4390">d</span></span></span><script type="math/tex" id="MathJax-Element-412">d</script> satisfy condition (i), let's begin with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4391"><span class="MJXp-msubsup" id="MJXp-Span-4392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4393" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4394" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-413">f_0</script>, delete the prime numbers from small to large, until <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4395"><span class="MJXp-msubsup" id="MJXp-Span-4396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4397" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4398" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-414">f_k</script> and calculate the contributions of these <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4400">d</span></span></span><script type="math/tex" id="MathJax-Element-415">d</script>.</p><p>We could use Dirichlet convolution to calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4401"><span class="MJXp-msubsup" id="MJXp-Span-4402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4403" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4404" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4405">p</span><span class="MJXp-mo" id="MJXp-Span-4406">+</span><span class="MJXp-mn" id="MJXp-Span-4407">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-416">f_{p+1}</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4408"><span class="MJXp-msubsup" id="MJXp-Span-4409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4410" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4411" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-417">f_p</script>.</p><p>Step 1:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4412"><span class="MJXp-msubsup" id="MJXp-Span-4413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4414" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4415" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-4416" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4417">N</span><span class="MJXp-mo" id="MJXp-Span-4418" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4419" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4421" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4422" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-4423" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4424">N</span><span class="MJXp-mo" id="MJXp-Span-4425" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4426" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4427">p</span><span class="MJXp-mo" id="MJXp-Span-4428" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-msubsup" id="MJXp-Span-4429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4430" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4431" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-4432" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-4433" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-4434" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4435">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4436">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4437" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-4438" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-418">h_p(N)=f_p(N)-p\times f_p(\lfloor\frac{N}{p}\rfloor)</script></center><p>Step 2:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4439"><span class="MJXp-msubsup" id="MJXp-Span-4440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4441" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4442" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4443">p</span><span class="MJXp-mo" id="MJXp-Span-4444">+</span><span class="MJXp-mn" id="MJXp-Span-4445">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4446" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4447">N</span><span class="MJXp-mo" id="MJXp-Span-4448" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4449" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4450"><span class="MJXp-mo" id="MJXp-Span-4451" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4452" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4453">i</span><span class="MJXp-mo" id="MJXp-Span-4454">=</span><span class="MJXp-mn" id="MJXp-Span-4455">0</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4457" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4458" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-4459" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-4460" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-4461" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4462">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4464" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4465" style="vertical-align: 0.5em;">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4466" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-4467" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4468" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4470" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4471" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-4472" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4473">N</span><span class="MJXp-mo" id="MJXp-Span-4474" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4475" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-4476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4477" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4478" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4479">p</span><span class="MJXp-mo" id="MJXp-Span-4480">+</span><span class="MJXp-mn" id="MJXp-Span-4481">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4482" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-4483" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-4484" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4485">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4486">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4487" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-4488" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-419">f_{p+1}(N)=\sum_{i=0}h_p(\lfloor\frac{N}{p^i}\rfloor)=h_p(N)+f_{p+1}(\lfloor\frac{N}{p}\rfloor)</script></center><p>These could solve in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4490">O</span><span class="MJXp-mrow" id="MJXp-Span-4491"><span class="MJXp-mo" id="MJXp-Span-4492" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.6em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.4em; margin-left: -0.17em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-4493" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-4494"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4495">N</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4496">×</span><span class="MJXp-msqrt" id="MJXp-Span-4497"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4498">B</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-4499">log</span><span class="MJXp-mo" id="MJXp-Span-4500"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4501">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4502" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.6em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.4em; margin-left: -0.17em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-420">O\left(\frac{\sqrt N \times \sqrt B}{\log n}\right)</script>.</p><p>For those <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4504">d</span></span></span><script type="math/tex" id="MathJax-Element-421">d</script> satisfy condition (ii), we calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4506">G</span><span class="MJXp-mo" id="MJXp-Span-4507" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4508">d</span><span class="MJXp-mo" id="MJXp-Span-4509" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4510">p</span><span class="MJXp-mo" id="MJXp-Span-4511" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-422">G(d,p)</script> in this method:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4512"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4513">G</span><span class="MJXp-mo" id="MJXp-Span-4514" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4515">d</span><span class="MJXp-mo" id="MJXp-Span-4516" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4517">p</span><span class="MJXp-mo" id="MJXp-Span-4518" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4519" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4520"><span class="MJXp-mo" id="MJXp-Span-4521" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4522" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4523">k</span><span class="MJXp-mo" id="MJXp-Span-4524">=</span><span class="MJXp-mn" id="MJXp-Span-4525">1</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4526">φ</span><span class="MJXp-mo" id="MJXp-Span-4527" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4528">d</span><span class="MJXp-msubsup" id="MJXp-Span-4529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4530" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4531" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-4532" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4534" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4535" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4536">p</span><span class="MJXp-mo" id="MJXp-Span-4537">+</span><span class="MJXp-mn" id="MJXp-Span-4538">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4539" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-4540" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-4541" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4542">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4543">d</span><span class="MJXp-msubsup" id="MJXp-Span-4544"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4545" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4546" style="vertical-align: 0.5em;">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4547" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-4548" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-423">G(d,p)=\sum_{k=1}\varphi(dp^k)f_{p+1}(\lfloor\frac{N}{dp^k}\rfloor)</script></center><p>Because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4550">p</span><span class="MJXp-mo" id="MJXp-Span-4551" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msqrt" id="MJXp-Span-4552"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4553">B</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-424">p\geq \sqrt B</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4555">d</span><span class="MJXp-mo" id="MJXp-Span-4556" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4557">B</span></span></span><script type="math/tex" id="MathJax-Element-425">d\geq B</script>, we only need to consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4559">k</span><span class="MJXp-mo" id="MJXp-Span-4560" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mfrac" id="MJXp-Span-4561" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-4562">log</span><span class="MJXp-mo" id="MJXp-Span-4563"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4564">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-4565">log</span><span class="MJXp-mo" id="MJXp-Span-4566"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4567">B</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-426">k\le \frac{\log N}{\log B}</script>, which is similar to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4569">O</span><span class="MJXp-mo" id="MJXp-Span-4570" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4571">1</span><span class="MJXp-mo" id="MJXp-Span-4572" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-427">O(1)</script>. </p><p>In this part, we only need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4574">f</span><span class="MJXp-mo" id="MJXp-Span-4575" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4576">x</span><span class="MJXp-mo" id="MJXp-Span-4577" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-428">f(x)</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4579">x</span><span class="MJXp-mo" id="MJXp-Span-4580" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4581">B</span></span></span><script type="math/tex" id="MathJax-Element-429">x\le B</script>, so to calculate these <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4583">f</span></span></span><script type="math/tex" id="MathJax-Element-430">f</script> is actually a two-dimensional partial order problem which can be solved using a BIT, time complexity <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4585">O</span><span class="MJXp-mo" id="MJXp-Span-4586" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-4587" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4588">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4589">B</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4590">log</span><span class="MJXp-mo" id="MJXp-Span-4591" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4592">N</span><span class="MJXp-mo" id="MJXp-Span-4593" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-431">O(\frac NB\log N)</script>.</p><p>Since for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4595">d</span></span></span><script type="math/tex" id="MathJax-Element-432">d</script>, we get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4597">G</span><span class="MJXp-mo" id="MJXp-Span-4598" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4599">d</span><span class="MJXp-mo" id="MJXp-Span-4600" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4601">p</span><span class="MJXp-mo" id="MJXp-Span-4602" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-433">G(d,p)</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4604">O</span><span class="MJXp-mo" id="MJXp-Span-4605" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4606">1</span><span class="MJXp-mo" id="MJXp-Span-4607" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-434">O(1)</script> in case (i), and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4609">O</span><span class="MJXp-mo" id="MJXp-Span-4610" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4611">log</span><span class="MJXp-mo" id="MJXp-Span-4612" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4613">N</span><span class="MJXp-mo" id="MJXp-Span-4614" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-435">O(\log N)</script> in case (ii).</p><p>The total time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4616">O</span><span class="MJXp-mrow" id="MJXp-Span-4617"><span class="MJXp-mo" id="MJXp-Span-4618" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.6em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.4em; margin-left: -0.17em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-4619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4620" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4621" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4622" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4623">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4624">3</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4625" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-4626" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-4627"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4628">N</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4629">×</span><span class="MJXp-msqrt" id="MJXp-Span-4630"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4631">B</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-4632">log</span><span class="MJXp-mo" id="MJXp-Span-4633"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4634">N</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4635" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-4636" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4637">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4638">B</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4639">log</span><span class="MJXp-mo" id="MJXp-Span-4640" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4641">N</span><span class="MJXp-mo" id="MJXp-Span-4642" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4643">D</span><span class="MJXp-mi" id="MJXp-Span-4644">log</span><span class="MJXp-mo" id="MJXp-Span-4645" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4646">N</span><span class="MJXp-mo" id="MJXp-Span-4647" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.6em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.4em; margin-left: -0.17em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-436">O\left(N^{\frac 23} + \frac{\sqrt N\times \sqrt B}{\log N}+ \frac NB\log N+D\log N\right)</script>.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4649">B</span><span class="MJXp-mo" id="MJXp-Span-4650" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4652" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4653" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4654" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4655">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4656">3</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4657"><span class="MJXp-mi" id="MJXp-Span-4658" style="margin-right: 0.05em;">log</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4659" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4660" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4661">4</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4662">3</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4663" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4664">N</span></span></span><script type="math/tex" id="MathJax-Element-437">B=N^{\frac 13}\log^{\frac 43}N</script>, the total time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4666">O</span><span class="MJXp-mrow" id="MJXp-Span-4667"><span class="MJXp-mo" id="MJXp-Span-4668" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.033em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.133em; margin-left: -0.21em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-4669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4670" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4671" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4672" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4673">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4674">3</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4675" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-4676" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4678" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4679" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4680" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4681">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4682">3</span></span></span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4683"><span class="MJXp-mi" id="MJXp-Span-4684" style="margin-right: 0.05em;">log</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4685" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4686" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4687">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4688">3</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4689"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4690">N</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4691" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4692">D</span><span class="MJXp-mi" id="MJXp-Span-4693">log</span><span class="MJXp-mo" id="MJXp-Span-4694" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4695">N</span><span class="MJXp-mo" id="MJXp-Span-4696" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.033em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.133em; margin-left: -0.21em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-438">O\left(N^{\frac 23}+ \frac{N^{\frac 23}}{\log^{\frac 13}N}+D\log N\right)</script>.</p><h3>Further optimization to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4698">n</span><span class="MJXp-mo" id="MJXp-Span-4699" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4700"><span class="MJXp-mn" id="MJXp-Span-4701" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4702" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-4703">13</span></span></span></span></span><script type="math/tex" id="MathJax-Element-439">n=10^{13}</script></h3><p>This part is included in the offline contest.</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4704"><span class="MJXp-mrow" id="MJXp-Span-4705"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4706">Key observation 2</span></span></span></span><script type="math/tex" id="MathJax-Element-440">\texttt{Key observation 2}</script> : The number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4708">i</span></span></span><script type="math/tex" id="MathJax-Element-441">i</script> in range <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4709"><span class="MJXp-mo" id="MJXp-Span-4710" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-4711">1</span><span class="MJXp-mo" id="MJXp-Span-4712" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4713">n</span><span class="MJXp-mo" id="MJXp-Span-4714" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-442">[1,n]</script> that satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4715"><span class="MJXp-mrow" id="MJXp-Span-4716"><span class="MJXp-mi" id="MJXp-Span-4717">m</span><span class="MJXp-mi" id="MJXp-Span-4718">i</span><span class="MJXp-mi" id="MJXp-Span-4719">n</span><span class="MJXp-mi" id="MJXp-Span-4720">p</span></span><span class="MJXp-mo" id="MJXp-Span-4721" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-4722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4723" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4724" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4725" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4726">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4727">4</span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-443">\mathrm{minp}\geq n^{\frac{1}{4}}</script> is of the order of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4728"><span class="MJXp-mfrac" id="MJXp-Span-4729" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4730">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-4731">ln</span><span class="MJXp-mo" id="MJXp-Span-4732"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4733">n</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-444">\frac{n}{\ln n}</script>. </p> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4735">O</span><span class="MJXp-mrow" id="MJXp-Span-4736"><span class="MJXp-mo" id="MJXp-Span-4737" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-4738"><span class="MJXp-mo" id="MJXp-Span-4739" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.924em; vertical-align: -0.704em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4753">π</span><span class="MJXp-mo" id="MJXp-Span-4754">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4755">n</span><span class="MJXp-mo" id="MJXp-Span-4756">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4741">x</span><span class="MJXp-mo" id="MJXp-Span-4742">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4743">π</span><span class="MJXp-mo" id="MJXp-Span-4744">(</span><span class="MJXp-msubsup" id="MJXp-Span-4745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4746" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4747" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4748" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4749">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4750">4</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4751">)</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4757"><span class="MJXp-mo" id="MJXp-Span-4758" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.484em; vertical-align: -0.704em;"><span class=" MJXp-script"><span><span style="margin-bottom: -1.39em;"><span class="MJXp-mrow" id="MJXp-Span-4771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4772">π</span><span class="MJXp-mo" id="MJXp-Span-4773">(</span><span class="MJXp-mfrac" id="MJXp-Span-4774" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4775">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4777" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4778" style="vertical-align: -0.4em;">x</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4779">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.55em;"><span class="MJXp-mrow" id="MJXp-Span-4759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4760">y</span><span class="MJXp-mo" id="MJXp-Span-4761">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4762">π</span><span class="MJXp-mo" id="MJXp-Span-4763">(</span><span class="MJXp-msubsup" id="MJXp-Span-4764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4765" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4766" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4767" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4768">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4769">4</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4770">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4780" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mrow" id="MJXp-Span-4781"><span class="MJXp-mo" id="MJXp-Span-4782" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4783">π</span><span class="MJXp-mo" id="MJXp-Span-4784" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-4785" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4786">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4788" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4789" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-4790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4791" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4792" style="vertical-align: -0.4em;">y</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4793" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4794" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4795">π</span><span class="MJXp-mo" id="MJXp-Span-4796" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4798" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4799" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4800" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4801">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4802">4</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4803" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4804" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-4805">0</span><span class="MJXp-mo" id="MJXp-Span-4806" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4807" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4808" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4809">O</span><span class="MJXp-mrow" id="MJXp-Span-4810"><span class="MJXp-mo" id="MJXp-Span-4811" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-4812"><span class="MJXp-mo" id="MJXp-Span-4813" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.924em; vertical-align: -0.704em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4827">π</span><span class="MJXp-mo" id="MJXp-Span-4828">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4829">n</span><span class="MJXp-mo" id="MJXp-Span-4830">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4814"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4815">x</span><span class="MJXp-mo" id="MJXp-Span-4816">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4817">π</span><span class="MJXp-mo" id="MJXp-Span-4818">(</span><span class="MJXp-msubsup" id="MJXp-Span-4819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4820" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4821" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4822" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4823">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4824">4</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4825">)</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4831">π</span><span class="MJXp-mo" id="MJXp-Span-4832" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-4833" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4834">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4836" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4837" style="vertical-align: -0.4em;">x</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4838" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4839"><span class="MJXp-mo" id="MJXp-Span-4840" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.484em; vertical-align: -0.704em;"><span class=" MJXp-script"><span><span style="margin-bottom: -1.39em;"><span class="MJXp-mrow" id="MJXp-Span-4853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4854">π</span><span class="MJXp-mo" id="MJXp-Span-4855">(</span><span class="MJXp-mfrac" id="MJXp-Span-4856" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4857">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4859" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4860" style="vertical-align: -0.4em;">x</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4861">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.55em;"><span class="MJXp-mrow" id="MJXp-Span-4841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4842">y</span><span class="MJXp-mo" id="MJXp-Span-4843">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4844">π</span><span class="MJXp-mo" id="MJXp-Span-4845">(</span><span class="MJXp-msubsup" id="MJXp-Span-4846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4847" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4848" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4849" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4850">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4851">4</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4852">)</span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-4862" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4863">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4865" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4866" style="vertical-align: -0.4em;">y</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4867" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-445">O\left(\sum_{x=\pi(n^{\frac{1}{4}})}^{\pi(n)}\sum_{y=\pi(n^{\frac{1}{4}})}^{\pi(\frac{n}{p_x})}\max\left(\pi(\frac{n}{p_xp_y})-\pi(n^{\frac{1}{4}}),0\right)\right)=O\left(\sum_{x=\pi(n^{\frac{1}{4}})}^{\pi(n)}\pi(\frac{n}{p_x})\sum_{y=\pi(n^{\frac{1}{4}})}^{\pi(\frac{n}{p_x})}\frac{1}{p_y}\right)</script></center> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4869">O</span><span class="MJXp-mrow" id="MJXp-Span-4870"><span class="MJXp-mo" id="MJXp-Span-4871" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-4872"><span class="MJXp-mo" id="MJXp-Span-4873" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4874" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4876" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4877" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4878" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4879">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4880">3</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4881">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4882">p</span><span class="MJXp-mo" id="MJXp-Span-4883">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4884">n</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-4885" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4886">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4887">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4888" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4889" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4890">O</span><span class="MJXp-mo" id="MJXp-Span-4891" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4892">log</span><span class="MJXp-mo" id="MJXp-Span-4893" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-4894">log</span><span class="MJXp-mo" id="MJXp-Span-4895" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4896">n</span><span class="MJXp-mo" id="MJXp-Span-4897" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi" id="MJXp-Span-4898">log</span><span class="MJXp-mo" id="MJXp-Span-4899" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-4900">log</span><span class="MJXp-mo" id="MJXp-Span-4901" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-4902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4903" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4904" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4905" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4906">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4907">3</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4908" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4909" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4910">O</span><span class="MJXp-mo" id="MJXp-Span-4911" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4912">log</span><span class="MJXp-mo" id="MJXp-Span-4913" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-4914">3</span><span class="MJXp-mo" id="MJXp-Span-4915" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-446">O\left(\sum_{n^{\frac{1}{3}}\leq p\leq n}\frac{1}{p}\right)=O(\log\log n-\log\log n^{\frac{1}{3}})=O(\log 3)</script></center> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4917">O</span><span class="MJXp-mrow" id="MJXp-Span-4918"><span class="MJXp-mo" id="MJXp-Span-4919" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-4920"><span class="MJXp-mo" id="MJXp-Span-4921" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.924em; vertical-align: -0.704em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4935">π</span><span class="MJXp-mo" id="MJXp-Span-4936">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4937">n</span><span class="MJXp-mo" id="MJXp-Span-4938">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4923">x</span><span class="MJXp-mo" id="MJXp-Span-4924">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4925">π</span><span class="MJXp-mo" id="MJXp-Span-4926">(</span><span class="MJXp-msubsup" id="MJXp-Span-4927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4928" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4929" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4930" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4931">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4932">4</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4933">)</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4939">π</span><span class="MJXp-mo" id="MJXp-Span-4940" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-4941" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4942">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4943"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4944" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4945" style="vertical-align: -0.4em;">x</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4946" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4947"><span class="MJXp-mo" id="MJXp-Span-4948" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.484em; vertical-align: -0.704em;"><span class=" MJXp-script"><span><span style="margin-bottom: -1.39em;"><span class="MJXp-mrow" id="MJXp-Span-4961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4962">π</span><span class="MJXp-mo" id="MJXp-Span-4963">(</span><span class="MJXp-mfrac" id="MJXp-Span-4964" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4965">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4967" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4968" style="vertical-align: -0.4em;">x</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4969">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.55em;"><span class="MJXp-mrow" id="MJXp-Span-4949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4950">y</span><span class="MJXp-mo" id="MJXp-Span-4951">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4952">π</span><span class="MJXp-mo" id="MJXp-Span-4953">(</span><span class="MJXp-msubsup" id="MJXp-Span-4954"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4955" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4956" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4957" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4958">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4959">4</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4960">)</span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-4970" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4971">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4973" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4974" style="vertical-align: -0.4em;">y</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4975" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4976" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4977">O</span><span class="MJXp-mrow" id="MJXp-Span-4978"><span class="MJXp-mo" id="MJXp-Span-4979" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-4980"><span class="MJXp-mo" id="MJXp-Span-4981" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.924em; vertical-align: -0.704em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4995">π</span><span class="MJXp-mo" id="MJXp-Span-4996">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4997">n</span><span class="MJXp-mo" id="MJXp-Span-4998">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4983">x</span><span class="MJXp-mo" id="MJXp-Span-4984">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4985">π</span><span class="MJXp-mo" id="MJXp-Span-4986">(</span><span class="MJXp-msubsup" id="MJXp-Span-4987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4988" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4989" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-4990" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4991">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4992">4</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4993">)</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4999">π</span><span class="MJXp-mo" id="MJXp-Span-5000" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-5001" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5002">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-5003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5004" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5005" style="vertical-align: -0.4em;">x</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5006" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5007" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-5008" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5009">O</span><span class="MJXp-mo" id="MJXp-Span-5010" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5011">π</span><span class="MJXp-mo" id="MJXp-Span-5012" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5013">n</span><span class="MJXp-mo" id="MJXp-Span-5014" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5015" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5016" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5017">O</span><span class="MJXp-mo" id="MJXp-Span-5018" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-5019" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5020">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-5021">log</span><span class="MJXp-mo" id="MJXp-Span-5022"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5023">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5024" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-447">O\left(\sum_{x=\pi(n^{\frac{1}{4}})}^{\pi(n)}\pi(\frac{n}{p_x})\sum_{y=\pi(n^{\frac{1}{4}})}^{\pi(\frac{n}{p_x})}\frac{1}{p_y}\right)=O\left(\sum_{x=\pi(n^{\frac{1}{4}})}^{\pi(n)}\pi(\frac{n}{p_x})\right)=O(\pi(n))=O(\frac{n}{\log n})</script></center></div></div><p>Since we only need to calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5026">G</span><span class="MJXp-mo" id="MJXp-Span-5027" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-5028" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5029">d</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5030"><span class="MJXp-mi" id="MJXp-Span-5031">m</span><span class="MJXp-mi" id="MJXp-Span-5032">a</span><span class="MJXp-mi" id="MJXp-Span-5033">x</span><span class="MJXp-mi" id="MJXp-Span-5034">p</span></span><span class="MJXp-mo" id="MJXp-Span-5035">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5036">d</span><span class="MJXp-mo" id="MJXp-Span-5037">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5038" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-5039"><span class="MJXp-mi" id="MJXp-Span-5040">m</span><span class="MJXp-mi" id="MJXp-Span-5041">a</span><span class="MJXp-mi" id="MJXp-Span-5042">x</span><span class="MJXp-mi" id="MJXp-Span-5043">p</span></span><span class="MJXp-mo" id="MJXp-Span-5044" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5045">d</span><span class="MJXp-mo" id="MJXp-Span-5046" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5047" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-448">G(\frac{d}{\mathrm{maxp}(d)},\mathrm{maxp}(d))</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5048"><span class="MJXp-mtext" id="MJXp-Span-5049">maxp</span><span class="MJXp-mo" id="MJXp-Span-5050" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5051">d</span><span class="MJXp-mo" id="MJXp-Span-5052" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5053" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msqrt" id="MJXp-Span-5054"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5055">B</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-449">\text{maxp}(d)\gt \sqrt B</script> in case (ii).</p><p>We actually only need to consider those <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5056"><span class="MJXp-mtext" id="MJXp-Span-5057">minp</span><span class="MJXp-mo" id="MJXp-Span-5058" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5059">i</span><span class="MJXp-mo" id="MJXp-Span-5060" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5061" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msqrt" id="MJXp-Span-5062"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5063">B</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-450">\text{minp}(i)\gt \sqrt B</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5065">i</span><span class="MJXp-mo" id="MJXp-Span-5066" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mfrac" id="MJXp-Span-5067" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5068">d</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mtext" id="MJXp-Span-5069">maxp</span><span class="MJXp-mo" id="MJXp-Span-5070">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5071">d</span><span class="MJXp-mo" id="MJXp-Span-5072">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5073" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mfrac" id="MJXp-Span-5074" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5075">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-5076"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5077">B</span></span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-451">i\le \frac{d}{\text{maxp}(d)}\le\frac N{\sqrt B}</script>.</p><p>Then if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5079">B</span><span class="MJXp-mo" id="MJXp-Span-5080" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-5081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5082" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5083" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5084" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5085">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5086">3</span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-452">B\gt N^{\frac 13}</script>, the actual size to append into the BIT is only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5088">O</span><span class="MJXp-mo" id="MJXp-Span-5089" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-5090" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5091">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5092">B</span><span class="MJXp-mi" id="MJXp-Span-5093">log</span><span class="MJXp-mo" id="MJXp-Span-5094"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5095">N</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5096" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-453">O(\frac{N}{B\log N})</script>, so the time complexity of case ii is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5097"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5098">O</span><span class="MJXp-mo" id="MJXp-Span-5099" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-5100" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5101">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5102">B</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5103" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-454">O(\frac NB)</script>.</p><p>Then we could adjust <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5105">B</span></span></span><script type="math/tex" id="MathJax-Element-455">B</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5106"><span class="MJXp-msubsup" id="MJXp-Span-5107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5108" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5109" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5110" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5111">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5112">3</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-5113"><span class="MJXp-mi" id="MJXp-Span-5114" style="margin-right: 0.05em;">log</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5115" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5116" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5117">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5118">3</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5119" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5120">N</span></span></span><script type="math/tex" id="MathJax-Element-456">N^{\frac 13}\log^{\frac 23}N</script>, the time complexity could reduce to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5122">O</span><span class="MJXp-mrow" id="MJXp-Span-5123"><span class="MJXp-mo" id="MJXp-Span-5124" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.033em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.133em; margin-left: -0.21em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-5125" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-5126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5127" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5128" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5129" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5130">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5131">3</span></span></span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-5132"><span class="MJXp-mi" id="MJXp-Span-5133" style="margin-right: 0.05em;">log</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5134" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5135" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5136">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5137">3</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5138"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5139">N</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5140" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5141">D</span><span class="MJXp-mi" id="MJXp-Span-5142">log</span><span class="MJXp-mo" id="MJXp-Span-5143" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5144">N</span><span class="MJXp-mo" id="MJXp-Span-5145" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-5146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5147" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5148" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5149" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5150">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5151">3</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5152" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.033em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.133em; margin-left: -0.21em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-457">O\left(\frac {N^{\frac 23}}{\log^{\frac 23}N}+D\log N+N^{\frac 23}\right)</script>.</p><p>To further optimize, let's introduce a method that could significantly reduce the time consumption of Du Sieve.</p><p>The formula of Du Sieve is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5153"><span class="MJXp-msubsup" id="MJXp-Span-5154"><span class="MJXp-mo" id="MJXp-Span-5155" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5156" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5157">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5158">y</span><span class="MJXp-mo" id="MJXp-Span-5159">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5160">N</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5161">f</span><span class="MJXp-mo" id="MJXp-Span-5162" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5163">x</span><span class="MJXp-mo" id="MJXp-Span-5164" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5165">g</span><span class="MJXp-mo" id="MJXp-Span-5166" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5167">y</span><span class="MJXp-mo" id="MJXp-Span-5168" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5169" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5171" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5172" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5173">f</span><span class="MJXp-mo" id="MJXp-Span-5174">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5175">g</span></span></span><span class="MJXp-mo" id="MJXp-Span-5176" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5177">N</span><span class="MJXp-mo" id="MJXp-Span-5178" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-458">\sum_{xy\leq N}f(x)g(y)=S_{f*g}(N)</script>. We can see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5179"><span class="MJXp-mo" id="MJXp-Span-5180" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-5181" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5182">x</span><span class="MJXp-mo" id="MJXp-Span-5183" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5184">y</span><span class="MJXp-mo" id="MJXp-Span-5185" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5186" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msqrt" id="MJXp-Span-5187"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5188">N</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-459">\min(x,y)\leq\sqrt{N}</script>, Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5190">B</span><span class="MJXp-mo" id="MJXp-Span-5191" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-5192" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-msqrt" id="MJXp-Span-5193"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5194">N</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5195" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-460">B=\lfloor\sqrt{N}\rfloor</script>, the formula could be rewritten like this: </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5196"><span class="MJXp-msubsup" id="MJXp-Span-5197"><span class="MJXp-mo" id="MJXp-Span-5198" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5203">B</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-5199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5200">i</span><span class="MJXp-mo" id="MJXp-Span-5201">=</span><span class="MJXp-mn" id="MJXp-Span-5202">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5204">f</span><span class="MJXp-mo" id="MJXp-Span-5205" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5206">i</span><span class="MJXp-mo" id="MJXp-Span-5207" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-5208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5209" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5210" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-5211" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-5212" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-5213" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5214">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5215">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5216" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-5217" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5218" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5219">g</span><span class="MJXp-mo" id="MJXp-Span-5220" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5221">i</span><span class="MJXp-mo" id="MJXp-Span-5222" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-5223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5224" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5225" style="vertical-align: -0.4em;">f</span></span><span class="MJXp-mo" id="MJXp-Span-5226" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-5227" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-5228" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5229">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5230">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5231" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-5232" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5233" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-5234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5235" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5236" style="vertical-align: -0.4em;">f</span></span><span class="MJXp-mo" id="MJXp-Span-5237" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5238">B</span><span class="MJXp-mo" id="MJXp-Span-5239" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-5240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5241" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5242" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-5243" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5244">B</span><span class="MJXp-mo" id="MJXp-Span-5245" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5246" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5248" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5249" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5250">f</span><span class="MJXp-mo" id="MJXp-Span-5251">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5252">g</span></span></span><span class="MJXp-mo" id="MJXp-Span-5253" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5254">N</span><span class="MJXp-mo" id="MJXp-Span-5255" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-461">\sum_{i=1}^Bf(i)S_g(\lfloor\frac{N}{i}\rfloor)+g(i)S_f(\lfloor\frac{N}{i}\rfloor)-S_f(B)S_g(B)=S_{f*g}(N)</script></center> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5256"><span class="MJXp-msubsup" id="MJXp-Span-5257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5258" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5259" style="vertical-align: -0.4em;">f</span></span><span class="MJXp-mo" id="MJXp-Span-5260" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5261">N</span><span class="MJXp-mo" id="MJXp-Span-5262" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5263" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5265" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5266" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5267">f</span><span class="MJXp-mo" id="MJXp-Span-5268">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5269">g</span></span></span><span class="MJXp-mo" id="MJXp-Span-5270" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5271">N</span><span class="MJXp-mo" id="MJXp-Span-5272" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5273" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-5274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5275" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5276" style="vertical-align: -0.4em;">f</span></span><span class="MJXp-mo" id="MJXp-Span-5277" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5278">B</span><span class="MJXp-mo" id="MJXp-Span-5279" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-5280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5281" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5282" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-5283" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5284">B</span><span class="MJXp-mo" id="MJXp-Span-5285" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5286" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-5287"><span class="MJXp-mo" id="MJXp-Span-5288" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5293">B</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-5289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5290">i</span><span class="MJXp-mo" id="MJXp-Span-5291">=</span><span class="MJXp-mn" id="MJXp-Span-5292">2</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5294">f</span><span class="MJXp-mo" id="MJXp-Span-5295" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5296">i</span><span class="MJXp-mo" id="MJXp-Span-5297" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-5298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5299" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5300" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-5301" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-5302" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-5303" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5304">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5305">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5306" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-5307" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5308" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5309">g</span><span class="MJXp-mo" id="MJXp-Span-5310" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5311">i</span><span class="MJXp-mo" id="MJXp-Span-5312" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-5313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5314" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5315" style="vertical-align: -0.4em;">f</span></span><span class="MJXp-mo" id="MJXp-Span-5316" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-5317" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-5318" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5319">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5320">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5321" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-5322" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5323" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-5324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5325" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5326" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-5327" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5328">N</span><span class="MJXp-mo" id="MJXp-Span-5329" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-462">S_f(N)=S_{f*g}(N)+S_f(B)S_g(B)-\sum_{i=2}^Bf(i)S_g(\lfloor\frac{N}{i}\rfloor)+g(i)S_f(\lfloor\frac{N}{i}\rfloor)-S_g(N)</script></center><p>Traditionally, we need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5330"><span class="MJXp-mo" id="MJXp-Span-5331" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-5332">6</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5333">B</span><span class="MJXp-mo" id="MJXp-Span-5334" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-5335">8</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5336">B</span><span class="MJXp-mo" id="MJXp-Span-5337" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-463">[6B,8B]</script> times of division, but using this method need a maximum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5338"><span class="MJXp-mn" id="MJXp-Span-5339">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5340">B</span></span></span><script type="math/tex" id="MathJax-Element-464">2B</script> times of division. </p><p>As for what we need to calculate in this problem, we can get the formula: </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5341"><span class="MJXp-msubsup" id="MJXp-Span-5342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5343" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5344" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5345">φ</span></span></span><span class="MJXp-mo" id="MJXp-Span-5346" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5347">N</span><span class="MJXp-mo" id="MJXp-Span-5348" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5349" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-5350" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5351">N</span><span class="MJXp-mo" id="MJXp-Span-5352">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5353">N</span><span class="MJXp-mo" id="MJXp-Span-5354">−</span><span class="MJXp-mn" id="MJXp-Span-5355">1</span><span class="MJXp-mo" id="MJXp-Span-5356">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5357">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5358" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-5359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5360" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5361" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5362">φ</span><span class="MJXp-mo" id="MJXp-Span-5363">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5364">B</span><span class="MJXp-mo" id="MJXp-Span-5365">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-5366" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5367">B</span><span class="MJXp-mo" id="MJXp-Span-5368" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-5369"><span class="MJXp-mo" id="MJXp-Span-5370" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5375">B</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-5371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5372">i</span><span class="MJXp-mo" id="MJXp-Span-5373">=</span><span class="MJXp-mn" id="MJXp-Span-5374">2</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5376">φ</span><span class="MJXp-mo" id="MJXp-Span-5377" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5378">i</span><span class="MJXp-mo" id="MJXp-Span-5379" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5380" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-5381" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5382">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5383">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5384" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-5385" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5386">i</span><span class="MJXp-msubsup" id="MJXp-Span-5387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5388" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5389" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5390">φ</span></span></span><span class="MJXp-mo" id="MJXp-Span-5391" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-5392" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-5393" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5394">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5395">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5396" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-5397" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-465">S_{\varphi}(N)=\frac{N(N-1)}{2}+S_{\varphi(B)}\times B-\sum_{i=2}^B\varphi(i)\lfloor\frac{N}{i}\rfloor+iS_{\varphi}(\lfloor\frac{N}{i}\rfloor)</script></center><p>Without using things like <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5398"><span class="MJXp-mtext" id="MJXp-Span-5399">std::map</span></span></span><script type="math/tex" id="MathJax-Element-466">\text{std::map}</script>, and use dynamic programming instead of DFS, we can further reduce the time consumption.</p><p>Then consider how to optimize Du Sieve to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5401">O</span><span class="MJXp-mrow" id="MJXp-Span-5402"><span class="MJXp-mo" id="MJXp-Span-5403" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.033em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.133em; margin-left: -0.21em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-5404" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-5405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5406" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5407" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5408" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5409">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5410">3</span></span></span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-5411">log</span><span class="MJXp-mo" id="MJXp-Span-5412"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5413">N</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5414" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.033em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.133em; margin-left: -0.21em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-467">O\left(\frac{N^{\frac{2}{3}}}{\log N}\right)</script>. </p><p>Definition: if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5416">f</span></span></span><script type="math/tex" id="MathJax-Element-468">f</script> is a multiplicative function, then we define a multiplicative function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5417"><span class="MJXp-msubsup" id="MJXp-Span-5418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5419" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5420" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-5421" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5423" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5424" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-5425" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5426" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-5427" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5428">p</span><span class="MJXp-mo" id="MJXp-Span-5429" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5430">x</span><span class="MJXp-mo" id="MJXp-Span-5431" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5432">f</span><span class="MJXp-mo" id="MJXp-Span-5433" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5435" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5436" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-5437" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-469">f_x(p^k)=[p\geq x]f(p^k)</script>. </p><p>We can calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5438"><span class="MJXp-msubsup" id="MJXp-Span-5439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5440" style="margin-right: 0.05em;">φ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5441" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5443" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5444" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5445" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5446">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5447">6</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-5449" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-5450" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5451">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5452">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5453" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-5454" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-470">\varphi_{N^{\frac{1}{6}}}(\lfloor\frac {N}{i} \rfloor)</script> for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5456">i</span></span></span><script type="math/tex" id="MathJax-Element-471">i</script> and then recurrence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5458">φ</span></span></span><script type="math/tex" id="MathJax-Element-472">\varphi</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5459"><span class="MJXp-msubsup" id="MJXp-Span-5460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5461" style="margin-right: 0.05em;">φ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5462" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5464" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5465" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5466" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5467">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5468">6</span></span></span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-473">\varphi_{N^{\frac 16}}</script>. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5470">n</span><span class="MJXp-mn" id="MJXp-Span-5471">6</span><span class="MJXp-mo" id="MJXp-Span-5472" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5474" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5475" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5476" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5477">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5478">6</span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-474">n6=N^{\frac{1}{6}}</script>, we can change the formula into: </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5479"><span class="MJXp-msubsup" id="MJXp-Span-5480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5481" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5482" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5484" style="margin-right: 0.05em;">φ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5485" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5486">n</span><span class="MJXp-mn" id="MJXp-Span-5487">6</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5488" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5489">N</span><span class="MJXp-mo" id="MJXp-Span-5490" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5491" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5493" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5494" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5495">i</span><span class="MJXp-msubsup" id="MJXp-Span-5496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5497" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5498" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5499">n</span><span class="MJXp-mn" id="MJXp-Span-5500">6</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5501" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5502">N</span><span class="MJXp-mo" id="MJXp-Span-5503" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5504" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-5505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5506" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5507" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5508"><span class="MJXp-mn" id="MJXp-Span-5509" style="margin-right: 0.05em;">1</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5510" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5511">n</span><span class="MJXp-mn" id="MJXp-Span-5512">6</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5513" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5514">N</span><span class="MJXp-mo" id="MJXp-Span-5515" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5516" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-5517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5518" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5519" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5521" style="margin-right: 0.05em;">φ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5522" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5523">n</span><span class="MJXp-mn" id="MJXp-Span-5524">6</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5525" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5526">B</span><span class="MJXp-mo" id="MJXp-Span-5527" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-5528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5529" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5530" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5531"><span class="MJXp-mn" id="MJXp-Span-5532" style="margin-right: 0.05em;">1</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5533" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5534">n</span><span class="MJXp-mn" id="MJXp-Span-5535">6</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5536" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5537">B</span><span class="MJXp-mo" id="MJXp-Span-5538" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5539" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-5540"><span class="MJXp-mo" id="MJXp-Span-5541" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5546">B</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-5542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5543">i</span><span class="MJXp-mo" id="MJXp-Span-5544">=</span><span class="MJXp-mn" id="MJXp-Span-5545">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5547" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-5548"><span class="MJXp-mi" id="MJXp-Span-5549">m</span><span class="MJXp-mi" id="MJXp-Span-5550">i</span><span class="MJXp-mi" id="MJXp-Span-5551">n</span><span class="MJXp-mi" id="MJXp-Span-5552">p</span></span><span class="MJXp-mo" id="MJXp-Span-5553" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5554">i</span><span class="MJXp-mo" id="MJXp-Span-5555" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5556" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5557">n</span><span class="MJXp-mn" id="MJXp-Span-5558">6</span><span class="MJXp-mo" id="MJXp-Span-5559" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5560">φ</span><span class="MJXp-mo" id="MJXp-Span-5561" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5562">i</span><span class="MJXp-mo" id="MJXp-Span-5563" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-5564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5565" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5566" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5567"><span class="MJXp-mn" id="MJXp-Span-5568" style="margin-right: 0.05em;">1</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5569" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5570">n</span><span class="MJXp-mn" id="MJXp-Span-5571">6</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5572" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-5573" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-5574" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5575">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5576">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5577" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-5578" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5579" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-5580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5581" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5582" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5584" style="margin-right: 0.05em;">φ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5585" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5586">n</span><span class="MJXp-mn" id="MJXp-Span-5587">6</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5588" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-5589" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-5590" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5591">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5592">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5593" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-475">S_{\varphi_{n6}}(N)=S_{id_{n6}}(N)-S_{1_{n6}}(N)+S_{\varphi_{n6}}(B)S_{1_{n6}}(B)-\sum_{i=2}^B[\mathrm{minp}(i)\geq n6]\varphi(i)S_{1_{n6}}(\lfloor\frac{N}{i}\rfloor)+S_{\varphi_{n6}}(\lfloor\frac{N}{i})</script></center><p>Where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5594"><span class="MJXp-mtext" id="MJXp-Span-5595">id</span><span class="MJXp-mo" id="MJXp-Span-5596" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5597">x</span><span class="MJXp-mo" id="MJXp-Span-5598" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5599" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5600">x</span></span></span><script type="math/tex" id="MathJax-Element-476">\text{id}(x)=x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5601"><span class="MJXp-mn" id="MJXp-Span-5602">1</span><span class="MJXp-mo" id="MJXp-Span-5603" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5604">x</span><span class="MJXp-mo" id="MJXp-Span-5605" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5606" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-5607">1</span></span></span><script type="math/tex" id="MathJax-Element-477">1(x)=1</script>, which can be calculated through <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5608"><span class="MJXp-mtext" id="MJXp-Span-5609">min25</span></span></span><script type="math/tex" id="MathJax-Element-478">\text{min25}</script> Seive, but we only need to solve <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5611">p</span><span class="MJXp-mo" id="MJXp-Span-5612" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5613">n</span><span class="MJXp-mn" id="MJXp-Span-5614">6</span></span></span><script type="math/tex" id="MathJax-Element-479">p\leq n6</script> instead of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5616">p</span><span class="MJXp-mo" id="MJXp-Span-5617" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msqrt" id="MJXp-Span-5618"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5619">N</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-480">p\leq\sqrt N</script>. </p><p>According to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5620"><span class="MJXp-mrow" id="MJXp-Span-5621"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-5622">Key observation 2</span></span></span></span><script type="math/tex" id="MathJax-Element-481">\texttt{Key observation 2}</script>, we know that the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5624">i</span><span class="MJXp-mo" id="MJXp-Span-5625" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msqrt" id="MJXp-Span-5626"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5627">N</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-482">i\le \sqrt N</script> that satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5628"><span class="MJXp-mrow" id="MJXp-Span-5629"><span class="MJXp-mi" id="MJXp-Span-5630">m</span><span class="MJXp-mi" id="MJXp-Span-5631">i</span><span class="MJXp-mi" id="MJXp-Span-5632">n</span><span class="MJXp-mi" id="MJXp-Span-5633">p</span></span><span class="MJXp-mo" id="MJXp-Span-5634" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5635">i</span><span class="MJXp-mo" id="MJXp-Span-5636" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5637" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5638">n</span><span class="MJXp-mn" id="MJXp-Span-5639">6</span></span></span><script type="math/tex" id="MathJax-Element-483">\mathrm{minp}(i)\geq n6</script> is about <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5640"><span class="MJXp-mfrac" id="MJXp-Span-5641" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-5642"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5643">N</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-5644">log</span><span class="MJXp-mo" id="MJXp-Span-5645"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5646">N</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-484">\frac{\sqrt N}{\log N}</script>, find them and iterate these numbers in the Du Sieve. The time complexity of this part is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5648">O</span><span class="MJXp-mrow" id="MJXp-Span-5649"><span class="MJXp-mo" id="MJXp-Span-5650" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.033em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.133em; margin-left: -0.21em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-5651" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-5652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5653" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5654" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5655" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5656">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5657">3</span></span></span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-5658">log</span><span class="MJXp-mo" id="MJXp-Span-5659"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5660">N</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5661" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.033em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.133em; margin-left: -0.21em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-485">O\left(\frac{N^{\frac{2}{3}}}{\log N}\right)</script>. </p><p>At last we get a solution of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5663">O</span><span class="MJXp-mrow" id="MJXp-Span-5664"><span class="MJXp-mo" id="MJXp-Span-5665" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.033em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.133em; margin-left: -0.21em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-5666" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-5667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5668" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5669" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-5670" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5671">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-5672">3</span></span></span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-5673">log</span><span class="MJXp-mo" id="MJXp-Span-5674"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5675">N</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5676" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-5677" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-5678"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5679">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5680">K</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-5681">log</span><span class="MJXp-mo" id="MJXp-Span-5682"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5683">N</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5684" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-5685" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5686">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5687">K</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5688" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.033em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.133em; margin-left: -0.21em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-486">O\left(\frac{N^{\frac{2}{3}}}{\log N}+\frac{\sqrt{NK}}{\log N}+\frac{N}{K}\right)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="str">&lt;bitset&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;cmath&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;ctime&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">min</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">max</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ull</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">Sol</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> M</span><span class="pun">=</span><span class="lit">4162277</span><span class="pun">+</span><span class="lit">5</span><span class="pun">,</span><span class="typ">Pi</span><span class="pun">=</span><span class="lit">1001258</span><span class="pun">+</span><span class="lit">5</span><span class="pun">,</span><span class="pln">M2</span><span class="pun">=</span><span class="lit">500000000</span><span class="pun">+</span><span class="lit">5</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">uint</span><span class="pln"> sum</span><span class="pun">;</span><span class="pln">ull N</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">uint</span><span class="pln"> F</span><span class="pun">[</span><span class="pln">M</span><span class="pun">],</span><span class="pln">G</span><span class="pun">[</span><span class="pln">M</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">uint</span><span class="pln"> top</span><span class="pun">,</span><span class="typ">Sp</span><span class="pun">[</span><span class="typ">Pi</span><span class="pun">],</span><span class="pln">pri</span><span class="pun">[</span><span class="typ">Pi</span><span class="pun">],</span><span class="pln">pi</span><span class="pun">[</span><span class="pln">M</span><span class="pun">],</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">M2</span><span class="pun">];</span><span class="kwd">double</span><span class="pln"> g</span><span class="pun">[</span><span class="typ">Pi</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">uint</span><span class="pln"> n4</span><span class="pun">,</span><span class="pln">K</span><span class="pun">,</span><span class="pln">B</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">lim</span><span class="pun">,</span><span class="pln">BIT</span><span class="pun">[</span><span class="pln">M</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">double</span><span class="pln"> st</span><span class="pun">,</span><span class="pln">ed</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">struct</span><span class="pln"> nb</span><span class="pun">{</span><span class="pln">
        ull n</span><span class="pun">;</span><span class="kwd">uint</span><span class="pln"> phi</span><span class="pun">;</span><span class="pln">
        nb</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">phi</span><span class="pun">=</span><span class="lit">1</span><span class="pun">):</span><span class="pln">n</span><span class="pun">(</span><span class="pln">n</span><span class="pun">),</span><span class="pln">phi</span><span class="pun">(</span><span class="pln">phi</span><span class="pun">){}</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">std</span><span class="pun">::</span><span class="pln">vector</span><span class="str">&lt;nb&gt;</span><span class="pln">d</span><span class="pun">[</span><span class="typ">Pi</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">inline</span><span class="pln"> ull div</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">m</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> n</span><span class="pun">*</span><span class="lit">1.</span><span class="pun">/</span><span class="pln">m</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Add</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> n</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">V</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">n</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">)</span><span class="pln">BIT</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]+=</span><span class="pln">V</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+=</span><span class="pln">n</span><span class="pun">&amp;-</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> </span><span class="typ">Qry</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> n</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">uint</span><span class="pln"> ans</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">+=</span><span class="pln">BIT</span><span class="pun">[</span><span class="pln">n</span><span class="pun">],</span><span class="pln">n</span><span class="pun">-=</span><span class="pln">n</span><span class="pun">&amp;-</span><span class="pln">n</span><span class="pun">;</span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> check</span><span class="pun">(</span><span class="kwd">double</span><span class="pln"> P</span><span class="pun">,</span><span class="pln">ull n</span><span class="pun">,</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">){</span><span class="pln">
        ull x</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">P</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">&amp;&amp;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">&amp;&amp;</span><span class="pln">x</span><span class="pun">*</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]&lt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln">P</span><span class="pun">*=</span><span class="pln">g</span><span class="pun">[</span><span class="pln">k</span><span class="pun">],</span><span class="pln">x</span><span class="pun">*=</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">++];</span><span class="kwd">return</span><span class="pln"> P</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> DFS1</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">phi</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">w</span><span class="pun">=</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">/</span><span class="pln">phi</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> 
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">w</span><span class="pun">*</span><span class="pln">phi</span><span class="pun">*</span><span class="lit">1.</span><span class="pun">/</span><span class="pln">n</span><span class="pun">,</span><span class="pln">T</span><span class="pun">,</span><span class="pln">k</span><span class="pun">))</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
        </span><span class="com">//g(n)*p/(p-1)&gt;=int(g(n))+1</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">R</span><span class="pun">=</span><span class="pln">pi</span><span class="pun">[</span><span class="pln">min</span><span class="pun">(</span><span class="pln">div</span><span class="pun">(</span><span class="pln">w</span><span class="pun">*</span><span class="pln">phi</span><span class="pun">,</span><span class="pln">w</span><span class="pun">*</span><span class="pln">phi</span><span class="pun">-</span><span class="pln">n</span><span class="pun">),</span><span class="pln">min</span><span class="pun">(</span><span class="pln">ull</span><span class="pun">(</span><span class="pln">B</span><span class="pun">),</span><span class="pln">T</span><span class="pun">))];</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">;++</span><span class="pln">k</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">=</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">*</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln">T</span><span class="pun">)</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">R</span><span class="pun">)</span><span class="pln">d</span><span class="pun">[</span><span class="pln">k</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">nb</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">phi</span><span class="pun">)),</span><span class="pln">n</span><span class="pun">*</span><span class="pln">p</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">&amp;&amp;(</span><span class="pln">lim</span><span class="pun">=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">lim</span><span class="pun">,</span><span class="pln">k</span><span class="pun">));</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ull x</span><span class="pun">=</span><span class="pln">n</span><span class="pun">,</span><span class="pln">tp</span><span class="pun">=</span><span class="pln">phi</span><span class="pun">*(</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">x</span><span class="pun">*</span><span class="pln">p</span><span class="pun">&lt;=</span><span class="pln">N</span><span class="pun">;</span><span class="pln">tp</span><span class="pun">*=</span><span class="pln">p</span><span class="pun">)</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">DFS1</span><span class="pun">(</span><span class="pln">x</span><span class="pun">*=</span><span class="pln">p</span><span class="pun">,</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">tp</span><span class="pun">))</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">R</span><span class="pun">)</span><span class="pln">sum</span><span class="pun">+=</span><span class="pln">phi</span><span class="pun">*(</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">R</span><span class="pun">]-</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">k</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> DFS2</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">phi</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">B</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="typ">Add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">phi</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">;++</span><span class="pln">k</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">=</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">k</span><span class="pun">],&amp;</span><span class="pln">T2</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">B</span><span class="pun">,</span><span class="pln">p</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln">T</span><span class="pun">)</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> x</span><span class="pun">=</span><span class="pln">n</span><span class="pun">,</span><span class="pln">tp</span><span class="pun">=</span><span class="pln">phi</span><span class="pun">*(</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">x</span><span class="pun">&lt;=</span><span class="pln">T2</span><span class="pun">;</span><span class="pln">tp</span><span class="pun">*=</span><span class="pln">p</span><span class="pun">)</span><span class="pln">DFS2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">*=</span><span class="pln">p</span><span class="pun">,</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">tp</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">void</span><span class="pln"> sieve</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">){</span><span class="pln">
        phi</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]){</span><span class="pln">
            	phi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">)</span><span class="pln">pri</span><span class="pun">[++</span><span class="pln">top</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">,</span><span class="pln">g</span><span class="pun">[</span><span class="pln">top</span><span class="pun">]=</span><span class="lit">1.</span><span class="pun">*(</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)/</span><span class="pln">i</span><span class="pun">,</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">top</span><span class="pun">]=</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">top</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">pi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> x</span><span class="pun">,</span><span class="pln">j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">top</span><span class="pun">&amp;&amp;(</span><span class="pln">x</span><span class="pun">=</span><span class="pln">i</span><span class="pun">*</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">){</span><span class="pln">
			    phi</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]=</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]*(</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">div</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])*</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]==</span><span class="pln">i</span><span class="pun">){</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]+=</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">break</span><span class="pun">;}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">)</span><span class="pln">pi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+=</span><span class="pln">pi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Getphi</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">){</span><span class="pln">
    	</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">B2</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">K</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">G</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">G</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">B</span><span class="pun">);</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">F</span><span class="pun">[</span><span class="pln">B</span><span class="pun">]+=</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">B</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;</span><span class="pln">B2</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">L</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">,&amp;</span><span class="pln">R</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">i</span><span class="pun">);</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">];</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">L</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">R</span><span class="pun">;++</span><span class="pln">k</span><span class="pun">)</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+=</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">k</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
    	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">B2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
    		</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">i</span><span class="pun">);</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">lim</span><span class="pun">=</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">T</span><span class="pun">);</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">lim</span><span class="pun">*</span><span class="pln">G</span><span class="pun">[</span><span class="pln">lim</span><span class="pun">]+</span><span class="pln">T</span><span class="pun">*(</span><span class="pln">T</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">lim</span><span class="pun">;++</span><span class="pln">k</span><span class="pun">){</span><span class="pln">
    			</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">T</span><span class="pun">,</span><span class="pln">k</span><span class="pun">);</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-=(</span><span class="pln">i</span><span class="pun">*</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">?</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">*</span><span class="pln">k</span><span class="pun">]:</span><span class="pln">G</span><span class="pun">[</span><span class="pln">x</span><span class="pun">])+</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]*</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">uint</span><span class="pln"> </span><span class="typ">Solve</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">){</span><span class="pln">
    	st</span><span class="pun">=</span><span class="pln">clock</span><span class="pun">();</span><span class="pln">
        N</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">B</span><span class="pun">=</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">N</span><span class="pun">);</span><span class="pln">n4</span><span class="pun">=</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">B</span><span class="pun">);</span><span class="pln">
        sieve</span><span class="pun">(</span><span class="pln">K</span><span class="pun">=</span><span class="kwd">uint</span><span class="pun">(</span><span class="pln">pow</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="lit">2.</span><span class="pun">/</span><span class="lit">3</span><span class="pun">)));</span><span class="pln">m</span><span class="pun">=</span><span class="pln">pi</span><span class="pun">[</span><span class="pln">B</span><span class="pun">];</span><span class="pln">
        fprintf</span><span class="pun">(</span><span class="pln">stderr</span><span class="pun">,</span><span class="str">"sieve(%d) done %lf\n"</span><span class="pun">,</span><span class="pln">K</span><span class="pun">,((</span><span class="pln">ed</span><span class="pun">=</span><span class="pln">clock</span><span class="pun">())-</span><span class="pln">st</span><span class="pun">)/</span><span class="lit">1000</span><span class="pun">);</span><span class="pln">st</span><span class="pun">=</span><span class="pln">ed</span><span class="pun">;</span><span class="pln">
        DFS1</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
        fprintf</span><span class="pun">(</span><span class="pln">stderr</span><span class="pun">,</span><span class="str">"DFS done %lf\n"</span><span class="pun">,((</span><span class="pln">ed</span><span class="pun">=</span><span class="pln">clock</span><span class="pun">())-</span><span class="pln">st</span><span class="pun">)/</span><span class="lit">1000</span><span class="pun">);</span><span class="pln">st</span><span class="pun">=</span><span class="pln">ed</span><span class="pun">;</span><span class="pln">
        </span><span class="typ">Getphi</span><span class="pun">(</span><span class="pln">N</span><span class="pun">);</span><span class="pln">sum</span><span class="pun">+=</span><span class="pln">F</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
        fprintf</span><span class="pun">(</span><span class="pln">stderr</span><span class="pun">,</span><span class="str">"Getphi done %lf\n"</span><span class="pun">,((</span><span class="pln">ed</span><span class="pun">=</span><span class="pln">clock</span><span class="pun">())-</span><span class="pln">st</span><span class="pun">)/</span><span class="lit">1000</span><span class="pun">);</span><span class="pln">st</span><span class="pun">=</span><span class="pln">ed</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">lim</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">=</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],&amp;</span><span class="pln">T</span><span class="pun">=</span><span class="pln">B</span><span class="pun">/</span><span class="pln">p</span><span class="pun">;</span><span class="kwd">const</span><span class="pln"> ull</span><span class="pun">&amp;</span><span class="pln">k</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">p</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">nb</span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">:</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">sum</span><span class="pun">+=</span><span class="pln">x</span><span class="pun">.</span><span class="pln">phi</span><span class="pun">*(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">n</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">?</span><span class="pln">F</span><span class="pun">[</span><span class="pln">x</span><span class="pun">.</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">G</span><span class="pun">[</span><span class="pln">div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">x</span><span class="pun">.</span><span class="pln">n</span><span class="pun">)]);</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">T</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-=</span><span class="pln">p</span><span class="pun">*</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">*</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">T</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-=</span><span class="pln">p</span><span class="pun">*</span><span class="pln">G</span><span class="pun">[</span><span class="pln">div</span><span class="pun">(</span><span class="pln">k</span><span class="pun">,</span><span class="pln">i</span><span class="pun">)];</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">B</span><span class="pun">,</span><span class="pln">j</span><span class="pun">=</span><span class="pln">div</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">p</span><span class="pun">);</span><span class="pln">j</span><span class="pun">;--</span><span class="pln">j</span><span class="pun">)</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> e</span><span class="pun">=</span><span class="pln">j</span><span class="pun">*</span><span class="pln">p</span><span class="pun">,</span><span class="pln">V</span><span class="pun">=</span><span class="pln">p</span><span class="pun">*</span><span class="pln">G</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="pln">e</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">G</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-=</span><span class="pln">V</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">p</span><span class="pun">,</span><span class="pln">j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> e</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="pln">p</span><span class="pun">,</span><span class="pln">B</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),</span><span class="pln">V</span><span class="pun">=</span><span class="pln">G</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">e</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">G</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+=</span><span class="pln">V</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">B</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;</span><span class="pln">T</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+=</span><span class="pln">G</span><span class="pun">[</span><span class="pln">div</span><span class="pun">(</span><span class="pln">k</span><span class="pun">,</span><span class="pln">i</span><span class="pun">)];</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">T</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+=</span><span class="pln">F</span><span class="pun">[</span><span class="pln">i</span><span class="pun">*</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">nb</span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">:</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">sum</span><span class="pun">-=</span><span class="pln">x</span><span class="pun">.</span><span class="pln">phi</span><span class="pun">*(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">n</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">?</span><span class="pln">F</span><span class="pun">[</span><span class="pln">x</span><span class="pun">.</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">G</span><span class="pun">[</span><span class="pln">div</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln">x</span><span class="pun">.</span><span class="pln">n</span><span class="pun">)]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        fprintf</span><span class="pun">(</span><span class="pln">stderr</span><span class="pun">,</span><span class="str">"case1 done %lf\n"</span><span class="pun">,((</span><span class="pln">ed</span><span class="pun">=</span><span class="pln">clock</span><span class="pun">())-</span><span class="pln">st</span><span class="pun">)/</span><span class="lit">1000</span><span class="pun">);</span><span class="pln">st</span><span class="pun">=</span><span class="pln">ed</span><span class="pun">;</span><span class="pln">
        </span><span class="typ">Add</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">m</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;</span><span class="pln">lim</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">=</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">nb</span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">:</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]){</span><span class="pln">
                ull n</span><span class="pun">=</span><span class="pln">N</span><span class="pun">/</span><span class="pln">x</span><span class="pun">.</span><span class="pln">n</span><span class="pun">/</span><span class="pln">p</span><span class="pun">,</span><span class="pln">phi</span><span class="pun">=</span><span class="pln">x</span><span class="pun">.</span><span class="pln">phi</span><span class="pun">*(</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
                </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln">sum</span><span class="pun">+=</span><span class="pln">phi</span><span class="pun">*</span><span class="typ">Qry</span><span class="pun">(</span><span class="pln">n</span><span class="pun">),</span><span class="pln">n</span><span class="pun">/=</span><span class="pln">p</span><span class="pun">,</span><span class="pln">phi</span><span class="pun">*=</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ull x</span><span class="pun">=</span><span class="pln">p</span><span class="pun">,</span><span class="pln">phi</span><span class="pun">=</span><span class="pln">p</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&lt;=</span><span class="pln">B</span><span class="pun">;</span><span class="pln">x</span><span class="pun">*=</span><span class="pln">p</span><span class="pun">,</span><span class="pln">phi</span><span class="pun">*=</span><span class="pln">p</span><span class="pun">)</span><span class="pln">DFS2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">phi</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        fprintf</span><span class="pun">(</span><span class="pln">stderr</span><span class="pun">,</span><span class="str">"case2 done %lf\n"</span><span class="pun">,((</span><span class="pln">ed</span><span class="pun">=</span><span class="pln">clock</span><span class="pun">())-</span><span class="pln">st</span><span class="pun">)/</span><span class="lit">1000</span><span class="pun">);</span><span class="pln">st</span><span class="pun">=</span><span class="pln">ed</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> n</span><span class="pun">*(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">-</span><span class="pln">sum</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">namespace</span><span class="pln"> sol</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">uint</span><span class="pln"> top</span><span class="pun">,</span><span class="pln">pri</span><span class="pun">[</span><span class="lit">10005</span><span class="pun">],</span><span class="pln">pos</span><span class="pun">[</span><span class="lit">10005</span><span class="pun">],</span><span class="pln">phi</span><span class="pun">[</span><span class="lit">10005</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> solve</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pun">&amp;</span><span class="pln">N</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">uint</span><span class="pln"> sum</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">phi</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">N</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=++</span><span class="pln">top</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">,</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> x</span><span class="pun">,</span><span class="pln">j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&amp;&amp;(</span><span class="pln">x</span><span class="pun">=</span><span class="pln">i</span><span class="pun">*</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])&lt;=</span><span class="pln">N</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]=(</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]=</span><span class="pln">j</span><span class="pun">)==</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]?</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]*</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]:</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]*(</span><span class="pln">pri</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			sum</span><span class="pun">+=</span><span class="pln">i</span><span class="pun">%</span><span class="pln">phi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> sum</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln"> 
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ull n</span><span class="pun">;</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%llu"</span><span class="pun">,&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">n</span><span class="pun">&lt;=</span><span class="lit">10000</span><span class="pun">)</span><span class="kwd">return</span><span class="pln"> printf</span><span class="pun">(</span><span class="str">"%u\n"</span><span class="pun">,</span><span class="pln">sol</span><span class="pun">::</span><span class="pln">solve</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)),</span><span class="lit">0</span><span class="pun">;</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"%u\n"</span><span class="pun">,</span><span class="typ">Sol</span><span class="pun">::</span><span class="typ">Solve</span><span class="pun">(</span><span class="pln">n</span><span class="pun">));</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2081" class="notice" style="text-decoration: none;">Codeforces Round 1010 (Div. 1, Unrated)</a> </span>
        </div>
        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2082" class="notice" style="text-decoration: none;">Codeforces Round 1010 (Div. 2, Unrated)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>