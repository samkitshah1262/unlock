{
  "contestId": 2093,
  "index": "G",
  "title": "Shorten the Array",
  "timeLimit": "2 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 1900,
  "tags": [
    "binary search",
    "bitmasks",
    "data structures",
    "dfs and similar",
    "greedy",
    "strings",
    "trees",
    "two pointers"
  ],
  "statementHtml": "<p>The beauty of an array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2\">b</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"></span><script type=\"math/tex\" id=\"MathJax-Element-1\">b</script> of length <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-4\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-2\">m</script> is defined as <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-7\"><span class=\"MJXp-mo\" id=\"MJXp-Span-8\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">max</span><span class=\"MJXp-mo\" id=\"MJXp-Span-9\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-10\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-11\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-12\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-13\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⊕</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-14\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-15\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-16\" style=\"vertical-align: -0.4em;\">j</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-17\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-3\">\\max(b_i \\oplus b_j)</script> among all possible pairs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-18\"><span class=\"MJXp-mn\" id=\"MJXp-Span-19\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-20\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-21\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-22\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-23\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-24\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-25\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-4\">1 \\le i \\le j \\le m</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-26\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-27\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-28\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⊕</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-29\">y</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-5\">x \\oplus y</script> is the <a href=\"https://en.wikipedia.org/wiki/Bitwise_operation#XOR\">bitwise XOR</a> of numbers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-30\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-31\">x</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-6\">x</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-32\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-33\">y</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-7\">y</script>. We denote the beauty value of the array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-34\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-35\">b</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-8\">b</script> as <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-36\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-37\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-38\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-39\">b</span><span class=\"MJXp-mo\" id=\"MJXp-Span-40\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-9\">f(b)</script>.</p>\n<p>An array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-41\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-42\">b</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-10\">b</script> is called beautiful if <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-43\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-44\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-45\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-46\">b</span><span class=\"MJXp-mo\" id=\"MJXp-Span-47\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-48\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≥</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-49\">k</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-11\">f(b) \\ge k</script>.</p>\n<p>Recently, Kostya bought an array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-50\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-51\">a</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-12\">a</script> of length <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-52\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-53\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-13\">n</script> from the store. He considers this array too long, so he plans to cut out some beautiful subarray from it. That is, he wants to choose numbers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-54\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-55\">l</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-14\">l</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-56\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-57\">r</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-15\">r</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-58\"><span class=\"MJXp-mn\" id=\"MJXp-Span-59\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-60\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-61\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-62\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-63\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-64\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-65\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-16\">1 \\le l \\le r \\le n</script>) such that the array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-66\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-67\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-68\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-69\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-70\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-71\">…</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-72\">r</span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-17\">a_{l \\dots r}</script> is beautiful. The length of such a subarray will be the number <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-73\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-74\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-75\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-76\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-77\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-78\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-18\">r - l + 1</script>. The entire array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-79\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-80\">a</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-19\">a</script> is also considered a subarray (with <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-81\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-82\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-83\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-84\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-20\">l = 1</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-85\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-86\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-87\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-88\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-21\">r = n</script>).</p>\n<p>Your task is to find the length of the shortest beautiful subarray in the array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-89\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-90\">a</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-22\">a</script>. If no subarray is beautiful, you should output the number <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-91\"><span class=\"MJXp-mo\" id=\"MJXp-Span-92\" style=\"margin-left: 0em; margin-right: 0.111em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-93\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-23\">-1</script>.</p>",
  "inputSpecHtml": "<p>The first line contains the number of test cases <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-94\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-95\">t</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-24\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-96\"><span class=\"MJXp-mn\" id=\"MJXp-Span-97\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-98\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-99\">t</span><span class=\"MJXp-mo\" id=\"MJXp-Span-100\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-101\"><span class=\"MJXp-mn\" id=\"MJXp-Span-102\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-103\" style=\"vertical-align: 0.5em;\">4</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-25\">1 \\le t \\le 10^4</script>).</p><p>Next, there are <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-104\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-105\">t</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-26\">t</script> blocks of two lines:</p><p>In the first line of the block, there are two integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-106\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-107\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-27\">n</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-108\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-109\">k</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-28\">k</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-110\"><span class=\"MJXp-mn\" id=\"MJXp-Span-111\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-112\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-113\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-114\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-115\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-116\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-117\"><span class=\"MJXp-mn\" id=\"MJXp-Span-118\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-119\" style=\"vertical-align: 0.5em;\">5</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-29\">1 \\le n \\le 2 \\cdot 10^5</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-120\"><span class=\"MJXp-mn\" id=\"MJXp-Span-121\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-122\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-123\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-124\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-125\"><span class=\"MJXp-mn\" id=\"MJXp-Span-126\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-127\" style=\"vertical-align: 0.5em;\">9</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-30\">0 \\le k \\le 10^9</script>).</p><p>In the second line of the block, there is the array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-128\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-129\">a</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-31\">a</script> consisting of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-130\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-131\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-32\">n</script> integers (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-132\"><span class=\"MJXp-mn\" id=\"MJXp-Span-133\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-134\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-135\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-136\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-137\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-138\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-139\"><span class=\"MJXp-mn\" id=\"MJXp-Span-140\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-141\" style=\"vertical-align: 0.5em;\">9</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-33\">0 \\le a_i \\le 10^9</script>).</p><p>It is guaranteed that the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-142\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-143\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-34\">n</script> across all tests does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-144\"><span class=\"MJXp-mn\" id=\"MJXp-Span-145\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-146\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-147\"><span class=\"MJXp-mn\" id=\"MJXp-Span-148\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-149\" style=\"vertical-align: 0.5em;\">5</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-35\">2 \\cdot 10^5</script>.</p>",
  "outputSpecHtml": "<p>For each test case, you need to output a single integer — the minimum length of the segment <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-150\"><span class=\"MJXp-mo\" id=\"MJXp-Span-151\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-152\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-153\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-154\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-155\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-36\">(l, r)</script> for which <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-156\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-157\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-158\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-159\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-160\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-161\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-162\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-163\">…</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-164\">r</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-165\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-166\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≥</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-167\">k</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-37\">f(a_{l \\dots r}) \\ge k</script>. If such a segment is not found, you should output <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-168\"><span class=\"MJXp-mo\" id=\"MJXp-Span-169\" style=\"margin-left: 0em; margin-right: 0.111em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-170\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-38\">-1</script>.</p>",
  "noteHtml": "",
  "samples": [
    {
      "input": "65 01 2 3 4 55 71 2 3 4 55 81 2 3 4 55 73 5 1 4 25 33 5 1 4 26 7126 56 12 45 60 27",
      "output": "1\n2\n-1\n4\n2\n-1"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2093/problem/G",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>First, note that in the optimal segment $$$[l, r]$$$, the maximum value of $$$a_i \\oplus a_j$$$ must be achieved precisely when $$$i = l$$$ and $$$j = r$$$. Otherwise, we can shift at least one of the boundaries, thereby reducing the length of the found segment. Our task then becomes to find the nearest pair of indices $$$i$$$ and $$$j$$$ such that $$$a_i \\oplus a_j \\ge k$$$.</p><p>Next, we consider all numbers in the array as binary strings padded with leading zeros to a length of $$$30$$$. Note that ordinary comparison of numbers is equivalent to lexicographical order on such strings.</p><p>Let $$$x = x_{29}x_{28}{\\dots}x_{1}x_{0}$$$, $$$y = y_{29}y_{28}{\\dots}y_{1}y_{0}$$$, $$$k = k_{29}k_{28}{\\dots}k_{1}k_{0}$$$, then the condition $$$x \\oplus y \\ge k$$$ is equivalent to the existence of a bit $$$i$$$ such that $$$x_{29} \\oplus y_{29} = k_{29}, \\dots, x_{i + 1} \\oplus y_{i + 1} = k_{i + 1}$$$ and $$$x_{i} \\oplus y_{i} &gt; k_{i}$$$. Or $$$x \\oplus y = k$$$, and then for any $$$i$$$ it will hold that $$$x_i \\oplus y_i = k_i$$$.</p><p>Suppose we have fixed the values of $$$x$$$, $$$k$$$, and $$$i$$$, then we need to find such a number $$$y$$$ that $$$y_{29} = x_{29} \\oplus k_{29}, \\dots y_{i + 1} = x_{i + 1} \\oplus k_{i + 1}$$$ and $$$k_i = 0$$$ and $$$x_i \\neq y_i$$$. For the given $$$a_i$$$ and $$$k$$$, we are interested in the nearest $$$a_j$$$ that satisfies these conditions.</p><p>We will traverse the array $$$a$$$ from left to right and maintain in a binary trie all the numbers we have already passed. We will also keep track of the maximum index among the added numbers in the corresponding subtree at each node of the trie. Thus, the search for the nearest suitable $$$a_j$$$ for a given $$$a_i$$$ will look like a descent in the trie along the string $$$a_i \\oplus k$$$. If the value in the $$$j$$$-th bit of the number $$$k$$$ is $$$1$$$, we need to descend along the edge $$$a_{ij} \\oplus 1$$$. Otherwise, if $$$k_j = 0$$$, we should check the maximum index in the subtree $$$a_{ij} \\oplus 1$$$, but we will descend along the edge $$$a_{ij} \\oplus 0$$$.</p><p>Thus, after processing all the numbers in the array, we will find a pair of nearest $$$a_i$$$, $$$a_j$$$, for which $$$a_i \\oplus a_j \\ge k$$$. The solution works in $$$O(N \\log{10^9})$$$.</p></div></div></div></div>"
}