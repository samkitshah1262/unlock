<html lang="en"><head>
        <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-K230KVN22K&amp;cx=c&amp;gtm=4e5ca1"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="73800a8b3b075a7ad0380f5d2d695056">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01">
    <meta name="robots" content="noai">
    <meta name="robots" content="noimageai">

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="l3">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <link rel="image_src" href="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <meta property="og:title" content="Codeforces Round 1012 (Div.1, Div. 2, based on THUPC 2025 — Finals) Editorial - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>Codeforces Round 1012 (Div.1, Div. 2, based on THUPC 2025 — Finals) Editorial - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/font-awesome.min.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/line-awesome.min.css" type="text/css" charset="utf-8">

        <link rel="preconnect" href="https://challenges.cloudflare.com">
        <link rel="dns-prefetch" href="https://challenges.cloudflare.com">
        <link href="//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">
        <link href="//fonts.googleapis.com/css?family=Cuprum&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.com/codeforces.org/s/52448/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.com/codeforces.org/s/52448/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.com/codeforces.org/s/52448/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.com/codeforces.org/s/52448/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.com/codeforces.org/s/52448/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.com/codeforces.org/s/52448/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.com/codeforces.org/s/52448/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.com/codeforces.org/s/52448/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.com/codeforces.org/s/52448/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="//codeforces.com/codeforces.org/s/52448/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.com/codeforces.org/s/52448/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.com/codeforces.org/s/52448/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.com/codeforces.org/s/52448/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.com/codeforces.org/s/52448/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.jgrowl.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.wysiwyg.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.autocomplete.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/codeforces.datepick.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.drafts.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/community.css" type="text/css" charset="utf-8">

    <!-- MathJax -->
    <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async="" src="https://codeforces.com/mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full">
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/5913b958cb6e1f2144469a313cc0ac6e/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/confetti.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/purify.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/skins/markitup/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/style.css" type="text/css" charset="utf-8">


    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




<style type="text/css" media="screen">#swfcontainer {visibility:hidden}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888; display: contents}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.9') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body class=" "><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><span class="MathJax MathJax_Processing" id="MathJax-Element-1-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-2-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-3-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-4-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-5-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-6-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-7-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-8-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-9-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-10-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-11-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-12-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-13-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-14-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-15-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-16-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-17-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-18-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-19-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-20-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-21-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-22-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-23-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-24-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-25-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-26-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-27-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-28-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-29-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-30-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-31-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-32-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-33-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-34-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-35-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-36-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-37-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-38-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-39-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-40-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-41-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-42-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-43-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-44-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-45-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-46-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-47-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-48-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-49-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-50-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-51-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-52-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-53-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-54-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-55-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-56-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-57-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-58-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-59-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-60-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-61-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-62-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-63-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-64-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-65-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-66-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-67-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-68-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-69-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-70-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-71-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-72-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-73-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-74-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-75-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-76-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-77-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-78-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-79-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-80-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-81-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-82-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-83-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-84-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-85-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-86-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-87-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-88-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-89-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-90-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-91-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-92-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-93-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-94-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-95-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-96-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-97-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-98-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-99-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-100-Frame" tabindex="0"></span><br><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0"></span></div><br><span class="MathJax MathJax_Processing" id="MathJax-Element-102-Frame" tabindex="0"></span><br><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0"></span></div><br><span class="MathJax MathJax_Processing" id="MathJax-Element-104-Frame" tabindex="0"></span><br><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0"></span></div><br><span class="MathJax MathJax_Processing" id="MathJax-Element-106-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-107-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-108-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-112-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-113-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-116-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-118-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-121-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-123-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-125-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-127-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-132-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-134-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-135-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-140-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-141-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-142-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-143-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-144-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-145-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-146-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-147-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-148-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-149-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-150-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-151-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-152-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-153-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-154-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-155-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-156-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-157-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-158-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-159-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-160-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-161-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-162-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-163-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-164-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-165-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-166-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-167-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-168-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-169-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-170-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-171-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-172-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-173-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-174-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-175-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-176-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-177-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-178-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-179-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-180-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-181-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-182-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-183-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-184-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-185-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-186-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-187-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-190-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-191-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-192-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-193-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-194-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-195-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-196-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-197-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-198-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-199-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-200-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-201-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-202-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-203-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-204-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-205-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-206-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-207-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-208-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-209-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-210-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-211-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-212-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-213-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-214-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-215-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-216-Frame" tabindex="0"></span><br></div></div><div id="MathJax_Message" style="">Processing math: 100%</div><span style="display:none;" class="csrf-token" data-csrf="73800a8b3b075a7ad0380f5d2d695056">&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }, beforeSend: function(jqXHR, settings) {
        const url = new URL(settings.url, window.location.href);
        const urlHref = url.href;
        url.searchParams.set('rv', Math.random().toString(36).substr(2, 9)); // Generate a random value
        settings.url = url.href;
    }});

    window.updateTypography();
    Codeforces.signForms();
    Codeforces.applyDatatableJs("Hold Ctrl+Alt and click to hide column. Also, you can drag&drop columns to reorder them.");

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        if (json.t === "a") {
            setTimeout(function() {
               Codeforces.showAnnouncements(json.d, "en");
            }, Math.random() * 500);
        }
    }

    function showEventCatcherUserMessage(json) {
        if (json.t === "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        const title = $(this).attr("data-title");
        const clazz = $(this).attr("data-clazz");
        const props = {};
        if (typeof (clazz) !== 'undefined') {
            props['clazz'] = clazz;
        }
        if (title) {
            Codeforces.alert(title, null, null, props);
        } else {
            Codeforces.alert($(this).attr("title"), null, null, props);
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
        

<div class="side-bell" style="visibility: hidden; display: none; opacity: 0.7; width: 40px; position: fixed; right: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 1.5rem;">
    <span class="icon-stack" style="width: 100%;">
        <i class="icon-circle icon-stack-base"></i>
        <i class="icon-bell-alt icon-light"></i>
    </span>
    <br>
    <span class="side-bell__count" style="position: relative; top: -10px;"></span>
</div>


<div id="header" style="position: relative;">

    <div style="float:left; max-height: 60px;">
                            <a href="/"><img height="65" style="height: 65px;" alt="Codeforces" title="Codeforces" src="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png"></a>
    </div>
    <div class="lang-chooser">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" title="In English" alt="In English"></a>
                <a href="?locale=ru"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/ru.png" title="По-русски" alt="По-русски"></a>
            </div>

        <div>
                        <a href="/enter?back=%2Fblog%2Fentry%2F141053">Enter</a>
                     | 
                        <a href="/register">Register</a>
                    
        </div>

    </div>
    <br style="clear: both;">
</div>

        


    <div class="roundbox menu-box borderTopRound borderBottomRound" style="">
    <div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="/">Home</a></li>
                <li class=""><a href="/top">Top</a></li>
                <li class=""><a href="/catalog">Catalog</a></li>
                <li class=""><a href="/contests">Contests</a></li>
                <li class=""><a href="/gyms">Gym</a></li>
                <li class=""><a href="/problemset">Problemset</a></li>
                <li class=""><a href="/groups">Groups</a></li>
                <li class=""><a href="/ratings">Rating</a></li>
                <li class=""><a href="/edu/courses"><span class="edu-menu-item">Edu</span></a></li>
                <li class=""><a href="/apiHelp">API</a></li>
                <li class=""><a href="/calendar">Calendar</a></li>
                <li class=""><a href="/help">Help</a></li>
    </ul>
        <form method="post" action="/search"><input type="hidden" name="csrf_token" value="73800a8b3b075a7ad0380f5d2d695056">
            <input class="search" name="query" data-isplaceholder="true" value="">
        <input type="hidden" name="_tta" value="895"></form>
    <br style="clear: both;">
</div>

    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("input.search").focus(function () {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
        
            <br style="height: 3em; clear: both;">

        <div style="position: relative;">
                        <div id="sidebar">

    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Pay attention
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
        <div style="text-align:center;">
            <span class="contest-state-phase">Before contest</span><br><a href="/contests/2181">2025-2026 ICPC, NERC, Northern Eurasia Finals (Unrated, Online Mirror, ICPC Rules, Teams Preferred)</a><br><span class="countdown" home="//codeforces.com/codeforces.org/s/52448" noredirection="true" textbeforeredirect="" cdid="i1"><span title="67:07:12">3 days</span></span><br><a href="/contestRegistration/2181">Register now »</a>
        </div>
</div>
    </div>

<style data-nocturne="true" type="text/css">
._StreamsSidebarFrame_frame {
  padding: 0.5em 0.5em 0 0.5em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream {
  text-align: center;
  border-bottom: 1px solid #b9b9b9;
  margin: 0 -0.5em 0.5em -0.5em;
  padding: 0 1em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_user {
  margin: 0 0 0.5em 0;
  font-size: 0.8em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_timeMark {
  color: #777;
  font-size: 0.9em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream:last-of-type {
  border-bottom: unset;
  margin: unset;
  padding: 0 0.5em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._viewAll {
  text-align: right;
}
.moreRunningStreamsSidebarNote {
  color: #777 !important;
  text-decoration: none;
}
</style>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Streams
            <div class="top-links">
            </div>
        </div>
            <div class="_StreamsSidebarFrame_frame">
                    <div class="_StreamsSidebarFrame_stream">
                        <div class="_StreamsSidebarFrame_name">
        <p class="_englishName _name">
            
            <a href="/stream/865">Repovive Opening Contest — Solution Discussion</a>
        </p>

                        </div>

                        <div class="_StreamsSidebarFrame_user">
                            By <a href="/profile/Shayan" title="International Grandmaster Shayan" class="rated-user user-red">Shayan</a>
                        </div>

                            <div class="_StreamsSidebarFrame_countdown _StreamsSidebarFrame_timeMark">
                                Before stream
                                <span class="countdown" noredirection="true" cdid="i2">04:42:10</span>
                            </div>
                    </div>
            </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/streams">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

<script data-nocturne="true"> $(function () {

}); </script>


<div class="roundbox sidebox top-contributed borderTopRound " style="">
<div class="caption titled">→ Top rated
<div class="top-links">
</div>
</div>
<table class="rtable ">
<tbody>
<tr>
<th class="left" style="width:2.25em;">#</th>
<th class="">User</th>
<th class="" style="width:5em;">Rating</th>
</tr>
<tr>
<td class="left dark">1</td>
<td class=" dark"><a href="/profile/Kevin114514" title="Legendary Grandmaster Kevin114514" class="rated-user user-legendary"><span class="legendary-user-first-letter">K</span>evin114514</a></td>
<td class=" dark">3765</td>
</tr>
<tr>
<td class="left ">2</td>
<td class=""><a href="/profile/tourist" title="Legendary Grandmaster tourist" class="rated-user user-legendary"><span class="legendary-user-first-letter">t</span>ourist</a></td>
<td class="">3757</td>
</tr>
<tr>
<td class="left dark">3</td>
<td class=" dark"><a href="/profile/Benq" title="Legendary Grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></td>
<td class=" dark">3738</td>
</tr>
<tr>
<td class="left ">4</td>
<td class=""><a href="/profile/jiangly" title="Legendary Grandmaster jiangly" class="rated-user user-legendary"><span class="legendary-user-first-letter">j</span>iangly</a></td>
<td class="">3705</td>
</tr>
<tr>
<td class="left dark">5</td>
<td class=" dark"><a href="/profile/orzdevinwang" title="Legendary Grandmaster orzdevinwang" class="rated-user user-legendary"><span class="legendary-user-first-letter">o</span>rzdevinwang</a></td>
<td class=" dark">3670</td>
</tr>
<tr>
<td class="left ">6</td>
<td class=""><a href="/profile/ksun48" title="Legendary Grandmaster ksun48" class="rated-user user-legendary"><span class="legendary-user-first-letter">k</span>sun48</a></td>
<td class="">3668</td>
</tr>
<tr>
<td class="left dark">7</td>
<td class=" dark"><a href="/profile/Radewoosh" title="Legendary Grandmaster Radewoosh" class="rated-user user-legendary"><span class="legendary-user-first-letter">R</span>adewoosh</a></td>
<td class=" dark">3531</td>
</tr>
<tr>
<td class="left ">8</td>
<td class=""><a href="/profile/maroonrk" title="Legendary Grandmaster maroonrk" class="rated-user user-legendary"><span class="legendary-user-first-letter">m</span>aroonrk</a></td>
<td class="">3443</td>
</tr>
<tr>
<td class="left dark">9</td>
<td class=" dark"><a href="/profile/dXqwq" title="Legendary Grandmaster dXqwq" class="rated-user user-legendary"><span class="legendary-user-first-letter">d</span>Xqwq</a></td>
<td class=" dark">3436</td>
</tr>
<tr>
<td class="left bottom">10</td>
<td class="bottom"><a href="/profile/Nachia" title="Legendary Grandmaster Nachia" class="rated-user user-legendary"><span class="legendary-user-first-letter">N</span>achia</a></td>
<td class="bottom">3432</td>
</tr>
</tbody>
</table>
<div class="bottom-links">
<table style="width:100%;">
<tbody>
<tr>
<td style="text-align:left;">
<a href="/ratings/countries">Countries</a> |
<a href="/ratings/cities">Cities</a> |
<a href="/ratings/organizations">Organizations</a>
</td>
<td style="text-align:right;">
<a href="/ratings">View all →</a>
</td>
</tr>
</tbody>
</table>
</div>
</div>


    <div class="roundbox sidebox top-contributed borderTopRound " style="">
        <div class="caption titled">→ Top contributors
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:2.25em;">#</th>
                            <th class="">User</th>
                            <th class="" style="width:5em;">Contrib.</th>
                </tr>
                    <tr>
                                <td class="left  dark">1</td>
                                <td class=" dark"><a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a></td>
                                <td class=" dark">169</td>
                    </tr>
                    <tr>
                                <td class="left ">2</td>
                                <td class=""><a href="/profile/Qingyu" title="Legendary Grandmaster Qingyu" class="rated-user user-legendary"><span class="legendary-user-first-letter">Q</span>ingyu</a></td>
                                <td class="">166</td>
                    </tr>
                    <tr>
                                <td class="left  dark">3</td>
                                <td class=" dark"><a href="/profile/errorgorn" title="Legendary Grandmaster errorgorn" class="rated-user user-legendary"><span class="legendary-user-first-letter">e</span>rrorgorn</a></td>
                                <td class=" dark">163</td>
                    </tr>
                    <tr>
                                <td class="left ">4</td>
                                <td class=""><a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a></td>
                                <td class="">156</td>
                    </tr>
                    <tr>
                                <td class="left  dark">5</td>
                                <td class=" dark"><a href="/profile/Proof_by_QED" title="Master Proof_by_QED" class="rated-user user-orange">Proof_by_QED</a></td>
                                <td class=" dark">152</td>
                    </tr>
                    <tr>
                                <td class="left ">6</td>
                                <td class=""><a href="/profile/Dominater069" title="Legendary Grandmaster Dominater069" class="rated-user user-legendary"><span class="legendary-user-first-letter">D</span>ominater069</a></td>
                                <td class="">150</td>
                    </tr>
                    <tr>
                                <td class="left  dark">7</td>
                                <td class=" dark"><a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a></td>
                                <td class=" dark">149</td>
                    </tr>
                    <tr>
                                <td class="left ">8</td>
                                <td class=""><a href="/profile/TheScrasse" title="Grandmaster TheScrasse" class="rated-user user-red">TheScrasse</a></td>
                                <td class="">144</td>
                    </tr>
                    <tr>
                                <td class="left  dark">9</td>
                                <td class=" dark"><a href="/profile/soullless" title="Master soullless" class="rated-user user-orange">soullless</a></td>
                                <td class=" dark">143</td>
                    </tr>
                    <tr>
                                <td class="left bottom">10</td>
                                <td class="bottom"><a href="/profile/Arpa" title="International Master Arpa" class="rated-user user-orange">Arpa</a></td>
                                <td class="bottom">141</td>
                    </tr>
            </tbody>
        </table>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/top-contributed">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
        });
    </script>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Find user
            <div class="top-links">
            </div>
        </div>
        <form class="handleForm" method="post" autocomplete="off"><input type="hidden" name="csrf_token" value="73800a8b3b075a7ad0380f5d2d695056">
            <div style="padding:1em;text-align:right;">
                <label style="padding-right:1em;">Handle:
                    <input style="width:12em;" type="text" class="handleBox ac_input" autocomplete="off">
                </label>
            </div>
            <div style="padding: 0 1em 1em 1em;text-align:right;">
                <input style="height:1.65em;padding:0 0.75em;" type="submit" value="Find">
            </div>
        <input type="hidden" name="_tta" value="895"></form>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".handleBox").autocompleteHandle();
    $(".handleForm").attr("autocomplete", "off").submit(function () {
        var link = "/profile/userHandle".replace(
            "userHandle", $(this).find(".handleBox").val()
        );
        window.location = link;
        return false;
    });
        });
    </script>





    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Recent actions
            <div class="top-links">
            </div>
        </div>
        <div class="recent-actions">
            <ul>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/phosphorqq" title="Newbie phosphorqq" class="rated-user user-gray">phosphorqq</a>        →
        <a href="/blog/entry/149227">дисциплина</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/atcoder_official" title="Unrated, atcoder_official" class="rated-user user-black">atcoder_official</a>        →
        <a href="/blog/entry/149183">AtCoder Beginner Contest 436 Announcement</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Priyansh31dec" title="Master Priyansh31dec" class="rated-user user-orange">Priyansh31dec</a>        →
        <a href="/blog/entry/149065">Video Solutions for CSES Problemset by TLE Eliminators</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/147893">Hacker Cup Round 1 Recap</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ko_osaga" title="Legendary Grandmaster ko_osaga" class="rated-user user-legendary"><span class="legendary-user-first-letter">k</span>o_osaga</a>        →
        <a href="/blog/entry/146988">Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/chenhongrui" title="Master chenhongrui" class="rated-user user-orange">chenhongrui</a>        →
        <a href="/blog/entry/149032">A Concern Regarding AI</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/kisuke_007" title="Pupil kisuke_007" class="rated-user user-green">kisuke_007</a>        →
        <a href="/blog/entry/110589">How to fix this?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ABalobanov" title="Expert ABalobanov" class="rated-user user-blue">ABalobanov</a>        →
        <a href="/blog/entry/149154">Codeforces Round 1070 (Div.2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/MathModel" title="Expert MathModel" class="rated-user user-blue">MathModel</a>        →
        <a href="/blog/entry/149013">Invitation to Eolymp Blitz #8 (Rating Upto 1750)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Coxin_Hor" title="Expert Coxin_Hor" class="rated-user user-blue">Coxin_Hor</a>        →
        <a href="/blog/entry/149220">A fun contest I created myself.</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/saPaul" title="Pupil saPaul" class="rated-user user-green">saPaul</a>        →
        <a href="/blog/entry/149221">[Update] CF FetchCodes v25.12.7: Smart Retries, Lazy Loading &amp; Instant Caching!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a>        →
        <a href="/blog/entry/149218">Finding all primes up to half a billion in 83 ms</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/awoo" title="Grandmaster awoo" class="rated-user user-red">awoo</a>        →
        <a href="/blog/entry/117791">Educational Codeforces Round 151 Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/alireza_kaviani" title="International Grandmaster alireza_kaviani" class="rated-user user-red">alireza_kaviani</a>        →
        <a href="/blog/entry/148411">Repovive Opening Contest</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/flamestorm" title="International Master flamestorm" class="rated-user user-orange">flamestorm</a>        →
        <a href="/blog/entry/104310">Codeforces Round #803 (Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SilverTongue1729" title="Candidate Master SilverTongue1729" class="rated-user user-violet">SilverTongue1729</a>        →
        <a href="/blog/entry/149213">Codeforces Profile Preview — Chrome Extension</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Xiaohuba" title="Master Xiaohuba" class="rated-user user-orange">Xiaohuba</a>        →
        <a href="/blog/entry/148062">Codeforces Global Round 30</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Ashwanth.K" title="Master Ashwanth.K" class="rated-user user-orange">Ashwanth.K</a>        →
        <a href="/blog/entry/149201">SOS DP easy understanding</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/BreakingNut" title="Specialist BreakingNut" class="rated-user user-cyan">BreakingNut</a>        →
        <a href="/blog/entry/149177">Solved the Problem, Lost the Girlfriend</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ProblemTerminator" title="International Master ProblemTerminator" class="rated-user user-orange">ProblemTerminator</a>        →
        <a href="/blog/entry/149005">pls ban cheater sinha_yash and rollback the rating</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a>        →
        <a href="/blog/entry/137325">GIFs in Problem Statements are Broken</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a>        →
        <a href="/blog/entry/146705">On AI ruining "solving math problems with computer" [a year later]</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/m_manasc" title="Pupil m_manasc" class="rated-user user-green">m_manasc</a>        →
        <a href="/blog/entry/149219">An interesting problem</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/148802">Meta Hacker Cup Round 3</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Top12" title="Expert Top12" class="rated-user user-blue">Top12</a>        →
        <a href="/blog/entry/149216">From TLE to AC using magic!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
            </ul>
        </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/recent-actions">Detailed →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>
</div>
                        <div id="pageContent" class="content-with-sidebar">
                    <div class="second-level-menu">
<ul class="second-level-menu-list"><li class="backLava" style="position: absolute; display: block; margin: 0px; padding: 0px; left: 54.3906px; top: 0px; width: 39px; height: 20px;"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li><a href="/profile/Ecrade_">Ecrade_</a></li>
        <li class="current selectedLava"><a href="/blog/Ecrade_">Blog</a></li>
        <li><a href="/teams/with/Ecrade_">Teams</a></li>
        <li><a href="/submissions/Ecrade_">Submissions</a></li>
        <li><a href="/groups/with/Ecrade_">Groups</a></li>
        <li><a href="/contests/with/Ecrade_">Contests</a></li>
        <li><a href="/contests/writer/Ecrade_">Problemsetting</a></li>
</ul>
</div>
    <div style="margin-top:0;">
    <div>
        <h3><a href="/blog/Ecrade_" style="text-decoration:none;color:black !important;">Ecrade_'s blog</a></h3>
    </div>
        <div style="margin-top:2em;">


<div class="has-topic-id topic" topicid="141679">
    <div class="title">
            <a href="/blog/entry/141053">            <p>Codeforces Round 1012 (Div.1, Div. 2, based on THUPC 2025 — Finals) Editorial</p>
</a>
    </div>

        <div class="info" style="position:relative;">
                By&nbsp;<a href="/profile/Ecrade_" title="Grandmaster Ecrade_" class="rated-user user-red">Ecrade_</a>,
                    <span class="format-humantime" title="Mar/26/2025 01:48 UTC">9 months ago</span>,
                
                <img style="position: relative;top: 5px;" src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" alt="In English" title="In English">



            <div class="topic-actions smaller">
                <ul>


                </ul>
            </div>
        </div>

    <div class="content">
        <div class="ttypography"><p>We apologize for the late editorial. </p><p><a href="/contest/2090/problem/A" title="Codeforces Round 1012 (Div. 2)">2090A - Treasure Hunt</a> <br> Idea: <a class="rated-user user-orange" href="/profile/_Lucien" title="Master _Lucien">_Lucien</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>Let's calculate how many operations we need. The number of pairs of operations is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mrow" id="MJXp-Span-2"><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-4" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">a</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">x</span><span class="MJXp-mo" id="MJXp-Span-7">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span></span></span><script type="math/tex" id="MathJax-Element-1">\left\lfloor\frac{a}{x + y}\right\rfloor</script>. Additionally, we add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-10"><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0em; margin-right: 0.111em;">+</span><span class="MJXp-mn" id="MJXp-Span-12">1</span></span></span><script type="math/tex" id="MathJax-Element-2">+1</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">a</span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">x</span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">y</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">x</span></span></span><script type="math/tex" id="MathJax-Element-3">(a \bmod (x + y)) \ge x</script>, because in this case, the first player will be able to make one more move. Note that the first part is always even, which means the answer depends only on whether <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">a</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">x</span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">y</span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">x</span></span></span><script type="math/tex" id="MathJax-Element-4">(a \bmod (x + y)) \ge x</script>, and in this case, the answer is YES.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x </span><span class="pun">&gt;&gt;</span><span class="pln"> y </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"NO\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"YES\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2090/problem/B" title="Codeforces Round 1012 (Div. 2)">2090B - Pushing Balls</a> <br> Idea: <a class="rated-user user-red" href="/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>We can transform the problem into: select a row / column and replace the leftmost / topmost <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-mn" id="MJXp-Span-38">0</span></span></span><script type="math/tex" id="MathJax-Element-5">0</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-39"><span class="MJXp-mn" id="MJXp-Span-40">1</span></span></span><script type="math/tex" id="MathJax-Element-6">1</script>. Then the solution is clear: if, for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-41"><span class="MJXp-mn" id="MJXp-Span-42">1</span></span></span><script type="math/tex" id="MathJax-Element-7">1</script> in the grid, there does not exist any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-43"><span class="MJXp-mn" id="MJXp-Span-44">0</span></span></span><script type="math/tex" id="MathJax-Element-8">0</script> on its top, or does not exist any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-45"><span class="MJXp-mn" id="MJXp-Span-46">0</span></span></span><script type="math/tex" id="MathJax-Element-9">0</script> on its left, then the answer is YES; otherwise NO.</p><p>But how to prove that if the condition is satisfied, we can always construct a valid series of ball-pushing operations? We can consider the problem in reverse order: given the final state, if, for an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-47"><span class="MJXp-mn" id="MJXp-Span-48">1</span></span></span><script type="math/tex" id="MathJax-Element-10">1</script> in the grid, there does not exist any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-49"><span class="MJXp-mn" id="MJXp-Span-50">0</span></span></span><script type="math/tex" id="MathJax-Element-11">0</script> on its top, or does not exist any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-51"><span class="MJXp-mn" id="MJXp-Span-52">0</span></span></span><script type="math/tex" id="MathJax-Element-12">0</script> on its left, then we can turn it into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-53"><span class="MJXp-mn" id="MJXp-Span-54">0</span></span></span><script type="math/tex" id="MathJax-Element-13">0</script>, and our goal is to turn all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-55"><span class="MJXp-mn" id="MJXp-Span-56">1</span></span></span><script type="math/tex" id="MathJax-Element-14">1</script> s into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-57"><span class="MJXp-mn" id="MJXp-Span-58">0</span></span></span><script type="math/tex" id="MathJax-Element-15">0</script> s. We can always reach the goal if we choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-59"><span class="MJXp-mn" id="MJXp-Span-60">1</span></span></span><script type="math/tex" id="MathJax-Element-16">1</script> s in descending order of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">i</span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">j</span></span></span><script type="math/tex" id="MathJax-Element-17">i+j</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">i</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">j</span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-18">(i,j)</script> is their coordinates in the grid.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="lit">59</span><span class="pun">][</span><span class="lit">59</span><span class="pun">],</span><span class="pln">vis</span><span class="pun">[</span><span class="lit">59</span><span class="pun">][</span><span class="lit">59</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">char</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">59</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ll read</span><span class="pun">(){</span><span class="pln">
	ll s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">)</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">^</span><span class="pln"> </span><span class="lit">48</span><span class="pun">),</span><span class="pln">ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	t </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">
		n </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">m </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			scanf</span><span class="pun">(</span><span class="str">"%s"</span><span class="pun">,</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
				a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">;</span><span class="pln">
				vis</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				vis</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				vis</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">bool</span><span class="pln"> fl </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">&amp;&amp;</span><span class="pln"> fl</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">!</span><span class="pln">vis</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]){</span><span class="pln">
					fl </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		puts</span><span class="pun">(</span><span class="pln">fl </span><span class="pun">?</span><span class="pln"> </span><span class="str">"YES"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"NO"</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2090/problem/C" title="Codeforces Round 1012 (Div. 2)">2090C - Dining Hall</a> <br> Idea: <a class="rated-user user-orange" href="/profile/myee" title="International Master myee">myee</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><blockquote><p>Original idea from <a class="rated-user user-orange" href="/profile/myee" title="International Master myee">myee</a> has <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mn" id="MJXp-Span-72">4</span></span></span><script type="math/tex" id="MathJax-Element-19">4</script> cases, which is a medium difficulty problem using deletable heap. You may find the original statement in zh-cn on GitHub later.</p><p>The Codeforces version by <a class="rated-user user-red" href="/profile/FairyWinx" title="Grandmaster FairyWinx">FairyWinx</a> has only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-73"><span class="MJXp-mn" id="MJXp-Span-74">2</span></span></span><script type="math/tex" id="MathJax-Element-20">2</script> cases, in order to meet the difficulty as Div2C.</p><p>The En/Ru statement changes for times after checking. Sorry for the inconvenience.</p> </blockquote><p>Firstly we can get the distance of each cell by BFS or Math Way: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-75"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">d</span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">x</span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">y</span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">x</span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">y</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-87">2</span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">x</span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-91">3</span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">y</span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-95">3</span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-97">2</span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-21">d(x,y)=x+y+2[x\bmod3=y\bmod3=2]</script>.</p><p><img alt=" " src="https://espresso.codeforces.com/db9590b32cd739d8aff4b52b22fba9065f198177.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>The proof is trivial.</p><p>Then we can sort out the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-99"><span class="MJXp-mn" id="MJXp-Span-100">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">n</span></span></span><script type="math/tex" id="MathJax-Element-22">4n</script> table cell with the lowest distance in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">O</span><span class="MJXp-mo" id="MJXp-Span-104" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">n</span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-23">O(n)</script> time: by BFS or enumerating possible <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">d</span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">x</span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">y</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">k</span></span></span><script type="math/tex" id="MathJax-Element-24">d(x,y)=k</script>.</p><p>Suppose we record whether a table cell is occupied or not by a bool array. Then we can check whether a cell can be allowed to go by someone <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">o</span><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-119">0</span><span class="MJXp-mrow" id="MJXp-Span-120"><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-122">1</span></span></span><script type="math/tex" id="MathJax-Element-25">o=0/1</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">O</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-126">1</span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-26">O(1)</script> time.</p><p>Suppose the shortest table cell we can choose is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-msubsup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-131" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-27">x_0</script> -th and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-msubsup" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-135" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-28">x_1</script> -th ones, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-msubsup" id="MJXp-Span-137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-139" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-143" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-145">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">n</span></span></span><script type="math/tex" id="MathJax-Element-29">x_1\le x_0\le4n</script>. We can keep trying the smallest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-147"><span class="MJXp-msubsup" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-150" style="vertical-align: -0.4em;">o</span></span></span></span><script type="math/tex" id="MathJax-Element-30">x_o</script> until it's okay.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">O</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">n</span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-31">O(n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> bol </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">bool</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> T</span><span class="pun">=</span><span class="lit">2000</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> R</span><span class="pun">=</span><span class="lit">200000</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">uint</span><span class="pln"> </span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">R</span><span class="pun">+</span><span class="lit">5</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">uint</span><span class="pln"> </span><span class="typ">Nxt</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> p</span><span class="pun">,</span><span class="kwd">uint</span><span class="pln"> o</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">uint</span><span class="pln"> x</span><span class="pun">=</span><span class="pln">p</span><span class="pun">/</span><span class="pln">T</span><span class="pun">,</span><span class="pln">y</span><span class="pun">=</span><span class="pln">p</span><span class="pun">%</span><span class="pln">T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">o</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">/</span><span class="lit">3</span><span class="pun">*</span><span class="lit">3</span><span class="pun">+</span><span class="lit">3</span><span class="pun">-</span><span class="pln">y</span><span class="pun">%</span><span class="lit">3</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">o</span><span class="pun">&amp;</span><span class="lit">2</span><span class="pun">)</span><span class="pln">x</span><span class="pun">=</span><span class="pln">x</span><span class="pun">/</span><span class="lit">3</span><span class="pun">*</span><span class="lit">3</span><span class="pun">+</span><span class="lit">3</span><span class="pun">-</span><span class="pln">x</span><span class="pun">%</span><span class="lit">3</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">*</span><span class="pln">T</span><span class="pun">+</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

bol G</span><span class="pun">[</span><span class="lit">2</span><span class="pun">][</span><span class="pln">T</span><span class="pun">*</span><span class="pln">T</span><span class="pun">];</span><span class="kwd">uint</span><span class="pln"> </span><span class="typ">Ans</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
</span><span class="com">#ifdef</span><span class="pln"> MYEE
    freopen</span><span class="pun">(</span><span class="str">"QAQ.in"</span><span class="pun">,</span><span class="str">"r"</span><span class="pun">,</span><span class="pln">stdin</span><span class="pun">);</span><span class="pln">
    freopen</span><span class="pun">(</span><span class="str">"QAQ.out"</span><span class="pun">,</span><span class="str">"w"</span><span class="pun">,</span><span class="pln">stdout</span><span class="pun">);</span><span class="pln">
</span><span class="com">#endif</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">,</span><span class="pln">tp</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&amp;&amp;</span><span class="pln">tp</span><span class="pun">&lt;</span><span class="pln">R</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">%</span><span class="lit">3</span><span class="pun">==</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&lt;</span><span class="pln">i</span><span class="pun">&amp;&amp;</span><span class="pln">tp</span><span class="pun">&lt;</span><span class="pln">R</span><span class="pun">;</span><span class="pln">x</span><span class="pun">+=</span><span class="lit">3</span><span class="pun">)</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">++]=</span><span class="pln">x</span><span class="pun">*</span><span class="pln">T</span><span class="pun">+</span><span class="pln">i</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">i</span><span class="pun">%</span><span class="lit">3</span><span class="pun">))</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&lt;=</span><span class="pln">i</span><span class="pun">-</span><span class="lit">2</span><span class="pun">&amp;&amp;</span><span class="pln">tp</span><span class="pun">&lt;</span><span class="pln">R</span><span class="pun">;</span><span class="pln">x</span><span class="pun">++)</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x</span><span class="pun">%</span><span class="lit">3</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">++]=</span><span class="pln">x</span><span class="pun">*</span><span class="pln">T</span><span class="pun">+</span><span class="pln">i</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x</span><span class="pun">%</span><span class="lit">3</span><span class="pun">==</span><span class="lit">2</span><span class="pun">)</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">++]=</span><span class="pln">x</span><span class="pun">*</span><span class="pln">T</span><span class="pun">+</span><span class="pln">i</span><span class="pun">-</span><span class="pln">x</span><span class="pun">-</span><span class="lit">2</span><span class="pun">,</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">++]=</span><span class="pln">x</span><span class="pun">*</span><span class="pln">T</span><span class="pun">+</span><span class="pln">i</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        </span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">++]=(</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)*</span><span class="pln">T</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">uint</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%u"</span><span class="pun">,&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">uint</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%u"</span><span class="pun">,&amp;</span><span class="pln">q</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">q</span><span class="pun">*</span><span class="lit">4</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">G</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]=</span><span class="pln">G</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="typ">Ans</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]=</span><span class="typ">Ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">q</span><span class="pun">--)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">uint</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%u"</span><span class="pun">,&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">G</span><span class="pun">[</span><span class="pln">t</span><span class="pun">][</span><span class="typ">Ord</span><span class="pun">[</span><span class="typ">Ans</span><span class="pun">[</span><span class="pln">t</span><span class="pun">]]])</span><span class="typ">Ans</span><span class="pun">[</span><span class="pln">t</span><span class="pun">]++;</span><span class="pln">
            t</span><span class="pun">=</span><span class="typ">Ord</span><span class="pun">[</span><span class="typ">Ans</span><span class="pun">[</span><span class="pln">t</span><span class="pun">]];</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"%u %u\n"</span><span class="pun">,</span><span class="pln">t</span><span class="pun">/</span><span class="pln">T</span><span class="pun">,</span><span class="pln">t</span><span class="pun">%</span><span class="pln">T</span><span class="pun">);</span><span class="pln">
            G</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="pln">t</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> o</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">o</span><span class="pun">&lt;</span><span class="lit">4</span><span class="pun">;</span><span class="pln">o</span><span class="pun">++)</span><span class="pln">G</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="typ">Nxt</span><span class="pun">(</span><span class="pln">t</span><span class="pun">,</span><span class="pln">o</span><span class="pun">)]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2089/problem/A" title="Codeforces Round 1012 (Div. 1)">2089A - Simple Permutation</a> <br> Idea: <a class="rated-user user-legendary" href="/profile/QuietBeautifulThoughts" title="Legendary Grandmaster QuietBeautifulThoughts"><span class="legendary-user-first-letter">Q</span>uietBeautifulThoughts</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p><strong>Lemma (Bertrand's postulate):</strong> For each positive integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">x</span></span></span><script type="math/tex" id="MathJax-Element-32">x</script>, there is a prime <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">p</span></span></span><script type="math/tex" id="MathJax-Element-33">p</script> inside the interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-160"><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">x</span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-164">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">x</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-34">[x,2x]</script>. </p><p>Find a prime number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">p</span></span></span><script type="math/tex" id="MathJax-Element-35">p</script> between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-169"><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-171" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-173">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-36">\lfloor \frac{n}{3} \rfloor</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-175"><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mfrac" id="MJXp-Span-177" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-178">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-180">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span><script type="math/tex" id="MathJax-Element-37">\lceil \frac{2n}{3} \rceil</script>, and construct the permutation in an alternating way: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">p</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">p</span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-187">1</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">p</span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-191">1</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">p</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-195">2</span><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">p</span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-199">2</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-38">p, p-1, p+1, p-2, p+2, \dots</script>. Place the remaining numbers arbitrarily.</p><p>In this construction, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-202"><span class="MJXp-msubsup" id="MJXp-Span-203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-205" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-209" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-213" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-219" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-220">2</span><span class="MJXp-mo" id="MJXp-Span-221">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-222" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-224">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-225">⌋</span><span class="MJXp-mo" id="MJXp-Span-226">−</span><span class="MJXp-mn" id="MJXp-Span-227">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">p</span></span></span><script type="math/tex" id="MathJax-Element-39">c_1 = c_3 = c_5 = \dots = c_{2 \lfloor \frac{n}{3} \rfloor - 1} = p</script>, which meets the requirement with at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-232" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-234">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-40">\lfloor \frac{n}{3} \rfloor</script> numbers being prime.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">bool</span><span class="pln"> isPrime</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> i </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> x </span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">%</span><span class="pln"> i </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

vector</span><span class="str">&lt;int&gt;</span><span class="pln"> generateSol</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
	ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">p</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
			ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">p </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p </span><span class="pun">+</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln">
			ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">p </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> t </span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		vector </span><span class="pun">&lt;</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">x</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">isPrime</span><span class="pun">(</span><span class="pln">n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">)){</span><span class="pln">
				ans </span><span class="pun">=</span><span class="pln"> generateSol</span><span class="pun">(</span><span class="pln">n </span><span class="pun">,</span><span class="pln"> n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
				</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">isPrime</span><span class="pun">(</span><span class="pln">n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> x</span><span class="pun">)){</span><span class="pln">
				ans </span><span class="pun">=</span><span class="pln"> generateSol</span><span class="pun">(</span><span class="pln">n </span><span class="pun">,</span><span class="pln"> n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
				</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
			cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" \n"</span><span class="pun">[</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2089/problem/B1" title="Codeforces Round 1012 (Div. 1)">2089B1 - Canteen (Easy Version)</a> <br> Idea: <a class="rated-user user-red" href="/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-236"><span class="MJXp-msubsup" id="MJXp-Span-237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-239" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-41"> a_i </script>, calculate the minimum number of cyclic right shifts required to reduce it to zero, denoted as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-240"><span class="MJXp-msubsup" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-243" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-42"> d_i </script>. The answer is the maximum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-244"><span class="MJXp-msubsup" id="MJXp-Span-245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-247" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-43"> d_i </script> across all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">i</span></span></span><script type="math/tex" id="MathJax-Element-44"> i </script>. </p><p>For cyclic problems, we can consider breaking the cycle into a chain (i.e., let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-msubsup" id="MJXp-Span-251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-253" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">i</span><span class="MJXp-mo" id="MJXp-Span-255">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-260" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-45"> a_{i+n} = a_i </script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-msubsup" id="MJXp-Span-262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-264" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">i</span><span class="MJXp-mo" id="MJXp-Span-266">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-271" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-46"> b_{i+n} = b_i </script>). </p><p>Consider constructing a parenthesis sequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">s</span></span></span><script type="math/tex" id="MathJax-Element-47"> s </script> by concatenating <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-274"><span class="MJXp-msubsup" id="MJXp-Span-275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-277" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-48"> a_0 </script> left parentheses, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-msubsup" id="MJXp-Span-279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-281" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-49"> b_0 </script> right parentheses, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-282"><span class="MJXp-msubsup" id="MJXp-Span-283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-285" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-50"> a_1 </script> left parentheses, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-msubsup" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-289" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-51"> b_1 </script> right parentheses, ... ,<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-msubsup" id="MJXp-Span-291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-293" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-294">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">n</span><span class="MJXp-mo" id="MJXp-Span-296">−</span><span class="MJXp-mn" id="MJXp-Span-297">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-52"> a_{2n-1} </script> left parentheses and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-298"><span class="MJXp-msubsup" id="MJXp-Span-299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-301" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-302">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">n</span><span class="MJXp-mo" id="MJXp-Span-304">−</span><span class="MJXp-mn" id="MJXp-Span-305">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-53"> b_{2n-1} </script> right parentheses. The operation in the original problem corresponds to the process of matching parentheses in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">s</span></span></span><script type="math/tex" id="MathJax-Element-54"> s </script>:</p> <ul>   <li>"Set the smaller of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-308"><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-312" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-316" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-55">(a_i, b_i)</script> to zero and the larger to their difference" <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-318"><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0.333em; margin-right: 0.333em;">⇒</span></span></span><script type="math/tex" id="MathJax-Element-56">\Rightarrow</script> "Match the parentheses corresponding to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-320"><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-324" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-328" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-57">(a_i, b_i)</script>".</li>   <li>"Cyclically right-shift <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">a</span></span></span><script type="math/tex" id="MathJax-Element-58"> a </script>" <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-332"><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0.333em; margin-right: 0.333em;">⇒</span></span></span><script type="math/tex" id="MathJax-Element-59">\Rightarrow</script> "Unmatched left parentheses continue to find matching right parentheses".</li> </ul><p>The first time <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-334"><span class="MJXp-msubsup" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-337" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-60"> a_i </script> is reduced to zero depends on which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-338"><span class="MJXp-msubsup" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-341" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-61"> b_j </script> ’s right parenthesis matches the leftmost parenthesis corresponding to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-342"><span class="MJXp-msubsup" id="MJXp-Span-343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-345" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-62"> a_i </script>. </p><p>We can use prefix sums to find matchings of the parenthesis: Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-346"><span class="MJXp-msubsup" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-349" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-351"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357" style="margin-right: 0px; margin-left: 0px;">i</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-353" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">j</span><span class="MJXp-mo" id="MJXp-Span-355">=</span><span class="MJXp-mn" id="MJXp-Span-356">0</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-361" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-365" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-63"> c_i = \sum\limits_{j=0}^i (a_j - b_j) </script>. Define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-367"><span class="MJXp-msubsup" id="MJXp-Span-368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-370" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-64"> p_i </script> as the smallest index satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-371"><span class="MJXp-msubsup" id="MJXp-Span-372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-374" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">i</span></span></span><script type="math/tex" id="MathJax-Element-65"> p_i > i </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-377"><span class="MJXp-msubsup" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-380" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-383" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-387" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-66"> c_{p_i} \leq c_i </script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-388"><span class="MJXp-msubsup" id="MJXp-Span-389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-391" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-395" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">i</span></span></span><script type="math/tex" id="MathJax-Element-67"> d_i = p_i - i </script>. We can compute all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-398"><span class="MJXp-msubsup" id="MJXp-Span-399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-401" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-68"> p_i </script> with a monotonic stack.</p><p>It should be pointed out that matching parentheses is just an intuitive way of understanding the solution. You can, of course, also draw the above conclusion by direct observation.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">O</span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">n</span><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-69"> O(\sum n) </script>. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">k</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="lit">400009</span><span class="pun">],</span><span class="pln">stk</span><span class="pun">[</span><span class="lit">400009</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ll read</span><span class="pun">(){</span><span class="pln">
	ll s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">)</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">^</span><span class="pln"> </span><span class="lit">48</span><span class="pun">),</span><span class="pln">ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	t </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">
		n </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">k </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		ll tp </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tp </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">stk</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> tp </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln">stk</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
			stk</span><span class="pun">[++</span><span class="pln"> tp</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2089/problem/B2" title="Codeforces Round 1012 (Div. 1)">2089B2 - Canteen (Hard Version)</a> <br> Idea: <a class="rated-user user-red" href="/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>We can use binary search on the answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">x</span></span></span><script type="math/tex" id="MathJax-Element-70"> x </script>, and calculate the minimum number of changes needed to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">a</span></span></span><script type="math/tex" id="MathJax-Element-71">a</script> zero within <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">x</span></span></span><script type="math/tex" id="MathJax-Element-72"> x </script> rounds.</p><p>However, direct computation on the cyclic chain of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-414"><span class="MJXp-mn" id="MJXp-Span-415">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">n</span></span></span><script type="math/tex" id="MathJax-Element-73"> 2n </script> elements is troublesome (due to overlapping contributions). Instead, we can cyclically shift <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">a</span></span></span><script type="math/tex" id="MathJax-Element-74"> a </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">b</span></span></span><script type="math/tex" id="MathJax-Element-75"> b </script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-421"><span class="MJXp-msubsup" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-424" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">n</span><span class="MJXp-mo" id="MJXp-Span-426">−</span><span class="MJXp-mn" id="MJXp-Span-427">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-429"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-435" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">n</span><span class="MJXp-mo" id="MJXp-Span-437">−</span><span class="MJXp-mn" id="MJXp-Span-438">1</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-431" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">i</span><span class="MJXp-mo" id="MJXp-Span-433">=</span><span class="MJXp-mn" id="MJXp-Span-434">0</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-441" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-76"> c_{n-1} = \min\limits_{i=0}^{n-1} c_i</script>, which ensures that no <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-442"><span class="MJXp-msubsup" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-445" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">n</span><span class="MJXp-mo" id="MJXp-Span-447">−</span><span class="MJXp-mn" id="MJXp-Span-448">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-450">0</span></span></span><script type="math/tex" id="MathJax-Element-77"> a_{n-1}>0 </script> will be cyclically shifted to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-451"><span class="MJXp-msubsup" id="MJXp-Span-452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-454" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-78">a_0</script>, enabling us to only consider the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">n</span></span></span><script type="math/tex" id="MathJax-Element-79">n</script> elements of the chain.</p><p>For the adjusted <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">a</span></span></span><script type="math/tex" id="MathJax-Element-80"> a </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">b</span></span></span><script type="math/tex" id="MathJax-Element-81"> b </script>, we can greedily process <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">i</span></span></span><script type="math/tex" id="MathJax-Element-82"> i </script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">n</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">x</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-468">1</span></span></span><script type="math/tex" id="MathJax-Element-83"> n - x - 1 </script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-469"><span class="MJXp-mo" id="MJXp-Span-470" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-471">1</span></span></span><script type="math/tex" id="MathJax-Element-84"> -1 </script>: If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-472"><span class="MJXp-munderover" id="MJXp-Span-473"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-481" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">i</span><span class="MJXp-mo" id="MJXp-Span-483">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">x</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-475" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">j</span><span class="MJXp-mo" id="MJXp-Span-477">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">i</span><span class="MJXp-mo" id="MJXp-Span-479">+</span><span class="MJXp-mn" id="MJXp-Span-480">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-487" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-491" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-85"> \min\limits_{j=i+1}^{i+x}c_j > c_i </script>, then we should apply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-munderover" id="MJXp-Span-493"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-501" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">i</span><span class="MJXp-mo" id="MJXp-Span-503">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">x</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-495" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">j</span><span class="MJXp-mo" id="MJXp-Span-497">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">i</span><span class="MJXp-mo" id="MJXp-Span-499">+</span><span class="MJXp-mn" id="MJXp-Span-500">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-507" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-511" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-86"> \min\limits_{j=i+1}^{i+x}c_j - c_i </script> changes to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-512"><span class="MJXp-msubsup" id="MJXp-Span-513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-515" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">i</span><span class="MJXp-mo" id="MJXp-Span-517">+</span><span class="MJXp-mn" id="MJXp-Span-518">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-87"> a_{i+1} </script> (assume that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-519"><span class="MJXp-msubsup" id="MJXp-Span-520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-522" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-523">−</span><span class="MJXp-mn" id="MJXp-Span-524">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-526">0</span></span></span><script type="math/tex" id="MathJax-Element-88">c_{-1}=0</script>). We can also use a monotonic stack to maintain the whole process. </p><p>Note that if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-527"><span class="MJXp-munderover" id="MJXp-Span-528"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-534" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">n</span><span class="MJXp-mo" id="MJXp-Span-536">−</span><span class="MJXp-mn" id="MJXp-Span-537">1</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-529" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-530" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">i</span><span class="MJXp-mo" id="MJXp-Span-532">=</span><span class="MJXp-mn" id="MJXp-Span-533">0</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-540" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-541" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">k</span></span></span><script type="math/tex" id="MathJax-Element-89">\sum\limits_{i=0}^{n-1} a_i=k</script>, we should output <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-543"><span class="MJXp-mn" id="MJXp-Span-544">0</span></span></span><script type="math/tex" id="MathJax-Element-90">0</script>.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">O</span><span class="MJXp-mo" id="MJXp-Span-547" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-548" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">n</span><span class="MJXp-mi" id="MJXp-Span-550">log</span><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">k</span><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-91"> O(\sum n\log k) </script>.</p><p><strong>Bonus:</strong> Find an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">O</span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">n</span><span class="MJXp-mo" id="MJXp-Span-559" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-92">O(\sum n)</script> solution. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">k</span><span class="pun">,</span><span class="pln">pos</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="lit">400009</span><span class="pun">],</span><span class="pln">stk</span><span class="pun">[</span><span class="lit">400009</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ll read</span><span class="pun">(){</span><span class="pln">
	ll s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">)</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">^</span><span class="pln"> </span><span class="lit">48</span><span class="pun">),</span><span class="pln">ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">bool</span><span class="pln"> judge</span><span class="pun">(</span><span class="pln">ll x</span><span class="pun">){</span><span class="pln">
	ll l </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">r </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&gt;=</span><span class="pln"> pos </span><span class="pun">-</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&lt;=</span><span class="pln"> r </span><span class="pun">&amp;&amp;</span><span class="pln"> stk</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> l </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> max</span><span class="pun">(</span><span class="lit">0ll</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">stk</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res </span><span class="pun">&gt;</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&lt;=</span><span class="pln"> r </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">stk</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> r </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		stk</span><span class="pun">[++</span><span class="pln"> r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	t </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">
		n </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">k </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		ll suma </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">suma </span><span class="pun">+=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">suma </span><span class="pun">==</span><span class="pln"> k</span><span class="pun">){</span><span class="pln">puts</span><span class="pun">(</span><span class="str">"0"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		pos </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">])</span><span class="pln"> pos </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
		ll l </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">r </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">ans </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&lt;=</span><span class="pln"> r</span><span class="pun">){</span><span class="pln">
			ll mid </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">judge</span><span class="pun">(</span><span class="pln">mid</span><span class="pun">))</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> mid</span><span class="pun">,</span><span class="pln">r </span><span class="pun">=</span><span class="pln"> mid </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2089/problem/C2" title="Codeforces Round 1012 (Div. 1)">2089C2 - Key of Like (Hard Version)</a> <br> Idea: <a class="rated-user user-violet" href="/profile/SpiritualKhorosho" title="Candidate Master SpiritualKhorosho">SpiritualKhorosho</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><h3>Background</h3><p>This problem is inspired by a minigame from a recently released party video game, but the story was modified to comply with <em>the title</em>. We tried to isolate the artistic part and the theoretical part, and I apologize if you still feel like working on reading comprehension exercises.</p><h3>Solution</h3><p>Noticing that each member's strategy is not maximizing the total outcome (which is the expected number of successful matches between keys and locks), but only maximizing the outcome in her current turn, and equally likely to adopt each of optimal (pure) strategies, it will be ideal if there is some simple form of the strategy that only depends on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">L</span></span></span><script type="math/tex" id="MathJax-Element-93">L</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">K</span></span></span><script type="math/tex" id="MathJax-Element-94">K</script>.</p><h4>Analyzing the Strategy</h4><p>At the very beginning, when there is no information about the relationship between keys and locks, the first member in her first turn must randomly choose a key and a lock.</p><p>What about the second member, if the first one is not lucky enough? Since she will not choose the same pair of keys and locks, there are three different types of (pure) strategies:</p> <ul>   <li><p>Choose a different key to open the same lock;</p></li>   <li><p>Choose the same key to open a different lock;</p></li>   <li><p>Choose a different key and a different lock.</p></li> </ul><p>For the first type of strategy, since there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-564"><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">L</span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">K</span><span class="MJXp-mo" id="MJXp-Span-569" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-570">1</span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-95">(L+K-1)</script> keys remaining (after the very first attempt), and among them is only one correct key, the probability of opening the same lock is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-572"><span class="MJXp-mn" id="MJXp-Span-573">1</span><span class="MJXp-mrow" id="MJXp-Span-574"><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">L</span><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">K</span><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-581">1</span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-96">1/(L+K-1)</script>.</p><p>For the second type, it can be proven that the probability is also <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-583"><span class="MJXp-mn" id="MJXp-Span-584">1</span><span class="MJXp-mrow" id="MJXp-Span-585"><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">L</span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">K</span><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-592">1</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-97">1/(L+K-1)</script>. Another way to think of this is, add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">K</span></span></span><script type="math/tex" id="MathJax-Element-98">K</script> imaginary locks and match each of them with a counterfeit key. Then, it is apparent that a new lock matches the selected key with the given probability.</p> <div class="spoiler"><b class="spoiler-title">The Straightforward Computation of the Probability</b><div class="spoiler-content" style="display: none;"><p>The key selected by the first member can either be a real key or a counterfeit one. Denote the event of the key being authentic as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">A</span></span></span><script type="math/tex" id="MathJax-Element-99">A</script>, and that of it failing to open the lock at the first turn as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">B</span></span></span><script type="math/tex" id="MathJax-Element-100">B</script>. Then, according to the Bayes' theorem along with the law of total probability,</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-600"><span class="MJXp-mtable" id="MJXp-Span-601"><span><span class="MJXp-mtr" id="MJXp-Span-602" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-603" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">P</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">A</span><span class="MJXp-mrow" id="MJXp-Span-607"><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">B</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-611" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-612"></span><span class="MJXp-mo" id="MJXp-Span-613" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-614" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">P</span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">B</span><span class="MJXp-mrow" id="MJXp-Span-618"><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">A</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">P</span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">A</span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">P</span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">B</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-631" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">P</span><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">B</span><span class="MJXp-mrow" id="MJXp-Span-635"><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">A</span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">P</span><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">A</span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">P</span><span class="MJXp-mo" id="MJXp-Span-644" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">B</span><span class="MJXp-mrow" id="MJXp-Span-646"><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">A</span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">P</span><span class="MJXp-mo" id="MJXp-Span-651" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">A</span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">P</span><span class="MJXp-mrow" id="MJXp-Span-656"><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">B</span><span class="MJXp-mrow" id="MJXp-Span-659"><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.013em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-661"><span class="MJXp-munderover" id="MJXp-Span-662"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">A</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">P</span><span class="MJXp-mrow" id="MJXp-Span-668"><span class="MJXp-mo" id="MJXp-Span-669" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-670"><span class="MJXp-munderover" id="MJXp-Span-671"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-673" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">A</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">)</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-675" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-676" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-677" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-678"></span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-680" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-681" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-682" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">L</span><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-685">1</span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-687"><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">L</span><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-692" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">L</span><span class="MJXp-mrow" id="MJXp-Span-694"><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-696" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">L</span><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">K</span><span class="MJXp-mo" id="MJXp-Span-700" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">L</span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-706">1</span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-708"><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710">L</span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">L</span><span class="MJXp-mrow" id="MJXp-Span-715"><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">L</span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">K</span><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-724">1</span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">K</span><span class="MJXp-mrow" id="MJXp-Span-728"><span class="MJXp-mo" id="MJXp-Span-729" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">L</span><span class="MJXp-mo" id="MJXp-Span-732" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">K</span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-736" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-737" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-738" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-739"></span><span class="MJXp-mo" id="MJXp-Span-740" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-741" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">L</span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-744">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">L</span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">K</span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-749">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-750" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mtr" id="MJXp-Span-751" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-752" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">P</span><span class="MJXp-mrow" id="MJXp-Span-754"><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-756"><span class="MJXp-mo" id="MJXp-Span-757" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-758"><span class="MJXp-munderover" id="MJXp-Span-759"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">A</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.013em;">|</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">B</span><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-765" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-766"></span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-768">1</span><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0em; margin-right: 0.222em;">—</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">P</span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">A</span><span class="MJXp-mrow" id="MJXp-Span-773"><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">B</span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-778" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">K</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">L</span><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">K</span><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-784">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-785" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-101">\begin{equation} \begin{split} P(A|B) &= \frac{P(B|A)P(A)}{P(B)} = \frac{P(B|A)P(A)}{P(B|A)P(A) + P\left(B\left|\bar{A}\right.\right)P\left(\bar{A}\right)} \\ &= \frac{((L-1)/L)\cdot (L/(L+K))}{((L-1)/L)\cdot (L/(L+K)) + 1\cdot(K/(L+K))}\\ &= \frac{L-1}{L+K-1},\\ P\left(\left.\bar{A}\right|B\right) &= 1 — P(A|B) = \frac{K}{L+K-1}. \end{split} \end{equation}</script></p><p>Thus, the probability that the same key selected by the first member can open another lock randomly chosen by the second member (denoted as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">C</span></span></span><script type="math/tex" id="MathJax-Element-102">C</script>) is</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-788"><span class="MJXp-mtable" id="MJXp-Span-789"><span><span class="MJXp-mtr" id="MJXp-Span-790" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-791" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">P</span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">C</span><span class="MJXp-mrow" id="MJXp-Span-795"><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">B</span><span class="MJXp-mo" id="MJXp-Span-798" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-799" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-800"></span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">P</span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">A</span><span class="MJXp-mrow" id="MJXp-Span-805"><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">B</span><span class="MJXp-mo" id="MJXp-Span-808" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">P</span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">C</span><span class="MJXp-mrow" id="MJXp-Span-813"><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">B</span><span class="MJXp-mo" id="MJXp-Span-817" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">P</span><span class="MJXp-mrow" id="MJXp-Span-820"><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-822"><span class="MJXp-mo" id="MJXp-Span-823" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-824"><span class="MJXp-munderover" id="MJXp-Span-825"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">A</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-828" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.013em;">|</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">B</span><span class="MJXp-mo" id="MJXp-Span-830" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">P</span><span class="MJXp-mrow" id="MJXp-Span-833"><span class="MJXp-mo" id="MJXp-Span-834" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">C</span><span class="MJXp-mrow" id="MJXp-Span-836"><span class="MJXp-mo" id="MJXp-Span-837" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.013em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-838"><span class="MJXp-munderover" id="MJXp-Span-839"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">A</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">B</span><span class="MJXp-mo" id="MJXp-Span-843" style="margin-left: 0em; margin-right: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-844" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">)</span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-845" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-846" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-847" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-848"></span><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-850" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">L</span><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-853">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">L</span><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">K</span><span class="MJXp-mo" id="MJXp-Span-857" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-858">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mfrac" id="MJXp-Span-860" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-861">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">L</span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-864">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-866" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">K</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">L</span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">K</span><span class="MJXp-mo" id="MJXp-Span-871" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-872">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-873" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mn" id="MJXp-Span-874">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-875" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-876" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-877" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-878"></span><span class="MJXp-mo" id="MJXp-Span-879" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-880" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-881">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">L</span><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">K</span><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-886">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-103">\begin{equation} \begin{split} P(C|B) &= P(A|B)\cdot P(C|AB) + P\left(\left.\bar{A}\right|B\right)\cdot P\left(C\left|\bar{A}B\right.\right)\\ &=\frac{L-1}{L+K-1}\cdot\frac{1}{L-1} + \frac{K}{L+K-1}\cdot 0\\ &= \frac{1}{L+K-1}. \end{split} \end{equation}</script></p></div></div><p>For the third type of strategy, its probability can be computed from either the first type or the second type, as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-888"><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">L</span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">K</span><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-894">1</span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-104">(L+K-1)</script> different outcomes are equally likely to happen:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-896"><span class="MJXp-mfrac" id="MJXp-Span-897" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-898">1</span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-900">1</span><span class="MJXp-mrow" id="MJXp-Span-901"><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">L</span><span class="MJXp-mo" id="MJXp-Span-905" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">K</span><span class="MJXp-mo" id="MJXp-Span-907" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-908">1</span><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">L</span><span class="MJXp-mo" id="MJXp-Span-911" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">K</span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-914">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-915" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-916" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">L</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">K</span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-921">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-922" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">L</span><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">K</span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-927">1</span><span class="MJXp-msubsup" id="MJXp-Span-928"><span class="MJXp-mo" id="MJXp-Span-929" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-930" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mfrac" id="MJXp-Span-932" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-933">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">L</span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">K</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-938">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-939" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-105">\begin{equation} \frac{1-1/(L+K-1)}{L+K-1}=\frac{L+K-2}{(L+K-1)^2}<\frac{1}{L+K-1}. \end{equation}</script></p><p>In conclusion, the second member will either choose the same key or the same lock. Because there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-940"><span class="MJXp-mo" id="MJXp-Span-941" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">L</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-944">1</span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-106">(L - 1)</script> pairs of the same key and other locks, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-946"><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">L</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">K</span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-952">1</span><span class="MJXp-mo" id="MJXp-Span-953" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-107">(L + K - 1)</script> pairs of other keys and the same lock, the second member will use the same key with probability <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-954"><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">L</span><span class="MJXp-mo" id="MJXp-Span-957" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-958">1</span><span class="MJXp-mo" id="MJXp-Span-959" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-960"><span class="MJXp-mo" id="MJXp-Span-961" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-962" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-963">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">L</span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">K</span><span class="MJXp-mo" id="MJXp-Span-967" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-968">2</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-108">(L - 1)/(2L + K - 2)</script>, or check the same lock with probability <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-970"><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">L</span><span class="MJXp-mo" id="MJXp-Span-973" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">K</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-976">1</span><span class="MJXp-mo" id="MJXp-Span-977" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-978"><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-980" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-981">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">L</span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">K</span><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-986">2</span><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-109">(L + K - 1)/(2L + K - 2)</script>.</p><p>As for all the following attempts, a similar <em>Proof</em> shows that, everyone will imitate the strategy adopted by the second member. That is to say, if the second member decides to continue with the same key, everyone will keep using this same key, until a lock is opened or all the locks are checked; if the second member picks a different key for the same lock, everyone will challenge this same lock, until it is eventually settled (and obviously it will). </p><p>Furthermore, whenever a key is identified as counterfeit, or a lock is opened, the information 'collapses', which turns the original problem into a subproblem with either one less counterfeit key (corresponding to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-988"><span class="MJXp-msup" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990" style="margin-right: 0.05em;">K</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-991" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">K</span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-995">1</span></span></span><script type="math/tex" id="MathJax-Element-110">K' = K - 1</script>), or both one less valid key and one less lock (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-996"><span class="MJXp-msup" id="MJXp-Span-997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998" style="margin-right: 0.05em;">L</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-999" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">L</span><span class="MJXp-mo" id="MJXp-Span-1002" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1003">1</span></span></span><script type="math/tex" id="MathJax-Element-111">L' = L - 1</script>), respectively.</p><p>To sum up, the process of the game is:</p> <ul>   <li>Whenever a lock is opened, the original problem is reduced to a subproblem with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1004"><span class="MJXp-msup" id="MJXp-Span-1005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006" style="margin-right: 0.05em;">L</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1007" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">L</span><span class="MJXp-mo" id="MJXp-Span-1010" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1011">1</span></span></span><script type="math/tex" id="MathJax-Element-112">L' = L - 1</script>;</li>   <li>Whenever a key is proven counterfeit, the original problem is reduced to a subproblem where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1012"><span class="MJXp-msup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;">K</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1015" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">K</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1019">1</span></span></span><script type="math/tex" id="MathJax-Element-113">K' = K - 1</script>; -The first member randomly chooses a key and a lock to check if they match;</li>   <li>If the first member fails, the second member adopts the same key with probability <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1020"><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">L</span><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1024">1</span><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1026"><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1029">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">L</span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">K</span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1034">2</span><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-114">(L - 1)/(2L + K - 2)</script>, or investigates the same lock with probability <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1036"><span class="MJXp-mo" id="MJXp-Span-1037" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">L</span><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">K</span><span class="MJXp-mo" id="MJXp-Span-1041" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1042">1</span><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1044"><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1047">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">L</span><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">K</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1052">2</span><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-115">(L + K - 1)/(2L + K - 2)</script>;</li>   <li>If the second member fails as well, all the following attempts will replicate the choice of whether to employ the same key or the same lock.</li> </ul><h4>Design the Algorithm with Strategies Solved</h4><p>Knowing the concrete strategies, the task now becomes how to compute the expected values efficiently. As you might have imagined, it can be achieved using dynamic programming due to the existence of overlapping subproblems. But let's examine another approach which might be easier to understand: compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1054"><span class="MJXp-msubsup" id="MJXp-Span-1055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1057" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">l</span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">k</span><span class="MJXp-mo" id="MJXp-Span-1062" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-116">p_i (l, k)</script>, the total probability that the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1063"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">i</span></span></span><script type="math/tex" id="MathJax-Element-117">i</script>-th member begins a subproblem with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">l</span></span></span><script type="math/tex" id="MathJax-Element-118">l</script> locks and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">k</span></span></span><script type="math/tex" id="MathJax-Element-119">k</script> counterfeit keys, and accumulate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1069"><span class="MJXp-msubsup" id="MJXp-Span-1070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1072" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-120">e_i</script>'s during the computation.</p><p>Transitions for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">p</span></span></span><script type="math/tex" id="MathJax-Element-121">p</script> itself include (and those from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">p</span></span></span><script type="math/tex" id="MathJax-Element-122">p</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">e</span></span></span><script type="math/tex" id="MathJax-Element-123">e</script> will be similar to):</p> <ol>   <li>The first member manages to open the lock without any prior information;</li>   <li>The second member makes a successful guess;</li>   <li>Any of the succeeding attempts succeeds;</li>   <li>Everyone uses the same key but it fails on all the locks.</li> </ol><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1079"><span class="MJXp-msubsup" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1082" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">l</span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">k</span><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-124">p_i(l, k)</script>, all the transition can be easily processed in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1088"><span class="MJXp-mi" id="MJXp-Span-1089">Θ</span><span class="MJXp-mo" id="MJXp-Span-1090" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1091">1</span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-125">\Theta(1)</script> time, except the third one. A verbatim implementation requires <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">O</span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">L</span><span class="MJXp-mo" id="MJXp-Span-1097" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">K</span><span class="MJXp-mo" id="MJXp-Span-1099" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-126">O(L + K)</script> time per state, which is apparently not efficient enough. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">N</span><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0.333em; margin-right: 0.333em;">≪</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">L</span></span></span><script type="math/tex" id="MathJax-Element-127">N \ll L</script>, a possible work-around is to compute the transition coefficient for each member, instead of each attempt. Intuitively, all attempts should share the same probability of success, regardless of the order. A simplified model is to draw all balls sequentially without replacement from a box of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1104"><span class="MJXp-mn" id="MJXp-Span-1105">1</span></span></span><script type="math/tex" id="MathJax-Element-128">1</script> red ball and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1106"><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">x</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1110">1</span><span class="MJXp-mo" id="MJXp-Span-1111" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-129">(x-1)</script> white balls, in which the red ball appears at the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">i</span></span></span><script type="math/tex" id="MathJax-Element-130">i</script>-th attempt with an equal probability of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1114"><span class="MJXp-mn" id="MJXp-Span-1115">1</span><span class="MJXp-mrow" id="MJXp-Span-1116"><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">x</span></span></span><script type="math/tex" id="MathJax-Element-131">1/x</script>. Of course, the observation for our problem can also be proven mathematically, but let's omit it for simplicity.</p><p>This important observation reduces the time complexity of the third type of transition to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">O</span><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">N</span><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-132">O(N)</script>, as we can first compute the maximum number of attempts for each member, and then multiply it with the common probability of a single attempt. However, this is still not enough for passing the problem (and we adjusted the constraints to prevent so).</p><p>The final trick to pass all testcases requires revisiting the transition coefficients we just computed. Notice that, if all the members have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">a</span></span></span><script type="math/tex" id="MathJax-Element-133">a</script> attempts in total (but for the third type of transition only, which excludes the first two), then:</p> <ul>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">a</span></span></span><script type="math/tex" id="MathJax-Element-134">a</script> is a multiple of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">N</span></span></span><script type="math/tex" id="MathJax-Element-135">N</script>, then every member can have at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">a</span><span class="MJXp-mrow" id="MJXp-Span-1132"><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">N</span></span></span><script type="math/tex" id="MathJax-Element-136">a/N</script> attempts;</p></li>   <li><p>Otherwise, the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">a</span><span class="MJXp-mo" id="MJXp-Span-1137" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">N</span></span></span><script type="math/tex" id="MathJax-Element-137">a \bmod N</script> members (right after the second member, who decides to advance with the same key or the same lock) can have at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1139"><span class="MJXp-mo" id="MJXp-Span-1140" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">a</span><span class="MJXp-mrow" id="MJXp-Span-1142"><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">N</span><span class="MJXp-mo" id="MJXp-Span-1145" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span><script type="math/tex" id="MathJax-Element-138">\lceil a/N\rceil</script> attempts, while all the others can have at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1146"><span class="MJXp-mo" id="MJXp-Span-1147" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">a</span><span class="MJXp-mrow" id="MJXp-Span-1149"><span class="MJXp-mo" id="MJXp-Span-1150" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">N</span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-139">\lfloor a/N\rfloor</script> attempts.</p></li> </ul><p>This implies that the transition coefficients consists of at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1153"><span class="MJXp-mn" id="MJXp-Span-1154">3</span></span></span><script type="math/tex" id="MathJax-Element-140">3</script> maximal contiguous subsequences of the same coefficients (in fact, if the coefficients are treated as a circular sequence, then there will be exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1155"><span class="MJXp-mn" id="MJXp-Span-1156">1</span></span></span><script type="math/tex" id="MathJax-Element-141">1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1157"><span class="MJXp-mn" id="MJXp-Span-1158">2</span></span></span><script type="math/tex" id="MathJax-Element-142">2</script> for the two cases respectively). Using techniques such as prefix sums helps further decrease the complexity of the computation to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1159"><span class="MJXp-mi" id="MJXp-Span-1160">Θ</span><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1162">1</span><span class="MJXp-mo" id="MJXp-Span-1163" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-143">\Theta(1)</script> per state.</p><p>The total time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">O</span><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">K</span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-144">O(NLK)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstring&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> MOD </span><span class="lit">1000000007</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> MAXN </span><span class="lit">108</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> MAXL </span><span class="lit">5004</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> MAXK </span><span class="lit">27</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> e</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">][</span><span class="pln">MAXK</span><span class="pun">][</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> inv</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> MAXL </span><span class="pun">+</span><span class="pln"> MAXK</span><span class="pun">];</span><span class="pln">  
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> _update</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> rbd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">base</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> diff</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">base</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">lbd</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> diff</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">rbd</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> diff</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="typ">Hill</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">)</span><span class="pln"> _update</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="typ">Valley</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">)</span><span class="pln"> _update</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> </span><span class="pun">((</span><span class="pln">_base</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">_diff</span><span class="pun">))</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">,</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">_diff</span><span class="pun">))</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="typ">Update</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">_lbd </span><span class="pun">&lt;</span><span class="pln"> _rbd</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Hill</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="typ">Valley</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> like</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> dh</span><span class="pun">,</span><span class="pln"> now</span><span class="pun">,</span><span class="pln"> nxt</span><span class="pun">,</span><span class="pln"> totk</span><span class="pun">,</span><span class="pln"> ntry</span><span class="pun">,</span><span class="pln"> prob</span><span class="pun">,</span><span class="pln"> pd</span><span class="pun">,</span><span class="pln"> pb</span><span class="pun">,</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> rbd</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d %d %d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">k</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	inv</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">MOD </span><span class="pun">-</span><span class="pln"> MOD </span><span class="pun">/</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">MOD </span><span class="pun">%</span><span class="pln"> i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	
	memset</span><span class="pun">(</span><span class="pln">p</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">p</span><span class="pun">));</span><span class="pln">
	memset</span><span class="pun">(</span><span class="pln">e</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">e</span><span class="pun">));</span><span class="pln">
	p</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	p</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	now </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> nxt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> l</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			totk </span><span class="pun">=</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> k </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> j</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> a </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">now</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">a</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">now</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">a </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> a </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				</span><span class="com">// Match at the first try</span><span class="pln">
				prob </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">now</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">a</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">totk</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">(</span><span class="pln">e</span><span class="pun">[</span><span class="pln">a</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> prob</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">!=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">[</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> prob</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> prob</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">!=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> prob</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">

				prob </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> prob </span><span class="pun">*</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">totk </span><span class="pun">+</span><span class="pln"> l </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="com">// Same lock</span><span class="pln">
				pd </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> prob </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ntry </span><span class="pun">=</span><span class="pln"> totk </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				pb </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ntry </span><span class="pun">/</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> pd </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dh </span><span class="pun">=</span><span class="pln"> ntry </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					lbd </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
					rbd </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> dh</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> 
					</span><span class="typ">Update</span><span class="pun">(</span><span class="pln">e</span><span class="pun">,</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> rbd</span><span class="pun">,</span><span class="pln"> pb</span><span class="pun">,</span><span class="pln"> pd</span><span class="pun">);</span><span class="pln">
					</span><span class="pun">(++</span><span class="pln">lbd</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">++(</span><span class="pln">rbd  </span><span class="pun">%=</span><span class="pln"> n</span><span class="pun">);</span><span class="pln"> 
					</span><span class="typ">Update</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">],</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> rbd</span><span class="pun">,</span><span class="pln"> pb</span><span class="pun">,</span><span class="pln"> pd</span><span class="pun">);</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					</span><span class="pun">(</span><span class="pln">e</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">

				</span><span class="com">// Same key</span><span class="pln">
				pd </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> prob </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ntry </span><span class="pun">=</span><span class="pln"> l </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">&lt;</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					pb </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> pd </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">-</span><span class="pln"> j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln"> 
					b </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> l </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">now</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">b</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">b </span><span class="pun">!=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">now</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">b </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				pb </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ntry </span><span class="pun">/</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> pd </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dh </span><span class="pun">=</span><span class="pln"> ntry </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					lbd </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
					rbd </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> dh</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> 
					</span><span class="typ">Update</span><span class="pun">(</span><span class="pln">e</span><span class="pun">,</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> rbd</span><span class="pun">,</span><span class="pln"> pb</span><span class="pun">,</span><span class="pln"> pd</span><span class="pun">);</span><span class="pln">
					</span><span class="pun">(++</span><span class="pln">lbd</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">++(</span><span class="pln">rbd  </span><span class="pun">%=</span><span class="pln"> n</span><span class="pun">);</span><span class="pln"> 
					</span><span class="typ">Update</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">],</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> rbd</span><span class="pun">,</span><span class="pln"> pb</span><span class="pun">,</span><span class="pln"> pd</span><span class="pun">);</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					</span><span class="pun">(</span><span class="pln">e</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">

		now </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		nxt </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		memset</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">],</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> MAXK </span><span class="pun">*</span><span class="pln"> MAXN</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> e</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">

	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> printf</span><span class="pun">(</span><span class="str">"%d%c"</span><span class="pun">,</span><span class="pln"> e</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> </span><span class="str">" \n"</span><span class="pun">[</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		like</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2089/problem/D" title="Codeforces Round 1012 (Div. 1)">2089D - Conditional Operators</a> <br> Idea: <a class="rated-user user-orange" href="/profile/E.Space" title="International Master E.Space">E.Space</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>Each operation transform three adjacent characters into one. If the string starts with <code class="tt">11</code>, the answer should be yes since we can first transform the remaining part into a single <code class="tt">0</code> or <code class="tt">1</code> and then the value of <code class="tt">11?</code> is always <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1171"><span class="MJXp-mn" id="MJXp-Span-1172">1</span></span></span><script type="math/tex" id="MathJax-Element-145">1</script>.</p><p>If the string ends with <code class="tt">1</code>, only <code class="tt">101</code> has no solution, otherwise it starts with <code class="tt">11</code> or <code class="tt">0</code>, or we can transform <code class="tt">10?</code> in the front of the string into a 0. Then transform the rest part of the string into a single character to make the last operation <code class="tt">0?(anything):1</code> makes 1.</p><p>If an operation transformed a string ending with <code class="tt">0</code> into one ending with <code class="tt">1</code>, it must be <code class="tt">1?1:0</code> makes 1.</p><p>Consider the case where the strings contains <code class="tt">11</code> as a substring. After transforming the remaining part, <code class="tt">?11??</code> or <code class="tt">??11?</code> will be derived. The cases are <code class="tt">01100</code>, <code class="tt">00110</code>, <code class="tt">01110</code>, <code class="tt">10110</code>. All other cases start with <code class="tt">11</code> or end with <code class="tt">1</code>.</p><p>All cases of <code class="tt">??11?</code> have a solution:</p><p><code class="tt">(0?0:1)?1:0</code> makes 1.</p><p><code class="tt">(0?1:1)?1:0</code> makes 1.</p><p><code class="tt">1?(0?1:1):0</code> makes 1.</p><p>However, <code class="tt">01100</code> has no solution.</p><p>Since <code class="tt">0?0:1</code> equals 1, before the last <code class="tt">1</code>, any two adjacent 0's with no <code class="tt">1</code> in between can be eliminated. Thus, if there are two 1's with an even number of 0's in between, and there are an even number of characters in front the former <code class="tt">1</code>, i.e., <code class="tt">(..)*1(00)*1(..)*0</code> in regular expression, the answer should be yes, since after eliminating the 0's in between, the 1's become adjacent. The parity of the characters before the former <code class="tt">1</code> guarantees that it will not become <code class="tt">01100</code>.</p><p>Another case is that the string ends with <code class="tt">0</code> and every pair of adjacent 1's has an odd number of 0's in between. Since <code class="tt">0(1?0:1)0</code> makes <code class="tt">000</code>, <code class="tt">1(0?1:0)1</code> makes <code class="tt">101</code>, <code class="tt">10(1?0:0)01</code> makes <code class="tt">10001</code>, there is no way to change the parity of the consecutive 0's to make <code class="tt">11</code> to change the ending <code class="tt">0</code> into <code class="tt">1</code>.</p><p>In the remaining case, there are even 0's between some pair of adjacent 1's, but the number of characters before the first 1 is odd, there must be only one pair. Suppose the string is 1-indexed. It is because the indices of such pair of 1's must be [odd, even]; while the indices in the previous case must be [even, odd]. Thus, if there are two such pairs of this case [odd, even], in the parity sequence [odd, even, ..., odd, even] there must be an [even, odd] as a substring.</p><p>Therefore, any other pair of adjacent 1's must have odd 0's in between, i.e., <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1173"><span class="MJXp-mn" id="MJXp-Span-1174">0</span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1176">00</span><span class="MJXp-msubsup" id="MJXp-Span-1177"><span class="MJXp-mo" id="MJXp-Span-1178" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1179" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mstyle" id="MJXp-Span-1180" style="color: blue;"><span class="MJXp-mo" id="MJXp-Span-1181" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1182">10</span><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1184">00</span><span class="MJXp-msubsup" id="MJXp-Span-1185"><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1187" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-msubsup" id="MJXp-Span-1188"><span class="MJXp-mo" id="MJXp-Span-1189" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1190" style="vertical-align: 0.5em;">∗</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1191" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1192">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1193" style="color: black;"><span class="MJXp-mo" id="MJXp-Span-1194" style="margin-left: 0em; margin-right: 0em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1195">00</span><span class="MJXp-msubsup" id="MJXp-Span-1196"><span class="MJXp-mo" id="MJXp-Span-1197" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1198" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mstyle" id="MJXp-Span-1199" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1200">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1201" style="color: blue;"><span class="MJXp-mo" id="MJXp-Span-1202" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1204">00</span><span class="MJXp-msubsup" id="MJXp-Span-1205"><span class="MJXp-mo" id="MJXp-Span-1206" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1207" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mn" id="MJXp-Span-1208">01</span><span class="MJXp-msubsup" id="MJXp-Span-1209"><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1211" style="vertical-align: 0.5em;">∗</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1212" style="color: black;"><span class="MJXp-mo" id="MJXp-Span-1213" style="margin-left: 0em; margin-right: 0em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1214">00</span><span class="MJXp-msubsup" id="MJXp-Span-1215"><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1217" style="vertical-align: 0.5em;">+</span></span></span></span><script type="math/tex" id="MathJax-Element-146">0(00)^*\color{blue}{(10(00)^*)^*}\color{red}1\color{black}(00)^*\color{red}1\color{blue}{((00)^*01)^*}\color{black}(00)^+</script> in regular expression. Any operation remains the string in this case, except that the string is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1218"><span class="MJXp-mn" id="MJXp-Span-1219">0</span><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1221">00</span><span class="MJXp-msubsup" id="MJXp-Span-1222"><span class="MJXp-mo" id="MJXp-Span-1223" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1224" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mstyle" id="MJXp-Span-1225" style="color: blue;"><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1227">10</span><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1229">00</span><span class="MJXp-msubsup" id="MJXp-Span-1230"><span class="MJXp-mo" id="MJXp-Span-1231" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1232" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-msubsup" id="MJXp-Span-1233"><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1235" style="vertical-align: 0.5em;">∗</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1236" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1237">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1238" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1239">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1240" style="color: black;"><span class="MJXp-mo" id="MJXp-Span-1241" style="margin-left: 0em; margin-right: 0em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1242">00</span><span class="MJXp-msubsup" id="MJXp-Span-1243"><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1245" style="vertical-align: 0.5em;">+</span></span></span></span><script type="math/tex" id="MathJax-Element-147">0(00)^*\color{blue}{(10(00)^*)^*}\color{red}1\color{red}1\color{black}(00)^+</script> and the operation is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1246"><span class="MJXp-mstyle" id="MJXp-Span-1247" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1248">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1249" style="color: black;"><span class="MJXp-mo" id="MJXp-Span-1250" style="margin-left: 0.111em; margin-right: 0.111em;">?</span></span><span class="MJXp-mstyle" id="MJXp-Span-1251" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1252">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1253" style="color: black;"><span class="MJXp-mo" id="MJXp-Span-1254" style="margin-left: 0.111em; margin-right: 0.167em;">:</span></span><span class="MJXp-mn" id="MJXp-Span-1255">0</span></span></span><script type="math/tex" id="MathJax-Element-148">\color{red}1\color{black}?\color{red}1\color{black}:0</script> makes 1. Since it must ends with <code class="tt">00</code>, it becomes a string ending with <code class="tt">0</code> and every pair of adjacent 1's has odd 0's in between, which is a case mentioned before that has no solution.</p><p>In conclusion, it has a solution if and only of at least one of the two following conditions is met:</p> <ul>   <li>It ends with <code class="tt">1</code> but it is not <code class="tt">101</code>.</li>   <li>It has two adjacent 1's such that there are even 0's in between and the number of characters before the former <code class="tt">1</code> is even.</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">char</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">333333</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">char</span><span class="pln"> val</span><span class="pun">(</span><span class="kwd">char</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">char</span><span class="pln"> y</span><span class="pun">,</span><span class="kwd">char</span><span class="pln"> z</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">==</span><span class="str">'1'</span><span class="pun">?</span><span class="pln">y</span><span class="pun">:</span><span class="pln">z</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
std</span><span class="pun">::</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="pln">std</span><span class="pun">::</span><span class="kwd">string</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">&gt;</span><span class="pln"> fold</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">){</span><span class="pln">
	std</span><span class="pun">::</span><span class="kwd">string</span><span class="pln"> str</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> v</span><span class="pun">=</span><span class="pln">s</span><span class="pun">[</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">l</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">r</span><span class="pun">;</span><span class="pln">i</span><span class="pun">+=</span><span class="lit">2</span><span class="pun">){</span><span class="pln">
		str</span><span class="pun">+=</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		str</span><span class="pun">+=</span><span class="str">'?'</span><span class="pun">;</span><span class="pln">
		str</span><span class="pun">+=</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		str</span><span class="pun">+=</span><span class="str">':'</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	str</span><span class="pun">+=</span><span class="pln">s</span><span class="pun">[</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">r</span><span class="pun">-</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="pln">l</span><span class="pun">;</span><span class="pln">i</span><span class="pun">-=</span><span class="lit">2</span><span class="pun">){</span><span class="pln">
		v</span><span class="pun">=</span><span class="pln">val</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">],</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">make_pair</span><span class="pun">(</span><span class="pln">str</span><span class="pun">,</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
	n</span><span class="pun">=</span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%s"</span><span class="pun">,</span><span class="pln">s</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">last</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="str">'1'</span><span class="pun">&amp;&amp;</span><span class="kwd">last</span><span class="pun">&gt;</span><span class="lit">0</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">%</span><span class="lit">2</span><span class="pun">==</span><span class="lit">0</span><span class="pun">&amp;&amp;</span><span class="kwd">last</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
				puts</span><span class="pun">(</span><span class="str">"Yes"</span><span class="pun">);</span><span class="pln">
				std</span><span class="pun">::</span><span class="kwd">string</span><span class="pln"> s4</span><span class="pun">=</span><span class="pln">fold</span><span class="pun">(</span><span class="kwd">last</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">i</span><span class="pun">).</span><span class="pln">first</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">auto</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">fold</span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
				std</span><span class="pun">::</span><span class="kwd">string</span><span class="pln"> s5</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">.</span><span class="pln">first</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">char</span><span class="pln"> v5</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">.</span><span class="pln">second</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">last</span><span class="pun">==</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
					printf</span><span class="pun">(</span><span class="str">"1?(%s):(%s)\n"</span><span class="pun">,</span><span class="pln">s4</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">s5</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">());</span><span class="pln">
					</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				tmp</span><span class="pun">=</span><span class="pln">fold</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="kwd">last</span><span class="pun">-</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
				std</span><span class="pun">::</span><span class="kwd">string</span><span class="pln"> s1</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">.</span><span class="pln">first</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">char</span><span class="pln"> v1</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">.</span><span class="pln">second</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">v1</span><span class="pun">==</span><span class="str">'1'</span><span class="pun">){</span><span class="pln">
					printf</span><span class="pun">(</span><span class="str">"(%s)?(%c?1:(%s)):(%s)\n"</span><span class="pun">,</span><span class="pln">s1</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">s</span><span class="pun">[</span><span class="kwd">last</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">s4</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">s5</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">());</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
					printf</span><span class="pun">(</span><span class="str">"((%s)?%c:1)?(%s):(%s)\n"</span><span class="pun">,</span><span class="pln">s1</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">s</span><span class="pun">[</span><span class="kwd">last</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">s4</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">s5</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">());</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="str">'1'</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">last</span><span class="pun">=</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]==</span><span class="str">'1'</span><span class="pun">&amp;&amp;</span><span class="pln">std</span><span class="pun">::</span><span class="kwd">string</span><span class="pun">(</span><span class="pln">s</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)!=</span><span class="str">"101"</span><span class="pun">){</span><span class="pln">
		puts</span><span class="pun">(</span><span class="str">"Yes"</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">auto</span><span class="pln"> left</span><span class="pun">=</span><span class="pln">s</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]==</span><span class="str">'0'</span><span class="pun">?</span><span class="pln">fold</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">):</span><span class="pln">fold</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">3</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">auto</span><span class="pln"> mid</span><span class="pun">=</span><span class="pln">s</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]==</span><span class="str">'0'</span><span class="pun">?</span><span class="pln">fold</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">):</span><span class="pln">fold</span><span class="pun">(</span><span class="lit">4</span><span class="pun">,</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"(%s)?(%s):1\n"</span><span class="pun">,</span><span class="pln">left</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">mid</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">());</span><span class="pln">
		</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	puts</span><span class="pun">(</span><span class="str">"No"</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--){</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2089/problem/E" title="Codeforces Round 1012 (Div. 1)">2089E - Black Cat Collapse</a> <br> Idea: <a class="rated-user user-orange" href="/profile/abruce" title="International Master abruce">abruce</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>Firstly, consider a classical dp to calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">d</span><span class="MJXp-msubsup" id="MJXp-Span-1258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1260" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">u</span><span class="MJXp-mo" id="MJXp-Span-1262">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-149">dp_{u,k}</script> as the number of delete <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">k</span></span></span><script type="math/tex" id="MathJax-Element-150">k</script> vertices in subtree <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">u</span></span></span><script type="math/tex" id="MathJax-Element-151">u</script> without considering deleting vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">n</span><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">i</span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1273">1</span></span></span><script type="math/tex" id="MathJax-Element-152">n-i+1</script> everyday. This is trivial.</p><p>Then, due to the existence of an “automatic deletion” process, we cannot view the selected points within the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">u</span></span></span><script type="math/tex" id="MathJax-Element-153">u</script> as operations with only relative order, because they may be illegal. However, we consider the final operation sequence, putting the vertex chosen on the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">i</span></span></span><script type="math/tex" id="MathJax-Element-154">i</script> th day in the position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">n</span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">i</span><span class="MJXp-mo" id="MJXp-Span-1282" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1283">1</span></span></span><script type="math/tex" id="MathJax-Element-155">n-i+1</script>. That is, if we firstly choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1284"><span class="MJXp-mn" id="MJXp-Span-1285">4</span></span></span><script type="math/tex" id="MathJax-Element-156">4</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1286"><span class="MJXp-mn" id="MJXp-Span-1287">3</span></span></span><script type="math/tex" id="MathJax-Element-157">3</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1288"><span class="MJXp-mn" id="MJXp-Span-1289">1</span></span></span><script type="math/tex" id="MathJax-Element-158">1</script>, it will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1290"><span class="MJXp-mn" id="MJXp-Span-1291">0431</span></span></span><script type="math/tex" id="MathJax-Element-159">0431</script>. Then, one vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">u</span></span></span><script type="math/tex" id="MathJax-Element-160">u</script> must be put in position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">u</span></span></span><script type="math/tex" id="MathJax-Element-161">u</script> or later.</p><p>Then, we find that for the subtree of vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">u</span></span></span><script type="math/tex" id="MathJax-Element-162">u</script> with DFS order interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1298"><span class="MJXp-mo" id="MJXp-Span-1299" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">l</span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">r</span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-163">[l,r]</script>, all vertices can't be put in position before <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">l</span></span></span><script type="math/tex" id="MathJax-Element-164">l</script>, and it is always legal to put in position after <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">r</span></span></span><script type="math/tex" id="MathJax-Element-165">r</script> if parent-child relations are satisfied.</p><p>So we consider a dp <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-msubsup" id="MJXp-Span-1309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1311" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">u</span><span class="MJXp-mo" id="MJXp-Span-1313">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">i</span><span class="MJXp-mo" id="MJXp-Span-1315">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">j</span><span class="MJXp-mo" id="MJXp-Span-1317">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-166">f_{u,i,j,k}</script> which represents that the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">u</span></span></span><script type="math/tex" id="MathJax-Element-167">u</script> leaves position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">i</span></span></span><script type="math/tex" id="MathJax-Element-168">i</script> for ancestors (which means nothing can be placed at position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">i</span></span></span><script type="math/tex" id="MathJax-Element-169">i</script> or before, and if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">i</span><span class="MJXp-mo" id="MJXp-Span-1327" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1328">0</span></span></span><script type="math/tex" id="MathJax-Element-170">i=0</script>, then nothing is left for ancestors), there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">j</span></span></span><script type="math/tex" id="MathJax-Element-171">j</script> empty spaces (not including the one left for ancestors), and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">k</span></span></span><script type="math/tex" id="MathJax-Element-172">k</script> vertices need to be put into positions after the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">u</span></span></span><script type="math/tex" id="MathJax-Element-173">u</script>. In the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">i</span><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1338">0</span></span></span><script type="math/tex" id="MathJax-Element-174">i=0</script> case, we merge subtrees, and the subtree with smaller DFS order can put some backward operations into the space of the subtree with bigger DFS order.</p><p>Specifically, consider the sons of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">u</span></span></span><script type="math/tex" id="MathJax-Element-175">u</script> enumerated in reverse order of DFS, and the son is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">v</span></span></span><script type="math/tex" id="MathJax-Element-176">v</script>. Then enumerate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">w</span></span></span><script type="math/tex" id="MathJax-Element-177">w</script> as how many backward operations of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">v</span></span></span><script type="math/tex" id="MathJax-Element-178">v</script> will fill in space of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">u</span></span></span><script type="math/tex" id="MathJax-Element-179">u</script>. The transition is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1349"><span class="MJXp-msubsup" id="MJXp-Span-1350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1352" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">u</span><span class="MJXp-mo" id="MJXp-Span-1354">,</span><span class="MJXp-mn" id="MJXp-Span-1355">0</span><span class="MJXp-mo" id="MJXp-Span-1356">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">j</span><span class="MJXp-mo" id="MJXp-Span-1358">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">j</span><span class="MJXp-mn" id="MJXp-Span-1360">1</span><span class="MJXp-mo" id="MJXp-Span-1361">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">w</span><span class="MJXp-mo" id="MJXp-Span-1363">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">k</span><span class="MJXp-mo" id="MJXp-Span-1365">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">k</span><span class="MJXp-mn" id="MJXp-Span-1367">1</span><span class="MJXp-mo" id="MJXp-Span-1368">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">w</span></span></span><span class="MJXp-mo" id="MJXp-Span-1370" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1373" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">u</span><span class="MJXp-mo" id="MJXp-Span-1375">,</span><span class="MJXp-mn" id="MJXp-Span-1376">0</span><span class="MJXp-mo" id="MJXp-Span-1377">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">j</span><span class="MJXp-mo" id="MJXp-Span-1379">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">j</span><span class="MJXp-mn" id="MJXp-Span-1381">1</span><span class="MJXp-mo" id="MJXp-Span-1382">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">w</span><span class="MJXp-mo" id="MJXp-Span-1384">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">k</span><span class="MJXp-mo" id="MJXp-Span-1386">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">k</span><span class="MJXp-mn" id="MJXp-Span-1388">1</span><span class="MJXp-mo" id="MJXp-Span-1389">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">w</span></span></span><span class="MJXp-mo" id="MJXp-Span-1391" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1394" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">u</span><span class="MJXp-mo" id="MJXp-Span-1396">,</span><span class="MJXp-mn" id="MJXp-Span-1397">0</span><span class="MJXp-mo" id="MJXp-Span-1398">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">j</span><span class="MJXp-mo" id="MJXp-Span-1400">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-msubsup" id="MJXp-Span-1403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1405" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">v</span><span class="MJXp-mo" id="MJXp-Span-1407">,</span><span class="MJXp-mn" id="MJXp-Span-1408">0</span><span class="MJXp-mo" id="MJXp-Span-1409">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">j</span><span class="MJXp-mn" id="MJXp-Span-1411">1</span><span class="MJXp-mo" id="MJXp-Span-1412">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">k</span><span class="MJXp-mn" id="MJXp-Span-1414">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1415" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mrow" id="MJXp-Span-1416"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1417"><span class="MJXp-mstyle" id="MJXp-Span-1418"><span class="MJXp-mrow" id="MJXp-Span-1419"><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1421"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">j</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">w</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1424"><span class="MJXp-mstyle" id="MJXp-Span-1425"><span class="MJXp-mrow" id="MJXp-Span-1426"><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1428" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mrow" id="MJXp-Span-1429"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1430"><span class="MJXp-mstyle" id="MJXp-Span-1431"><span class="MJXp-mrow" id="MJXp-Span-1432"><span class="MJXp-mo" id="MJXp-Span-1433" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1434"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">k</span><span class="MJXp-mo" id="MJXp-Span-1436">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">k</span><span class="MJXp-mn" id="MJXp-Span-1438">1</span><span class="MJXp-mo" id="MJXp-Span-1439">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">w</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">k</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1442"><span class="MJXp-mstyle" id="MJXp-Span-1443"><span class="MJXp-mrow" id="MJXp-Span-1444"><span class="MJXp-mo" id="MJXp-Span-1445" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-180">f_{u,0,j+j1-w,k+k1-w}\leftarrow f_{u,0,j+j1-w,k+k1-w}+f_{u,0,j,k}\times f_{v,0,j1,k1}\times \binom{j}{w}\times\binom{k+k1-w}{k}</script>. That is, after putting <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">w</span></span></span><script type="math/tex" id="MathJax-Element-181">w</script> operations from backward operations of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">v</span></span></span><script type="math/tex" id="MathJax-Element-182">v</script> into spaces of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">u</span></span></span><script type="math/tex" id="MathJax-Element-183">u</script>, we merge the spaces of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">u</span></span></span><script type="math/tex" id="MathJax-Element-184">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">v</span></span></span><script type="math/tex" id="MathJax-Element-185">v</script>, then the backward operations of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">u</span></span></span><script type="math/tex" id="MathJax-Element-186">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">v</span></span></span><script type="math/tex" id="MathJax-Element-187">v</script>.</p><p>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1460"><span class="MJXp-msubsup" id="MJXp-Span-1461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1463" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">v</span><span class="MJXp-mo" id="MJXp-Span-1465">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">i</span><span class="MJXp-mo" id="MJXp-Span-1467">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">j</span><span class="MJXp-mo" id="MJXp-Span-1469">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">i</span><span class="MJXp-mo" id="MJXp-Span-1473" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mn" id="MJXp-Span-1474">0</span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-188">f_{v,i,j,k}(i\neq 0)</script>, it won't interfere with the transition with its following siblings. And for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1476"><span class="MJXp-msubsup" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1479" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">u</span><span class="MJXp-mo" id="MJXp-Span-1481">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">i</span><span class="MJXp-mo" id="MJXp-Span-1483">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">j</span><span class="MJXp-mo" id="MJXp-Span-1485">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-189">f_{u,i,j,k}</script>,any operations from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">v</span></span></span><script type="math/tex" id="MathJax-Element-190">v</script> can't put into the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">u</span></span></span><script type="math/tex" id="MathJax-Element-191">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">v</span></span></span><script type="math/tex" id="MathJax-Element-192">v</script>, so we only need to merge backward operations of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">u</span></span></span><script type="math/tex" id="MathJax-Element-193">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">v</span></span></span><script type="math/tex" id="MathJax-Element-194">v</script>.</p><p>After finishing the transition of subtrees, we consider where to put <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">u</span></span></span><script type="math/tex" id="MathJax-Element-195">u</script>.</p> <ul>   <li>If we don't put <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">u</span></span></span><script type="math/tex" id="MathJax-Element-196">u</script>, there will be one more space, and we can consider whether to leave it for ancestors if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">i</span><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1504">0</span></span></span><script type="math/tex" id="MathJax-Element-197">i=0</script>.That is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1505"><span class="MJXp-msubsup" id="MJXp-Span-1506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1508" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">u</span><span class="MJXp-mo" id="MJXp-Span-1510">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">i</span><span class="MJXp-mo" id="MJXp-Span-1512">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">j</span><span class="MJXp-mo" id="MJXp-Span-1514">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1519" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1520">u</span><span class="MJXp-mo" id="MJXp-Span-1521">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">i</span><span class="MJXp-mo" id="MJXp-Span-1523">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">j</span><span class="MJXp-mo" id="MJXp-Span-1525">+</span><span class="MJXp-mn" id="MJXp-Span-1526">1</span><span class="MJXp-mo" id="MJXp-Span-1527">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1532" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">u</span><span class="MJXp-mo" id="MJXp-Span-1534">,</span><span class="MJXp-mn" id="MJXp-Span-1535">0</span><span class="MJXp-mo" id="MJXp-Span-1536">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">j</span><span class="MJXp-mo" id="MJXp-Span-1538">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1543" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">u</span><span class="MJXp-mo" id="MJXp-Span-1545">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">u</span><span class="MJXp-mo" id="MJXp-Span-1547">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">j</span><span class="MJXp-mo" id="MJXp-Span-1549">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-198">f_{u,i,j,k}\rightarrow f_{u,i,j+1,k},f_{u,0,j,k}\rightarrow f_{u,u,j,k}</script>.</li>   <li>We put <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">u</span></span></span><script type="math/tex" id="MathJax-Element-199">u</script> into the position left for ancestors, that is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1553"><span class="MJXp-msubsup" id="MJXp-Span-1554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1556" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">u</span><span class="MJXp-mo" id="MJXp-Span-1558">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">i</span><span class="MJXp-mo" id="MJXp-Span-1560">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">j</span><span class="MJXp-mo" id="MJXp-Span-1562">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1567" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">u</span><span class="MJXp-mo" id="MJXp-Span-1569">,</span><span class="MJXp-mn" id="MJXp-Span-1570">0</span><span class="MJXp-mo" id="MJXp-Span-1571">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">j</span><span class="MJXp-mo" id="MJXp-Span-1573">+</span><span class="MJXp-mn" id="MJXp-Span-1574">1</span><span class="MJXp-mo" id="MJXp-Span-1575">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-200">f_{u,i,j,k}\rightarrow f_{u,0,j+1,k}</script>. And we can leave another position for ancestors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1577"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">u</span></span></span><script type="math/tex" id="MathJax-Element-201">u</script>, that is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1579"><span class="MJXp-msubsup" id="MJXp-Span-1580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1582" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">u</span><span class="MJXp-mo" id="MJXp-Span-1584">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">i</span><span class="MJXp-mo" id="MJXp-Span-1586">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">j</span><span class="MJXp-mo" id="MJXp-Span-1588">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1593" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594">u</span><span class="MJXp-mo" id="MJXp-Span-1595">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596">i</span><span class="MJXp-mn" id="MJXp-Span-1597">1</span><span class="MJXp-mo" id="MJXp-Span-1598">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">j</span><span class="MJXp-mo" id="MJXp-Span-1600">+</span><span class="MJXp-mn" id="MJXp-Span-1601">1</span><span class="MJXp-mo" id="MJXp-Span-1602">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1604" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">i</span><span class="MJXp-mn" id="MJXp-Span-1606">1</span><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608">i</span><span class="MJXp-mo" id="MJXp-Span-1609" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-202">f_{u,i,j,k}\rightarrow f_{u,i1,j+1,k}(i1<i)</script>.</li>   <li>We put <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">u</span></span></span><script type="math/tex" id="MathJax-Element-203">u</script> into position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">u</span></span></span><script type="math/tex" id="MathJax-Element-204">u</script>, in that case, we can't leave position for ancestors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">u</span></span></span><script type="math/tex" id="MathJax-Element-205">u</script>, that is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1616"><span class="MJXp-msubsup" id="MJXp-Span-1617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1619" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">u</span><span class="MJXp-mo" id="MJXp-Span-1621">,</span><span class="MJXp-mn" id="MJXp-Span-1622">0</span><span class="MJXp-mo" id="MJXp-Span-1623">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">j</span><span class="MJXp-mo" id="MJXp-Span-1625">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1627" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1630" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">u</span><span class="MJXp-mo" id="MJXp-Span-1632">,</span><span class="MJXp-mn" id="MJXp-Span-1633">0</span><span class="MJXp-mo" id="MJXp-Span-1634">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">j</span><span class="MJXp-mo" id="MJXp-Span-1636">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-206">f_{u,0,j,k}\rightarrow f_{u,0,j,k}</script>.</li>   <li>We put <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">u</span></span></span><script type="math/tex" id="MathJax-Element-207">u</script> backward, then we can't put anything in the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">u</span></span></span><script type="math/tex" id="MathJax-Element-208">u</script>, but we can leave position for ancestors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">u</span></span></span><script type="math/tex" id="MathJax-Element-209">u</script>, that is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1644"><span class="MJXp-msubsup" id="MJXp-Span-1645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1647" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">u</span><span class="MJXp-mo" id="MJXp-Span-1649">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">i</span><span class="MJXp-mo" id="MJXp-Span-1651">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">i</span><span class="MJXp-msubsup" id="MJXp-Span-1654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1656" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1657">−</span><span class="MJXp-mn" id="MJXp-Span-1658">2</span><span class="MJXp-mo" id="MJXp-Span-1659">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1664" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">u</span><span class="MJXp-mo" id="MJXp-Span-1666">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">i</span><span class="MJXp-mo" id="MJXp-Span-1668">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670">i</span><span class="MJXp-msubsup" id="MJXp-Span-1671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1673" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1674">−</span><span class="MJXp-mn" id="MJXp-Span-1675">1</span><span class="MJXp-mo" id="MJXp-Span-1676">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">k</span><span class="MJXp-mo" id="MJXp-Span-1678">+</span><span class="MJXp-mn" id="MJXp-Span-1679">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1680" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1683" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">u</span><span class="MJXp-mo" id="MJXp-Span-1685">,</span><span class="MJXp-mn" id="MJXp-Span-1686">0</span><span class="MJXp-mo" id="MJXp-Span-1687">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">i</span><span class="MJXp-msubsup" id="MJXp-Span-1690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1692" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1693">−</span><span class="MJXp-mn" id="MJXp-Span-1694">1</span><span class="MJXp-mo" id="MJXp-Span-1695">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1700" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">u</span><span class="MJXp-mo" id="MJXp-Span-1702">,</span><span class="MJXp-mn" id="MJXp-Span-1703">0</span><span class="MJXp-mo" id="MJXp-Span-1704">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">i</span><span class="MJXp-msubsup" id="MJXp-Span-1707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1709" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1710">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">k</span><span class="MJXp-mo" id="MJXp-Span-1712">+</span><span class="MJXp-mn" id="MJXp-Span-1713">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-210">f_{u,i,siz_u-2,k}\rightarrow f_{u,i,siz_u-1,k+1},f_{u,0,siz_u-1,k}\rightarrow f_{u,0,siz_u,k+1}</script>.</li> </ul><p>The answer for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">i</span></span></span><script type="math/tex" id="MathJax-Element-211">i</script> operations is just we leave position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">n</span><span class="MJXp-mo" id="MJXp-Span-1718" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719">i</span><span class="MJXp-mo" id="MJXp-Span-1720" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1721">1</span></span></span><script type="math/tex" id="MathJax-Element-212">n-i+1</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1722"><span class="MJXp-mn" id="MJXp-Span-1723">1</span></span></span><script type="math/tex" id="MathJax-Element-213">1</script>, and there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">n</span><span class="MJXp-mo" id="MJXp-Span-1726" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">i</span></span></span><script type="math/tex" id="MathJax-Element-214">n-i</script> spaces (therefore the spaces are before <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">n</span><span class="MJXp-mo" id="MJXp-Span-1730" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">i</span><span class="MJXp-mo" id="MJXp-Span-1732" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1733">1</span></span></span><script type="math/tex" id="MathJax-Element-215">n-i+1</script>) and no backward operations.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">O</span><span class="MJXp-mo" id="MJXp-Span-1736" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-1738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1740" style="vertical-align: 0.5em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-1741" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-216">O(\sum n^5)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> read</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">f</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> c</span><span class="pun">=</span><span class="pln">getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">c</span><span class="pun">&lt;</span><span class="str">'0'</span><span class="pun">||</span><span class="pln">c</span><span class="pun">&gt;</span><span class="str">'9'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">c</span><span class="pun">==</span><span class="str">'-'</span><span class="pun">)</span><span class="pln">f</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		c</span><span class="pun">=</span><span class="pln">getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">c</span><span class="pun">&gt;=</span><span class="str">'0'</span><span class="pun">&amp;&amp;</span><span class="pln">c</span><span class="pun">&lt;=</span><span class="str">'9'</span><span class="pun">)</span><span class="pln">x</span><span class="pun">=</span><span class="pln">x</span><span class="pun">*</span><span class="lit">10</span><span class="pun">+</span><span class="pln">c</span><span class="pun">-</span><span class="str">'0'</span><span class="pun">,</span><span class="pln">c</span><span class="pun">=</span><span class="pln">getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">*</span><span class="pln">f</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">namespace</span><span class="pln"> tokido_saya </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> maxn</span><span class="pun">=</span><span class="lit">81</span><span class="pun">,</span><span class="pln">mod</span><span class="pun">=</span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">typedef</span><span class="pln"> vector</span><span class="str">&lt;int&gt;</span><span class="pun">::</span><span class="pln">iterator iter</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
	ll f</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> zc</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
	ll qpow</span><span class="pun">(</span><span class="pln">ll x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		ll w</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">w</span><span class="pun">=</span><span class="pln">w</span><span class="pun">*</span><span class="pln">x</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
			x</span><span class="pun">=</span><span class="pln">x</span><span class="pun">*</span><span class="pln">x</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">,</span><span class="pln">y</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	ll C</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">||</span><span class="pln">y</span><span class="pun">&gt;</span><span class="pln">x</span><span class="pun">)</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> fac</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">y</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">void</span><span class="pln"> dfs1</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]=</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]=</span><span class="pln">u</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">iter it</span><span class="pun">=</span><span class="pln">v</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">();</span><span class="pln">it</span><span class="pun">!=</span><span class="pln">v</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">();</span><span class="pln">it</span><span class="pun">++)</span><span class="pln">dfs1</span><span class="pun">(*</span><span class="pln">it</span><span class="pun">),</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln">rp</span><span class="pun">[*</span><span class="pln">it</span><span class="pun">]);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">void</span><span class="pln"> dfs2</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">iter it</span><span class="pun">=</span><span class="pln">v</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">();</span><span class="pln">it</span><span class="pun">!=</span><span class="pln">v</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">();</span><span class="pln">it</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">=*</span><span class="pln">it</span><span class="pun">;</span><span class="pln">
			dfs2</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">--)</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">j</span><span class="pun">;</span><span class="pln">j</span><span class="pun">--)</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">]=(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">]+</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]*</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">,</span><span class="pln">j</span><span class="pun">))%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j1</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j1</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">j1</span><span class="pun">++)</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k1</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k1</span><span class="pun">&lt;=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">j1</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]);</span><span class="pln">k1</span><span class="pun">++)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					memset</span><span class="pun">(</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">],</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">]));</span><span class="pln">
					</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
						</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">k</span><span class="pun">++)</span><span class="pln">
							</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> w</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">w</span><span class="pun">&lt;=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">k1</span><span class="pun">,</span><span class="pln">j</span><span class="pun">);</span><span class="pln">w</span><span class="pun">++)</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="pln">j1</span><span class="pun">-</span><span class="pln">w</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="pln">k1</span><span class="pun">-</span><span class="pln">w</span><span class="pun">]=(</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="pln">j1</span><span class="pun">-</span><span class="pln">w</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="pln">k1</span><span class="pun">-</span><span class="pln">w</span><span class="pun">]+</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">k</span><span class="pun">+</span><span class="pln">k1</span><span class="pun">-</span><span class="pln">w</span><span class="pun">,</span><span class="pln">k</span><span class="pun">))%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">	
			memset</span><span class="pun">(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">],</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]));</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">k</span><span class="pun">++)</span><span class="pln">
					</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j1</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j1</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">j1</span><span class="pun">++)</span><span class="pln">
						</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k1</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k1</span><span class="pun">&lt;=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">],</span><span class="pln">j1</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">k1</span><span class="pun">++)</span><span class="pln">
							</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">])</span><span class="pln">
							</span><span class="pun">{</span><span class="pln">
								</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> w</span><span class="pun">=</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">];</span><span class="pln">
								f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">]+</span><span class="pln">f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]*</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
								</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">]+</span><span class="pln">f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]*</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
							</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="pln">i</span><span class="pun">-</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">--)</span><span class="pln">
					</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k</span><span class="pun">--)</span><span class="pln">
					</span><span class="pun">{</span><span class="pln">
						</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> val</span><span class="pun">=</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">];</span><span class="pln">
						f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
						</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">p</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">p</span><span class="pun">++)</span><span class="pln">
							</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> w</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">w</span><span class="pun">&lt;=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">p</span><span class="pun">,</span><span class="pln">j</span><span class="pun">-(</span><span class="pln">i</span><span class="pun">-</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">));</span><span class="pln">w</span><span class="pun">++)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-</span><span class="pln">w</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="pln">p</span><span class="pun">-</span><span class="pln">w</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-</span><span class="pln">w</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="pln">p</span><span class="pun">-</span><span class="pln">w</span><span class="pun">]+</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="pln">p</span><span class="pun">]*</span><span class="pln">val</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">j</span><span class="pun">-(</span><span class="pln">i</span><span class="pun">-</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">),</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">k</span><span class="pun">+</span><span class="pln">p</span><span class="pun">-</span><span class="pln">w</span><span class="pun">,</span><span class="pln">k</span><span class="pun">))%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">}</span><span class="pln">
			siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">--)</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]=(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">])%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u</span><span class="pun">!=</span><span class="lit">1</span><span class="pun">)</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">--)</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]);</span><span class="pln">k</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k</span><span class="pun">--)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				ll sum</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">i</span><span class="pun">--)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> w</span><span class="pun">=</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">];</span><span class="pln">
					f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">==</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
					f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]=</span><span class="pln">sum</span><span class="pun">,</span><span class="pln">sum</span><span class="pun">=(</span><span class="pln">sum</span><span class="pun">+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> w</span><span class="pun">=</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">];</span><span class="pln">
				f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">,</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">+</span><span class="pln">sum</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">==</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">,</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]++;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
		t</span><span class="pun">=</span><span class="pln">read</span><span class="pun">(),</span><span class="pln">fac</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">80</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">i</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
		inv</span><span class="pun">[</span><span class="lit">80</span><span class="pun">]=</span><span class="pln">qpow</span><span class="pun">(</span><span class="pln">fac</span><span class="pun">[</span><span class="lit">80</span><span class="pun">],</span><span class="pln">mod</span><span class="pun">-</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">80</span><span class="pun">;</span><span class="pln">i</span><span class="pun">;</span><span class="pln">i</span><span class="pun">--)</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]*</span><span class="pln">i</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			n</span><span class="pun">=</span><span class="pln">read</span><span class="pun">(),</span><span class="pln">memset</span><span class="pun">(</span><span class="pln">f</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">f</span><span class="pun">)),</span><span class="pln">memset</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">)),</span><span class="pln">memset</span><span class="pun">(</span><span class="pln">siz</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">siz</span><span class="pun">));</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				x</span><span class="pun">=</span><span class="pln">read</span><span class="pun">(),</span><span class="pln">y</span><span class="pun">=</span><span class="pln">read</span><span class="pun">();</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln">swap</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
				v</span><span class="pun">[</span><span class="pln">x</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">sort</span><span class="pun">(</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">()),</span><span class="pln">reverse</span><span class="pun">(</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
			dfs1</span><span class="pun">(</span><span class="lit">1</span><span class="pun">),</span><span class="pln">dfs2</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">--)</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"%lld "</span><span class="pun">,</span><span class="pln">f</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">i</span><span class="pun">-</span><span class="lit">2</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]);</span><span class="pln">
			puts</span><span class="pun">(</span><span class="str">"1"</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> tokido_saya</span><span class="pun">::</span><span class="pln">main</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="/contest/2089" class="notice" style="text-decoration: none;">Codeforces Round 1012 (Div. 1)</a> </span>
        </div>
        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="/contest/2090" class="notice" style="text-decoration: none;">Codeforces Round 1012 (Div. 2)</a> </span>
        </div>
        
            <script type="text/javascript">
    $(document).ready(function () {
        $(".delete-resource-link-325085-141679").click(function() {
            var that = this;
            Codeforces.confirm("Are you sure you want to detach a contest?", function () {
                $.post("/data/blogAndContest", {
                    action: "detachBlogFromContest",
                    blogId: "325085",
                    blogEntryId: "141053",
                    contestId: $(that).attr("data-contestId"),
                    resourceIds: $(that).attr("data-resourceIds")
                }, function(json) {        
                    Codeforces.reloadAndShowMessageOrShowError(json, "Contest detached");
                });
            }, function () {}, "Yes", "No");
        });
    });
</script>
        



    <div class="roundbox meta borderTopRound borderBottomRound" style="">
        <div class="left-meta">
            <ul>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-up-141679"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/voteup-gray.png" alt="Vote: I like it" title="Vote: I like it"></a>


</li>
                    <li style="line-height: 1.6em;">

        
        <span class="topic-rating topic-rating-141679" title="Topic rating" data-topicid="141679" data-rawrating="13" style="font-size:larger;position:relative;bottom:1px;font-weight:bold;color:green">+13</span>
        
</li>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-down-141679"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/votedown-gray.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>


</li>
            </ul>
        </div>


            <span style="position: relative; line-height: 1.65em; top: 0.75rem; left: 0.8em;">
            </span>

        <div class="right-meta">
            <ul>
                    <li>        <a href="/profile/Ecrade_"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/user_16x16.png" alt="Author" title="Author"></a>


        <a href="/profile/Ecrade_">
        Ecrade_
        </a>
</li>
                    <li>        <img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/date_16x16.png" alt="Publication date" title="Publication date">


        
        <span class="format-humantime" title="Mar/26/2025 01:48 UTC">9 months ago</span>
        
</li>
                    <li>        <a href="/blog/entry/141053#comments"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/comments_16x16.png" alt="Comments" title="Comments"></a>


        <a href="/blog/entry/141053#comments">
        44
        </a>
</li>
            </ul>
        </div>

        <br style="clear:both;">
    </div>


<style type="text/css">
    .comments .title {
        float: left;
    }

    .comments .comments-actions-div {
        float: right;
        margin-top: 3rem;
        margin-right: 0.5em;
    }

    .comments .comments-actions-div .separator {
        margin: 0 1rem;
    }

    .comments label.show-archived {
    }

    .comments label.show-archived, .comments label.show-archived * {
        font-size: 1.4rem !important;
        color: black !important;
        /*position: relative !important;*/
        /*bottom: 0.4rem !important;*/
    }

    .comments label.show-archived input {
        height: 1.4rem !important;
        width: 1.4rem !important;
        position: relative;
        top: 0.25rem;
    }

    .new-root-comment {
        font-size: 1.4rem !important;
    }
</style>

    <div class="comments" commentableid="155645">
        <div style="display: flow-root">
            <div class="title">
                <img src="//codeforces.com/codeforces.org/s/52448/images/icons/comments-48x48.png" alt="Comments" title="Comments" style="position:relative;top:0.6em;">
                <a name="comments">Comments (44)</a>

            </div>
            <div class="comments-actions-div">
                <a href="#" class="new-root-comment">Write comment?</a>
            </div>
        </div>

<div class="comment" commentid="1259598">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1259598" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Ak_16" title="Expert Ak_16" class="rated-user user-blue">Ak_16</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/26/2025 20:09 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1259598" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Ak_16" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Ak_16" title="Expert Ak_16" class="rated-user user-blue">Ak_16</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/26/2025 20:09 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1259598" href="?#comment-1259598" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1259598" class="CommentVoteFrame" myvotedirection="0" data-commentrating="53" data-commentuserid="3096521" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+53</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1259598">
                        <div class="moveup">
                        <div class="ttypography"><p>Lightning fast editorial</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1259598 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1259598 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1259598">
        </ul>
    </div>
</div>

<div class="comment" commentid="1259639">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1259639" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/wddd" title="Specialist wddd" class="rated-user user-cyan">wddd</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 01:22 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">6</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1259639" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/wddd" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/wddd" title="Specialist wddd" class="rated-user user-cyan">wddd</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 01:22 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1259639" href="?#comment-1259639" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1259639" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3028165" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1259639">
                        <div class="moveup">
                        <div class="ttypography"><p>Anyone has a better explanation for 2089A — Simple Permutation ? I don't really follow the solution.</p><p>Like why we want to find a prime between between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1742"><span class="MJXp-mo" id="MJXp-Span-1743" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-1744" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1746">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1747" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-217-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-217">\lfloor \frac{n}{3} \rfloor</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1748"><span class="MJXp-mo" id="MJXp-Span-1749" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mfrac" id="MJXp-Span-1750" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1751">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1753">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1754" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-218-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-218">\lceil \frac{2n}{3} \rceil</script> (instead of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1755"><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-1757" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1759">4</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1760" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-219-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-219">\lfloor \frac{n}{4} \rfloor</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1761"><span class="MJXp-mo" id="MJXp-Span-1762" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-1763" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1765">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-220-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-220">\lfloor \frac{n}{2} \rfloor</script>)? And where is this <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">p</span><span class="MJXp-mo" id="MJXp-Span-1769" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">p</span><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1772">1</span><span class="MJXp-mo" id="MJXp-Span-1773" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">p</span><span class="MJXp-mo" id="MJXp-Span-1775" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1776">1</span><span class="MJXp-mo" id="MJXp-Span-1777" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778">p</span><span class="MJXp-mo" id="MJXp-Span-1779" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1780">2</span><span class="MJXp-mo" id="MJXp-Span-1781" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">p</span><span class="MJXp-mo" id="MJXp-Span-1783" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1784">2</span><span class="MJXp-mo" id="MJXp-Span-1785" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1786" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-221-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-221">p, p-1, p+1, p-2, p+2, \dots</script> from? What's the intuitions behind them?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1259639 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1259639 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1259639">
                <li>
<div class="comment" commentid="1259641">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1259641" commentparentid="1259639">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/i_love_sqrt_decomp" title="Specialist i_love_sqrt_decomp" class="rated-user user-cyan">i_love_sqrt_decomp</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 01:31 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1259641" commentparentid="1259639">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/i_love_sqrt_decomp" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3464794/avatar/4f550f1f345e5477.jpg">        </a>
        <div><a href="/profile/i_love_sqrt_decomp" title="Specialist i_love_sqrt_decomp" class="rated-user user-cyan">i_love_sqrt_decomp</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 01:31 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1259641" href="?#comment-1259641" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259639" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1259641" revisioncount="5" revision="5">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">5</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1259641" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3464794" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1259641">
                        <div class="moveup">
                        <div class="ttypography"><p>Note that each tuple <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1787"><span class="MJXp-mo" id="MJXp-Span-1788" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">p</span><span class="MJXp-mo" id="MJXp-Span-1790" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">k</span><span class="MJXp-mo" id="MJXp-Span-1792" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">p</span><span class="MJXp-mo" id="MJXp-Span-1794" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795">k</span><span class="MJXp-mo" id="MJXp-Span-1796" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-222-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-222">(p+k,p-k)</script> balances out each other, so the average is still <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">p</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-223-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-223">p</script>. We want to choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">p</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-224-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-224">p</script> s.t. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">p</span><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-1804" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1806">3</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-225-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-225">p-\frac{n}{3}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">p</span><span class="MJXp-mo" id="MJXp-Span-1809" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1810" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1812">3</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-226-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-226">p+\frac{n}{3}</script> is in the range <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1813"><span class="MJXp-mo" id="MJXp-Span-1814" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1815">1</span><span class="MJXp-mo" id="MJXp-Span-1816" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1817">n</span><span class="MJXp-mo" id="MJXp-Span-1818" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-227-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-227">[1,n]</script>, thus the range described in the editorial.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1259641 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1259641 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1259641">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1259672">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1259672" commentparentid="1259639">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/ben-ustc" title="Grandmaster ben-ustc" class="rated-user user-red">ben-ustc</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 04:09 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">3</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1259672" commentparentid="1259639">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/ben-ustc" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/ben-ustc" title="Grandmaster ben-ustc" class="rated-user user-red">ben-ustc</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 04:09 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1259672" href="?#comment-1259672" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259639" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1259672" revisioncount="3" revision="3">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">3</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1259672" class="CommentVoteFrame" myvotedirection="0" data-commentrating="5" data-commentuserid="3441734" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1259672">
                        <div class="moveup">
                        <div class="ttypography"><p>The idea is, for example if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">n</span><span class="MJXp-mo" id="MJXp-Span-1821" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1822">12</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-228-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-228">n = 12</script>, We can make permutation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1823"><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1825">5</span><span class="MJXp-mo" id="MJXp-Span-1826" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1827">4</span><span class="MJXp-mo" id="MJXp-Span-1828" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1829">6</span><span class="MJXp-mo" id="MJXp-Span-1830" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1831">3</span><span class="MJXp-mo" id="MJXp-Span-1832" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1833">7</span><span class="MJXp-mo" id="MJXp-Span-1834" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1835">2</span><span class="MJXp-mo" id="MJXp-Span-1836" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1837">8</span><span class="MJXp-mo" id="MJXp-Span-1838" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1839">1</span><span class="MJXp-mo" id="MJXp-Span-1840" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1841">9</span><span class="MJXp-mo" id="MJXp-Span-1842" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1843">10</span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1845">11</span><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1847">12</span><span class="MJXp-mo" id="MJXp-Span-1848" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-229-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-229">(5,4,6,3,7,2,8,1,9,10,11,12)</script> so that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1849"><span class="MJXp-msubsup" id="MJXp-Span-1850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1852" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1853" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1856" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1857" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1860" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-1861" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1864" style="vertical-align: -0.4em;">7</span></span><span class="MJXp-mo" id="MJXp-Span-1865" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1868" style="vertical-align: -0.4em;">9</span></span><span class="MJXp-mo" id="MJXp-Span-1869" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1870">5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-230-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-230">c_1 = c_3 = c_5 = c_7 = c_9 = 5</script>.</p><p>The intuition is we want to find a prime <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872">p</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-231-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-231">p</script> close to the midpoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1874">n</span><span class="MJXp-mrow" id="MJXp-Span-1875"><span class="MJXp-mo" id="MJXp-Span-1876" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-1877">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-232-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-232">n/2</script>, then construct the pattern <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1878"><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">p</span><span class="MJXp-mo" id="MJXp-Span-1881" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882">p</span><span class="MJXp-mo" id="MJXp-Span-1883" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1884">1</span><span class="MJXp-mo" id="MJXp-Span-1885" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">p</span><span class="MJXp-mo" id="MJXp-Span-1887" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1888">1</span><span class="MJXp-mo" id="MJXp-Span-1889" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890">p</span><span class="MJXp-mo" id="MJXp-Span-1891" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1892">2</span><span class="MJXp-mo" id="MJXp-Span-1893" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">p</span><span class="MJXp-mo" id="MJXp-Span-1895" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1896">2</span><span class="MJXp-mo" id="MJXp-Span-1897" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1898" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1899" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1900" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1901" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-233-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-233">(p, p-1, p+1, p-2, p+2, ... )</script> until it touched <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1902"><span class="MJXp-mn" id="MJXp-Span-1903">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-234-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-234">0</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905">n</span><span class="MJXp-mo" id="MJXp-Span-1906" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1907">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-235-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-235">n+1</script>. Such pattern makes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1908"><span class="MJXp-msubsup" id="MJXp-Span-1909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1911" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1912" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1915" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1916" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1918" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1919" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-1920" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1921" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1922" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1923" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-236-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-236">c_1, c_3, c_5, ...</script> all equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">p</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-237-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-237">p</script>,</p><p>It can be shown that if the chosen <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1926"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927">p</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-238-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-238">p</script> is close enough to the midpoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1928"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1929">n</span><span class="MJXp-mrow" id="MJXp-Span-1930"><span class="MJXp-mo" id="MJXp-Span-1931" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-1932">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-239-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-239">n/2</script>, that is, between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1933"><span class="MJXp-mo" id="MJXp-Span-1934" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mstyle" id="MJXp-Span-1935"><span class="MJXp-mfrac" id="MJXp-Span-1936" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1938">3</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1939" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-240-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-240">\lfloor \dfrac n3 \rfloor</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1940"><span class="MJXp-mo" id="MJXp-Span-1941" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mstyle" id="MJXp-Span-1942"><span class="MJXp-mfrac" id="MJXp-Span-1943" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1944">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1946">3</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1947" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-241-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-241">\lceil \dfrac{2n}3 \rceil</script>, then the constructed pattern will be long enough that at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1948"><span class="MJXp-mo" id="MJXp-Span-1949" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mstyle" id="MJXp-Span-1950"><span class="MJXp-mfrac" id="MJXp-Span-1951" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1952">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1953">3</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1954" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-1955" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1956">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-242-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-242">\lfloor \dfrac n3 \rfloor - 1</script> elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-243-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-243">c</script> will be equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1959"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1960">p</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-244-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-244">p</script>. </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1259672 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1259672 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1259672">
                <li>
<div class="comment" commentid="1260805">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1260805" commentparentid="1259672">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Kortex" title="Pupil Kortex" class="rated-user user-green">Kortex</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/30/2025 05:11 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1260805" commentparentid="1259672">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Kortex" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3684166/avatar/e65a3c6606d9b620.jpg">        </a>
        <div><a href="/profile/Kortex" title="Pupil Kortex" class="rated-user user-green">Kortex</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/30/2025 05:11 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1260805" href="?#comment-1260805" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259672" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1260805" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1260805" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3684166" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1260805">
                        <div class="moveup">
                        <div class="ttypography"><p>can you please provide a proof that choosing this interval for p will give us the required least no. of primes?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1260805 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1260805 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1260805">
                <li>
<div class="comment" commentid="1261884">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1261884" commentparentid="1260805">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/newbie_1604" title="Newbie newbie_1604" class="rated-user user-gray">newbie_1604</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/02/2025 16:49 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1261884" commentparentid="1260805">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/newbie_1604" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4311634/avatar/1ad21307c53cdd6b.jpg">        </a>
        <div><a href="/profile/newbie_1604" title="Newbie newbie_1604" class="rated-user user-gray">newbie_1604</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/02/2025 16:49 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1261884" href="?#comment-1261884" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1260805" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1261884" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4311634" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1261884">
                        <div class="moveup">
                        <div class="ttypography"><p><a href="https://www.youtube.com/live/d-c5AiBnxg8?si=P4puCWSj2gN5Pl7i">https://www.youtube.com/live/d-c5AiBnxg8?si=P4puCWSj2gN5Pl7i</a> check this video for understanding the solution</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1261884 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1261884 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1261884">
                <li>
<div class="comment" commentid="1261932">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1261932" commentparentid="1261884">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Kortex" title="Pupil Kortex" class="rated-user user-green">Kortex</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/02/2025 19:59 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1261932" commentparentid="1261884">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Kortex" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3684166/avatar/e65a3c6606d9b620.jpg">        </a>
        <div><a href="/profile/Kortex" title="Pupil Kortex" class="rated-user user-green">Kortex</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/02/2025 19:59 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1261932" href="?#comment-1261932" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1261884" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1261932" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3684166" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1261932">
                        <div class="moveup">
                        <div class="ttypography"><p>ya i had got it..forgot to delete,,but thanks</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1261932 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1261932 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1261932">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1273669">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1273669" commentparentid="1259639">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/oneafter" title="Unrated, oneafter" class="rated-user user-black">oneafter</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="May/08/2025 08:25 UTC">7 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1273669" commentparentid="1259639">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/oneafter" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/oneafter" title="Unrated, oneafter" class="rated-user user-black">oneafter</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="May/08/2025 08:25 UTC">7 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1273669" href="?#comment-1273669" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259639" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1273669" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2436199" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1273669">
                        <div class="moveup">
                        <div class="ttypography"><p>In fact, the prime between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1961"><span class="MJXp-mrow" id="MJXp-Span-1962"><span class="MJXp-mo" id="MJXp-Span-1963" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-1964" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1966">6</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1967" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-245-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-245">\left\lfloor \frac{n}{6} \right\rfloor</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1968"><span class="MJXp-mrow" id="MJXp-Span-1969"><span class="MJXp-mo" id="MJXp-Span-1970" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-1971" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1972">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1974">6</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1975" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-246-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-246">\left\lfloor \frac{2n}{6} \right\rfloor</script> will be enough. </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1273669 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1273669 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1273669">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1259695">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1259695" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/minuki646" title="Specialist minuki646" class="rated-user user-cyan">minuki646</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 05:24 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1259695" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/minuki646" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2857544/avatar/f97fbafdf75c22bb.jpg">        </a>
        <div><a href="/profile/minuki646" title="Specialist minuki646" class="rated-user user-cyan">minuki646</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 05:24 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1259695" href="?#comment-1259695" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1259695" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2857544" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1259695">
                        <div class="moveup">
                        <div class="ttypography"><p>Div2E/Div1B (easy version) — I solved with 2 pointer on buffs, love that. </p><p>Really good problems.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1259695 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1259695 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1259695">
        </ul>
    </div>
</div>

<div class="comment" commentid="1259721">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1259721" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Jomax100" title="Expert Jomax100" class="rated-user user-blue">Jomax100</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 07:31 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">9</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1259721" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Jomax100" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/384281/avatar/9259af372deb1789.jpg">        </a>
        <div><a href="/profile/Jomax100" title="Expert Jomax100" class="rated-user user-blue">Jomax100</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 07:31 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1259721" href="?#comment-1259721" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1259721" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1259721" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="384281" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1259721">
                        <div class="moveup">
                        <div class="ttypography"><p>Thanks for the editorial. </p><p>I was looking forward to div 1 C1 but it seems missing. Are you planning to add solution for it? 2089C1 — Key of Like (Easy Version where k=0) For folks who struggled with the easy version, the solution analysis for the hard version is quite hard to follow</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1259721 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1259721 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1259721">
                <li>
<div class="comment" commentid="1259861">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1259861" commentparentid="1259721">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 16:07 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">8</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1259861" commentparentid="1259721">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SoReMore" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4013757/avatar/2abb517cad9f5014.jpg">        </a>
        <div><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 16:07 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1259861" href="?#comment-1259861" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259721" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1259861" class="CommentVoteFrame" myvotedirection="0" data-commentrating="10" data-commentuserid="4013757" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1259861">
                        <div class="moveup">
                        <div class="ttypography"><p>Here is my approach. When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977">k</span><span class="MJXp-mo" id="MJXp-Span-1978" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1979">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-247-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-247">k = 0</script>, the keys and locks are in the same position, so the optimal chose can be seen as just trying to open the same lock. Thinking with the idea of generating function, you can find for the last <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981">i</span><span class="MJXp-mo" id="MJXp-Span-1982" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1984">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-248-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-248">i-th</script> lock, the formula is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1985"><span class="MJXp-mfrac" id="MJXp-Span-1986" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1987">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988">i</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1989"><span class="MJXp-mo" id="MJXp-Span-1990" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1995"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1996">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1992">k</span><span class="MJXp-mo" id="MJXp-Span-1993">=</span><span class="MJXp-mn" id="MJXp-Span-1994">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1999" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-249-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-249">\frac{1}{i}\sum_{k=1}^{i}z^k</script> ,where the exponent of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-250-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-250">z</script> indicates the turns and the coefficient indicates the possiblity of openning a lock in this turn.(Don't forget to multiple former polynomials) And you can see that there is a loop in the turn so you can just let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2002"><span class="MJXp-msubsup" id="MJXp-Span-2003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2004" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2005" style="vertical-align: 0.5em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2006" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2007">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-251-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-251">z^n = 1</script>, thus, you can calculate directly the answer as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2008"><span class="MJXp-msubsup" id="MJXp-Span-2009"><span class="MJXp-mo" id="MJXp-Span-2010" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2015"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016">l</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2011"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2012">i</span><span class="MJXp-mo" id="MJXp-Span-2013">=</span><span class="MJXp-mn" id="MJXp-Span-2014">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2017"><span class="MJXp-mo" id="MJXp-Span-2018" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">j</span><span class="MJXp-mo" id="MJXp-Span-2021">=</span><span class="MJXp-mn" id="MJXp-Span-2022">1</span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2025" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2026">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027">l</span><span class="MJXp-mo" id="MJXp-Span-2028">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">j</span><span class="MJXp-mo" id="MJXp-Span-2030">+</span><span class="MJXp-mn" id="MJXp-Span-2031">1</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2032"><span class="MJXp-mo" id="MJXp-Span-2033" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2039">l</span><span class="MJXp-mo" id="MJXp-Span-2040">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2041">j</span><span class="MJXp-mo" id="MJXp-Span-2042">+</span><span class="MJXp-mn" id="MJXp-Span-2043">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2035">k</span><span class="MJXp-mo" id="MJXp-Span-2036">=</span><span class="MJXp-mn" id="MJXp-Span-2037">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2046" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-252-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-252">\sum_{i=1}^{l}\prod_{j=1}^{i} \frac{1}{l-j+1}\sum_{k=1}^{l-j+1}z^k</script> and the coefficients will be the answer.(Note that the coefficient of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2047"><span class="MJXp-mn" id="MJXp-Span-2048">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-253-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-253">1</script> will be the answer of the n-th person) The time complexity will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2049"><span class="MJXp-msubsup" id="MJXp-Span-2050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2052" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053">l</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-254-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-254">n^2l</script>.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1259861 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1259861 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1259861">
                <li>
<div class="comment" commentid="1260289">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1260289" commentparentid="1259861">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/bricked_" title="Specialist bricked_" class="rated-user user-cyan">bricked_</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/29/2025 07:16 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">5</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1260289" commentparentid="1259861">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/bricked_" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3287483/avatar/2c6aa4870bf5f30f.jpg">        </a>
        <div><a href="/profile/bricked_" title="Specialist bricked_" class="rated-user user-cyan">bricked_</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/29/2025 07:16 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1260289" href="?#comment-1260289" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259861" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1260289" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1260289" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3287483" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1260289">
                        <div class="moveup">
                        <div class="ttypography"><p>can you explain how the formulas work(why they help us calculate the answer)? i tried asking chatgpt for help but i didn't quite understand, and i find this 2.2k problem very intriguing.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1260289 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1260289 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1260289">
                <li>
<div class="comment" commentid="1260309">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1260309" commentparentid="1260289">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/29/2025 10:41 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">4</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1260309" commentparentid="1260289">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SoReMore" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4013757/avatar/2abb517cad9f5014.jpg">        </a>
        <div><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/29/2025 10:41 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1260309" href="?#comment-1260309" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1260289" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1260309" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1260309" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4013757" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1260309">
                        <div class="moveup">
                        <div class="ttypography"><p>Let's take <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055">l</span><span class="MJXp-mo" id="MJXp-Span-2056" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2057">3</span><span class="MJXp-mo" id="MJXp-Span-2058" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059">n</span><span class="MJXp-mo" id="MJXp-Span-2060" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2061">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-255-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-255">l=3,n=3</script> for example.For the first lock, the possiblity of making the lock open in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2062"><span class="MJXp-mn" id="MJXp-Span-2063">1</span><span class="MJXp-mo" id="MJXp-Span-2064" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2065">2</span><span class="MJXp-mo" id="MJXp-Span-2066" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2067">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-256-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-256">1,2,3</script> turn(s) will be the same, which is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2068"><span class="MJXp-mfrac" id="MJXp-Span-2069" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2070">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2071">3</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-257-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-257">\frac{1}{3}</script>. So, as I mentioned above, we make the exponent for the turns and the coefficient for the possiblity for exactly end at which turn. So you can note that for the first lock,the formula will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2072"><span class="MJXp-mfrac" id="MJXp-Span-2073" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2074">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2075">3</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">z</span><span class="MJXp-mo" id="MJXp-Span-2077" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2078" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2079">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2080">3</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2083" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2085" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2086">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2087">3</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2090" style="vertical-align: 0.5em;">3</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-258-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-258">\frac{1}{3}z+\frac{1}{3}z^2+\frac{1}{3}z^3</script>. Which means for the first lock,there is a chance of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2091"><span class="MJXp-mfrac" id="MJXp-Span-2092" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2093">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2094">3</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-259-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-259">\frac{1}{3}</script> to end at exactly the first,second and the third turn,and no chance for turns else.And then for the second lock, we should calculate base on the first lock's formula, this is becase we only discussed turns costed for this lock,but how about which turn we are now at? Just mutiply the second turns formula and the first turns formula. And after expanding it,you can see that exponent adds and the possiblity multiplies, which is just like what we are going to calculate for(Do the expanding yourself to feel it). It will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2095"><span class="MJXp-mo" id="MJXp-Span-2096" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-2097" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2098">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2099">3</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2100">z</span><span class="MJXp-mo" id="MJXp-Span-2101" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2102" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2103">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2104">3</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2106" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2107" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2108" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2109" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2110">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2111">3</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2113" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2114" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-2115" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2116" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-2117" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2118">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2119">2</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2120">z</span><span class="MJXp-mo" id="MJXp-Span-2121" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2122" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2123">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2124">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2127" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2128" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2129" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2130" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2131">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2132">6</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2135" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2136" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2137" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2138">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2139">3</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2141" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2142" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-2143" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2144" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2145">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2146">3</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2149" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-2150" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2151" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2152">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2153">6</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2155" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2156" style="vertical-align: 0.5em;">5</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-260-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-260">(\frac{1}{3}z+\frac{1}{3}z^2+\frac{1}{3}z^3)(\frac{1}{2}z+\frac{1}{2}z^2) = \frac{1}{6}z^2+\frac{1}{3}z^3+\frac{1}{3}z^4+\frac{1}{6}z^5</script> , which indicates that after the second lock is opened, we are now at the second turn for the possiblity of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2157"><span class="MJXp-mfrac" id="MJXp-Span-2158" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2159">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2160">6</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-261-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-261">\frac{1}{6}</script>, the third for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2161"><span class="MJXp-mfrac" id="MJXp-Span-2162" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2163">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2164">3</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-262-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-262">\frac{1}{3}</script> and etc. And you can calculate for the third lock for the same. After that, we've got the formula for the three locks. We can just sum it up for the answer. The final formula will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2165"><span class="MJXp-msubsup" id="MJXp-Span-2166"><span class="MJXp-mo" id="MJXp-Span-2167" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2172"><span class="MJXp-mn" id="MJXp-Span-2173">3</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2169">i</span><span class="MJXp-mo" id="MJXp-Span-2170">=</span><span class="MJXp-mn" id="MJXp-Span-2171">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2174"><span class="MJXp-mo" id="MJXp-Span-2175" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2177">j</span><span class="MJXp-mo" id="MJXp-Span-2178">=</span><span class="MJXp-mn" id="MJXp-Span-2179">1</span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2182" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2183">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2184">3</span><span class="MJXp-mo" id="MJXp-Span-2185">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186">j</span><span class="MJXp-mo" id="MJXp-Span-2187">+</span><span class="MJXp-mn" id="MJXp-Span-2188">1</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2189"><span class="MJXp-mo" id="MJXp-Span-2190" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2195"><span class="MJXp-mn" id="MJXp-Span-2196">3</span><span class="MJXp-mo" id="MJXp-Span-2197">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198">j</span><span class="MJXp-mo" id="MJXp-Span-2199">+</span><span class="MJXp-mn" id="MJXp-Span-2200">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2192">k</span><span class="MJXp-mo" id="MJXp-Span-2193">=</span><span class="MJXp-mn" id="MJXp-Span-2194">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2203" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-263-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-263">\sum_{i=1}^{3}\prod_{j=1}^{i} \frac{1}{3-j+1}\sum_{k=1}^{3-j+1}z^k</script>. After doing the expanding, the coefficients will be the expect number(Three formula get for possiblities and sum it up we get the expects). And that since there are loops. When ever you get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2204"><span class="MJXp-msubsup" id="MJXp-Span-2205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2206" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2207" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-264-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-264">z^n</script> or higher ones you can just make them divide <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2208"><span class="MJXp-msubsup" id="MJXp-Span-2209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2210" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2211" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-265-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-265">z^n</script>. And that every polynomials you calculate will be just in n terms(for example, the formula for the second lock now turns into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2212"><span class="MJXp-mfrac" id="MJXp-Span-2213" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2214">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2215">6</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2218" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2219" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2220" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2221">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2222">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2223" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2224" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2225">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2226">3</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227">z</span><span class="MJXp-mo" id="MJXp-Span-2228" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2229" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2230">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2231">6</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2234" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2235" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2236" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2237">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2238">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2239" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2240" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2241">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2242">3</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">z</span><span class="MJXp-mo" id="MJXp-Span-2244" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2245" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2246">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2247">3</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2250" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-266-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-266">\frac{1}{6}z^2+\frac{1}{3}+\frac{1}{3}z+\frac{1}{6}z^2 = \frac{1}{3}+\frac{1}{3}z+\frac{1}{3}z^2</script> , which indicates that for the tree persons they have equal chance to open the second lock).</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1260309 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1260309 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1260309">
                <li>
<div class="comment" commentid="1260951">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1260951" commentparentid="1260309">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/bricked_" title="Specialist bricked_" class="rated-user user-cyan">bricked_</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/30/2025 16:43 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1260951" commentparentid="1260309">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/bricked_" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3287483/avatar/2c6aa4870bf5f30f.jpg">        </a>
        <div><a href="/profile/bricked_" title="Specialist bricked_" class="rated-user user-cyan">bricked_</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/30/2025 16:43 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1260951" href="?#comment-1260951" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1260309" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1260951" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3287483" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1260951">
                        <div class="moveup">
                        <div class="ttypography"><p>Ohh ty!</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1260951 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1260951 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1260951">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1264784">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1264784" commentparentid="1260309">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Ragnar21" title="Expert Ragnar21" class="rated-user user-blue">Ragnar21</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/10/2025 11:40 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1264784" commentparentid="1260309">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Ragnar21" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3323542/avatar/36cfe4f9f46ffd80.jpg">        </a>
        <div><a href="/profile/Ragnar21" title="Expert Ragnar21" class="rated-user user-blue">Ragnar21</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/10/2025 11:40 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1264784" href="?#comment-1264784" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1260309" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1264784" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3323542" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1264784">
                        <div class="moveup">
                        <div class="ttypography"><p>I did not understand how the coefficients comes out to be the expected value. Can you please explain?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1264784 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1264784 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1264784">
                <li>
<div class="comment" commentid="1264792">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1264792" commentparentid="1264784">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/10/2025 12:11 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1264792" commentparentid="1264784">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SoReMore" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4013757/avatar/2abb517cad9f5014.jpg">        </a>
        <div><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/10/2025 12:11 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1264792" href="?#comment-1264792" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1264784" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1264792" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1264792" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4013757" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1264792">
                        <div class="moveup">
                        <div class="ttypography"><p>As I explain above, the coefficients of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2251"><span class="MJXp-msubsup" id="MJXp-Span-2252"><span class="MJXp-mo" id="MJXp-Span-2253" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255">j</span><span class="MJXp-mo" id="MJXp-Span-2256">=</span><span class="MJXp-mn" id="MJXp-Span-2257">1</span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2260" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2261">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2262">l</span><span class="MJXp-mo" id="MJXp-Span-2263">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264">j</span><span class="MJXp-mo" id="MJXp-Span-2265">+</span><span class="MJXp-mn" id="MJXp-Span-2266">1</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2267"><span class="MJXp-mo" id="MJXp-Span-2268" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2274">l</span><span class="MJXp-mo" id="MJXp-Span-2275">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276">j</span><span class="MJXp-mo" id="MJXp-Span-2277">+</span><span class="MJXp-mn" id="MJXp-Span-2278">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2270">k</span><span class="MJXp-mo" id="MJXp-Span-2271">=</span><span class="MJXp-mn" id="MJXp-Span-2272">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2281" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-267-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-267">\prod_{j=1}^{i} \frac{1}{l-j+1}\sum_{k=1}^{l-j+1}z^k</script> indicates exactly after the open of the last i-th lock (this will tell who is the person that opened it), the possiblity to end at the exponent round. And, because of the linearity of expectation (which means, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2283">E</span><span class="MJXp-mo" id="MJXp-Span-2284" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2285">A</span><span class="MJXp-mo" id="MJXp-Span-2286" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2287" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2288">E</span><span class="MJXp-mo" id="MJXp-Span-2289" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2290">B</span><span class="MJXp-mo" id="MJXp-Span-2291" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2292" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2293">E</span><span class="MJXp-mo" id="MJXp-Span-2294" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2295">A</span><span class="MJXp-mo" id="MJXp-Span-2296" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2297">B</span><span class="MJXp-mo" id="MJXp-Span-2298" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-268-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-268">E(A)+E(B)=E(A+B)</script> , even if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2300">A</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-269-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-269">A</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2302">B</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-270-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-270">B</script> are dependent), the expected value is the sum, which will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2303"><span class="MJXp-msubsup" id="MJXp-Span-2304"><span class="MJXp-mo" id="MJXp-Span-2305" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2311">l</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">i</span><span class="MJXp-mo" id="MJXp-Span-2308">=</span><span class="MJXp-mn" id="MJXp-Span-2309">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2312"><span class="MJXp-mo" id="MJXp-Span-2313" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2319">i</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2315">j</span><span class="MJXp-mo" id="MJXp-Span-2316">=</span><span class="MJXp-mn" id="MJXp-Span-2317">1</span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2320" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2321">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2322">l</span><span class="MJXp-mo" id="MJXp-Span-2323">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2324">j</span><span class="MJXp-mo" id="MJXp-Span-2325">+</span><span class="MJXp-mn" id="MJXp-Span-2326">1</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2327"><span class="MJXp-mo" id="MJXp-Span-2328" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2334">l</span><span class="MJXp-mo" id="MJXp-Span-2335">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336">j</span><span class="MJXp-mo" id="MJXp-Span-2337">+</span><span class="MJXp-mn" id="MJXp-Span-2338">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2330">k</span><span class="MJXp-mo" id="MJXp-Span-2331">=</span><span class="MJXp-mn" id="MJXp-Span-2332">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2340" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2341" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-271-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-271">\sum_{i=1}^{l}\prod_{j=1}^{i} \frac{1}{l-j+1}\sum_{k=1}^{l-j+1}z^k</script> .</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1264792 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1264792 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1264792">
                <li>
<div class="comment" commentid="1264937">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1264937" commentparentid="1264792">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Ragnar21" title="Expert Ragnar21" class="rated-user user-blue">Ragnar21</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/11/2025 05:59 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1264937" commentparentid="1264792">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Ragnar21" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3323542/avatar/36cfe4f9f46ffd80.jpg">        </a>
        <div><a href="/profile/Ragnar21" title="Expert Ragnar21" class="rated-user user-blue">Ragnar21</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/11/2025 05:59 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1264937" href="?#comment-1264937" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1264792" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1264937" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3323542" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1264937">
                        <div class="moveup">
                        <div class="ttypography"><p>Got it! Thanks a lot</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1264937 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1264937 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1264937">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1331256">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1331256" commentparentid="1259861">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/AkShukla" title="Expert AkShukla" class="rated-user user-blue">AkShukla</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Dec/08/2025 10:14 UTC">6 days ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1331256" commentparentid="1259861">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/AkShukla" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4052663/avatar/9926d57ee087964b.jpg">        </a>
        <div><a href="/profile/AkShukla" title="Expert AkShukla" class="rated-user user-blue">AkShukla</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Dec/08/2025 10:14 UTC">6 days ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1331256" href="?#comment-1331256" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259861" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1331256" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4052663" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>



</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1331256">
                        <div class="moveup">
                        <div class="ttypography"><p>Apologies for the necroposting</p><p>But can you please explain why its always optimal to keep on opening the same lock after choosing a lock?</p><p>Suppose we have </p><p>L1 L2 L3 L4 L5 K1 K2 K3 K4 K5 </p><p>after we choose L5K4 pair and find it to be not valid, probability of L5K3 being valid is 1/4 but probability of L3K4 is also 1/4 but and does not use the same lock again!</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1331256 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1331256 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1331256">
                <li>
<div class="comment" commentid="1331584">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1331584" commentparentid="1331256">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Dec/10/2025 01:01 UTC">5 days ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1331584" commentparentid="1331256">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SoReMore" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4013757/avatar/2abb517cad9f5014.jpg">        </a>
        <div><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Dec/10/2025 01:01 UTC">5 days ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1331584" href="?#comment-1331584" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1331256" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1331584" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4013757" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>

<style data-nocturne="true" type="text/css">
.ComplaintFrame {
  display: inline-block;
  position: absolute;
  top: 0;
  right: -1.4em;
}
.ComplaintFrame a {
  text-decoration: none;
  color: #ff8c00;
  opacity: 0.5;
}
.ComplaintFrame a:hover {
  opacity: 1;
}
._ComplaintFrame_popup p,
._ComplaintFrame_popup button {
  margin-top: 1rem;
}
._ComplaintFrame_popup input[type=submit] {
  padding: 0.25rem 2rem;
}
._ComplaintFrame_popup ul {
  margin-top: 1em !important;
  margin-bottom: 1em !important;
}
</style>


<script data-nocturne="true"> $(function () {
    $(".ComplaintFrame a").click(function () {
        const $complaintFrame = $(this).closest(".ComplaintFrame");
        const targetId = $complaintFrame.attr("data-targetId");
        const targetClass = $complaintFrame.attr("data-targetClass");

        Codeforces.facebox("._ComplaintFrame_popup", "//codeforces.com/codeforces.org/s/52448");

        $.post("/data/complaint", {
            action: "findComplaintReasons",
            targetClass: $complaintFrame.attr("data-targetClass"),
            targetId: $complaintFrame.attr("data-targetId")
        }, function (response) {
            if (response.success === "true") {
                const complaintReasons = response.complaintReasons;
                const complaint = response.complaint;

                const $popup = $("#facebox ._ComplaintFrame_popup");
                for (const complaintReason of complaintReasons) {
                    let $li = $("#facebox ._ComplaintFrame_complaintReasonItemProto li").clone();
                    $li.find("input[name=complaintReasonId]").attr("value", complaintReason.id);
                    $li.find("span")
                        .html(getLocalizedName(complaintReason)
                            + " <i class=\"icon-question-sign clickable-title\" title=\""
                            + getLocalizedDescription(complaintReason)
                            + "\"></i>")
                        .attr("title", getLocalizedDescription(complaintReason));
                    $li.show();
                    $li.appendTo($popup.find("ul"));
                    if (complaint && complaint.complaintReasonId === complaintReason.id) {
                        $li.find("input[name=complaintReasonId]").attr("checked", "checked");
                    }
                    $li.find(".clickable-title").click(function () {
                        alert(getLocalizedDescription(complaintReason));
                        return false;
                    }).css("position", "relative").css("bottom", "1px").css("font-size", "12px");
                }

                if (complaint) {
                    let $li = $("#facebox ._ComplaintFrame_complaintReasonItemProto li").clone();
                    $li.find("input[name=complaintReasonId]").attr("value", 0);
                    $li.find("span").html("Delete complaint");
                    $li.show();
                    $li.appendTo($popup.find("ul"));
                }

                $popup.find("._ComplaintFrame_submitForm").submit(function () {
                    const complaintReasonId = $popup.find("input[name=complaintReasonId]:checked").val();
                    if (complaintReasonId === undefined) {
                        alert("Please select complaint reason");
                        return false;
                    }

                    $.post("/data/complaint", {
                        action: "newComplaint",
                        targetClass: targetClass,
                        targetId: targetId,
                        complaintReasonId: complaintReasonId
                    }, function (response) {
                        if (response.success === "true") {
                            Codeforces.showMessage("Complaint has been created");
                            $.facebox.close();
                        }
                    }, "json");

                    return false;
                });
            }
        }, "json");

        return false;
    });
}); </script>

</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1331584">
                        <div class="moveup">
                        <div class="ttypography"><p>I mean, they are in the same position. If you take the same key, you can regard key as lock and vice versa, which doesn't affect the answer. So let's just say lock for convenient.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1331584 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1331584 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1331584">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1259800">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1259800" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/ChihChi21" title="Candidate Master ChihChi21" class="rated-user user-violet">ChihChi21</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 12:35 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">3</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1259800" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/ChihChi21" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2055117/avatar/9efeb6e421d8a16.jpg">        </a>
        <div><a href="/profile/ChihChi21" title="Candidate Master ChihChi21" class="rated-user user-violet">ChihChi21</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 12:35 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1259800" href="?#comment-1259800" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1259800" class="CommentVoteFrame" myvotedirection="0" data-commentrating="8" data-commentuserid="2055117" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1259800">
                        <div class="moveup">
                        <div class="ttypography"><p>In div2 F, why should the second player apply a random strategy?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1259800 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1259800 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1259800">
                <li>
<div class="comment" commentid="1259997">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1259997" commentparentid="1259800">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 01:44 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1259997" commentparentid="1259800">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SoReMore" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4013757/avatar/2abb517cad9f5014.jpg">        </a>
        <div><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 01:44 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1259997" href="?#comment-1259997" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259800" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1259997" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1259997" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4013757" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1259997">
                        <div class="moveup">
                        <div class="ttypography"><p>I agree with you. I think it can be discussed by 2 cases: </p><p><strong>The chose don’t effect later persons:</strong> then for sure you can just choose the keys or just choose the locks for calculation.</p><p><strong>The chose effect later persons:</strong> it will be reasonable to randomly select for the objects remained when they are the same for the person choosing now so you do need to randomize the chose. However turns forms a loop, so until after the chose it is not possible for this person to choose, it should be randomized, for the other situations, since the chose will effect later persons including himself, he will choose the one(keys or the locks) which provides higher expectation.</p><p>Thus, I think it is not reasonable to randomize the chose all the time.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1259997 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1259997 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1259997">
                <li>
<div class="comment" commentid="1259999">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1259999" commentparentid="1259997">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/ChihChi21" title="Candidate Master ChihChi21" class="rated-user user-violet">ChihChi21</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 02:17 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1259999" commentparentid="1259997">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/ChihChi21" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2055117/avatar/9efeb6e421d8a16.jpg">        </a>
        <div><a href="/profile/ChihChi21" title="Candidate Master ChihChi21" class="rated-user user-violet">ChihChi21</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 02:17 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1259999" href="?#comment-1259999" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259997" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1259999" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2055117" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1259999">
                        <div class="moveup">
                        <div class="ttypography"><p>In the problem, it said: _"To open the toy box as soon as possible, every member chooses the key and the lock that maximize the probability of being a successful match. If there are multiple such pairs, a member will randomly choose one of such pairs with equal probability. "</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1259999 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1259999 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1259999">
                <li>
<div class="comment" commentid="1260004">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1260004" commentparentid="1259999">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 02:38 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1260004" commentparentid="1259999">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SoReMore" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4013757/avatar/2abb517cad9f5014.jpg">        </a>
        <div><a href="/profile/SoReMore" title="Master SoReMore" class="rated-user user-orange">SoReMore</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 02:38 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1260004" href="?#comment-1260004" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259999" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1260004" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4013757" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1260004">
                        <div class="moveup">
                        <div class="ttypography"><p>Then I can tell you why it will be randomized.It costs equal expected time whether to choose the keys or the locks ( just think that there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343">l</span><span class="MJXp-mo" id="MJXp-Span-2344" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-272-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-272">l+k</script> locks also ) so it will be the same possibility that to choose any object remaining ( which is ,<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347">l</span><span class="MJXp-mo" id="MJXp-Span-2348" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2349">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-273-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-273">l-1</script> locks and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2351">l</span><span class="MJXp-mo" id="MJXp-Span-2352" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353">k</span><span class="MJXp-mo" id="MJXp-Span-2354" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2355">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-274-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-274">l+k-1</script> keys ) and trying to pair up it with the opposite one which is tried already.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1260004 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1260004 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1260004">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1259882">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1259882" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/ShirayukiNoa" title="Expert ShirayukiNoa" class="rated-user user-blue">ShirayukiNoa</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 16:34 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1259882" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/ShirayukiNoa" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3348389/avatar/7054527d6a15e213.jpg">        </a>
        <div><a href="/profile/ShirayukiNoa" title="Expert ShirayukiNoa" class="rated-user user-blue">ShirayukiNoa</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/27/2025 16:34 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1259882" href="?#comment-1259882" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1259882" class="CommentVoteFrame" myvotedirection="0" data-commentrating="6" data-commentuserid="3348389" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1259882">
                        <div class="moveup">
                        <div class="ttypography"><p>I used priority_queue like Dijkstra to solve Div1B.</p><p><a href="https://codeforces.com/contest/2089/submission/312036355">B1 Submission</a></p><p><a href="https://codeforces.com/contest/2089/submission/312039630">B2 Submission</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1259882 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1259882 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1259882">
                <li>
<div class="comment" commentid="1260906">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1260906" commentparentid="1259882">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/BiaxialRay_" title="Master BiaxialRay_" class="rated-user user-orange">BiaxialRay_</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/30/2025 13:11 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1260906" commentparentid="1259882">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/BiaxialRay_" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4248444/avatar/d89fb869d394b134.jpg">        </a>
        <div><a href="/profile/BiaxialRay_" title="Master BiaxialRay_" class="rated-user user-orange">BiaxialRay_</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/30/2025 13:11 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1260906" href="?#comment-1260906" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259882" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1260906" class="CommentVoteFrame" myvotedirection="0" data-commentrating="8" data-commentuserid="4248444" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1260906">
                        <div class="moveup">
                        <div class="ttypography"><p>Brilliant naming method!</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1260906 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1260906 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1260906">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1274160">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1274160" commentparentid="1259882">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SummitClimbingDevil" title="Expert SummitClimbingDevil" class="rated-user user-blue">SummitClimbingDevil</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="May/11/2025 02:27 UTC">7 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1274160" commentparentid="1259882">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SummitClimbingDevil" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4020963/avatar/7c16c3ab65908d8f.jpg">        </a>
        <div><a href="/profile/SummitClimbingDevil" title="Expert SummitClimbingDevil" class="rated-user user-blue">SummitClimbingDevil</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="May/11/2025 02:27 UTC">7 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1274160" href="?#comment-1274160" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1259882" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1274160" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1274160" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4020963" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1274160">
                        <div class="moveup">
                        <div class="ttypography"><p>How do you come up with such intuitive solutions?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1274160 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1274160 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1274160">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1260103">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1260103" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Muhammadali_2009" title="Expert Muhammadali_2009" class="rated-user user-blue">Muhammadali_2009</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 12:52 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1260103" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Muhammadali_2009" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3700724/avatar/873d5275cec01099.jpg">        </a>
        <div><a href="/profile/Muhammadali_2009" title="Expert Muhammadali_2009" class="rated-user user-blue">Muhammadali_2009</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 12:52 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1260103" href="?#comment-1260103" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1260103" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3700724" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1260103">
                        <div class="moveup">
                        <div class="ttypography"><p>The solution for problem C does not look good, ig. Can you write a more beautiful and clearer code?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1260103 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1260103 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1260103">
        </ul>
    </div>
</div>

<div class="comment" commentid="1260115">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1260115" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/stillgrowing" title="Expert stillgrowing" class="rated-user user-blue">stillgrowing</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 13:42 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1260115" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/stillgrowing" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/stillgrowing" title="Expert stillgrowing" class="rated-user user-blue">stillgrowing</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 13:42 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1260115" href="?#comment-1260115" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1260115" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4066937" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1260115">
                        <div class="moveup">
                        <div class="ttypography"><p>Can someone explain canteen(hard version)? I did not understand the editorial. </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1260115 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1260115 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1260115">
                <li>
<div class="comment" commentid="1260214">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1260214" commentparentid="1260115">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/osvarp" title="Master osvarp" class="rated-user user-orange">osvarp</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 20:08 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1260214" commentparentid="1260115">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/osvarp" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3500633/avatar/262102ef827fb42.jpg">        </a>
        <div><a href="/profile/osvarp" title="Master osvarp" class="rated-user user-orange">osvarp</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 20:08 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1260214" href="?#comment-1260214" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1260115" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1260214" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3500633" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1260214">
                        <div class="moveup">
                        <div class="ttypography"><p>What I did was fixating the amount of rounds (h) by binary search. Then for a specific h, I simulated how the rounds would affect <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2356"><span class="MJXp-mi" id="MJXp-Span-2357">Σ</span><span class="MJXp-msubsup" id="MJXp-Span-2358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2360" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-275-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-275">\Sigma a_i</script> and then said it was posible to do in 'h' rounds if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2362">k</span><span class="MJXp-mo" id="MJXp-Span-2363" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi" id="MJXp-Span-2364">Σ</span><span class="MJXp-msubsup" id="MJXp-Span-2365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2367" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-276-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-276">k\geq\Sigma a_i</script>. To see how <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2368"><span class="MJXp-mi" id="MJXp-Span-2369">Σ</span><span class="MJXp-msubsup" id="MJXp-Span-2370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2372" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-277-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-277">\Sigma a_i</script> would change I used a stack to access the closest non-zero <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2373"><span class="MJXp-msubsup" id="MJXp-Span-2374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2376" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-278-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-278">a_i</script> and, if it was in a valid range (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2378">i</span><span class="MJXp-mo" id="MJXp-Span-2379" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2380">j</span><span class="MJXp-mo" id="MJXp-Span-2381" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2382">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-279-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-279">i-j<h</script>), simulate how the (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2384">j</span><span class="MJXp-mo" id="MJXp-Span-2385" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2386">i</span><span class="MJXp-mo" id="MJXp-Span-2387" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2388">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-280-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-280">j-i+1</script>)th round would change both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2389"><span class="MJXp-msubsup" id="MJXp-Span-2390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2391" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2392" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-281-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-281">a_i</script> and the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2393"><span class="MJXp-msubsup" id="MJXp-Span-2394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2395" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2396" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-282-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-282">b_j</script>.</p><p>My submission is <a href="/contest/2089/submission/312846510" title="Submission 312846510 by osvarp">312846510</a>.</p><p>Hope this is of help -_-</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1260214 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1260214 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1260214">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1260211">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1260211" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SuperMo" title="Pupil SuperMo" class="rated-user user-green">SuperMo</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 19:44 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1260211" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SuperMo" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/SuperMo" title="Pupil SuperMo" class="rated-user user-green">SuperMo</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 19:44 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1260211" href="?#comment-1260211" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1260211" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2489275" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1260211">
                        <div class="moveup">
                        <div class="ttypography"><p>in problem C many people just figured out that the bound for y axis is around sqrt(n) can some one tell how did they estimate this ? </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1260211 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1260211 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1260211">
                <li>
<div class="comment" commentid="1260219">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1260219" commentparentid="1260211">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SuperMo" title="Pupil SuperMo" class="rated-user user-green">SuperMo</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 20:17 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1260219" commentparentid="1260211">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SuperMo" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/SuperMo" title="Pupil SuperMo" class="rated-user user-green">SuperMo</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/28/2025 20:17 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1260219" href="?#comment-1260219" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1260211" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1260219" revisioncount="4" revision="4">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">4</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1260219" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2489275" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1260219">
                        <div class="moveup">
                        <div class="ttypography"><p>.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1260219 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1260219 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1260219">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1261041">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1261041" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/milind0110" title="Expert milind0110" class="rated-user user-blue">milind0110</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/30/2025 20:22 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1261041" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/milind0110" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1540986/avatar/6a1e34f69fa7a089.jpg">        </a>
        <div><a href="/profile/milind0110" title="Expert milind0110" class="rated-user user-blue">milind0110</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/30/2025 20:22 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1261041" href="?#comment-1261041" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1261041" revisioncount="7" revision="7">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">7</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1261041" class="CommentVoteFrame" myvotedirection="0" data-commentrating="15" data-commentuserid="1540986" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+15</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1261041">
                        <div class="moveup">
                        <div class="ttypography"><p>Really enjoyed solving problem 2089B1 and B2. Here is my <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398">O</span><span class="MJXp-mo" id="MJXp-Span-2399" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2400">n</span><span class="MJXp-mo" id="MJXp-Span-2401" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-283-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-283">O(n)</script> solution for B2.</p><p>My solution also considers a parenthesis sequence with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2403">a</span><span class="MJXp-mo" id="MJXp-Span-2404" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2405">i</span><span class="MJXp-mo" id="MJXp-Span-2406" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-284-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-284">a[i]</script> being the number of opening bracket sequences and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408">b</span><span class="MJXp-mo" id="MJXp-Span-2409" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2410">i</span><span class="MJXp-mo" id="MJXp-Span-2411" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-285-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-285">b[i]</script> being the number of closing bracket sequences and doing a binary search to check if we can make all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413">a</span><span class="MJXp-mo" id="MJXp-Span-2414" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415">i</span><span class="MJXp-mo" id="MJXp-Span-2416" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-286-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-286">a[i]</script> zero with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2417"><span class="MJXp-mo" id="MJXp-Span-2418" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2419">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2420">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-287-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-287"><= mx</script> cyclic shifts. If some <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2421"><span class="MJXp-mo" id="MJXp-Span-2422" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2423">a</span><span class="MJXp-mo" id="MJXp-Span-2424" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2425">j</span><span class="MJXp-mo" id="MJXp-Span-2426" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2428">b</span><span class="MJXp-mo" id="MJXp-Span-2429" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430">i</span><span class="MJXp-mo" id="MJXp-Span-2431" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2432" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-288-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-288">(a[j],b[i])</script> is taking more than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2434">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-289-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-289">mx</script> cycle shifts, we would need to reduce the current value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2437">a</span><span class="MJXp-mo" id="MJXp-Span-2438" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2439">i</span><span class="MJXp-mo" id="MJXp-Span-2440" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-290-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-290">a[i]</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2441"><span class="MJXp-mn" id="MJXp-Span-2442">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-291-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-291">0</script> as we don't want to do this cycle shift. <a href="/contest/2090/submission/313175241" title="Submission 313175241 by milind0110">313175241</a></p><p>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2444">O</span><span class="MJXp-mo" id="MJXp-Span-2445" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2446">n</span><span class="MJXp-mo" id="MJXp-Span-2447" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-292-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-292">O(n)</script> solution we can just store for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2448"><span class="MJXp-mo" id="MJXp-Span-2449" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2450">a</span><span class="MJXp-mo" id="MJXp-Span-2451" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452">j</span><span class="MJXp-mo" id="MJXp-Span-2453" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2454" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2455">b</span><span class="MJXp-mo" id="MJXp-Span-2456" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2457">i</span><span class="MJXp-mo" id="MJXp-Span-2458" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2459" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-293-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-293">(a[j],b[i])</script> that is being performed what is the reduction we need to perform so that this cyclic shift is not required which is just <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2461">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2463">n</span><span class="MJXp-mo" id="MJXp-Span-2464" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2465">a</span><span class="MJXp-mo" id="MJXp-Span-2466" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2467">j</span><span class="MJXp-mo" id="MJXp-Span-2468" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2469" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2470">b</span><span class="MJXp-mo" id="MJXp-Span-2471" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472">i</span><span class="MJXp-mo" id="MJXp-Span-2473" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2474" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-294-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-294">min(a[j],b[i])</script>. Lastly we can iterate in reverse and take the prefix sums and check if we have sufficient value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-295-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-295">k</script> in order to not perform the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2479">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2480">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-296-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-296">ith</script> cyclic shift. <a href="/contest/2090/submission/313175736" title="Submission 313175736 by milind0110">313175736</a></p><p>Apologies for my bad English. Let me know if some part is not clear.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1261041 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1261041 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1261041">
        </ul>
    </div>
</div>

<div class="comment" commentid="1261153">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1261153" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/paracet_anmol" title="Specialist paracet_anmol" class="rated-user user-cyan">paracet_anmol</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/31/2025 07:29 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1261153" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/paracet_anmol" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/paracet_anmol" title="Specialist paracet_anmol" class="rated-user user-cyan">paracet_anmol</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/31/2025 07:29 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1261153" href="?#comment-1261153" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1261153" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4301065" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1261153">
                        <div class="moveup">
                        <div class="ttypography"><p>great contest</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1261153 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1261153 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1261153">
        </ul>
    </div>
</div>

<div class="comment" commentid="1261800">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1261800" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Hajmola" title="Expert Hajmola" class="rated-user user-blue">Hajmola</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/02/2025 09:07 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1261800" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Hajmola" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2832348/avatar/ad9babcb1f270d27.jpg">        </a>
        <div><a href="/profile/Hajmola" title="Expert Hajmola" class="rated-user user-blue">Hajmola</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/02/2025 09:07 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1261800" href="?#comment-1261800" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1261800" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1261800" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2832348" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1261800">
                        <div class="moveup">
                        <div class="ttypography"><p>solution for d (simple permutation): <a href="https://youtu.be/LthXrsjfilI?si=csvXnGlNQkC2MzO5">https://youtu.be/LthXrsjfilI?si=csvXnGlNQkC2MzO5</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1261800 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1261800 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1261800">
        </ul>
    </div>
</div>

<div class="comment" commentid="1262413">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1262413" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/duanzx" title="Pupil duanzx" class="rated-user user-green">duanzx</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/04/2025 12:01 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1262413" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/duanzx" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/duanzx" title="Pupil duanzx" class="rated-user user-green">duanzx</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/04/2025 12:01 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1262413" href="?#comment-1262413" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1262413" class="CommentVoteFrame" myvotedirection="0" data-commentrating="3" data-commentuserid="4050149" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1262413">
                        <div class="moveup">
                        <div class="ttypography"><p>In the editorial of 2089B2,I dont understand why "If minj=i+1i+xcj&gt;ci , then we should apply minj=i+1i+xcj−ci  changes to ai+1".Can someone explain it for me?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1262413 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1262413 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1262413">
                <li>
<div class="comment" commentid="1284429">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1284429" commentparentid="1262413">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/codexistent" title="Expert codexistent" class="rated-user user-blue">codexistent</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Jun/16/2025 02:43 UTC">6 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1284429" commentparentid="1262413">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/codexistent" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1995211/avatar/985c85f590d95fd7.jpg">        </a>
        <div><a href="/profile/codexistent" title="Expert codexistent" class="rated-user user-blue">codexistent</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Jun/16/2025 02:43 UTC">6 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1284429" href="?#comment-1284429" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1262413" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1284429" revisioncount="7" revision="7">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">7</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1284429" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="1995211" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1284429">
                        <div class="moveup">
                        <div class="ttypography"><p>To answer your question/ explain more thoroughly on B2's solution in general:</p><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2482">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-297-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-297">i</script>, we want to look at the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2483"><span class="MJXp-msubsup" id="MJXp-Span-2484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2486" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-298-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-298">c_j</script> values for the next <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2488">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-299-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-299">x</script> elements(that is, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2490">j</span><span class="MJXp-mo" id="MJXp-Span-2491" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2492">i</span><span class="MJXp-mo" id="MJXp-Span-2493" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2494">1</span><span class="MJXp-mo" id="MJXp-Span-2495" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2496">i</span><span class="MJXp-mo" id="MJXp-Span-2497" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2498">2</span><span class="MJXp-mo" id="MJXp-Span-2499" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2500" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2501" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2502" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2503">i</span><span class="MJXp-mo" id="MJXp-Span-2504" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2505">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-300-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-300">j = i + 1, i + 2, ... i + x</script>) in front of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-301-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-301">i</script>. </p><p>If there is no <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2508"><span class="MJXp-msubsup" id="MJXp-Span-2509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2510" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2511" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-302-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-302">c_j</script> with value smaller or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2512"><span class="MJXp-msubsup" id="MJXp-Span-2513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2515" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-303-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-303">c_i</script>(which we will call the <em>qualifying condition</em> for the left brackets/<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2516"><span class="MJXp-msubsup" id="MJXp-Span-2517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2518" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2519" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-304-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-304">a_i</script> values at position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2521">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-305-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-305">i</script> to have paired with all necessary right brackets/<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2523">b</span><span class="MJXp-mo" id="MJXp-Span-2524" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2525">i</span><span class="MJXp-mo" id="MJXp-Span-2526" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-306-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-306">b[i]</script> values by the time they are at position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2528">j</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-307-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-307">j</script>), these <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2529"><span class="MJXp-msubsup" id="MJXp-Span-2530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2531" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2532" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-308-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-308">c_j</script> values must all be greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2533"><span class="MJXp-msubsup" id="MJXp-Span-2534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2535" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2536" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-309-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-309">c_i</script>. To meet this <em>qualifying condition</em> we 'edit' some elements in the array to make it possible. Now we just have to determine the best possible edit. </p><p>We cannot decrement <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2537"><span class="MJXp-msubsup" id="MJXp-Span-2538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2540" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-2541" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2542" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2543" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-2544"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2545" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2546" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-310-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-310">a_0...a_i</script>, since this would change both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2547"><span class="MJXp-msubsup" id="MJXp-Span-2548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2550" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-311-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-311">c_i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2551"><span class="MJXp-msubsup" id="MJXp-Span-2552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2553" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2554" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-312-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-312">c_j</script> such that their relative value stays the same. So we must decrement some <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556">a</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-313-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-313">a</script> element in the range <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2557"><span class="MJXp-msubsup" id="MJXp-Span-2558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2559" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2560" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2561">i</span><span class="MJXp-mo" id="MJXp-Span-2562">+</span><span class="MJXp-mn" id="MJXp-Span-2563">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2564" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2565" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2566" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-2567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2568" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2569" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2570">n</span><span class="MJXp-mo" id="MJXp-Span-2571">−</span><span class="MJXp-mn" id="MJXp-Span-2572">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-314-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-314">a_{i + 1}...a_{n - 1}</script>. Remember we want to reach the <em>qualifying condition</em> using the minimum moves, yet make these moves as optimal as possible. Note it is optimal to decrement element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2573"><span class="MJXp-msubsup" id="MJXp-Span-2574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2575" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2576" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2577">i</span><span class="MJXp-mo" id="MJXp-Span-2578">+</span><span class="MJXp-mn" id="MJXp-Span-2579">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-315-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-315">a_{i + 1}</script> since this would decrease the values for a maximum number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2581">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-316-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-316">c</script> elements(that is, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2582"><span class="MJXp-msubsup" id="MJXp-Span-2583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2584" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2585" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2586">i</span><span class="MJXp-mo" id="MJXp-Span-2587">+</span><span class="MJXp-mn" id="MJXp-Span-2588">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2589" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2590" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2591" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-2592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2593" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2594" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595">n</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-317-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-317">c_{i + 1}...c_{n}</script>), making it more likely for the next(decreasing) <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2597">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-318-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-318">i</script> indicies to find a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2598"><span class="MJXp-msubsup" id="MJXp-Span-2599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2600" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2601" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-319-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-319">c_j</script> above it that is smaller.</p><p>Hope this clarifies!</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1284429 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1284429 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1284429">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1262599">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1262599" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/RandomKami" title="Unrated, RandomKami" class="rated-user user-black">RandomKami</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/05/2025 00:42 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1262599" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/RandomKami" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/RandomKami" title="Unrated, RandomKami" class="rated-user user-black">RandomKami</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/05/2025 00:42 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1262599" href="?#comment-1262599" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1262599" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1262599" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2219867" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1262599">
                        <div class="moveup">
                        <div class="ttypography"><p>Does O(L^2*K) pass for Div1 C2? I figured out the O(LNK) solution but it's a little more annoying to code than just running the O(N) loop as an O(L) loop.</p><p>My O(L^2*K) solution is not very optimized but TLEed: <a href="https://codeforces.com/contest/2089/submission/313984076">https://codeforces.com/contest/2089/submission/313984076</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1262599 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1262599 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1262599">
        </ul>
    </div>
</div>

<div class="comment" commentid="1265506">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1265506" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/chiranjeetdas73" title="Newbie chiranjeetdas73" class="rated-user user-gray">chiranjeetdas73</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/13/2025 09:21 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1265506" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/chiranjeetdas73" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/chiranjeetdas73" title="Newbie chiranjeetdas73" class="rated-user user-gray">chiranjeetdas73</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/13/2025 09:21 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1265506" href="?#comment-1265506" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1265506" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3303600" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1265506">
                        <div class="moveup">
                        <div class="ttypography"><p>Treasure Hunt needs a correction in the question instead of a.5 it should be a .And it test case 2 at the third token for the accepted answer gives YES but the expected output according to the test case is NO . I don't know how magically it giving an output of NO for the program which gives YES for the same input and accepting it </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1265506 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1265506 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1265506">
                <li>
<div class="comment" commentid="1268836">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1268836" commentparentid="1265506">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/d1amondzz" title="Specialist d1amondzz" class="rated-user user-cyan">d1amondzz</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/23/2025 15:55 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1268836" commentparentid="1265506">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/d1amondzz" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/d1amondzz" title="Specialist d1amondzz" class="rated-user user-cyan">d1amondzz</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/23/2025 15:55 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1268836" href="?#comment-1268836" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1265506" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1268836" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2793004" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1268836">
                        <div class="moveup">
                        <div class="ttypography"><p>If it was a, the answer would be "NO" in the first sample, because the first guy reaches depth 4 earlier. No clue what you're saying about testcase 2, your solution outputs YES, the expected answer is NO, so you have wrong answer on test 2.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1268836 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1268836 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1268836">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1266226">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1266226" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/razamimiranto" title="Unrated, razamimiranto" class="rated-user user-black">razamimiranto</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/15/2025 12:29 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1266226" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/razamimiranto" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4356970/avatar/fd4a20ef6992950b.jpg">        </a>
        <div><a href="/profile/razamimiranto" title="Unrated, razamimiranto" class="rated-user user-black">razamimiranto</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/15/2025 12:29 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1266226" href="?#comment-1266226" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1266226" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4356970" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1266226">
                        <div class="moveup">
                        <div class="ttypography"><p>i don't really understand the solution code in "dining hall" problem </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1266226 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1266226 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1266226">
        </ul>
    </div>
</div>

<div class="comment" commentid="1274892">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1274892" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/sujalagrawal47" title="Pupil sujalagrawal47" class="rated-user user-green">sujalagrawal47</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="May/13/2025 14:57 UTC">7 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1274892" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/sujalagrawal47" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/sujalagrawal47" title="Pupil sujalagrawal47" class="rated-user user-green">sujalagrawal47</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="May/13/2025 14:57 UTC">7 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1274892" href="?#comment-1274892" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1274892" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4827501" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1274892">
                        <div class="moveup">
                        <div class="ttypography"><p><a href="https://codeforces.com/contest/2090/submission/319528851">My Submission</a> What is wrong in this code?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1274892 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1274892 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1274892">
        </ul>
    </div>
</div>

<div class="comment" commentid="1296119">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1296119" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Faroff" title="Newbie Faroff" class="rated-user user-gray">Faroff</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Jul/21/2025 06:59 UTC">5 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1296119" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Faroff" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4259791/avatar/e98841e77a8edc87.jpg">        </a>
        <div><a href="/profile/Faroff" title="Newbie Faroff" class="rated-user user-gray">Faroff</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Jul/21/2025 06:59 UTC">5 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1296119" href="?#comment-1296119" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1296119" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4259791" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1296119">
                        <div class="moveup">
                        <div class="ttypography"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 </span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> vector</span><span class="pun">&lt;</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> vec</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> vector</span><span class="str">&lt;string&gt;</span><span class="pln"> str</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pub push_back 
</span><span class="com">#define</span><span class="pln"> aa cout</span><span class="pun">&lt;&lt;</span><span class="str">'yes'</span><span class="pln"> 
</span><span class="com">#define</span><span class="pln"> bb cout</span><span class="pun">&lt;&lt;</span><span class="str">'no'</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">;</span><span class="pln">
        cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">&gt;&gt;</span><span class="pln">m</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">m</span><span class="pun">];</span><span class="pln">
        
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
                </span><span class="kwd">string</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
                cin</span><span class="pun">&gt;&gt;</span><span class="pln">s</span><span class="pun">;</span><span class="pln">
                </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">m</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++){</span><span class="pln">
                        g</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]=</span><span class="pln">s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]-</span><span class="str">'0'</span><span class="pun">;</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">

        </span><span class="pun">}</span><span class="pln">
        

 
</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">n</span><span class="pun">!=</span><span class="lit">1</span><span class="pun">&amp;&amp;</span><span class="pln">m</span><span class="pun">!=</span><span class="lit">1</span><span class="pun">){</span><span class="pln">

        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">x</span><span class="pun">++){</span><span class="pln">
                </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">y</span><span class="pun">&lt;</span><span class="pln">m</span><span class="pun">;</span><span class="pln">y</span><span class="pun">++){</span><span class="pln">
                        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">g</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">y</span><span class="pun">]==</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
                                </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">g</span><span class="pun">[</span><span class="pln">x</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">y</span><span class="pun">]!=</span><span class="lit">1</span><span class="pun">&amp;&amp;</span><span class="pln">g</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">y</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]!=</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
                                        cout</span><span class="pun">&lt;&lt;</span><span class="str">"no"</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
                                        </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">;</span><span class="pln">
                                </span><span class="pun">}</span><span class="pln">

                        </span><span class="pun">}</span><span class="pln">
                         

                </span><span class="pun">}</span><span class="pln">

        </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

 

cout</span><span class="pun">&lt;&lt;</span><span class="str">"yes"</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">;</span><span class="pln">

</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
cin</span><span class="pun">&gt;&gt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--){</span><span class="pln">
solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>guys can someone explain where is my test getting failed </p><p>and i am not able to access the test case where my code is getting failed if anyones knows how to know it can tell </p><p>thx</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1296119 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1296119 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1296119">
        </ul>
    </div>
</div>

<div class="comment" commentid="1309872">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1309872" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/MmusoM" title="Candidate Master MmusoM" class="rated-user user-violet">MmusoM</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/16/2025 17:36 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1309872" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/MmusoM" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/MmusoM" title="Candidate Master MmusoM" class="rated-user user-violet">MmusoM</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/16/2025 17:36 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1309872" href="?#comment-1309872" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1309872" class="CommentVoteFrame" myvotedirection="0" data-commentrating="1" data-commentuserid="1613896" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1309872">
                        <div class="moveup">
                        <div class="ttypography"><p>I think tests in B1/E1 are not enough to check it for tl, because my <a href="https://codeforces.com/contest/2089/submission/338675056">solution</a> works O(n*n), I even have a test for it but somehow it passes. Would you check it, maybe I understood something wrong. Thank you in advance)</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1309872 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1309872 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1309872">
        </ul>
    </div>
</div>

<div class="comment" commentid="1323489">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1323489" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Leonid78" title="Newbie Leonid78" class="rated-user user-gray">Leonid78</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/05/2025 20:29 UTC">6 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1323489" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Leonid78" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3514085/avatar/ef96cbb33df1ea89.jpg">        </a>
        <div><a href="/profile/Leonid78" title="Newbie Leonid78" class="rated-user user-gray">Leonid78</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/05/2025 20:29 UTC">6 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1323489" href="?#comment-1323489" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1323489" revisioncount="3" revision="3">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">3</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1323489" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3514085" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1323489">
                        <div class="moveup">
                        <div class="ttypography"><p>I solved div2C using priority queue. Here's my code: <a href="/contest/2090/submission/347603855" title="Submission 347603855 by Leonid78">347603855</a>. I consider it to be O(n) time, but it uses a lot of memory, how could i prevent that?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1323489 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1323489 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1323489">
        </ul>
    </div>
</div>
        <br>

<div id="editBox-155645" style="width:50em;display:none;">
    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
    <div style="width: 1px">&nbsp;</div>
    <div class="commentLocale" style="position: relative; top: 0.5em;left:4px;display: none;">
        <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
        <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
    </div>
    <textarea data-drafts-id="CommentReplyFrame" class="wysiwyg" name="editContent" rows="20" style="width:99%;"></textarea>
    <div class="error error__content"></div>
    <div style="text-align:center;">
        <input type="button" name="preview" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Preview">
        <input type="button" name="save" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Save">
    </div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {

var firstPreview155645 = true;
var lastPreviewContent155645 = '';

if (!window.moveCommentRevision) {
    moveCommentRevision = function(e, dir) {
        var p = e.parent();
        var revisionCount = parseInt(p.attr("revisionCount"));
        var revision = parseInt(p.attr("revision"));
        var next = revision + dir;
        var commentId = p.attr("commentId");
        if (next >= 1 && next <= revisionCount) {
            $.post(
                "/data/comment-data",
                {action: "revision", commentId: commentId, revision: next},
                function(json) {
                    if (json.success == "true") {
                        var parentDiv = e;

                        while (parentDiv !== null && (parentDiv[0].nodeName.toLowerCase() !== "td" || !parentDiv.hasClass("right"))) {
                            parentDiv = parentDiv.parent();
                        }

                        if (parentDiv === null) {
                            return;
                        }

                        parentDiv.find("div.comment-content-" + commentId + " .moveup").html(json.content);
                        Codeforces.setupSpoilers(parentDiv.find("div.comment-content-" + commentId + " .moveup"));
                        p.attr("revision", next);
                        p.find("span.revision").text(next);
                        if (next == 1) {
                            p.find("a.leftRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.leftRevision").css("visibility", "visible");
                        }
                        if (next == revisionCount) {
                            p.find("a.rightRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.rightRevision").css("visibility", "visible");
                        }

                        window.updateTypography();
                        MathJax.Hub.Typeset();
                    } else {
                        alert(e.error);
                    }
                },
                "json"
            );
        }
    };
}

$("div[commentableId=155645] a.leftRevision").click(function () {
    window.moveCommentRevision($(this), -1);
    return false;
});

$("div[commentableId=155645] a.rightRevision").click(function () {
    window.moveCommentRevision($(this), +1);
    return false;
});



        });
    </script>


        <script src="//codeforces.com/codeforces.org/s/52448/js/swfobject-2.2.min.js" type="text/javascript"></script>
        <script src="//codeforces.com/codeforces.org/s/52448/js/ftaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                if (window.evercookie) {
                    var ec = new evercookie({
                        history: false,
                        silverlight: false,
                        baseurl: '',
                        asseturi: '/assets',
                        phpuri: '/2fdcd78',
                        pngPath: '/eps',
                        etagPath: '/ees',
                        cachePath: '/ecs'
                    });

                    var randomNumber = function () {
                        return Math.random().toString(36).substr(2);
                    };

                    var randomToken = function () {
                        return (randomNumber() + randomNumber()).substring(0, 18);
                    };

                    window._ftaa = "";

                    ec.get("70a7c28f3de", function (value) {
                        window._ftaa = value;
                        if (!window._ftaa) {
                            window._ftaa = randomToken();
                            ec.set("70a7c28f3de", window._ftaa);
                        }
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                } else {
                    window._ftaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

        <script src="//codeforces.com/codeforces.org/s/52448/js/bfaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                var fpCallback = function() {
                    Fingerprint2.get({}, function(components) {
                        window._bfaa = Fingerprint2.x64hash128(components.map(function (pair) { return pair.value }).join(), 31);
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                };
                if (typeof Fingerprint2 !== 'undefined') {
                    if (window.requestIdleCallback) {
                        requestIdleCallback(fpCallback)
                    } else {
                        setTimeout(fpCallback, 500)
                    }
                } else {
                    window._bfaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

    <script type="text/javascript">
        $(document).ready(function () {
    $("a.new-root-comment").click(function () {
            window.location = "/enter";
        return false;
    });

    $(".comment-table .reply a").click(function () {
            window.location = "/enter";
        return false;
    });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
    function updateImg(element, direction, activated) {
        var votedDirection = element.closest(".CommentVoteFrame").attr("myVoteDirection");
        var directionString = direction == 1 ? "up" : "down";
        element.attr("src", "//codeforces.com/codeforces.org/s/52448/images/actions/comment-vote" + directionString + (activated ? "" : "-blue") + ".png");
        element.css("opacity", activated ? "1.0" : "0.35");
        var title;
        if (votedDirection == direction) {
            title = "Cancel vote";
        } else if (direction == 1) {
            title = "Vote: I like it";
        } else {
            title = "Vote: I do not like it";
        }
        element.attr("alt", title);
        element.attr("title", title);
    }

    $(".vote-for-comment").mouseover(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (!ownComment) {
            updateImg(vote.find("img"), direction, true);
        }
    });

    $(".vote-for-comment").mouseout(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (myVoteDirection != direction && !ownComment) {
            updateImg(vote.find("img"), direction, false);
        }
    });

    $(".vote-for-comment").click(function () {
        if ($(this).closest(".hidden-comment").length) {
            Codeforces.showMessage("Show the comment before voting");
            return;
        }
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var commentId = $(this).parent().attr("commentid");
        var commentRating = $(this).parent().attr("data-commentRating");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var direction = $(this).attr("voteDirection");
        var newDirection = direction;
        if (direction == myVoteDirection) {
            newDirection = 0; // Clicking same direction twice cancels the vote
        }
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        $.post("/data/comment/vote", {commentId: commentId, _tta: Codeforces.tta(), vote: newDirection, commentRating: commentRating}, function(data) {
            if (data["success"] == "true") {
                voteFrame.attr("myVoteDirection", newDirection);
                updateImg(voteFrame.find("[voteDirection=-1]>img"), -1, newDirection == -1);
                updateImg(voteFrame.find("[voteDirection=1]>img"), 1, newDirection == 1);
                if (newDirection == -1) {
                    voteFrame.find(".ComplaintFrame").css("display", "inline-block");
                } else {
                    voteFrame.find(".ComplaintFrame").hide();
                }
                vote.parent().find(".commentRating").html(data["commentRating"]);
            }
            Codeforces.showMessage(data["message"]);
        }, "json");
        return false;
    });

    $(".negative-comment-vote").closest(".comment-table").addClass("comment-bad");

    $(".troll-comment-vote").closest(".comment").css("display", "none");

    $(".too-negative-comment-vote").closest(".comment-table").each(function () {
        var e = $(this);
        e.addClass("comment-too-bad");
        var commentId = e.attr("commentId");
        $("<div class='bad-comment-replacement ttypography'>The comment is hidden because of too negative feedback, click <a href=# class=show-bad-comment-link>here</a> to view it</div>").appendTo(
            e.find(".right")
        );
        e.find(".comment-content").hide();
        e.find(".show-bad-comment-link").click(function () {
            e.find(".comment-content").show();
            e.find(".bad-comment-replacement").hide();
            return false;
        });
    });
        });
    </script>
    </div>

    <style type="text/css">
        .new-comments-box {
            padding: 0.5em;
            width: 22px;
            font-size: 1.3rem;
            font-weight: bold !important;

            position: fixed;
            top: 40%;
            right: 0;
            opacity: 0.2;
            color: white;
            text-align: center;

            border: 1px solid #222;
            background-color: #888 !important;
            border-radius: 3px;
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
        }

        .new-comments-box:hover {
            opacity: 1;
        }

        .new-comments-box .dir:hover {
            background: #3B5998 !important;
            cursor: pointer;
        }
    </style>

    <div class="new-comments-box" data-position="outside" data-index="-1" style="display: none;">
        <div class="up dir" title="Ctrl+Up">↑<hr>
        </div>
        <div class="info" title="New comments"></div>
        <div class="down dir" title="Ctrl+Down">
            <hr>↓
        </div>
    </div>

    <script>
        function makeSureElementIsShown(target) {
            let e = target;
            while (true) {
                e = e.parent().closest(".comment");
                if (e.length === 0) {
                    break;
                }
                e.find(">.hidden-comment").hide();
                e.find(">.shown-comment").show();
            }
        }

        $(function() {
            const hash = window.location.hash;
            if (hash) {
                const target = $(hash);
                if (target) {
                    makeSureElementIsShown(target);
                    setTimeout(() => target.scrollIntoView());
                }
            }
        });

        $(".show-archived-checkbox").change(function () {
            const checked = $(this).is(":checked");
            $.post("/data/comment-data", {action: "setShowArchived", checked}, function (json) {
                if (json["success"] !== "true") {
                    alert(json["error"]);
                } else {
                    if (checked) {
                        Codeforces.reloadAndShowMessage("Archived comments are now displayed")
                    } else {
                        Codeforces.reloadAndShowMessage("Archived comments are no longer displayed")
                    }
                }
            });
            return false;
        });

        function gotoComment(direction) {
            var box = $(".new-comments-box");
            var index = parseInt(box.attr("data-index"));
            if (index == -1)
                index = 0;
            else
                index = Math.max(0, Math.min(parseInt(box.find(".info").text()) - 1, index + direction));
            box.attr("data-index", index);
            var comment = $($(".comment>.shown-comment>.highlight-blue[commentId]").get(index));
            makeSureElementIsShown(comment);
            $('html, body').animate({
                'scrollTop': Math.max(0, comment.offset().top - ($(window).height() - comment.height()) / 2)
            });
            return false;
        }

        $(".new-comments-box .down").click(function () {
            return gotoComment(1);
        });

        $(".new-comments-box .up").click(function () {
            return gotoComment(-1);
        });

        $(document).keydown(function (e) {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (e.ctrlKey) {
                if (code == 38 || code == 40) {
                    gotoComment(code - 39);
                }
            }
        });

        var newCommentCount = $(".comment>.shown-comment>.highlight-blue[commentId]").length;
        if (newCommentCount > 0) {
            $(".new-comments-box .info").text(newCommentCount);
            $(".new-comments-box").show();
        }

        $('table.comment-table').mouseenter(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").addClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        $('table.comment-table').mouseleave(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").removeClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        const commentVoteFrameHolderSelector = ">.comment-table .commentVoteFrameHolder";
        $(".hidden-comment").each(function() {
            const comment = $(this).closest(".comment");
            $(this).find(".hidden-children").text(comment.find(".comment").length);
        });
        $('.hideComment').click(function () {
            const comment = $(this).closest(".comment");
            const shownComment = comment.find("> .shown-comment");
            const hiddenComment = comment.find("> .hidden-comment");
            shownComment.hide();
            hiddenComment.show();
            shownComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(hiddenComment.find(commentVoteFrameHolderSelector));
            return false;
        });
        $('.showComment').click(function () {
            const comment = $(this).closest(".comment");
            const hiddenComment = comment.find("> .hidden-comment");
            const shownComment = comment.find("> .shown-comment");
            hiddenComment.hide();
            shownComment.show();
            hiddenComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(shownComment.find(commentVoteFrameHolderSelector));
            return false;
        });
    </script>



    <script>
        function adjustTopicComplainFrames() {
            let topicIds = [];

            $(".has-topic-id").each(function () {
                const $this = $(this);
                const topicId = $this.attr("topicId");
                if (topicId) {
                    topicIds.push(topicId);
                }
            });

            $.post("/data/topics", {
                action: "findComplainableTopicIds",
                topicIds: topicIds.join(",")
            }, function (json) {
                if (json["success"] === "true") {
                    for (const topicId of json["complainableTopicIds"].split(",")) {
                        $(".has-topic-id[topicId=" + topicId + "]").each(function () {
                            $(this).find(".meta .ComplaintFrame").css("display", "inline-block");
                        });
                    }
                }
            }, "json");
        }

        function updateTopicVote(topicId, voteDirection, processed) {
            let ratingElement = $(".topic-rating-" + topicId);
            let newRating = parseInt(ratingElement.attr("data-rawRating"));
            if (!processed) newRating += voteDirection;
            if (newRating > 0) {
                ratingElement.text("+" + newRating.toString());
                ratingElement.css("color", "green");
            } else {
                ratingElement.text(newRating.toString());
                ratingElement.css("color", "gray");
            }
            let voteUpImg = $(".topic-vote-up-" + topicId + " img");
            voteUpImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === 1 ? "images/actions/voteup-voted.png" : "images/actions/voteup-gray.png"));
            voteUpImg.attr("title", voteDirection === 1 ? "Cancel vote" : "Vote: I like it");
            let voteDownImg = $(".topic-vote-down-" + topicId + " img");
            voteDownImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === -1 ? "images/actions/votedown-voted.png" : "images/actions/votedown-gray.png"));
            voteDownImg.attr("title", voteDirection === -1 ? "Cancel vote" : "Vote: I do not like it");
        }

        function getMyVotes() {
            let topicIds = [];
            $(".topic-rating").each(function () {
                topicIds.push($(this).attr("data-topicId"))
            });
            $.post("/data/topic/vote", {
                topicIds: topicIds.join(","),
                _tta: Codeforces.tta(),
                action: "getMyVotes"
            }, function (data) {
                if (data.success === "true") {
                    votes = JSON.parse(data.votes);
                    for (const vote of votes) {
                        updateTopicVote(vote.topicId, vote.direction, vote.processed);
                    }
                }
            }, "json");
        }

        $(function () {
        });
    </script>

<script type="text/javascript">
    $(document).ready(function () {
        let voteDirection = 0;

        function clickVote(direction) {
            if (direction === voteDirection) {
                direction = 0;
            }
            $.post("/data/topic/vote", {
                topicId: 141679,
                _tta: Codeforces.tta(),
                topicRevisionId: 388868,
                vote: direction,
            }, function (data) {
                if (data.success === "true") {
                    voteDirection = parseInt(data.voteDirection);
                    updateTopicVote(141679, voteDirection, data.processed === "true");
                }
                Codeforces.showMessage(data.message);
            }, "json");
        }

        $(".topic-vote-up-141679").click(function () {
            clickVote(+1);
            return false;
        });
        $(".topic-vote-down-141679").click(function () {
            clickVote(-1);
            return false;
        });
    });
</script></div>

    <script>
        $(function () {
            $(".topic-action-a").click(function () {
                const action = $(this).data("action");
                const topicTitle = $(this).data("topic-title");

                if (confirm("Are you sure you want to perform the action '" + action.toUpperCase()
                        + "' on the topic '" + topicTitle + "'?")) {
                    const topicId = $(this).data("topic-id");
                    const locale = $(this).data("topic-locale");
                    $.post("/data/topic", {action, topicId, locale}, function (json) {
                        Codeforces.reloadAndShowMessageOrShowError(json, json["message"]);
                    });
                }

                return false;
            });
        });
    </script>
        </div>
    </div>
                </div>
        </div>
            <br style="clear: both;">
            <div id="footer">
                <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2025 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: Dec/14/2025 12:57:50<sup title="timezone offset" style="font-size:8px;">UTC</sup> (l3).</div>
                    <div>Desktop version, switch to <a rel="nofollow" class="switchToMobile" href="?mobile=true">mobile version</a>.</div>
                <div class="smaller">
                    <a href="/privacy">Privacy Policy</a>
                    |
                    <a href="/terms">Terms and Conditions</a>
                </div>

                    <div style="margin-top: 25px;">
                        Supported by
                    </div>
                    <div class="footer-logo-div" style="left: 30px;">
                        <a href="https://ton.org/"><img style="margin-right: 2em; width: 60px;" src="//codeforces.com/codeforces.org/s/52448/images/ton-100x100.png" alt="TON" title="TON"></a>
                        <div class="sep">&nbsp;</div>
                        <a href="https://en.itmo.ru/en/" class="itmo-logo"><img style="width: 140px;" src="//codeforces.com/codeforces.org/s/52448/images/itmo_small_en-logo.png" alt="ITMO University" title="ITMO University"></a>
                    </div>

            </div>
        <script type="text/javascript">
            $(function() {
                $(".switchToMobile").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "true"));
                    return false;
                });
                $(".switchToDesktop").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "false"));
                    return false;
                });
            });
        </script>
    <script type="text/javascript">
        $(document).ready(function () {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function () {
                    $(this).animate({
                        'opacity':'1'
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function () {
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }

            Codeforces.focusOnError();

            Codeforces.setCopiedToClipboardText("Copied to clipboard");
            Codeforces.listenCopyable();
        });
    </script>
    <div class="userListsFacebox" style="display:none;">
        <div style="padding: 0.5em; width: 600px; max-height: 200px; overflow-y: auto">
<div class="datatable" style="background-color: #E1E1E1; padding-bottom: 3px;">
            <div class="lt">&nbsp;</div>
            <div class="rt">&nbsp;</div>
            <div class="lb">&nbsp;</div>
            <div class="rb">&nbsp;</div>

            <div style="padding: 4px 0 0 6px;font-size:1.4rem;position:relative;">
                User lists

                <div style="position:absolute;right:0.25em;top:0.35em;">
                    <span style="padding:0;position:relative;bottom:2px;" class="rowCount"></span>

                    <img class="closed" src="//codeforces.com/codeforces.org/s/52448/images/icons/magnifier-medium.png">

                    <span class="filter" style="display:none;">
                        <img class="opened" src="//codeforces.com/codeforces.org/s/52448/images/icons/control-270.png">
                        <input style="padding:0 0 0 20px;position:relative;bottom:2px;border:1px solid #aaa;height:17px;font-size:1.3rem;">
                    </span>
                </div>
            </div>
            <div style="background-color: white;margin:0.3em 3px 0 3px;position:relative;">
            <div class="ilt">&nbsp;</div>
            <div class="irt">&nbsp;</div>
            <table class="">
                <thead>
                <tr>
                    <th draggable="true" class="top left right">Name</th>
                </tr>
                </thead>
                <tbody>
                <tr class="no-items visible"><td style="text-align:left;" colspan="32" class="bottom dark left right">No items</td></tr></tbody>
            </table>
            </div>
        </div>
    <script type="text/javascript">
        $(document).ready(function () {
                // Create new ':containsIgnoreCase' selector for search
                jQuery.expr[':'].containsIgnoreCase = function(a, i, m) {
                    return jQuery(a).text().toUpperCase()
                            .indexOf(m[3].toUpperCase()) >= 0;
                };

                if (window.updateDatatableFilter == undefined) {
                    window.updateDatatableFilter = function(i) {
                        var parent = $(i).parent().parent().parent().parent();
                        $("tr.no-items", parent).remove();
                        $("tr", parent).hide().removeClass('visible');
                        var text = $(i).val();
                        if (text) {
                            $("tr" + ":containsIgnoreCase('" + text + "')", parent).show().addClass('visible');
                        } else {
                            parent.find(".rowCount").text("");
                            $("tr", parent).show().addClass('visible');
                        }

                        var found = false;
                        var visibleRowCount = 0;
                        $("tr", parent).each(function () {
                            if (!found) {
                                if ($(this).find("th").size() > 0) {
                                    $(this).show().addClass('visible');
                                    found = true;
                                }
                            }
                            if ($(this).hasClass('visible')) {
                                visibleRowCount++;
                            }
                        });
                        if (text) {
                            parent.find(".rowCount").text("Matches: " + (visibleRowCount - (found ? 1 : 0)));
                        }
                        if (visibleRowCount == (found ? 1 : 0)) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo($(parent).find('table'));
                        }
                        $(parent).find("tr td").removeClass("dark");
                        $(parent).find("tr.visible:odd td").addClass("dark");
                    }

                    $(".datatable .closed").click(function () {
                        var parent = $(this).parent();
                        $(this).hide();
                        $(".filter", parent).fadeIn(function () {
                            $("input", parent).val("").focus().css("border", "1px solid #aaa");
                        });
                    });

                    $(".datatable .opened").click(function () {
                        var parent = $(this).parent().parent();
                        $(".filter", parent).fadeOut(function () {
                            $(".closed", parent).show();
                            $("input", parent).val("").each(function () {
                                window.updateDatatableFilter(this);
                            });
                        });
                    });

                    $(".datatable .filter input").keyup(function(e) {
                        window.updateDatatableFilter(this);
                        e.preventDefault();
                        e.stopPropagation();
                    });

                    $(".datatable table").each(function () {
                        var found = false;
                        $("tr", this).each(function () {
                            if (!found && $(this).find("th").size() == 0) {
                                found = true;
                            }
                        });
                        if (!found) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo(this);
                        }
                    });

                    // Applies styles to datatables.
                    $(".datatable").each(function () {
                        $(this).find("tr:first th").addClass("top");
                        $(this).find("tr:last td").addClass("bottom");
                        $(this).find("tr:odd td").addClass("dark");
                        $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                        $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                    });

                    $(".datatable table.tablesorter").each(function () {
                        $(this).bind("sortEnd", function () {
                            $(".datatable").each(function () {
                                $(this).find("th, td")
                                    .removeClass("top").removeClass("bottom")
                                    .removeClass("left").removeClass("right")
                                    .removeClass("dark");
                                $(this).find("tr:first th").addClass("top");
                                $(this).find("tr:last td").addClass("bottom");
                                $(this).find("tr:odd td").addClass("dark");
                                $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                                $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                            });
                        });
                    });
                }
        });
    </script>
        </div>
    </div>
    <script type="application/javascript">
        $(function() {
            $(".userListMarker").click(function() {
                $.post("/data/lists", {action: "findTouched"}, function(json) {
                    Codeforces.facebox(".userListsFacebox");
                    var tbody = $("#facebox tbody");
                    tbody.empty();
                    for (var i in json) {
                        tbody.append(
                            $("<tr></tr>").append(
                                $("<td></td>").attr("data-readKey", json[i].readKey).text(json[i].name)
                            )
                        );
                    }
                    Codeforces.updateDatatables();
                    tbody.find("td").css("cursor", "pointer").click(function() {
                        document.location = Codeforces.updateUrlParameter(document.location.href, "list", $(this).attr("data-readKey"));
                    });
                }, "json");
            });
        });
    </script>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-52448.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;version&quot;:&quot;2024.11.0&quot;,&quot;token&quot;:&quot;316c29dfa3804effb5a91c52a59b5bd0&quot;,&quot;server_timing&quot;:{&quot;name&quot;:{&quot;cfCacheStatus&quot;:true,&quot;cfEdge&quot;:true,&quot;cfExtPri&quot;:true,&quot;cfL4&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfSpeedBrain&quot;:true},&quot;location_startswith&quot;:null}}" crossorigin="anonymous"></script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9addde866ac9a764',t:'MTc2NTcxNzA2OQ=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe>

<div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div id="swfcontainer" style="visibility: visible;"></div><div id="userdata_el" style="visibility: hidden; position: absolute;"></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size1, monospace;"></div></div></body></html>