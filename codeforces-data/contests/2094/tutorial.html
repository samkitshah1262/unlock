<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/141796" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><div class="spoiler"><b class="spoiler-title">Rating Predictions</b><div class="spoiler-content" style="display: block;"><table class="bordertable">   <thead>     <tr>       <th>Predictor </th>       <th>A </th>       <th>B </th>       <th>C </th>       <th>D </th>       <th>E </th>       <th>F </th>       <th>G </th>       <th>H </th>     </tr>   </thead>   <tbody>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/Proof_by_QED" title="Master Proof_by_QED">Proof_by_QED</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1200 </td>       <td>1300 </td>       <td>1600 </td>       <td>1800 </td>     </tr>     <tr>       <td><a class="rated-user user-red" href="https://codeforces.com/profile/Dominater069" title="International Grandmaster Dominater069">Dominater069</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>900 </td>       <td>1200 </td>       <td>1200 </td>       <td>1600 </td>       <td>1600 </td>     </tr>     <tr>       <td><a class="rated-user user-violet" href="https://codeforces.com/profile/reirugan" title="Candidate Master reirugan">reirugan</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>900 </td>       <td>1500 </td>       <td>1500 </td>       <td>1700 </td>       <td>1700 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/macaquedev" title="Expert macaquedev">macaquedev</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>900 </td>       <td>1600 </td>       <td>900 </td>       <td>1800 </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/Filikec" title="Expert Filikec">Filikec</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>900 </td>       <td>1300 </td>       <td>1500 </td>       <td>1700 </td>       <td>1800 </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/Edeeva" title="Master Edeeva">Edeeva</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1300 </td>       <td>1600 </td>       <td>1700 </td>       <td>1900 </td>     </tr>     <tr>       <td><a class="rated-user user-violet" href="https://codeforces.com/profile/yoru_sacri" title="Candidate Master yoru_sacri">yoru_sacri</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>900 </td>       <td>1400 </td>       <td>1700 </td>       <td>1900 </td>       <td>1900 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/kevlu8" title="Expert kevlu8">kevlu8</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>900 </td>       <td>1600 </td>       <td>1400 </td>       <td>1700 </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-cyan" href="https://codeforces.com/profile/AG-88301" title="Specialist AG-88301">AG-88301</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>1400 </td>       <td>1500 </td>       <td>— </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1300 </td>       <td>1200 </td>       <td>1800 </td>       <td>2000 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/SpyrosAliv" title="Expert SpyrosAliv">SpyrosAliv</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1200 </td>       <td>3500 </td>       <td>1900 </td>       <td>2000 </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/temporary1" title="Master temporary1">temporary1</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1400 </td>       <td>1500 </td>       <td>1500 </td>       <td>2000 </td>     </tr>   </tbody> </table></div></div><p>Thanks to <a class="rated-user user-violet" href="https://codeforces.com/profile/reirugan" title="Candidate Master reirugan">reirugan</a> for helping write the editorials.</p><h4><a href="https://codeforces.com/contest/2094/problem/A" title="Codeforces Round 1017 (Div. 4)">2094A - Trippi Troppi</a></h4><p>Problem Credits: <a class="rated-user user-orange" href="https://codeforces.com/profile/Proof_by_QED" title="Master Proof_by_QED">Proof_by_QED</a> <br></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>This can be solved by printing the zero-th index of each string in sequence. For example, suppose your strings are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">a</span></span></span><script type="math/tex" id="MathJax-Element-1">a</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">b</span></span></span><script type="math/tex" id="MathJax-Element-2">b</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">c</span></span></span><script type="math/tex" id="MathJax-Element-3">c</script>. Then in C++, you can use <code class="tt">cout &lt;&lt; a[0] &lt;&lt; b[0] &lt;&lt; c[0] &lt;&lt; '\n';</code>, and similarly, in Python you can use <code class="tt">print(a[0] + b[0] + c[0])</code>. See your preferred language's syntax for how to obtain a given indexed character from a string. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="pln">t </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
    inp </span><span class="pun">=</span><span class="pln"> input</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> w </span><span class="kwd">in</span><span class="pln"> inp</span><span class="pun">.</span><span class="pln">split</span><span class="pun">():</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">w</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="kwd">end</span><span class="pun">=</span><span class="str">""</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">()</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>
<style data-nocturne="true" type="text/css">

</style>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9977">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="262">262</span>
            </i>
        </a>
    </span>

    <script>
        $(function() {
            const likeFormUtil = {};
            likeFormUtil.getCount = function ($count) {
                return Number($count.attr("data-value"));
            };
            likeFormUtil.setCount = function ($count, value) {
                $count.attr("data-value", value);
                $count.text(value);
            };
            likeFormUtil.like = function ($likeForm) {
                $likeForm.find(".likeState").addClass("liked");
                const $likeCount = $likeForm.find(".likeCount");
                likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) + 1);
            };
            likeFormUtil.unLike = function ($likeForm) {
                if ($likeForm.find(".likeState").hasClass("liked")) {
                    $likeForm.find(".likeState").removeClass("liked");
                    const $likeCount = $likeForm.find(".likeCount");
                    likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) - 1);
                }
            };
            likeFormUtil.dislike = function ($likeForm) {
                $likeForm.find(".dislikeState").addClass("disliked");
                const $dislikeCount = $likeForm.find(".dislikeCount");
                likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) + 1);
            };
            likeFormUtil.unDislike = function ($likeForm) {
                if ($likeForm.find(".dislikeState").hasClass("disliked")) {
                    $likeForm.find(".dislikeState").removeClass("disliked");
                    const $dislikeCount = $likeForm.find(".dislikeCount");
                    likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) - 1);
                }
            };
            likeFormUtil.disable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", function () {
                    return false;
                });
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", function () {
                    return false;
                });
            };
            likeFormUtil.enable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", onLike);
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", onDislike);
            };
            likeFormUtil.applyLikeableInformation = function(likeableInformation) {
                const id = likeableInformation.likeable.id;
                console.log(id);
                const $likeForm = $(".likeActionLink[data-likeableId='" + id + "']").closest(".likeForm");
                console.log($likeForm);
                likeFormUtil.setCount($likeForm.find(".likeCount"), likeableInformation.likeCount);
                likeFormUtil.setCount($likeForm.find(".dislikeCount"), likeableInformation.dislikeCount);
                if (likeableInformation.liked) {
                    $likeForm.find(".likeState").addClass("liked");
                } else {
                    $likeForm.find(".likeState").removeClass("liked");
                }
                if (likeableInformation.disliked) {
                    $likeForm.find(".likeState").addClass("disliked");
                } else {
                    $likeForm.find(".likeState").removeClass("disliked");
                }
            }
            likeFormUtil.applyLikeableInformations = function(likeableInformations) {
                likeableInformations.forEach((applyLikeableInformation) => {
                    likeFormUtil.applyLikeableInformation(applyLikeableInformation);
                });
            }

            function onLike() {
                const $likeActionLink = $(this);
                const likeableId = $likeActionLink.attr("data-likeableId");
                const $likeForm = $likeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "like",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["liked"]) {
                            Codeforces.showMessage('Added to liked');
                        } else {
                            Codeforces.showMessage('Removed from liked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            function onDislike() {
                const $dislikeActionLink = $(this);
                const likeableId = $dislikeActionLink.attr("data-likeableId");
                const $likeForm = $dislikeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "dislike",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["disliked"]) {
                            Codeforces.showMessage('Added to disliked');
                        } else {
                            Codeforces.showMessage('Removed from disliked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            $(".likeActionLink").click(onLike);
            $(".dislikeActionLink").click(onDislike);

            $(".likeCount").add(".dislikeCount").each(function () {
                const $count = $(this);
                likeFormUtil.setCount($count, likeFormUtil.getCount($count));
            });
        });
    </script>

<script data-nocturne="true"> $(function () {
}); </script>

 Good Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9978">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="173">173</span>
            </i>
        </a>
    </span>


 Okay Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9979">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="26">26</span>
            </i>
        </a>
    </span>


 Bad Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9980">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="16">16</span>
            </i>
        </a>
    </span>


 Didn't Solve</li> </ul></div></div><h4><a href="https://codeforces.com/contest/2094/problem/B" title="Codeforces Round 1017 (Div. 4)">2094B - Bobritto Bandito</a></h4><p>Problem Credits: <a class="rated-user user-orange" href="https://codeforces.com/profile/Proof_by_QED" title="Master Proof_by_QED">Proof_by_QED</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>What is the condition for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-msup" id="MJXp-Span-8"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9" style="margin-right: 0.05em;">l</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-10" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-4">l'</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-msup" id="MJXp-Span-12"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13" style="margin-right: 0.05em;">r</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-14" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-5">r'</script> to be valid?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>We must have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-msup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;">r</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-18" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msup" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21" style="margin-right: 0.05em;">l</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-22" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">m</span></span></span><script type="math/tex" id="MathJax-Element-6">r' - l' = m</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">l</span><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msup" id="MJXp-Span-28"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29" style="margin-right: 0.05em;">l</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-30" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-32">0</span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msup" id="MJXp-Span-34"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35" style="margin-right: 0.05em;">r</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-36" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">r</span></span></span><script type="math/tex" id="MathJax-Element-7">l\leq l' \leq 0 \leq r'\leq r</script>.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>The problem reduces to finding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-39"><span class="MJXp-msup" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41" style="margin-right: 0.05em;">l</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-42" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-8">l'</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-43"><span class="MJXp-msup" id="MJXp-Span-44"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45" style="margin-right: 0.05em;">r</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-46" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-9">r'</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-47"><span class="MJXp-msup" id="MJXp-Span-48"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49" style="margin-right: 0.05em;">r</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-50" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msup" id="MJXp-Span-52"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53" style="margin-right: 0.05em;">l</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-54" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">m</span></span></span><script type="math/tex" id="MathJax-Element-10">r' - l' = m</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-57"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">l</span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msup" id="MJXp-Span-60"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61" style="margin-right: 0.05em;">l</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-62" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-64">0</span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msup" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67" style="margin-right: 0.05em;">r</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-68" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">r</span></span></span><script type="math/tex" id="MathJax-Element-11">l\leq l' \leq 0 \leq r'\leq r</script>. There are several different approaches; two are outlined below.</p><p>One approach which runs in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">O</span><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-74">1</span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-12">O(1)</script> time is to case on whether <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">m</span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">r</span></span></span><script type="math/tex" id="MathJax-Element-13">m\leq r</script>. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">m</span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">r</span></span></span><script type="math/tex" id="MathJax-Element-14">m\leq r</script>, we can choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-msup" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86" style="margin-right: 0.05em;">l</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-87" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-89">0</span></span></span><script type="math/tex" id="MathJax-Element-15">l' = 0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-90"><span class="MJXp-msup" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92" style="margin-right: 0.05em;">r</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-93" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">m</span></span></span><script type="math/tex" id="MathJax-Element-16">r' = m</script>, and then we see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-96"><span class="MJXp-msup" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98" style="margin-right: 0.05em;">r</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-99" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msup" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102" style="margin-right: 0.05em;">l</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-103" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-104" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">m</span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-107">0</span><span class="MJXp-mo" id="MJXp-Span-108" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">m</span></span></span><script type="math/tex" id="MathJax-Element-17">r' - l' = m - 0 = m</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">l</span><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-113">0</span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-115">0</span><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">m</span><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">r</span></span></span><script type="math/tex" id="MathJax-Element-18">l \leq 0 \leq 0 \leq m \leq r</script> as desired. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">m</span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">r</span></span></span><script type="math/tex" id="MathJax-Element-19">m>r</script>, we can choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-124"><span class="MJXp-msup" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126" style="margin-right: 0.05em;">l</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-127" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">r</span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">m</span></span></span><script type="math/tex" id="MathJax-Element-20">l' = r-m</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-msup" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134" style="margin-right: 0.05em;">r</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-135" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">r</span></span></span><script type="math/tex" id="MathJax-Element-21">r' = r</script>, and then we see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-138"><span class="MJXp-msup" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140" style="margin-right: 0.05em;">r</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-141" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-142" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msup" id="MJXp-Span-143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144" style="margin-right: 0.05em;">l</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-145" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">r</span><span class="MJXp-mo" id="MJXp-Span-148" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">r</span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">m</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">m</span></span></span><script type="math/tex" id="MathJax-Element-22">r' - l' = r - (r-m) = m</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">l</span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">r</span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">m</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-163">0</span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">r</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">r</span></span></span><script type="math/tex" id="MathJax-Element-23">l \leq r-m \leq 0 \leq r \leq r</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">l</span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">r</span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">m</span></span></span><script type="math/tex" id="MathJax-Element-24">l \leq r-m</script> holds because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">r</span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">l</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">n</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">m</span></span></span><script type="math/tex" id="MathJax-Element-25">r-l = n \geq m</script>.</p><p>An alternative approach which runs in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">O</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">m</span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-26">O(m)</script> time is to simply simulate the process; expand in an arbitrary direction which satisfies the desired inequalities until <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-187"><span class="MJXp-msup" id="MJXp-Span-188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189" style="margin-right: 0.05em;">r</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-190" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msup" id="MJXp-Span-192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193" style="margin-right: 0.05em;">l</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-194" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">m</span></span></span><script type="math/tex" id="MathJax-Element-27">r' - l' = m</script>. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> m </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> diff </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
    l </span><span class="pun">=</span><span class="pln"> abs</span><span class="pun">(</span><span class="pln">l</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&gt;=</span><span class="pln"> diff</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        l </span><span class="pun">-=</span><span class="pln"> diff</span><span class="pun">;</span><span class="pln">
        diff </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        diff </span><span class="pun">-=</span><span class="pln"> l</span><span class="pun">;</span><span class="pln">
        l </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">-</span><span class="pln">l </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> r </span><span class="pun">-</span><span class="pln"> diff </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9981">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="280">280</span>
            </i>
        </a>
    </span>


 Good Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9982">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="100">100</span>
            </i>
        </a>
    </span>


 Okay Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9983">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="94">94</span>
            </i>
        </a>
    </span>


 Bad Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9984">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="38">38</span>
            </i>
        </a>
    </span>


 Didn't Solve</li> </ul></div></div><h4><a href="https://codeforces.com/contest/2094/problem/C" title="Codeforces Round 1017 (Div. 4)">2094C - Brr Brrr Patapim</a></h4><p>Problem Credits: <a class="rated-user user-orange" href="https://codeforces.com/profile/cry" title="International Master cry">cry</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>How can we find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-197"><span class="MJXp-msubsup" id="MJXp-Span-198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-200" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-28">p_i</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-201"><span class="MJXp-mn" id="MJXp-Span-202">2</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">i</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">n</span></span></span><script type="math/tex" id="MathJax-Element-29">2\leq i\leq n</script>? How can we find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-msubsup" id="MJXp-Span-208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-210" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-30">p_i</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">n</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-214">1</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">i</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-218">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">n</span></span></span><script type="math/tex" id="MathJax-Element-31">n+1\leq i\leq 2n</script>?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-220"><span class="MJXp-mn" id="MJXp-Span-221">2</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">i</span><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">n</span></span></span><script type="math/tex" id="MathJax-Element-32">2\leq i\leq n</script>, we can find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-226"><span class="MJXp-msubsup" id="MJXp-Span-227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-229" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-33">p_i</script> by checking <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-msubsup" id="MJXp-Span-231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-233" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-234">1</span><span class="MJXp-mo" id="MJXp-Span-235">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">i</span><span class="MJXp-mo" id="MJXp-Span-237">−</span><span class="MJXp-mn" id="MJXp-Span-238">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-34">G_{1, i-1}</script>. For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">n</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-242">1</span><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">i</span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-246">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">n</span></span></span><script type="math/tex" id="MathJax-Element-35">n+1\leq i\leq 2n</script>, we can find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-msubsup" id="MJXp-Span-249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-251" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-36">p_i</script> by checking <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-252"><span class="MJXp-msubsup" id="MJXp-Span-253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-255" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">n</span><span class="MJXp-mo" id="MJXp-Span-257">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">i</span><span class="MJXp-mo" id="MJXp-Span-259">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">n</span></span></span></span></span><script type="math/tex" id="MathJax-Element-37">G_{n, i-n}</script>.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Observe that for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-mn" id="MJXp-Span-262">2</span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">i</span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">n</span></span></span><script type="math/tex" id="MathJax-Element-38">2\leq i\leq n</script>, we can find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-267"><span class="MJXp-msubsup" id="MJXp-Span-268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-270" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-39">p_i</script> by checking <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-271"><span class="MJXp-msubsup" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-274" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-275">1</span><span class="MJXp-mo" id="MJXp-Span-276">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">i</span><span class="MJXp-mo" id="MJXp-Span-278">−</span><span class="MJXp-mn" id="MJXp-Span-279">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-40">G_{1, i-1}</script>. Then for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">n</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-283">1</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">i</span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-287">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">n</span></span></span><script type="math/tex" id="MathJax-Element-41">n+1\leq i\leq 2n</script>, we can find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-289"><span class="MJXp-msubsup" id="MJXp-Span-290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-292" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-42">p_i</script> by checking <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-293"><span class="MJXp-msubsup" id="MJXp-Span-294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-296" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">n</span><span class="MJXp-mo" id="MJXp-Span-298">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">i</span><span class="MJXp-mo" id="MJXp-Span-300">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">n</span></span></span></span></span><script type="math/tex" id="MathJax-Element-43">G_{n, i-n}</script>. Now, we only have to find the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-302"><span class="MJXp-msubsup" id="MJXp-Span-303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-305" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-44">p_1</script>. However, each value from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mn" id="MJXp-Span-307">1</span></span></span><script type="math/tex" id="MathJax-Element-45">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-308"><span class="MJXp-mn" id="MJXp-Span-309">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">n</span></span></span><script type="math/tex" id="MathJax-Element-46">2n</script> must appear exactly once in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">p</span></span></span><script type="math/tex" id="MathJax-Element-47">p</script>. Thus, we can simply find the value which has not appeared yet, and choose that as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-313"><span class="MJXp-msubsup" id="MJXp-Span-314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-316" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-48">p_1</script>. This can be done by storing which values have been seen in a boolean array, and then finding which one remains false. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ans</span><span class="pun">(</span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    vector</span><span class="str">&lt;bool&gt;</span><span class="pln"> used</span><span class="pun">(</span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
            ans</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
            used</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">used</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    used</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
                    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> j </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pun">;</span><span class="pln">
                    </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9985">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="287">287</span>
            </i>
        </a>
    </span>


 Good Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9986">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="59">59</span>
            </i>
        </a>
    </span>


 Okay Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9987">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="33">33</span>
            </i>
        </a>
    </span>


 Bad Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9988">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="15">15</span>
            </i>
        </a>
    </span>


 Didn't Solve</li> </ul></div></div><h4><a href="https://codeforces.com/contest/2094/problem/D" title="Codeforces Round 1017 (Div. 4)">2094D - Tung Tung Sahur</a></h4><p>Problem Credits: <a class="rated-user user-orange" href="https://codeforces.com/profile/Proof_by_QED" title="Master Proof_by_QED">Proof_by_QED</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>What would happen if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-317"><span class="MJXp-msubsup" id="MJXp-Span-318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-320" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-49">s_1</script> consists of only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">L</span></span></span><script type="math/tex" id="MathJax-Element-50">L</script>?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>In this case, the answer is yes if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-323"><span class="MJXp-mrow" id="MJXp-Span-324"><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-328" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-329"><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-332"><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-336" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-337"><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-340">2</span><span class="MJXp-mrow" id="MJXp-Span-341"><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-345" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-346"><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-51">|s_1| \leq |s_2| \leq 2|s_1|</script>. Now try to generalize this.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>First, let us consider a simpler case of the problem: suppose that there is only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">L</span></span></span><script type="math/tex" id="MathJax-Element-52">L</script> in both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-350"><span class="MJXp-msubsup" id="MJXp-Span-351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-353" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-53">s_1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-354"><span class="MJXp-msubsup" id="MJXp-Span-355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-357" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-54">s_2</script>. Then it is clear that the answer is yes if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-358"><span class="MJXp-mrow" id="MJXp-Span-359"><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-363" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-364"><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-367"><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-371" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-372"><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-375">2</span><span class="MJXp-mrow" id="MJXp-Span-376"><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-380" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-381"><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-55">|s_1| \leq |s_2| \leq 2|s_1|</script>. If this holds (in particular, we also necessitate that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-383"><span class="MJXp-msubsup" id="MJXp-Span-384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-386" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-56">s_1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-387"><span class="MJXp-msubsup" id="MJXp-Span-388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-390" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-57">s_2</script> consist of only a single character, and the same character), we will call <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-391"><span class="MJXp-msubsup" id="MJXp-Span-392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-394" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-58">s_2</script> an extension of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-395"><span class="MJXp-msubsup" id="MJXp-Span-396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-398" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-59">s_1</script>.</p><p>Now, observe that the problem given is simply the simpler version, repeated several times alternating between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">L</span></span></span><script type="math/tex" id="MathJax-Element-60">L</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">R</span></span></span><script type="math/tex" id="MathJax-Element-61">R</script>. So we can partition <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-403"><span class="MJXp-msubsup" id="MJXp-Span-404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-406" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-62">s_1</script> into "blocks" (where we define a block to be a maximal group of contiguous identical characters). Then the answer is yes if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-407"><span class="MJXp-msubsup" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-410" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-63">s_2</script> is the concatenation of extensions of blocks in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-411"><span class="MJXp-msubsup" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-414" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-64">s_1</script>. For example, consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-415"><span class="MJXp-msubsup" id="MJXp-Span-416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-418" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">L</span></span></span><script type="math/tex" id="MathJax-Element-65">s_1 = LLLLLRL</script>. We see that this consists of five <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">L</span></span></span><script type="math/tex" id="MathJax-Element-66">L</script>s, one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">R</span></span></span><script type="math/tex" id="MathJax-Element-67">R</script>, and one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">L</span></span></span><script type="math/tex" id="MathJax-Element-68">L</script>. So the answer is yes if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-433"><span class="MJXp-msubsup" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-436" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-69">s_2</script> consists of between five and ten <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">L</span></span></span><script type="math/tex" id="MathJax-Element-70">L</script>s (inclusive), between one and two <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">R</span></span></span><script type="math/tex" id="MathJax-Element-71">R</script>s, and between one and two <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">L</span></span></span><script type="math/tex" id="MathJax-Element-72">L</script> 's, concatenated in that order. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">string</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a </span><span class="pun">&gt;&gt;</span><span class="pln"> b</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> m </span><span class="pun">=</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">m </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">||</span><span class="pln"> m </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">||</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> b</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"NO\n"</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> aa</span><span class="pun">,</span><span class="pln"> bb</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            aa</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">);</span><span class="pln">
            cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> cnt</span><span class="pun">++;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    aa</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">);</span><span class="pln">
    cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            bb</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">);</span><span class="pln">
            cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> cnt</span><span class="pun">++;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    bb</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">aa</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> bb</span><span class="pun">.</span><span class="pln">size</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"NO\n"</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> aa</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">aa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> bb</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> aa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> bb</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"NO\n"</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"YES\n"</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9993">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="485">485</span>
            </i>
        </a>
    </span>


 Good Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9994">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="60">60</span>
            </i>
        </a>
    </span>


 Okay Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9995">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="38">38</span>
            </i>
        </a>
    </span>


 Bad Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9996">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="66">66</span>
            </i>
        </a>
    </span>


 Didn't Solve</li> </ul></div></div><h4><a href="https://codeforces.com/contest/2094/problem/E" title="Codeforces Round 1017 (Div. 4)">2094E - Boneca Ambalabu</a></h4><p>Problem Credits: <a class="rated-user user-orange" href="https://codeforces.com/profile/Proof_by_QED" title="Master Proof_by_QED">Proof_by_QED</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Consider each bit independently.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Suppose we fix <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">k</span></span></span><script type="math/tex" id="MathJax-Element-73">k</script>. How can we compute the desired sum quickly? Note that this may require preprocessing.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Here, it suffices to consider each bit independently, because addition is both commutative and associative. For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-445"><span class="MJXp-mn" id="MJXp-Span-446">0</span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">i</span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-450">30</span></span></span><script type="math/tex" id="MathJax-Element-74">0\leq i < 30</script>, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">n</span><span class="MJXp-msubsup" id="MJXp-Span-454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-456" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-75">cnt_i</script> denote the number of elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">a</span></span></span><script type="math/tex" id="MathJax-Element-76">a</script> which have the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">i</span></span></span><script type="math/tex" id="MathJax-Element-77">i</script>-th bit set (where bits are indexed from the least significant bit being the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-461"><span class="MJXp-mn" id="MJXp-Span-462">0</span></span></span><script type="math/tex" id="MathJax-Element-78">0</script>-th bit); note that these can be found in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">O</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-466">30</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">n</span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-79">O(30n)</script> time (more generally, we need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">O</span><span class="MJXp-mo" id="MJXp-Span-477" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-478">log</span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mrow" id="MJXp-Span-481"><span class="MJXp-msubsup" id="MJXp-Span-482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-484" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-485" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-80">O(\log\max{a_i})</script> operations per element).</p><p>Now, suppose we choose a particular <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">k</span></span></span><script type="math/tex" id="MathJax-Element-81">k</script>. Then we can find the sum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-488"><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-492" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-msubsup" id="MJXp-Span-494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-496" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-498" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-499" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-502" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-msubsup" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-506" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-510" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-513" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-msubsup" id="MJXp-Span-515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-517" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-518" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-82">(a_k\oplus a_1) + (a_k\oplus a_2) \dots + (a_k\oplus a_n)</script> as follows: for a given bit position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">i</span></span></span><script type="math/tex" id="MathJax-Element-83">i</script>, the number of elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-521"><span class="MJXp-msubsup" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-524" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-84">a_j</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-525"><span class="MJXp-msubsup" id="MJXp-Span-526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-528" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-529" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-msubsup" id="MJXp-Span-530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-532" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-85">a_k \oplus a_j</script> has the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">i</span></span></span><script type="math/tex" id="MathJax-Element-86">i</script>-th bit set will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">n</span><span class="MJXp-msubsup" id="MJXp-Span-538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-540" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-87">cnt_i</script> if the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">i</span></span></span><script type="math/tex" id="MathJax-Element-88">i</script>-th bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-543"><span class="MJXp-msubsup" id="MJXp-Span-544"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-546" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-89">a_k</script> is not set, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">n</span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">n</span><span class="MJXp-msubsup" id="MJXp-Span-552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-554" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-90">n-cnt_i</script> if the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">i</span></span></span><script type="math/tex" id="MathJax-Element-91">i</script>-th bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-557"><span class="MJXp-msubsup" id="MJXp-Span-558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-560" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-92">a_k</script> is set. So we can simply add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">n</span><span class="MJXp-msubsup" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-566" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-568"><span class="MJXp-mn" id="MJXp-Span-569" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-570" style="vertical-align: 0.5em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-93">cnt_i \cdot 2^i</script> to our sum if the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">i</span></span></span><script type="math/tex" id="MathJax-Element-94">i</script>-th bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-573"><span class="MJXp-msubsup" id="MJXp-Span-574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-576" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-95">a_k</script> is not set, and add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-577"><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">n</span><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">n</span><span class="MJXp-msubsup" id="MJXp-Span-583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-585" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-588"><span class="MJXp-mn" id="MJXp-Span-589" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-590" style="vertical-align: 0.5em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-96">(n-cnt_i) \cdot 2^i</script> to our sum if the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">i</span></span></span><script type="math/tex" id="MathJax-Element-97">i</script>-th bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-593"><span class="MJXp-msubsup" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-596" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-98">a_k</script> is set.</p><p>This allows us to compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-597"><span class="MJXp-mo" id="MJXp-Span-598" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-601" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-msubsup" id="MJXp-Span-603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-605" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-611" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-612" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-msubsup" id="MJXp-Span-613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-615" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-617" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-622" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-msubsup" id="MJXp-Span-624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-626" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-99">(a_k\oplus a_1) + (a_k\oplus a_2) \dots + (a_k\oplus a_n)</script> for any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">k</span></span></span><script type="math/tex" id="MathJax-Element-100">k</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">O</span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-633">30</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-101">O(30)</script> time, so we can now compute this sum for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">k</span></span></span><script type="math/tex" id="MathJax-Element-102">k</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">O</span><span class="MJXp-mo" id="MJXp-Span-639" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-640">30</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">n</span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-103">O(30n)</script> time and output the maximum. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> arr</span><span class="pun">[</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> cnt</span><span class="pun">(</span><span class="lit">30</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">30</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> tot </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">30</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">bool</span><span class="pln"> f </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">f</span><span class="pun">)</span><span class="pln"> tot </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> tot </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        ans </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> tot</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9997">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="632">632</span>
            </i>
        </a>
    </span>


 Good Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9998">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="29">29</span>
            </i>
        </a>
    </span>


 Okay Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="9999">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


 Bad Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10000">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="125">125</span>
            </i>
        </a>
    </span>


 Didn't Solve</li> </ul></div></div><h4><a href="https://codeforces.com/contest/2094/problem/F" title="Codeforces Round 1017 (Div. 4)">2094F - Trulimero Trulicina</a></h4><p>Problem Credits: <a class="rated-user user-orange" href="https://codeforces.com/profile/Proof_by_QED" title="Master Proof_by_QED">Proof_by_QED</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>What would happen if we tried outputting the numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-643"><span class="MJXp-mn" id="MJXp-Span-644">1</span><span class="MJXp-mo" id="MJXp-Span-645" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">k</span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-650">1</span><span class="MJXp-mo" id="MJXp-Span-651" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">k</span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-104">1, \dots, k, 1, \dots, k, \dots</script> in the natural reading order? For example, for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">n</span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-660">3</span></span></span><script type="math/tex" id="MathJax-Element-105">n=3</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">m</span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-664">4</span></span></span><script type="math/tex" id="MathJax-Element-106">m=4</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">k</span><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-668">6</span></span></span><script type="math/tex" id="MathJax-Element-107">k=6</script>, we would output the following:</p> <table class="bordertable">   <tbody>     <tr>       <td>1 </td>       <td>2 </td>       <td>3 </td>       <td>4 </td>     </tr>     <tr>       <td>5 </td>       <td>6 </td>       <td>1 </td>       <td>2 </td>     </tr>     <tr>       <td>3 </td>       <td>4 </td>       <td>5 </td>       <td>6 </td>     </tr>   </tbody> </table><p>In which cases does this fail?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>This fails if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">m</span></span></span><script type="math/tex" id="MathJax-Element-108">m</script> is a multiple of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">k</span></span></span><script type="math/tex" id="MathJax-Element-109">k</script>, because we see that horizontally adjacent elements differ by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-673"><span class="MJXp-mn" id="MJXp-Span-674">1</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-675"><span class="MJXp-mspace" id="MJXp-Span-676" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-678">mod</span><span class="MJXp-mspace" id="MJXp-Span-679" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">k</span><span class="MJXp-mo" id="MJXp-Span-681" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-110">1\pmod k</script> and vertically adjacent elements differ by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">m</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-684"><span class="MJXp-mspace" id="MJXp-Span-685" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-687">mod</span><span class="MJXp-mspace" id="MJXp-Span-688" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">k</span><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-111">m\pmod k</script>. Now try to resolve this case.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>There are many working constructions for this problem; one of them is to case on whether or not <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">m</span></span></span><script type="math/tex" id="MathJax-Element-112">m</script> is a multiple of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-693"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">k</span></span></span><script type="math/tex" id="MathJax-Element-113">k</script>.</p><p>Suppose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">m</span></span></span><script type="math/tex" id="MathJax-Element-114">m</script> is not a multiple of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">k</span></span></span><script type="math/tex" id="MathJax-Element-115">k</script>. For example, consider the second sample, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">n</span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-702">3</span></span></span><script type="math/tex" id="MathJax-Element-116">n=3</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-703"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">m</span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-706">4</span></span></span><script type="math/tex" id="MathJax-Element-117">m=4</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">k</span><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-710">6</span></span></span><script type="math/tex" id="MathJax-Element-118">k=6</script>. Then we can output the numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-711"><span class="MJXp-mn" id="MJXp-Span-712">1</span><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-715" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">k</span><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-718">1</span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">k</span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-119">1, \dots, k, 1, \dots, k, \dots</script> in the natural reading order, as follows:</p> <table class="bordertable">   <tbody>     <tr>       <td>1 </td>       <td>2 </td>       <td>3 </td>       <td>4 </td>     </tr>     <tr>       <td>5 </td>       <td>6 </td>       <td>1 </td>       <td>2 </td>     </tr>     <tr>       <td>3 </td>       <td>4 </td>       <td>5 </td>       <td>6 </td>     </tr>   </tbody> </table><p>and we see that any two horizontally adjacent elements differ by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-725"><span class="MJXp-mn" id="MJXp-Span-726">1</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-727"><span class="MJXp-mspace" id="MJXp-Span-728" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-729" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-730">mod</span><span class="MJXp-mspace" id="MJXp-Span-731" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">k</span><span class="MJXp-mo" id="MJXp-Span-733" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-120">1\pmod k</script>, whereas any two vertically adjacent elements differ by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">m</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-736"><span class="MJXp-mspace" id="MJXp-Span-737" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-739">mod</span><span class="MJXp-mspace" id="MJXp-Span-740" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">k</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-121">m\pmod k</script>, so no two adjacent elements are the same, as desired.</p><p>Now, suppose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">m</span></span></span><script type="math/tex" id="MathJax-Element-122">m</script> is a multiple of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">k</span></span></span><script type="math/tex" id="MathJax-Element-123">k</script>. For example, consider the case <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">n</span><span class="MJXp-mo" id="MJXp-Span-749" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-750">4</span></span></span><script type="math/tex" id="MathJax-Element-124">n=4</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">m</span><span class="MJXp-mo" id="MJXp-Span-753" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-754">6</span></span></span><script type="math/tex" id="MathJax-Element-125">m=6</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">k</span><span class="MJXp-mo" id="MJXp-Span-757" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-758">3</span></span></span><script type="math/tex" id="MathJax-Element-126">k=3</script>. Suppose we were to try the above strategy, then we get:</p> <table class="bordertable">   <tbody>     <tr>       <td>1 </td>       <td>2 </td>       <td>3 </td>       <td>1 </td>       <td>2 </td>       <td>3 </td>     </tr>     <tr>       <td>1 </td>       <td>2 </td>       <td>3 </td>       <td>1 </td>       <td>2 </td>       <td>3 </td>     </tr>     <tr>       <td>1 </td>       <td>2 </td>       <td>3 </td>       <td>1 </td>       <td>2 </td>       <td>3 </td>     </tr>     <tr>       <td>1 </td>       <td>2 </td>       <td>3 </td>       <td>1 </td>       <td>2 </td>       <td>3 </td>     </tr>   </tbody> </table><p>which doesn't work, since vertically adjacent elements are the same. We can fix this by cyclically shifting every other row as follows:</p> <table class="bordertable">   <tbody>     <tr>       <td>1 </td>       <td>2 </td>       <td>3 </td>       <td>1 </td>       <td>2 </td>       <td>3 </td>     </tr>     <tr>       <td>2 </td>       <td>3 </td>       <td>1 </td>       <td>2 </td>       <td>3 </td>       <td>1 </td>     </tr>     <tr>       <td>1 </td>       <td>2 </td>       <td>3 </td>       <td>1 </td>       <td>2 </td>       <td>3 </td>     </tr>     <tr>       <td>2 </td>       <td>3 </td>       <td>1 </td>       <td>2 </td>       <td>3 </td>       <td>1 </td>     </tr>   </tbody> </table><p>and we see that any two horizontally adjacent elements differ by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-759"><span class="MJXp-mn" id="MJXp-Span-760">1</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-761"><span class="MJXp-mspace" id="MJXp-Span-762" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-763" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-764">mod</span><span class="MJXp-mspace" id="MJXp-Span-765" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">k</span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-127">1\pmod k</script> as before, whereas any two vertically adjacent elements also differ by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-768"><span class="MJXp-mn" id="MJXp-Span-769">1</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-770"><span class="MJXp-mspace" id="MJXp-Span-771" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-773">mod</span><span class="MJXp-mspace" id="MJXp-Span-774" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">k</span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-128">1\pmod k</script>, so no two adjacent elements are the same, as desired. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> sys
input </span><span class="pun">=</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">readline
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
    n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">k </span><span class="pun">=</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
    LAST </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[-</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">m</span><span class="pun">)]</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        shift </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
        CUR </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">m</span><span class="pun">)]</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">m</span><span class="pun">):</span><span class="pln">
            elm </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> elm </span><span class="pun">==</span><span class="pln"> LAST</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]:</span><span class="pln">
                shift </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">
            CUR</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> elm
        </span><span class="kwd">if</span><span class="pln"> shift</span><span class="pun">:</span><span class="pln">
            CUR </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">CUR</span><span class="pun">[(</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)%</span><span class="pln">m</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">m</span><span class="pun">)]</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(*</span><span class="pln">CUR</span><span class="pun">)</span><span class="pln">
        LAST </span><span class="pun">=</span><span class="pln"> CUR</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10001">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="325">325</span>
            </i>
        </a>
    </span>


 Good Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10002">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="70">70</span>
            </i>
        </a>
    </span>


 Okay Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10003">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="134">134</span>
            </i>
        </a>
    </span>


 Bad Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10004">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="62">62</span>
            </i>
        </a>
    </span>


 Didn't Solve</li> </ul></div></div><h4><a href="https://codeforces.com/contest/2094/problem/G" title="Codeforces Round 1017 (Div. 4)">2094G - Chimpanzini Bananini</a></h4><p>Problem Credits: <a class="rated-user user-orange" href="https://codeforces.com/profile/Proof_by_QED" title="Master Proof_by_QED">Proof_by_QED</a>, <a class="rated-user user-orange" href="https://codeforces.com/profile/cry" title="International Master cry">cry</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Note that reversing an array then pushing an element to the back is similar to simply pushing an element to the front. Thus, we would like to push elements to both ends of the array. What data structure supports this?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>A deque is the most natural choice to use. Most languages, including C++, Java, and Python, include deques in their standard library, so you likely do not have to implement it yourself.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>What other values do we need to maintain in order to keep track of score?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>It suffices to keep track of the current score, the score of the array if it were backwards, the size of the array, and the sum of the array. </p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>We can solve this using a deque. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-777"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">e</span></span></span><script type="math/tex" id="MathJax-Element-129">score</script> denote the current score, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">e</span></span></span><script type="math/tex" id="MathJax-Element-130">rscore</script> denote the score of the array if it were backwards. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">e</span></span></span><script type="math/tex" id="MathJax-Element-131">size</script> denote the size of the array, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">m</span></span></span><script type="math/tex" id="MathJax-Element-132">sum</script> denote the sum of the array. Then we consider how these three values change as each operation is performed.</p><p>Suppose operation 1 is performed. This is equivalent to popping the back element of the array and pushing it in the front. When you pop the back element of the array, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">e</span></span></span><script type="math/tex" id="MathJax-Element-133">score</script> decreases by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-805"><span class="MJXp-msubsup" id="MJXp-Span-806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-808" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">e</span></span></span><script type="math/tex" id="MathJax-Element-134">a_n \cdot size</script>. Then when you push it to the front, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-814"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">e</span></span></span><script type="math/tex" id="MathJax-Element-135">score</script> increases by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">m</span></span></span><script type="math/tex" id="MathJax-Element-136">sum</script> because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-824"><span class="MJXp-msubsup" id="MJXp-Span-825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-827" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-137">a_n</script> is pushed to the first spot and every element from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-828"><span class="MJXp-msubsup" id="MJXp-Span-829"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-831" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-138">a_1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-832"><span class="MJXp-msubsup" id="MJXp-Span-833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-835" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">n</span><span class="MJXp-mo" id="MJXp-Span-837">−</span><span class="MJXp-mn" id="MJXp-Span-838">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-139">a_{n-1}</script> moves forward one spot. Notice that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-839"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">e</span></span></span><script type="math/tex" id="MathJax-Element-140">rscore</script> changes in the reverse way; this is equivalent to popping the front element of the array and pushing it to the back. When you pop the front element of the array, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">e</span></span></span><script type="math/tex" id="MathJax-Element-141">rscore</script> decreases by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">m</span></span></span><script type="math/tex" id="MathJax-Element-142">sum</script>, and when you push it to the back, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-857"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">e</span></span></span><script type="math/tex" id="MathJax-Element-143">rscore</script> increases by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-864"><span class="MJXp-msubsup" id="MJXp-Span-865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-867" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">e</span></span></span><script type="math/tex" id="MathJax-Element-144">a_n \cdot size</script>. Note that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">e</span></span></span><script type="math/tex" id="MathJax-Element-145">size</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">m</span></span></span><script type="math/tex" id="MathJax-Element-146">sum</script> remain unchanged.</p><p>Suppose operation 2 is performed. Then we swap <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">e</span></span></span><script type="math/tex" id="MathJax-Element-147">score</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">e</span></span></span><script type="math/tex" id="MathJax-Element-148">rscore</script>, and we also want to "reverse" the array. However, it is costly to entirely reverse the deque. Instead, we will set a flag to indicate that the array has been reversed (and similarly, if the flag is already set, we will unset it). If the flag is set, we simply switch the front and back ends whenever we access or modify the deque while performing operations 1 or 3.</p><p>Suppose operation 3 is performed. Then we see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">e</span></span></span><script type="math/tex" id="MathJax-Element-149">size</script> increases by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-900"><span class="MJXp-mn" id="MJXp-Span-901">1</span></span></span><script type="math/tex" id="MathJax-Element-150">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">m</span></span></span><script type="math/tex" id="MathJax-Element-151">sum</script> increases by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">k</span></span></span><script type="math/tex" id="MathJax-Element-152">k</script>. Then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-908"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">e</span></span></span><script type="math/tex" id="MathJax-Element-153">score</script> increases by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">k</span><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">e</span></span></span><script type="math/tex" id="MathJax-Element-154">k \cdot size</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">e</span></span></span><script type="math/tex" id="MathJax-Element-155">rscore</script> increases by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-928"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">m</span></span></span><script type="math/tex" id="MathJax-Element-156">sum</script> (using the new value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">m</span></span></span><script type="math/tex" id="MathJax-Element-157">sum</script>), by identical reasoning to that in operation 1. </p><p>Additional optimization: we don't actually have to maintain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">e</span></span></span><script type="math/tex" id="MathJax-Element-158">rscore</script>; we can obtain it with the expression: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-943"><span class="MJXp-mo" id="MJXp-Span-944" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">n</span><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-947">1</span><span class="MJXp-mo" id="MJXp-Span-948" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-949"><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">i</span><span class="MJXp-mo" id="MJXp-Span-953">=</span><span class="MJXp-mn" id="MJXp-Span-954">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-958" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-959" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">e</span></span></span><script type="math/tex" id="MathJax-Element-159">(n+1)\sum_{i=1}^na_i-score</script>. This is because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-965"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">e</span><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">e</span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">n</span><span class="MJXp-mo" id="MJXp-Span-981" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-982">1</span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-984"><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">i</span><span class="MJXp-mo" id="MJXp-Span-988">=</span><span class="MJXp-mn" id="MJXp-Span-989">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-993" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-160">score + rscore = (n+1)\sum_{i=1}^na_i</script> since the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">i</span></span></span><script type="math/tex" id="MathJax-Element-161">i</script>-th term is counted <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">i</span></span></span><script type="math/tex" id="MathJax-Element-162">i</script> times in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">e</span></span></span><script type="math/tex" id="MathJax-Element-163">score</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">n</span><span class="MJXp-mo" id="MJXp-Span-1006" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1007">1</span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">i</span></span></span><script type="math/tex" id="MathJax-Element-164">n+1-i</script> times in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">e</span></span></span><script type="math/tex" id="MathJax-Element-165">rscore</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> norm </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> rev </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> q</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tot </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    deque</span><span class="str">&lt;int&gt;</span><span class="pln"> qNorm</span><span class="pun">,</span><span class="pln"> qRev</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">q</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">last</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> qNorm</span><span class="pun">.</span><span class="pln">back</span><span class="pun">();</span><span class="pln">
            qNorm</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
            qNorm</span><span class="pun">.</span><span class="pln">push_front</span><span class="pun">(</span><span class="kwd">last</span><span class="pun">);</span><span class="pln">
            norm </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tot </span><span class="pun">-</span><span class="pln"> </span><span class="kwd">last</span><span class="pun">);</span><span class="pln">
            norm </span><span class="pun">-=</span><span class="pln"> </span><span class="kwd">last</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
            norm </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">last</span><span class="pun">;</span><span class="pln">

            </span><span class="kwd">last</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> qRev</span><span class="pun">.</span><span class="pln">front</span><span class="pun">();</span><span class="pln">
            qRev</span><span class="pun">.</span><span class="pln">pop_front</span><span class="pun">();</span><span class="pln">
            qRev</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="kwd">last</span><span class="pun">);</span><span class="pln">
            rev </span><span class="pun">-=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tot </span><span class="pun">-</span><span class="pln"> </span><span class="kwd">last</span><span class="pun">);</span><span class="pln">
            rev </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">last</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
            rev </span><span class="pun">-=</span><span class="pln"> </span><span class="kwd">last</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">==</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            swap</span><span class="pun">(</span><span class="pln">rev</span><span class="pun">,</span><span class="pln"> norm</span><span class="pun">);</span><span class="pln">
            swap</span><span class="pun">(</span><span class="pln">qNorm</span><span class="pun">,</span><span class="pln"> qRev</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">==</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            n</span><span class="pun">++;</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
            qNorm</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">k</span><span class="pun">);</span><span class="pln">
            qRev</span><span class="pun">.</span><span class="pln">push_front</span><span class="pun">(</span><span class="pln">k</span><span class="pun">);</span><span class="pln">
            norm </span><span class="pun">+=</span><span class="pln"> k </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
            rev </span><span class="pun">+=</span><span class="pln"> tot</span><span class="pun">;</span><span class="pln">
            rev </span><span class="pun">+=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
            tot </span><span class="pun">+=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> norm </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10005">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="402">402</span>
            </i>
        </a>
    </span>


 Good Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10006">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="35">35</span>
            </i>
        </a>
    </span>


 Okay Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10007">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="10">10</span>
            </i>
        </a>
    </span>


 Bad Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10008">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="49">49</span>
            </i>
        </a>
    </span>


 Didn't Solve</li> </ul></div></div><h4><a href="https://codeforces.com/contest/2094/problem/H" title="Codeforces Round 1017 (Div. 4)">2094H - La Vaca Saturno Saturnita</a></h4><p>Problem Credits: <a class="rated-user user-orange" href="https://codeforces.com/profile/cry" title="International Master cry">cry</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>What must the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">a</span><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">i</span><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-166">a[i]</script> be in order for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">k</span></span></span><script type="math/tex" id="MathJax-Element-167">k</script> to change?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">a</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">i</span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-168">a[i]</script> must be a divisor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">k</span></span></span><script type="math/tex" id="MathJax-Element-169">k</script>.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Can we use this to bound the number of times <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">k</span></span></span><script type="math/tex" id="MathJax-Element-170">k</script> changes?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>For each divisor <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">d</span></span></span><script type="math/tex" id="MathJax-Element-171">d</script> of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">k</span></span></span><script type="math/tex" id="MathJax-Element-172">k</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1037"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">k</span></span></span><script type="math/tex" id="MathJax-Element-173">k</script> can only change once, because after the first iteration with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">a</span><span class="MJXp-mo" id="MJXp-Span-1041" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">i</span><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1044" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">d</span></span></span><script type="math/tex" id="MathJax-Element-174">a[i] = d</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">k</span></span></span><script type="math/tex" id="MathJax-Element-175">k</script> is no longer divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">d</span></span></span><script type="math/tex" id="MathJax-Element-176">d</script>. Thus, the number of times <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">k</span></span></span><script type="math/tex" id="MathJax-Element-177">k</script> changes is bounded by the number of divisors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">k</span></span></span><script type="math/tex" id="MathJax-Element-178">k</script>.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Consider a particular query. We make the following two observations: first, the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">k</span></span></span><script type="math/tex" id="MathJax-Element-179">k</script> only changes if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">a</span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">i</span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-180">a[i]</script> is a divisor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1061"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">k</span></span></span><script type="math/tex" id="MathJax-Element-181">k</script>, and second, if there exists <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1063"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">a</span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1068" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">a</span><span class="MJXp-mo" id="MJXp-Span-1072" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1075" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1076" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-182">a[i_1] = a[i_2]</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">l</span><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1082" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1086" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">r</span></span></span><script type="math/tex" id="MathJax-Element-183">l\leq i_1 < i_2 \leq r</script>, then the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1089"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">k</span></span></span><script type="math/tex" id="MathJax-Element-184">k</script> will not change at <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">i</span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1096" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-185">i=i_2</script> (because after the iteration <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1097"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">i</span><span class="MJXp-mo" id="MJXp-Span-1099" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1102" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-186">i=i_1</script>, we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">k</span></span></span><script type="math/tex" id="MathJax-Element-187">k</script> is no longer divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">a</span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1110" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1111" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-188">a[i_2]</script>).</p><p>This allows us to bound the number of times <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">k</span></span></span><script type="math/tex" id="MathJax-Element-189">k</script> changes by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">d</span><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">k</span><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-190">d(k)</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">d</span><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">k</span><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-191">d(k)</script> is the number of divisors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">k</span></span></span><script type="math/tex" id="MathJax-Element-192">k</script>. Note that the divisors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">d</span><span class="MJXp-mo" id="MJXp-Span-1128" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">k</span><span class="MJXp-mo" id="MJXp-Span-1130" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-193">d(k)</script> can be found in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">O</span><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msqrt" id="MJXp-Span-1134"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">k</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-194">O(\sqrt{k})</script> time by checking if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">a</span></span></span><script type="math/tex" id="MathJax-Element-195">a</script> divides <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">k</span></span></span><script type="math/tex" id="MathJax-Element-196">k</script> for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">a</span></span></span><script type="math/tex" id="MathJax-Element-197">a</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1143"><span class="MJXp-mn" id="MJXp-Span-1144">2</span></span></span><script type="math/tex" id="MathJax-Element-198">2</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1145"><span class="MJXp-msqrt" id="MJXp-Span-1146"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">k</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-199">\sqrt{k}</script>, and if so, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">a</span></span></span><script type="math/tex" id="MathJax-Element-200">a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1150"><span class="MJXp-mfrac" id="MJXp-Span-1151" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">a</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-201">\frac{k}{a}</script> are both divisors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">k</span></span></span><script type="math/tex" id="MathJax-Element-202">k</script>. Furthermore, at the scale constrained by the problem bounds, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">d</span><span class="MJXp-mo" id="MJXp-Span-1158" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">k</span><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-203">d(k)</script> is around <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">O</span><span class="MJXp-mo" id="MJXp-Span-1163" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mroot" id="MJXp-Span-1164"><span class="MJXp-script" style="margin-right: -0.67em; vertical-align: 0.854em; margin-left: 0.27em;"><span class="MJXp-mn" id="MJXp-Span-1166">3</span></span><span><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">k</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1167" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-204">O(\sqrt[3]{k})</script>, so we only have to update <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">k</span></span></span><script type="math/tex" id="MathJax-Element-205">k</script> at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">O</span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mroot" id="MJXp-Span-1173"><span class="MJXp-script" style="margin-right: -0.67em; vertical-align: 0.854em; margin-left: 0.27em;"><span class="MJXp-mn" id="MJXp-Span-1175">3</span></span><span><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">k</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-206">O(\sqrt[3]{k})</script> times.</p><p>Now, we would like to find the first time each divisor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">k</span></span></span><script type="math/tex" id="MathJax-Element-207">k</script> appears in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">a</span><span class="MJXp-mo" id="MJXp-Span-1181" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">l</span><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">a</span><span class="MJXp-mo" id="MJXp-Span-1188" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">r</span><span class="MJXp-mo" id="MJXp-Span-1190" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-208">a[l], \dots, a[r]</script>. This can be done by storing the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">a</span></span></span><script type="math/tex" id="MathJax-Element-209">a</script> in a map, where each value is mapped to a vector of indices where that values appears. Then for a given divisor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">k</span></span></span><script type="math/tex" id="MathJax-Element-210">k</script>, we can use <code class="tt">lower_bound()</code> (or generally, binary search) to find the smallest index at or after <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">l</span></span></span><script type="math/tex" id="MathJax-Element-211">l</script> where this divisor appears, and we can check if it is no greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">r</span></span></span><script type="math/tex" id="MathJax-Element-212">r</script>.</p><p>Now, we have a list of indices at which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">k</span></span></span><script type="math/tex" id="MathJax-Element-213">k</script> might change. So, suppose that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">k</span></span></span><script type="math/tex" id="MathJax-Element-214">k</script> changes to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1203"><span class="MJXp-msup" id="MJXp-Span-1204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205" style="margin-right: 0.05em;">k</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1206" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-215">k'</script> at index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1207"><span class="MJXp-msubsup" id="MJXp-Span-1208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1210" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-216">i_1</script>, and then changes to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1211"><span class="MJXp-msup" id="MJXp-Span-1212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">k</span><span class="MJXp-mo" id="MJXp-Span-1214">″</span></span></span></span><script type="math/tex">k' '</script> at index <span class="MathJax_Preview">i_2</span><script type="math/tex">i_2</script> (and these are adjacent changes). Then we know that we have a value of <span class="MathJax_Preview">k'</span><script type="math/tex">k'</script> from <span class="MathJax_Preview">i=i_1</span><script type="math/tex">i=i_1</script> to <span class="MathJax_Preview">i_2-1</span><script type="math/tex">i_2-1</script>, so we can add <span class="MathJax_Preview">k' \cdot (i_2 - i_1)</span><script type="math/tex">k' \cdot (i_2 - i_1)</script> to <span class="MathJax_Preview">ans</span><script type="math/tex">ans</script>. We can then do this for all changes. This allows us to solve the problem in <span class="MathJax_Preview">O(n\log{n})</span><script type="math/tex">O(n\log{n})</script> preprocessing time and <span class="MathJax_Preview">O(\sqrt{k} + d(k)\log{n})</span><script type="math/tex">O(\sqrt{k} + d(k)\log{n})</script> time per query.</p><p>There are a few ways to optimize the runtime further, if your implementation is too slow. We can use a vector (of vectors) instead of a map, since <span class="MathJax_Preview">A = \max a_i = 10^5</span><script type="math/tex">A = \max a_i = 10^5</script> is reasonably small. Note that instantiating a vector of this size in every test case is too slow, so you may have to instantiate it globally and clear the vectors that were used after each test case.</p><p>Another optimization is to preprocess divisors instead of computing them on the spot. We can compute and store the divisors of all integers <span class="MathJax_Preview">2\leq a_i\leq 10^5</span><script type="math/tex">2\leq a_i\leq 10^5</script> in <span class="MathJax_Preview">O(A\log A)</span><script type="math/tex">O(A\log A)</script> time in a vector of vectors where <span class="MathJax_Preview">divisor[a_i]</span><script type="math/tex">divisor[a_i]</script> contains all divisors of <span class="MathJax_Preview">a_i</span><script type="math/tex">a_i</script> as follows: for all <span class="MathJax_Preview">2\leq i\leq A</span><script type="math/tex">2\leq i\leq A</script>, we push <span class="MathJax_Preview">i</span><script type="math/tex">i</script> into <span class="MathJax_Preview">divisors[j]</span><script type="math/tex">divisors[j]</script> for all multiples <span class="MathJax_Preview">j</span><script type="math/tex">j</script> of <span class="MathJax_Preview">i</span><script type="math/tex">i</script>. (The runtime follows from the fact that there are <span class="MathJax_Preview">\lfloor\frac{A}{i}\rfloor</span><script type="math/tex">\lfloor\frac{A}{i}\rfloor</script> multiples of <span class="MathJax_Preview">i</span><script type="math/tex">i</script> which are at most <span class="MathJax_Preview">A</span><script type="math/tex">A</script>, so across all <span class="MathJax_Preview">i</span><script type="math/tex">i</script>, we have at most <span class="MathJax_Preview">\frac{A}{1} + \frac{A}{2} + \cdots + \frac{A}{A} = A(\frac{1}{1} + \cdots + \frac{1}{A}) = AH(A) = O(A\log A)</span><script type="math/tex">\frac{A}{1} + \frac{A}{2} + \cdots + \frac{A}{A} = A(\frac{1}{1} + \cdots + \frac{1}{A}) = AH(A) = O(A\log A)</script> computations). This allows us to remove the <span class="MathJax_Preview">\sqrt{k}</span><script type="math/tex">\sqrt{k}</script> term in the runtime of each query. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> vector</span><span class="str">&lt;int&gt;</span><span class="pun">&gt;</span><span class="pln"> pos</span><span class="pun">;</span><span class="pln">
    map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> ptr</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> arr</span><span class="pun">[</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        pos</span><span class="pun">[</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
        ptr</span><span class="pun">[</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    vector</span><span class="pun">&lt;</span><span class="pln">tuple</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;&gt;</span><span class="pln"> qr</span><span class="pun">(</span><span class="pln">q</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;[</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">]:</span><span class="pln"> qr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> v </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
        i </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">++;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> anss</span><span class="pun">(</span><span class="pln">q</span><span class="pun">);</span><span class="pln">
    sort</span><span class="pun">(</span><span class="pln">qr</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> qr</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> prevL </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> idd</span><span class="pun">]:</span><span class="pln"> qr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> prevL</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> l</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            ptr</span><span class="pun">[</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]]++;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        prevL </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">;</span><span class="pln">
        vector</span><span class="pun">&lt;</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;&gt;</span><span class="pln"> facts</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> v</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v </span><span class="pun">%</span><span class="pln"> i </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">int</span><span class="pln"> fact1 </span><span class="pun">=</span><span class="pln"> v </span><span class="pun">/</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!(</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">fact1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ptr</span><span class="pun">[</span><span class="pln">fact1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">fact1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">fact1</span><span class="pun">][</span><span class="pln">ptr</span><span class="pun">[</span><span class="pln">fact1</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> r </span><span class="pun">||</span><span class="pln"> fact1 </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    facts</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">({</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">fact1</span><span class="pun">][</span><span class="pln">ptr</span><span class="pun">[</span><span class="pln">fact1</span><span class="pun">]],</span><span class="pln"> fact1</span><span class="pun">});</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
                </span><span class="kwd">int</span><span class="pln"> fact2 </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">fact2 </span><span class="pun">==</span><span class="pln"> fact1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!(</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">fact2</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ptr</span><span class="pun">[</span><span class="pln">fact2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">fact2</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">fact2</span><span class="pun">][</span><span class="pln">ptr</span><span class="pun">[</span><span class="pln">fact2</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> r </span><span class="pun">||</span><span class="pln"> fact2 </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    facts</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">({</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">fact2</span><span class="pun">][</span><span class="pln">ptr</span><span class="pun">[</span><span class="pln">fact2</span><span class="pun">]],</span><span class="pln"> fact2</span><span class="pun">});</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        sort</span><span class="pun">(</span><span class="pln">facts</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> facts</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> pr </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">idx</span><span class="pun">,</span><span class="pln"> val</span><span class="pun">]:</span><span class="pln"> facts</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> rr </span><span class="pun">=</span><span class="pln"> idx </span><span class="pun">-</span><span class="pln"> pr</span><span class="pun">;</span><span class="pln">
            ans </span><span class="pun">+=</span><span class="pln"> v </span><span class="pun">*</span><span class="pln"> rr</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v </span><span class="pun">%</span><span class="pln"> val </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> v </span><span class="pun">/=</span><span class="pln"> val</span><span class="pun">;</span><span class="pln">
            pr </span><span class="pun">=</span><span class="pln"> idx</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">facts</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">())</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> v </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> ans </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> pr </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
        anss</span><span class="pun">[</span><span class="pln">idd</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> anss</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10009">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="227">227</span>
            </i>
        </a>
    </span>


 Good Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10010">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="35">35</span>
            </i>
        </a>
    </span>


 Okay Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10011">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="13">13</span>
            </i>
        </a>
    </span>


 Bad Problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10012">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="114">114</span>
            </i>
        </a>
    </span>


 Didn't Solve</li> </ul></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2094" class="notice" style="text-decoration: none;">Codeforces Round 1017 (Div. 4)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>