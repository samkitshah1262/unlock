<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/149003" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>The harder 4 problems are from the Yandex Cup Finals.</p> <div><h3><a href="https://codeforces.com/contest/2175/problem/A" title="Codeforces Round 1069 (Div. 2)">2175A - Little Fairy's Painting</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's first find out the color of the $$$(n+1)$$$-st cell. As per the statement, it is the number of distinct elements in the given array $$$a$$$. We can compute that by directly, or by sorting the array, or using a set. Let this number of $$$d$$$, it is the color of the $$$(n + 1)$$$-st cell.</p><p>What happens next? If this color is already in the array, then nothing changes, and each next color will be $$$d$$$. If $$$d$$$ was not present in the array initially, then it's a new color, and the color of the $$$(n + 2)$$$-nd cell becomes $$$d + 1$$$, then $$$d + 2$$$, and so on, until it coincides with an existing color. At that point, the number of distinct colors does not increase, and all further cells will be colored in the same color. This will always happen at some point, because $$$\max(a) \ge \operatorname{distinct}(a)$$$.</p><p>Thus, the answer is the smallest number present in the original array that is greater than or equal to the number of distinct colors.</p></div></div></div></div> <div><h3><a href="https://codeforces.com/contest/2175/problem/B" title="Codeforces Round 1069 (Div. 2)">2175B - XOR Array</a></h3><div class="ttypography"><div class="problem-statement"><div><p>When talking about XOR of a subsegment, it's usually useful to think about prefix XORs. Then, if $$$b_i = a_1 \oplus a_2 \oplus \ldots \oplus a_i$$$ is the array or prefix XORs, the subsegment XOR $$$f$$$ is simply $$$f(x, y) = b_y \oplus b_{x-1}$$$. That means, for $$$f(l, r)$$$ to be zero, $$$b_{l - 1}$$$ has to be equal to $$$b_r$$$, while all other values of $$$b$$$ should be distinct. The easiest construction is then $$$b_i = i$$$, with the exception that $$$b_r = l - 1$$$. The array $$$a$$$ can be then reconstructed as $$$a_i = b_i \oplus b_{i - 1}$$$.</p></div></div></div></div> <div><h3><a href="https://codeforces.com/contest/2174/problem/A" title="Codeforces Round 1069 (Div. 1)">2174A - Иголка в стоге сена</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's first extract from $$$t$$$ all letters that are needed to build $$$s$$$, and sort all the others to get the string $$$t'$$$. If there are not enough letters to build $$$s$$$, the answer is <span class="tex-font-style-tt">Impossible</span>.</p><p>Then, it turns out that the greedy algorithm works: we can simply build the resulting string letter by letter, each time taking the smallest of the first letter s from $$$s$$$ and $$$t'$$$, and preferring taking from $$$s$$$ if they are equal. In other words, this is the standard "merge" algorithm, even though $$$s$$$ is not sorted.</p><p>The proof is as follows. Consider one step, let $$$x$$$ be the front letter in $$$s$$$, and $$$y$$$ be the front letter in $$$t'$$$. $$$$$$ \begin{align} s &amp;= \mathrm{x...}, \\ t' &amp;= \mathrm{y...}. \end{align} $$$$$$ If $$$x \ne y$$$, it's obvious why our algorithm works: it's clear that we can always finish the resulting string no matter what we take, and thus we can follow the greedy algorithm to obtain the lexmin answer. If $$$x = y$$$, we have to look at the first position where the remaining parts of $$$s$$$ and $$$t'$$$ differ, let the corresponding letters be $$$z$$$ and $$$w$$$: $$$$$$ \begin{align} s &amp;= \mathrm{xxxxz...}, \\ t' &amp;= \mathrm{xxxxw...}. \end{align} $$$$$$ </p><ul> <li> If both are greater than $$$x$$$, then it does not matter from which string to take, as we'll take all letters equal to $$$x$$$ prior to both $$$z$$$ and $$$w$$$. </li><li> If $$$z &lt; x &lt;= w$$$, then it's better to take from $$$s$$$, as we'll reach the smaller letter earlier. </li><li> $$$w &lt; x$$$ can't be, because $$$t'$$$ is sorted. </li></ul> This ends the proof.</div></div></div></div> <div><h3><a href="https://codeforces.com/contest/2174/problem/B" title="Codeforces Round 1069 (Div. 1)">2174B - Wishing Cards</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's start with some simple dynamic programming solution. As we go through the friends left to right, what is important for us to continue? It is how many elements we've chosen <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">i</script>, their sum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">s</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">s</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">s</script>, their maximum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-7"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">m</script>, and the current happiness of Little A <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">h</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-10"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">h</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">h</script>. As usual, of these four numbers, three have to be the DP parameters, and one has to be the DP result. The most natural choice is <span class="tex-font-style-tt">dp[i][s][m] -&gt; max h</span>. The transitions are trivial: loop through <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-msubsup" id="MJXp-Span-10"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-12" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">i</span><span class="MJXp-mo" id="MJXp-Span-14">+</span><span class="MJXp-mn" id="MJXp-Span-15">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-13"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-14"><span class="msubsup" id="MathJax-Span-15"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="texatom" id="MathJax-Span-17"><span class="mrow" id="MathJax-Span-18"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-20" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-21" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">b_{i + 1}</script>, and update <span class="tex-font-style-tt">dp[i + 1]</span> accordingly. This is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">O</span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">n</span><span class="MJXp-msubsup" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-22" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-22"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-27"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.544em;"><span class="mn" id="MathJax-Span-29" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">O(nk^3)</script> solution which is quite slow.</p><p>We need to add two optimizations. The first one is to get rid of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-31"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">n</script> factor. This is quite easy: if you want to use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-msubsup" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-29" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-35"><span class="msubsup" id="MathJax-Span-36"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-38" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">b_i = x</script> at some point, you'd put is as early as possible, i.e. at the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-32"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-42"><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">i</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-34"><span class="MJXp-msubsup" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-37" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-44"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-45"><span class="msubsup" id="MathJax-Span-46"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">a_i \ge x</script>. This means that from the whole array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">a</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-52"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">a</script> we only need the prefix maxima, which leaves us with an array of length at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-42"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">k</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-54"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-55"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">k</script>.</p><p>The second optimization is to get rid of linear transitions. Instead, we can do the backward-looking dp, and compute <span class="tex-font-style-tt">dp[i][s][m]</span> as <span class="tex-font-style-tt">max(dp[i - 1][s][m], dp[i - 1][s - m][t])</span>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-44"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">t</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-57"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">t</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">t</script> is arbitrary. To choose this maximum, no loop is needed, as we can precompute this for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-46"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">s</span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-60"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-61"><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">s - m</script>.</p><p>The final complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">O</span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">n</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-55"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-57" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-65"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-66"><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="msubsup" id="MathJax-Span-71" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.544em;"><span class="mn" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">O(n + k^3)</script>.</p></div></div></div></div> <div><h3><a href="https://codeforces.com/contest/2174/problem/C2" title="Codeforces Round 1069 (Div. 1)">2174C2 - Красивые узоры (сложная версия)</a></h3><div class="ttypography"><div class="problem-statement"><div><p>We need to calculate $$$\mathbb{E}[f^2]$$$. Let's see what $$$f$$$ is — it is the number of non-empty palindromic substrings, that is, $$$f = \sum x_{l,r}$$$ over all non-empty substrings $$$[l,r]$$$, where $$$x_{l,r}$$$ is an indicator variable that corresponds to the substring $$$[l,r]$$$ being a palindrome.</p><p>Thus, $$$\mathbb{E}[f^2] = \mathbb{E}[\sum^2 x_{l,r}] = \mathbb{E}[\sum x_{l,r}^2 + 2\sum x_{l_1,r_1} \cdot x_{l_2,r_2}] = \mathbb{E}[\sum x_{l,r}] + 2\mathbb{E}[\sum x_{l_1,r_1} \cdot x_{l_2,r_2}]$$$. Next, we need to learn how to calculate $$$\mathbb{E}[x_{l,r}]$$$. The probability that a string of length $$$s$$$ is a palindrome is the probability that the first $$$(s+1)/2$$$ letters are arbitrary, while the rest are determined (that is, $$${\frac {m^{(s+1)/2}}{m^s}}$$$).</p><p>Now we need to calculate $$$\mathbb{E}[x_{l_1,r_1} \cdot x_{l_2,r_2}]$$$, which is the probability that both substrings are palindromes simultaneously. If they are concentric (have the same center and parity), then the answer is also obvious — it is simply the probability for the longer of the two strings. If they are not concentric, it is claimed$$$^*$$$ that the events "substring is a palindrome" are independent for these two strings. Therefore, $$$\mathbb{E}[x_{l_1,r_1} \cdot x_{l_2,r_2}] = \frac{m^{(s_1 + 1)/2 + (s_2 + 1)/2}}{m^{s_1 + s_2}}$$$.</p><p>Thus, we need to separately analyze the cases when the substrings have the same centers and when they do not. Then the solution for the fourth degree can be written obviously (by iterating through all pairs of substrings). To obtain a solution that passes the first subtask, it is sufficient to optimize the enumeration somehow. For example, for the case of concentric strings, we can iterate only over the length of the longer string, and for the case of non-concentric strings, we can iterate over their lengths and multiply the probability by the number of pairs of non-concentric substrings with those lengths. This results in a solution with a complexity of $$$O(n^2)$$$.</p><p>To achieve a solution with a complexity of $$$O(n)$$$, it is sufficient to notice the following: when we calculate the answer for non-concentric substrings, we compute $$$\sum 1/m^{s_1 - (s_1 + 1) / 2 + s_2 - (s_2 + 1) / 2}=\sum m ^ {-(s_1/2 + s_2/2)}$$$. If we fix the parities of $$$s_1$$$ and $$$s_2$$$, it will be enough to iterate simply over $$$s = s_1 + s_2$$$ and multiply $$$m ^ {-(s/2 - flag)} $$$ by the number of pairs of non-concentric substrings with a total length of $$$s$$$, where $$$flag$$$ is equal to one if and only if both strings have an odd length.</p><p>It remains to prove *: if the strings do not intersect, then the statement is obvious. Let them intersect and the length of the intersection be $$$len$$$. Any point in the intersection subsegment has two symmetric points: one relative to the center of the first string, and the other relative to the center of the second. Moreover, these points are always distinct because the strings are not concentric; furthermore, all such pairs of points do not intersect with each other. Thus, if we have assigned $$$(s_1 + 1)/2$$$ symbols in the first string arbitrarily, then in the second we can only choose $$$(s_2 + 1)/2 - len$$$, because $$$len$$$ symbols are already automatically determined. Therefore, the probability for these two strings will be equal to $$$ \frac{m^{(s_1 + 1)/2 + (s_2 + 1)/2 - len}}{m^{s_1 + s_2 - len}} = \frac{m^{(s_1 + 1)/2 + (s_2 + 1)/2}}{m^{s_1 + s_2}}$$$ — which is what we needed to prove.</p></div></div></div></div> <div><h3><a href="https://codeforces.com/contest/2174/problem/D" title="Codeforces Round 1069 (Div. 1)">2174D - Secret Message</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's sort the edges by weight and take the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">n</span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-62">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-75"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-76"><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">n - 1</script> of them. In case they already do not form a spanning tree, we are done. Otherwise, they form a spanning tree, let's call it <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">T</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-81"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">T</script>. Denote the sum of their weights <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">S</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-83"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">S</script>.</p><p>Let's consider a case when the answer is formed by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">n</span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-70">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-86"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-90" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">n - 2</script> edges from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">T</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-91"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">T</script>, plus one extra edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">e</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-94"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-95"><span class="mi" id="MathJax-Span-96" style="font-family: MathJax_Math-italic;">e</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">e</script>, which isn't present in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-75"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">T</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-97"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-98"><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">T</script>. Fix this edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">e</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-100"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-101"><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math-italic;">e</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">e</script>. Let's call the edges from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">T</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-103"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">T</script>, which form a cycle joined with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">e</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-106"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-107"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-italic;">e</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">e</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">e</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-109"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-110"><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic;">e</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">e</script>'s fundamental cycle. We need to remove an edge from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">T</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-112"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">T</script> that doesn't belong to that fundamental cycle. In this case, the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-87"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">S</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">w</span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">e</span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-95"><span class="MJXp-mi" id="MJXp-Span-96">m</span><span class="MJXp-mi" id="MJXp-Span-97">x</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-115"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-116"><span class="mi" id="MathJax-Span-117" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">w</span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="texatom" id="MathJax-Span-124" style="padding-left: 0.219em;"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Main;">x</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">S + w(e) - \mathrm{mx}</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-98"><span class="MJXp-mrow" id="MJXp-Span-99"><span class="MJXp-mi" id="MJXp-Span-100">m</span><span class="MJXp-mi" id="MJXp-Span-101">x</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-128"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-129"><span class="texatom" id="MathJax-Span-130"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Main;">x</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">\mathrm{mx}</script> is the maximum weight of edges of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">T</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-134"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-135"><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">T</script> out of a given path (connecting the endpoints of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">e</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-137"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-138"><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Math-italic;">e</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">e</script>).</p><p>There are several ways to answer these queries "maximum weight of edges out of a given path". The easiest to come up with is to use heavy-light decomposition. To discard a path, one needs to subtract infinity on the path, and then to answer a query it suffices to take the global maximum. There is also another way to answer these queries. Consider a maximum edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-106"><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">u</span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">v</span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">w</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-140"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-141"><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-143" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-144" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">v</span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-147" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">w</span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">(u, v, w)</script> of the tree. In case the given path doesn't contain that edge, the maximum out of the path is clearly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">w</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-149"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-family: MathJax_Math-italic;">w</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">w</script>. Otherwise, the given path passes through the edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-116"><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">u</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">v</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-152"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-153"><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">v</span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">(u, v)</script>, and we can cut the tree at it. In that way, one obtains two independent problems of finding the maximum of edges out of a given path from the root (which is either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">u</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">u</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">v</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-162"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">v</script>). The answers to these queries could be precalculated (let's traverse the tree twice, visiting children of a vertex in a reversed order the second time, and maintain the maximum of edges that are already visited).</p><p>It remains to deal with the case when the answer differs from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">T</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-165"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">T</script> by more than one edge. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-msubsup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">w</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-131" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-132" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-137" style="vertical-align: -0.4em;">m</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-168"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-169"><span class="msubsup" id="MathJax-Span-170"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mn" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main; padding-left: 0.273em;">…</span><span class="mo" id="MathJax-Span-175" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="msubsup" id="MathJax-Span-176" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.41em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-178" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">w_1 \le \ldots \le w_m</script> be the weights of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-138"><span class="MJXp-msubsup" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140" style="margin-right: 0.05em;">e</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-141" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-142" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-147" style="vertical-align: -0.4em;">m</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-179"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-180"><span class="msubsup" id="MathJax-Span-181"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mn" id="MathJax-Span-183" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="msubsup" id="MathJax-Span-187" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">e_1, \ldots, e_m</script> correspondingly. Since we need to exchange two edges, the answer is at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">S</span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-153" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">n</span><span class="MJXp-mo" id="MJXp-Span-155">−</span><span class="MJXp-mn" id="MJXp-Span-156">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-160" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">n</span><span class="MJXp-mo" id="MJXp-Span-162">−</span><span class="MJXp-mn" id="MJXp-Span-163">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-167" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-172" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">n</span><span class="MJXp-mo" id="MJXp-Span-174">+</span><span class="MJXp-mn" id="MJXp-Span-175">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-190"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-191"><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="msubsup" id="MathJax-Span-194" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="texatom" id="MathJax-Span-196"><span class="mrow" id="MathJax-Span-197"><span class="mi" id="MathJax-Span-198" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-199" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-200" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-201" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="msubsup" id="MathJax-Span-202" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="texatom" id="MathJax-Span-204"><span class="mrow" id="MathJax-Span-205"><span class="mi" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-207" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-208" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="msubsup" id="MathJax-Span-210" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="texatom" id="MathJax-Span-212"><span class="mrow" id="MathJax-Span-213"><span class="mi" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="msubsup" id="MathJax-Span-216" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="texatom" id="MathJax-Span-218"><span class="mrow" id="MathJax-Span-219"><span class="mi" id="MathJax-Span-220" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-222" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">S - w_{n-1} - w_{n-2} + w_{n} + w_{n+1}</script>. Let's show that this estimate is always achievable. Note that both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-176"><span class="MJXp-msubsup" id="MJXp-Span-177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-179" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">n</span><span class="MJXp-mo" id="MJXp-Span-181">−</span><span class="MJXp-mn" id="MJXp-Span-182">2</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-223"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-224"><span class="msubsup" id="MathJax-Span-225"><span style="display: inline-block; position: relative; width: 1.897em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">e_{n-2}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-183"><span class="MJXp-msubsup" id="MJXp-Span-184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-186" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">n</span><span class="MJXp-mo" id="MJXp-Span-188">−</span><span class="MJXp-mn" id="MJXp-Span-189">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-232"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-233"><span class="msubsup" id="MathJax-Span-234"><span style="display: inline-block; position: relative; width: 1.897em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-236"><span class="mrow" id="MathJax-Span-237"><span class="mi" id="MathJax-Span-238" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-239" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-240" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">e_{n-1}</script> are present in the fundamental cycles of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-190"><span class="MJXp-msubsup" id="MJXp-Span-191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-193" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-241"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-242"><span class="msubsup" id="MathJax-Span-243"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-245" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">e_n</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-194"><span class="MJXp-msubsup" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-197" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">n</span><span class="MJXp-mo" id="MJXp-Span-199">+</span><span class="MJXp-mn" id="MJXp-Span-200">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-247"><span class="msubsup" id="MathJax-Span-248"><span style="display: inline-block; position: relative; width: 1.897em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-250"><span class="mrow" id="MathJax-Span-251"><span class="mi" id="MathJax-Span-252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-253" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">e_{n+1}</script> (otherwise, it is possible to achieve <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">S</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-206" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">n</span><span class="MJXp-mo" id="MJXp-Span-208">−</span><span class="MJXp-mn" id="MJXp-Span-209">1</span><span class="MJXp-mtext" id="MJXp-Span-210">&nbsp;or&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">n</span><span class="MJXp-mo" id="MJXp-Span-212">−</span><span class="MJXp-mn" id="MJXp-Span-213">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-217" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">n</span><span class="MJXp-mtext" id="MJXp-Span-219">&nbsp;or&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">n</span><span class="MJXp-mo" id="MJXp-Span-221">+</span><span class="MJXp-mn" id="MJXp-Span-222">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-45-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-255"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-256"><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="msubsup" id="MathJax-Span-259" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 4.44em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="texatom" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mi" id="MathJax-Span-263" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-264" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-265" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mtext" id="MathJax-Span-266" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;or&nbsp;</span><span class="mi" id="MathJax-Span-267" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-268" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-269" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="msubsup" id="MathJax-Span-271" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 3.52em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="texatom" id="MathJax-Span-273"><span class="mrow" id="MathJax-Span-274"><span class="mi" id="MathJax-Span-275" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mtext" id="MathJax-Span-276" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;or&nbsp;</span><span class="mi" id="MathJax-Span-277" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-278" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-279" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">S - w_{n - 1\text{ or }n-2} + w_{n\text{ or }n+1}</script>, which is good enough). Therefore, one could replace both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-223"><span class="MJXp-msubsup" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-226" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">n</span><span class="MJXp-mo" id="MJXp-Span-228">−</span><span class="MJXp-mn" id="MJXp-Span-229">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-46-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-280"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-281"><span class="msubsup" id="MathJax-Span-282"><span style="display: inline-block; position: relative; width: 1.897em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-284"><span class="mrow" id="MathJax-Span-285"><span class="mi" id="MathJax-Span-286" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-287" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-288" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">e_{n-1}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-msubsup" id="MJXp-Span-231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-233" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">n</span><span class="MJXp-mo" id="MJXp-Span-235">−</span><span class="MJXp-mn" id="MJXp-Span-236">2</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-47-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-289"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-290"><span class="msubsup" id="MathJax-Span-291"><span style="display: inline-block; position: relative; width: 1.897em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-293"><span class="mrow" id="MathJax-Span-294"><span class="mi" id="MathJax-Span-295" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-296" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-297" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">e_{n-2}</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-237"><span class="MJXp-msubsup" id="MJXp-Span-238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-240" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-48-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-298"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-299"><span class="msubsup" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-302" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">e_n</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-241"><span class="MJXp-msubsup" id="MJXp-Span-242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-244" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">n</span><span class="MJXp-mo" id="MJXp-Span-246">+</span><span class="MJXp-mn" id="MJXp-Span-247">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-49-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-303"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-304"><span class="msubsup" id="MathJax-Span-305"><span style="display: inline-block; position: relative; width: 1.897em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="mi" id="MathJax-Span-309" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">e_{n+1}</script>, which solves the problem.</p></div></div></div></div> <div><h3><a href="https://codeforces.com/contest/2174/problem/E2" title="Codeforces Round 1069 (Div. 1)">2174E2 - Игра учёных (версия 2)</a></h3><div class="ttypography"><div class="problem-statement"><div><p>One important idea: if we know the sum of digits of number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-50-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-312"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-313"><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">x</script> in base <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">b</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-51-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-315"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-316"><span class="mi" id="MathJax-Span-317" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">b</script>, we know <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">x</span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mo" id="MJXp-Span-255" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">b</span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-258">1</span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-52-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-318"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-319"><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main; padding-left: 0.273em; padding-right: 0.273em;">mod</span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-325" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-326" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">x \bmod (b - 1)</script>. So, after some queries we will know remainders of the secret number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-53-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-327"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-328"><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">x</script> by some modulos, which could be combined into one modulo with CRT (Chineese Remainders Theorem).</p><p>Let's define the following function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">f</span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">m</span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">k</span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-54-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-330"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-331"><span class="mi" id="MathJax-Span-332" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-335" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">k</span><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">f(m, k)</script> — the maximum number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">d</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-55-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-338"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-339"><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">d</script>, such that the numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">r</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">r</span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">m</span><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">r</span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-280">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">m</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">r</span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-56-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-341"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-342"><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">m</span><span class="mo" id="MathJax-Span-348" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-351" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-353" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-354" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-56">r, r+m, r+2m, \ldots, r + dm</script> can be distinguished with at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">k</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-57-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-360"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-361"><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">k</script> queries for any possible remainder <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-291"><span class="MJXp-mn" id="MJXp-Span-292">0</span><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">r</span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-58-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-363"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-364"><span class="mn" id="MathJax-Span-365" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">r</span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">0 \leq r < m</script>. The remainder is unknown and is not a function parameter, we should be able to distinguish for any possible remainder value. One more important detail: if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">m</span><span class="MJXp-mo" id="MJXp-Span-299" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-300">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-59-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-370"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-371"><span class="mi" id="MathJax-Span-372" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-373" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-374" style="font-family: MathJax_Main; padding-left: 0.273em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-59">m = 1</script> and the first number is less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-301"><span class="MJXp-mn" id="MJXp-Span-302">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-60-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-375"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-376"><span class="mn" id="MathJax-Span-377" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-60">1</script>, we do not consider it, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">m</span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-306">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-61-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-379"><span class="mi" id="MathJax-Span-380" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-381" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mn" id="MathJax-Span-382" style="font-family: MathJax_Main; padding-left: 0.273em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">m \geq 2</script> and the first number is less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-307"><span class="MJXp-mn" id="MJXp-Span-308">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-62-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-383"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-384"><span class="mn" id="MathJax-Span-385" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">2</script>, we do not consider it.</p><p>Let's make the following observations:</p><ul> <li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">f</span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-312">1</span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-314">1</span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-317">3</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-63-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-386"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-387"><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-389" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-390" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-391" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-392" style="font-family: MathJax_Main; padding-left: 0.165em;">1</span><span class="mo" id="MathJax-Span-393" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-395" style="font-family: MathJax_Main; padding-left: 0.273em;">3</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-63">f(1, 1) = 3</script>, because we can distinguish <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-318"><span class="MJXp-mn" id="MJXp-Span-319">1</span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-321">2</span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-323">3</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-64-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-396"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-397"><span class="mn" id="MathJax-Span-398" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-400" style="font-family: MathJax_Main; padding-left: 0.165em;">2</span><span class="mo" id="MathJax-Span-401" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-402" style="font-family: MathJax_Main; padding-left: 0.165em;">3</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-64">1, 2, 3</script> by asking <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">b</span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-327">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-65-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-403"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-404"><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-406" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-407" style="font-family: MathJax_Main; padding-left: 0.273em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">b=2</script>.</li><li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">f</span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">m</span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-333">1</span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">m</span><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-338">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-66-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-408"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-409"><span class="mi" id="MathJax-Span-410" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-412" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-413" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-414" style="font-family: MathJax_Main; padding-left: 0.165em;">1</span><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-416" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">m</span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-419" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">f(m, 1) = m + 1</script>, because we can distinguish <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">r</span><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">r</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">m</span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">r</span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-348">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">m</span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">r</span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">m</span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-358">1</span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-67-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-420"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-423" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-425" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">m</span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-429" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-430" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span><span class="mi" id="MathJax-Span-431" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-432" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-433" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mo" id="MathJax-Span-437" style="font-family: MathJax_Main; padding-left: 0.219em;">(</span><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-440" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-67">r, r + m, r + 2m, \ldots, r + (m+1)\cdot m</script> by asking <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">m</span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-365">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-68-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-445"><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-447" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-448" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-68">m+2</script>.<p>Proof. We will know that the number is less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">m</span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-369">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-69-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-449"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-450"><span class="mi" id="MathJax-Span-451" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-452" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-453" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-69">m+2</script>, or the remainder by modulo <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">m</span><span class="MJXp-mo" id="MJXp-Span-372" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-373">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-70-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-454"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-455"><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-458" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-70">m+1</script>. Let's note, that at most one number in the sequence is less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">m</span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-377">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-71-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-459"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-460"><span class="mi" id="MathJax-Span-461" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-462" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-463" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-71">m+2</script> (because if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">r</span><span class="MJXp-mo" id="MJXp-Span-380" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-381">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-72-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-464"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-465"><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-467" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mn" id="MathJax-Span-468" style="font-family: MathJax_Main; padding-left: 0.273em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">r \geq 2</script>, than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">r</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">m</span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">m</span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-389">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-73-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-470"><span class="mi" id="MathJax-Span-471" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-472" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">m</span><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mi" id="MathJax-Span-475" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">m</span><span class="mo" id="MathJax-Span-476" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-477" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-73">r+m \geq m + 2</script>, otherwise if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">r</span><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-393">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-74-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-478"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-479"><span class="mi" id="MathJax-Span-480" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-481" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mn" id="MathJax-Span-482" style="font-family: MathJax_Main; padding-left: 0.273em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">r < 2</script>, the first number in the sequence is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">r</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-75-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-483"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-484"><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-486" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-487" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-75">r+m</script>, the second is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">r</span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-401">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">m</span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">m</span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-406">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-76-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-488"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-489"><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-491" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-492" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-494" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mi" id="MathJax-Span-495" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">m</span><span class="mo" id="MathJax-Span-496" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-497" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">r+2m \geq m+2</script>. All other numbers have different remainders by modulo <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">m</span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-410">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-77-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-498"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-501" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-502" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-77">m+1</script>, because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">m</span><span class="MJXp-mo" id="MJXp-Span-413" style="margin-left: 0.333em; margin-right: 0.333em;">≡</span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-415">1</span><span class="MJXp-mspace" id="MJXp-Span-416" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">m</span><span class="MJXp-mo" id="MJXp-Span-420" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-421">1</span><span class="MJXp-mo" id="MJXp-Span-422" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-78-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-503"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-506" style="font-family: MathJax_Main; padding-left: 0.273em;">≡</span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main; padding-left: 0.273em;">−</span><span class="mn" id="MathJax-Span-508" style="font-family: MathJax_Main;">1</span><span class="mspace" id="MathJax-Span-509" style="height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main; padding-left: 0.273em; padding-right: 0.273em;">mod</span><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-514" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-78">m \equiv -1 \, (\bmod m + 1)</script>.</p></li><li> Let's calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">f</span><span class="MJXp-mo" id="MJXp-Span-425" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">m</span><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">k</span><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-79-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-516"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-517"><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-521" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-522" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">k</span><span class="mo" id="MathJax-Span-523" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">f(m, k)</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">k</span><span class="MJXp-mo" id="MJXp-Span-432" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-433">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-80-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-524"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mn" id="MathJax-Span-528" style="font-family: MathJax_Main; padding-left: 0.273em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-80">k \geq 2</script>.<p>Let's define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">s</span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">f</span><span class="MJXp-mo" id="MJXp-Span-438" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">m</span><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">k</span><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-443">1</span><span class="MJXp-mo" id="MJXp-Span-444" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-81-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-529"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-530"><span class="mi" id="MathJax-Span-531" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-532" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-533" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-535" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-536" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-537" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">k</span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-539" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-540" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-81">s = f(m, k - 1)</script>. Let's ask <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">b</span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">s</span><span class="MJXp-mo" id="MJXp-Span-450" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-451">1</span><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-82-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-541"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-542"><span class="mi" id="MathJax-Span-543" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-544" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mo" id="MathJax-Span-545" style="font-family: MathJax_Main; padding-left: 0.273em;">(</span><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-548" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-549" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">b = (s + 1) m</script>. As a result, we will know that the number is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-454"><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">s</span><span class="MJXp-mo" id="MJXp-Span-458" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-459">1</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-83-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-551"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-552"><span class="mo" id="MathJax-Span-553" style="font-family: MathJax_Main;">&lt;</span><span class="mo" id="MathJax-Span-554" style="font-family: MathJax_Main; padding-left: 0.273em;">(</span><span class="mi" id="MathJax-Span-555" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-556" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-557" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-558" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">< (s + 1)m</script>, or the remainder by modulo <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-462"><span class="MJXp-mtext" id="MJXp-Span-463">mod</span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">s</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-468">1</span><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">m</span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-472">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-84-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-560"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-561"><span class="mtext" id="MathJax-Span-562" style="font-family: MathJax_Main;">mod</span><span class="mo" id="MathJax-Span-563" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main; padding-left: 0.273em;">(</span><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-567" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-568" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-569" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-570" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-571" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-84">\text{mod} = (s + 1)m - 1</script>. If the number is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-473"><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">s</span><span class="MJXp-mo" id="MJXp-Span-477" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-478">1</span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-85-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-572"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-573"><span class="mo" id="MathJax-Span-574" style="font-family: MathJax_Main;">&lt;</span><span class="mo" id="MathJax-Span-575" style="font-family: MathJax_Main; padding-left: 0.273em;">(</span><span class="mi" id="MathJax-Span-576" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-577" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-578" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-580" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-85">< (s + 1)m</script>, we can find it in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">k</span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-484">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-86-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-581"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-582"><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-585" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-86">k-1</script> queries by definition of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">f</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-87-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-586"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-587"><span class="mi" id="MathJax-Span-588" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">f</script>, because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">s</span><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">f</span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">m</span><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">k</span><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-496">1</span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-88-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-589"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-590"><span class="mi" id="MathJax-Span-591" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-592" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-594" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-596" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-597" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">k</span><span class="mo" id="MathJax-Span-598" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-599" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-88">s = f(m, k - 1)</script>. Otherwise, by CRT we now know the remainder of the number by modulo <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-498"><span class="MJXp-mtext" id="MJXp-Span-499">mod</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-89-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-601"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-602"><span class="mtext" id="MathJax-Span-603" style="font-family: MathJax_Main;">mod</span><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-89">\text{mod} \cdot m</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-502"><span class="MJXp-mtext" id="MJXp-Span-503">mod</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-90-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-606"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-607"><span class="mtext" id="MathJax-Span-608" style="font-family: MathJax_Main;">mod</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">\text{mod}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-91-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-609"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-610"><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-91">m</script> are co-prime). So, we can distinguish numbers up to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-506"><span class="MJXp-mtext" id="MJXp-Span-507">mod</span><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">m</span><span class="MJXp-mo" id="MJXp-Span-510" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">f</span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-513">mod</span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">m</span><span class="MJXp-mo" id="MJXp-Span-516" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">k</span><span class="MJXp-mo" id="MJXp-Span-518" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-519">1</span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-92-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-612"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-613"><span class="mtext" id="MathJax-Span-614" style="font-family: MathJax_Main;">mod</span><span class="mo" id="MathJax-Span-615" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">m</span><span class="mo" id="MathJax-Span-617" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mi" id="MathJax-Span-618" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-619" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-620" style="font-family: MathJax_Main;">mod</span><span class="mo" id="MathJax-Span-621" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mi" id="MathJax-Span-622" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">m</span><span class="mo" id="MathJax-Span-623" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">k</span><span class="mo" id="MathJax-Span-625" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-626" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-627" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-92">\text{mod} \cdot m \cdot f(\text{mod} \cdot m, k - 1)</script>.</p><p>So, we get the following formula:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">f</span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">m</span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">k</span><span class="MJXp-mo" id="MJXp-Span-527" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-529" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">f</span><span class="MJXp-mo" id="MJXp-Span-531" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">m</span><span class="MJXp-mo" id="MJXp-Span-533" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">k</span><span class="MJXp-mo" id="MJXp-Span-535" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-536">1</span><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-539">1</span><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">m</span><span class="MJXp-mo" id="MJXp-Span-542" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-543">1</span><span class="MJXp-mo" id="MJXp-Span-544" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">f</span><span class="MJXp-mo" id="MJXp-Span-546" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-547" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">f</span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">m</span><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">k</span><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-554">1</span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-557">1</span><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">m</span><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-561">1</span><span class="MJXp-mo" id="MJXp-Span-562" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">m</span><span class="MJXp-mo" id="MJXp-Span-564" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">k</span><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-567">1</span><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-629"><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-631" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-632" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-633" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-634" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">k</span><span class="mo" id="MathJax-Span-635" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-636" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mo" id="MathJax-Span-637" style="font-family: MathJax_Main; padding-left: 0.273em;">(</span><span class="mi" id="MathJax-Span-638" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-640" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-641" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-642" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">k</span><span class="mo" id="MathJax-Span-643" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-644" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-645" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-646" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-647" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-648" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-649" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-650" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-651" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-652" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-654" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-655" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-656" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-658" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-659" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-660" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">k</span><span class="mo" id="MathJax-Span-661" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-662" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-663" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-664" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-665" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-666" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-667" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-668" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-669" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-670" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-671" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-672" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-673" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">k</span><span class="mo" id="MathJax-Span-674" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-675" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-676" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-93">f(m, k) = (f(m, k - 1) + 1) m - 1) f((f(m, k - 1) + 1) m - 1) m, k - 1)</script></p></li><li> Required only for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">k</span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-572">3</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-94-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-677"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-678"><span class="mi" id="MathJax-Span-679" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-680" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-681" style="font-family: MathJax_Main; padding-left: 0.273em;">3</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-94">k=3</script> to solve. We can pre-calculate with bruteforce that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-573"><span class="MJXp-mn" id="MJXp-Span-574">1</span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-576">2</span><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-578">3</span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-582">35</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-95-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-682"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-683"><span class="mn" id="MathJax-Span-684" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-685" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-686" style="font-family: MathJax_Main; padding-left: 0.165em;">2</span><span class="mo" id="MathJax-Span-687" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-688" style="font-family: MathJax_Main; padding-left: 0.165em;">3</span><span class="mo" id="MathJax-Span-689" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-690" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-691" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="mn" id="MathJax-Span-692" style="font-family: MathJax_Main; padding-left: 0.165em;">35</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-95">1, 2, 3, \ldots, 35</script> can be distinguished. So <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">f</span><span class="MJXp-mo" id="MJXp-Span-585" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-586">1</span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-588">2</span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-590" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-591">35</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-96-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-693"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-694"><span class="mi" id="MathJax-Span-695" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-696" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-697" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-698" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-699" style="font-family: MathJax_Main; padding-left: 0.165em;">2</span><span class="mo" id="MathJax-Span-700" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-701" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-702" style="font-family: MathJax_Main; padding-left: 0.273em;">35</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">f(1, 2) = 35</script>. This is the only place where we will use that in our query we get the sum of digits instead of just remainder by modulo.</li></ul><p>The code on Python:</p><pre class="verbatim"><br>def f(m, k):<br>    if k == 1:<br>        if m == 1:<br>            return 3<br>        return m + 1<br>    if m == 1 and k == 2:<br>        return 35<br>    s = f(m, k - 1)<br>    mod = (s + 1) * m - 1<br>    return f(mod * m, k - 1) * mod<br></pre><p>To solve the problem, we need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">f</span><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-595">1</span><span class="MJXp-mo" id="MJXp-Span-596" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-597">3</span><span class="MJXp-mo" id="MJXp-Span-598" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-599" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-600">2</span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-602"><span class="MJXp-mn" id="MJXp-Span-603" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-604" style="vertical-align: 0.5em;">9</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-97-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-703"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-704"><span class="mi" id="MathJax-Span-705" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-706" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-707" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-708" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-709" style="font-family: MathJax_Main; padding-left: 0.165em;">3</span><span class="mo" id="MathJax-Span-710" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-711" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mn" id="MathJax-Span-712" style="font-family: MathJax_Main; padding-left: 0.273em;">2</span><span class="mo" id="MathJax-Span-713" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="msubsup" id="MathJax-Span-714" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.41em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-715" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.977em;"><span class="mn" id="MathJax-Span-716" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">f(1, 3) \geq 2 \cdot 10^9</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">f</span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-608">1</span><span class="MJXp-mo" id="MJXp-Span-609" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-610">4</span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-612" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-613">4</span><span class="MJXp-mo" id="MJXp-Span-614" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-615"><span class="MJXp-mn" id="MJXp-Span-616" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-617" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-618">18</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-98-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-717"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-718"><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-720" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-721" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-722" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-723" style="font-family: MathJax_Main; padding-left: 0.165em;">4</span><span class="mo" id="MathJax-Span-724" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-725" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mn" id="MathJax-Span-726" style="font-family: MathJax_Main; padding-left: 0.273em;">4</span><span class="mo" id="MathJax-Span-727" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="msubsup" id="MathJax-Span-728" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-729" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.977em;"><span class="texatom" id="MathJax-Span-730"><span class="mrow" id="MathJax-Span-731"><span class="mn" id="MathJax-Span-732" style="font-size: 70.7%; font-family: MathJax_Main;">18</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">f(1, 4) \geq 4 \cdot 10^{18}</script>. It holds because the function grows very fast, it is similar to Ackermann function. Values are:</p><ul> <li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">f</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-622">1</span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-624">3</span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-626" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-627">2051229390</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-99-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-733"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-734"><span class="mi" id="MathJax-Span-735" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-736" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-737" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-738" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-739" style="font-family: MathJax_Main; padding-left: 0.165em;">3</span><span class="mo" id="MathJax-Span-740" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-741" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-742" style="font-family: MathJax_Main; padding-left: 0.273em;">2051229390</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-99">f(1, 3) = 2051229390</script> </li><li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">f</span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-631">1</span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-633">4</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-msubsup" id="MJXp-Span-636"><span class="MJXp-mn" id="MJXp-Span-637" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-638" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-639">391</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-100-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-743"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-744"><span class="mi" id="MathJax-Span-745" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-746" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-747" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-748" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-749" style="font-family: MathJax_Main; padding-left: 0.165em;">4</span><span class="mo" id="MathJax-Span-750" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-751" style="font-family: MathJax_Main; padding-left: 0.273em;">≈</span><span class="msubsup" id="MathJax-Span-752" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-753" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.977em;"><span class="texatom" id="MathJax-Span-754"><span class="mrow" id="MathJax-Span-755"><span class="mn" id="MathJax-Span-756" style="font-size: 70.7%; font-family: MathJax_Main;">391</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-100">f(1, 4) \approx 10^{391}</script> </li></ul><p>To make interactive guess, we can just distingush the number by the same logic we used to prove how <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">f</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-101-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-757"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-758"><span class="mi" id="MathJax-Span-759" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-101">f</script> is calculated.</p><p>Time complexity of one guess: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">O</span><span class="MJXp-mo" id="MJXp-Span-644" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">k</span><span class="MJXp-mi" id="MJXp-Span-646">log</span><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">c</span></span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-102-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-760"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-761"><span class="mi" id="MathJax-Span-762" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-763" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-764" style="font-family: MathJax_Math-italic;">k</span><span class="mi" id="MathJax-Span-765" style="font-family: MathJax_Main; padding-left: 0.165em;">log</span><span class="mo" id="MathJax-Span-766"></span><span class="texatom" id="MathJax-Span-767" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-768"><span class="mi" id="MathJax-Span-769" style="font-family: MathJax_Math-italic;">c</span></span></span><span class="mo" id="MathJax-Span-770" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-102">O(k \log{c})</script>, because we use CRT at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">k</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-103-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-771"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-772"><span class="mi" id="MathJax-Span-773" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-103">k</script> times.</p></div></div></div></div> <div><h3><a href="https://codeforces.com/contest/2174/problem/F" title="Codeforces Round 1069 (Div. 1)">2174F - Мозаичное дерево</a></h3><div class="ttypography"><div class="problem-statement"><div><p>The key insight is to use <span class="tex-font-style-it">Prüfer codes</span> to enumerate all labeled trees. Each labeled tree with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-104-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-774"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-775"><span class="mi" id="MathJax-Span-776" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-104">n</script> vertices corresponds bijectively to a sequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-655"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">p</span><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-658" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-661" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-665" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-668" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-671" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">n</span><span class="MJXp-mo" id="MJXp-Span-673">−</span><span class="MJXp-mn" id="MJXp-Span-674">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-675" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-105-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-777"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-778"><span class="mi" id="MathJax-Span-779" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-780" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mo" id="MathJax-Span-781" style="font-family: MathJax_Main; padding-left: 0.273em;">(</span><span class="msubsup" id="MathJax-Span-782"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mn" id="MathJax-Span-784" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-785" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-786" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-787" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mn" id="MathJax-Span-788" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-789" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-790" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-791" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="msubsup" id="MathJax-Span-792" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.897em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-793" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-794"><span class="mrow" id="MathJax-Span-795"><span class="mi" id="MathJax-Span-796" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-797" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-798" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-799" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-105">p = (p_1, p_2, \ldots, p_{n-2})</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-676"><span class="MJXp-msubsup" id="MJXp-Span-677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-679" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-681" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-682">1</span><span class="MJXp-mo" id="MJXp-Span-683" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-685" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">n</span><span class="MJXp-mo" id="MJXp-Span-687" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-106-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-800"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-801"><span class="msubsup" id="MathJax-Span-802"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-803" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-804" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-805" style="font-family: MathJax_Main; padding-left: 0.273em;">∈</span><span class="mo" id="MathJax-Span-806" style="font-family: MathJax_Main; padding-left: 0.273em;">{</span><span class="mn" id="MathJax-Span-807" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-808" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-809" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-810" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="mi" id="MathJax-Span-811" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">n</span><span class="mo" id="MathJax-Span-812" style="font-family: MathJax_Main;">}</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-106">p_j \in \{1, \ldots, n\}</script>.</p><p>For a vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">v</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-107-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-813"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-814"><span class="mi" id="MathJax-Span-815" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-107">v</script>, its degree in the tree is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-690"><span class="MJXp-mi" id="MJXp-Span-691">deg</span><span class="MJXp-mo" id="MJXp-Span-692" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">v</span><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-696" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706">s</span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">p</span><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710">v</span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-713">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-108-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-816"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-817"><span class="mi" id="MathJax-Span-818" style="font-family: MathJax_Main;">deg</span><span class="mo" id="MathJax-Span-819"></span><span class="mo" id="MathJax-Span-820" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-821" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-822" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-823" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-824" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">o</span><span class="mi" id="MathJax-Span-825" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-826" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-827" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-828" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-829" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-830" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-831" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-833" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-834" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-835" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-836" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-837" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">v</span><span class="mo" id="MathJax-Span-838" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-839" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-840" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">\deg(v) = occurences(p, v) + 1</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">s</span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">p</span><span class="MJXp-mo" id="MJXp-Span-727" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">v</span><span class="MJXp-mo" id="MJXp-Span-729" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-109-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-841"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-842"><span class="mi" id="MathJax-Span-843" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-845" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-846" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-847" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-848" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-849" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-850" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-852" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-853" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-854" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-855" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-856" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">v</span><span class="mo" id="MathJax-Span-857" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">occurences(p, v)</script> is the number of occurrences of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">v</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-110-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-858"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-859"><span class="mi" id="MathJax-Span-860" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-110">v</script> in the Prüfer code <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">p</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-111-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-861"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-862"><span class="mi" id="MathJax-Span-863" style="font-family: MathJax_Math-italic;">p</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-111">p</script>.</p><p>A tree is <span class="tex-font-style-it">beautiful</span> if for each color <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">c</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-112-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-864"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-865"><span class="mi" id="MathJax-Span-866" style="font-family: MathJax_Math-italic;">c</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-112">c</script>: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">s</span><span class="MJXp-msubsup" id="MJXp-Span-740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-742" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">n</span><span class="MJXp-msubsup" id="MJXp-Span-749"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-751" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-752" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-753"><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-755" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">v</span><span class="MJXp-mo" id="MJXp-Span-757">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">o</span><span class="MJXp-msubsup" id="MJXp-Span-760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-762" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-763">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">c</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">s</span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">p</span><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">v</span><span class="MJXp-mo" id="MJXp-Span-779" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-781">&nbsp;mod&nbsp;</span><span class="MJXp-mn" id="MJXp-Span-782">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-113-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-867"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-868"><span class="mi" id="MathJax-Span-869" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-870" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-871" style="font-family: MathJax_Math-italic;">s</span><span class="msubsup" id="MathJax-Span-872"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-873" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-874" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-875" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mo" id="MathJax-Span-876" style="font-family: MathJax_Main; padding-left: 0.273em;">(</span><span class="mi" id="MathJax-Span-877" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-878" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-879" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-880" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-881"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-882" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-883" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-884" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="munderover" id="MathJax-Span-885" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 3.682em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-886" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.731em; left: 1.085em;"><span class="texatom" id="MathJax-Span-887"><span class="mrow" id="MathJax-Span-888"><span class="mi" id="MathJax-Span-889" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-890" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-891" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-892" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="msubsup" id="MathJax-Span-893"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.16em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-894" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.219em;"><span class="mi" id="MathJax-Span-895" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-896" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-897" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-898" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">o</span><span class="mi" id="MathJax-Span-899" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-900" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-901" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-902" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-903" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-904" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-905" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-906" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-907" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-908" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-909" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-910" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-911" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">v</span><span class="mo" id="MathJax-Span-912" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-913" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-914" style="font-family: MathJax_Main;">&nbsp;mod&nbsp;</span><span class="mn" id="MathJax-Span-915" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">mask_c = (count_c + \sum_{v, col_v = c} occurences(p, v)) \text{ mod } 2</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">n</span><span class="MJXp-msubsup" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-790" style="vertical-align: -0.4em;">c</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-114-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-916"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-917"><span class="mi" id="MathJax-Span-918" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-919" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-920" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-921" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-922"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-923" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-924" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-114">count_c</script> is the number of vertices with color <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">c</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-115-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-925"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-926"><span class="mi" id="MathJax-Span-927" style="font-family: MathJax_Math-italic;">c</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-115">c</script>.</p><p>For a fixed tree, let's define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-793"><span class="MJXp-msubsup" id="MJXp-Span-794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-796" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-797" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">p</span><span class="MJXp-mo" id="MJXp-Span-799" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-800" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-msubsup" id="MJXp-Span-801"><span class="MJXp-mo" id="MJXp-Span-802" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-803" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">v</span><span class="MJXp-mo" id="MJXp-Span-805">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">o</span><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-810" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-811">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">c</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">s</span><span class="MJXp-mo" id="MJXp-Span-823" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">p</span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">v</span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-828">&nbsp;mod&nbsp;</span><span class="MJXp-mn" id="MJXp-Span-829">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-116-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-928"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-929"><span class="msubsup" id="MathJax-Span-930"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-931" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="mi" id="MathJax-Span-932" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-933" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-934" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-935" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-936" style="font-family: MathJax_Main; padding-left: 0.273em;">:<span style="font-family: MathJax_Main;">=</span></span><span class="munderover" id="MathJax-Span-937" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 3.682em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-938" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.731em; left: 1.085em;"><span class="texatom" id="MathJax-Span-939"><span class="mrow" id="MathJax-Span-940"><span class="mi" id="MathJax-Span-941" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-942" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-943" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-944" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="msubsup" id="MathJax-Span-945"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.16em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-946" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.219em;"><span class="mi" id="MathJax-Span-947" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-948" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-949" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-950" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">o</span><span class="mi" id="MathJax-Span-951" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-952" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-953" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-954" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-955" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-956" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-957" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-958" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-959" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-960" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-961" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-962" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-963" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">v</span><span class="mo" id="MathJax-Span-964" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-965" style="font-family: MathJax_Main;">&nbsp;mod&nbsp;</span><span class="mn" id="MathJax-Span-966" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-116">S_c(p) := \sum_{v, col_v = c} occurences(p, v) \text{ mod } 2</script>.</p><p>For a beautiful tree, the following applies: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">S</span><span class="MJXp-mo" id="MJXp-Span-832" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">p</span><span class="MJXp-mo" id="MJXp-Span-834" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-835" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">r</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-117-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-967"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-968"><span class="mi" id="MathJax-Span-969" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-970" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-971" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-972" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-973" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-974" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">r</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-117">S(p) = r</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-837"><span class="MJXp-msubsup" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-840" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">s</span><span class="MJXp-msubsup" id="MJXp-Span-845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-847" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">n</span><span class="MJXp-msubsup" id="MJXp-Span-854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-856" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mtext" id="MJXp-Span-857">&nbsp;mod&nbsp;</span><span class="MJXp-mn" id="MJXp-Span-858">2</span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-118-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-975"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-976"><span class="msubsup" id="MathJax-Span-977"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-978" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-979" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-980" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-981" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">m</span><span class="mi" id="MathJax-Span-982" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-983" style="font-family: MathJax_Math-italic;">s</span><span class="msubsup" id="MathJax-Span-984"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-985" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-986" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-987" style="font-family: MathJax_Main; padding-left: 0.219em;">⊕</span><span class="mo" id="MathJax-Span-988" style="font-family: MathJax_Main; padding-left: 0.219em;">(</span><span class="mi" id="MathJax-Span-989" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-990" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-991" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-992" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-993"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-994" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-995" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mtext" id="MathJax-Span-996" style="font-family: MathJax_Main;">&nbsp;mod&nbsp;</span><span class="mn" id="MathJax-Span-997" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-998" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-118">r_c = mask_c \oplus (count_c \text{ mod } 2)</script>. We need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-860"><span class="MJXp-mfrac" id="MJXp-Span-861" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-862">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-863">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-864"><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-866" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">ε</span><span class="MJXp-mo" id="MJXp-Span-868">∈</span><span class="MJXp-mo" id="MJXp-Span-869">{</span><span class="MJXp-mo" id="MJXp-Span-870">−</span><span class="MJXp-mn" id="MJXp-Span-871">1</span><span class="MJXp-mo" id="MJXp-Span-872">,</span><span class="MJXp-mn" id="MJXp-Span-873">1</span><span class="MJXp-mo" id="MJXp-Span-874">}</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876" style="margin-right: 0.05em;">ε</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-877" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-880" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-881">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">p</span><span class="MJXp-mo" id="MJXp-Span-883">)</span><span class="MJXp-mo" id="MJXp-Span-884">−</span><span class="MJXp-msubsup" id="MJXp-Span-885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-887" style="vertical-align: -0.4em;">c</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-888" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-889">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-119-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-999"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1000"><span class="mfrac" id="MathJax-Span-1001"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.358em, 1000.33em, 4.169em, -999.997em); top: -4.435em; left: 50%; margin-left: -0.16em;"><span class="mn" id="MathJax-Span-1002" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1000.33em, 4.169em, -999.997em); top: -3.623em; left: 50%; margin-left: -0.16em;"><span class="mn" id="MathJax-Span-1003" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1000.49em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.49em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1004" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 4.115em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1005" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.731em; left: 1.085em;"><span class="texatom" id="MathJax-Span-1006"><span class="mrow" id="MathJax-Span-1007"><span class="mi" id="MathJax-Span-1008" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ε</span><span class="mo" id="MathJax-Span-1009" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mo" id="MathJax-Span-1010" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mo" id="MathJax-Span-1011" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1012" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1013" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1014" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1015" style="font-size: 70.7%; font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1016" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 3.304em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1017" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1018"><span class="mrow" id="MathJax-Span-1019"><span class="msubsup" id="MathJax-Span-1020"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1021" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.436em;"><span class="mi" id="MathJax-Span-1022" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1023" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1024" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1025" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1026" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1027"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1028" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.327em;"><span class="mi" id="MathJax-Span-1029" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1030" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-1031" style="font-family: MathJax_Main; padding-left: 0.273em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-119">\frac{1}{2}\sum_{\varepsilon \in \{-1, 1\}} \varepsilon^{S_c(p) - r_c} = 1</script> for each color:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-890"><span class="MJXp-munderover" id="MJXp-Span-891"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-897" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-892" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-893" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">c</span><span class="MJXp-mo" id="MJXp-Span-895">=</span><span class="MJXp-mn" id="MJXp-Span-896">1</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-899" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-900">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-901">2</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-902"><span class=""><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-904" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">ε</span><span class="MJXp-mo" id="MJXp-Span-906">∈</span><span class="MJXp-mo" id="MJXp-Span-907">{</span><span class="MJXp-mo" id="MJXp-Span-908">−</span><span class="MJXp-mn" id="MJXp-Span-909">1</span><span class="MJXp-mo" id="MJXp-Span-910">,</span><span class="MJXp-mn" id="MJXp-Span-911">1</span><span class="MJXp-mo" id="MJXp-Span-912">}</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914" style="margin-right: 0.05em;">ε</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-915" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-918" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-919">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">p</span><span class="MJXp-mo" id="MJXp-Span-921">)</span><span class="MJXp-mo" id="MJXp-Span-922">−</span><span class="MJXp-msubsup" id="MJXp-Span-923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-925" style="vertical-align: -0.4em;">c</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-927" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-928">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-929"><span class="MJXp-mn" id="MJXp-Span-930" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-931" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-932"><span class=""><span class="MJXp-mo" id="MJXp-Span-933" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-934" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">ε</span><span class="MJXp-mo" id="MJXp-Span-936">∈</span><span class="MJXp-mo" id="MJXp-Span-937">{</span><span class="MJXp-mo" id="MJXp-Span-938">±</span><span class="MJXp-mn" id="MJXp-Span-939">1</span><span class="MJXp-msubsup" id="MJXp-Span-940"><span class="MJXp-mo" id="MJXp-Span-941" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-942" style="vertical-align: 0.5em;">m</span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-943"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-944" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-945" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">c</span><span class="MJXp-mo" id="MJXp-Span-947">=</span><span class="MJXp-mn" id="MJXp-Span-948">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-953"><span class="MJXp-msubsup" id="MJXp-Span-954"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-956" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-957">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">p</span><span class="MJXp-mo" id="MJXp-Span-959">)</span><span class="MJXp-mo" id="MJXp-Span-960">−</span><span class="MJXp-msubsup" id="MJXp-Span-961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-963" style="vertical-align: -0.4em;">c</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">c</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-965" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-966">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-967"><span class="MJXp-mn" id="MJXp-Span-968" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-969" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-970"><span class=""><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-972" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">ε</span><span class="MJXp-mo" id="MJXp-Span-974">∈</span><span class="MJXp-mo" id="MJXp-Span-975">{</span><span class="MJXp-mo" id="MJXp-Span-976">±</span><span class="MJXp-mn" id="MJXp-Span-977">1</span><span class="MJXp-msubsup" id="MJXp-Span-978"><span class="MJXp-mo" id="MJXp-Span-979" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-980" style="vertical-align: 0.5em;">m</span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-981"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-982" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-983" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">c</span><span class="MJXp-mo" id="MJXp-Span-985">=</span><span class="MJXp-mn" id="MJXp-Span-986">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-991"><span class="MJXp-msubsup" id="MJXp-Span-992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-994" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-995">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">p</span><span class="MJXp-mo" id="MJXp-Span-997">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">c</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-998"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-999" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1000" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">c</span><span class="MJXp-mo" id="MJXp-Span-1002">=</span><span class="MJXp-mn" id="MJXp-Span-1003">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1008"><span class="MJXp-mo" id="MJXp-Span-1009">−</span><span class="MJXp-msubsup" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1012" style="vertical-align: -0.4em;">c</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">c</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1032"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1033"><span class="munderover" id="MathJax-Span-1034"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1035" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1036"><span class="mrow" id="MathJax-Span-1037"><span class="mi" id="MathJax-Span-1038" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1039" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1040" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1041"><span class="mrow" id="MathJax-Span-1042"><span class="mi" id="MathJax-Span-1043" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1044" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.268em;"><span class="mn" id="MathJax-Span-1045" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.268em;"><span class="mn" id="MathJax-Span-1046" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1000.6em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.598em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1047" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.979em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.76em;"><span class="mo" id="MathJax-Span-1048" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.92em, 4.44em, -999.997em); top: -2.865em; left: 0em;"><span class="texatom" id="MathJax-Span-1049"><span class="mrow" id="MathJax-Span-1050"><span class="mi" id="MathJax-Span-1051" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ε</span><span class="mo" id="MathJax-Span-1052" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mo" id="MathJax-Span-1053" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mo" id="MathJax-Span-1054" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1055" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1056" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1057" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1058" style="font-size: 70.7%; font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1059" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 3.304em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1060" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.435em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1061"><span class="mrow" id="MathJax-Span-1062"><span class="msubsup" id="MathJax-Span-1063"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1064" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.436em;"><span class="mi" id="MathJax-Span-1065" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1066" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1067" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1068" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1069" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1070"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1071" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.327em;"><span class="mi" id="MathJax-Span-1072" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1073" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mfrac" id="MathJax-Span-1074" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.268em;"><span class="mn" id="MathJax-Span-1075" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.19em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.593em;"><span class="msubsup" id="MathJax-Span-1076"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-1077" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-1078" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1001.3em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.301em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1079" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.925em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.706em;"><span class="mo" id="MathJax-Span-1080" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.92em, 4.44em, -999.997em); top: -2.811em; left: 0em;"><span class="texatom" id="MathJax-Span-1081"><span class="mrow" id="MathJax-Span-1082"><span class="mi" id="MathJax-Span-1083" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ε</span><span class="mo" id="MathJax-Span-1084" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mo" id="MathJax-Span-1085" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mo" id="MathJax-Span-1086" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span class="mn" id="MathJax-Span-1087" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1088"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.304em, 1000.33em, 4.332em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1089" style="font-size: 70.7%; font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.326em; left: 0.381em;"><span class="mi" id="MathJax-Span-1090" style="font-size: 50%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1091" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1092" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1093"><span class="mrow" id="MathJax-Span-1094"><span class="mi" id="MathJax-Span-1095" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1096" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1097" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1098" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1099" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 3.304em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1100" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.82em, 4.332em, -999.997em); top: -4.543em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1101"><span class="mrow" id="MathJax-Span-1102"><span class="msubsup" id="MathJax-Span-1103"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.436em;"><span class="mi" id="MathJax-Span-1105" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1106" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1107" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1108" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1109" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1110"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1111" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.327em;"><span class="mi" id="MathJax-Span-1112" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1113" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1114" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mfrac" id="MathJax-Span-1115" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.268em;"><span class="mn" id="MathJax-Span-1116" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.19em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.593em;"><span class="msubsup" id="MathJax-Span-1117"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-1118" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-1119" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1001.3em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.301em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1120" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.925em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.706em;"><span class="mo" id="MathJax-Span-1121" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.92em, 4.44em, -999.997em); top: -2.811em; left: 0em;"><span class="texatom" id="MathJax-Span-1122"><span class="mrow" id="MathJax-Span-1123"><span class="mi" id="MathJax-Span-1124" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ε</span><span class="mo" id="MathJax-Span-1125" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mo" id="MathJax-Span-1126" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mo" id="MathJax-Span-1127" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span class="mn" id="MathJax-Span-1128" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1129"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.304em, 1000.33em, 4.332em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1130" style="font-size: 70.7%; font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.326em; left: 0.381em;"><span class="mi" id="MathJax-Span-1131" style="font-size: 50%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1132" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1133" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1134"><span class="mrow" id="MathJax-Span-1135"><span class="mi" id="MathJax-Span-1136" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1137" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1138" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1139" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1140" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1141" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1001.68em, 4.332em, -999.997em); top: -4.543em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1142"><span class="mrow" id="MathJax-Span-1143"><span class="msubsup" id="MathJax-Span-1144"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1145" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.436em;"><span class="mi" id="MathJax-Span-1146" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1147" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1148" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1149" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1150" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1151" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1152" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1153"><span class="mrow" id="MathJax-Span-1154"><span class="mi" id="MathJax-Span-1155" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1156" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1157" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1158" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1159" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1160" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1001.19em, 4.278em, -999.997em); top: -4.435em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1161"><span class="mrow" id="MathJax-Span-1162"><span class="mo" id="MathJax-Span-1163" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1164"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1165" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.327em;"><span class="mi" id="MathJax-Span-1166" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1167" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-120"> \prod_{c=1}^{m}\frac{1}{2} \sum_{\varepsilon \in \{-1, 1\}} \varepsilon^{S_c(p) - r_c} = \frac{1}{2^m}\sum_{\varepsilon \in \{\pm 1\}^m} \prod_{c=1}^m \varepsilon_c^{S_c(p) - r_c} = \frac{1}{2^m}\sum_{\varepsilon \in \{\pm 1\}^m} \prod_{c=1}^m \varepsilon_c^{S_c(p)} \prod_{c=1}^m \varepsilon_c^{-r_c} </script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1013"><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0.267em; margin-right: 0.267em;">±</span><span class="MJXp-mn" id="MJXp-Span-1016">1</span><span class="MJXp-msubsup" id="MJXp-Span-1017"><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0em; margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1019" style="vertical-align: 0.5em;">m</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-121-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1168"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1169"><span class="mo" id="MathJax-Span-1170" style="font-family: MathJax_Main;">{</span><span class="mo" id="MathJax-Span-1171" style="font-family: MathJax_Main;">±</span><span class="mn" id="MathJax-Span-1172" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1173"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.44em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1174" style="font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-1175" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-121">\{\pm 1\}^m</script> denotes all sequences of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-122-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1176"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1177"><span class="mi" id="MathJax-Span-1178" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-122">m</script> consisting of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1022"><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1024">1</span><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1026">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-123-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1179"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1180"><span class="mo" id="MathJax-Span-1181" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1182" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1183" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1184" style="font-family: MathJax_Main; padding-left: 0.165em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-123">-1, 1</script>.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">P</span><span class="MJXp-mo" id="MJXp-Span-1029" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">n</span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-124-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1185"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1186"><span class="mi" id="MathJax-Span-1187" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span><span class="mo" id="MathJax-Span-1188" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1189" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1190" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-124">P(n)</script> be the set of all Prüfer codes for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-125-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1191"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1192"><span class="mi" id="MathJax-Span-1193" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-125">n</script> vertices. Now we need to sum the previous indicator over all trees:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1034"><span class="MJXp-mtable" id="MJXp-Span-1035"><span><span class="MJXp-mtr" id="MJXp-Span-1036" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1037" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">s</span></span><span class="MJXp-mtd" id="MJXp-Span-1041" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1042"></span><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1044"><span class=""><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1046" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">p</span><span class="MJXp-mo" id="MJXp-Span-1048">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">P</span><span class="MJXp-mo" id="MJXp-Span-1050">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">n</span><span class="MJXp-mo" id="MJXp-Span-1052">)</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1053" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1054">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1055"><span class="MJXp-mn" id="MJXp-Span-1056" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1057" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1058"><span class=""><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1060" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">ε</span><span class="MJXp-mo" id="MJXp-Span-1062">∈</span><span class="MJXp-mo" id="MJXp-Span-1063">{</span><span class="MJXp-mo" id="MJXp-Span-1064">±</span><span class="MJXp-mn" id="MJXp-Span-1065">1</span><span class="MJXp-msubsup" id="MJXp-Span-1066"><span class="MJXp-mo" id="MJXp-Span-1067" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1068" style="vertical-align: 0.5em;">m</span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1069"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1071" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">c</span><span class="MJXp-mo" id="MJXp-Span-1073">=</span><span class="MJXp-mn" id="MJXp-Span-1074">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1079"><span class="MJXp-msubsup" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1082" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1083">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">p</span><span class="MJXp-mo" id="MJXp-Span-1085">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">c</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1086"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1088" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">c</span><span class="MJXp-mo" id="MJXp-Span-1090">=</span><span class="MJXp-mn" id="MJXp-Span-1091">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1096"><span class="MJXp-mo" id="MJXp-Span-1097">−</span><span class="MJXp-msubsup" id="MJXp-Span-1098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1100" style="vertical-align: -0.4em;">c</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">c</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1102" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1103" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1104" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1105"></span><span class="MJXp-mo" id="MJXp-Span-1106" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1107" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1108">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1109"><span class="MJXp-mn" id="MJXp-Span-1110" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1111" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1112"><span class=""><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1114" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">ε</span><span class="MJXp-mo" id="MJXp-Span-1116">∈</span><span class="MJXp-mo" id="MJXp-Span-1117">{</span><span class="MJXp-mo" id="MJXp-Span-1118">±</span><span class="MJXp-mn" id="MJXp-Span-1119">1</span><span class="MJXp-msubsup" id="MJXp-Span-1120"><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1122" style="vertical-align: 0.5em;">m</span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1123"><span class=""><span class="MJXp-mo" id="MJXp-Span-1124" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1125" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">p</span><span class="MJXp-mo" id="MJXp-Span-1127">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">P</span><span class="MJXp-mo" id="MJXp-Span-1129">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">n</span><span class="MJXp-mo" id="MJXp-Span-1131">)</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1132"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1134" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">c</span><span class="MJXp-mo" id="MJXp-Span-1136">=</span><span class="MJXp-mn" id="MJXp-Span-1137">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1142"><span class="MJXp-msubsup" id="MJXp-Span-1143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1145" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1146">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">p</span><span class="MJXp-mo" id="MJXp-Span-1148">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">c</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1149"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1150" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1151" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">c</span><span class="MJXp-mo" id="MJXp-Span-1153">=</span><span class="MJXp-mn" id="MJXp-Span-1154">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1159"><span class="MJXp-mo" id="MJXp-Span-1160">−</span><span class="MJXp-msubsup" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1163" style="vertical-align: -0.4em;">c</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">c</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1164" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1165" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1166" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1167" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1168"></span><span class="MJXp-mo" id="MJXp-Span-1169" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1170" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1171">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1172"><span class="MJXp-mn" id="MJXp-Span-1173" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1174" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1175"><span class=""><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1177" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">ε</span><span class="MJXp-mo" id="MJXp-Span-1179">∈</span><span class="MJXp-mo" id="MJXp-Span-1180">{</span><span class="MJXp-mo" id="MJXp-Span-1181">±</span><span class="MJXp-mn" id="MJXp-Span-1182">1</span><span class="MJXp-msubsup" id="MJXp-Span-1183"><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1185" style="vertical-align: 0.5em;">m</span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1186"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1188" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">c</span><span class="MJXp-mo" id="MJXp-Span-1190">=</span><span class="MJXp-mn" id="MJXp-Span-1191">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1196"><span class="MJXp-mo" id="MJXp-Span-1197">−</span><span class="MJXp-msubsup" id="MJXp-Span-1198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1200" style="vertical-align: -0.4em;">c</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">c</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-munderover" id="MJXp-Span-1202"><span class=""><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1204" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">p</span><span class="MJXp-mo" id="MJXp-Span-1206">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">P</span><span class="MJXp-mo" id="MJXp-Span-1208">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">n</span><span class="MJXp-mo" id="MJXp-Span-1210">)</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1211"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1213" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">c</span><span class="MJXp-mo" id="MJXp-Span-1215">=</span><span class="MJXp-mn" id="MJXp-Span-1216">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1221"><span class="MJXp-msubsup" id="MJXp-Span-1222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1224" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1225">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">p</span><span class="MJXp-mo" id="MJXp-Span-1227">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">c</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1229" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1230" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1231" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1232"></span><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1234" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1235">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1236"><span class="MJXp-mn" id="MJXp-Span-1237" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1238" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1239"><span class=""><span class="MJXp-mo" id="MJXp-Span-1240" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1241" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">ε</span><span class="MJXp-mo" id="MJXp-Span-1243">∈</span><span class="MJXp-mo" id="MJXp-Span-1244">{</span><span class="MJXp-mo" id="MJXp-Span-1245">±</span><span class="MJXp-mn" id="MJXp-Span-1246">1</span><span class="MJXp-msubsup" id="MJXp-Span-1247"><span class="MJXp-mo" id="MJXp-Span-1248" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1249" style="vertical-align: 0.5em;">m</span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1250"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1252" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">c</span><span class="MJXp-mo" id="MJXp-Span-1254">=</span><span class="MJXp-mn" id="MJXp-Span-1255">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1260"><span class="MJXp-mo" id="MJXp-Span-1261">−</span><span class="MJXp-msubsup" id="MJXp-Span-1262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1264" style="vertical-align: -0.4em;">c</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">c</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1265" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-munderover" id="MJXp-Span-1266"><span class=""><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1268" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">p</span><span class="MJXp-mo" id="MJXp-Span-1270">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">P</span><span class="MJXp-mo" id="MJXp-Span-1272">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">n</span><span class="MJXp-mo" id="MJXp-Span-1274">)</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1275"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1276" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1277" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">c</span><span class="MJXp-mo" id="MJXp-Span-1279">=</span><span class="MJXp-mn" id="MJXp-Span-1280">1</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1282"><span class=""><span class="MJXp-mo" id="MJXp-Span-1283" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1284" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">v</span><span class="MJXp-mo" id="MJXp-Span-1286">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">o</span><span class="MJXp-msubsup" id="MJXp-Span-1289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1291" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-1292">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">c</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">s</span><span class="MJXp-mo" id="MJXp-Span-1309">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">p</span><span class="MJXp-mo" id="MJXp-Span-1311">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">v</span><span class="MJXp-mo" id="MJXp-Span-1313">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">c</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1314" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1315" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1316" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1317" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1318"></span><span class="MJXp-mo" id="MJXp-Span-1319" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1320" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1321">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1322"><span class="MJXp-mn" id="MJXp-Span-1323" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1324" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1325"><span class=""><span class="MJXp-mo" id="MJXp-Span-1326" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1327" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">ε</span><span class="MJXp-mo" id="MJXp-Span-1329">∈</span><span class="MJXp-mo" id="MJXp-Span-1330">{</span><span class="MJXp-mo" id="MJXp-Span-1331">±</span><span class="MJXp-mn" id="MJXp-Span-1332">1</span><span class="MJXp-msubsup" id="MJXp-Span-1333"><span class="MJXp-mo" id="MJXp-Span-1334" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1335" style="vertical-align: 0.5em;">m</span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1336"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1338" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">c</span><span class="MJXp-mo" id="MJXp-Span-1340">=</span><span class="MJXp-mn" id="MJXp-Span-1341">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1346"><span class="MJXp-msubsup" id="MJXp-Span-1347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1349" style="vertical-align: -0.4em;">c</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">c</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1350" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-munderover" id="MJXp-Span-1351"><span class=""><span class="MJXp-mo" id="MJXp-Span-1352" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1353" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">p</span><span class="MJXp-mo" id="MJXp-Span-1355">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">P</span><span class="MJXp-mo" id="MJXp-Span-1357">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">n</span><span class="MJXp-mo" id="MJXp-Span-1359">)</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1360"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1366" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">n</span><span class="MJXp-mo" id="MJXp-Span-1368">−</span><span class="MJXp-mn" id="MJXp-Span-1369">2</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1362" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">j</span><span class="MJXp-mo" id="MJXp-Span-1364">=</span><span class="MJXp-mn" id="MJXp-Span-1365">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371" style="margin-right: 0.05em;">ε</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1372" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">o</span><span class="MJXp-msubsup" id="MJXp-Span-1375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376" style="margin-right: 0.05em;">l</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1377" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1380" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1194"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1195"><span class="mtable" id="MathJax-Span-1196"><span style="display: inline-block; position: relative; width: 24.894em; height: 0px; margin-right: 0.165em; margin-left: 0.165em;"><span style="position: absolute; clip: rect(7.362em, 1001.79em, 21.81em, -999.997em); top: -15.149em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.843em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1001.79em, 4.169em, -999.997em); top: -10.928em; right: 0em;"><span class="mtd" id="MathJax-Span-1197"><span class="mrow" id="MathJax-Span-1198"><span class="mi" id="MathJax-Span-1199" style="font-family: MathJax_Math-italic;">A</span><span class="mi" id="MathJax-Span-1200" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1201" style="font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.169em, -999.997em); top: -7.573em; right: 0em;"><span class="mtd" id="MathJax-Span-1270"><span class="mrow" id="MathJax-Span-1271"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.169em, -999.997em); top: -4.272em; right: 0em;"><span class="mtd" id="MathJax-Span-1340"><span class="mrow" id="MathJax-Span-1341"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.169em, -999.997em); top: -0.971em; right: 0em;"><span class="mtd" id="MathJax-Span-1411"><span class="mrow" id="MathJax-Span-1412"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.169em, -999.997em); top: 2.492em; right: 0em;"><span class="mtd" id="MathJax-Span-1506"><span class="mrow" id="MathJax-Span-1507"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 15.154em;"></span></span><span style="position: absolute; clip: rect(8.823em, 1023em, 25.544em, -999.997em); top: -17.422em; left: 1.843em;"><span style="display: inline-block; position: relative; width: 23.055em; height: 0px;"><span style="position: absolute; clip: rect(2.275em, 1016.51em, 5.63em, -999.997em); top: -10.928em; left: 0em;"><span class="mtd" id="MathJax-Span-1202"><span class="mrow" id="MathJax-Span-1203"><span class="mi" id="MathJax-Span-1204"></span><span class="mo" id="MathJax-Span-1205" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="munderover" id="MathJax-Span-1206" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 2.33em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.436em;"><span class="mo" id="MathJax-Span-1207" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.27em, 4.44em, -999.997em); top: -2.865em; left: 0em;"><span class="texatom" id="MathJax-Span-1208"><span class="mrow" id="MathJax-Span-1209"><span class="mi" id="MathJax-Span-1210" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1211" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1212" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1213" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1214" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1215" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1216" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.268em;"><span class="mn" id="MathJax-Span-1217" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.19em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.593em;"><span class="msubsup" id="MathJax-Span-1218"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-1219" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-1220" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1001.3em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.301em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1221" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.925em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.706em;"><span class="mo" id="MathJax-Span-1222" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.92em, 4.44em, -999.997em); top: -2.811em; left: 0em;"><span class="texatom" id="MathJax-Span-1223"><span class="mrow" id="MathJax-Span-1224"><span class="mi" id="MathJax-Span-1225" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ε</span><span class="mo" id="MathJax-Span-1226" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mo" id="MathJax-Span-1227" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mo" id="MathJax-Span-1228" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span class="mn" id="MathJax-Span-1229" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1230"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.304em, 1000.33em, 4.332em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1231" style="font-size: 70.7%; font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.326em; left: 0.381em;"><span class="mi" id="MathJax-Span-1232" style="font-size: 50%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1233" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1234" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1235"><span class="mrow" id="MathJax-Span-1236"><span class="mi" id="MathJax-Span-1237" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1238" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1239" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1240" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1241" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1242" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1001.68em, 4.332em, -999.997em); top: -4.543em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1243"><span class="mrow" id="MathJax-Span-1244"><span class="msubsup" id="MathJax-Span-1245"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1246" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.436em;"><span class="mi" id="MathJax-Span-1247" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1248" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1249" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1250" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1251" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1252" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1253" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1254"><span class="mrow" id="MathJax-Span-1255"><span class="mi" id="MathJax-Span-1256" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1257" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1258" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1259" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1260" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1261" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1001.19em, 4.278em, -999.997em); top: -4.435em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1262"><span class="mrow" id="MathJax-Span-1263"><span class="mo" id="MathJax-Span-1264" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1265"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1266" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.327em;"><span class="mi" id="MathJax-Span-1267" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1268" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1269" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(2.275em, 1016.51em, 5.63em, -999.997em); top: -7.573em; left: 0em;"><span class="mtd" id="MathJax-Span-1272"><span class="mrow" id="MathJax-Span-1273"><span class="mi" id="MathJax-Span-1274"></span><span class="mo" id="MathJax-Span-1275" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mfrac" id="MathJax-Span-1276" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.268em;"><span class="mn" id="MathJax-Span-1277" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.19em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.593em;"><span class="msubsup" id="MathJax-Span-1278"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-1279" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-1280" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1001.3em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.301em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1281" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.925em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.706em;"><span class="mo" id="MathJax-Span-1282" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.92em, 4.44em, -999.997em); top: -2.811em; left: 0em;"><span class="texatom" id="MathJax-Span-1283"><span class="mrow" id="MathJax-Span-1284"><span class="mi" id="MathJax-Span-1285" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ε</span><span class="mo" id="MathJax-Span-1286" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mo" id="MathJax-Span-1287" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mo" id="MathJax-Span-1288" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span class="mn" id="MathJax-Span-1289" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1290"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.304em, 1000.33em, 4.332em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1291" style="font-size: 70.7%; font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.326em; left: 0.381em;"><span class="mi" id="MathJax-Span-1292" style="font-size: 50%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1293" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.33em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.436em;"><span class="mo" id="MathJax-Span-1294" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.27em, 4.44em, -999.997em); top: -2.865em; left: 0em;"><span class="texatom" id="MathJax-Span-1295"><span class="mrow" id="MathJax-Span-1296"><span class="mi" id="MathJax-Span-1297" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1298" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1299" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1300" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1301" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1302" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1303" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1304" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1305"><span class="mrow" id="MathJax-Span-1306"><span class="mi" id="MathJax-Span-1307" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1308" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1309" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1311" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1312" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1001.68em, 4.332em, -999.997em); top: -4.543em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1313"><span class="mrow" id="MathJax-Span-1314"><span class="msubsup" id="MathJax-Span-1315"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1316" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.436em;"><span class="mi" id="MathJax-Span-1317" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1318" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1320" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1321" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1322" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1323" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1324"><span class="mrow" id="MathJax-Span-1325"><span class="mi" id="MathJax-Span-1326" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1327" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1328" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1329" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1330" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1331" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1001.19em, 4.278em, -999.997em); top: -4.435em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1332"><span class="mrow" id="MathJax-Span-1333"><span class="mo" id="MathJax-Span-1334" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1335"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1336" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.327em;"><span class="mi" id="MathJax-Span-1337" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1338" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1339" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(2.275em, 1017.05em, 5.63em, -999.997em); top: -4.272em; left: 0em;"><span class="mtd" id="MathJax-Span-1342"><span class="mrow" id="MathJax-Span-1343"><span class="mi" id="MathJax-Span-1344"></span><span class="mo" id="MathJax-Span-1345" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mfrac" id="MathJax-Span-1346" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.268em;"><span class="mn" id="MathJax-Span-1347" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.19em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.593em;"><span class="msubsup" id="MathJax-Span-1348"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-1349" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-1350" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1001.3em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.301em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1351" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.925em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.706em;"><span class="mo" id="MathJax-Span-1352" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.92em, 4.44em, -999.997em); top: -2.811em; left: 0em;"><span class="texatom" id="MathJax-Span-1353"><span class="mrow" id="MathJax-Span-1354"><span class="mi" id="MathJax-Span-1355" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ε</span><span class="mo" id="MathJax-Span-1356" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mo" id="MathJax-Span-1357" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mo" id="MathJax-Span-1358" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span class="mn" id="MathJax-Span-1359" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1360"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.304em, 1000.33em, 4.332em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1361" style="font-size: 70.7%; font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.326em; left: 0.381em;"><span class="mi" id="MathJax-Span-1362" style="font-size: 50%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1363" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1364" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1365"><span class="mrow" id="MathJax-Span-1366"><span class="mi" id="MathJax-Span-1367" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1368" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1369" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1370" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1371" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1372" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1001.19em, 4.278em, -999.997em); top: -4.435em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1373"><span class="mrow" id="MathJax-Span-1374"><span class="mo" id="MathJax-Span-1375" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1376"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1377" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.327em;"><span class="mi" id="MathJax-Span-1378" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1379" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1380" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="munderover" id="MathJax-Span-1381" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 2.33em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.436em;"><span class="mo" id="MathJax-Span-1382" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.27em, 4.44em, -999.997em); top: -2.865em; left: 0em;"><span class="texatom" id="MathJax-Span-1383"><span class="mrow" id="MathJax-Span-1384"><span class="mi" id="MathJax-Span-1385" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1386" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1387" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1388" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1389" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1390" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1391" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1392" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1393"><span class="mrow" id="MathJax-Span-1394"><span class="mi" id="MathJax-Span-1395" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1396" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1397" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1398" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1399" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1400" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1001.68em, 4.332em, -999.997em); top: -4.543em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1401"><span class="mrow" id="MathJax-Span-1402"><span class="msubsup" id="MathJax-Span-1403"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1404" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.436em;"><span class="mi" id="MathJax-Span-1405" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1406" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1407" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1408" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1409" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1410" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(2.275em, 1023em, 5.63em, -999.997em); top: -0.971em; left: 0em;"><span class="mtd" id="MathJax-Span-1413"><span class="mrow" id="MathJax-Span-1414"><span class="mi" id="MathJax-Span-1415"></span><span class="mo" id="MathJax-Span-1416" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mfrac" id="MathJax-Span-1417" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.268em;"><span class="mn" id="MathJax-Span-1418" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.19em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.593em;"><span class="msubsup" id="MathJax-Span-1419"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-1420" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-1421" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1001.3em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.301em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1422" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.925em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.706em;"><span class="mo" id="MathJax-Span-1423" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.92em, 4.44em, -999.997em); top: -2.811em; left: 0em;"><span class="texatom" id="MathJax-Span-1424"><span class="mrow" id="MathJax-Span-1425"><span class="mi" id="MathJax-Span-1426" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ε</span><span class="mo" id="MathJax-Span-1427" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mo" id="MathJax-Span-1428" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mo" id="MathJax-Span-1429" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span class="mn" id="MathJax-Span-1430" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1431"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.304em, 1000.33em, 4.332em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1432" style="font-size: 70.7%; font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.326em; left: 0.381em;"><span class="mi" id="MathJax-Span-1433" style="font-size: 50%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1434" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1435" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1436"><span class="mrow" id="MathJax-Span-1437"><span class="mi" id="MathJax-Span-1438" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1439" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1440" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1442" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1443" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1001.19em, 4.278em, -999.997em); top: -4.435em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1444"><span class="mrow" id="MathJax-Span-1445"><span class="mo" id="MathJax-Span-1446" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1447"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1448" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.327em;"><span class="mi" id="MathJax-Span-1449" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1451" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="munderover" id="MathJax-Span-1452" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 2.33em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.436em;"><span class="mo" id="MathJax-Span-1453" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.27em, 4.44em, -999.997em); top: -2.865em; left: 0em;"><span class="texatom" id="MathJax-Span-1454"><span class="mrow" id="MathJax-Span-1455"><span class="mi" id="MathJax-Span-1456" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1457" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1458" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1459" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1460" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1461" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1462" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1463" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1464"><span class="mrow" id="MathJax-Span-1465"><span class="mi" id="MathJax-Span-1466" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1467" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1468" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1469" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1470" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.546em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0.652em;"><span class="mo" id="MathJax-Span-1471" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1002.55em, 4.386em, -999.997em); top: -2.919em; left: 0em;"><span class="texatom" id="MathJax-Span-1472"><span class="mrow" id="MathJax-Span-1473"><span class="mi" id="MathJax-Span-1474" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1475" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1476" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1477" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="msubsup" id="MathJax-Span-1478"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.16em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1479" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.219em;"><span class="mi" id="MathJax-Span-1480" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1481" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1482" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1483" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 5.414em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1484" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1004.93em, 4.332em, -999.997em); top: -4.543em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1485"><span class="mrow" id="MathJax-Span-1486"><span class="mi" id="MathJax-Span-1487" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1488" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1489" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1490" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-1491" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1492" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1493" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1494" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1495" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1496" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1497" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1498" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1499" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1501" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1502"><span class="mrow" id="MathJax-Span-1503"><span class="mi" id="MathJax-Span-1504" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1505" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(2.275em, 1015.37em, 5.793em, -999.997em); top: 2.33em; left: 0em;"><span class="mtd" id="MathJax-Span-1508"><span class="mrow" id="MathJax-Span-1509"><span class="mi" id="MathJax-Span-1510"></span><span class="mo" id="MathJax-Span-1511" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mfrac" id="MathJax-Span-1512" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.268em;"><span class="mn" id="MathJax-Span-1513" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.19em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.593em;"><span class="msubsup" id="MathJax-Span-1514"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-1515" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-1516" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1001.3em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.301em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1517" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.925em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.706em;"><span class="mo" id="MathJax-Span-1518" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.92em, 4.44em, -999.997em); top: -2.811em; left: 0em;"><span class="texatom" id="MathJax-Span-1519"><span class="mrow" id="MathJax-Span-1520"><span class="mi" id="MathJax-Span-1521" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ε</span><span class="mo" id="MathJax-Span-1522" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mo" id="MathJax-Span-1523" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mo" id="MathJax-Span-1524" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span class="mn" id="MathJax-Span-1525" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1526"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.304em, 1000.33em, 4.332em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1527" style="font-size: 70.7%; font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.326em; left: 0.381em;"><span class="mi" id="MathJax-Span-1528" style="font-size: 50%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1529" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1530" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1531"><span class="mrow" id="MathJax-Span-1532"><span class="mi" id="MathJax-Span-1533" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1534" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1535" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -5.138em; left: 0.327em;"><span class="mi" id="MathJax-Span-1536" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1537" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1538" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.65em, 4.278em, -999.997em); top: -4.435em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1539"><span class="mrow" id="MathJax-Span-1540"><span class="msubsup" id="MathJax-Span-1541"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.327em;"><span class="mi" id="MathJax-Span-1543" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1544" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1545" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="munderover" id="MathJax-Span-1546" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 2.33em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0.436em;"><span class="mo" id="MathJax-Span-1547" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1002.27em, 4.44em, -999.997em); top: -2.865em; left: 0em;"><span class="texatom" id="MathJax-Span-1548"><span class="mrow" id="MathJax-Span-1549"><span class="mi" id="MathJax-Span-1550" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1551" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1552" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1553" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1554" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1555" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1556" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.356em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.25em, 4.602em, -999.997em); top: -4.002em; left: 0.003em;"><span class="mo" id="MathJax-Span-1557" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.44em, -999.997em); top: -2.919em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1558"><span class="mrow" id="MathJax-Span-1559"><span class="mi" id="MathJax-Span-1560" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1561" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1562" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.249em, 1001.3em, 4.223em, -999.997em); top: -5.138em; left: 0em;"><span class="texatom" id="MathJax-Span-1563"><span class="mrow" id="MathJax-Span-1564"><span class="mi" id="MathJax-Span-1565" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1566" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1567" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1568" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1569" style="font-family: MathJax_Math-italic;">ε</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1570"><span class="mrow" id="MathJax-Span-1571"><span class="mi" id="MathJax-Span-1572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1573" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="msubsup" id="MathJax-Span-1574"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.16em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1575" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.219em;"><span class="texatom" id="MathJax-Span-1576"><span class="mrow" id="MathJax-Span-1577"><span class="msubsup" id="MathJax-Span-1578"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px;"><span style="position: absolute; clip: rect(3.628em, 1000.27em, 4.278em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1579" style="font-size: 50%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.273em;"><span class="mi" id="MathJax-Span-1580" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.169em;"></span></span></span><span style="display: inline-block; width: 0px; height: 17.427em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-126"> \begin{align} Ans &= \sum_{p \in P(n)} \frac{1}{2^m}\sum_{\varepsilon \in \{\pm 1\}^m} \prod_{c=1}^m \varepsilon_c^{S_c(p)} \prod_{c=1}^m \varepsilon_c^{-r_c} = \nonumber \\ &= \frac{1}{2^m}\sum_{\varepsilon \in \{\pm 1\}^m} \sum_{p \in P(n)} \prod_{c=1}^m \varepsilon_c^{S_c(p)} \prod_{c=1}^m \varepsilon_c^{-r_c} = \nonumber \\ &= \frac{1}{2^m}\sum_{\varepsilon \in \{\pm 1\}^m} \prod_{c=1}^m \varepsilon_c^{-r_c} \cdot \sum_{p \in P(n)} \prod_{c=1}^m \varepsilon_c^{S_c(p)} = \nonumber \\ &= \frac{1}{2^m}\sum_{\varepsilon \in \{\pm 1\}^m} \prod_{c=1}^m \varepsilon_c^{-r_c} \cdot \sum_{p \in P(n)} \prod_{c=1}^m \prod_{v, col_v = c} \varepsilon_{c}^{occurences(p, v)} = \nonumber \\ &= \frac{1}{2^m}\sum_{\varepsilon \in \{\pm 1\}^m} \prod_{c=1}^m \varepsilon_c^{r_c} \cdot \sum_{p \in P(n)} \prod_{j=1}^{n-2} \varepsilon_{col_{p_j}} \nonumber \end{align} </script> Here, each vertex in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">p</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-127-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1581"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1582"><span class="mi" id="MathJax-Span-1583" style="font-family: MathJax_Math-italic;">p</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-127">p</script> multiplies the expression by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">ε</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-128-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1584"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1585"><span class="mi" id="MathJax-Span-1586" style="font-family: MathJax_Math-italic;">ε</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-128">\varepsilon</script> of its color. Let's simplify the second part: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1385"><span class="MJXp-munderover" id="MJXp-Span-1386"><span class=""><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1388" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">p</span><span class="MJXp-mo" id="MJXp-Span-1390">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">P</span><span class="MJXp-mo" id="MJXp-Span-1392">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">n</span><span class="MJXp-mo" id="MJXp-Span-1394">)</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1395"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1401" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">n</span><span class="MJXp-mo" id="MJXp-Span-1403">−</span><span class="MJXp-mn" id="MJXp-Span-1404">2</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1396" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1397" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">j</span><span class="MJXp-mo" id="MJXp-Span-1399">=</span><span class="MJXp-mn" id="MJXp-Span-1400">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406" style="margin-right: 0.05em;">ε</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1407" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">o</span><span class="MJXp-msubsup" id="MJXp-Span-1410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411" style="margin-right: 0.05em;">l</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1412" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1415" style="vertical-align: -0.4em;">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1417"><span class="MJXp-mrow" id="MJXp-Span-1418" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1419" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-1420"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426" style="margin-right: 0px; margin-left: 0px;">n</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1421" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1422" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">v</span><span class="MJXp-mo" id="MJXp-Span-1424">=</span><span class="MJXp-mn" id="MJXp-Span-1425">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428" style="margin-right: 0.05em;">ε</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1429" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">o</span><span class="MJXp-msubsup" id="MJXp-Span-1432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1434" style="vertical-align: -0.4em;">v</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1435" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1436" style="vertical-align: 1.64em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">n</span><span class="MJXp-mo" id="MJXp-Span-1438">−</span><span class="MJXp-mn" id="MJXp-Span-1439">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1440" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1441"><span class="MJXp-mrow" id="MJXp-Span-1442" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-1444"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1445" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1446" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">c</span><span class="MJXp-mo" id="MJXp-Span-1448">=</span><span class="MJXp-mn" id="MJXp-Span-1449">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452" style="margin-right: 0.05em;">ε</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1453" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1454" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">n</span><span class="MJXp-msubsup" id="MJXp-Span-1459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1461" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1462" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1463" style="vertical-align: 1.64em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">n</span><span class="MJXp-mo" id="MJXp-Span-1465">−</span><span class="MJXp-mn" id="MJXp-Span-1466">2</span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" style=""></span></div><script type="math/tex; mode=display" id="MathJax-Element-129"> \sum_{p \in P(n)} \prod_{j=1}^{n-2} \varepsilon_{col_{p_j}} = \left(\sum_{v=1}^n \varepsilon_{col_v} \right)^{n-2} = \left( \sum_{c=1}^m \varepsilon_c \cdot count_c \right)^{n-2} </script> because we iterate through all Prüfer codes for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-130">n</script> vertices.</p><p>Let's return to the overall sum: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1469"><span class="MJXp-mtable" id="MJXp-Span-1470"><span><span class="MJXp-mtr" id="MJXp-Span-1471" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1472" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">s</span></span><span class="MJXp-mtd" id="MJXp-Span-1476" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1477"></span><span class="MJXp-mo" id="MJXp-Span-1478" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1479" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1480">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1481"><span class="MJXp-mn" id="MJXp-Span-1482" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1483" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1484"><span class=""><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1486" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">ε</span><span class="MJXp-mo" id="MJXp-Span-1488">∈</span><span class="MJXp-mo" id="MJXp-Span-1489">{</span><span class="MJXp-mo" id="MJXp-Span-1490">±</span><span class="MJXp-mn" id="MJXp-Span-1491">1</span><span class="MJXp-msubsup" id="MJXp-Span-1492"><span class="MJXp-mo" id="MJXp-Span-1493" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1494" style="vertical-align: 0.5em;">m</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1495"><span class="MJXp-mrow" id="MJXp-Span-1496" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-1498"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1499" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1500" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">c</span><span class="MJXp-mo" id="MJXp-Span-1502">=</span><span class="MJXp-mn" id="MJXp-Span-1503">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506" style="margin-right: 0.05em;">ε</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1507" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1508" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">n</span><span class="MJXp-msubsup" id="MJXp-Span-1513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1515" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1517" style="vertical-align: 1.64em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">n</span><span class="MJXp-mo" id="MJXp-Span-1519">−</span><span class="MJXp-mn" id="MJXp-Span-1520">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1521" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-munderover" id="MJXp-Span-1522"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1523" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1524" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">c</span><span class="MJXp-mo" id="MJXp-Span-1526">=</span><span class="MJXp-mn" id="MJXp-Span-1527">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1532"><span class="MJXp-msubsup" id="MJXp-Span-1533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1535" style="vertical-align: -0.4em;">c</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">c</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1537" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1538" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1539" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1540"></span><span class="MJXp-mo" id="MJXp-Span-1541" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1542" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1543">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1544"><span class="MJXp-mn" id="MJXp-Span-1545" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1546" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1547"><span class=""><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1549" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550">ε</span><span class="MJXp-mo" id="MJXp-Span-1551">∈</span><span class="MJXp-mo" id="MJXp-Span-1552">{</span><span class="MJXp-mo" id="MJXp-Span-1553">±</span><span class="MJXp-mn" id="MJXp-Span-1554">1</span><span class="MJXp-msubsup" id="MJXp-Span-1555"><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1557" style="vertical-align: 0.5em;">m</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1558"><span class="MJXp-mrow" id="MJXp-Span-1559" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-1561"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1563" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">c</span><span class="MJXp-mo" id="MJXp-Span-1565">=</span><span class="MJXp-mn" id="MJXp-Span-1566">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569" style="margin-right: 0.05em;">ε</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1570" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1571" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">n</span><span class="MJXp-msubsup" id="MJXp-Span-1576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1578" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1580" style="vertical-align: 1.64em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">n</span><span class="MJXp-mo" id="MJXp-Span-1582">−</span><span class="MJXp-mn" id="MJXp-Span-1583">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1584"><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-1586"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592" style="margin-right: 0px; margin-left: 0px;">m</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1587" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1588" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">c</span><span class="MJXp-mo" id="MJXp-Span-1590">=</span><span class="MJXp-mn" id="MJXp-Span-1591">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594" style="margin-right: 0.05em;">ε</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">s</span><span class="MJXp-msubsup" id="MJXp-Span-1600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1602" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1603">⊕</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">n</span><span class="MJXp-msubsup" id="MJXp-Span-1608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1610" style="vertical-align: -0.4em;">c</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">c</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1612" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1613" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1614" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1615" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1616"></span><span class="MJXp-mo" id="MJXp-Span-1617" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1618" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1619">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1620"><span class="MJXp-mn" id="MJXp-Span-1621" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1622" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1623"><span class=""><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1625" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">ε</span><span class="MJXp-mo" id="MJXp-Span-1627">∈</span><span class="MJXp-mo" id="MJXp-Span-1628">{</span><span class="MJXp-mo" id="MJXp-Span-1629">±</span><span class="MJXp-mn" id="MJXp-Span-1630">1</span><span class="MJXp-msubsup" id="MJXp-Span-1631"><span class="MJXp-mo" id="MJXp-Span-1632" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1633" style="vertical-align: 0.5em;">m</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1634"><span class="MJXp-mrow" id="MJXp-Span-1635" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1636" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.773em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.093em; margin-left: -0.17em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">n</span><span class="MJXp-mo" id="MJXp-Span-1638" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1639">2</span><span class="MJXp-munderover" id="MJXp-Span-1640"><span class=""><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1642" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">c</span><span class="MJXp-mo" id="MJXp-Span-1644">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">p</span><span class="MJXp-msubsup" id="MJXp-Span-1647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1649" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1650">=</span><span class="MJXp-mo" id="MJXp-Span-1651">−</span><span class="MJXp-mn" id="MJXp-Span-1652">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">n</span><span class="MJXp-msubsup" id="MJXp-Span-1657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1659" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.773em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.093em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1661" style="vertical-align: 0.68em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">n</span><span class="MJXp-mo" id="MJXp-Span-1663">−</span><span class="MJXp-mn" id="MJXp-Span-1664">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1665"><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.773em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.093em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-1667"><span class=""><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1669" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670">c</span><span class="MJXp-mo" id="MJXp-Span-1671">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673">p</span><span class="MJXp-msubsup" id="MJXp-Span-1674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1676" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1677">=</span><span class="MJXp-mo" id="MJXp-Span-1678">−</span><span class="MJXp-mn" id="MJXp-Span-1679">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1680" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1681" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1682">1</span><span class="MJXp-msubsup" id="MJXp-Span-1683"><span class="MJXp-mo" id="MJXp-Span-1684" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1685" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">s</span><span class="MJXp-msubsup" id="MJXp-Span-1689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1691" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1692">⊕</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">n</span><span class="MJXp-msubsup" id="MJXp-Span-1697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1699" style="vertical-align: -0.4em;">c</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.773em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.093em; margin-left: -0.17em;">)</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-131"> \begin{align} Ans &= \frac{1}{2^m}\sum_{\varepsilon \in \{\pm 1\}^m} \left( \sum_{c=1}^m \varepsilon_c \cdot count_c \right)^{n-2}\cdot \prod_{c=1}^m \varepsilon_c^{r_c} = \nonumber \\ &= \frac{1}{2^m}\sum_{\varepsilon \in \{\pm 1\}^m} \left( \sum_{c=1}^m \varepsilon_c \cdot count_c \right)^{n-2}\left( \prod_{c=1}^m \varepsilon_c^{mask_c \oplus count_c} \right) = \nonumber \\ &= \frac{1}{2^m}\sum_{\varepsilon \in \{\pm 1\}^m} \left(n - 2\sum_{c, eps_c = -1} count_c\right)^{n-2} \left( \prod_{c, eps_c = -1} (-1)^{mask_c \oplus count_c} \right) \nonumber \end{align} </script> Now we need to group the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">ε</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-132-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-132">\varepsilon</script> sequences by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1703"><span class="MJXp-msubsup" id="MJXp-Span-1704"><span class="MJXp-mo" id="MJXp-Span-1705" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1706" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708" style="margin-right: 0.05em;">ε</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1709" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1710">=</span><span class="MJXp-mo" id="MJXp-Span-1711">−</span><span class="MJXp-mn" id="MJXp-Span-1712">1</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">n</span><span class="MJXp-msubsup" id="MJXp-Span-1717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1719" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1720" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-133">\sum_{\varepsilon_c = -1}count_c = k</script>; let's denote this set as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">g</span><span class="MJXp-mo" id="MJXp-Span-1726" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">m</span><span class="MJXp-mo" id="MJXp-Span-1728" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">k</span><span class="MJXp-mo" id="MJXp-Span-1730" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-134-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-134">Neg(m, k)</script>: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1731"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734">s</span><span class="MJXp-mo" id="MJXp-Span-1735" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1736" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1737">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1738"><span class="MJXp-mn" id="MJXp-Span-1739" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1740" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1741"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747" style="margin-right: 0px; margin-left: 0px;">n</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1742" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1743" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">k</span><span class="MJXp-mo" id="MJXp-Span-1745">=</span><span class="MJXp-mn" id="MJXp-Span-1746">0</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1748"><span class=""><span class="MJXp-mo" id="MJXp-Span-1749" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1750" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">ε</span><span class="MJXp-mo" id="MJXp-Span-1752">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">g</span><span class="MJXp-mo" id="MJXp-Span-1756">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">m</span><span class="MJXp-mo" id="MJXp-Span-1758">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">k</span><span class="MJXp-mo" id="MJXp-Span-1760">)</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1761"><span class="MJXp-mo" id="MJXp-Span-1762" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.773em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.093em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-1763"><span class=""><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1765" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1766">c</span><span class="MJXp-mo" id="MJXp-Span-1767">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769">p</span><span class="MJXp-msubsup" id="MJXp-Span-1770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1772" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1773">=</span><span class="MJXp-mo" id="MJXp-Span-1774">−</span><span class="MJXp-mn" id="MJXp-Span-1775">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1776" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1777" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1778">1</span><span class="MJXp-msubsup" id="MJXp-Span-1779"><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1781" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">s</span><span class="MJXp-msubsup" id="MJXp-Span-1785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1786" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1787" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1788">⊕</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">n</span><span class="MJXp-msubsup" id="MJXp-Span-1793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1795" style="vertical-align: -0.4em;">c</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1796" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1797" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">n</span><span class="MJXp-mo" id="MJXp-Span-1799" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1800">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">k</span><span class="MJXp-msubsup" id="MJXp-Span-1802"><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1804" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">n</span><span class="MJXp-mo" id="MJXp-Span-1806">−</span><span class="MJXp-mn" id="MJXp-Span-1807">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1808" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.773em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.093em; margin-left: -0.17em;">)</span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-135"> Ans = \frac{1}{2^m}\sum_{k=0}^n \sum_{\varepsilon \in Neg(m, k)} \left( \prod_{c, eps_c = -1} (-1)^{mask_c \oplus count_c} \cdot (n - 2k)^{n-2} \right) </script> Let's construct the polynomial <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810">A</span><span class="MJXp-mo" id="MJXp-Span-1811" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">t</span><span class="MJXp-mo" id="MJXp-Span-1813" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1814" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1815"><span class="MJXp-mo" id="MJXp-Span-1816" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821">m</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1817"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">c</span><span class="MJXp-mo" id="MJXp-Span-1819">=</span><span class="MJXp-mn" id="MJXp-Span-1820">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1822" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1823">1</span><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1826" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1827">1</span><span class="MJXp-msubsup" id="MJXp-Span-1828"><span class="MJXp-mo" id="MJXp-Span-1829" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1830" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">s</span><span class="MJXp-msubsup" id="MJXp-Span-1834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1836" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1837">⊕</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">n</span><span class="MJXp-msubsup" id="MJXp-Span-1842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1844" style="vertical-align: -0.4em;">c</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1845" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1848" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852">n</span><span class="MJXp-msubsup" id="MJXp-Span-1853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1855" style="vertical-align: -0.4em;">c</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1856" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-136">A(t) = \prod_{c=1}^m (1 + (-1)^{mask_c \oplus count_c}\cdot t^{count_c})</script> and use its coefficients to calculate the answer: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1857"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1858">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">s</span><span class="MJXp-mo" id="MJXp-Span-1861" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1862" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1863">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1864"><span class="MJXp-mn" id="MJXp-Span-1865" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1866" style="vertical-align: 0.5em;">m</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1867"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873" style="margin-right: 0px; margin-left: 0px;">n</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1868" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1869" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">k</span><span class="MJXp-mo" id="MJXp-Span-1871">=</span><span class="MJXp-mn" id="MJXp-Span-1872">0</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1876" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878">t</span><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1880" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1881" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882">n</span><span class="MJXp-mo" id="MJXp-Span-1883" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1884">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885">k</span><span class="MJXp-msubsup" id="MJXp-Span-1886"><span class="MJXp-mo" id="MJXp-Span-1887" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1888" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1889">n</span><span class="MJXp-mo" id="MJXp-Span-1890">−</span><span class="MJXp-mn" id="MJXp-Span-1891">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1892" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-137"> Ans = \frac{1}{2^m} \sum_{k=0}^n A_k(t) \cdot (n-2k)^{n-2}. </script> (consider the case <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897">n</span><span class="MJXp-msubsup" id="MJXp-Span-1898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1900" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-1901" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1902">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-138">count_c = 0</script> separately).</p><p>For the given problem constraints, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">O</span><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906">m</span><span class="MJXp-mo" id="MJXp-Span-1907" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908">n</span><span class="MJXp-mo" id="MJXp-Span-1909" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-139">O(m \cdot n)</script> polynomial multiplication time complexity is sufficient. It can be optimized further.</p></div></div></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2174" class="notice" style="text-decoration: none;">Codeforces Round 1069 (Div. 1)</a> </span>
        </div>
        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2175" class="notice" style="text-decoration: none;">Codeforces Round 1069 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>