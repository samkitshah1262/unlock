<html lang="en"><head>
        <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-K230KVN22K&amp;cx=c&amp;gtm=4e5ca1"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="9fefa991e18b2fdaa215cdd35a0d05a4">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01">
    <meta name="robots" content="noai">
    <meta name="robots" content="noimageai">

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="l3">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <link rel="image_src" href="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <meta property="og:title" content="Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2) Editorial - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2) Editorial - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/font-awesome.min.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/line-awesome.min.css" type="text/css" charset="utf-8">

        <link rel="preconnect" href="https://challenges.cloudflare.com">
        <link rel="dns-prefetch" href="https://challenges.cloudflare.com">
        <link href="//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">
        <link href="//fonts.googleapis.com/css?family=Cuprum&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.com/codeforces.org/s/52448/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.com/codeforces.org/s/52448/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.com/codeforces.org/s/52448/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.com/codeforces.org/s/52448/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.com/codeforces.org/s/52448/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.com/codeforces.org/s/52448/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.com/codeforces.org/s/52448/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.com/codeforces.org/s/52448/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.com/codeforces.org/s/52448/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="//codeforces.com/codeforces.org/s/52448/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.com/codeforces.org/s/52448/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.com/codeforces.org/s/52448/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.com/codeforces.org/s/52448/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.com/codeforces.org/s/52448/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.jgrowl.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.wysiwyg.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.autocomplete.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/codeforces.datepick.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.drafts.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/community.css" type="text/css" charset="utf-8">

    <!-- MathJax -->
    <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async="" src="https://codeforces.com/mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full">
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/5913b958cb6e1f2144469a313cc0ac6e/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/confetti.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/purify.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/skins/markitup/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/style.css" type="text/css" charset="utf-8">


    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888; display: contents}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css" media="screen">#swfcontainer {visibility:hidden}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.9') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body class=" "><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><span class="MathJax MathJax_Processed" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-140"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-141"><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-143"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mi" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-147" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-151"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-152"><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-157"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mi" id="MathJax-Span-159" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="msubsup" id="MathJax-Span-162" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-165"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Main;">log</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-168"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-169"><span class="mn" id="MathJax-Span-170" style="font-family: MathJax_Main;">3</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-171"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-172"><span class="mn" id="MathJax-Span-173" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Main; padding-left: 0.219em;">log</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-176"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-177"><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic;">x</span><span class="mtext" id="MathJax-Span-182" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-186"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-187"><span class="mtext" id="MathJax-Span-188" style="font-family: MathJax_Main;">a</span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mtext" id="MathJax-Span-193" style="font-family: MathJax_Main; padding-left: 0.273em;">a</span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-197" style="font-family: MathJax_Main; padding-left: 0.219em;">±</span><span class="mn" id="MathJax-Span-198" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-199"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-200"><span class="mtext" id="MathJax-Span-201" style="font-family: MathJax_Main;">a</span><span class="mo" id="MathJax-Span-202" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-204" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mtext" id="MathJax-Span-206" style="font-family: MathJax_Main; padding-left: 0.273em;">a</span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-211" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-212"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-213"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-215"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-216"><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-218"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-219"><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_Math-italic;">x</span><span class="mtext" id="MathJax-Span-224" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">p</span><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math-italic;">x</span><span class="mtext" id="MathJax-Span-236" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math-italic;">u</span><span class="msubsup" id="MathJax-Span-239"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.87em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.869em;"><span class="mn" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-244" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mtext" id="MathJax-Span-246" style="font-family: MathJax_Main; padding-left: 0.219em;">plus_pos.order_of_key</span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mtext" id="MathJax-Span-251" style="font-family: MathJax_Main; padding-left: 0.219em;">minus_pos.order_of_key</span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-118-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1002"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1003"><span class="mn" id="MathJax-Span-1004" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-123-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1024"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1025"><span class="mi" id="MathJax-Span-1026" style="font-family: MathJax_Math-italic;">w</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-124-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1027"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1028"><span class="mi" id="MathJax-Span-1029" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-125-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1030"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1031"><span class="mi" id="MathJax-Span-1032" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-126-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1033"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1034"><span class="msubsup" id="MathJax-Span-1035"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1036" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-1037" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1038" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-1039" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-127-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1040"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1041"><span class="mi" id="MathJax-Span-1042" style="font-family: MathJax_Math-italic;">w</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-128-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1043"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1044"><span class="msubsup" id="MathJax-Span-1045"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1046" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-1047" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1048" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-1049" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1050" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mi" id="MathJax-Span-1051" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">l</span><span class="mspace" id="MathJax-Span-1052" style="height: 0em; vertical-align: 0em; width: 0.273em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1053" style="font-family: MathJax_Main; padding-left: 0.273em;">⟹</span><span class="mspace" id="MathJax-Span-1054" style="height: 0em; vertical-align: 0em; width: 0.273em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-1055" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1056" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-1057" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1058" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mi" id="MathJax-Span-1059" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">l</span><span class="mo" id="MathJax-Span-1060" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-1061" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-129-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1062"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1063"><span class="mi" id="MathJax-Span-1064" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-130-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1065"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1066"><span class="mi" id="MathJax-Span-1067" style="font-family: MathJax_Math-italic;">p</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-131-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1068"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1069"><span class="mi" id="MathJax-Span-1070" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-132-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1071"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1072"><span class="mi" id="MathJax-Span-1073" style="font-family: MathJax_Math-italic;">p</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-133-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1074"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1075"><span class="mi" id="MathJax-Span-1076" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-134-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1077"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1078"><span class="mi" id="MathJax-Span-1079" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-135-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1080"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1081"><span class="mi" id="MathJax-Span-1082" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1083" style="font-family: MathJax_Main; padding-left: 0.219em;">∪</span><span class="mo" id="MathJax-Span-1084" style="font-family: MathJax_Main; padding-left: 0.219em;">{</span><span class="mi" id="MathJax-Span-1085" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1086" style="font-family: MathJax_Main;">}</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-136-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1087"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1088"><span class="mi" id="MathJax-Span-1089" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1090" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-1091" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1092" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="msubsup" id="MathJax-Span-1093" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1094" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-1095" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-137-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1096"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1097"><span class="mi" id="MathJax-Span-1098" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1099" style="font-family: MathJax_Main; padding-left: 0.219em;">∪</span><span class="mo" id="MathJax-Span-1100" style="font-family: MathJax_Main; padding-left: 0.219em;">{</span><span class="mi" id="MathJax-Span-1101" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1102" style="font-family: MathJax_Main;">}</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-138-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1103"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1104"><span class="mo" id="MathJax-Span-1105" style="font-family: MathJax_Main;">{</span><span class="mi" id="MathJax-Span-1106" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1107" style="font-family: MathJax_Main;">}</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-139-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1108"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1109"><span class="mi" id="MathJax-Span-1110" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1111" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="msubsup" id="MathJax-Span-1112" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1113" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-1114" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1115" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mi" id="MathJax-Span-1116" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span><span class="mo" id="MathJax-Span-1117" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-1118" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1119" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="msubsup" id="MathJax-Span-1120" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1121" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-1122" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-140-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1123"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1124"><span class="mtable" id="MathJax-Span-1125" style="min-width: 10.717em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 10.717em;"><span style="display: inline-block; position: absolute; width: 6.55em; height: 0px; clip: rect(-0.917em, 1006.55em, 0.436em, -999.997em); top: 0em; left: 50%; margin-left: -3.298em;"><span style="position: absolute; clip: rect(3.304em, 1006.55em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.55em; height: 0px;"><span style="position: absolute; clip: rect(3.249em, 1006.55em, 4.386em, -999.997em); top: -4.002em; left: 50%; margin-left: -3.298em;"><span class="mtd" id="MathJax-Span-1129"><span class="mrow" id="MathJax-Span-1130"><span class="mspace" id="MathJax-Span-1131" style="height: 0em; vertical-align: 0em; width: 0.273em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1132" style="font-family: MathJax_Main;">⟹</span><span class="mspace" id="MathJax-Span-1133" style="height: 0em; vertical-align: 0em; width: 0.273em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1134" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1135" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mi" id="MathJax-Span-1136" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span><span class="mo" id="MathJax-Span-1137" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-1138" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.301em; height: 0px; clip: rect(-0.863em, 1001.19em, 0.436em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.087em, 1001.19em, 4.44em, -999.997em); top: -4.002em; right: 0em;"><span class="mtd" id="mjx-eqn-1"><span class="mrow" id="MathJax-Span-1127"><span class="mtext" id="MathJax-Span-1128" style="font-family: MathJax_Main;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-141-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1139"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1140"><span class="mi" id="MathJax-Span-1141" style="font-family: MathJax_Math-italic;">w</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-142-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1142"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1143"><span class="mtable" id="MathJax-Span-1144" style="min-width: 8.715em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 8.715em;"><span style="display: inline-block; position: absolute; width: 4.548em; height: 0px; clip: rect(-0.917em, 1004.49em, 0.436em, -999.997em); top: 0em; left: 50%; margin-left: -2.27em;"><span style="position: absolute; clip: rect(3.195em, 1004.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.548em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1004.49em, 4.386em, -999.997em); top: -4.002em; left: 50%; margin-left: -2.27em;"><span class="mtd" id="MathJax-Span-1148"><span class="mrow" id="MathJax-Span-1149"><span class="mi" id="MathJax-Span-1150" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1151" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="msubsup" id="MathJax-Span-1152" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1153" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-1154" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1155" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mi" id="MathJax-Span-1156" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">l</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.301em; height: 0px; clip: rect(-0.863em, 1001.19em, 0.436em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.087em, 1001.19em, 4.44em, -999.997em); top: -4.002em; right: 0em;"><span class="mtd" id="mjx-eqn-2"><span class="mrow" id="MathJax-Span-1146"><span class="mtext" id="MathJax-Span-1147" style="font-family: MathJax_Main;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-143-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1157"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1158"><span class="mtable" id="MathJax-Span-1159" style="min-width: 10.501em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 10.501em;"><span style="display: inline-block; position: absolute; width: 6.334em; height: 0px; clip: rect(-0.917em, 1006.28em, 0.436em, -999.997em); top: 0em; left: 50%; margin-left: -3.136em;"><span style="position: absolute; clip: rect(3.195em, 1006.28em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.334em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1006.28em, 4.386em, -999.997em); top: -4.002em; left: 50%; margin-left: -3.136em;"><span class="mtd" id="MathJax-Span-1163"><span class="mrow" id="MathJax-Span-1164"><span class="mi" id="MathJax-Span-1165" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1166" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-1167" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1168" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="msubsup" id="MathJax-Span-1169" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1170" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-1171" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1172" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mi" id="MathJax-Span-1173" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">l</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.301em; height: 0px; clip: rect(-0.863em, 1001.19em, 0.436em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.087em, 1001.19em, 4.44em, -999.997em); top: -4.002em; right: 0em;"><span class="mtd" id="mjx-eqn-3"><span class="mrow" id="MathJax-Span-1161"><span class="mtext" id="MathJax-Span-1162" style="font-family: MathJax_Main;">(3)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-144-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1174"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1175"><span class="mo" id="MathJax-Span-1176" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1177" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1178" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-145-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1179"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1180"><span class="mo" id="MathJax-Span-1181" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1182" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1183" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-146-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1184"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1185"><span class="mo" id="MathJax-Span-1186" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1187" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-1188" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-147-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1189"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1190"><span class="msubsup" id="MathJax-Span-1191"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1192" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-1193" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1194" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mi" id="MathJax-Span-1195" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">l</span><span class="mo" id="MathJax-Span-1196" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-1197" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-148-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1198"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1199"><span class="msubsup" id="MathJax-Span-1200"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1201" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-1202" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-149-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1203"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1204"><span class="mi" id="MathJax-Span-1205" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-1206" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-1207" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-150-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1208"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1209"><span class="mi" id="MathJax-Span-1210" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-151-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1211"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1212"><span class="mo" id="MathJax-Span-1213" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-1214" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1215" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1216" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1217" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">l</span><span class="mo" id="MathJax-Span-1218" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-1219" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1220" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-174-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1454"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1455"><span class="mi" id="MathJax-Span-1456" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-175-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1457"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1458"><span class="mtable" id="MathJax-Span-1459"><span style="display: inline-block; position: relative; width: 20.133em; height: 0px; margin-right: 0.165em; margin-left: 0.165em;"><span style="position: absolute; clip: rect(3.791em, 1004.93em, 9.743em, -999.997em); top: -6.653em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.927em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1004.93em, 4.169em, -999.997em); top: -6.058em; right: 0em;"><span class="mtd" id="MathJax-Span-1460"><span class="mrow" id="MathJax-Span-1461"><span class="mtext" id="MathJax-Span-1462" style="font-family: MathJax_Main;">minimize</span><span class="mspace" id="MathJax-Span-1463" style="height: 0em; vertical-align: 0em; width: 0.977em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.249em, 1002.33em, 4.169em, -999.997em); top: -3.623em; right: 0em;"><span class="mtd" id="MathJax-Span-1478"><span class="mrow" id="MathJax-Span-1479"><span class="mtext" id="MathJax-Span-1480" style="font-family: MathJax_Main;">s.t.</span><span class="mspace" id="MathJax-Span-1481" style="height: 0em; vertical-align: 0em; width: 0.977em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.169em, -999.997em); top: -1.08em; right: 0em;"><span class="mtd" id="MathJax-Span-1528"><span class="mrow" id="MathJax-Span-1529"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.659em;"></span></span><span style="position: absolute; clip: rect(3.899em, 1015.15em, 10.933em, -999.997em); top: -7.681em; left: 4.927em;"><span style="display: inline-block; position: relative; width: 15.154em; height: 0px;"><span style="position: absolute; clip: rect(2.275em, 1002.65em, 5.36em, -999.997em); top: -6.058em; left: 0em;"><span class="mtd" id="MathJax-Span-1464"><span class="mrow" id="MathJax-Span-1465"><span class="mi" id="MathJax-Span-1466"></span><span class="munderover" id="MathJax-Span-1467" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1468" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.09em, 4.278em, -999.997em); top: -2.919em; left: 0.165em;"><span class="texatom" id="MathJax-Span-1469"><span class="mrow" id="MathJax-Span-1470"><span class="mi" id="MathJax-Span-1471" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1472" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1473" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -5.138em; left: 0.49em;"><span class="mi" id="MathJax-Span-1474" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1475" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1476" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="mi" id="MathJax-Span-1477" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(2.871em, 1015.15em, 5.576em, -999.997em); top: -3.623em; left: 0em;"><span class="mtd" id="MathJax-Span-1482"><span class="mrow" id="MathJax-Span-1483"><span class="mi" id="MathJax-Span-1484" style="font-family: MathJax_Main;">∀</span><span class="mi" id="MathJax-Span-1485" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1486" style="font-family: MathJax_Main;">,</span><span class="munderover" id="MathJax-Span-1487" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 2.113em;"><span class="mo" id="MathJax-Span-1488" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1005.68em, 4.44em, -999.997em); top: -2.865em; left: 0em;"><span class="texatom" id="MathJax-Span-1489"><span class="mrow" id="MathJax-Span-1490"><span class="mo" id="MathJax-Span-1491" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1492" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1493" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1494" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1495" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1496" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1497" style="font-size: 70.7%; font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1498" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1499" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1500" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1501" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1502" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1503" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1504" style="font-size: 70.7%; font-family: MathJax_Main;">∉</span><span class="mi" id="MathJax-Span-1505" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1506" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1507" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-1508"><span class="mrow" id="MathJax-Span-1509"><span class="mo" id="MathJax-Span-1510" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1511" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1512" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1513" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1514" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1515" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="munderover" id="MathJax-Span-1516" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1517" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.41em, 4.278em, -999.997em); top: -2.865em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1518"><span class="mrow" id="MathJax-Span-1519"><span class="mi" id="MathJax-Span-1520" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1521" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1522" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1523" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1524" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="mi" id="MathJax-Span-1525" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1526" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mi" id="MathJax-Span-1527" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">l</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.195em, 1002.65em, 4.332em, -999.997em); top: -1.08em; left: 0em;"><span class="mtd" id="MathJax-Span-1530"><span class="mrow" id="MathJax-Span-1531"><span class="msubsup" id="MathJax-Span-1532"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1533" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="mi" id="MathJax-Span-1534" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1535" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mn" id="MathJax-Span-1536" style="font-family: MathJax_Main; padding-left: 0.273em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.687em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-176-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1537"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1538"><span class="mtable" id="MathJax-Span-1539"><span style="display: inline-block; position: relative; width: 19.375em; height: 0px; margin-right: 0.165em; margin-left: 0.165em;"><span style="position: absolute; clip: rect(4.007em, 1005.14em, 10.014em, -999.997em); top: -6.707em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.143em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1005.14em, 4.169em, -999.997em); top: -5.896em; right: 0em;"><span class="mtd" id="MathJax-Span-1540"><span class="mrow" id="MathJax-Span-1541"><span class="mtext" id="MathJax-Span-1542" style="font-family: MathJax_Main;">maximize</span><span class="mspace" id="MathJax-Span-1543" style="height: 0em; vertical-align: 0em; width: 0.977em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.249em, 1002.33em, 4.169em, -999.997em); top: -3.244em; right: 0em;"><span class="mtd" id="MathJax-Span-1586"><span class="mrow" id="MathJax-Span-1587"><span class="mtext" id="MathJax-Span-1588" style="font-family: MathJax_Main;">s.t.</span><span class="mspace" id="MathJax-Span-1589" style="height: 0em; vertical-align: 0em; width: 0.977em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.169em, -999.997em); top: -0.863em; right: 0em;"><span class="mtd" id="MathJax-Span-1607"><span class="mrow" id="MathJax-Span-1608"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.713em;"></span></span><span style="position: absolute; clip: rect(4.169em, 1013.91em, 11.637em, -999.997em); top: -8.168em; left: 5.143em;"><span style="display: inline-block; position: relative; width: 14.234em; height: 0px;"><span style="position: absolute; clip: rect(2.221em, 1013.91em, 5.901em, -999.997em); top: -6.22em; left: 0em;"><span class="mtd" id="MathJax-Span-1544"><span class="mrow" id="MathJax-Span-1545"><span class="mi" id="MathJax-Span-1546"></span><span class="munderover" id="MathJax-Span-1547" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1548" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1000.54em, 4.278em, -999.997em); top: -2.865em; left: 0.436em;"><span class="mi" id="MathJax-Span-1549" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1550" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.085em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1551" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1552" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1553" style="padding-left: 0.165em;"><span class="mo" id="MathJax-Span-1554" style="vertical-align: 1.951em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.865em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -1.296em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-1555" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-1556" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="munderover" id="MathJax-Span-1557" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 2.113em;"><span class="mo" id="MathJax-Span-1558" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1005.68em, 4.44em, -999.997em); top: -2.865em; left: 0em;"><span class="texatom" id="MathJax-Span-1559"><span class="mrow" id="MathJax-Span-1560"><span class="mo" id="MathJax-Span-1561" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1562" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1563" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1564" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1565" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1566" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1567" style="font-size: 70.7%; font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1568" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1569" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1570" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1571" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1572" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1573" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1574" style="font-size: 70.7%; font-family: MathJax_Main;">∉</span><span class="mi" id="MathJax-Span-1575" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1576" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1577" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-1578"><span class="mrow" id="MathJax-Span-1579"><span class="mo" id="MathJax-Span-1580" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1581" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1582" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1583" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1584" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1585" style="vertical-align: 1.951em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.865em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -1.296em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.332em;"></span></span><span style="position: absolute; clip: rect(2.871em, 1006.01em, 5.414em, -999.997em); top: -3.244em; left: 0em;"><span class="mtd" id="MathJax-Span-1590"><span class="mrow" id="MathJax-Span-1591"><span class="mi" id="MathJax-Span-1592" style="font-family: MathJax_Main;">∀</span><span class="mi" id="MathJax-Span-1593" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1594" style="font-family: MathJax_Main;">,</span><span class="munderover" id="MathJax-Span-1595" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-1596" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.41em, 4.278em, -999.997em); top: -2.865em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1597"><span class="mrow" id="MathJax-Span-1598"><span class="mi" id="MathJax-Span-1599" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1600" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1601" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1602" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.085em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1603" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1604" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1605" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mn" id="MathJax-Span-1606" style="font-family: MathJax_Main; padding-left: 0.273em;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.195em, 1002.87em, 4.386em, -999.997em); top: -0.863em; left: 0em;"><span class="mtd" id="MathJax-Span-1609"><span class="mrow" id="MathJax-Span-1610"><span class="msubsup" id="MathJax-Span-1611"><span style="display: inline-block; position: relative; width: 1.085em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1612" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-1613" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1614" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mn" id="MathJax-Span-1615" style="font-family: MathJax_Main; padding-left: 0.273em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.174em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-177-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-178-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-179-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-180-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-181-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-182-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-183-Frame" tabindex="0"></span><br></div></div><div id="MathJax_Message" style="display: none;"></div><span style="display:none;" class="csrf-token" data-csrf="9fefa991e18b2fdaa215cdd35a0d05a4">&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }, beforeSend: function(jqXHR, settings) {
        const url = new URL(settings.url, window.location.href);
        const urlHref = url.href;
        url.searchParams.set('rv', Math.random().toString(36).substr(2, 9)); // Generate a random value
        settings.url = url.href;
    }});

    window.updateTypography();
    Codeforces.signForms();
    Codeforces.applyDatatableJs("Hold Ctrl+Alt and click to hide column. Also, you can drag&drop columns to reorder them.");

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        if (json.t === "a") {
            setTimeout(function() {
               Codeforces.showAnnouncements(json.d, "en");
            }, Math.random() * 500);
        }
    }

    function showEventCatcherUserMessage(json) {
        if (json.t === "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        const title = $(this).attr("data-title");
        const clazz = $(this).attr("data-clazz");
        const props = {};
        if (typeof (clazz) !== 'undefined') {
            props['clazz'] = clazz;
        }
        if (title) {
            Codeforces.alert(title, null, null, props);
        } else {
            Codeforces.alert($(this).attr("title"), null, null, props);
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
        

<div class="side-bell" style="visibility: hidden; display: none; opacity: 0.7; width: 40px; position: fixed; right: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 1.5rem;">
    <span class="icon-stack" style="width: 100%;">
        <i class="icon-circle icon-stack-base"></i>
        <i class="icon-bell-alt icon-light"></i>
    </span>
    <br>
    <span class="side-bell__count" style="position: relative; top: -10px;"></span>
</div>


<div id="header" style="position: relative;">

    <div style="float:left; max-height: 60px;">
                            <a href="/"><img height="65" style="height: 65px;" alt="Codeforces" title="Codeforces" src="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png"></a>
    </div>
    <div class="lang-chooser">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" title="In English" alt="In English"></a>
                <a href="?locale=ru"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/ru.png" title="По-русски" alt="По-русски"></a>
            </div>

        <div>
                        <a href="/enter?back=%2Fblog%2Fentry%2F146988">Enter</a>
                     | 
                        <a href="/register">Register</a>
                    
        </div>

    </div>
    <br style="clear: both;">
</div>

        


    <div class="roundbox menu-box borderTopRound borderBottomRound" style="">
    <div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="/">Home</a></li>
                <li class=""><a href="/top">Top</a></li>
                <li class=""><a href="/catalog">Catalog</a></li>
                <li class=""><a href="/contests">Contests</a></li>
                <li class=""><a href="/gyms">Gym</a></li>
                <li class=""><a href="/problemset">Problemset</a></li>
                <li class=""><a href="/groups">Groups</a></li>
                <li class=""><a href="/ratings">Rating</a></li>
                <li class=""><a href="/edu/courses"><span class="edu-menu-item">Edu</span></a></li>
                <li class=""><a href="/apiHelp">API</a></li>
                <li class=""><a href="/calendar">Calendar</a></li>
                <li class=""><a href="/help">Help</a></li>
    </ul>
        <form method="post" action="/search"><input type="hidden" name="csrf_token" value="9fefa991e18b2fdaa215cdd35a0d05a4">
            <input class="search" name="query" data-isplaceholder="true" value="">
        <input type="hidden" name="_tta" value="196"></form>
    <br style="clear: both;">
</div>

    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("input.search").focus(function () {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
        
            <br style="height: 3em; clear: both;">

        <div style="position: relative;">
                        <div id="sidebar">

    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Pay attention
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
        <div style="text-align:center;">
            <span class="contest-state-phase">Before contest</span><br><a href="/contests/2181">2025-2026 ICPC, NERC, Northern Eurasia Finals (Unrated, Online Mirror, ICPC Rules, Teams Preferred)</a><br><span class="countdown" home="//codeforces.com/codeforces.org/s/52448" noredirection="true" textbeforeredirect="" cdid="i1"><span title="68:23:47">3 days</span></span><br><a href="/contestRegistration/2181">Register now »</a>
        </div>
</div>
    </div>

<style data-nocturne="true" type="text/css">
._StreamsSidebarFrame_frame {
  padding: 0.5em 0.5em 0 0.5em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream {
  text-align: center;
  border-bottom: 1px solid #b9b9b9;
  margin: 0 -0.5em 0.5em -0.5em;
  padding: 0 1em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_user {
  margin: 0 0 0.5em 0;
  font-size: 0.8em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_timeMark {
  color: #777;
  font-size: 0.9em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream:last-of-type {
  border-bottom: unset;
  margin: unset;
  padding: 0 0.5em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._viewAll {
  text-align: right;
}
.moreRunningStreamsSidebarNote {
  color: #777 !important;
  text-decoration: none;
}
</style>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Streams
            <div class="top-links">
            </div>
        </div>
            <div class="_StreamsSidebarFrame_frame">
                    <div class="_StreamsSidebarFrame_stream">
                        <div class="_StreamsSidebarFrame_name">
        <p class="_englishName _name">
            
            <a href="/stream/865">Repovive Opening Contest — Solution Discussion</a>
        </p>

                        </div>

                        <div class="_StreamsSidebarFrame_user">
                            By <a href="/profile/Shayan" title="International Grandmaster Shayan" class="rated-user user-red">Shayan</a>
                        </div>

                            <div class="_StreamsSidebarFrame_countdown _StreamsSidebarFrame_timeMark">
                                Before stream
                                <span class="countdown" noredirection="true" cdid="i2">05:58:46</span>
                            </div>
                    </div>
            </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/streams">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

<script data-nocturne="true"> $(function () {

}); </script>


<div class="roundbox sidebox top-contributed borderTopRound " style="">
<div class="caption titled">→ Top rated
<div class="top-links">
</div>
</div>
<table class="rtable ">
<tbody>
<tr>
<th class="left" style="width:2.25em;">#</th>
<th class="">User</th>
<th class="" style="width:5em;">Rating</th>
</tr>
<tr>
<td class="left dark">1</td>
<td class=" dark"><a href="/profile/Kevin114514" title="Legendary Grandmaster Kevin114514" class="rated-user user-legendary"><span class="legendary-user-first-letter">K</span>evin114514</a></td>
<td class=" dark">3765</td>
</tr>
<tr>
<td class="left ">2</td>
<td class=""><a href="/profile/tourist" title="Legendary Grandmaster tourist" class="rated-user user-legendary"><span class="legendary-user-first-letter">t</span>ourist</a></td>
<td class="">3757</td>
</tr>
<tr>
<td class="left dark">3</td>
<td class=" dark"><a href="/profile/Benq" title="Legendary Grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></td>
<td class=" dark">3738</td>
</tr>
<tr>
<td class="left ">4</td>
<td class=""><a href="/profile/jiangly" title="Legendary Grandmaster jiangly" class="rated-user user-legendary"><span class="legendary-user-first-letter">j</span>iangly</a></td>
<td class="">3705</td>
</tr>
<tr>
<td class="left dark">5</td>
<td class=" dark"><a href="/profile/orzdevinwang" title="Legendary Grandmaster orzdevinwang" class="rated-user user-legendary"><span class="legendary-user-first-letter">o</span>rzdevinwang</a></td>
<td class=" dark">3670</td>
</tr>
<tr>
<td class="left ">6</td>
<td class=""><a href="/profile/ksun48" title="Legendary Grandmaster ksun48" class="rated-user user-legendary"><span class="legendary-user-first-letter">k</span>sun48</a></td>
<td class="">3668</td>
</tr>
<tr>
<td class="left dark">7</td>
<td class=" dark"><a href="/profile/Radewoosh" title="Legendary Grandmaster Radewoosh" class="rated-user user-legendary"><span class="legendary-user-first-letter">R</span>adewoosh</a></td>
<td class=" dark">3531</td>
</tr>
<tr>
<td class="left ">8</td>
<td class=""><a href="/profile/maroonrk" title="Legendary Grandmaster maroonrk" class="rated-user user-legendary"><span class="legendary-user-first-letter">m</span>aroonrk</a></td>
<td class="">3443</td>
</tr>
<tr>
<td class="left dark">9</td>
<td class=" dark"><a href="/profile/dXqwq" title="Legendary Grandmaster dXqwq" class="rated-user user-legendary"><span class="legendary-user-first-letter">d</span>Xqwq</a></td>
<td class=" dark">3436</td>
</tr>
<tr>
<td class="left bottom">10</td>
<td class="bottom"><a href="/profile/Nachia" title="Legendary Grandmaster Nachia" class="rated-user user-legendary"><span class="legendary-user-first-letter">N</span>achia</a></td>
<td class="bottom">3432</td>
</tr>
</tbody>
</table>
<div class="bottom-links">
<table style="width:100%;">
<tbody>
<tr>
<td style="text-align:left;">
<a href="/ratings/countries">Countries</a> |
<a href="/ratings/cities">Cities</a> |
<a href="/ratings/organizations">Organizations</a>
</td>
<td style="text-align:right;">
<a href="/ratings">View all →</a>
</td>
</tr>
</tbody>
</table>
</div>
</div>


    <div class="roundbox sidebox top-contributed borderTopRound " style="">
        <div class="caption titled">→ Top contributors
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:2.25em;">#</th>
                            <th class="">User</th>
                            <th class="" style="width:5em;">Contrib.</th>
                </tr>
                    <tr>
                                <td class="left  dark">1</td>
                                <td class=" dark"><a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a></td>
                                <td class=" dark">169</td>
                    </tr>
                    <tr>
                                <td class="left ">2</td>
                                <td class=""><a href="/profile/Qingyu" title="Legendary Grandmaster Qingyu" class="rated-user user-legendary"><span class="legendary-user-first-letter">Q</span>ingyu</a></td>
                                <td class="">166</td>
                    </tr>
                    <tr>
                                <td class="left  dark">3</td>
                                <td class=" dark"><a href="/profile/errorgorn" title="Legendary Grandmaster errorgorn" class="rated-user user-legendary"><span class="legendary-user-first-letter">e</span>rrorgorn</a></td>
                                <td class=" dark">163</td>
                    </tr>
                    <tr>
                                <td class="left ">4</td>
                                <td class=""><a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a></td>
                                <td class="">156</td>
                    </tr>
                    <tr>
                                <td class="left  dark">5</td>
                                <td class=" dark"><a href="/profile/Proof_by_QED" title="Master Proof_by_QED" class="rated-user user-orange">Proof_by_QED</a></td>
                                <td class=" dark">152</td>
                    </tr>
                    <tr>
                                <td class="left ">6</td>
                                <td class=""><a href="/profile/Dominater069" title="Legendary Grandmaster Dominater069" class="rated-user user-legendary"><span class="legendary-user-first-letter">D</span>ominater069</a></td>
                                <td class="">150</td>
                    </tr>
                    <tr>
                                <td class="left  dark">7</td>
                                <td class=" dark"><a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a></td>
                                <td class=" dark">149</td>
                    </tr>
                    <tr>
                                <td class="left ">8</td>
                                <td class=""><a href="/profile/TheScrasse" title="Grandmaster TheScrasse" class="rated-user user-red">TheScrasse</a></td>
                                <td class="">144</td>
                    </tr>
                    <tr>
                                <td class="left  dark">9</td>
                                <td class=" dark"><a href="/profile/soullless" title="Master soullless" class="rated-user user-orange">soullless</a></td>
                                <td class=" dark">143</td>
                    </tr>
                    <tr>
                                <td class="left bottom">10</td>
                                <td class="bottom"><a href="/profile/Arpa" title="International Master Arpa" class="rated-user user-orange">Arpa</a></td>
                                <td class="bottom">141</td>
                    </tr>
            </tbody>
        </table>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/top-contributed">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
        });
    </script>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Find user
            <div class="top-links">
            </div>
        </div>
        <form class="handleForm" method="post" autocomplete="off"><input type="hidden" name="csrf_token" value="9fefa991e18b2fdaa215cdd35a0d05a4">
            <div style="padding:1em;text-align:right;">
                <label style="padding-right:1em;">Handle:
                    <input style="width:12em;" type="text" class="handleBox ac_input" autocomplete="off">
                </label>
            </div>
            <div style="padding: 0 1em 1em 1em;text-align:right;">
                <input style="height:1.65em;padding:0 0.75em;" type="submit" value="Find">
            </div>
        <input type="hidden" name="_tta" value="196"></form>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".handleBox").autocompleteHandle();
    $(".handleForm").attr("autocomplete", "off").submit(function () {
        var link = "/profile/userHandle".replace(
            "userHandle", $(this).find(".handleBox").val()
        );
        window.location = link;
        return false;
    });
        });
    </script>





    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Recent actions
            <div class="top-links">
            </div>
        </div>
        <div class="recent-actions">
            <ul>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ABalobanov" title="Expert ABalobanov" class="rated-user user-blue">ABalobanov</a>        →
        <a href="/blog/entry/149154">Codeforces Round 1070 (Div.2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/atcoder_official" title="Unrated, atcoder_official" class="rated-user user-black">atcoder_official</a>        →
        <a href="/blog/entry/149183">AtCoder Beginner Contest 436 Announcement</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/147893">Hacker Cup Round 1 Recap</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/MathModel" title="Expert MathModel" class="rated-user user-blue">MathModel</a>        →
        <a href="/blog/entry/149013">Invitation to Eolymp Blitz #8 (Rating Upto 1750)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Coxin_Hor" title="Expert Coxin_Hor" class="rated-user user-blue">Coxin_Hor</a>        →
        <a href="/blog/entry/149220">A fun contest I created myself.</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/saPaul" title="Pupil saPaul" class="rated-user user-green">saPaul</a>        →
        <a href="/blog/entry/149221">[Update] CF FetchCodes v25.12.7: Smart Retries, Lazy Loading &amp; Instant Caching!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a>        →
        <a href="/blog/entry/149218">Finding all primes up to half a billion in 83 ms</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/awoo" title="Grandmaster awoo" class="rated-user user-red">awoo</a>        →
        <a href="/blog/entry/117791">Educational Codeforces Round 151 Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/alireza_kaviani" title="International Grandmaster alireza_kaviani" class="rated-user user-red">alireza_kaviani</a>        →
        <a href="/blog/entry/148411">Repovive Opening Contest</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/flamestorm" title="International Master flamestorm" class="rated-user user-orange">flamestorm</a>        →
        <a href="/blog/entry/104310">Codeforces Round #803 (Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SilverTongue1729" title="Candidate Master SilverTongue1729" class="rated-user user-violet">SilverTongue1729</a>        →
        <a href="/blog/entry/149213">Codeforces Profile Preview — Chrome Extension</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Xiaohuba" title="Master Xiaohuba" class="rated-user user-orange">Xiaohuba</a>        →
        <a href="/blog/entry/148062">Codeforces Global Round 30</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Ashwanth.K" title="Master Ashwanth.K" class="rated-user user-orange">Ashwanth.K</a>        →
        <a href="/blog/entry/149201">SOS DP easy understanding</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/BreakingNut" title="Specialist BreakingNut" class="rated-user user-cyan">BreakingNut</a>        →
        <a href="/blog/entry/149177">Solved the Problem, Lost the Girlfriend</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ProblemTerminator" title="International Master ProblemTerminator" class="rated-user user-orange">ProblemTerminator</a>        →
        <a href="/blog/entry/149005">pls ban cheater sinha_yash and rollback the rating</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a>        →
        <a href="/blog/entry/137325">GIFs in Problem Statements are Broken</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a>        →
        <a href="/blog/entry/146705">On AI ruining "solving math problems with computer" [a year later]</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/m_manasc" title="Pupil m_manasc" class="rated-user user-green">m_manasc</a>        →
        <a href="/blog/entry/149219">An interesting problem</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/148802">Meta Hacker Cup Round 3</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Top12" title="Expert Top12" class="rated-user user-blue">Top12</a>        →
        <a href="/blog/entry/149216">From TLE to AC using magic!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/TheScrasse" title="Grandmaster TheScrasse" class="rated-user user-red">TheScrasse</a>        →
        <a href="/blog/entry/148631">Codeforces Round 1066 (Div. 1 + Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/MohamedAboOkail" title="Specialist MohamedAboOkail" class="rated-user user-cyan">MohamedAboOkail</a>        →
        <a href="/blog/entry/149116">Removing the cheaters</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ibrm" title="Candidate Master ibrm" class="rated-user user-violet">ibrm</a>        →
        <a href="/blog/entry/147532">Bots?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Shisuko" title="Master Shisuko" class="rated-user user-orange">Shisuko</a>        →
        <a href="/blog/entry/149199">2025 ICPC Asia Manila Regional (Gym) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/amankbps" title="Specialist amankbps" class="rated-user user-cyan">amankbps</a>        →
        <a href="/blog/entry/142846">sliding window or(CSES)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
            </ul>
        </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/recent-actions">Detailed →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>
</div>
                        <div id="pageContent" class="content-with-sidebar">
                    <div class="second-level-menu">
<ul class="second-level-menu-list"><li class="backLava" style="position: absolute; display: block; margin: 0px; padding: 0px; left: 62.6406px; top: 0px; width: 39px; height: 20px;"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li><a href="/profile/ko_osaga">ko_osaga</a></li>
        <li class="current selectedLava"><a href="/blog/ko_osaga">Blog</a></li>
        <li><a href="/teams/with/ko_osaga">Teams</a></li>
        <li><a href="/submissions/ko_osaga">Submissions</a></li>
        <li><a href="/groups/with/ko_osaga">Groups</a></li>
        <li><a href="/contests/with/ko_osaga">Contests</a></li>
        <li><a href="/contests/writer/ko_osaga">Problemsetting</a></li>
        <li><a href="/streams/ko_osaga">Streams</a></li>
</ul>
</div>
    <div style="margin-top:0;">
    <div>
        <h3><a href="/blog/ko_osaga" style="text-decoration:none;color:black !important;">ko_osaga's blog</a></h3>
    </div>
        <div style="margin-top:2em;">


<div class="has-topic-id topic" topicid="147629">
    <div class="title">
            <a href="/blog/entry/146988">            <p>Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2) Editorial</p>
</a>
    </div>

        <div class="info" style="position:relative;">
                By&nbsp;<a href="/profile/ko_osaga" title="Legendary Grandmaster ko_osaga" class="rated-user user-legendary"><span class="legendary-user-first-letter">k</span>o_osaga</a>,
                    <a href="/topic/147629/en2">history</a>,
                    <span class="format-humantime" title="Oct/03/2025 18:16 UTC">2 months ago</span>,
                
                <img style="position: relative;top: 5px;" src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" alt="In English" title="In English">



            <div class="topic-actions smaller">
                <ul>


                </ul>
            </div>
        </div>

    <div class="content">
        <div class="ttypography"><p>Thank you for your participation!</p><p>Problem A, B were authored by <a class="rated-user user-orange" href="/profile/djm03178" title="Master djm03178">djm03178</a>.</p><p>Problem C was authored by <a class="rated-user user-red" href="/profile/as_dfsdf" title="International Grandmaster as_dfsdf">as_dfsdf</a>.</p><p>Problem D was authored by <a class="rated-user user-red" href="/profile/qwerasdfzxcl" title="Grandmaster qwerasdfzxcl">qwerasdfzxcl</a>.</p><p>Problem E, F, G, H1, H2 were authored by <a class="rated-user user-legendary" href="/profile/ko_osaga" title="Legendary Grandmaster ko_osaga"><span class="legendary-user-first-letter">k</span>o_osaga</a>.</p><p><a href="/contest/2152/problem/A">2152A - Increase or Smash</a></p> <div class="spoiler"><b class="spoiler-title">Spoiler</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2152/problem/A" title="Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2)">2152A - Increase or Smash</a></h3><div class="ttypography"><div class="problem-statement"><div><p>For simplicity, we'll define $$$m$$$ as the number of distinct elements in the array $$$a$$$; i.e. $$$m = |set(a)|$$$.</p><p>Observe that it is never optimal to perform the same operation in a row, because they can be done in one operation. Also, because all elements are $$$0$$$ initially and the target array contains no $$$0$$$, the first and the last operation will be <span class="tex-font-style-bf">increase</span> operations. Therefore, any optimal order of operation will repeat (<span class="tex-font-style-bf">increase</span> — <span class="tex-font-style-bf">smash</span>) $$$0$$$ or more times and then end with an <span class="tex-font-style-bf">increase</span> operation.</p><p>Because <span class="tex-font-style-bf">increase</span> operations do not affect $$$m$$$, we need to use a <span class="tex-font-style-bf">smash</span> operation to increase $$$m$$$ by at most $$$1$$$. With these constraints, the lower bound of the answer is $$$2m-1$$$ for the given target array. We will show a process to find a possible order of operations to achieve this lower bound.</p><p>Let arrays $$$t$$$ and $$$s$$$ be the target array. $$$a$$$ starts with $$$n$$$ zeros. </p><ol> <li> Remove all duplicates from $$$s$$$. </li><li> Sort $$$s$$$ in decreasing order. </li><li> For $$$i=1 ... m-1$$$: <ol> <li> Perform an <span class="tex-font-style-bf">increase</span> operation with $$$x=s_i-s_{i+1}$$$. </li><li> Perform a <span class="tex-font-style-bf">smash</span> operation on all $$$a_j$$$ where $$$t_j = s_{i+1}$$$. </li></ol> </li><li> Perform an <span class="tex-font-style-bf">increase</span> operation with $$$x=s_m$$$. </li></ol><p>Note that $$$s_i = s_m + \sum_{j=i}^{m-1}{s_j-s_{j+1}}$$$, and the <span class="tex-font-style-bf">increase</span> operation is applied to all $$$a_j$$$ where $$$t_j=s_i$$$ just as the formula after the last <span class="tex-font-style-bf">smash</span> operation applied to them.</p><p>Since we do not actually need to perform these operations, simply finding $$$m$$$ and printing $$$2m-1$$$ suffice. Some ways to find $$$m$$$ are: </p><ul> <li> Insert all elements in a set and get its size. For example, 'std::set' in C++ or 'set' in Python. </li><li> Sort the array and count the number of $$$a_i$$$ where $$$i=n$$$ or $$$a_i \ne a_{i+1}$$$. Library functions such as 'std::unique' in C++ can also be used. </li><li> Make an array $$$c_1 ... c_{100}$$$ and mark all $$$c_{a_i}$$$ with $$$1$$$, then find the sum of $$$c$$$. </li></ul></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">set</span><span class="str">&lt;int&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
			cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
			s</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> s</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2152/problem/B">2152B - Catching the Krug</a></p> <div class="spoiler"><b class="spoiler-title">Spoiler</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2152/problem/B" title="Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2)">2152B - Catching the Krug</a></h3><div class="ttypography"><div class="problem-statement"><div><p>We will find the lower and upper bound for the Krug's <span class="tex-font-style-it">survival time</span> with simple strategies for the Krug and Doran, and show that these bounds overlap at a single point.</p><p>Assume that $$$r_K &lt; r_D$$$. In this case, the Krug can always run all the way to the $$$0$$$-th row before getting <span class="tex-font-style-it">caught</span>, and it takes $$$r_D$$$ time for Doran to reach the same row as the Krug. Similarly, if $$$r_K &gt; r_D$$$, it takes $$$n - r_D$$$ time for Doran to reach the same row as Krug if the Krug runs to the $$$n$$$-th row. The same strategy can be applied column-wise too. Therefore, the lower bound of the Krug's <span class="tex-font-style-it">survival time</span> is:</p><p>$$$$$$ \max{ \begin{cases} \begin{cases} r_D, &amp; (r_K &lt; r_D) \\ n-r_D, &amp; (r_K &gt; r_D) \\ 0 &amp; (r_K = r_D) \end{cases}\\ \begin{cases} c_D, &amp; (c_K &lt; c_D) \\ n-c_D, &amp; (c_K &gt; c_D) \\ 0 &amp; (c_K = c_D) \end{cases}\\ \end{cases} } $$$$$$</p><p>Now assume a greedy strategy for Doran; i.e. Doran always moves to a cell that minimizes the absolute difference of row and column between Doran and the Krug. Let these differences be $$$d_r$$$ and $$$d_c$$$, respectively. Then after each pair of the Krug and Doran's moves, each of $$$d_r$$$ and $$$d_c$$$ is reduced (or remains at $$$0$$$) unless the Krug moved to the opposite direction of Doran for the respective axis. Since the Krug can make such move only until she reaches the edge of the grid of each axis (possibly not both, but does not matter), the upper bound of the Krug's <span class="tex-font-style-it">survival time</span> is also maximum of the time until Doran reaches that edge.</p><p>On a side note, the answer remains the same even if the Krug can choose only one direction to move at the beginning, or if the Krug can also move diagonally.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">

	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> ra</span><span class="pun">,</span><span class="pln"> ca</span><span class="pun">,</span><span class="pln"> rb</span><span class="pun">,</span><span class="pln"> cb</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> ra </span><span class="pun">&gt;&gt;</span><span class="pln"> ca </span><span class="pun">&gt;&gt;</span><span class="pln"> rb </span><span class="pun">&gt;&gt;</span><span class="pln"> cb</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rb </span><span class="pun">&gt;</span><span class="pln"> ra</span><span class="pun">)</span><span class="pln">
			ans </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> rb</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rb </span><span class="pun">&lt;</span><span class="pln"> ra</span><span class="pun">)</span><span class="pln">
			ans </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> rb</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cb </span><span class="pun">&gt;</span><span class="pln"> ca</span><span class="pun">)</span><span class="pln">
			ans </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> cb</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cb </span><span class="pun">&lt;</span><span class="pln"> ca</span><span class="pun">)</span><span class="pln">
			ans </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> cb</span><span class="pun">);</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2152/problem/C">2152C - Triple Removal</a></p> <div class="spoiler"><b class="spoiler-title">Spoiler</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2152/problem/C" title="Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2)">2152C - Triple Removal</a></h3><div class="ttypography"><div class="problem-statement"><div><p>The answer to the query is $$$-1$$$ if either the number of zeros or the number of ones is not a multiple of $$$3$$$. If it is possible to make the array $$$[a_l, \cdots, a_r]$$$ empty, the minimum total cost is at least $$$(r-l+1)/3$$$, since each operation costs at least $$$1$$$ and removes exactly three elements.</p><p>An operation of cost 1 can be viewed as removing two adjacent elements along with a third element.</p><p>Observation 1. Suppose it is possible to make an array $$$A$$$ empty, and $$$A$$$ contains at least one pair of adjacent identical elements. Then, the minimum total cost is $$$|A|/3$$$.</p><p>Based on the observation, the answer to the query $$$[l, r]$$$ is as follows: </p><ul><li> If the number of zeros or ones in $$$[l, r]$$$ is not a multiple of $$$3$$$, the answer is $$$-1$$$. </li><li> If the number of zeros or ones in $$$[l, r]$$$ is a multiple of $$$3$$$ and $$$a_i = a_{i+1}$$$ for some $$$l \le i &lt; r$$$, the answer is $$$(r-l+1)/3$$$. </li><li> Otherwise, the subarray is alternating ($$$0101\cdots 01$$$ or $$$1010\cdots 10$$$). In this case, after applying one operation with cost $$$2$$$, some pair of identical elements becomes adjacent. Thus, the minimum cost is $$$2 + (r-l-2)/3$$$. </li></ul><p>Detailed proof of the observation:</p><p>It is sufficient to show that we can perform operations of cost $$$1$$$ in such a way that either the array becomes empty or there is at least one pair of identical adjacent elements in the remaining array.</p><p>First, consider the case where there are adjacent zeros and adjacent ones. In this situation, we can remove all pairs of adjacent zeros (or ones) with cost $$$1$$$ operations. Therefore, we can reduce to the case where either zeros or ones are not adjacent to each other. Without loss of generality, assume that all ones in the array are not adjacent.</p><p>Let $$$3k$$$ denote the total number of ones in the array. Define $$$c_i$$$ as the number of zeros between the $$$i$$$-th one and the $$$(i+1)$$$-th one for $$$i = 1, \dots, 3k-1$$$. Let $$$c_0$$$ and $$$c_{3k}$$$ denote the number of zeros before the first one and after the last one, respectively. Since no two ones are adjacent in the array, we have $$$c_1, \dots, c_{3k-1} \ge 1$$$. </p><ul> <li> Suppose that there are two indices $$$i, j$$$ such that $$$c_j \ge 2, 0 &lt; i &lt; 3k, 0 \le j \le 3k$$$, and $$$i\ne j$$$. Then it is possible to perform the operations of cost $$$1$$$ to remove every $$$0$$$s between $$$i$$$-th $$$1$$$ and $$$(i+1)$$$-th $$$1$$$. </li><li> Otherwise, $$$c_1=c_2 =\cdots =c_{3k-1}=1$$$ and $$$c_0, c_{3k} \le 1$$$. In this case, every pair of adjacent elements in $$$[a_l, a_{l+1}, \cdots, a_r]$$$ is different. </li></ul></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">/*
* T1 Thanks Round
* Problem triple-removal
* Main Correct Solution
*/</span><span class="pln">

</span><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAX </span><span class="pun">=</span><span class="pln"> </span><span class="lit">250</span><span class="str">'010;

int A[MAX];

int diff[MAX];
int diffsum[MAX];

int sum[2][MAX];

void solve() {
	int N, Q;
	cin &gt;&gt; N &gt;&gt; Q;
	int i;
	for (i = 1; i &lt;= N; i++) cin &gt;&gt; A[i];
	for (i = 1; i &lt;= N; i++) {
		sum[0][i] = sum[0][i - 1];
		sum[1][i] = sum[1][i - 1];
		sum[A[i]][i]++;

		diff[i] = A[i] != A[i - 1];
		diffsum[i] = diffsum[i - 1] + diff[i];
	}
	int l, r;
	for (i = 1; i &lt;= Q; i++) {
		cin &gt;&gt; l &gt;&gt; r;

		int z, o;
		z = sum[0][r] - sum[0][l - 1];
		o = sum[1][r] - sum[1][l - 1];
		if (z % 3) {
			cout &lt;&lt; -1 &lt;&lt; '</span><span class="pln">\n</span><span class="str">';
			continue;
		}
		if (o % 3) {
			cout &lt;&lt; -1 &lt;&lt; '</span><span class="pln">\n</span><span class="str">';
			continue;
		}

		int sum = z / 3 + o / 3;
		if (diffsum[r] - diffsum[l] == (r - l)) sum++;
		cout &lt;&lt; sum &lt;&lt; '</span><span class="pln">\n</span><span class="str">';
	}
}

signed main() {
	ios::sync_with_stdio(false), cin.tie(0);
	int t, T;
	cin &gt;&gt; T;
	for (t = 1; t &lt;= T; t++) solve();
}</span></code></pre></div></div><p><a href="/contest/2152/problem/D">2152D - Division Versus Addition</a></p> <div class="spoiler"><b class="spoiler-title">Spoiler</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2152/problem/D" title="Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2)">2152D - Division Versus Addition</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Lemma: For a single integer $$$x_0 \ge 2$$$, repeatedly applying $$$x \mapsto \left\lfloor \frac{x+1}{2}\right\rfloor$$$ takes exactly $$$\lfloor\log_2 x_0\rfloor$$$ steps if $$$x_0$$$ is a power of two and $$$\lfloor\log_2 x_0\rfloor+1$$$ otherwise (can be proved by induction). </p><p>Classify each array element by its initial value: Type A if $$$a_i=2^k$$$, Type B if $$$a_i=2^k+1$$$, Type C otherwise. Let $$$|B|$$$ and $$$|C|$$$ be the counts of types B and C. The answer is $$$\text{ans}=\sum_i \lfloor \log_2 a_i\rfloor+\left\lfloor\frac{|B|}{2}\right\rfloor+|C|.$$$</p><p>Upper bound (strategy for Poby). Whenever Rekkles plays on an untouched type B for the first time, Poby immediately responds on some other untouched type B (B-mirror); otherwise Poby simply follows Rekkles on the same position on the next move. With this policy, when Poby returns to any previously touched position, its value has increased by at most 1 since his last touch, so from Poby's perspective each revisit applies $$$x\mapsto\big\lfloor\frac{x+1}{2}\big\rfloor$$$; the only worse one-time jump $$$x\mapsto\big\lfloor\frac{x+2}{2}\big\rfloor$$$ can occur on a Type B that Rekkles touched before Poby's first touch. Type A costs $$$\lfloor\log_2 a_i\rfloor$$$; Type C costs $$$\lfloor\log_2 a_i\rfloor+1$$$; Type B costs $$$\lfloor\log_2 a_i\rfloor$$$ if Poby first-touches it and $$$\lfloor\log_2 a_i\rfloor+1$$$ if Rekkles first-touches it. The B-mirror ensures that at most half of the Bs can be stolen by Rekkles, so the total Poby moves are at most $$$\sum_i \lfloor \log_2 a_i\rfloor+\lfloor|B|/2\rfloor+|C|.$$$</p><p>Lower bound (strategy for Rekkles). If Poby just first-touched a fresh B, Rekkles first-touches another fresh B when possible; otherwise he follows Poby on the same position. This keeps every A and C behaving, from Poby's viewpoint, as repeated $$$x\mapsto\big\lfloor\frac{x+1}{2}\big\rfloor$$$ after the initial halving step, giving costs $$$\lfloor\log_2 a_i\rfloor$$$ for A and $$$\lfloor\log_2 a_i\rfloor+1$$$ for C, and guarantees at least $$$\lfloor|B|/2\rfloor$$$ stolen Bs each costing the +1 version. Hence Poby must make at least $$$\sum_i \lfloor \log_2 a_i\rfloor+\lfloor|B|/2\rfloor+|C|$$$ moves.</p><p>Both bounds match, so under optimal play $$$ans=\sum_i \lfloor \log_2 a_i\rfloor+\left\lfloor\frac{|B|}{2}\right\rfloor+|C|$$$.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> ll </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">constexpr</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAXN </span><span class="pun">=</span><span class="pln"> </span><span class="lit">250000</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">MAXN </span><span class="pun">+</span><span class="pln"> </span><span class="lit">100</span><span class="pun">];</span><span class="pln">
ll prf</span><span class="pun">[</span><span class="pln">MAXN </span><span class="pun">+</span><span class="pln"> </span><span class="lit">100</span><span class="pun">][</span><span class="lit">4</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    scanf</span><span class="pun">(</span><span class="str">"%d %d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">q</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln"> scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">+</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
    
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="lit">3</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln"> prf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> prf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
        
        </span><span class="kwd">int</span><span class="pln"> typ </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">popcount</span><span class="pun">((</span><span class="kwd">unsigned</span><span class="pun">)</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> typ </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">popcount</span><span class="pun">((</span><span class="kwd">unsigned</span><span class="pun">)</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> typ </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">

        prf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">typ</span><span class="pun">]++;</span><span class="pln">

        prf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> prf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">31</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> countl_zero</span><span class="pun">((</span><span class="kwd">unsigned</span><span class="pun">)</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]));</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">q</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
        scanf</span><span class="pun">(</span><span class="str">"%d %d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">r</span><span class="pun">);</span><span class="pln">

        ll cnt</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="lit">3</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> prf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> prf</span><span class="pun">[</span><span class="pln">l</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">];</span><span class="pln">

        ll ans </span><span class="pun">=</span><span class="pln"> prf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">][</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> prf</span><span class="pun">[</span><span class="pln">l</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> cnt</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> cnt</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
        printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2152/problem/E">2152E - Monotone Subsequence</a></p> <div class="spoiler"><b class="spoiler-title">Spoiler</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2152/problem/E" title="Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2)">2152E - Monotone Subsequence</a></h3><div class="ttypography"><div class="problem-statement"><div><p>First, note that the set of visible skyscrapers forms an increasing subsequence. As a result, if the interactor ever returns a set with at least $$$n+1$$$ skyscrapers, we are immediately done. On the other hand, for a sequence like $$$[n^2 + 1, n^2, \ldots, 1]$$$, any query will yield exactly one visible skyscraper, so we cannot count on the interactor alone to find the answer. This suggests that the hard case is when a long increasing subsequence does not exist, and we must find a decreasing subsequence instead.</p><p>Start with the set $$$A = \{1, 2, \ldots, n^2+1\}$$$ and repeat the following procedure for up to $$$n$$$ times: </p><ul> <li> Make a skyscraper query on the current set $$$A$$$. </li><li> Let $$$B \subseteq A$$$ be the set of visible skyscrapers. If $$$|B| \ge n+1$$$, report $$$B$$$ and terminate. </li><li> Otherwise, remove the elements of $$$B$$$ from $$$A$$$ and repeat. </li></ul><p>Suppose the algorithm completes all $$$n$$$ iterations without terminating. Let $$$B_i$$$ be the set of visible skyscrapers returned in the $$$i$$$-th iteration, for $$$i=1, \ldots, n$$$. Let $$$B_{n+1}$$$ be the set of all elements remaining in $$$A$$$ after the $$$n$$$-th iteration. Note that $$$B_{n+1}$$$ is not empty.</p><p>We will construct a decreasing sequence by picking indices $$$j_1, j_2, \ldots, j_{n+1}$$$ such that each $$$j_k \in B_k$$$. The following observation is key.</p><p><span class="tex-font-style-bf">Claim.</span> Let $$$dp[j]$$$ be the length of the longest decreasing subsequence ending with the element at index $$$j$$$. For each $$$k \in \{1, \ldots, n\}$$$, the set is $$$B_k = \{j \mid dp[j] = k\}$$$.</p><p><span class="tex-font-style-it">Proof.</span> We use induction on $$$k$$$. For any $$$j \in B_k$$$: </p><ol> <li> <span class="tex-font-style-bf">$$$dp[j] \ge k$$$</span>: Since $$$j \in B_k$$$, it was not visible in the previous iteration. This implies there exists an element $$$m \in B_{k-1}$$$ such that $$$m &lt; j$$$ and its value $$$p_m &gt; p_j$$$. By the inductive hypothesis, $$$dp[m] = k-1$$$. We can append the element at index $$$j$$$ to the decreasing subsequence ending at $$$m$$$ to get a new sequence of length $$$k$$$. Therefore, $$$dp[j] \ge k$$$.<p> </p></li><li> <span class="tex-font-style-bf">$$$dp[j] \le k$$$</span>: Consider any decreasing subsequence that ends at $$$j$$$. Since each of the sets $$$B_1, B_2, \ldots, B_{k-1}$$$ is an increasing subsequence, the decreasing subsequence can contain at most one element from each of these sets. Therefore, its total length is at most $$$(k-1)$$$ elements from those sets, plus the element at index $$$j$$$, giving a maximum length of $$$k$$$. </li></ol> Since $$$dp[j] \ge k$$$ and $$$dp[j] \le k$$$, we must have $$$dp[j] = k$$$. $$$\blacksquare$$$<p>This claim allows us to construct the final sequence. Start with any element $$$j_{n+1} \in B_{n+1}$$$. We know $$$dp[j_{n+1}] \ge n+1$$$. By the definition of $$$dp$$$, there must be a predecessor index $$$j_n &lt; j_{n+1}$$$ with $$$p_{j_n} &gt; p_{j_{n+1}}$$$ and $$$dp[j_n] = dp[j_{n+1}]-1$$$. From our claim, this means $$$j_n \in B_n$$$. We can repeat this process backward to find a $$$j_k \in B_k$$$ for each $$$k$$$, which gives us the desired decreasing subsequence of length $$$n+1$$$.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> lint </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> pi </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">&lt;</span><span class="pln">lint</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">&gt;;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">size</span><span class="pun">())</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> cr</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">clear</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">resize</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ord</span><span class="pun">(</span><span class="pln">n </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	iota</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">ord</span><span class="pun">),</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">auto</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[&amp;](</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">x </span><span class="pun">:</span><span class="pln"> v</span><span class="pun">)</span><span class="pln">
			cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> y</span><span class="pun">;</span><span class="pln">
		v</span><span class="pun">.</span><span class="pln">resize</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">x </span><span class="pun">:</span><span class="pln"> v</span><span class="pun">)</span><span class="pln">
			cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">--;</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">};</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> dp</span><span class="pun">(</span><span class="pln">n </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">auto</span><span class="pln"> cur_ord </span><span class="pun">=</span><span class="pln"> query</span><span class="pun">(</span><span class="pln">ord</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sz</span><span class="pun">(</span><span class="pln">cur_ord</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"!"</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
				cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> cur_ord</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			cout </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		vector</span><span class="str">&lt;int&gt;</span><span class="pln"> new_ord</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">x </span><span class="pun">:</span><span class="pln"> ord</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">binary_search</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">cur_ord</span><span class="pun">),</span><span class="pln"> x</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				new_ord</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
			</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		ord </span><span class="pun">=</span><span class="pln"> new_ord</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> cur</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
			cur</span><span class="pun">--;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
	    cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> cur </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
	    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">x </span><span class="pun">:</span><span class="pln"> dp</span><span class="pun">)</span><span class="pln"> cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> x </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pun">;</span><span class="pln">
	    cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	reverse</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">));</span><span class="pln">
	</span><span class="kwd">assert</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"!"</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">x </span><span class="pun">:</span><span class="pln"> ans</span><span class="pun">)</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> tc</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> tc</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tc</span><span class="pun">--)</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2152/problem/F">2152F - Triple Attack</a></p> <div class="spoiler"><b class="spoiler-title">Spoiler</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2152/problem/F" title="Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2)">2152F - Triple Attack</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let $$$Y = \{y_1, y_2, \ldots, y_m\}$$$ be a <span class="tex-font-style-it">sorted</span> multiset of $$$m$$$ timestamps (i.e., $$$y_1 \le y_2 \le \ldots \le y_m$$$). Observe that $$$Y$$$ is <span class="tex-font-style-bf">safe</span> if and only if $$$y_{i+2} &gt; y_i + z$$$ for all $$$1 \le i \le m - 2$$$, since the condition is most constrained by triplets of the form $$$\{y_i, y_{i+1}, y_{i+2}\}$$$. A naive greedy algorithm based on this would be to iterate through the elements $$$x_l, \ldots, x_r$$$ and add each element to a candidate set if the safe property is maintained. This approach takes $$$O(n)$$$ time per query, which is too slow.</p><p>To build an efficient solution, let's first consider a simplified case where $$$Y$$$ is safe if and only if $$$y_{i+1} &gt; y_i + z$$$. Here, a greedy algorithm works by considering the last element instead of the second-to-last. The algorithm on a range $$$[l, r]$$$ starts by picking the $$$l$$$-th element, then repeatedly picks the first subsequent element with a value greater by more than $$$t$$$. For each $$$1 \le i \le n$$$, let $$$f(i)$$$ be the first index $$$j &gt; i$$$ such that $$$x_j &gt; x_i + z$$$ (or $$$n+1$$$ if none exists). These $$$f(i)$$$ values can be precomputed for all $$$i$$$ in $$$O(n)$$$ time using a two-pointer approach. The greedy algorithm then picks elements at indices $$$l, f(l), f^2(l), \ldots$$$ until the index goes beyond $$$r$$$. By building a sparse table for this successor function $$$f$$$, one can find the number of elements picked in $$$O(\log n)$$$ time per query, after an $$$O(n \log n)$$$ initialization.</p><p>Going back to the original problem, the greedy algorithm is equivalent to picking elements from two parallel chains starting at indices $$$l$$$ and $$$l+1$$$: one chain is $$$l, f(l), f^2(l), \ldots$$$ and the other is $$$l+1, f(l+1), f^2(l+1), \ldots$$$. This continues until the chains conflict by reaching the same element. We can model this relationship as a successor tree, where each node $$$i$$$ ($$$1 \le i \le n$$$) has $$$f(i)$$$ as its parent and $$$n+1$$$ is the root. The first conflict point for chains starting at $$$l$$$ and $$$l+1$$$ is their Lowest Common Ancestor, $$$\text{LCA}(l, l+1)$$$. After the chains merge at this node, the process can be reinitialized from the LCA and the node following it.</p><p>This observation allows for an efficient simulation. Starting from $$$l$$$, we repeatedly perform a "big jump" to the next conflict point, $$$\text{LCA}(l, l + 1)$$$. For each jump, we can compute the number of elements picked, which corresponds to the number of nodes on the tree paths from $$$l$$$ and $$$l+1$$$ to their LCA. If the next big jump would take us beyond $$$r$$$, we simulate each chain separately to the end. While performing each big jump naively is slow, we can again use the sparse table to find the destination of multiple big jumps at once. The total time complexity is $$$O((n + q) \log n)$$$.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> lint </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> pi </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">&lt;</span><span class="pln">lint</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">&gt;;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">size</span><span class="pun">())</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> cr</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">clear</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">resize</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAXN </span><span class="pun">=</span><span class="pln"> </span><span class="lit">500005</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> nxt1</span><span class="pun">[</span><span class="lit">20</span><span class="pun">][</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> dep1</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">
pi nxt2</span><span class="pun">[</span><span class="lit">20</span><span class="pun">][</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
	
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--){</span><span class="pln">
    	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    	t</span><span class="pun">++;</span><span class="pln">
    	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    	
    	</span><span class="com">// EDIT: added init statements for globals</span><span class="pln">
    	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">+</span><span class="lit">5</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
    	    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">20</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> nxt1</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">nxt2</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]={</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
    	    dep1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    	</span><span class="pun">}</span><span class="pln">
    		
    	</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    		</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">)</span><span class="pln">
    			j</span><span class="pun">++;</span><span class="pln">
    		nxt1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln">
    	</span><span class="pun">}</span><span class="pln">
    	nxt1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln">
    		dep1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dep1</span><span class="pun">[</span><span class="pln">nxt1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">20</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln">
    			nxt1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> nxt1</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">nxt1</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]];</span><span class="pln">
    	</span><span class="pun">}</span><span class="pln">
    	</span><span class="kwd">auto</span><span class="pln"> lca </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[&amp;](</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dep1</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> dep1</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
    			swap</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">);</span><span class="pln">
    		</span><span class="kwd">int</span><span class="pln"> dx </span><span class="pun">=</span><span class="pln"> dep1</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> dep1</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">
    		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> dx</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dx </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    				v </span><span class="pun">=</span><span class="pln"> nxt1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">v</span><span class="pun">];</span><span class="pln">
    			</span><span class="pun">}</span><span class="pln">
    			dx </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    		</span><span class="pun">}</span><span class="pln">
    		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">u </span><span class="pun">==</span><span class="pln"> v</span><span class="pun">)</span><span class="pln">
    			</span><span class="kwd">return</span><span class="pln"> u</span><span class="pun">;</span><span class="pln">
    		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">19</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">nxt1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> nxt1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">v</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    				u </span><span class="pun">=</span><span class="pln"> nxt1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">u</span><span class="pun">];</span><span class="pln">
    				v </span><span class="pun">=</span><span class="pln"> nxt1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">v</span><span class="pun">];</span><span class="pln">
    			</span><span class="pun">}</span><span class="pln">
    		</span><span class="pun">}</span><span class="pln">
    		</span><span class="kwd">return</span><span class="pln"> nxt1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">u</span><span class="pun">];</span><span class="pln">
    	</span><span class="pun">};</span><span class="pln">
    	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    		</span><span class="kwd">int</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> lca</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    		nxt2</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> pi</span><span class="pun">{</span><span class="pln">z</span><span class="pun">,</span><span class="pln"> dep1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dep1</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dep1</span><span class="pun">[</span><span class="pln">z</span><span class="pun">]};</span><span class="pln">
    	</span><span class="pun">}</span><span class="pln">
    	nxt2</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> pi</span><span class="pun">{</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">};</span><span class="pln">
    	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">20</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    			</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">n1</span><span class="pun">,</span><span class="pln"> d1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> nxt2</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
    			</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">n2</span><span class="pun">,</span><span class="pln"> d2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> nxt2</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">n1</span><span class="pun">];</span><span class="pln">
    			nxt2</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> pi</span><span class="pun">{</span><span class="pln">n2</span><span class="pun">,</span><span class="pln"> d1 </span><span class="pun">+</span><span class="pln"> d2</span><span class="pun">};</span><span class="pln">
    		</span><span class="pun">}</span><span class="pln">
    	</span><span class="pun">}</span><span class="pln">
    	</span><span class="kwd">auto</span><span class="pln"> gp </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[&amp;](</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    		</span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">19</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">nxt1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    				l </span><span class="pun">=</span><span class="pln"> nxt1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">l</span><span class="pun">];</span><span class="pln">
    				ans </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
    			</span><span class="pun">}</span><span class="pln">
    		</span><span class="pun">}</span><span class="pln">
    		</span><span class="kwd">return</span><span class="pln"> ans </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    	</span><span class="pun">};</span><span class="pln">
    	</span><span class="kwd">int</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">q</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    		</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
    		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
    		l</span><span class="pun">--;</span><span class="pln">
    		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> l </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    			cout </span><span class="pun">&lt;&lt;</span><span class="pln"> r </span><span class="pun">-</span><span class="pln"> l </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    			</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
    		</span><span class="pun">}</span><span class="pln">
    		</span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">19</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">nxt2</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">l</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    				ans </span><span class="pun">+=</span><span class="pln"> nxt2</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">l</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
    				l </span><span class="pun">=</span><span class="pln"> nxt2</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">l</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
    			</span><span class="pun">}</span><span class="pln">
    		</span><span class="pun">}</span><span class="pln">
    		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> r</span><span class="pun">)</span><span class="pln">
    			ans </span><span class="pun">+=</span><span class="pln"> gp</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">);</span><span class="pln">
    		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> r</span><span class="pun">)</span><span class="pln">
    			ans </span><span class="pun">+=</span><span class="pln"> gp</span><span class="pun">(</span><span class="pln">l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">);</span><span class="pln">
    		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    	</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2152/problem/G">2152G - Query Jungle</a></p> <div class="spoiler"><b class="spoiler-title">Spoiler</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2152/problem/G" title="Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2)">2152G - Query Jungle</a></h3><div class="ttypography"><div class="problem-statement"><div><p>We find an efficient characterization of the minimum number of paths, which allows subtree updates to be supported by standard data structures.</p><p><span class="tex-font-style-bf">Claim 1.</span> The minimum number of paths required to cover all monsters is equal to the size of the largest ancestor-free subset of monsters. (An ancestor-free subset is one where no monster is an ancestor of another).</p><p><span class="tex-font-style-it">Proof.</span> An ancestor-free subset of size $$$m$$$ clearly requires $$$m$$$ paths to cover. Conversely, consider a minimum-sized set of paths that covers all monsters. If an endpoint of a path does not contain a monster, the path can be shortened towards the root until its endpoint is a monster (or the path becomes empty, contradicting minimality). Thus, we can assume every path endpoint contains a monster. Furthermore, because the path set is of minimum size, no path can be a subpath of another. Therefore, the endpoints of these paths form an ancestor-free subset of monsters of the same size. $$$\blacksquare$$$</p><p>Next, we generate an Euler tour sequence $$$S$$$ of length $$$2n$$$ via a DFS traversal from the root. We assume familiarity with basic properties of Euler tours on trees, such as the interval representation of subtrees.</p><pre class="lstlisting"><code class="prettyprint prettyprinted" style=""><span class="pln">dfs</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><br><span class="pln">	S</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><br><span class="pln">	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">all childs w </span><span class="kwd">of</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> dfs</span><span class="pun">(</span><span class="pln">w</span><span class="pun">);</span><br><span class="pln">	S</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><br><span class="pun">}</span><br></code></pre><p>This generates a sequence of length $$$2n$$$, where each node is associated with one $$$0$$$ (marking entry into its subtree) and one $$$1$$$ (marking exit). For each vertex that contains a monster, we replace its corresponding $$$0$$$ and $$$1$$$ in the sequence with $$$2$$$ and $$$3$$$, respectively.</p><p><span class="tex-font-style-bf">Claim 2.</span> The size of the largest ancestor-free subset of monsters is half the length of the longest subsequence of $$$S$$$ of the form $$$2, 3, 2, 3, \ldots$$$.</p><p><span class="tex-font-style-it">Proof.</span> </p><ul> <li> Given a maximum-sized ancestor-free subset of size $$$k$$$, we can construct a subsequence of $$$S$$$ by taking the corresponding $$$2$$$ and $$$3$$$ for each monster in the subset. This subsequence will have the form $$$2, 3, 2, 3, \ldots$$$ because, for any monster $$$v$$$ in the subset, the DFS enters its subtree (producing a $$$2$$$) and must exit it (producing a $$$3$$$) before visiting any other monster in the ancestor-free set. Thus, the length of the longest such subsequence is at least $$$2k$$$. </li><li> Given a maximum-length subsequence of the form $$$2, 3, \ldots$$$ with length $$$2k$$$, it can be transformed into a subsequence corresponding to $$$k$$$ vertices that form an ancestor-free set. For each adjacent pair of $$$2, 3$$$ that does not correspond to the same vertex, you can move either one of them (specifically, the one that is closer to the root) to the other vertex's matching position. The subsequence now corresponds to $$$k$$$ vertices that are ancestor-free. Hence, the subset size is at least half of the length. $$$\blacksquare$$$ </li></ul><p>Subtree updates are handled as follows. A flip query on a subtree corresponds to XORing all values in the corresponding range of $$$S$$$ by $$$2$$$. This operation swaps $$$0 \leftrightarrow 2$$$ and $$$1 \leftrightarrow 3$$$. By maintaining the lengths of the longest alternating subsequences for each possible starting element and character set, we can answer queries efficiently. Specifically, each node in our data structure will store four values: </p><ul> <li> The maximum length of a subsequence of the form $$$0, 1, 0, 1, \ldots$$$ </li><li> The maximum length of a subsequence of the form $$$1, 0, 1, 0, \ldots$$$ </li><li> The maximum length of a subsequence of the form $$$2, 3, 2, 3, \ldots$$$ </li><li> The maximum length of a subsequence of the form $$$3, 2, 3, 2, \ldots$$$ </li></ul> This allows us to solve the problem using a segment tree with lazy propagation. The total time complexity is $$$O((n + q) \log n)$$$.</div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> lint </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> pi </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">&lt;</span><span class="pln">lint</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">&gt;;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)(</span><span class="pln">a</span><span class="pun">).</span><span class="pln">size</span><span class="pun">())</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">).</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">).</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAXN </span><span class="pun">=</span><span class="pln"> </span><span class="lit">250005</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAXT </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1050000</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">struct</span><span class="pln"> mtrx </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> nxt</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
	mtrx</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> nxt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> nxt</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
	mtrx</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		nxt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		nxt</span><span class="pun">[</span><span class="lit">1</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	mtrx </span><span class="kwd">operator</span><span class="pun">+(</span><span class="kwd">const</span><span class="pln"> mtrx </span><span class="pun">&amp;</span><span class="pln">m</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		mtrx ret</span><span class="pun">;</span><span class="pln">
		ret</span><span class="pun">.</span><span class="pln">nxt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> nxt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> m</span><span class="pun">.</span><span class="pln">nxt</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pun">];</span><span class="pln">
		ret</span><span class="pun">.</span><span class="pln">nxt</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> nxt</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> m</span><span class="pun">.</span><span class="pln">nxt</span><span class="pun">[(</span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> nxt</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="kwd">struct</span><span class="pln"> node </span><span class="pun">{</span><span class="pln">
	mtrx M</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> lazy</span><span class="pun">;</span><span class="pln">
	node </span><span class="kwd">operator</span><span class="pun">+(</span><span class="kwd">const</span><span class="pln"> node </span><span class="pun">&amp;</span><span class="pln">nd</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		node ret</span><span class="pun">;</span><span class="pln">
		ret</span><span class="pun">.</span><span class="pln">M</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> M</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> nd</span><span class="pun">.</span><span class="pln">M</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
		ret</span><span class="pun">.</span><span class="pln">M</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> M</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> nd</span><span class="pun">.</span><span class="pln">M</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		ret</span><span class="pun">.</span><span class="pln">lazy </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">MAXT</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> init</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> s</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> e</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> vector</span><span class="str">&lt;pi&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">seq</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">==</span><span class="pln"> e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">M</span><span class="pun">[</span><span class="pln">seq</span><span class="pun">[</span><span class="pln">s</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mtrx</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">[</span><span class="pln">s</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
		tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">M</span><span class="pun">[</span><span class="lit">1</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> seq</span><span class="pun">[</span><span class="pln">s</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mtrx</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> m </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
	init</span><span class="pun">(</span><span class="pln">s</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> seq</span><span class="pun">);</span><span class="pln">
	init</span><span class="pun">(</span><span class="pln">m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> e</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> seq</span><span class="pun">);</span><span class="pln">
	tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tree</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> tree</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> lazydown</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">lazy</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			tree</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">lazy </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			swap</span><span class="pun">(</span><span class="pln">tree</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">M</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">M</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">lazy </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> update</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> s</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> e</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> ps</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> pe</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e </span><span class="pun">&lt;</span><span class="pln"> ps </span><span class="pun">||</span><span class="pln"> pe </span><span class="pun">&lt;</span><span class="pln"> s</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;=</span><span class="pln"> ps </span><span class="pun">&amp;&amp;</span><span class="pln"> pe </span><span class="pun">&lt;=</span><span class="pln"> e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">lazy </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		swap</span><span class="pun">(</span><span class="pln">tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">M</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">M</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
		</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> pm </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ps </span><span class="pun">+</span><span class="pln"> pe</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
	lazydown</span><span class="pun">(</span><span class="pln">p</span><span class="pun">);</span><span class="pln">
	update</span><span class="pun">(</span><span class="pln">s</span><span class="pun">,</span><span class="pln"> e</span><span class="pun">,</span><span class="pln"> ps</span><span class="pun">,</span><span class="pln"> pm</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">);</span><span class="pln">
	update</span><span class="pun">(</span><span class="pln">s</span><span class="pun">,</span><span class="pln"> e</span><span class="pun">,</span><span class="pln"> pm </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> pe</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tree</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> tree</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> tree</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">M</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">nxt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">

vector</span><span class="str">&lt;int&gt;</span><span class="pln"> gph</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> din</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> dout</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">
vector</span><span class="str">&lt;pi&gt;</span><span class="pln"> seq</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	din</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">);</span><span class="pln">
	seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">({</span><span class="pln">a</span><span class="pun">[</span><span class="pln">x</span><span class="pun">],</span><span class="pln"> </span><span class="lit">0</span><span class="pun">});</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">y </span><span class="pun">:</span><span class="pln"> gph</span><span class="pun">[</span><span class="pln">x</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">)</span><span class="pln">
			dfs</span><span class="pun">(</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">({</span><span class="pln">a</span><span class="pun">[</span><span class="pln">x</span><span class="pun">],</span><span class="pln"> </span><span class="lit">1</span><span class="pun">});</span><span class="pln">
	dout</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    		
    	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> gph</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
    	seq</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
    	
    	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    		</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
    		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> u </span><span class="pun">&gt;&gt;</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
    		u</span><span class="pun">--;</span><span class="pln">
    		v</span><span class="pun">--;</span><span class="pln">
    		gph</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
    		gph</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
    	</span><span class="pun">}</span><span class="pln">
    	dfs</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    	init</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> seq</span><span class="pun">);</span><span class="pln">
    	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> query</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    	</span><span class="kwd">int</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">q</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    		</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
    		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
    		v</span><span class="pun">--;</span><span class="pln">
    		update</span><span class="pun">(</span><span class="pln">din</span><span class="pun">[</span><span class="pln">v</span><span class="pun">],</span><span class="pln"> dout</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> query</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    	</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2152/problem/H1">2152H1 - Victorious Coloring (Easy Version)</a></p> <div class="spoiler"><b class="spoiler-title">Spoiler</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2152/problem/H1" title="Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2)">2152H1 - Victorious Coloring (Easy Version)</a></h3><div class="ttypography"><div class="problem-statement"><div><p>WLOG, we assume all edge weights are distinct; ties can be broken arbitrarily.</p><p>We first consider the problem of computing $$$f([x_1, x_2, \ldots, x_n])$$$ when the vector $$$x$$$ is known. The solution is based on the following key observation:</p><p><span class="tex-font-style-bf">Claim 1.</span> There exists a minimum-cost victorious coloring where the following properties hold: </p><ul> <li> The subgraph induced by the red vertices is connected. </li><li> For any edge $$$e_1$$$ with both endpoints colored red and any edge $$$e_2$$$ with exactly one endpoint colored red, it holds that $$$w(e_1) &gt; w(e_2)$$$. </li></ul><p><span class="tex-font-style-it">Proof.</span> If the subgraph induced by the red vertices is disconnected, we can recolor any connected component from red to yellow to reduce the total cost. Suppose there is a pair of edges $$$e_1, e_2$$$ with $$$w(e_1) \le w(e_2)$$$. Removing edge $$$e_1$$$ disconnects the red subgraph into two parts. If we recolor the part not containing the red endpoint of $$$e_2$$$, the cost is reduced by at least $$$w(e_2) - w(e_1) \ge 0$$$. $$$\blacksquare$$$</p><p>A non-empty subset of vertices is called <span class="tex-font-style-it">strong</span> if it corresponds to a red set in a coloring that satisfies the conditions in Claim 1. Clearly, every singleton set $$$\{v\}$$$ is strong. A strong set of size at least two is uniquely determined by its minimum-weight internal edge $$$e$$$; the set consists of all vertices reachable from $$$e$$$ using only edges with weight at least $$$w(e)$$$.</p><p>An immediate corollary is that there are at most $$$2n-1$$$ strong sets. We can characterize this structure further by considering Kruskal's algorithm on the tree edges in decreasing order of weight. Each component maintained by the DSU structure corresponds to a strong set. Specifically, a union operation merges two strong sets $$$A$$$ and $$$B$$$ along an edge $$$e$$$ to form a new strong set $$$A \cup B$$$.</p><p>From this observation, we build a binary tree of strong sets: leaves are singleton sets, and each non-leaf node has two children, representing the two sets that were merged to form it.</p><p>Additionally, for each strong set $$$S$$$ in this tree, we compute its cut value $$$c(S)$$$, which is the sum of weights of edges with exactly one endpoint in $$$S$$$. A naive computation would take $$$O(n^2)$$$ time. However, an edge $$$(u, v)$$$ contributes to $$$c(S)$$$ if and only if $$$S$$$ contains exactly one of $$$u$$$ or $$$v$$$. These set $$$S$$$ will form a simple path from $$$\{u\}$$$ to $$$\{v\}$$$, so we need to add a value to a simple path, which can be done with prefix-sum arrays since LCA is easy to find (the LCA is the node corresponding to the edge $$$e$$$).</p><p>With this structure, we can solve the original problem. The condition $$$f(x) \ge l$$$ is equivalent to requiring $$$c(S) + \sum_{i \in S} x_i \ge l$$$ for every strong set $$$S$$$. To find an optimal assignment, we use a greedy algorithm in a bottom-up fashion on the strong set tree. For a given strong set $$$S$$$, we first recursively find the minimum sums for its children. Then, if the current assignments result in $$$c(S) + \sum_{i \in S} x_i &lt; l$$$, we increase the $$$x_j$$$ value for an arbitrary leaf $$$j \in S$$$ to meet the bound exactly. Processing each query this way takes linear time, leading to a total time complexity of $$$O(n \log n + qn)$$$.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> lint </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> pi </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">&lt;</span><span class="pln">lint</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">&gt;;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">size</span><span class="pun">())</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> cr</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">clear</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">resize</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">

vector</span><span class="str">&lt;int&gt;</span><span class="pln"> pa</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> find</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> pa</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pa</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> x </span><span class="pun">?</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">pa</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]));</span><span class="pln"> </span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--){</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		vector</span><span class="pun">&lt;</span><span class="pln">array</span><span class="pun">&lt;</span><span class="pln">lint</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">&gt;&gt;</span><span class="pln"> edges</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			lint u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
			cin </span><span class="pun">&gt;&gt;</span><span class="pln"> u </span><span class="pun">&gt;&gt;</span><span class="pln"> v </span><span class="pun">&gt;&gt;</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
			u</span><span class="pun">--;</span><span class="pln">
			v</span><span class="pun">--;</span><span class="pln">
			edges</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">({</span><span class="pln">w</span><span class="pun">,</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">});</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		sort</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">edges</span><span class="pun">));</span><span class="pln">
		reverse</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">edges</span><span class="pun">));</span><span class="pln">
		cr</span><span class="pun">(</span><span class="pln">pa</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		vector</span><span class="str">&lt;lint&gt;</span><span class="pln"> cost</span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		vector</span><span class="str">&lt;pi&gt;</span><span class="pln"> ch</span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		iota</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">pa</span><span class="pun">),</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> u </span><span class="pun">=</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> v </span><span class="pun">=</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">2</span><span class="pun">]);</span><span class="pln">
			pa</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
			pa</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
			ch</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">};</span><span class="pln">
			cost</span><span class="pun">[</span><span class="pln">edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
			cost</span><span class="pun">[</span><span class="pln">edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">2</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
			cost</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> cost</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> cost</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">q</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			lint x</span><span class="pun">;</span><span class="pln">
			cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
			vector</span><span class="str">&lt;lint&gt;</span><span class="pln"> dp</span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			lint dap </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&gt;=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]];</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					dap </span><span class="pun">+=</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
					dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			cout </span><span class="pun">&lt;&lt;</span><span class="pln"> dap </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2152/problem/H2">2152H2 - Victorious Coloring (Hard Version)</a></p> <div class="spoiler"><b class="spoiler-title">Spoiler</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2152/problem/H2" title="Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2)">2152H2 - Victorious Coloring (Hard Version)</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Essentially, the computation from the first part of our solution can be restated as follows: Given a static rooted tree $$$T$$$ where each vertex $$$v$$$ has a value $$$f_v \ge 0$$$, we compute the recurrence $$$dp_v$$$ for all vertices: </p><ul> <li> If $$$v$$$ is a leaf, $$$dp_v = \max(0, l - f_v)$$$. </li><li> If $$$v$$$ is a non-leaf with children $$$a$$$ and $$$b$$$, $$$dp_v = \max(dp_a + dp_b, l - f_v)$$$. </li></ul><p>To support queries for multiple values of $$$l$$$, we represent each $$$dp_v$$$ as a function of $$$l$$$. We observe that $$$dp_v(l)$$$ is a convex, piecewise linear function with non-decreasing slopes. This is trivially true for leaves. For a non-leaf node, the sum of two convex piecewise linear functions is also convex, and this property is preserved by the $$$\max(\dots, l - f_v)$$$ operation.</p><p>We represent each function by storing its breakpoints as pairs $$$(p, d)$$$, signifying that the slope increases by $$$d$$$ at point $$$p$$$. These breakpoints are stored in a min-heap for each vertex, ordered by $$$p$$$. The sum of two functions corresponds to the union of their breakpoint sets, which can be computed efficiently using small-to-large merging. To apply the $$$\max(\dots, l - f_v)$$$ operation, we find the intersection of the current function and the line $$$y = l - f_v$$$. We then remove all breakpoints below this intersection and add at most two new ones to define the updated function. This update process adds $$$O(1)$$$ new breakpoints, so the cost is amortized.</p><p>The time complexity is $$$O((n + q) \log n)$$$ using a mergeable heap, or $$$O(n \log^2 n + q \log n)$$$ using a priority queue with small-to-large merging, which is sufficient to pass.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> lint </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> pi </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">&lt;</span><span class="pln">lint</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">&gt;;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">size</span><span class="pun">())</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> cr</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">clear</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">).</span><span class="pln">resize</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">

vector</span><span class="str">&lt;int&gt;</span><span class="pln"> pa</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> find</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> pa</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pa</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> x </span><span class="pun">?</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">pa</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]));</span><span class="pln"> </span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--){</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		vector</span><span class="pun">&lt;</span><span class="pln">array</span><span class="pun">&lt;</span><span class="pln">lint</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">&gt;&gt;</span><span class="pln"> edges</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			lint u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
			cin </span><span class="pun">&gt;&gt;</span><span class="pln"> u </span><span class="pun">&gt;&gt;</span><span class="pln"> v </span><span class="pun">&gt;&gt;</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
			u</span><span class="pun">--;</span><span class="pln">
			v</span><span class="pun">--;</span><span class="pln">
			edges</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">({</span><span class="pln">w</span><span class="pun">,</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">});</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		sort</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">edges</span><span class="pun">));</span><span class="pln">
		reverse</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">edges</span><span class="pun">));</span><span class="pln">
		cr</span><span class="pun">(</span><span class="pln">pa</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		vector</span><span class="str">&lt;lint&gt;</span><span class="pln"> cost</span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		vector</span><span class="str">&lt;pi&gt;</span><span class="pln"> ch</span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		iota</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">pa</span><span class="pun">),</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> u </span><span class="pun">=</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> v </span><span class="pun">=</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">2</span><span class="pun">]);</span><span class="pln">
			pa</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
			pa</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
			ch</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">};</span><span class="pln">
			cost</span><span class="pun">[</span><span class="pln">edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
			cost</span><span class="pun">[</span><span class="pln">edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">2</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
			cost</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> edges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> cost</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> cost</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="com">// (point, slope increase)</span><span class="pln">
		vector</span><span class="pun">&lt;</span><span class="pln">priority_queue</span><span class="pun">&lt;</span><span class="pln">pi</span><span class="pun">,</span><span class="pln"> vector</span><span class="str">&lt;pi&gt;</span><span class="pun">,</span><span class="pln"> greater</span><span class="str">&lt;pi&gt;</span><span class="pun">&gt;&gt;</span><span class="pln"> pq</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		vector</span><span class="str">&lt;int&gt;</span><span class="pln"> idx</span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		iota</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">idx</span><span class="pun">),</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				pq</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">push</span><span class="pun">({</span><span class="pln">cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> </span><span class="lit">1</span><span class="pun">});</span><span class="pln">
				</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sz</span><span class="pun">(</span><span class="pln">pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]]])</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]]]))</span><span class="pln">
				swap</span><span class="pun">(</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
			idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> idx</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]];</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sz</span><span class="pun">(</span><span class="pln">pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]]]))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">auto</span><span class="pln"> tp </span><span class="pun">=</span><span class="pln"> pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]]].</span><span class="pln">top</span><span class="pun">();</span><span class="pln">
				pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">ch</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]]].</span><span class="pln">pop</span><span class="pun">();</span><span class="pln">
				pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">push</span><span class="pun">(</span><span class="pln">tp</span><span class="pun">);</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">top</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">])</span><span class="pln">
				</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> lint</span><span class="pun">(</span><span class="lit">2e9</span><span class="pun">))</span><span class="pln">
				</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
			lint A </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> B </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			lint pv </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sz</span><span class="pun">(</span><span class="pln">pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">point</span><span class="pun">,</span><span class="pln"> slope</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">top</span><span class="pun">();</span><span class="pln">
				pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">pop</span><span class="pun">();</span><span class="pln">
				B </span><span class="pun">+=</span><span class="pln"> A </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">point </span><span class="pun">-</span><span class="pln"> pv</span><span class="pun">);</span><span class="pln">
				pv </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">;</span><span class="pln">
				A </span><span class="pun">+=</span><span class="pln"> slope</span><span class="pun">;</span><span class="pln">
				</span><span class="com">// A x - A * pv + B = x - cost[i]</span><span class="pln">
				</span><span class="com">// (A - 1) x = A * pv - B - cost[i]</span><span class="pln">
				lint U </span><span class="pun">=</span><span class="pln"> A </span><span class="pun">*</span><span class="pln"> pv </span><span class="pun">-</span><span class="pln"> B </span><span class="pun">-</span><span class="pln"> cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
				lint L </span><span class="pun">=</span><span class="pln"> A </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
				</span><span class="com">// point &lt;= U / L, so no need to dedup</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">L </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					</span><span class="kwd">assert</span><span class="pun">(</span><span class="pln">point </span><span class="pun">*</span><span class="pln"> L </span><span class="pun">&lt;=</span><span class="pln"> U</span><span class="pun">);</span><span class="pln">
					</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">sz</span><span class="pun">(</span><span class="pln">pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]])</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> U </span><span class="pun">&lt;</span><span class="pln"> pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">top</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> L</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
						lint f1 </span><span class="pun">=</span><span class="pln"> U </span><span class="pun">/</span><span class="pln"> L </span><span class="pun">-</span><span class="pln"> cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
						lint f2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">U </span><span class="pun">/</span><span class="pln"> L </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> pv</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> A </span><span class="pun">+</span><span class="pln"> B</span><span class="pun">;</span><span class="pln">
						</span><span class="com">// (cost[i], 0) -&gt; (U / L, f1) -&gt; (U / L + 1, f2) -&gt; increase w/ speed A</span><span class="pln">
						pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">push</span><span class="pun">({</span><span class="pln">cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> </span><span class="lit">1</span><span class="pun">});</span><span class="pln">
						pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">push</span><span class="pun">({</span><span class="pln">U </span><span class="pun">/</span><span class="pln"> L</span><span class="pun">,</span><span class="pln"> f2 </span><span class="pun">-</span><span class="pln"> f1 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">});</span><span class="pln">
						pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">push</span><span class="pun">({</span><span class="pln">U </span><span class="pun">/</span><span class="pln"> L </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> A </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">f2 </span><span class="pun">-</span><span class="pln"> f1</span><span class="pun">)});</span><span class="pln">
						</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">}</span><span class="pln">
				</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sz</span><span class="pun">(</span><span class="pln">pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]])</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					pq</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">push</span><span class="pun">({</span><span class="pln">cost</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> </span><span class="lit">1</span><span class="pun">});</span><span class="pln">
					</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
		vector</span><span class="str">&lt;pi&gt;</span><span class="pln"> queries</span><span class="pun">(</span><span class="pln">q</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			cin </span><span class="pun">&gt;&gt;</span><span class="pln"> queries</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
			queries</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		sort</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">queries</span><span class="pun">));</span><span class="pln">
		vector</span><span class="str">&lt;lint&gt;</span><span class="pln"> ans</span><span class="pun">(</span><span class="pln">q</span><span class="pun">);</span><span class="pln">
		lint A </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> B </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> pv </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">auto</span><span class="pln"> T </span><span class="pun">=</span><span class="pln"> idx</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;[</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> queries</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sz</span><span class="pun">(</span><span class="pln">pq</span><span class="pun">[</span><span class="pln">T</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> pq</span><span class="pun">[</span><span class="pln">T</span><span class="pun">].</span><span class="pln">top</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">point</span><span class="pun">,</span><span class="pln"> slope</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> pq</span><span class="pun">[</span><span class="pln">T</span><span class="pun">].</span><span class="pln">top</span><span class="pun">();</span><span class="pln">
				pq</span><span class="pun">[</span><span class="pln">T</span><span class="pun">].</span><span class="pln">pop</span><span class="pun">();</span><span class="pln">
				B </span><span class="pun">+=</span><span class="pln"> A </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">point </span><span class="pun">-</span><span class="pln"> pv</span><span class="pun">);</span><span class="pln">
				pv </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">;</span><span class="pln">
				A </span><span class="pun">+=</span><span class="pln"> slope</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> pv</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> A </span><span class="pun">+</span><span class="pln"> B</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">v </span><span class="pun">:</span><span class="pln"> ans</span><span class="pun">)</span><span class="pln">
			cout </span><span class="pun">&lt;&lt;</span><span class="pln"> v </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="/contest/2152" class="notice" style="text-decoration: none;">Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2)</a> </span>
        </div>
        
            <script type="text/javascript">
    $(document).ready(function () {
        $(".delete-resource-link-38652-147629").click(function() {
            var that = this;
            Codeforces.confirm("Are you sure you want to detach a contest?", function () {
                $.post("/data/blogAndContest", {
                    action: "detachBlogFromContest",
                    blogId: "38652",
                    blogEntryId: "146988",
                    contestId: $(that).attr("data-contestId"),
                    resourceIds: $(that).attr("data-resourceIds")
                }, function(json) {        
                    Codeforces.reloadAndShowMessageOrShowError(json, "Contest detached");
                });
            }, function () {}, "Yes", "No");
        });
    });
</script>
        



    <div class="roundbox meta borderTopRound borderBottomRound" style="">
        <div class="left-meta">
            <ul>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-up-147629"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/voteup-gray.png" alt="Vote: I like it" title="Vote: I like it"></a>


</li>
                    <li style="line-height: 1.6em;">

        
        <span class="topic-rating topic-rating-147629" title="Topic rating" data-topicid="147629" data-rawrating="275" style="font-size:larger;position:relative;bottom:1px;font-weight:bold;color:green">+275</span>
        
</li>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-down-147629"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/votedown-gray.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>


</li>
            </ul>
        </div>


            <span style="position: relative; line-height: 1.65em; top: 0.75rem; left: 0.8em;">
            </span>

        <div class="right-meta">
            <ul>
                    <li>        <a href="/profile/ko_osaga"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/user_16x16.png" alt="Author" title="Author"></a>


        <a href="/profile/ko_osaga">
        ko_osaga
        </a>
</li>
                    <li>        <img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/date_16x16.png" alt="Publication date" title="Publication date">


        
        <span class="format-humantime" title="Oct/03/2025 18:16 UTC">2 months ago</span>
        
</li>
                    <li>        <a href="/blog/entry/146988#comments"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/comments_16x16.png" alt="Comments" title="Comments"></a>


        <a href="/blog/entry/146988#comments">
        66
        </a>
</li>
            </ul>
        </div>

        <br style="clear:both;">
    </div>


<style type="text/css">
    .comments .title {
        float: left;
    }

    .comments .comments-actions-div {
        float: right;
        margin-top: 3rem;
        margin-right: 0.5em;
    }

    .comments .comments-actions-div .separator {
        margin: 0 1rem;
    }

    .comments label.show-archived {
    }

    .comments label.show-archived, .comments label.show-archived * {
        font-size: 1.4rem !important;
        color: black !important;
        /*position: relative !important;*/
        /*bottom: 0.4rem !important;*/
    }

    .comments label.show-archived input {
        height: 1.4rem !important;
        width: 1.4rem !important;
        position: relative;
        top: 0.25rem;
    }

    .new-root-comment {
        font-size: 1.4rem !important;
    }
</style>

    <div class="comments" commentableid="162311">
        <div style="display: flow-root">
            <div class="title">
                <img src="//codeforces.com/codeforces.org/s/52448/images/icons/comments-48x48.png" alt="Comments" title="Comments" style="position:relative;top:0.6em;">
                <a name="comments">Comments (66)</a>

            </div>
            <div class="comments-actions-div">
                <a href="#" class="new-root-comment">Write comment?</a>
            </div>
        </div>

<div class="comment" commentid="1314290">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314290" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/ko_osaga" title="Legendary Grandmaster ko_osaga" class="rated-user user-legendary"><span class="legendary-user-first-letter">k</span>o_osaga</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:21 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314290" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/ko_osaga" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/210765/avatar/90b51bd6ebd11e79.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="//codeforces.com/codeforces.org/s/52448/images/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="/profile/ko_osaga" title="Legendary Grandmaster ko_osaga" class="rated-user user-legendary"><span class="legendary-user-first-letter">k</span>o_osaga</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:21 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314290" href="?#comment-1314290" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314290" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="210765" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314290">
                        <div class="moveup">
                        <div class="ttypography"><p><i>Auto comment: topic has been updated by <a class="rated-user user-legendary" href="/profile/ko_osaga" title="Legendary Grandmaster ko_osaga"><span class="legendary-user-first-letter">k</span>o_osaga</a> (<a href="/topic/147629/en1">previous revision</a>, <a href="/topic/147629/en2">new revision</a>, <a href="/topic/147629/diff/en1/en2">compare</a>).</i></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314290 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314290 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314290">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314293">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314293" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/discontinuous" title="Specialist discontinuous" class="rated-user user-cyan">discontinuous</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:23 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314293" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/discontinuous" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3281020/avatar/a0f5dd45571fce30.jpg">        </a>
        <div><a href="/profile/discontinuous" title="Specialist discontinuous" class="rated-user user-cyan">discontinuous</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:23 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314293" href="?#comment-1314293" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314293" class="CommentVoteFrame" myvotedirection="0" data-commentrating="10" data-commentuserid="3281020" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314293">
                        <div class="moveup">
                        <div class="ttypography"><p>Thanks for the fast editorial and the amazing contest :) </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314293 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314293 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314293">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314303">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314303" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/davidvivek" title="Specialist davidvivek" class="rated-user user-cyan">davidvivek</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:29 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">6</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314303" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/davidvivek" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4256523/avatar/964398d7c6147277.jpg">        </a>
        <div><a href="/profile/davidvivek" title="Specialist davidvivek" class="rated-user user-cyan">davidvivek</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:29 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314303" href="?#comment-1314303" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314303" class="CommentVoteFrame" myvotedirection="0" data-commentrating="13" data-commentuserid="4256523" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+13</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314303">
                        <div class="moveup">
                        <div class="ttypography"><p>Except for B&gt;C, it was a beautiful contest...</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314303 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314303 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314303">
                <li>
<div class="comment" commentid="1314521">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314521" commentparentid="1314303">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/baldy" title="Pupil baldy" class="rated-user user-green">baldy</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 12:29 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314521" commentparentid="1314303">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/baldy" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/5174307/avatar/f2731004ea8df543.jpg">        </a>
        <div><a href="/profile/baldy" title="Pupil baldy" class="rated-user user-green">baldy</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 12:29 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314521" href="?#comment-1314521" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314303" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1314521" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314521" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-13" data-commentuserid="5174307" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-13</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314521">
                        <div class="moveup">
                        <div class="ttypography"><p>C was easy than B.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314521 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314521 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314521">
                <li>
<div class="comment" commentid="1314775">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314775" commentparentid="1314521">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Nukumizu-Anna" title="Expert Nukumizu-Anna" class="rated-user user-blue">Nukumizu-Anna</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/05/2025 12:43 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314775" commentparentid="1314521">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Nukumizu-Anna" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2036253/avatar/5caf5ae52e286685.jpg">        </a>
        <div><a href="/profile/Nukumizu-Anna" title="Expert Nukumizu-Anna" class="rated-user user-blue">Nukumizu-Anna</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/05/2025 12:43 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314775" href="?#comment-1314775" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314521" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314775" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2036253" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314775">
                        <div class="moveup">
                        <div class="ttypography"><p>Yes,and it can be determined whether 01 is interleaved just by using the prefix sum!</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314775 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314775 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314775">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1314628">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314628" commentparentid="1314303">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/shizukaMinamoto" title="Newbie shizukaMinamoto" class="rated-user user-gray">shizukaMinamoto</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 16:32 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314628" commentparentid="1314303">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/shizukaMinamoto" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4187313/avatar/d581d69459a3abab.jpg">        </a>
        <div><a href="/profile/shizukaMinamoto" title="Newbie shizukaMinamoto" class="rated-user user-gray">shizukaMinamoto</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 16:32 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314628" href="?#comment-1314628" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314303" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314628" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4187313" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314628">
                        <div class="moveup">
                        <div class="ttypography"><p>bro how u check that there is a pair of same 0 or same 1 or not in a subarray</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314628 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314628 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314628">
                <li>
<div class="comment" commentid="1314632">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314632" commentparentid="1314628">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Ayush_Baghel" title="Pupil Ayush_Baghel" class="rated-user user-green">Ayush_Baghel</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 16:55 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314632" commentparentid="1314628">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Ayush_Baghel" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Ayush_Baghel" title="Pupil Ayush_Baghel" class="rated-user user-green">Ayush_Baghel</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 16:55 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314632" href="?#comment-1314632" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314628" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314632" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2987113" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314632">
                        <div class="moveup">
                        <div class="ttypography"><p>node of segment tree will contain two variables (left and right) -&gt; on merging check if either of the two subpart already have the adjacent element(i.e two consecutive 1's or 0's) or their left subarray's(right) and right subarray's(left) can make it.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314632 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314632 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314632">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1315476">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1315476" commentparentid="1314628">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/pawsitive" title="Newbie pawsitive" class="rated-user user-gray">pawsitive</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/07/2025 10:55 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1315476" commentparentid="1314628">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/pawsitive" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/pawsitive" title="Newbie pawsitive" class="rated-user user-gray">pawsitive</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/07/2025 10:55 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1315476" href="?#comment-1315476" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314628" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1315476" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3682969" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1315476">
                        <div class="moveup">
                        <div class="ttypography"><p>if we find the subarray to be alternating 0 and 1 or not, we can answer your question. Construct a dp which says for each index maximum length till which the sequence is alternating from that index.Then checking if index + dp[index]-1&gt;=r or determines answer to your question, (subarray is [index,r])</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1315476 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1315476 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1315476">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1315490">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1315490" commentparentid="1314303">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/KinaRight" title="Newbie KinaRight" class="rated-user user-gray">KinaRight</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/07/2025 12:10 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1315490" commentparentid="1314303">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/KinaRight" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/KinaRight" title="Newbie KinaRight" class="rated-user user-gray">KinaRight</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/07/2025 12:10 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1315490" href="?#comment-1315490" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314303" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1315490" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="5081564" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1315490">
                        <div class="moveup">
                        <div class="ttypography"><p>Really?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1315490 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1315490 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1315490">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314304">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314304" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/KrutoyHasan" title="Newbie KrutoyHasan" class="rated-user user-gray">KrutoyHasan</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:29 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314304" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/KrutoyHasan" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4877571/avatar/13d51d69215ccb0b.jpg">        </a>
        <div><a href="/profile/KrutoyHasan" title="Newbie KrutoyHasan" class="rated-user user-gray">KrutoyHasan</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:29 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314304" href="?#comment-1314304" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314304" class="CommentVoteFrame" myvotedirection="0" data-commentrating="79" data-commentuserid="4877571" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+79</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314304">
                        <div class="moveup">
                        <div class="ttypography"><p>B is my nightmare</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314304 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314304 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314304">
                <li>
<div class="comment" commentid="1314415">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314415" commentparentid="1314304">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/wangzhilin" title="Expert wangzhilin" class="rated-user user-blue">wangzhilin</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 04:22 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314415" commentparentid="1314304">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/wangzhilin" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4208853/avatar/9b9f84a26b53a2b9.jpg">        </a>
        <div><a href="/profile/wangzhilin" title="Expert wangzhilin" class="rated-user user-blue">wangzhilin</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 04:22 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314415" href="?#comment-1314415" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314304" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314415" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4208853" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314415">
                        <div class="moveup">
                        <div class="ttypography"><p>Agree lol.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314415 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314415 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314415">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314305">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314305" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/djm03178" title="Master djm03178" class="rated-user user-orange">djm03178</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:30 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">3</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314305" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/djm03178" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/djm03178" title="Master djm03178" class="rated-user user-orange">djm03178</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:30 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314305" href="?#comment-1314305" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314305" class="CommentVoteFrame" myvotedirection="0" data-commentrating="23" data-commentuserid="687688" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+23</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314305">
                        <div class="moveup">
                        <div class="ttypography"><p>Thank you all for participating! For fun, here are one-liner (except for inputs) python solutions for <a href="/contest/2152/problem/A">2152A - Increase or Smash</a> and <a href="/contest/2152/problem/B">2152B - Catching the Krug</a>. Although problem B turned out to be harder than my intention (but I'm glad that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mn" id="MJXp-Span-2">1500</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: MathJax_Main;">1500</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">1500</script> points worked!), I hope you still enjoyed the problems!</p> <div class="spoiler"><b class="spoiler-title">A. Increase or Smash</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">for</span><span class="pln"> t </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="kwd">set</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())))</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">B. Catching the Krug</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">for</span><span class="pln"> t </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
    n</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> c</span><span class="pun">,</span><span class="pln"> d </span><span class="pun">=</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">max</span><span class="pun">(</span><span class="pln">c </span><span class="kwd">if</span><span class="pln"> a</span><span class="pun">&lt;</span><span class="pln">c </span><span class="kwd">else</span><span class="pln"> n</span><span class="pun">-</span><span class="pln">c </span><span class="kwd">if</span><span class="pln"> a</span><span class="pun">&gt;</span><span class="pln">c </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> d </span><span class="kwd">if</span><span class="pln"> b</span><span class="pun">&lt;</span><span class="pln">d </span><span class="kwd">else</span><span class="pln"> n</span><span class="pun">-</span><span class="pln">d </span><span class="kwd">if</span><span class="pln"> b</span><span class="pun">&gt;</span><span class="pln">d </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pun">))</span></code></pre></div></div></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314305 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314305 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314305">
                <li>
<div class="comment" commentid="1314311">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314311" commentparentid="1314305">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/KrutoyHasan" title="Newbie KrutoyHasan" class="rated-user user-gray">KrutoyHasan</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:38 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314311" commentparentid="1314305">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/KrutoyHasan" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4877571/avatar/13d51d69215ccb0b.jpg">        </a>
        <div><a href="/profile/KrutoyHasan" title="Newbie KrutoyHasan" class="rated-user user-gray">KrutoyHasan</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:38 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314311" href="?#comment-1314311" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314305" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314311" class="CommentVoteFrame" myvotedirection="0" data-commentrating="21" data-commentuserid="4877571" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+21</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314311">
                        <div class="moveup">
                        <div class="ttypography"><p>Every unsolved problem teaches us.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314311 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314311 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314311">
                <li>
<div class="comment" commentid="1314398">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314398" commentparentid="1314311">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Feynman5210" title="Candidate Master Feynman5210" class="rated-user user-violet">Feynman5210</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 02:14 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314398" commentparentid="1314311">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Feynman5210" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Feynman5210" title="Candidate Master Feynman5210" class="rated-user user-violet">Feynman5210</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 02:14 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314398" href="?#comment-1314398" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314311" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314398" class="CommentVoteFrame" myvotedirection="0" data-commentrating="13" data-commentuserid="4128425" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+13</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314398">
                        <div class="moveup">
                        <div class="ttypography"><p>Yes</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314398 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314398 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314398">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1314418">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314418" commentparentid="1314305">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/bribritt" title="International Grandmaster bribritt" class="rated-user user-red">bribritt</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 04:41 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314418" commentparentid="1314305">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/bribritt" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/bribritt" title="International Grandmaster bribritt" class="rated-user user-red">bribritt</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 04:41 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314418" href="?#comment-1314418" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314305" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314418" class="CommentVoteFrame" myvotedirection="0" data-commentrating="65" data-commentuserid="2404174" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+65</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314418">
                        <div class="moveup">
                        <div class="ttypography"><p>If you want to be a try-hard at codegolfing, you can technically solve them in 1 line (including input reading).</p> <div class="spoiler"><b class="spoiler-title">A</b><div class="spoiler-content" style="display: none;"><p>The main idea is to use <code class="tt">"\n".join(array)</code> to solve all input instances at once.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">print</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">.</span><span class="kwd">join</span><span class="pun">([</span><span class="pln">input</span><span class="pun">()*</span><span class="lit">0</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="lit">2</span><span class="pun">*</span><span class="pln">len</span><span class="pun">(</span><span class="kwd">set</span><span class="pun">(</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">()))]))</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">B</b><div class="spoiler-content" style="display: none;"><p>We can use a lambda that takes in the input (as a list of 5 numbers) and outputs the correct answer.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">print</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">.</span><span class="kwd">join</span><span class="pun">([</span><span class="pln">str</span><span class="pun">((</span><span class="kwd">lambda</span><span class="pln"> inp</span><span class="pun">:</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">inp</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> inp</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]&lt;</span><span class="pln">inp</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> inp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]-</span><span class="pln">inp</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> inp</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]&gt;</span><span class="pln">inp</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> inp</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> inp</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]&lt;</span><span class="pln">inp</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> inp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]-</span><span class="pln">inp</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> inp</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]&gt;</span><span class="pln">inp</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pun">))(</span><span class="pln">list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))))</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">()))]))</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">C</b><div class="spoiler-content" style="display: none;"><p>Now, we need several lambdas, one to do precomputation and another to answer all our queries. Unfortunately, my solution needs to use <code class="tt">itertools</code>, making it 2 lines.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> itertools
</span><span class="kwd">print</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">.</span><span class="kwd">join</span><span class="pun">([(</span><span class="kwd">lambda</span><span class="pln"> q</span><span class="pun">:</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">lambda</span><span class="pln"> q</span><span class="pun">,</span><span class="pln"> psum</span><span class="pun">:</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">.</span><span class="kwd">join</span><span class="pun">([</span><span class="pln">str</span><span class="pun">((</span><span class="kwd">lambda</span><span class="pln"> lr</span><span class="pun">:</span><span class="pln"> </span><span class="pun">(-</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lr</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> lr</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> </span><span class="pun">(</span><span class="pln">psum</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">lr</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> psum</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">lr</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lr</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> lr</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="com">// 3 if psum[1][lr[0]-1] == psum[1][lr[1]-1] else (lr[1] - lr[0] + 1) // 3))(list(map(int,input().split())))) for _ in range(q)]))(q, (lambda a: (list(itertools.accumulate(a,initial=0)), list(itertools.accumulate([1 if a[i]==a[i-1] else 0 for i in range(1,len(a))],initial=0))))(list(map(int,input().split()))))))(int(input().split()[1])) for _ in range(int(input()))]))</span></code></pre><p>If you were to unpack the lambdas, it would look like this (note that <code class="tt">singlequery</code> leads to RTE(1) as psum is not defined in its scope):</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> itertools
singlequery </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pln"> lr</span><span class="pun">:</span><span class="pln"> </span><span class="pun">(-</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lr</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> lr</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> </span><span class="pun">(</span><span class="pln">psum</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">lr</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> psum</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="pln">lr</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lr</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> lr</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="com">// 3 if psum[1][lr[0]-1] == psum[1][lr[1]-1] else (lr[1] - lr[0] + 1) // 3)</span><span class="pln">
allquery </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pln"> q</span><span class="pun">,</span><span class="pln"> psum</span><span class="pun">:</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">.</span><span class="kwd">join</span><span class="pun">([</span><span class="pln">str</span><span class="pun">(</span><span class="pln">singlequery</span><span class="pun">(</span><span class="pln">list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))))</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">q</span><span class="pun">)])</span><span class="pln">
precomp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pln"> a</span><span class="pun">:</span><span class="pln"> </span><span class="pun">(</span><span class="pln">list</span><span class="pun">(</span><span class="pln">itertools</span><span class="pun">.</span><span class="pln">accumulate</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">initial</span><span class="pun">=</span><span class="lit">0</span><span class="pun">)),</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">itertools</span><span class="pun">.</span><span class="pln">accumulate</span><span class="pun">([</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">len</span><span class="pun">(</span><span class="pln">a</span><span class="pun">))],</span><span class="pln">initial</span><span class="pun">=</span><span class="lit">0</span><span class="pun">)))</span><span class="pln">
solve </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pln"> q</span><span class="pun">:</span><span class="pln"> allquery</span><span class="pun">(</span><span class="pln">q</span><span class="pun">,</span><span class="pln"> precomp</span><span class="pun">(</span><span class="pln">list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))))</span><span class="pln">
</span><span class="kwd">print</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">.</span><span class="kwd">join</span><span class="pun">([</span><span class="pln">solve</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()[</span><span class="lit">1</span><span class="pun">]))</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">()))]))</span></code></pre><p>Here, <code class="tt">singlequery</code> outputs the answer to the query. <code class="tt">allquery</code> processes all queries into a string. <code class="tt">precomp</code> generates two prefix sum arrays necessary for solving queries, and <code class="tt">solve</code> solves a testcase.</p></div></div></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314418 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314418 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314418">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314312">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314312" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/_LeMur_" title="Master _LeMur_" class="rated-user user-orange">_LeMur_</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:43 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314312" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/_LeMur_" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/149870/avatar/fbbb05d82f15c986.jpg">        </a>
        <div><a href="/profile/_LeMur_" title="Master _LeMur_" class="rated-user user-orange">_LeMur_</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:43 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314312" href="?#comment-1314312" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314312" class="CommentVoteFrame" myvotedirection="0" data-commentrating="11" data-commentuserid="149870" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+11</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314312">
                        <div class="moveup">
                        <div class="ttypography"><p>Great problems!</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314312 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314312 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314312">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314316">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314316" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/RustamT" title="Newbie RustamT" class="rated-user user-gray">RustamT</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:51 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314316" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/RustamT" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3192263/avatar/13c6d221664c7f5e.jpg">        </a>
        <div><a href="/profile/RustamT" title="Newbie RustamT" class="rated-user user-gray">RustamT</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:51 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314316" href="?#comment-1314316" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314316" class="CommentVoteFrame" myvotedirection="0" data-commentrating="2" data-commentuserid="3192263" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+2</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314316">
                        <div class="moveup">
                        <div class="ttypography"><p>First time tried D before C for more points and I hate myself. Waiting for intuition of D... Was sure it was about log2</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314316 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314316 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314316">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314318">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314318" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/OtterZ" title="Candidate Master OtterZ" class="rated-user user-violet">OtterZ</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:55 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314318" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/OtterZ" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2303907/avatar/a7e48a06cc657106.jpg">        </a>
        <div><a href="/profile/OtterZ" title="Candidate Master OtterZ" class="rated-user user-violet">OtterZ</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 18:55 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314318" href="?#comment-1314318" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314318" class="CommentVoteFrame" myvotedirection="0" data-commentrating="11" data-commentuserid="2303907" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+11</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314318">
                        <div class="moveup">
                        <div class="ttypography"><p>Such contest might make me drop a lot,go and learn binary search</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314318 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314318 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314318">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314323">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314323" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Trumpsunderwear" title="Newbie Trumpsunderwear" class="rated-user user-gray">Trumpsunderwear</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 19:01 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314323" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Trumpsunderwear" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3910021/avatar/a266b88af1c517b3.jpg">        </a>
        <div><a href="/profile/Trumpsunderwear" title="Newbie Trumpsunderwear" class="rated-user user-gray">Trumpsunderwear</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 19:01 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314323" href="?#comment-1314323" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314323" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3910021" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314323">
                        <div class="moveup">
                        <div class="ttypography"><p>For problem-B, Is it true that Doran always catches Krug in atmost 'n' moves even for worst possible case?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314323 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314323 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314323">
                <li>
<div class="comment" commentid="1314326">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314326" commentparentid="1314323">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/h_maano" title="Pupil h_maano" class="rated-user user-green">h_maano</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 19:04 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314326" commentparentid="1314323">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/h_maano" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/h_maano" title="Pupil h_maano" class="rated-user user-green">h_maano</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 19:04 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314326" href="?#comment-1314326" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314323" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1314326" revisioncount="4" revision="4">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">4</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314326" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4305822" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314326">
                        <div class="moveup">
                        <div class="ttypography"><p>yes., its more like it catches in max n-1 move. max survival time will be n</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314326 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314326 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314326">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314339">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314339" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/JeanBombeur" title="International Master JeanBombeur" class="rated-user user-orange">JeanBombeur</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 19:31 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314339" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/JeanBombeur" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1573780/avatar/cc066acc9d50cde.jpg">        </a>
        <div><a href="/profile/JeanBombeur" title="International Master JeanBombeur" class="rated-user user-orange">JeanBombeur</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 19:31 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314339" href="?#comment-1314339" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314339" class="CommentVoteFrame" myvotedirection="0" data-commentrating="145" data-commentuserid="1573780" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+145</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314339">
                        <div class="moveup">
                        <div class="ttypography"><p>F be like</p><p><img alt=" " src="/predownloaded/3f/26/3f26a5730104d1ed311d927aa4ec115dd475de33.jpg" style="max-width: 100.0%;max-height: 100.0%;"></p><p>Great problem by the way !</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314339 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314339 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314339">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314341">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314341" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/H_R_K" title="Specialist H_R_K" class="rated-user user-cyan">H_R_K</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 19:46 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314341" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/H_R_K" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/H_R_K" title="Specialist H_R_K" class="rated-user user-cyan">H_R_K</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 19:46 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314341" href="?#comment-1314341" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314341" class="CommentVoteFrame" myvotedirection="0" data-commentrating="8" data-commentuserid="4013944" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314341">
                        <div class="moveup">
                        <div class="ttypography"><p>Thanks for the great contest :)</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314341 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314341 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314341">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314343">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314343" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/mzhao" title="Specialist mzhao" class="rated-user user-cyan">mzhao</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 19:54 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">3</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314343" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/mzhao" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/401363/avatar/5a3a8fdd0d16954c.jpg">        </a>
        <div><a href="/profile/mzhao" title="Specialist mzhao" class="rated-user user-cyan">mzhao</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 19:54 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314343" href="?#comment-1314343" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1314343" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314343" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="401363" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314343">
                        <div class="moveup">
                        <div class="ttypography"><p>For problem D, could someone explain why Poby and Rekkles are always able to find fresh "B"'s in their strategies? What if the array is (8, 8, 9), then one of them touches 9, then the other two elements are type A...</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314343 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314343 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314343">
                <li>
<div class="comment" commentid="1314357">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314357" commentparentid="1314343">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/kpiyush1024" title="Specialist kpiyush1024" class="rated-user user-cyan">kpiyush1024</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 20:18 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314357" commentparentid="1314343">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/kpiyush1024" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/kpiyush1024" title="Specialist kpiyush1024" class="rated-user user-cyan">kpiyush1024</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 20:18 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314357" href="?#comment-1314357" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314343" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1314357" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314357" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="1575574" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314357">
                        <div class="moveup">
                        <div class="ttypography"><p>I think it happens only when possible ( If Poby just first-touched a fresh B, Rekkles first-touches another fresh B when possible). And B's will have priority as they are the inflection points. </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314357 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314357 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314357">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1314416">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314416" commentparentid="1314343">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Cappybara" title="Specialist Cappybara" class="rated-user user-cyan">Cappybara</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 04:24 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314416" commentparentid="1314343">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Cappybara" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4034878/avatar/e6c7a59a295f5a74.jpg">        </a>
        <div><a href="/profile/Cappybara" title="Specialist Cappybara" class="rated-user user-cyan">Cappybara</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 04:24 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314416" href="?#comment-1314416" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314343" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1314416" revisioncount="4" revision="4">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">4</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314416" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4034878" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314416">
                        <div class="moveup">
                        <div class="ttypography"><p>Type A have no problem, because Rekkles has to make a number 2^n into 2^n + 2 to be able to increase the number of moves by 1. But as soon as he increases it by 1, Poby will be making it again of the form 2^m by dividing by 2 and Rekkles has to increase it again by 2.</p><p>but if it is of the form 2^n + 1 in the start, then Poby can save atmost half of them, because if he saves 1 by dividing by 2, Rekkles makes another one of the form 2^n + 2. </p><p>any other number will be atleast of the form 2^n + 2 .... which will be eventually reduced to 2^m + 1, Rekkles will make it again atleast of the form 2^m + 2. So Poby cant save any of these numbers from Rekkles.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314416 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314416 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314416">
                <li>
<div class="comment" commentid="1314417">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314417" commentparentid="1314416">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Cappybara" title="Specialist Cappybara" class="rated-user user-cyan">Cappybara</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 04:29 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314417" commentparentid="1314416">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Cappybara" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4034878/avatar/e6c7a59a295f5a74.jpg">        </a>
        <div><a href="/profile/Cappybara" title="Specialist Cappybara" class="rated-user user-cyan">Cappybara</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 04:29 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314417" href="?#comment-1314417" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314416" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314417" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4034878" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314417">
                        <div class="moveup">
                        <div class="ttypography"><p>Why Rekkles want the number to be of the form 2^n + 2?</p><p>because when it will be reduced to 2^m + 1(m=n-1), Rekkles will again make it 2^m + 2</p><p>and so on until it reaches 3(2^1 + 1), and Rekkles will make it 4. so it increases the move count by 1.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314417 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314417 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314417">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314347">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314347" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/RuchitJagodara" title="Expert RuchitJagodara" class="rated-user user-blue">RuchitJagodara</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 20:00 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314347" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/RuchitJagodara" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/RuchitJagodara" title="Expert RuchitJagodara" class="rated-user user-blue">RuchitJagodara</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 20:00 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314347" href="?#comment-1314347" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1314347" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314347" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4011506" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314347">
                        <div class="moveup">
                        <div class="ttypography"><p>UPD: Found the issue, Thanks to <a class="rated-user user-orange" href="/profile/djm03178" title="Master djm03178">djm03178</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314347 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314347 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314347">
                <li>
<div class="comment" commentid="1314350">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314350" commentparentid="1314347">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/djm03178" title="Master djm03178" class="rated-user user-orange">djm03178</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 20:04 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314350" commentparentid="1314347">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/djm03178" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/djm03178" title="Master djm03178" class="rated-user user-orange">djm03178</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 20:04 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314350" href="?#comment-1314350" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314347" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314350" class="CommentVoteFrame" myvotedirection="0" data-commentrating="25" data-commentuserid="687688" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+25</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314350">
                        <div class="moveup">
                        <div class="ttypography"><p>You returned the function after printing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mo" id="MJXp-Span-4" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-5">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-5"><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-7" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">-1</script>, so you get inputs in a wrong way afterwards when <code class="tt">soln()</code> is called again.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314350 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314350 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314350">
                <li>
<div class="comment" commentid="1314352">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314352" commentparentid="1314350">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/RuchitJagodara" title="Expert RuchitJagodara" class="rated-user user-blue">RuchitJagodara</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 20:05 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314352" commentparentid="1314350">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/RuchitJagodara" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/RuchitJagodara" title="Expert RuchitJagodara" class="rated-user user-blue">RuchitJagodara</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 20:05 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314352" href="?#comment-1314352" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314350" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314352" class="CommentVoteFrame" myvotedirection="0" data-commentrating="14" data-commentuserid="4011506" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+14</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314352">
                        <div class="moveup">
                        <div class="ttypography"><p>Oh, right, Thank you for pointing out. And apologize for the mistake.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314352 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314352 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314352">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314360">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314360" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Senku" title="Expert Senku" class="rated-user user-blue">Senku</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 20:27 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">4</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314360" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Senku" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2156110/avatar/9bfc601ee7f1eadf.jpg">        </a>
        <div><a href="/profile/Senku" title="Expert Senku" class="rated-user user-blue">Senku</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 20:27 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314360" href="?#comment-1314360" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314360" class="CommentVoteFrame" myvotedirection="0" data-commentrating="3" data-commentuserid="2156110" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314360">
                        <div class="moveup">
                        <div class="ttypography"><p>My Solution for E using DAG <a href="/contest/2152/submission/341753535" title="Submission 341753535 by Senku">341753535</a></p><p>Would be great if someone could prove why it works</p><p>Basically, I tried to build a DAG using the queries where each index is a node and edges point from index with smaller value to index with greater value. Then find a path of length n + 1 such that indices on that path are monotonically increasing or decreasing. I'm not sure why a path of length n + 1 always exists in this DAG.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314360 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314360 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314360">
                <li>
<div class="comment" commentid="1314368">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314368" commentparentid="1314360">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Noobish_Monk" title="Grandmaster Noobish_Monk" class="rated-user user-red">Noobish_Monk</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 21:08 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">3</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314368" commentparentid="1314360">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Noobish_Monk" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2080623/avatar/4376653b319b765a.jpg">        </a>
        <div><a href="/profile/Noobish_Monk" title="Grandmaster Noobish_Monk" class="rated-user user-red">Noobish_Monk</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 21:08 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314368" href="?#comment-1314368" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314360" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314368" class="CommentVoteFrame" myvotedirection="0" data-commentrating="5" data-commentuserid="2080623" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314368">
                        <div class="moveup">
                        <div class="ttypography"><p>As far as I understand that's what the editorial does, transitions in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">p</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-9"><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;">p</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">dp</script> can be viewed as a path in a DAG, though I might be mistaken.</p><p>This graph is literally all relations between elemenets which you can get with queries, so it will cover some construction which always appears. That construction is as follows:</p><p>there will be 1 element left. Then look at the records from queries in reverse order, and at each step pick the record closest to current element which is to its left. The DAG contains this path.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314368 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314368 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314368">
                <li>
<div class="comment" commentid="1314371">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314371" commentparentid="1314368">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Senku" title="Expert Senku" class="rated-user user-blue">Senku</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 21:31 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314371" commentparentid="1314368">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Senku" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2156110/avatar/9bfc601ee7f1eadf.jpg">        </a>
        <div><a href="/profile/Senku" title="Expert Senku" class="rated-user user-blue">Senku</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 21:31 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314371" href="?#comment-1314371" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314368" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314371" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2156110" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314371">
                        <div class="moveup">
                        <div class="ttypography"><p>What do u mean by “there will be 1 element left”?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314371 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314371 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314371">
                <li>
<div class="comment" commentid="1314372">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314372" commentparentid="1314371">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Noobish_Monk" title="Grandmaster Noobish_Monk" class="rated-user user-red">Noobish_Monk</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 21:38 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314372" commentparentid="1314371">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Noobish_Monk" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2080623/avatar/4376653b319b765a.jpg">        </a>
        <div><a href="/profile/Noobish_Monk" title="Grandmaster Noobish_Monk" class="rated-user user-red">Noobish_Monk</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 21:38 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314372" href="?#comment-1314372" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314371" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314372" class="CommentVoteFrame" myvotedirection="0" data-commentrating="5" data-commentuserid="2080623" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314372">
                        <div class="moveup">
                        <div class="ttypography"><p>The one which isn't a record in any of the queries (since there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-msubsup" id="MJXp-Span-10"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-12" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-14">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-13"><span class="msubsup" id="MathJax-Span-14"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.618em;"><span class="mn" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-18" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">n^2 + 1</script> and each query covers at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-19"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">n</script>)</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314372 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314372 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314372">
                <li>
<div class="comment" commentid="1314376">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314376" commentparentid="1314372">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Senku" title="Expert Senku" class="rated-user user-blue">Senku</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 21:52 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314376" commentparentid="1314372">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Senku" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2156110/avatar/9bfc601ee7f1eadf.jpg">        </a>
        <div><a href="/profile/Senku" title="Expert Senku" class="rated-user user-blue">Senku</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 21:52 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314376" href="?#comment-1314376" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314372" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314376" class="CommentVoteFrame" myvotedirection="0" data-commentrating="8" data-commentuserid="2156110" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314376">
                        <div class="moveup">
                        <div class="ttypography"><p>Ohh right. If some query returns more than n indices then that would be the answer, and if not, then your construction would be present. </p><p>Awesome proof, thanks :)</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314376 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314376 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314376">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314367">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314367" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/marseille" title="Candidate Master marseille" class="rated-user user-violet">marseille</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 21:00 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314367" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/marseille" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3983559/avatar/44c05b2cfb23dd42.jpg">        </a>
        <div><a href="/profile/marseille" title="Candidate Master marseille" class="rated-user user-violet">marseille</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/03/2025 21:00 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314367" href="?#comment-1314367" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314367" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3983559" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314367">
                        <div class="moveup">
                        <div class="ttypography"><p>My solution for F <a href="/contest/2152/submission/341757812" title="Submission 341757812 by marseille">341757812</a><br> Brute forced the possible states. Start with all {i, i+1} and add state {i+1, pos}, where {i, i+1, pos} is the most optimal pair. Could not find a bound on the number of states but somehow it works!</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314367 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314367 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314367">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314386">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314386" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/AeeE5x" title="Specialist AeeE5x" class="rated-user user-cyan">AeeE5x</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 00:46 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314386" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/AeeE5x" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4973996/avatar/f48c453fd0758315.jpg">        </a>
        <div><a href="/profile/AeeE5x" title="Specialist AeeE5x" class="rated-user user-cyan">AeeE5x</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 00:46 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314386" href="?#comment-1314386" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314386" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4973996" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314386">
                        <div class="moveup">
                        <div class="ttypography"><p>People who are not good at game theory:</p><p>A: 495 0:04</p><p>B: 1236 01:06</p><p>C: 1176 01:21</p><p>D: -2</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314386 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314386 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314386">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314388">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314388" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Sai_t" title="International Grandmaster Sai_t" class="rated-user user-red">Sai_t</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 01:18 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314388" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Sai_t" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1397506/avatar/d1301331b710c4bf.jpg">        </a>
        <div><a href="/profile/Sai_t" title="International Grandmaster Sai_t" class="rated-user user-red">Sai_t</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 01:18 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314388" href="?#comment-1314388" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314388" class="CommentVoteFrame" myvotedirection="0" data-commentrating="13" data-commentuserid="1397506" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+13</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314388">
                        <div class="moveup">
                        <div class="ttypography"><p>Why no stronger samples TAT</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314388 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314388 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314388">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314390">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314390" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/ashish1729" title="Specialist ashish1729" class="rated-user user-cyan">ashish1729</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 01:37 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314390" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/ashish1729" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/ashish1729" title="Specialist ashish1729" class="rated-user user-cyan">ashish1729</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 01:37 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314390" href="?#comment-1314390" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314390" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="297113" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314390">
                        <div class="moveup">
                        <div class="ttypography"><p>Would someone like to share how they came up with the intuition for problem D? Thanks.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314390 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314390 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314390">
                <li>
<div class="comment" commentid="1314397">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314397" commentparentid="1314390">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/kr25161" title="Expert kr25161" class="rated-user user-blue">kr25161</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 02:12 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314397" commentparentid="1314390">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/kr25161" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2918765/avatar/4ae7dc68e3e9698a.jpg">        </a>
        <div><a href="/profile/kr25161" title="Expert kr25161" class="rated-user user-blue">kr25161</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 02:12 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314397" href="?#comment-1314397" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314390" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1314397" revisioncount="9" revision="9">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">9</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314397" class="CommentVoteFrame" myvotedirection="0" data-commentrating="19" data-commentuserid="2918765" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+19</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314397">
                        <div class="moveup">
                        <div class="ttypography"><ul>   <li>first understand that once a element becomes a power of 2, it cannot contribute anymore to increase in no of poby operations. it gives us a base that max answer could be</li> </ul> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-msubsup" id="MJXp-Span-18"><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">r</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">i</span><span class="MJXp-mo" id="MJXp-Span-22">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">l</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-26"><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.08em;">⌊</span></span><span class="MJXp-msubsup" id="MJXp-Span-28"><span class="MJXp-mi" id="MJXp-Span-29" style="margin-right: 0.05em;">log</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-30" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-31">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-35" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.08em;">⌋</span></span></span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">r</span><span class="MJXp-mo" id="MJXp-Span-40" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">l</span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-43">1</span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-22"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-23"><span class="munderover" id="MathJax-Span-24"><span style="display: inline-block; position: relative; width: 2.157em; height: 0px;"><span style="position: absolute; clip: rect(3.08em, 1000.99em, 4.434em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.511em, 1000.37em, 4.188em, -999.997em); top: -4.489em; left: 1.049em;"><span class="texatom" id="MathJax-Span-26"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.326em, 1001.11em, 4.188em, -999.997em); top: -3.689em; left: 1.049em;"><span class="texatom" id="MathJax-Span-29"><span class="mrow" id="MathJax-Span-30"><span class="mi" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-32" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-33" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mrow" id="MathJax-Span-34" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main;">⌊</span><span class="msubsup" id="MathJax-Span-36"><span style="display: inline-block; position: relative; width: 1.726em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1001.29em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Main;">log</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.295em;"><span class="texatom" id="MathJax-Span-38"><span class="mrow" id="MathJax-Span-39"><span class="mn" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-41"></span><span class="msubsup" id="MathJax-Span-42" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">⌋</span></span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main; padding-left: 0.249em;">(</span><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">l</span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-52" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main;">.</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">\sum_{i=l}^{r} \left\lfloor \log_{2} a_i \right\rfloor + (r-l+1).</script></center> <ul>   <li>lets assume rekless wont add +1 to the same element twice, making it +2. it just becomes complex.</li>   <li>ignore the power of two elements they are of no use</li>   <li>now the main strategy that helps is, what happens if rekkless adds a +1 to the same element poby floor divided. will that strategy ensure that we can get maximum answer ?</li>   <li>happens that there are two types of elements, type1 where if rekkless keeps adding a +1 "after" the floor division, it can provide a +1 to the answer. so type1 elements always contribute to answer with "+1", as rekkless can simply add +1 to any element poby floor divides. poby can do nothing about it and its pre determined.</li>   <li>type2 where rekkless has to keep add a "+1" before poby floor divides it. if the first operation on such elements is floor division, they become useless, instead if its a "+1" operation they convert into type1 elements.</li>   <li>so the initial strategy for poby is to get rid of as many type2 elements by floor divinding them once and making them useless for further, and so for rekkless is to do +1 to as many elements type2 and converting them into type1 elements.</li>   <li>so rekkless can force the game to always achieve</li> </ul> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-46"><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-53"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">r</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-49"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">i</span><span class="MJXp-mo" id="MJXp-Span-51">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">l</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-55"><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.08em;">⌊</span></span><span class="MJXp-msubsup" id="MJXp-Span-57"><span class="MJXp-mi" id="MJXp-Span-58" style="margin-right: 0.05em;">log</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-59" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-60">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-62"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-64" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.08em;">⌋</span></span></span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-67">type1 in&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">l</span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">r</span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-74"><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-76" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mtext" id="MJXp-Span-77">type2 in&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-78">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">l</span><span class="MJXp-mo" id="MJXp-Span-80">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">r</span><span class="MJXp-mo" id="MJXp-Span-82">]</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-83">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-56"><span class="munderover" id="MathJax-Span-57"><span style="display: inline-block; position: relative; width: 2.157em; height: 0px;"><span style="position: absolute; clip: rect(3.08em, 1000.99em, 4.434em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.511em, 1000.37em, 4.188em, -999.997em); top: -4.489em; left: 1.049em;"><span class="texatom" id="MathJax-Span-59"><span class="mrow" id="MathJax-Span-60"><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.326em, 1001.11em, 4.188em, -999.997em); top: -3.689em; left: 1.049em;"><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-65" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-66" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mrow" id="MathJax-Span-67" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">⌊</span><span class="msubsup" id="MathJax-Span-69"><span style="display: inline-block; position: relative; width: 1.726em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1001.29em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Main;">log</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.295em;"><span class="texatom" id="MathJax-Span-71"><span class="mrow" id="MathJax-Span-72"><span class="mn" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-74"></span><span class="msubsup" id="MathJax-Span-75" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">⌋</span></span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mtext" id="MathJax-Span-80" style="font-family: MathJax_Main; padding-left: 0.249em;">type1 in&nbsp;</span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">r</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mrow" id="MathJax-Span-87" style="padding-left: 0.249em;"><span class="mo" id="MathJax-Span-88" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">⌊</span></span><span class="mfrac" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 3.88em; height: 0px; margin-right: 0.126em; margin-left: 0.126em;"><span style="position: absolute; clip: rect(3.265em, 1003.7em, 4.372em, -999.997em); top: -4.612em; left: 50%; margin-left: -1.905em;"><span class="mrow" id="MathJax-Span-90"><span class="mtext" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Main;">type2 in&nbsp;</span><span class="mo" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-93" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-95" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.326em, 1000.31em, 4.188em, -999.997em); top: -3.628em; left: 50%; margin-left: -0.182em;"><span class="mn" id="MathJax-Span-97" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1003.88em, 1.295em, -999.997em); top: -1.351em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.88em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.111em;"></span></span></span></span><span class="mo" id="MathJax-Span-98" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">⌋</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">\sum_{i=l}^{r} \left\lfloor \log_{2} a_i \right\rfloor + \text{type1 in } [l,r] + \left\lfloor \frac{\text{type2 in } [l,r]}{2} \right\rfloor   </script></center> <ul>   <li>we can see that "+2" case is not needed in a optimal sequence of moves.</li> </ul></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314397 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314397 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314397">
                <li>
<div class="comment" commentid="1314437">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314437" commentparentid="1314397">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/ashish1729" title="Specialist ashish1729" class="rated-user user-cyan">ashish1729</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 06:35 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314437" commentparentid="1314397">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/ashish1729" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/ashish1729" title="Specialist ashish1729" class="rated-user user-cyan">ashish1729</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 06:35 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314437" href="?#comment-1314437" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314397" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314437" class="CommentVoteFrame" myvotedirection="0" data-commentrating="1" data-commentuserid="297113" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314437">
                        <div class="moveup">
                        <div class="ttypography"><p>ok, thanks for writing this.. I will spend some time understanding this.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314437 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314437 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314437">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314407">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314407" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/LXL4510" title="Candidate Master LXL4510" class="rated-user user-violet">LXL4510</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 02:54 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314407" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/LXL4510" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2925782/avatar/87ead4ecd3339483.jpg">        </a>
        <div><a href="/profile/LXL4510" title="Candidate Master LXL4510" class="rated-user user-violet">LXL4510</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 02:54 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314407" href="?#comment-1314407" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314407" class="CommentVoteFrame" myvotedirection="0" data-commentrating="1" data-commentuserid="2925782" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314407">
                        <div class="moveup">
                        <div class="ttypography"><p>B is unexpectedly difficult. but i finally solve it. E is expectedly difficult. but i don't solve it untill end. ;(</p><p>Can anyone share how to think of solution of E ?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314407 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314407 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314407">
                <li>
<div class="comment" commentid="1314461">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314461" commentparentid="1314407">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/_Kee" title="Expert _Kee" class="rated-user user-blue">_Kee</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 08:14 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314461" commentparentid="1314407">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/_Kee" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/_Kee" title="Expert _Kee" class="rated-user user-blue">_Kee</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 08:14 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314461" href="?#comment-1314461" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314407" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314461" class="CommentVoteFrame" myvotedirection="0" data-commentrating="3" data-commentuserid="597892" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314461">
                        <div class="moveup">
                        <div class="ttypography"><p>Take a look at <a href="https://codeforces.com/blog/entry/147005">my editorial for problem E</a>.</p><p>(Initially I wrote it as a comment here, but Codeforces blocked me from posting it, saying "The comment contains source code without markup." So I put it in my blog...)</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314461 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314461 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314461">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314410">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314410" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/shiny_shine" title="Master shiny_shine" class="rated-user user-orange">shiny_shine</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 03:26 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314410" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/shiny_shine" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2683519/avatar/79a89f3775dc3f8a.jpg">        </a>
        <div><a href="/profile/shiny_shine" title="Master shiny_shine" class="rated-user user-orange">shiny_shine</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 03:26 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314410" href="?#comment-1314410" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314410" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2683519" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314410">
                        <div class="moveup">
                        <div class="ttypography"><p>Reached Master with this contest, thanks for the amazing A-E and brute-force-able F :)</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314410 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314410 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314410">
                <li>
<div class="comment" commentid="1314476">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314476" commentparentid="1314410">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Feynman5210" title="Candidate Master Feynman5210" class="rated-user user-violet">Feynman5210</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 09:50 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314476" commentparentid="1314410">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Feynman5210" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Feynman5210" title="Candidate Master Feynman5210" class="rated-user user-violet">Feynman5210</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 09:50 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314476" href="?#comment-1314476" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314410" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314476" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4128425" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314476">
                        <div class="moveup">
                        <div class="ttypography"><p>If the time limit is 2s</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314476 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314476 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314476">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1314524">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314524" commentparentid="1314410">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/_ThanhDat_" title="Candidate Master _ThanhDat_" class="rated-user user-violet">_ThanhDat_</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 13:02 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314524" commentparentid="1314410">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/_ThanhDat_" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/585549/avatar/3bbf716713a0c7c9.jpg">        </a>
        <div><a href="/profile/_ThanhDat_" title="Candidate Master _ThanhDat_" class="rated-user user-violet">_ThanhDat_</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 13:02 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314524" href="?#comment-1314524" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314410" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314524" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="585549" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314524">
                        <div class="moveup">
                        <div class="ttypography"><p>congratulations! I wish someday could reach Master just like you did that day</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314524 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314524 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314524">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314411">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314411" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/dream7" title="Specialist dream7" class="rated-user user-cyan">dream7</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 03:36 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314411" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/dream7" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2172537/avatar/490dfa1a75be245a.jpg">        </a>
        <div><a href="/profile/dream7" title="Specialist dream7" class="rated-user user-cyan">dream7</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 03:36 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314411" href="?#comment-1314411" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1314411" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314411" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2172537" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314411">
                        <div class="moveup">
                        <div class="ttypography"><p>Why does my code works? Can anyone explain? <a href="https://codeforces.com/contest/2152/submission/341725079">code:problem D</a></p><p>I basically divided initial v[i]s based on who act first on that element. I calculated #ops it takes to make it 1, by starting from v[i] (first op made by player A) and by starting at v[i]+1 (first op made by player B). This way, I calculated what all v[i] take +1 extra operation when player B act first on it.</p><p>Then result of [l,r] is = orignal #ops + cnt/2, where cnt is total number of v[i]s where you have chance to increase operation by +1 if player B starts first. </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314411 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314411 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314411">
                <li>
<div class="comment" commentid="1316124">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1316124" commentparentid="1314411">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Girgit01" title="Newbie Girgit01" class="rated-user user-gray">Girgit01</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/10/2025 05:04 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1316124" commentparentid="1314411">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Girgit01" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/5122176/avatar/d1bc5b8158e69af8.jpg">        </a>
        <div><a href="/profile/Girgit01" title="Newbie Girgit01" class="rated-user user-gray">Girgit01</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/10/2025 05:04 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1316124" href="?#comment-1316124" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314411" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1316124" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="5122176" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1316124">
                        <div class="moveup">
                        <div class="ttypography"><p>why cnt/2 shouldn't it be cnt — 1 as for all the v[i] B will act first and increase value by 1 except in the starting case as A has to make the first move</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1316124 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1316124 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1316124">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314438">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314438" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/harshcooljn" title="Specialist harshcooljn" class="rated-user user-cyan">harshcooljn</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 06:38 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314438" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/harshcooljn" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3463794/avatar/fd4532fa70f2f5de.jpg">        </a>
        <div><a href="/profile/harshcooljn" title="Specialist harshcooljn" class="rated-user user-cyan">harshcooljn</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 06:38 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314438" href="?#comment-1314438" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314438" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3463794" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314438">
                        <div class="moveup">
                        <div class="ttypography"><p><strong>New Problem Suggestion as C2 : Triple Removal (Hard Version)</strong></p><p>In this version of the problem there will be 2 kinds of queries </p> <ol>   <li><p>1 l r : To find minimum cost for the array [al,...,ar]</p></li>   <li><p>2 i : Flip the bit at index i (i.e set a[i] = a[i]^1) (Point update)</p></li> </ol><p>I got this idea while solving C using segment tree </p><p>My solution for C : <a href="https://codeforces.com/contest/2152/submission/341788525">https://codeforces.com/contest/2152/submission/341788525</a></p><p>Inspired solution for the new version of the problem — </p> <div class="spoiler"><b class="spoiler-title">Node Structure</b><div class="spoiler-content" style="display: none;"><p>Node structure for segment tree : (in the following definitions "range" refers to the range that the segment tree node is responsible for)</p> <ol>   <li><p>cnt0 = frequency of 0 in the range</p></li>   <li><p>cnt1 = frequency of 1 in the range</p></li>   <li><p>min0 = minimum distance between 2 zeros in the range </p></li>   <li><p>min1 = minimum distance between 2 ones in the range</p></li>   <li><p>f0 = index of first occurrence of 0 in the range</p></li>   <li><p>l0 = index of last occurrence of 0 in the range</p></li>   <li><p>f1 = index of first occurrence of 1 in the range</p></li>   <li><p>l1 = index of last occurrence of 1 in the range</p></li> </ol></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">/* Coded by harshcooljn */</span><span class="pln">

</span><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> vll vector</span><span class="str">&lt;ll&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> fr</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">a</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">=</span><span class="pln">a</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> fastIO ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Segtree</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="kwd">public</span><span class="pun">:</span><span class="pln">
    </span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">struct</span><span class="pln"> node </span><span class="pun">{</span><span class="pln">
        ll cnt0</span><span class="pun">,</span><span class="pln"> cnt1</span><span class="pun">;</span><span class="pln">
        ll min1</span><span class="pun">,</span><span class="pln"> min0</span><span class="pun">;</span><span class="pln">
        ll f0</span><span class="pun">,</span><span class="pln"> l0</span><span class="pun">,</span><span class="pln"> f1</span><span class="pun">,</span><span class="pln"> l1</span><span class="pun">;</span><span class="pln">
        node</span><span class="pun">(</span><span class="pln">ll cnt0 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> ll cnt1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> ll min1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">,</span><span class="pln"> ll min0 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">,</span><span class="pln"> ll f0 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> ll l0 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> ll f1 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> ll l1 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">this</span><span class="pun">-&gt;</span><span class="pln">cnt0 </span><span class="pun">=</span><span class="pln"> cnt0</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">this</span><span class="pun">-&gt;</span><span class="pln">cnt1 </span><span class="pun">=</span><span class="pln"> cnt1</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">this</span><span class="pun">-&gt;</span><span class="pln">min0 </span><span class="pun">=</span><span class="pln"> min0</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">this</span><span class="pun">-&gt;</span><span class="pln">min1 </span><span class="pun">=</span><span class="pln"> min1</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">this</span><span class="pun">-&gt;</span><span class="pln">f0 </span><span class="pun">=</span><span class="pln"> f0</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">this</span><span class="pun">-&gt;</span><span class="pln">f1 </span><span class="pun">=</span><span class="pln"> f1</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">this</span><span class="pun">-&gt;</span><span class="pln">l0 </span><span class="pun">=</span><span class="pln"> l0</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">this</span><span class="pun">-&gt;</span><span class="pln">l1 </span><span class="pun">=</span><span class="pln"> l1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> node</span><span class="pun">;</span><span class="pln">

    node merge</span><span class="pun">(</span><span class="pln">node</span><span class="pun">&amp;</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> node</span><span class="pun">&amp;</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        node p</span><span class="pun">;</span><span class="pln">
        p</span><span class="pun">.</span><span class="pln">cnt0 </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">.</span><span class="pln">cnt0 </span><span class="pun">+</span><span class="pln"> r</span><span class="pun">.</span><span class="pln">cnt0</span><span class="pun">;</span><span class="pln">
        p</span><span class="pun">.</span><span class="pln">cnt1 </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">.</span><span class="pln">cnt1 </span><span class="pun">+</span><span class="pln"> r</span><span class="pun">.</span><span class="pln">cnt1</span><span class="pun">;</span><span class="pln">
        p</span><span class="pun">.</span><span class="pln">f0 </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">.</span><span class="pln">f0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">.</span><span class="pln">f0 </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">f0 </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">.</span><span class="pln">f0</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        p</span><span class="pun">.</span><span class="pln">l0 </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">.</span><span class="pln">l0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">.</span><span class="pln">l0 </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">l0 </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">.</span><span class="pln">l0</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        p</span><span class="pun">.</span><span class="pln">f1 </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">.</span><span class="pln">f1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">.</span><span class="pln">f1 </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">f1 </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">.</span><span class="pln">f1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        p</span><span class="pun">.</span><span class="pln">l1 </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">.</span><span class="pln">l1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">.</span><span class="pln">l1 </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">l1 </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">.</span><span class="pln">l1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        p</span><span class="pun">.</span><span class="pln">min0 </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">l</span><span class="pun">.</span><span class="pln">min0</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">.</span><span class="pln">min0</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">.</span><span class="pln">f0 </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> l</span><span class="pun">.</span><span class="pln">l0 </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">min0 </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">p</span><span class="pun">.</span><span class="pln">min0</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">.</span><span class="pln">f0 </span><span class="pun">-</span><span class="pln"> l</span><span class="pun">.</span><span class="pln">l0</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        p</span><span class="pun">.</span><span class="pln">min1 </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">l</span><span class="pun">.</span><span class="pln">min1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">.</span><span class="pln">min1</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">.</span><span class="pln">f1 </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> l</span><span class="pun">.</span><span class="pln">l1 </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">min1 </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">p</span><span class="pun">.</span><span class="pln">min1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">.</span><span class="pln">f1 </span><span class="pun">-</span><span class="pln"> l</span><span class="pun">.</span><span class="pln">l1</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> p</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    vector</span><span class="str">&lt;node&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="typ">Segtree</span><span class="pun">(</span><span class="pln">ll n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        t</span><span class="pun">.</span><span class="pln">assign</span><span class="pun">(</span><span class="lit">4</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> node</span><span class="pun">());</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">,</span><span class="pln"> ll l</span><span class="pun">,</span><span class="pln"> ll r</span><span class="pun">,</span><span class="pln"> vll</span><span class="pun">&amp;</span><span class="pln"> a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">==</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> node</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> node</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        ll mid </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        build</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> mid</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">);</span><span class="pln">
        build</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">);</span><span class="pln">
        t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> merge</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    node query</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">,</span><span class="pln"> ll l</span><span class="pun">,</span><span class="pln"> ll r</span><span class="pun">,</span><span class="pln"> ll lq</span><span class="pun">,</span><span class="pln"> ll rq</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&gt;</span><span class="pln"> rq </span><span class="pun">||</span><span class="pln"> r </span><span class="pun">&lt;</span><span class="pln"> lq</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> node</span><span class="pun">();</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lq </span><span class="pun">&lt;=</span><span class="pln"> l </span><span class="pun">&amp;&amp;</span><span class="pln"> r </span><span class="pun">&lt;=</span><span class="pln"> rq</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        ll mid </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        node left </span><span class="pun">=</span><span class="pln"> query</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> mid</span><span class="pun">,</span><span class="pln"> lq</span><span class="pun">,</span><span class="pln"> rq</span><span class="pun">);</span><span class="pln">
        node right </span><span class="pun">=</span><span class="pln"> query</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> lq</span><span class="pun">,</span><span class="pln"> rq</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> merge</span><span class="pun">(</span><span class="pln">left</span><span class="pun">,</span><span class="pln"> right</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">void</span><span class="pln"> update</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">,</span><span class="pln"> ll l</span><span class="pun">,</span><span class="pln"> ll r</span><span class="pun">,</span><span class="pln"> ll x</span><span class="pun">,</span><span class="pln"> ll val</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&gt;</span><span class="pln"> x </span><span class="pun">||</span><span class="pln"> r </span><span class="pun">&lt;</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">==</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">val </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> node</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> node</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        ll mid </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        update</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> mid</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> val</span><span class="pun">);</span><span class="pln">
        update</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> val</span><span class="pun">);</span><span class="pln">
        t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> merge</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Solve</span><span class="pun">(</span><span class="pln">ll t10</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ll n</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    vll a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    fr</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="typ">Segtree</span><span class="pln"> t</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    t</span><span class="pun">.</span><span class="pln">build</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">q</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        ll type</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> type</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">type </span><span class="pun">==</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            ll i</span><span class="pun">;</span><span class="pln">
            cin </span><span class="pun">&gt;&gt;</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
            i</span><span class="pun">--;</span><span class="pln">
            a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            t</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            ll l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
            cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
            l</span><span class="pun">--;</span><span class="pln">r</span><span class="pun">--;</span><span class="pln">
            </span><span class="kwd">auto</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">.</span><span class="pln">query</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">.</span><span class="pln">cnt0 </span><span class="pun">%</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">cnt1 </span><span class="pun">%</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                ll total </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">cnt1 </span><span class="pun">/</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">cnt0 </span><span class="pun">/</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">
                total</span><span class="pun">--;</span><span class="pln">
                ll ans </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">p</span><span class="pun">.</span><span class="pln">min0</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">min1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> total</span><span class="pun">;</span><span class="pln">
                cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">



</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    fastIO</span><span class="pun">;</span><span class="pln">
    ll t</span><span class="pun">;</span><span class="pln">cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">fr</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> t </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Solve</span><span class="pun">(</span><span class="pln">c</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div><p>Please let me know if there exists an easier solution for this </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314438 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314438 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314438">
                <li>
<div class="comment" commentid="1314449">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314449" commentparentid="1314438">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Badri41" title="Specialist Badri41" class="rated-user user-cyan">Badri41</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 07:25 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314449" commentparentid="1314438">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Badri41" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4028785/avatar/68c6021567f9e08a.jpg">        </a>
        <div><a href="/profile/Badri41" title="Specialist Badri41" class="rated-user user-cyan">Badri41</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 07:25 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314449" href="?#comment-1314449" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314438" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1314449" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314449" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4028785" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314449">
                        <div class="moveup">
                        <div class="ttypography"><p>I think such complicated node structure is not required simple version of fenwick tree works here </p><p>define index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">T</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">i</span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-99"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-100"><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math-italic;">B</span><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.126em;"></span></span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">BIT[i]</script> = 1 if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-92"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">s</span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">i</span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0.333em; margin-right: 0.333em;">==</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">s</span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">i</span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-102">1</span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-108"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main; padding-left: 0.311em;">=<span style="font-family: MathJax_Main;">=</span></span><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">s</span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mn" id="MathJax-Span-118" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">s[i] == s[i - 1]</script> else <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-104"><span class="MJXp-mn" id="MJXp-Span-105">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-121"><span class="mn" id="MathJax-Span-122" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">0</script> Find segment sum and check if its positive for checking alternating in a segment and then we can do point updates by carefully update the value at <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-123"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-124"><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">i</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">i</span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-111">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-126"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-127"><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-130" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">i + 1</script> indices after flipping <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-131"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-132"><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">i</script>. </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314449 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314449 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314449">
                <li>
<div class="comment" commentid="1315027">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1315027" commentparentid="1314449">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/zundamon" title="Expert zundamon" class="rated-user user-blue">zundamon</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/06/2025 01:40 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1315027" commentparentid="1314449">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/zundamon" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/5084776/avatar/889472846615c41f.jpg">        </a>
        <div><a href="/profile/zundamon" title="Expert zundamon" class="rated-user user-blue">zundamon</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/06/2025 01:40 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1315027" href="?#comment-1315027" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314449" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1315027" revisioncount="4" revision="4">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">4</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1315027" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="5084776" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1315027">
                        <div class="moveup">
                        <div class="ttypography"><p>For checking is subarray alternating (with flip bit update), we can use only std::map&lt;int, int&gt;.</p><p>But problem with counting <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-114"><span class="MJXp-mn" id="MJXp-Span-115">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-134"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-135"><span class="mn" id="MathJax-Span-136" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-116"><span class="MJXp-mn" id="MJXp-Span-117">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-137"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-138"><span class="mn" id="MathJax-Span-139" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">1</script> in range — btw it possible to solve with <a href="https://codeforces.com/blog/entry/11080">ordered_set</a>.</p> <div class="spoiler"><b class="spoiler-title">Spoiler</b><div class="spoiler-content" style="display: none;"><p>All array is covered by disjoint alternating segments. For example: 010|0|0|0101|10</p><p>Let maintain this <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-118"><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-122" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-126" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-16">[l_i, r_i]</script> alternating segments in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">p</span><span class="MJXp-mo" id="MJXp-Span-132" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-135" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-137" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-140" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-17">map[l_i] = r_i</script>. So we can answering is subarray contained in some alternating segments in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-141"><span class="MJXp-mi" id="MJXp-Span-142">log</span></span></span><script type="math/tex" id="MathJax-Element-18">\log</script>. </p><p>Flipping the bit affect only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-143"><span class="MJXp-mn" id="MJXp-Span-144">3</span></span></span><script type="math/tex" id="MathJax-Element-19">3</script> segments (in situation ..01|1|10..), so updating cost <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-mn" id="MJXp-Span-146">3</span><span class="MJXp-mo" id="MJXp-Span-147" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-148">log</span></span></span><script type="math/tex" id="MathJax-Element-20">3 \cdot \log</script> at worst case. (but it so painful to accurate realisation)</p> <hr><p>To deal with remain part, we essentially need to provide <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">x</span><span class="MJXp-mtext" id="MJXp-Span-154">_</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">m</span></span></span><script type="math/tex" id="MathJax-Element-21">prfx\text{_}sum</script> with just <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-158"><span class="MJXp-mtext" id="MJXp-Span-159">a</span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">i</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-164">a</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">i</span><span class="MJXp-mo" id="MJXp-Span-167" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0.267em; margin-right: 0.267em;">±</span><span class="MJXp-mn" id="MJXp-Span-169">1</span></span></span><script type="math/tex" id="MathJax-Element-22">\text{a}[i] = \text{a}[i] \pm 1</script> updates. (pls, I don't want to learn cheater data structure like BIT or segment tree ＞﹏＜)</p><p>Let create <em>ordered_multiset</em> plus_pos and minus_pos: for evry <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-mtext" id="MJXp-Span-171">a</span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">i</span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-176">a</span><span class="MJXp-mo" id="MJXp-Span-177" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">i</span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-181">1</span></span></span><script type="math/tex" id="MathJax-Element-23">\text{a}[i] = \text{a}[i] + 1</script> operation we insert <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">i</span></span></span><script type="math/tex" id="MathJax-Element-24">i</script> in plus_pos and similarly with minus_pos. (!!! bad O(Q) space).</p><p>Thank to <code class="tt">order_of_key(i)</code> (which return the number of items that are strictly smaller than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">i</span></span></span><script type="math/tex" id="MathJax-Element-25">i</script>), we can corrective: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">x</span><span class="MJXp-mtext" id="MJXp-Span-191">_</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">m</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">i</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">x</span><span class="MJXp-mtext" id="MJXp-Span-203">_</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">u</span><span class="MJXp-msubsup" id="MJXp-Span-206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-208" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">i</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-213">plus_pos.order_of_key</span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">i</span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-218">minus_pos.order_of_key</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">i</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-26">prfx\text{_}sum[i] = prfx\text{_}sum_0[i] + \text{plus_pos.order_of_key}(i) - \text{minus_pos.order_of_key}(i)</script>.</p><p>But structure of this task provides that plus_pos.count(i) at most 1, so ordered_set enough. (,,,finaly)</p> <hr><p>To check, before each [L, R] query I twice flipping a[L]: <a href="/contest/2152/submission/342144368" title="Submission 342144368 by zundamon">342144368</a></p> <div class="spoiler"><b class="spoiler-title">code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ext/pb_ds/assoc_container.hpp&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> __gnu_pbds</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">class</span><span class="pln"> ordered_set </span><span class="pun">:</span><span class="pln"> </span><span class="kwd">public</span><span class="pln"> tree</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">,</span><span class="pln"> null_type</span><span class="pun">,</span><span class="pln"> less</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;,</span><span class="pln"> rb_tree_tag</span><span class="pun">,</span><span class="pln"> tree_order_statistics_node_update</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="kwd">public</span><span class="pun">:</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> count</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> T</span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">-&gt;</span><span class="pln">find</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">-&gt;</span><span class="kwd">end</span><span class="pun">();</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

ordered_set</span><span class="str">&lt;int&gt;</span><span class="pln"> add_updates</span><span class="pun">,</span><span class="pln"> del_updates</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">struct</span><span class="pln"> PRFX0 </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> prfx0</span><span class="pun">;</span><span class="pln">

    PRFX0</span><span class="pun">(</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> aa</span><span class="pun">)</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> n</span><span class="pun">(</span><span class="pln">aa</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()),</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">aa</span><span class="pun">),</span><span class="pln"> prfx0</span><span class="pun">(</span><span class="pln">aa</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()+</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        add_updates</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
        del_updates</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> prfx0</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> prfx0</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> prfx0</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> add_updates</span><span class="pun">.</span><span class="pln">order_of_key</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> del_updates</span><span class="pun">.</span><span class="pln">order_of_key</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">void</span><span class="pln"> upd</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
             </span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> add_updates</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> add_updates</span><span class="pun">.</span><span class="pln">erase</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> del_updates</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> del_updates</span><span class="pun">.</span><span class="pln">erase</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> add_updates </span><span class="pun">:</span><span class="pln"> del_updates </span><span class="pun">).</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">

    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pun">&amp;</span><span class="pln"> e </span><span class="pun">:</span><span class="pln"> a</span><span class="pun">)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> e</span><span class="pun">;</span><span class="pln">

    PRFX0 counter0</span><span class="pun">(</span><span class="pln">a</span><span class="pun">);</span><span class="pln">

    </span><span class="com">// maintain "alternating segments" [l_i, r_i]  (like 1010... or 0101...)</span><span class="pln">
    map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> dead</span><span class="pun">;</span><span class="pln">  </span><span class="com">// &lt;key=l_i, value=r_i&gt;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">;</span><span class="pln">  i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">  i </span><span class="pun">=</span><span class="pln"> j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">bool</span><span class="pln"> which </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">

        </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">j </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">  j </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> which</span><span class="pun">;</span><span class="pln">  j</span><span class="pun">++)</span><span class="pln">
            which </span><span class="pun">=</span><span class="pln"> </span><span class="pun">!</span><span class="pln">which</span><span class="pun">;</span><span class="pln">

        dead</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> j</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln"> q</span><span class="pun">--</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> type </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">;</span><span class="pln"> 
        </span><span class="com">// cin &gt;&gt; type;  // UNCOMMENT for "Point Update" version</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l</span><span class="pun">;</span><span class="pln">
        l</span><span class="pun">--;</span><span class="pln">

        </span><span class="kwd">auto</span><span class="pln"> pcurr </span><span class="pun">=</span><span class="pln"> dead</span><span class="pun">.</span><span class="pln">upper_bound</span><span class="pun">(</span><span class="pln">l</span><span class="pun">);</span><span class="pln"> pcurr</span><span class="pun">--;</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">A</span><span class="pun">,</span><span class="pln"> B</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*</span><span class="pln">pcurr</span><span class="pun">;</span><span class="pln">

        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> type </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// Find minimum cost for the array [al,...,ar] </span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> r</span><span class="pun">--;</span><span class="pln">

            </span><span class="kwd">int</span><span class="pln"> cnt0 </span><span class="pun">=</span><span class="pln"> counter0</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">r</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> counter0</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">l</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> cnt1 </span><span class="pun">=</span><span class="pln">   </span><span class="pun">(</span><span class="pln">r</span><span class="pun">-</span><span class="pln">l</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">  </span><span class="pun">-</span><span class="pln"> cnt0</span><span class="pun">;</span><span class="pln">

            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> cnt0</span><span class="pun">%</span><span class="lit">3</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> cnt1</span><span class="pun">%</span><span class="lit">3</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"-1\n"</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
            
            </span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> cnt0</span><span class="pun">/</span><span class="lit">3</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> cnt1</span><span class="pun">/</span><span class="lit">3</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> r </span><span class="pun">&lt;=</span><span class="pln"> B </span><span class="pun">)</span><span class="pln"> ans</span><span class="pun">++;</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">


        </span><span class="com">// Flip the bit at index i</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> indx </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">;</span><span class="pln">
        counter0</span><span class="pun">.</span><span class="pln">upd</span><span class="pun">(</span><span class="pln">indx</span><span class="pun">);</span><span class="pln">

        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> A </span><span class="pun">&lt;</span><span class="pln"> indx </span><span class="pun">&amp;&amp;</span><span class="pln"> indx </span><span class="pun">&lt;</span><span class="pln"> B </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            dead</span><span class="pun">[</span><span class="pln">A</span><span class="pun">]</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> indx</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            dead</span><span class="pun">[</span><span class="pln">indx</span><span class="pun">]</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> indx</span><span class="pun">;</span><span class="pln">
            dead</span><span class="pun">[</span><span class="pln">indx</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> B</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        
        </span><span class="kwd">int</span><span class="pln"> updA </span><span class="pun">=</span><span class="pln"> A</span><span class="pun">,</span><span class="pln"> updB </span><span class="pun">=</span><span class="pln"> B</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> indx </span><span class="pun">==</span><span class="pln"> A </span><span class="pun">&amp;&amp;</span><span class="pln"> pcurr </span><span class="pun">!=</span><span class="pln"> dead</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">()</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            pcurr </span><span class="pun">=</span><span class="pln"> </span><span class="pun">--</span><span class="pln">dead</span><span class="pun">.</span><span class="pln">erase</span><span class="pun">(</span><span class="pln">pcurr</span><span class="pun">);</span><span class="pln">  </span><span class="com">// erase - return Iterator following the last removed element.</span><span class="pln">
            updA </span><span class="pun">=</span><span class="pln"> pcurr </span><span class="pun">-&gt;</span><span class="pln"> first</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">

        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> indx </span><span class="pun">==</span><span class="pln"> B </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">(++</span><span class="pln">pcurr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> dead</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            updB </span><span class="pun">=</span><span class="pln"> pcurr </span><span class="pun">-&gt;</span><span class="pln"> second</span><span class="pun">;</span><span class="pln">
            dead</span><span class="pun">.</span><span class="pln">erase</span><span class="pun">(</span><span class="pln">pcurr</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">

        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> A </span><span class="pun">==</span><span class="pln"> indx </span><span class="pun">&amp;&amp;</span><span class="pln"> indx </span><span class="pun">==</span><span class="pln"> B </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            dead</span><span class="pun">[</span><span class="pln">updA</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> updB</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> indx </span><span class="pun">==</span><span class="pln"> A </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            dead</span><span class="pun">[</span><span class="pln">updA</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> A</span><span class="pun">;</span><span class="pln">
            dead</span><span class="pun">[</span><span class="pln">A</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> B</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// indx == B</span><span class="pln">
            dead</span><span class="pun">[</span><span class="pln">A</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> B</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            dead</span><span class="pun">[</span><span class="pln">B</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> updB</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"> cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln"> t</span><span class="pun">--</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">useless info</b><div class="spoiler-content" style="display: none;"><p>... I spent on this 5+ hours ((((</p></div></div></div></div></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1315027 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1315027 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1315027">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314473">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314473" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/subtomyonlycodes" title="Newbie subtomyonlycodes" class="rated-user user-gray">subtomyonlycodes</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 09:27 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314473" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/subtomyonlycodes" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4587610/avatar/d1fba64af2eb7182.jpg">        </a>
        <div><a href="/profile/subtomyonlycodes" title="Newbie subtomyonlycodes" class="rated-user user-gray">subtomyonlycodes</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 09:27 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314473" href="?#comment-1314473" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314473" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4587610" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314473">
                        <div class="moveup">
                        <div class="ttypography"><p>I hate that i dont get problem D. how do people even solve it?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314473 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314473 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314473">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314482">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314482" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/IUA_Hasin" title="Specialist IUA_Hasin" class="rated-user user-cyan">IUA_Hasin</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 10:04 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314482" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/IUA_Hasin" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2909913/avatar/a7f7d517812e1b31.jpg">        </a>
        <div><a href="/profile/IUA_Hasin" title="Specialist IUA_Hasin" class="rated-user user-cyan">IUA_Hasin</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 10:04 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314482" href="?#comment-1314482" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314482" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-13" data-commentuserid="2909913" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-13</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314482">
                        <div class="moveup">
                        <div class="ttypography"><p>Problems like B shouldn't be given in a contest.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314482 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314482 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314482">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314485">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314485" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/ywjylx" title="Master ywjylx" class="rated-user user-orange">ywjylx</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 10:16 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314485" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/ywjylx" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/226622/avatar/15a1fbdef70547f5.jpg">        </a>
        <div><a href="/profile/ywjylx" title="Master ywjylx" class="rated-user user-orange">ywjylx</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 10:16 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314485" href="?#comment-1314485" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314485" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="226622" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314485">
                        <div class="moveup">
                        <div class="ttypography"><p>The scores of H1 and H2 should be swapped.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314485 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314485 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314485">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314592">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314592" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Celebrate" title="International Master Celebrate" class="rated-user user-orange">Celebrate</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 14:30 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314592" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Celebrate" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1354590/avatar/4873dc26ac28928a.jpg">        </a>
        <div><a href="/profile/Celebrate" title="International Master Celebrate" class="rated-user user-orange">Celebrate</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 14:30 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314592" href="?#comment-1314592" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314592" class="CommentVoteFrame" myvotedirection="0" data-commentrating="8" data-commentuserid="1354590" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314592">
                        <div class="moveup">
                        <div class="ttypography"><p>Naturally come up with a link-cut-tree solution for G. </p><p><a href="https://codeforces.com/contest/2152/submission/341864664">code</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314592 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314592 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314592">
        </ul>
    </div>
</div>

<div class="comment" commentid="1314658">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314658" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/DSG213" title="Master DSG213" class="rated-user user-orange">DSG213</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 18:30 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314658" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/DSG213" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/DSG213" title="Master DSG213" class="rated-user user-orange">DSG213</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/04/2025 18:30 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314658" href="?#comment-1314658" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314658" class="CommentVoteFrame" myvotedirection="0" data-commentrating="16" data-commentuserid="787041" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+16</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314658">
                        <div class="moveup">
                        <div class="ttypography"><p>There is in alternative solution for F.</p><p>I used a similar method to the one listed in the tutorial using jump pointers but with a different transition states. Each state is a pair <code class="tt">(a,b)</code> where <code class="tt">b</code> is the current most right index, and <code class="tt">a</code> is the previous index. There is a special case with <code class="tt">a==-1</code>, which means that we are free to find the next index. <code class="tt">(a,b)</code> transitions to <code class="tt">(b,c)</code> where <code class="tt">c</code> is the first element with <code class="tt">x[a] + z &lt; x[c]</code>. This can be found using binary search. We start by computing all transitions for <code class="tt">(-1,i)</code>, and transitions from states that follow. I don't have a proof for it but we should visit O(n) states in total. The we do jump pointers and for each query move from <code class="tt">(-1,l)</code></p><p>Example solution <a href="https://codeforces.com/contest/2152/submission/341761304">https://codeforces.com/contest/2152/submission/341761304</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314658 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314658 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314658">
                <li>
<div class="comment" commentid="1315155">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1315155" commentparentid="1314658">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/polosatic" title="Master polosatic" class="rated-user user-orange">polosatic</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/06/2025 11:20 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1315155" commentparentid="1314658">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/polosatic" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1221024/avatar/54ada60fd1062fd6.jpg">        </a>
        <div><a href="/profile/polosatic" title="Master polosatic" class="rated-user user-orange">polosatic</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/06/2025 11:20 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1315155" href="?#comment-1315155" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1314658" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1315155" class="CommentVoteFrame" myvotedirection="0" data-commentrating="6" data-commentuserid="1221024" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1315155">
                        <div class="moveup">
                        <div class="ttypography"><p>Bro, you're not alone! I also came up with a very similar idea. Here's the formal proof for its complexity and an argument for why this approach is arguably more elegant than the editorial's.</p><p>My implementation is slightly different: I start from pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-222"><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">i</span><span class="MJXp-mo" id="MJXp-Span-225" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">i</span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-228">1</span><span class="MJXp-mo" id="MJXp-Span-229" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-255"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-256"><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-258" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-259" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">i</span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-262" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">(i, i+1)</script> (using 0-based indexing) and a sequence terminates when it generates an invalid pair like <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">i</span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">n</span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-264"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-265"><span class="mo" id="MathJax-Span-266" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">(i, n)</script>. You can see my submission here: <a href="/contest/2152/submission/342191794" title="Submission 342191794 by polosatic">342191794</a></p><p><strong>The proof of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">O</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">n</span><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-271"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-272"><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-274" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-275" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">O(n)</script> states</strong></p><p>The key claim is that the total number of unique pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-241"><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">i</span><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">j</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-277"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-278"><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">j</span><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">(i, j)</script> generated is bounded by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-247"><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mn" id="MJXp-Span-249">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-284"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-285"><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main;">∼</span><span class="mn" id="MathJax-Span-287" style="font-family: MathJax_Main; padding-left: 0.311em;">4</span><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">\sim 4n</script>. My solution gets RE with a buffer of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-251"><span class="MJXp-mn" id="MJXp-Span-252">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">N</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-289"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-290"><span class="mn" id="MathJax-Span-291" style="font-family: MathJax_Main;">3</span><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">3N</script> for the states, but gets AC with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-mn" id="MJXp-Span-255">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">N</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-293"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-294"><span class="mn" id="MathJax-Span-295" style="font-family: MathJax_Main;">4</span><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">4N</script>. Let's formalize the model. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">f</span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">i</span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-297"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-298"><span class="mi" id="MathJax-Span-299" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">f(i)</script> be the function from the editorial: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">f</span><span class="MJXp-mo" id="MJXp-Span-271" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">i</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mrow" id="MJXp-Span-276"><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">j</span><span class="MJXp-mrow" id="MJXp-Span-279"><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">j</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">i</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">x</span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">j</span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">x</span><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">i</span><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">z</span></span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-303"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-304"><span class="mi" id="MathJax-Span-305" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-309" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mo" id="MathJax-Span-310" style="font-family: MathJax_Main; padding-left: 0.311em;">min</span><span class="texatom" id="MathJax-Span-311" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-312"><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-italic;">j</span><span class="texatom" id="MathJax-Span-315"><span class="mrow" id="MathJax-Span-316"><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main; padding-left: 0.311em;">&gt;</span><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">i</span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-322" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">x</span><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-325" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-326" style="font-family: MathJax_Main; padding-left: 0.311em;">&gt;</span><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">x</span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-330" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-332" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">f(i) = \min {(j | j > i, x[j] > x[i] + z})</script>. Our state transition function is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">g</span><span class="MJXp-mo" id="MJXp-Span-299" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">i</span><span class="MJXp-mo" id="MJXp-Span-302" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">j</span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">j</span><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">x</span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">j</span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-316">1</span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">f</span><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">i</span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-334"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">j</span><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main; padding-left: 0.311em;">(</span><span class="mi" id="MathJax-Span-346" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">m</span><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-353" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-354" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-359" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-360" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">g((i, j)) = (j, max(j + 1, f(i)))</script>. The entire solution explores a functional graph where states are pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-324"><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">i</span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">j</span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-362"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-363"><span class="mo" id="MathJax-Span-364" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">j</span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">(i, j)</script> and edges are defined by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-369"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">g</script>. To prove the linear bound, we can split the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-372"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-373"><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">x</script> into blocks, where a block ends at index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">k</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-375"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-376"><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">k</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">x</span><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">k</span><span class="MJXp-mo" id="MJXp-Span-340" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-341">1</span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">x</span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">k</span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-379"><span class="mi" id="MathJax-Span-380" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-381" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-382" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-383" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-384" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-385" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-386" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">x</span><span class="mo" id="MathJax-Span-388" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-389" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-390" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-391" style="font-family: MathJax_Main; padding-left: 0.311em;">&gt;</span><span class="mi" id="MathJax-Span-392" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">x[k+1] - x[k] > z</script>.</p><p><strong>Counting "boundary crossing" pairs (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-350"><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mn" id="MJXp-Span-352">1</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-393"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-394"><span class="mo" id="MathJax-Span-395" style="font-family: MathJax_Main;">∼</span><span class="mn" id="MathJax-Span-396" style="font-family: MathJax_Main; padding-left: 0.311em;">1</span><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">\sim 1n</script> states)</strong></p><p>When a transition crosses from block <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-354"><span class="MJXp-msubsup" id="MJXp-Span-355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-357" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-398"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-399"><span class="msubsup" id="MathJax-Span-400"><span style="display: inline-block; position: relative; width: 1.234em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">B_k</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-358"><span class="MJXp-msubsup" id="MJXp-Span-359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-361" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">k</span><span class="MJXp-mo" id="MJXp-Span-363">+</span><span class="MJXp-mn" id="MJXp-Span-364">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-403"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-404"><span class="msubsup" id="MathJax-Span-405"><span style="display: inline-block; position: relative; width: 2.095em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-407"><span class="mrow" id="MathJax-Span-408"><span class="mi" id="MathJax-Span-409" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-410" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-411" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">B_{k+1}</script>, the new pair is always <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-365"><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">L</span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">R</span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-45-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-412"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-413"><span class="mo" id="MathJax-Span-414" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-416" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">R</span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">(L, R)</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">R</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-46-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-419"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-420"><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math-italic;">R</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">R</script> is the first element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-373"><span class="MJXp-msubsup" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-376" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">k</span><span class="MJXp-mo" id="MJXp-Span-378">+</span><span class="MJXp-mn" id="MJXp-Span-379">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-47-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-422"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-423"><span class="msubsup" id="MathJax-Span-424"><span style="display: inline-block; position: relative; width: 2.095em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-426"><span class="mrow" id="MathJax-Span-427"><span class="mi" id="MathJax-Span-428" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-429" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-430" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">B_{k+1}</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">L</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-48-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-431"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-432"><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Math-italic;">L</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">L</script> is some element from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-382"><span class="MJXp-msubsup" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-385" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-49-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-434"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-435"><span class="msubsup" id="MathJax-Span-436"><span style="display: inline-block; position: relative; width: 1.234em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-438" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">B_k</script>. The number of such pairs is at most the sum of sizes of all blocks except the last one: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">n</span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-389"><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-393" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">t</span></span></span><span class="MJXp-mrow" id="MJXp-Span-398"><span class="MJXp-mo" id="MJXp-Span-399" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-50-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-439"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="texatom" id="MathJax-Span-443" style="padding-left: 0.249em;"><span class="mrow" id="MathJax-Span-444"><span class="mo" id="MathJax-Span-445" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-446"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-448"><span class="mrow" id="MathJax-Span-449"><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-451" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-452" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-453" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="texatom" id="MathJax-Span-454"><span class="mrow" id="MathJax-Span-455"><span class="mo" id="MathJax-Span-456" style="font-family: MathJax_Main;">|</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">n - |B_{last}|</script>. Also I use invalid <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-400"><span class="MJXp-mo" id="MJXp-Span-401" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">i</span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">n</span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-51-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-457"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-458"><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-462" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-463" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">(i, n)</script> pairs in my implementation. Note that the index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-52-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-464"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-465"><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">i</script> here must be taken from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-msubsup" id="MJXp-Span-409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-411" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">t</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-53-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-467"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-468"><span class="msubsup" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-470" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-471"><span class="mrow" id="MathJax-Span-472"><span class="mi" id="MathJax-Span-473" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-474" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-475" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-476" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">B_{last}</script>. The number of these pairs is at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-416"><span class="MJXp-mrow" id="MJXp-Span-417"><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-421" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">t</span></span></span><span class="MJXp-mrow" id="MJXp-Span-426"><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-54-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-477"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-478"><span class="texatom" id="MathJax-Span-479"><span class="mrow" id="MathJax-Span-480"><span class="mo" id="MathJax-Span-481" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-482"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-483" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-484"><span class="mrow" id="MathJax-Span-485"><span class="mi" id="MathJax-Span-486" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-487" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-488" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-489" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="texatom" id="MathJax-Span-490"><span class="mrow" id="MathJax-Span-491"><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Main;">|</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">|B_{last}|</script>. Summing these two gives <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-428"><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">n</span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-432"><span class="MJXp-mo" id="MJXp-Span-433" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-436" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">t</span></span></span><span class="MJXp-mrow" id="MJXp-Span-441"><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-444" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-445"><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-449" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">t</span></span></span><span class="MJXp-mrow" id="MJXp-Span-454"><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-55-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-493"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-494"><span class="mo" id="MathJax-Span-495" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-496" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-497" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="texatom" id="MathJax-Span-498" style="padding-left: 0.249em;"><span class="mrow" id="MathJax-Span-499"><span class="mo" id="MathJax-Span-500" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-501"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-502" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-503"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-506" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-507" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-508" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="texatom" id="MathJax-Span-509"><span class="mrow" id="MathJax-Span-510"><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-512" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="texatom" id="MathJax-Span-514" style="padding-left: 0.249em;"><span class="mrow" id="MathJax-Span-515"><span class="mo" id="MathJax-Span-516" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-517"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-519"><span class="mrow" id="MathJax-Span-520"><span class="mi" id="MathJax-Span-521" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-522" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-524" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="texatom" id="MathJax-Span-525"><span class="mrow" id="MathJax-Span-526"><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">(n - |B_{last}|) + |B_{last}| = n</script>. So, all "boundary crossing" transitions generate at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-56-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-530"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-531"><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-56">n</script> unique states in total.</p><p><strong>Counting "in-block" pairs (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-460"><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mn" id="MJXp-Span-462">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-57-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-533"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-534"><span class="mo" id="MathJax-Span-535" style="font-family: MathJax_Main;">∼</span><span class="mn" id="MathJax-Span-536" style="font-family: MathJax_Main; padding-left: 0.311em;">3</span><span class="mi" id="MathJax-Span-537" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">\sim 3n</script> states)</strong></p><p>Consider the chain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-464"><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">i</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">i</span><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-470">1</span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">i</span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-476">1</span><span class="MJXp-mo" id="MJXp-Span-477" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">f</span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">i</span><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">f</span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">i</span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">f</span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">i</span><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-494">1</span><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-58-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-538"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-539"><span class="mo" id="MathJax-Span-540" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-542" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-543" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">i</span><span class="mo" id="MathJax-Span-544" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-545" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-546" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Main; padding-left: 0.311em;">→</span><span class="mo" id="MathJax-Span-548" style="font-family: MathJax_Main; padding-left: 0.311em;">(</span><span class="mi" id="MathJax-Span-549" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-550" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-551" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-552" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-553" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-554" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-555" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-556" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-558" style="font-family: MathJax_Main; padding-left: 0.311em;">→</span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main; padding-left: 0.311em;">(</span><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-561" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-562" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-563" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-567" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-568" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-569" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-570" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-571" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-572" style="font-family: MathJax_Main; padding-left: 0.188em;">…</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">(i, i+1) \to (i+1, f(i)) \to (f(i), f(i+1)) \dots</script> Note that the chain is correct because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">f</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">i</span><span class="MJXp-mo" id="MJXp-Span-502" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">i</span><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-506">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-59-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-573"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-574"><span class="mi" id="MathJax-Span-575" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-576" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-578" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Main; padding-left: 0.311em;">&gt;</span><span class="mi" id="MathJax-Span-580" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">i</span><span class="mo" id="MathJax-Span-581" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-582" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-59">f(i) > i + 1</script>, because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-507"><span class="MJXp-msubsup" id="MJXp-Span-508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-510" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">f</span><span class="MJXp-mo" id="MJXp-Span-512">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">i</span><span class="MJXp-mo" id="MJXp-Span-514">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-518" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-60-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-583"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-584"><span class="msubsup" id="MathJax-Span-585"><span style="display: inline-block; position: relative; width: 1.849em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.812em; left: 0.557em;"><span class="texatom" id="MathJax-Span-587"><span class="mrow" id="MathJax-Span-588"><span class="mi" id="MathJax-Span-589" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-590" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-591" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-592" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-593" style="font-family: MathJax_Main; padding-left: 0.311em;">&gt;</span><span class="msubsup" id="MathJax-Span-594" style="padding-left: 0.311em;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-596" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-598" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-60">x_{f(i)} > x_i + z</script> by definition, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-521"><span class="MJXp-msubsup" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-524" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">i</span><span class="MJXp-mo" id="MJXp-Span-526">+</span><span class="MJXp-mn" id="MJXp-Span-527">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-531" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-61-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-599"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-600"><span class="msubsup" id="MathJax-Span-601"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="texatom" id="MathJax-Span-603"><span class="mrow" id="MathJax-Span-604"><span class="mi" id="MathJax-Span-605" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-606" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-607" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main; padding-left: 0.311em;">≤</span><span class="msubsup" id="MathJax-Span-609" style="padding-left: 0.311em;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-611" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-612" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-613" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">x_{i+1} \le x_i + z</script> because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-62-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-614"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-615"><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">i</script> &amp; <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">i</span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-539">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-63-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-617"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-618"><span class="mi" id="MathJax-Span-619" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-620" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-621" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-63">i + 1</script> are in the same block, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-64-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-622"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-623"><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-64">x</script> is monotonous.</p><p>Let's now split all the pairs into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-542"><span class="MJXp-mn" id="MJXp-Span-543">3</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-65-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-625"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-626"><span class="mn" id="MathJax-Span-627" style="font-family: MathJax_Main;">3</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">3</script> groups and count them.</p><p><strong>Type 1:</strong> Base pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-544"><span class="MJXp-mo" id="MJXp-Span-545" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">k</span><span class="MJXp-mo" id="MJXp-Span-547" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">k</span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-550">1</span><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-66-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-629"><span class="mo" id="MathJax-Span-630" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-631" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-632" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">k</span><span class="mo" id="MathJax-Span-634" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-635" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-636" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">(k, k+1)</script>. There are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">n</span><span class="MJXp-mo" id="MJXp-Span-554" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-555">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-67-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-637"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-638"><span class="mi" id="MathJax-Span-639" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-640" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mn" id="MathJax-Span-641" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-67">n-1</script> of them.</p><p><strong>Type 2:</strong> First-jump pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-556"><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">k</span><span class="MJXp-mo" id="MJXp-Span-559" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-560">1</span><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">f</span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">k</span><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-68-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-642"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-643"><span class="mo" id="MathJax-Span-644" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-645" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-646" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-647" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-648" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-649" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-650" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-651" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-652" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-653" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-68">(k+1, f(k))</script>. Each base pair generates one of these. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-567"><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-69-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-654"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-655"><span class="mo" id="MathJax-Span-656" style="font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-657" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-69">\sim n</script> states.</p><p><strong>Type 3:</strong> Synchronized-jump pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-570"><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">f</span><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">k</span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">f</span><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">k</span><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-581">1</span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-583" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-70-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-658"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-659"><span class="mo" id="MathJax-Span-660" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-661" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-662" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-663" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-664" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-665" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-666" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-667" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-668" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-669" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-670" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-671" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-672" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-70">(f(k), f(k+1))</script>. Their number is also <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-584"><span class="MJXp-mo" id="MJXp-Span-585" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-71-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-673"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-674"><span class="mo" id="MathJax-Span-675" style="font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-676" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-71">\sim n</script>, because we have them for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">k</span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-590">1</span><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">n</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-594">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-72-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-677"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-678"><span class="mi" id="MathJax-Span-679" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-680" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-681" style="font-family: MathJax_Main; padding-left: 0.311em;">1</span><span class="mo" id="MathJax-Span-682" style="font-family: MathJax_Main; padding-left: 0.188em;">…</span><span class="mi" id="MathJax-Span-683" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-684" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mn" id="MathJax-Span-685" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">k = 1 \dots n-1</script></p><p>Together, these account for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-595"><span class="MJXp-mo" id="MJXp-Span-596" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mn" id="MJXp-Span-597">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-73-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-686"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-687"><span class="mo" id="MathJax-Span-688" style="font-family: MathJax_Main;">∼</span><span class="mn" id="MathJax-Span-689" style="font-family: MathJax_Main; padding-left: 0.311em;">3</span><span class="mi" id="MathJax-Span-690" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-73">\sim 3n</script> states within the blocks.</p><p>Summing up the boundary states (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-599"><span class="MJXp-mo" id="MJXp-Span-600" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mn" id="MJXp-Span-601">1</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-74-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-691"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-692"><span class="mo" id="MathJax-Span-693" style="font-family: MathJax_Main;">∼</span><span class="mn" id="MathJax-Span-694" style="font-family: MathJax_Main; padding-left: 0.311em;">1</span><span class="mi" id="MathJax-Span-695" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">\sim 1n</script>) and in-block states (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-603"><span class="MJXp-mo" id="MJXp-Span-604" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mn" id="MJXp-Span-605">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-75-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-696"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-697"><span class="mo" id="MathJax-Span-698" style="font-family: MathJax_Main;">∼</span><span class="mn" id="MathJax-Span-699" style="font-family: MathJax_Main; padding-left: 0.311em;">3</span><span class="mi" id="MathJax-Span-700" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-75">\sim 3n</script>), we get the total bound of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-607"><span class="MJXp-mn" id="MJXp-Span-608">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-76-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-701"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-702"><span class="mn" id="MathJax-Span-703" style="font-family: MathJax_Main;">4</span><span class="mi" id="MathJax-Span-704" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">4n</script> states.</p><p><strong>Why this approach is more unified than the editorial's</strong></p><p>The editorial's solution feels a bit hacky. Our solution is more elegant because it's unified. There is only one mode of operation: We precompute a single graph of states <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-610"><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">i</span><span class="MJXp-mo" id="MJXp-Span-613" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">j</span><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-77-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-705"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-706"><span class="mo" id="MathJax-Span-707" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-708" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-709" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-710" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">j</span><span class="mo" id="MathJax-Span-711" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-77">(i, j)</script>. The logic of path merging (the LCA part) is implicitly baked into our graph structure — the transition to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-616"><span class="MJXp-mo" id="MJXp-Span-617" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">A</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">A</span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-626">1</span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-78-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-712"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-713"><span class="mo" id="MathJax-Span-714" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-715" style="font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-716" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-717" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-718" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">L</span><span class="mi" id="MathJax-Span-720" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mi" id="MathJax-Span-721" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-722" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-723" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-724" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-78">(LCA, LCA + 1)</script> in author's solution is the transition from one block to another in our solution: Let's see: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-628"><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">i</span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">j</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mspace" id="MJXp-Span-636" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-637" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-638" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-639" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">x</span><span class="MJXp-mspace" id="MJXp-Span-641" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">y</span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-79-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-725"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-726"><span class="mo" id="MathJax-Span-727" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-728" style="font-family: MathJax_Main;">…</span><span class="mi" id="MathJax-Span-729" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">i</span><span class="mo" id="MathJax-Span-730" style="font-family: MathJax_Main; padding-left: 0.188em;">…</span><span class="mi" id="MathJax-Span-731" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">j</span><span class="mo" id="MathJax-Span-732" style="font-family: MathJax_Main; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-733" style="font-family: MathJax_Main;">]</span><span class="mspace" id="MathJax-Span-734" style="height: 0em; vertical-align: 0em; width: 0.311em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-735" style="height: 0em; vertical-align: 0em; width: 0.311em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-736" style="height: 0em; vertical-align: 0em; width: 0.311em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-737" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-738" style="font-family: MathJax_Math-italic;">x</span><span class="mspace" id="MathJax-Span-739" style="height: 0em; vertical-align: 0em; width: 0.311em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-740" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-741" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">[\dots i \dots j \dots] \;\;\; [x \; y]</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-80-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-742"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-743"><span class="mi" id="MathJax-Span-744" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-80">i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">j</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-81-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-745"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-746"><span class="mi" id="MathJax-Span-747" style="font-family: MathJax_Math-italic;">j</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-81">j</script> — some elements of the left block, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-82-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-748"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-749"><span class="mi" id="MathJax-Span-750" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">x</script> &amp; <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-83-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-751"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-752"><span class="mi" id="MathJax-Span-753" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">y</script> — the first 2 elements of the right block (for simplification, we consider only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-652"><span class="MJXp-mrow" id="MJXp-Span-653"><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-655"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-657" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">t</span></span></span><span class="MJXp-mrow" id="MJXp-Span-663"><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-666">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-84-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-754"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-755"><span class="texatom" id="MathJax-Span-756"><span class="mrow" id="MathJax-Span-757"><span class="mo" id="MathJax-Span-758" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-759"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-760" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-761"><span class="mrow" id="MathJax-Span-762"><span class="mi" id="MathJax-Span-763" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-764" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-765" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-766" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-767" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="texatom" id="MathJax-Span-768"><span class="mrow" id="MathJax-Span-769"><span class="mo" id="MathJax-Span-770" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-771" style="font-family: MathJax_Main; padding-left: 0.311em;">≥</span><span class="mn" id="MathJax-Span-772" style="font-family: MathJax_Main; padding-left: 0.311em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-84">|B_{right}| \ge 2</script>). The equation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">f</span><span class="MJXp-mo" id="MJXp-Span-669" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">x</span><span class="MJXp-mo" id="MJXp-Span-671" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-672" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">f</span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">y</span><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-85-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-773"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-774"><span class="mi" id="MathJax-Span-775" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-776" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-778" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-779" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-780" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-781" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-782" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-783" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-85">f(x) = f(y)</script> (going to LCA) is equivalent to the transition <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-677"><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">i</span><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">j</span><span class="MJXp-mo" id="MJXp-Span-682" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-683" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">j</span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">x</span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">x</span><span class="MJXp-mo" id="MJXp-Span-692" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">y</span><span class="MJXp-mo" id="MJXp-Span-694" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-86-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-784"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-785"><span class="mo" id="MathJax-Span-786" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-787" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-788" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-789" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">j</span><span class="mo" id="MathJax-Span-790" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-791" style="font-family: MathJax_Main; padding-left: 0.311em;">→</span><span class="mo" id="MathJax-Span-792" style="font-family: MathJax_Main; padding-left: 0.311em;">(</span><span class="mi" id="MathJax-Span-793" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-794" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-795" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">x</span><span class="mo" id="MathJax-Span-796" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-797" style="font-family: MathJax_Main; padding-left: 0.311em;">→</span><span class="mo" id="MathJax-Span-798" style="font-family: MathJax_Main; padding-left: 0.311em;">(</span><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-800" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-801" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-802" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-86">(i, j) \to (j, x) \to (x, y)</script>.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1315155 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1315155 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1315155">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1314729">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1314729" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/snowysecret" title="International Master snowysecret" class="rated-user user-orange">snowysecret</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/05/2025 07:32 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1314729" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/snowysecret" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1412644/avatar/a6595dafc5b699e2.jpg">        </a>
        <div><a href="/profile/snowysecret" title="International Master snowysecret" class="rated-user user-orange">snowysecret</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/05/2025 07:32 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1314729" href="?#comment-1314729" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1314729" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="1412644" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1314729">
                        <div class="moveup">
                        <div class="ttypography"><p>Check out my <a href="https://m.youtube.com/watch?v=qGUqnZXZVLQ">explanation to problem F</a>!</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1314729 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1314729 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1314729">
        </ul>
    </div>
</div>

<div class="comment" commentid="1315078">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1315078" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/shinchankosen" title="Master shinchankosen" class="rated-user user-orange">shinchankosen</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/06/2025 06:33 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1315078" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/shinchankosen" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/912846/avatar/52f03f7235f9b046.jpg">        </a>
        <div><a href="/profile/shinchankosen" title="Master shinchankosen" class="rated-user user-orange">shinchankosen</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/06/2025 06:33 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1315078" href="?#comment-1315078" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1315078" class="CommentVoteFrame" myvotedirection="0" data-commentrating="10" data-commentuserid="912846" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1315078">
                        <div class="moveup">
                        <div class="ttypography"><p>H1 is able to solved by in O(nq) time using tree DP.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1315078 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1315078 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1315078">
        </ul>
    </div>
</div>

<div class="comment" commentid="1315366">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1315366" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/negative-xp" title="Master negative-xp" class="rated-user user-orange">negative-xp</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/06/2025 23:07 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1315366" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/negative-xp" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4043346/avatar/d2979d356511d0ad.jpg">        </a>
        <div><a href="/profile/negative-xp" title="Master negative-xp" class="rated-user user-orange">negative-xp</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/06/2025 23:07 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1315366" href="?#comment-1315366" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1315366" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4043346" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1315366">
                        <div class="moveup">
                        <div class="ttypography"><p>Alternate sqrt solution for F:</p> <ul>   <li>Define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-695"><span class="MJXp-mtext" id="MJXp-Span-696">nxt</span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">i</span><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-87-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-803"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-804"><span class="mtext" id="MathJax-Span-805" style="font-family: MathJax_Main;">nxt</span><span class="mo" id="MathJax-Span-806" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-807" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-808" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">\text{nxt}(i)</script> to be the smallest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">j</span><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-88-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-809"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-810"><span class="mi" id="MathJax-Span-811" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-812" style="font-family: MathJax_Main; padding-left: 0.311em;">&gt;</span><span class="mi" id="MathJax-Span-813" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-88">j > i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-704"><span class="MJXp-msubsup" id="MJXp-Span-705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-707" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-708" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">z</span><span class="MJXp-mo" id="MJXp-Span-710" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-713" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-89-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-814"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-815"><span class="msubsup" id="MathJax-Span-816"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-817" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-818" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-819" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-820" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-821" style="font-family: MathJax_Main; padding-left: 0.311em;">&lt;</span><span class="msubsup" id="MathJax-Span-822" style="padding-left: 0.311em;"><span style="display: inline-block; position: relative; width: 0.926em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-823" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-824" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-89">a_i + z < a_j</script>.</li>   <li>Notice that greedily building the subsequence from left to right is optimal for every query (ie. start with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">S</span><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">l</span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">l</span><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-722">1</span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-90-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-825"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-826"><span class="mi" id="MathJax-Span-827" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-828" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mo" id="MathJax-Span-829" style="font-family: MathJax_Main; padding-left: 0.311em;">[</span><span class="mi" id="MathJax-Span-830" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">l</span><span class="mo" id="MathJax-Span-833" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-834" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-835" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">S = [l, l + 1]</script>, then at every step, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-91-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-836"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-837"><span class="mi" id="MathJax-Span-838" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-91">x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-92-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-839"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-840"><span class="mi" id="MathJax-Span-841" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-92">y</script> be the second last/last elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">S</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-93-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-842"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-843"><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">S</script>, and we add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-730"><span class="MJXp-mo" id="MJXp-Span-731" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-732" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-733">nxt</span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">x</span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">y</span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-740">1</span><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-94-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-845"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-846"><span class="mo" id="MathJax-Span-847" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-848" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-849" style="font-family: MathJax_Main;">nxt</span><span class="mo" id="MathJax-Span-850" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-852" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-853" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-854" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-855" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-856" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-857" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-94">\max(\text{nxt}(x), y + 1)</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">S</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-95-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-858"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-859"><span class="mi" id="MathJax-Span-860" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-95">S</script>. We do this until the index to be added remains <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-744"><span class="MJXp-mo" id="MJXp-Span-745" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">r</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-96-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-861"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-862"><span class="mo" id="MathJax-Span-863" style="font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-864" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">r</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">\leq r</script>).</li>   <li>Divide the array into blocks of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">B</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-97-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-865"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-866"><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math-italic;">B</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">B</script>.</li>   <li>For every pair of indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-749"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">i</span><span class="MJXp-mo" id="MJXp-Span-751" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">j</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-98-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-868"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-869"><span class="mi" id="MathJax-Span-870" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-871" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-872" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">j</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">i, j</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-753"><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">i</span><span class="MJXp-mo" id="MJXp-Span-756" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">j</span><span class="MJXp-mo" id="MJXp-Span-758" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-99-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-873"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-874"><span class="mo" id="MathJax-Span-875" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-876" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-877" style="font-family: MathJax_Main; padding-left: 0.311em;">&lt;</span><span class="mi" id="MathJax-Span-878" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">j</span><span class="mo" id="MathJax-Span-879" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-99">(i < j)</script> belonging to the same block <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">b</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-100-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-880"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-881"><span class="mi" id="MathJax-Span-882" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-100">b</script>, precompute (a) the state it ends up at upon first exiting this block if we enter with state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-761"><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">x</span><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765">i</span><span class="MJXp-mo" id="MJXp-Span-766" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">y</span><span class="MJXp-mo" id="MJXp-Span-768" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">j</span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-101-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-883"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-884"><span class="mo" id="MathJax-Span-885" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-886" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-887" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-888" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">i</span><span class="mo" id="MathJax-Span-889" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-890" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-891" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-892" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">j</span><span class="mo" id="MathJax-Span-893" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-101">(x = i, y = j)</script> (b) the number of jumps required to do so. All of this can be done in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">O</span><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-776" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-102-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-894"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-895"><span class="mi" id="MathJax-Span-896" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-897" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-898"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-899" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.742em;"><span class="mn" id="MathJax-Span-900" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-901" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-102">O(B^2)</script> per block, and thus takes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">O</span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">n</span><span class="MJXp-mrow" id="MJXp-Span-783"><span class="MJXp-mo" id="MJXp-Span-784" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">B</span><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-790" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-103-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-902"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-903"><span class="mi" id="MathJax-Span-904" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-905" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-906" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-907" style="font-family: MathJax_Math-italic;">n</span><span class="texatom" id="MathJax-Span-908"><span class="mrow" id="MathJax-Span-909"><span class="mo" id="MathJax-Span-910" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-911" style="font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-912" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-913" style="font-family: MathJax_Main; padding-left: 0.249em;">⋅</span><span class="msubsup" id="MathJax-Span-914" style="padding-left: 0.249em;"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.74em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-915" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.742em;"><span class="mn" id="MathJax-Span-916" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-917" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-103">O((n/B) \cdot B^2)</script> time in total.</li>   <li>For every query <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">l</span><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">r</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-104-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-918"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-919"><span class="mi" id="MathJax-Span-920" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-921" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-922" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">r</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-104">l, r</script>, start with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">x</span><span class="MJXp-mo" id="MJXp-Span-798" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">l</span><span class="MJXp-mo" id="MJXp-Span-800" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">y</span><span class="MJXp-mo" id="MJXp-Span-802" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">l</span><span class="MJXp-mo" id="MJXp-Span-804" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-805">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-105-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-923"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-924"><span class="mi" id="MathJax-Span-925" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-926" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-927" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">l</span><span class="mo" id="MathJax-Span-928" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-929" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-930" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-931" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">l</span><span class="mo" id="MathJax-Span-932" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-933" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-105">x = l, y = l + 1</script>, and until <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">y</span><span class="MJXp-mo" id="MJXp-Span-808" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">r</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-106-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-934"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-935"><span class="mi" id="MathJax-Span-936" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-937" style="font-family: MathJax_Main; padding-left: 0.311em;">≤</span><span class="mi" id="MathJax-Span-938" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">r</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-106">y \leq r</script>: (a) if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-107-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-939"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-940"><span class="mi" id="MathJax-Span-941" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-107">x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-108-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-942"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-943"><span class="mi" id="MathJax-Span-944" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">y</script> lie in the same block and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-814"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">r</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-109-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-945"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-946"><span class="mi" id="MathJax-Span-947" style="font-family: MathJax_Math-italic;">r</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">r</script> doesn't lie in the same block, use the precomputed info to jump out of this block in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">O</span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-819">1</span><span class="MJXp-mo" id="MJXp-Span-820" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-110-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-948"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-949"><span class="mi" id="MathJax-Span-950" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-951" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-952" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-953" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-110">O(1)</script> (b) otherwise manually make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-111-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-954"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-955"><span class="mi" id="MathJax-Span-956" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-111">x</script> jump to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-823"><span class="MJXp-mo" id="MJXp-Span-824" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-826">nxt</span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">x</span><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-830" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">y</span><span class="MJXp-mo" id="MJXp-Span-832" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-833">1</span><span class="MJXp-mo" id="MJXp-Span-834" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-112-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-957"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-958"><span class="mo" id="MathJax-Span-959" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-960" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-961" style="font-family: MathJax_Main;">nxt</span><span class="mo" id="MathJax-Span-962" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-963" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-964" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-965" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-966" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-967" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-968" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-969" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-112">\max(\text{nxt}(x), y + 1)</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">O</span><span class="MJXp-mo" id="MJXp-Span-837" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-838">1</span><span class="MJXp-mo" id="MJXp-Span-839" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-113-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-970"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-971"><span class="mi" id="MathJax-Span-972" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-973" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-974" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-975" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">O(1)</script>. We can prove that this process terminates within <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">O</span><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">n</span><span class="MJXp-mrow" id="MJXp-Span-844"><span class="MJXp-mo" id="MJXp-Span-845" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">B</span><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-114-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-976"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-977"><span class="mi" id="MathJax-Span-978" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-979" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-980" style="font-family: MathJax_Math-italic;">n</span><span class="texatom" id="MathJax-Span-981"><span class="mrow" id="MathJax-Span-982"><span class="mo" id="MathJax-Span-983" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-984" style="font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-985" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-114">O(n/B)</script> iterations, so we answer each query in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">O</span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">n</span><span class="MJXp-mrow" id="MJXp-Span-852"><span class="MJXp-mo" id="MJXp-Span-853" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">B</span><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-115-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-986"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-987"><span class="mi" id="MathJax-Span-988" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-989" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-990" style="font-family: MathJax_Math-italic;">n</span><span class="texatom" id="MathJax-Span-991"><span class="mrow" id="MathJax-Span-992"><span class="mo" id="MathJax-Span-993" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-994" style="font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-995" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-115">O(n/B)</script> time.</li> </ul><p>A poor implementation of this idea can be found <a href="https://codeforces.com/contest/2152/submission/342364793">here</a>. Unfortunately, accessing the precomputed information is horribly cache-unfriendly to the point where I don't think this can be made to pass.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1315366 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1315366 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1315366">
        </ul>
    </div>
</div>

<div class="comment" commentid="1315523">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1315523" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Asim020202" title="Pupil Asim020202" class="rated-user user-green">Asim020202</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/07/2025 15:05 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1315523" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Asim020202" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4896798/avatar/bcb98c7807d24cf3.jpg">        </a>
        <div><a href="/profile/Asim020202" title="Pupil Asim020202" class="rated-user user-green">Asim020202</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/07/2025 15:05 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1315523" href="?#comment-1315523" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1315523" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4896798" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1315523">
                        <div class="moveup">
                        <div class="ttypography"><p>I was a pupil in this test.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1315523 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1315523 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1315523">
        </ul>
    </div>
</div>

<div class="comment" commentid="1315743">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1315743" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/negative-xp" title="Master negative-xp" class="rated-user user-orange">negative-xp</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/08/2025 12:34 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1315743" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/negative-xp" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4043346/avatar/d2979d356511d0ad.jpg">        </a>
        <div><a href="/profile/negative-xp" title="Master negative-xp" class="rated-user user-orange">negative-xp</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/08/2025 12:34 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1315743" href="?#comment-1315743" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1315743" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1315743" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4043346" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1315743">
                        <div class="moveup">
                        <div class="ttypography"><p>Alternate linear solution for H1:</p><p>Let's try to solve the problem for a single query with value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">l</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-116-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-996"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-997"><span class="mi" id="MathJax-Span-998" style="font-family: MathJax_Math-italic;">l</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-116">l</script>. We root the tree at node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-858"><span class="MJXp-mn" id="MJXp-Span-859">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-117-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-999"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1000"><span class="mn" id="MathJax-Span-1001" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-117">1</script>. </p><p><strong>Observation 1</strong>: Any optimal selection of red nodes forms a connected component.</p> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: none;"><p>If the set of red nodes form two connected components, then you can delete one and that will strictly improve the answer since the contribution of the remaining component isn't affected and that of the deleted one becomes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-860"><span class="MJXp-mn" id="MJXp-Span-861">0</span></span></span><script type="math/tex" id="MathJax-Element-118">0</script>.</p></div></div><p><strong>Observation 2</strong>: For any leaf <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">u</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-119-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1005"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1006"><span class="mi" id="MathJax-Span-1007" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-119">u</script>, it's optimal to assign it a weight of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-864"><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-866" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-867">0</span><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">l</span><span class="MJXp-mo" id="MJXp-Span-870" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">y</span><span class="MJXp-mo" id="MJXp-Span-872" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-120-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1008"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1009"><span class="mo" id="MathJax-Span-1010" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-1011" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1012" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1013" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1014" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">l</span><span class="mo" id="MathJax-Span-1015" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mi" id="MathJax-Span-1016" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1017" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-120">\max(0, l - y)</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-121-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1018"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1019"><span class="mi" id="MathJax-Span-1020" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-121">y</script> is the weight of the edge from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">u</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-122-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1021"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1022"><span class="mi" id="MathJax-Span-1023" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-122">u</script> to its parent.</p> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: none;"><p>Fix any optimal assignment of weights <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-877"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">w</span></span></span><script type="math/tex" id="MathJax-Element-123">w</script>.</p><p>Then in this assignment, the minimum cost coloring where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">u</span></span></span><script type="math/tex" id="MathJax-Element-124">u</script> is colored red is one of the following:</p> <ul>   <li>We only color <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">u</span></span></span><script type="math/tex" id="MathJax-Element-125">u</script> red, incurring a total cost of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-883"><span class="MJXp-msubsup" id="MJXp-Span-884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-886" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">y</span></span></span><script type="math/tex" id="MathJax-Element-126">w_u + y</script>. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">w</span></span></span><script type="math/tex" id="MathJax-Element-127">w</script> is valid, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-891"><span class="MJXp-msubsup" id="MJXp-Span-892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-894" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">y</span><span class="MJXp-mo" id="MJXp-Span-897" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">l</span><span class="MJXp-mspace" id="MJXp-Span-899" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-900" style="margin-left: 0.333em; margin-right: 0.333em;">⟹</span><span class="MJXp-mspace" id="MJXp-Span-901" style="width: 0.278em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-904" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-905" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">l</span><span class="MJXp-mo" id="MJXp-Span-907" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">y</span></span></span><script type="math/tex" id="MathJax-Element-128">w_u + y \geq l \implies w_u \geq l - y</script>.</li>   <li>Both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">u</span></span></span><script type="math/tex" id="MathJax-Element-129">u</script> and its parent <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">p</span></span></span><script type="math/tex" id="MathJax-Element-130">p</script> are colored red. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">S</span></span></span><script type="math/tex" id="MathJax-Element-131">S</script> be a set of red nodes with the minimum possible cost which includes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-915"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">p</span></span></span><script type="math/tex" id="MathJax-Element-132">p</script> but not <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">u</span></span></span><script type="math/tex" id="MathJax-Element-133">u</script>, and let its cost be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-919"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">x</span></span></span><script type="math/tex" id="MathJax-Element-134">x</script>. Then in this case, the optimal choice is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">S</span><span class="MJXp-mo" id="MJXp-Span-923" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">u</span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-135">S \cup \{ u \}</script>, and the cost of this set will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">x</span><span class="MJXp-mo" id="MJXp-Span-929" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">y</span><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-934" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-136">x - y + w_u</script>. Now, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">S</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-mo" id="MJXp-Span-938" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">u</span><span class="MJXp-mo" id="MJXp-Span-940" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-137">S \cup \{ u \}</script> is strictly more optimal than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-941"><span class="MJXp-mo" id="MJXp-Span-942" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">u</span><span class="MJXp-mo" id="MJXp-Span-944" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-138">\{ u \}</script> iff <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">y</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-948"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-950" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">x</span><span class="MJXp-mo" id="MJXp-Span-953" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">y</span><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-958" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-139">y + w_u > x - y + w_u</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-959"><span class="MJXp-mtable" id="MJXp-Span-960"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-961" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-962" style="text-align: center;"><span class="MJXp-mspace" id="MJXp-Span-963" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0.333em; margin-right: 0.333em;">⟹</span><span class="MJXp-mspace" id="MJXp-Span-965" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">y</span><span class="MJXp-mo" id="MJXp-Span-967" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">x</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">y</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-140">\implies y > x - y \tag{1}</script> Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">w</span></span></span><script type="math/tex" id="MathJax-Element-141">w</script> is a valid assignment, we also have: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-973"><span class="MJXp-mtable" id="MJXp-Span-974"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-975" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-976" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">y</span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-981" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-982" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">l</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-142">y + w_u \geq l \tag{2}</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-984"><span class="MJXp-mtable" id="MJXp-Span-985"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-986" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-987" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">x</span><span class="MJXp-mo" id="MJXp-Span-989" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">y</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-994" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-995" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">l</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-143">x - y + w_u \geq l \tag{3}</script> Combining <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-997"><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-999">1</span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-144">(1)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1001"><span class="MJXp-mo" id="MJXp-Span-1002" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1003">2</span><span class="MJXp-mo" id="MJXp-Span-1004" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-145">(2)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1005"><span class="MJXp-mo" id="MJXp-Span-1006" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1007">3</span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-146">(3)</script>, we get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1009"><span class="MJXp-msubsup" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1012" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1013" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">l</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">y</span></span></span><script type="math/tex" id="MathJax-Element-147">w_u \geq l - y</script>.</li> </ul><p>So in both situations, the necessary lowerbound on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1017"><span class="MJXp-msubsup" id="MJXp-Span-1018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1020" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-148">w_u</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">l</span><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">y</span></span></span><script type="math/tex" id="MathJax-Element-149">l - y</script>, and we assign <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">u</span></span></span><script type="math/tex" id="MathJax-Element-150">u</script> the lowest possible weight, which is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1027"><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1029" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1030">0</span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">l</span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">y</span><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-151">\max(0, l - y)</script> (since all weights must be non-negative).</p></div></div><p>Let's extend this idea further. We'll assign weights to vertices in a bottom-up manner (so when assigning <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1036"><span class="MJXp-msubsup" id="MJXp-Span-1037"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1039" style="vertical-align: -0.4em;">u</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-152-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1221"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1222"><span class="msubsup" id="MathJax-Span-1223"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1224" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-1225" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-152">w_u</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1040"><span class="MJXp-msubsup" id="MJXp-Span-1041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1043" style="vertical-align: -0.4em;">v</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-153-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1226"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1227"><span class="msubsup" id="MathJax-Span-1228"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1229" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-1230" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-153">w_v</script> for all children <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">v</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-154-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1231"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1232"><span class="mi" id="MathJax-Span-1233" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-154">v</script> of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">u</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-155-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1234"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1235"><span class="mi" id="MathJax-Span-1236" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-155">u</script> would already have been assigned).</p><p>Some definitions:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">S</span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">u</span><span class="MJXp-mo" id="MJXp-Span-1052" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">v</span><span class="MJXp-mo" id="MJXp-Span-1054" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-156-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1237"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1238"><span class="mi" id="MathJax-Span-1239" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-1240" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1241" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1242" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1243" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">v</span><span class="mo" id="MathJax-Span-1244" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-156">S(u, v)</script> — a set of red nodes with the minimum cost which contains <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">u</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-157-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1245"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1246"><span class="mi" id="MathJax-Span-1247" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-157">u</script> but not <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">v</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-158-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1248"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1249"><span class="mi" id="MathJax-Span-1250" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-158">v</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1059"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">C</span><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">u</span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">v</span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-159-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1251"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1252"><span class="mi" id="MathJax-Span-1253" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-1254" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1255" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1256" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1257" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">v</span><span class="mo" id="MathJax-Span-1258" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-159">C(u, v)</script> — the cost of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">S</span><span class="MJXp-mo" id="MJXp-Span-1068" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">u</span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">v</span><span class="MJXp-mo" id="MJXp-Span-1072" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-160-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1259"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1260"><span class="mi" id="MathJax-Span-1261" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-1262" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1263" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1264" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1265" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">v</span><span class="mo" id="MathJax-Span-1266" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-160">S(u, v)</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1073"><span class="MJXp-msubsup" id="MJXp-Span-1074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1076" style="vertical-align: -0.4em;">u</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-161-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1267"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1268"><span class="msubsup" id="MathJax-Span-1269"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1270" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1271" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-161">p_u</script> — the parent of u.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">g</span><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">u</span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">v</span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-162-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1272"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1273"><span class="mi" id="MathJax-Span-1274" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1275" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1276" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1277" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1278" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">v</span><span class="mo" id="MathJax-Span-1279" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-162">g(u, v)</script> — the weight of the edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1084"><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">u</span><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">v</span><span class="MJXp-mo" id="MJXp-Span-1089" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-163-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1280"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1281"><span class="mo" id="MathJax-Span-1282" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1283" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1284" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1285" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">v</span><span class="mo" id="MathJax-Span-1286" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-163">(u, v)</script>.</li> </ul><p>For every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1090"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">u</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-164-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1287"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1288"><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-164">u</script>, we will compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">C</span><span class="MJXp-mo" id="MJXp-Span-1094" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">u</span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1097"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1099" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1100" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-165-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1290"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1291"><span class="mi" id="MathJax-Span-1292" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-1293" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1294" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1295" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1296" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1297" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1298" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1299" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-165">C(u, p_u)</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1101"><span class="MJXp-msubsup" id="MJXp-Span-1102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1104" style="vertical-align: -0.4em;">u</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-166-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1300"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1301"><span class="msubsup" id="MathJax-Span-1302"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1303" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1304" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-166">p_u</script> is the parent of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">u</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-167-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1305"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1306"><span class="mi" id="MathJax-Span-1307" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-167">u</script>. It's not difficult to see that:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">C</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">u</span><span class="MJXp-mo" id="MJXp-Span-1111" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1114" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1115" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">g</span><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">u</span><span class="MJXp-mo" id="MJXp-Span-1120" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1123" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1124" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1125" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1128" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1129" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1130"><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1132" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">v</span><span class="MJXp-mo" id="MJXp-Span-1134">∈</span><span class="MJXp-mtext" id="MJXp-Span-1135">children</span><span class="MJXp-mo" id="MJXp-Span-1136">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">u</span><span class="MJXp-mo" id="MJXp-Span-1138">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1140" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1141" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">g</span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">v</span><span class="MJXp-mo" id="MJXp-Span-1145" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1148" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1150" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">C</span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">v</span><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1157" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-1158" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1159" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">g</span><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">v</span><span class="MJXp-mo" id="MJXp-Span-1163" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1166" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-1167" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1169" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-168-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1308"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1309"><span class="mi" id="MathJax-Span-1310" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-1311" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1312" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1313" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1314" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1315" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1316" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1317" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1318" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-1319" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1320" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1321" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1322" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1323" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1324" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1325" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1326" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1327" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="msubsup" id="MathJax-Span-1328" style="padding-left: 0.249em;"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1329" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-1330" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1331" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="munderover" id="MathJax-Span-1332" style="padding-left: 0.249em;"><span style="display: inline-block; position: relative; width: 5.357em; height: 0px;"><span style="position: absolute; clip: rect(3.08em, 1000.99em, 4.434em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-1333" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.689em; left: 1.049em;"><span class="texatom" id="MathJax-Span-1334"><span class="mrow" id="MathJax-Span-1335"><span class="mi" id="MathJax-Span-1336" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1337" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mtext" id="MathJax-Span-1338" style="font-size: 70.7%; font-family: MathJax_Main;">children</span><span class="mo" id="MathJax-Span-1339" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1340" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1341" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1342" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1343" style="font-family: MathJax_Main;">min</span><span class="mo" id="MathJax-Span-1344" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1345" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1346" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1347" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1348" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1349" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.926em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1350" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1351" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1352" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1353" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1354" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-1355" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1356" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1357" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1358" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.926em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1359" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1360" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1361" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1362" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mi" id="MathJax-Span-1363" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1364" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1365" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1366" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1367" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.926em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1368" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1369" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1370" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1371" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1372" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-168">C(u, p_u) = g(u, p_u) + w_u + \sum_{v \in \text{children}(u)} (\min(g(v, p_v), C(v, p_v) - g(v, p_v)))</script></center><p>(for every child $v$, we choose to either take the cost of the optimal component from below, or that of just the edge)</p><p><strong>Observation 3</strong>: It's optimal to assign node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">u</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-169-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1373"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1374"><span class="mi" id="MathJax-Span-1375" style="font-family: MathJax_Math-italic;">u</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-169">u</script> a weight of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1172"><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1175">0</span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">l</span><span class="MJXp-mo" id="MJXp-Span-1178" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">g</span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">u</span><span class="MJXp-mo" id="MJXp-Span-1182" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1185" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1188"><span class="MJXp-mo" id="MJXp-Span-1189" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1190" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">v</span><span class="MJXp-mo" id="MJXp-Span-1192">∈</span><span class="MJXp-mtext" id="MJXp-Span-1193">children</span><span class="MJXp-mo" id="MJXp-Span-1194">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">u</span><span class="MJXp-mo" id="MJXp-Span-1196">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1197" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1198" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">g</span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">v</span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1206" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-1207" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1208" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">C</span><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">v</span><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1215" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1217" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">g</span><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">v</span><span class="MJXp-mo" id="MJXp-Span-1221" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1224" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-1225" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-170-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1376"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1377"><span class="mo" id="MathJax-Span-1378" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-1379" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1380" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1381" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1382" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">l</span><span class="mo" id="MathJax-Span-1383" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mi" id="MathJax-Span-1384" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1385" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1386" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1387" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1388" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1389" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1390" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1391" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1392" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="munderover" id="MathJax-Span-1393" style="padding-left: 0.249em;"><span style="display: inline-block; position: relative; width: 5.357em; height: 0px;"><span style="position: absolute; clip: rect(3.08em, 1000.99em, 4.434em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-1394" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.689em; left: 1.049em;"><span class="texatom" id="MathJax-Span-1395"><span class="mrow" id="MathJax-Span-1396"><span class="mi" id="MathJax-Span-1397" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1398" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mtext" id="MathJax-Span-1399" style="font-size: 70.7%; font-family: MathJax_Main;">children</span><span class="mo" id="MathJax-Span-1400" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1401" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1402" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1403" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1404" style="font-family: MathJax_Main;">min</span><span class="mo" id="MathJax-Span-1405" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1406" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1407" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1408" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1409" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1410" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.926em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1411" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1412" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1413" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1414" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1415" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-1416" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1417" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1418" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1419" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.926em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1420" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1421" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1422" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1423" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mi" id="MathJax-Span-1424" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1425" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1426" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1427" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1428" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.926em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1429" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mi" id="MathJax-Span-1430" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1431" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1432" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1433" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1434" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-170">\max(0, l - g(u, p_u) - \sum_{v \in \text{children}(u)} (\min(g(v, p_v), C(v, p_v) - g(v, p_v))))</script> (define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">g</span><span class="MJXp-mo" id="MJXp-Span-1231" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1232">1</span><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1236" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-171-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1435"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1436"><span class="mi" id="MathJax-Span-1437" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1438" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1439" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1440" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1441" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.926em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1442" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.495em;"><span class="mn" id="MathJax-Span-1443" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1444" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-171">g(1, p_1)</script> to be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1238"><span class="MJXp-mn" id="MJXp-Span-1239">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-172-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1445"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1446"><span class="mn" id="MathJax-Span-1447" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-172">0</script>).</p> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: none;"><p>Exercise for the reader. The outline is the same as the case for leaves, you just have to consider the fact that we now have some children and we know for certain the choice we're going to make between choosing the edge going to a child or some component including the child (since these choices are independent from the rest of the assignment).</p></div></div><p>This works in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">O</span><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">n</span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-173-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1448"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 125%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1449"><span class="mi" id="MathJax-Span-1450" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1451" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1452" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1453" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-173">O(n)</script> per query and ends up being very easy <a href="https://codeforces.com/contest/2152/submission/342585623">to implement</a>.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1315743 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1315743 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1315743">
        </ul>
    </div>
</div>

<div class="comment" commentid="1315769">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1315769" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/rJ_YsenM2" title="Unrated, rJ_YsenM2" class="rated-user user-black">rJ_YsenM2</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/08/2025 13:27 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1315769" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/rJ_YsenM2" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/rJ_YsenM2" title="Unrated, rJ_YsenM2" class="rated-user user-black">rJ_YsenM2</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/08/2025 13:27 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1315769" href="?#comment-1315769" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1315769" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="5204243" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1315769">
                        <div class="moveup">
                        <div class="ttypography"><p>I’m really sorry to post this here, but I need some help. In this contest, my main account rJ_ysenM was banned immediately after my first “skip”. I believe it’s a mistake because I did not cheat or engage in any suspicious behavior. In fact, I even ran the problems through several AI language models and got totally different solutions from mine.</p><p>I understand that skipping some easy problems and go solve harder problems right away can look suspicious, but if you review my contest history, you’ll see I only do that in topics I’m deeply familiar with (primarily graphs and combinatorics).</p><p>I realize you may have strict anti-cheat measures in place, which is why I’m reaching out directly now. I’ve already contacted Mike but haven’t heard back, so a friend suggested I try here or reach out to KAN (which i also did but i know both of them are busy)</p><p>I was so close to reaching Master and I’d really appreciate any help restoring my account. Thank you for your time, and sorry again for any inconvenience.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1315769 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1315769 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1315769">
        </ul>
    </div>
</div>

<div class="comment" commentid="1316227">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1316227" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/zltzlt" title="International Grandmaster zltzlt" class="rated-user user-red">zltzlt</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/10/2025 14:50 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1316227" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/zltzlt" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2142326/avatar/fbf08ef98d03d17e.jpg">        </a>
        <div><a href="/profile/zltzlt" title="International Grandmaster zltzlt" class="rated-user user-red">zltzlt</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/10/2025 14:50 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1316227" href="?#comment-1316227" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1316227" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2142326" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1316227">
                        <div class="moveup">
                        <div class="ttypography"><p>I have an alternative solution for H1:</p> <div class="spoiler"><b class="spoiler-title">Spoiler</b><div class="spoiler-content" style="display: none;"><p>First, it is clear that the red points form a connected component. We can write the following linear program (let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">C</span></span></span><script type="math/tex" id="MathJax-Element-174">C</script> denote a connected component):</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1247"><span class="MJXp-mtable" id="MJXp-Span-1248"><span><span class="MJXp-mtr" id="MJXp-Span-1249" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1250" style="text-align: right;"><span class="MJXp-mtext" id="MJXp-Span-1251">minimize</span><span class="MJXp-mspace" id="MJXp-Span-1252" style="width: 1em; height: 0em;"></span></span><span class="MJXp-mtd" id="MJXp-Span-1253" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1254"></span><span class="MJXp-munderover" id="MJXp-Span-1255"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261" style="margin-right: 0px; margin-left: 0px;">n</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1256" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1257" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">i</span><span class="MJXp-mo" id="MJXp-Span-1259">=</span><span class="MJXp-mn" id="MJXp-Span-1260">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1264" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-1265" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1266" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mtext" id="MJXp-Span-1267">s.t.</span><span class="MJXp-mspace" id="MJXp-Span-1268" style="width: 1em; height: 0em;"></span></span><span class="MJXp-mtd" id="MJXp-Span-1269" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1270">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">C</span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-munderover" id="MJXp-Span-1273"><span class=""><span class="MJXp-mo" id="MJXp-Span-1274" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1275" style="margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1276">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">u</span><span class="MJXp-mo" id="MJXp-Span-1278">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">v</span><span class="MJXp-mo" id="MJXp-Span-1280">)</span><span class="MJXp-mo" id="MJXp-Span-1281">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">E</span><span class="MJXp-mo" id="MJXp-Span-1283">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">u</span><span class="MJXp-mo" id="MJXp-Span-1285">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">C</span><span class="MJXp-mo" id="MJXp-Span-1287">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">v</span><span class="MJXp-mo" id="MJXp-Span-1289">∉</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">C</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1293" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1294">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">u</span><span class="MJXp-mo" id="MJXp-Span-1296">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">v</span><span class="MJXp-mo" id="MJXp-Span-1298">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1299" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-1300"><span class=""><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1302" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">u</span><span class="MJXp-mo" id="MJXp-Span-1304">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">C</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1308" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">l</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1311" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1312" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1313" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-1314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1316" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1318">0</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-175"> \begin{aligned} \text{minimize}\quad & \sum\limits_{i = 1}^n x_i \\ \text{s.t.}\quad & \forall C, \sum\limits_{(u, v) \in E, u \in C, v \notin C} d_{(u, v)} + \sum\limits_{u \in C} x_u \ge l \\ & x_i \ge 0 \end{aligned} </script></center><p>Taking the dual, we have:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1319"><span class="MJXp-mtable" id="MJXp-Span-1320"><span><span class="MJXp-mtr" id="MJXp-Span-1321" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1322" style="text-align: right;"><span class="MJXp-mtext" id="MJXp-Span-1323">maximize</span><span class="MJXp-mspace" id="MJXp-Span-1324" style="width: 1em; height: 0em;"></span></span><span class="MJXp-mtd" id="MJXp-Span-1325" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1326"></span><span class="MJXp-munderover" id="MJXp-Span-1327"><span class=""><span class="MJXp-mo" id="MJXp-Span-1328" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329" style="margin-left: 0px;">C</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1332" style="vertical-align: -0.4em;">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1333"><span class="MJXp-mo" id="MJXp-Span-1334" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.622em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.489em; margin-left: -0.17em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">l</span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-1337"><span class=""><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1339" style="margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1340">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">u</span><span class="MJXp-mo" id="MJXp-Span-1342">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">v</span><span class="MJXp-mo" id="MJXp-Span-1344">)</span><span class="MJXp-mo" id="MJXp-Span-1345">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">E</span><span class="MJXp-mo" id="MJXp-Span-1347">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">u</span><span class="MJXp-mo" id="MJXp-Span-1349">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">C</span><span class="MJXp-mo" id="MJXp-Span-1351">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">v</span><span class="MJXp-mo" id="MJXp-Span-1353">∉</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">C</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1357" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1358">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">u</span><span class="MJXp-mo" id="MJXp-Span-1360">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">v</span><span class="MJXp-mo" id="MJXp-Span-1362">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1363" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.622em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.489em; margin-left: -0.17em;">)</span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-1364" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1365" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mtext" id="MJXp-Span-1366">s.t.</span><span class="MJXp-mspace" id="MJXp-Span-1367" style="width: 1em; height: 0em;"></span></span><span class="MJXp-mtd" id="MJXp-Span-1368" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1369">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">u</span><span class="MJXp-mo" id="MJXp-Span-1371" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-munderover" id="MJXp-Span-1372"><span class=""><span class="MJXp-mo" id="MJXp-Span-1373" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1374" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">u</span><span class="MJXp-mo" id="MJXp-Span-1376">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">C</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1380" style="vertical-align: -0.4em;">C</span></span><span class="MJXp-mo" id="MJXp-Span-1381" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1382">1</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1383" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1384" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1385" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-1386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1388" style="vertical-align: -0.4em;">C</span></span><span class="MJXp-mo" id="MJXp-Span-1389" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1390">0</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-176"> \begin{aligned} \text{maximize}\quad & \sum\limits_C y_C \left(l - \sum\limits_{(u, v) \in E, u \in C, v \notin C} d_{(u, v)}\right) \\ \text{s.t.}\quad & \forall u, \sum\limits_{u \in C} y_C \le 1 \\ & y_C \ge 0 \end{aligned} </script></center><p>If we assume that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1391"><span class="MJXp-msubsup" id="MJXp-Span-1392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1394" style="vertical-align: -0.4em;">C</span></span></span></span><script type="math/tex" id="MathJax-Element-177">y_C</script> takes integer values, the problem becomes equivalent to selecting several connected components such that each vertex is contained in at most one component, and each selected component <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">C</span></span></span><script type="math/tex" id="MathJax-Element-178">C</script> has a value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">l</span><span class="MJXp-mo" id="MJXp-Span-1399" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-1400"><span class=""><span class="MJXp-mo" id="MJXp-Span-1401" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1402" style="margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1403">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">u</span><span class="MJXp-mo" id="MJXp-Span-1405">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">v</span><span class="MJXp-mo" id="MJXp-Span-1407">)</span><span class="MJXp-mo" id="MJXp-Span-1408">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">E</span><span class="MJXp-mo" id="MJXp-Span-1410">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">u</span><span class="MJXp-mo" id="MJXp-Span-1412">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">C</span><span class="MJXp-mo" id="MJXp-Span-1414">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">v</span><span class="MJXp-mo" id="MJXp-Span-1416">∉</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">C</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1420" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1421">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">u</span><span class="MJXp-mo" id="MJXp-Span-1423">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">v</span><span class="MJXp-mo" id="MJXp-Span-1425">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-179">l - \sum\limits_{(u, v) \in E, u \in C, v \notin C} d_{(u, v)}</script>. The goal is to maximize the total value of the selected components.</p><p>Consider a tree DP. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1426"><span class="MJXp-msubsup" id="MJXp-Span-1427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1429" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">u</span><span class="MJXp-mo" id="MJXp-Span-1431">,</span><span class="MJXp-mn" id="MJXp-Span-1432">0</span><span class="MJXp-mrow" id="MJXp-Span-1433"><span class="MJXp-mo" id="MJXp-Span-1434">/</span></span><span class="MJXp-mn" id="MJXp-Span-1435">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-180">f_{u, 0/1}</script> denote the maximum total value of connected components within the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">u</span></span></span><script type="math/tex" id="MathJax-Element-181">u</script>, with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">u</span></span></span><script type="math/tex" id="MathJax-Element-182">u</script> either being included in or excluded from a connected component. The transition is straightforward.</p><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">O</span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">q</span><span class="MJXp-mo" id="MJXp-Span-1445" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-183">O(nq)</script></p> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pb emplace_back

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">&gt;</span><span class="pln"> pii</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> maxn </span><span class="pun">=</span><span class="pln"> </span><span class="lit">250100</span><span class="pun">;</span><span class="pln">

ll n</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">,</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">][</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
vector</span><span class="str">&lt;pii&gt;</span><span class="pln"> G</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> fa</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">]</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> G</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v </span><span class="pun">==</span><span class="pln"> fa</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		dfs</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> u</span><span class="pun">);</span><span class="pln">
		f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> m </span><span class="pun">-</span><span class="pln"> d</span><span class="pun">);</span><span class="pln">
		f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> max</span><span class="pun">({</span><span class="pln">f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> d</span><span class="pun">,</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> m </span><span class="pun">-</span><span class="pln"> d </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">});</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%lld"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		vector</span><span class="str">&lt;pii&gt;</span><span class="pun">().</span><span class="pln">swap</span><span class="pun">(</span><span class="pln">G</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">d</span><span class="pun">);</span><span class="pln">
		G</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="pln">pb</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">);</span><span class="pln">
		G</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">pb</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%lld"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">q</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">q</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%lld"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">m</span><span class="pun">);</span><span class="pln">
		dfs</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">f</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> f</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> m</span><span class="pun">));</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1316227 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1316227 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1316227">
        </ul>
    </div>
</div>

<div class="comment" commentid="1316648">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1316648" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/geruome" title="International Master geruome" class="rated-user user-orange">geruome</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/11/2025 13:21 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1316648" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/geruome" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2215035/avatar/f6cec61dbbdaab32.jpg">        </a>
        <div><a href="/profile/geruome" title="International Master geruome" class="rated-user user-orange">geruome</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/11/2025 13:21 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1316648" href="?#comment-1316648" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1316648" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2215035" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1316648">
                        <div class="moveup">
                        <div class="ttypography"><p>I bet the question setter is a T1 fan</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1316648 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1316648 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1316648">
        </ul>
    </div>
</div>

<div class="comment" commentid="1317845">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1317845" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/ritchie_s" title="Pupil ritchie_s" class="rated-user user-green">ritchie_s</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/15/2025 15:23 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1317845" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/ritchie_s" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4383205/avatar/6bbfd84467d7ab5e.jpg">        </a>
        <div><a href="/profile/ritchie_s" title="Pupil ritchie_s" class="rated-user user-green">ritchie_s</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/15/2025 15:23 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1317845" href="?#comment-1317845" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1317845" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1317845" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-8" data-commentuserid="4383205" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1317845">
                        <div class="moveup">
                        <div class="ttypography"><p>even the first problem felt difficult to me....</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1317845 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1317845 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1317845">
        </ul>
    </div>
</div>

<div class="comment" commentid="1327757">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1327757" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Tadas" title="Pupil Tadas" class="rated-user user-green">Tadas</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/21/2025 15:36 UTC">3 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1327757" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Tadas" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/458307/avatar/450b5df4b80035ee.jpg">        </a>
        <div><a href="/profile/Tadas" title="Pupil Tadas" class="rated-user user-green">Tadas</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/21/2025 15:36 UTC">3 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1327757" href="?#comment-1327757" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1327757" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="458307" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1327757">
                        <div class="moveup">
                        <div class="ttypography"><p>Is C proof complete?</p><p>This part seems not to be strict or detailed enough. "Suppose that there are two indices i,j such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1446"><span class="MJXp-msubsup" id="MJXp-Span-1447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1449" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1450" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1451">2</span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1453">0</span><span class="MJXp-mo" id="MJXp-Span-1454" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">i</span><span class="MJXp-mo" id="MJXp-Span-1456" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1457">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">k</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1460">0</span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">j</span><span class="MJXp-mo" id="MJXp-Span-1463" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1464">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-184-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-184">c_j\geq2,0<i<3k,0\leq j\leq 3k</script> , and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">i</span><span class="MJXp-mo" id="MJXp-Span-1468" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">j</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-185-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-185">i \ne j</script> . Then it is possible to perform the operations of cost 1 to remove every 0 s between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-186-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-186">i</script> -th 1 and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1472"><span class="MJXp-mo" id="MJXp-Span-1473" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">i</span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1476">1</span><span class="MJXp-mo" id="MJXp-Span-1477" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-187-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-187">(i+1)</script> -th 1 . "</p><p>How can we be sure that it won't lead to this situation? "Otherwise, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1478"><span class="MJXp-msubsup" id="MJXp-Span-1479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1481" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1482" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1485" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1486" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1488" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1490" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1493" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1494">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">k</span><span class="MJXp-mo" id="MJXp-Span-1496">−</span><span class="MJXp-mn" id="MJXp-Span-1497">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1499">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-188">c_1=c_2=...=c_{3k-1}=1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1500"><span class="MJXp-msubsup" id="MJXp-Span-1501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1503" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1504" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1507" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1508">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1511">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-189">c_0,c_{3k}\leq1</script> . In this case, every pair of adjacent elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1512"><span class="MJXp-mo" id="MJXp-Span-1513" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1516" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1517" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1520" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">l</span><span class="MJXp-mo" id="MJXp-Span-1522">+</span><span class="MJXp-mn" id="MJXp-Span-1523">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1525" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1527" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1528" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1531" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-1532" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-190-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-190">[a_l,a_{l+1},...,a_r]</script> is different."</p><p>Is it because we can remove 0s between i-th 1 and i+1th 1, ending up with reversed situation (now 11 are adjacent which can be used to produce another 00 pair (after removing that 11)?)</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1327757 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1327757 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1327757">
        </ul>
    </div>
</div>
        <br>

<div id="editBox-162311" style="width:50em;display:none;">
    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
    <div style="width: 1px">&nbsp;</div>
    <div class="commentLocale" style="position: relative; top: 0.5em;left:4px;display: none;">
        <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
        <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
    </div>
    <textarea data-drafts-id="CommentReplyFrame" class="wysiwyg" name="editContent" rows="20" style="width:99%;"></textarea>
    <div class="error error__content"></div>
    <div style="text-align:center;">
        <input type="button" name="preview" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Preview">
        <input type="button" name="save" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Save">
    </div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {

var firstPreview162311 = true;
var lastPreviewContent162311 = '';

if (!window.moveCommentRevision) {
    moveCommentRevision = function(e, dir) {
        var p = e.parent();
        var revisionCount = parseInt(p.attr("revisionCount"));
        var revision = parseInt(p.attr("revision"));
        var next = revision + dir;
        var commentId = p.attr("commentId");
        if (next >= 1 && next <= revisionCount) {
            $.post(
                "/data/comment-data",
                {action: "revision", commentId: commentId, revision: next},
                function(json) {
                    if (json.success == "true") {
                        var parentDiv = e;

                        while (parentDiv !== null && (parentDiv[0].nodeName.toLowerCase() !== "td" || !parentDiv.hasClass("right"))) {
                            parentDiv = parentDiv.parent();
                        }

                        if (parentDiv === null) {
                            return;
                        }

                        parentDiv.find("div.comment-content-" + commentId + " .moveup").html(json.content);
                        Codeforces.setupSpoilers(parentDiv.find("div.comment-content-" + commentId + " .moveup"));
                        p.attr("revision", next);
                        p.find("span.revision").text(next);
                        if (next == 1) {
                            p.find("a.leftRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.leftRevision").css("visibility", "visible");
                        }
                        if (next == revisionCount) {
                            p.find("a.rightRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.rightRevision").css("visibility", "visible");
                        }

                        window.updateTypography();
                        MathJax.Hub.Typeset();
                    } else {
                        alert(e.error);
                    }
                },
                "json"
            );
        }
    };
}

$("div[commentableId=162311] a.leftRevision").click(function () {
    window.moveCommentRevision($(this), -1);
    return false;
});

$("div[commentableId=162311] a.rightRevision").click(function () {
    window.moveCommentRevision($(this), +1);
    return false;
});



        });
    </script>


        <script src="//codeforces.com/codeforces.org/s/52448/js/swfobject-2.2.min.js" type="text/javascript"></script>
        <script src="//codeforces.com/codeforces.org/s/52448/js/ftaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                if (window.evercookie) {
                    var ec = new evercookie({
                        history: false,
                        silverlight: false,
                        baseurl: '',
                        asseturi: '/assets',
                        phpuri: '/2fdcd78',
                        pngPath: '/eps',
                        etagPath: '/ees',
                        cachePath: '/ecs'
                    });

                    var randomNumber = function () {
                        return Math.random().toString(36).substr(2);
                    };

                    var randomToken = function () {
                        return (randomNumber() + randomNumber()).substring(0, 18);
                    };

                    window._ftaa = "";

                    ec.get("70a7c28f3de", function (value) {
                        window._ftaa = value;
                        if (!window._ftaa) {
                            window._ftaa = randomToken();
                            ec.set("70a7c28f3de", window._ftaa);
                        }
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                } else {
                    window._ftaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

        <script src="//codeforces.com/codeforces.org/s/52448/js/bfaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                var fpCallback = function() {
                    Fingerprint2.get({}, function(components) {
                        window._bfaa = Fingerprint2.x64hash128(components.map(function (pair) { return pair.value }).join(), 31);
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                };
                if (typeof Fingerprint2 !== 'undefined') {
                    if (window.requestIdleCallback) {
                        requestIdleCallback(fpCallback)
                    } else {
                        setTimeout(fpCallback, 500)
                    }
                } else {
                    window._bfaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

    <script type="text/javascript">
        $(document).ready(function () {
    $("a.new-root-comment").click(function () {
            window.location = "/enter";
        return false;
    });

    $(".comment-table .reply a").click(function () {
            window.location = "/enter";
        return false;
    });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
    function updateImg(element, direction, activated) {
        var votedDirection = element.closest(".CommentVoteFrame").attr("myVoteDirection");
        var directionString = direction == 1 ? "up" : "down";
        element.attr("src", "//codeforces.com/codeforces.org/s/52448/images/actions/comment-vote" + directionString + (activated ? "" : "-blue") + ".png");
        element.css("opacity", activated ? "1.0" : "0.35");
        var title;
        if (votedDirection == direction) {
            title = "Cancel vote";
        } else if (direction == 1) {
            title = "Vote: I like it";
        } else {
            title = "Vote: I do not like it";
        }
        element.attr("alt", title);
        element.attr("title", title);
    }

    $(".vote-for-comment").mouseover(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (!ownComment) {
            updateImg(vote.find("img"), direction, true);
        }
    });

    $(".vote-for-comment").mouseout(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (myVoteDirection != direction && !ownComment) {
            updateImg(vote.find("img"), direction, false);
        }
    });

    $(".vote-for-comment").click(function () {
        if ($(this).closest(".hidden-comment").length) {
            Codeforces.showMessage("Show the comment before voting");
            return;
        }
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var commentId = $(this).parent().attr("commentid");
        var commentRating = $(this).parent().attr("data-commentRating");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var direction = $(this).attr("voteDirection");
        var newDirection = direction;
        if (direction == myVoteDirection) {
            newDirection = 0; // Clicking same direction twice cancels the vote
        }
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        $.post("/data/comment/vote", {commentId: commentId, _tta: Codeforces.tta(), vote: newDirection, commentRating: commentRating}, function(data) {
            if (data["success"] == "true") {
                voteFrame.attr("myVoteDirection", newDirection);
                updateImg(voteFrame.find("[voteDirection=-1]>img"), -1, newDirection == -1);
                updateImg(voteFrame.find("[voteDirection=1]>img"), 1, newDirection == 1);
                if (newDirection == -1) {
                    voteFrame.find(".ComplaintFrame").css("display", "inline-block");
                } else {
                    voteFrame.find(".ComplaintFrame").hide();
                }
                vote.parent().find(".commentRating").html(data["commentRating"]);
            }
            Codeforces.showMessage(data["message"]);
        }, "json");
        return false;
    });

    $(".negative-comment-vote").closest(".comment-table").addClass("comment-bad");

    $(".troll-comment-vote").closest(".comment").css("display", "none");

    $(".too-negative-comment-vote").closest(".comment-table").each(function () {
        var e = $(this);
        e.addClass("comment-too-bad");
        var commentId = e.attr("commentId");
        $("<div class='bad-comment-replacement ttypography'>The comment is hidden because of too negative feedback, click <a href=# class=show-bad-comment-link>here</a> to view it</div>").appendTo(
            e.find(".right")
        );
        e.find(".comment-content").hide();
        e.find(".show-bad-comment-link").click(function () {
            e.find(".comment-content").show();
            e.find(".bad-comment-replacement").hide();
            return false;
        });
    });
        });
    </script>
    </div>

    <style type="text/css">
        .new-comments-box {
            padding: 0.5em;
            width: 22px;
            font-size: 1.3rem;
            font-weight: bold !important;

            position: fixed;
            top: 40%;
            right: 0;
            opacity: 0.2;
            color: white;
            text-align: center;

            border: 1px solid #222;
            background-color: #888 !important;
            border-radius: 3px;
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
        }

        .new-comments-box:hover {
            opacity: 1;
        }

        .new-comments-box .dir:hover {
            background: #3B5998 !important;
            cursor: pointer;
        }
    </style>

    <div class="new-comments-box" data-position="outside" data-index="-1" style="display: none;">
        <div class="up dir" title="Ctrl+Up">↑<hr>
        </div>
        <div class="info" title="New comments"></div>
        <div class="down dir" title="Ctrl+Down">
            <hr>↓
        </div>
    </div>

    <script>
        function makeSureElementIsShown(target) {
            let e = target;
            while (true) {
                e = e.parent().closest(".comment");
                if (e.length === 0) {
                    break;
                }
                e.find(">.hidden-comment").hide();
                e.find(">.shown-comment").show();
            }
        }

        $(function() {
            const hash = window.location.hash;
            if (hash) {
                const target = $(hash);
                if (target) {
                    makeSureElementIsShown(target);
                    setTimeout(() => target.scrollIntoView());
                }
            }
        });

        $(".show-archived-checkbox").change(function () {
            const checked = $(this).is(":checked");
            $.post("/data/comment-data", {action: "setShowArchived", checked}, function (json) {
                if (json["success"] !== "true") {
                    alert(json["error"]);
                } else {
                    if (checked) {
                        Codeforces.reloadAndShowMessage("Archived comments are now displayed")
                    } else {
                        Codeforces.reloadAndShowMessage("Archived comments are no longer displayed")
                    }
                }
            });
            return false;
        });

        function gotoComment(direction) {
            var box = $(".new-comments-box");
            var index = parseInt(box.attr("data-index"));
            if (index == -1)
                index = 0;
            else
                index = Math.max(0, Math.min(parseInt(box.find(".info").text()) - 1, index + direction));
            box.attr("data-index", index);
            var comment = $($(".comment>.shown-comment>.highlight-blue[commentId]").get(index));
            makeSureElementIsShown(comment);
            $('html, body').animate({
                'scrollTop': Math.max(0, comment.offset().top - ($(window).height() - comment.height()) / 2)
            });
            return false;
        }

        $(".new-comments-box .down").click(function () {
            return gotoComment(1);
        });

        $(".new-comments-box .up").click(function () {
            return gotoComment(-1);
        });

        $(document).keydown(function (e) {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (e.ctrlKey) {
                if (code == 38 || code == 40) {
                    gotoComment(code - 39);
                }
            }
        });

        var newCommentCount = $(".comment>.shown-comment>.highlight-blue[commentId]").length;
        if (newCommentCount > 0) {
            $(".new-comments-box .info").text(newCommentCount);
            $(".new-comments-box").show();
        }

        $('table.comment-table').mouseenter(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").addClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        $('table.comment-table').mouseleave(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").removeClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        const commentVoteFrameHolderSelector = ">.comment-table .commentVoteFrameHolder";
        $(".hidden-comment").each(function() {
            const comment = $(this).closest(".comment");
            $(this).find(".hidden-children").text(comment.find(".comment").length);
        });
        $('.hideComment').click(function () {
            const comment = $(this).closest(".comment");
            const shownComment = comment.find("> .shown-comment");
            const hiddenComment = comment.find("> .hidden-comment");
            shownComment.hide();
            hiddenComment.show();
            shownComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(hiddenComment.find(commentVoteFrameHolderSelector));
            return false;
        });
        $('.showComment').click(function () {
            const comment = $(this).closest(".comment");
            const hiddenComment = comment.find("> .hidden-comment");
            const shownComment = comment.find("> .shown-comment");
            hiddenComment.hide();
            shownComment.show();
            hiddenComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(shownComment.find(commentVoteFrameHolderSelector));
            return false;
        });
    </script>



    <script>
        function adjustTopicComplainFrames() {
            let topicIds = [];

            $(".has-topic-id").each(function () {
                const $this = $(this);
                const topicId = $this.attr("topicId");
                if (topicId) {
                    topicIds.push(topicId);
                }
            });

            $.post("/data/topics", {
                action: "findComplainableTopicIds",
                topicIds: topicIds.join(",")
            }, function (json) {
                if (json["success"] === "true") {
                    for (const topicId of json["complainableTopicIds"].split(",")) {
                        $(".has-topic-id[topicId=" + topicId + "]").each(function () {
                            $(this).find(".meta .ComplaintFrame").css("display", "inline-block");
                        });
                    }
                }
            }, "json");
        }

        function updateTopicVote(topicId, voteDirection, processed) {
            let ratingElement = $(".topic-rating-" + topicId);
            let newRating = parseInt(ratingElement.attr("data-rawRating"));
            if (!processed) newRating += voteDirection;
            if (newRating > 0) {
                ratingElement.text("+" + newRating.toString());
                ratingElement.css("color", "green");
            } else {
                ratingElement.text(newRating.toString());
                ratingElement.css("color", "gray");
            }
            let voteUpImg = $(".topic-vote-up-" + topicId + " img");
            voteUpImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === 1 ? "images/actions/voteup-voted.png" : "images/actions/voteup-gray.png"));
            voteUpImg.attr("title", voteDirection === 1 ? "Cancel vote" : "Vote: I like it");
            let voteDownImg = $(".topic-vote-down-" + topicId + " img");
            voteDownImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === -1 ? "images/actions/votedown-voted.png" : "images/actions/votedown-gray.png"));
            voteDownImg.attr("title", voteDirection === -1 ? "Cancel vote" : "Vote: I do not like it");
        }

        function getMyVotes() {
            let topicIds = [];
            $(".topic-rating").each(function () {
                topicIds.push($(this).attr("data-topicId"))
            });
            $.post("/data/topic/vote", {
                topicIds: topicIds.join(","),
                _tta: Codeforces.tta(),
                action: "getMyVotes"
            }, function (data) {
                if (data.success === "true") {
                    votes = JSON.parse(data.votes);
                    for (const vote of votes) {
                        updateTopicVote(vote.topicId, vote.direction, vote.processed);
                    }
                }
            }, "json");
        }

        $(function () {
        });
    </script>

<script type="text/javascript">
    $(document).ready(function () {
        let voteDirection = 0;

        function clickVote(direction) {
            if (direction === voteDirection) {
                direction = 0;
            }
            $.post("/data/topic/vote", {
                topicId: 147629,
                _tta: Codeforces.tta(),
                topicRevisionId: 408881,
                vote: direction,
            }, function (data) {
                if (data.success === "true") {
                    voteDirection = parseInt(data.voteDirection);
                    updateTopicVote(147629, voteDirection, data.processed === "true");
                }
                Codeforces.showMessage(data.message);
            }, "json");
        }

        $(".topic-vote-up-147629").click(function () {
            clickVote(+1);
            return false;
        });
        $(".topic-vote-down-147629").click(function () {
            clickVote(-1);
            return false;
        });
    });
</script></div>

    <script>
        $(function () {
            $(".topic-action-a").click(function () {
                const action = $(this).data("action");
                const topicTitle = $(this).data("topic-title");

                if (confirm("Are you sure you want to perform the action '" + action.toUpperCase()
                        + "' on the topic '" + topicTitle + "'?")) {
                    const topicId = $(this).data("topic-id");
                    const locale = $(this).data("topic-locale");
                    $.post("/data/topic", {action, topicId, locale}, function (json) {
                        Codeforces.reloadAndShowMessageOrShowError(json, json["message"]);
                    });
                }

                return false;
            });
        });
    </script>
        </div>
    </div>
                </div>
        </div>
            <br style="clear: both;">
            <div id="footer">
                <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2025 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: Dec/14/2025 11:41:14<sup title="timezone offset" style="font-size:8px;">UTC</sup> (l3).</div>
                    <div>Desktop version, switch to <a rel="nofollow" class="switchToMobile" href="?mobile=true">mobile version</a>.</div>
                <div class="smaller">
                    <a href="/privacy">Privacy Policy</a>
                    |
                    <a href="/terms">Terms and Conditions</a>
                </div>

                    <div style="margin-top: 25px;">
                        Supported by
                    </div>
                    <div class="footer-logo-div" style="left: 30px;">
                        <a href="https://ton.org/"><img style="margin-right: 2em; width: 60px;" src="//codeforces.com/codeforces.org/s/52448/images/ton-100x100.png" alt="TON" title="TON"></a>
                        <div class="sep">&nbsp;</div>
                        <a href="https://en.itmo.ru/en/" class="itmo-logo"><img style="width: 140px;" src="//codeforces.com/codeforces.org/s/52448/images/itmo_small_en-logo.png" alt="ITMO University" title="ITMO University"></a>
                    </div>

            </div>
        <script type="text/javascript">
            $(function() {
                $(".switchToMobile").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "true"));
                    return false;
                });
                $(".switchToDesktop").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "false"));
                    return false;
                });
            });
        </script>
    <script type="text/javascript">
        $(document).ready(function () {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function () {
                    $(this).animate({
                        'opacity':'1'
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function () {
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }

            Codeforces.focusOnError();

            Codeforces.setCopiedToClipboardText("Copied to clipboard");
            Codeforces.listenCopyable();
        });
    </script>
    <div class="userListsFacebox" style="display:none;">
        <div style="padding: 0.5em; width: 600px; max-height: 200px; overflow-y: auto">
<div class="datatable" style="background-color: #E1E1E1; padding-bottom: 3px;">
            <div class="lt">&nbsp;</div>
            <div class="rt">&nbsp;</div>
            <div class="lb">&nbsp;</div>
            <div class="rb">&nbsp;</div>

            <div style="padding: 4px 0 0 6px;font-size:1.4rem;position:relative;">
                User lists

                <div style="position:absolute;right:0.25em;top:0.35em;">
                    <span style="padding:0;position:relative;bottom:2px;" class="rowCount"></span>

                    <img class="closed" src="//codeforces.com/codeforces.org/s/52448/images/icons/magnifier-medium.png">

                    <span class="filter" style="display:none;">
                        <img class="opened" src="//codeforces.com/codeforces.org/s/52448/images/icons/control-270.png">
                        <input style="padding:0 0 0 20px;position:relative;bottom:2px;border:1px solid #aaa;height:17px;font-size:1.3rem;">
                    </span>
                </div>
            </div>
            <div style="background-color: white;margin:0.3em 3px 0 3px;position:relative;">
            <div class="ilt">&nbsp;</div>
            <div class="irt">&nbsp;</div>
            <table class="">
                <thead>
                <tr>
                    <th draggable="true" class="top left right">Name</th>
                </tr>
                </thead>
                <tbody>
                <tr class="no-items visible"><td style="text-align:left;" colspan="32" class="bottom dark left right">No items</td></tr></tbody>
            </table>
            </div>
        </div>
    <script type="text/javascript">
        $(document).ready(function () {
                // Create new ':containsIgnoreCase' selector for search
                jQuery.expr[':'].containsIgnoreCase = function(a, i, m) {
                    return jQuery(a).text().toUpperCase()
                            .indexOf(m[3].toUpperCase()) >= 0;
                };

                if (window.updateDatatableFilter == undefined) {
                    window.updateDatatableFilter = function(i) {
                        var parent = $(i).parent().parent().parent().parent();
                        $("tr.no-items", parent).remove();
                        $("tr", parent).hide().removeClass('visible');
                        var text = $(i).val();
                        if (text) {
                            $("tr" + ":containsIgnoreCase('" + text + "')", parent).show().addClass('visible');
                        } else {
                            parent.find(".rowCount").text("");
                            $("tr", parent).show().addClass('visible');
                        }

                        var found = false;
                        var visibleRowCount = 0;
                        $("tr", parent).each(function () {
                            if (!found) {
                                if ($(this).find("th").size() > 0) {
                                    $(this).show().addClass('visible');
                                    found = true;
                                }
                            }
                            if ($(this).hasClass('visible')) {
                                visibleRowCount++;
                            }
                        });
                        if (text) {
                            parent.find(".rowCount").text("Matches: " + (visibleRowCount - (found ? 1 : 0)));
                        }
                        if (visibleRowCount == (found ? 1 : 0)) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo($(parent).find('table'));
                        }
                        $(parent).find("tr td").removeClass("dark");
                        $(parent).find("tr.visible:odd td").addClass("dark");
                    }

                    $(".datatable .closed").click(function () {
                        var parent = $(this).parent();
                        $(this).hide();
                        $(".filter", parent).fadeIn(function () {
                            $("input", parent).val("").focus().css("border", "1px solid #aaa");
                        });
                    });

                    $(".datatable .opened").click(function () {
                        var parent = $(this).parent().parent();
                        $(".filter", parent).fadeOut(function () {
                            $(".closed", parent).show();
                            $("input", parent).val("").each(function () {
                                window.updateDatatableFilter(this);
                            });
                        });
                    });

                    $(".datatable .filter input").keyup(function(e) {
                        window.updateDatatableFilter(this);
                        e.preventDefault();
                        e.stopPropagation();
                    });

                    $(".datatable table").each(function () {
                        var found = false;
                        $("tr", this).each(function () {
                            if (!found && $(this).find("th").size() == 0) {
                                found = true;
                            }
                        });
                        if (!found) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo(this);
                        }
                    });

                    // Applies styles to datatables.
                    $(".datatable").each(function () {
                        $(this).find("tr:first th").addClass("top");
                        $(this).find("tr:last td").addClass("bottom");
                        $(this).find("tr:odd td").addClass("dark");
                        $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                        $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                    });

                    $(".datatable table.tablesorter").each(function () {
                        $(this).bind("sortEnd", function () {
                            $(".datatable").each(function () {
                                $(this).find("th, td")
                                    .removeClass("top").removeClass("bottom")
                                    .removeClass("left").removeClass("right")
                                    .removeClass("dark");
                                $(this).find("tr:first th").addClass("top");
                                $(this).find("tr:last td").addClass("bottom");
                                $(this).find("tr:odd td").addClass("dark");
                                $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                                $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                            });
                        });
                    });
                }
        });
    </script>
        </div>
    </div>
    <script type="application/javascript">
        $(function() {
            $(".userListMarker").click(function() {
                $.post("/data/lists", {action: "findTouched"}, function(json) {
                    Codeforces.facebox(".userListsFacebox");
                    var tbody = $("#facebox tbody");
                    tbody.empty();
                    for (var i in json) {
                        tbody.append(
                            $("<tr></tr>").append(
                                $("<td></td>").attr("data-readKey", json[i].readKey).text(json[i].name)
                            )
                        );
                    }
                    Codeforces.updateDatatables();
                    tbody.find("td").css("cursor", "pointer").click(function() {
                        document.location = Codeforces.updateUrlParameter(document.location.href, "list", $(this).attr("data-readKey"));
                    });
                }, "json");
            });
        });
    </script>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-52448.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9add6e53aa6e8f94',t:'MTc2NTcxMjQ3NA=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;version&quot;:&quot;2024.11.0&quot;,&quot;token&quot;:&quot;316c29dfa3804effb5a91c52a59b5bd0&quot;,&quot;server_timing&quot;:{&quot;name&quot;:{&quot;cfCacheStatus&quot;:true,&quot;cfEdge&quot;:true,&quot;cfExtPri&quot;:true,&quot;cfL4&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfSpeedBrain&quot;:true},&quot;location_startswith&quot;:null}}" crossorigin="anonymous"></script>


<div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div id="swfcontainer" style="visibility: visible;"></div><div id="userdata_el" style="visibility: hidden; position: absolute;"></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size4, sans-serif;"></div></div></body></html>