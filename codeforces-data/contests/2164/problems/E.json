{
  "contestId": 2164,
  "index": "E",
  "title": "Journey",
  "timeLimit": "3 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 2300,
  "tags": [
    "data structures",
    "dfs and similar",
    "dsu",
    "graphs",
    "greedy"
  ],
  "statementHtml": "<p>You are on an undirected connected graph of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-1\">n</script> vertices and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-4\">m</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-4\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mi\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Math-italic;\">m</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-2\">m</script> weighted edges. The edges are indexed from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-5\"><span class=\"MJXp-mn\" id=\"MJXp-Span-6\">1</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-7\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-8\"><span class=\"mn\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Main;\">1</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-3\">1</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-7\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-8\">m</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-10\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-11\"><span class=\"mi\" id=\"MathJax-Span-12\" style=\"font-family: MathJax_Math-italic;\">m</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-4\">m</script>. The <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-9\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-10\">i</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-13\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-14\"><span class=\"mi\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Math-italic;\">i</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-5\">i</script>-th edge connects vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-11\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-12\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-13\" style=\"margin-right: 0.05em;\">u</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-14\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-16\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-17\"><span class=\"msubsup\" id=\"MathJax-Span-18\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-19\" style=\"font-family: MathJax_Math-italic;\">u</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-20\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-6\">u_i</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-15\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-16\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-17\" style=\"margin-right: 0.05em;\">v</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-18\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-21\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-22\"><span class=\"msubsup\" id=\"MathJax-Span-23\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-24\" style=\"font-family: MathJax_Math-italic;\">v</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-25\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-7\">v_i</script>, and has weight <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-19\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-20\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-21\" style=\"margin-right: 0.05em;\">w</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-22\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-26\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-27\"><span class=\"msubsup\" id=\"MathJax-Span-28\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.71em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-29\" style=\"font-family: MathJax_Math-italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.706em;\"><span class=\"mi\" id=\"MathJax-Span-30\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-8\">w_i</script>. You decided to take a wonderful journey around the graph.</p>\n<p>Suppose you are at vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-23\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-24\">x</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-31\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-32\"><span class=\"mi\" id=\"MathJax-Span-33\" style=\"font-family: MathJax_Math-italic;\">x</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-9\">x</script>. You can do the following operations any number of times: </p>\n<p>You are now at vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-132\"><span class=\"MJXp-mn\" id=\"MJXp-Span-133\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-25\">1</script>, and you need to <span class=\"tex-font-style-it\">mark</span> every edge at least once and return to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-134\"><span class=\"MJXp-mn\" id=\"MJXp-Span-135\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-26\">1</script>. Calculate the minimum cost.</p>\n<p><span class=\"tex-font-style-bf\">Please note the cost for <span class=\"tex-font-style-it\">transferring</span> is not the maximum weight on the path, nor the maximum index itself. If you have any questions, refer to the <span class=\"tex-font-style-it\">Note</span> section below.</span></p>",
  "inputSpecHtml": "<p>Each test contains multiple test cases. The first line contains the number of test cases <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-136\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-137\">T</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-27\">T</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-138\"><span class=\"MJXp-mn\" id=\"MJXp-Span-139\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-140\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-141\">T</span><span class=\"MJXp-mo\" id=\"MJXp-Span-142\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-143\"><span class=\"MJXp-mn\" id=\"MJXp-Span-144\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-145\" style=\"vertical-align: 0.5em;\">4</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-28\">1 \\le T \\le 10^4</script>). The description of the test cases follows. </p><p>The first line of each test case contains two integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-146\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-147\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-29\">n</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-148\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-149\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-30\">m</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-150\"><span class=\"MJXp-mn\" id=\"MJXp-Span-151\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-152\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-153\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-154\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-155\"><span class=\"MJXp-mn\" id=\"MJXp-Span-156\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-157\" style=\"vertical-align: 0.5em;\">6</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-31\">1 \\le n \\le 10^6</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-158\"><span class=\"MJXp-mn\" id=\"MJXp-Span-159\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-160\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-161\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-162\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-163\"><span class=\"MJXp-mn\" id=\"MJXp-Span-164\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-165\" style=\"vertical-align: 0.5em;\">6</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-32\">0 \\le m \\le 10^6</script>).</p><p>Then <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-166\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-167\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-33\">m</script> lines, the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-168\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-169\">i</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-34\">i</script>-th line contains three integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-170\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-171\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-172\" style=\"margin-right: 0.05em;\">u</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-173\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-174\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-175\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-176\" style=\"margin-right: 0.05em;\">v</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-177\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-178\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-179\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-180\" style=\"margin-right: 0.05em;\">w</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-181\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-35\">u_i, v_i, w_i</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-182\"><span class=\"MJXp-mn\" id=\"MJXp-Span-183\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-184\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-185\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-186\" style=\"margin-right: 0.05em;\">u</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-187\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-188\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-189\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-190\" style=\"margin-right: 0.05em;\">v</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-191\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-192\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-193\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-36\">1 \\le u_i, v_i \\le n</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-194\"><span class=\"MJXp-mn\" id=\"MJXp-Span-195\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-196\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-197\">w</span><span class=\"MJXp-mo\" id=\"MJXp-Span-198\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-199\"><span class=\"MJXp-mn\" id=\"MJXp-Span-200\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-201\" style=\"vertical-align: 0.5em;\">9</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-37\">1 \\le w \\le 10^9</script>) — meaning that the edge with index <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-202\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-203\">i</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-38\">i</script> is between vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-204\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-205\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-206\" style=\"margin-right: 0.05em;\">u</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-207\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-39\">u_i</script> and vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-208\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-209\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-210\" style=\"margin-right: 0.05em;\">v</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-211\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-40\">v_i</script> with weight <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-212\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-213\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-214\" style=\"margin-right: 0.05em;\">w</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-215\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-41\">w_i</script>.</p><p>It's guaranteed that the described graph is connected.</p><p>Also note that the graph may have <span class=\"tex-font-style-bf\">self-loops</span> and <span class=\"tex-font-style-bf\">multiple edges</span>.</p><p>It is guaranteed that the sums of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-216\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-217\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-42\">n</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-218\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-219\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-43\">m</script> over all test cases do not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-220\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-221\"><span class=\"MJXp-mn\" id=\"MJXp-Span-222\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-223\" style=\"vertical-align: 0.5em;\">6</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-44\">10^6</script> each.</p>",
  "outputSpecHtml": "<p>For each test case output one integer — the minimum cost.</p>",
  "noteHtml": "<p><a href=\"https://codeforces.com/assets/contests/2164/E_ooxathoosh9Oob4quoiv.html\">Visualizer link</a></p><p>Let <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-224\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-225\">u</span><span class=\"MJXp-munderover\" id=\"MJXp-Span-226\"><span><span class=\"MJXp-over\"><span class=\" MJXp-script\"><span class=\"MJXp-mpadded\" id=\"MJXp-Span-228\" style=\"vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;\"><span class=\"MJXp-box\" style=\"margin: -0.15em 0.333em 0.15em 0.278em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-229\">e</span></span></span></span><span class=\"\"><span class=\"MJXp-mo\" id=\"MJXp-Span-227\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">→</span></span></span></span></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-230\">v</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-45\">u \\xrightarrow{e} v</script> denote going to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-231\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-232\">v</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-46-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-46\">v</script> from vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-233\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-234\">u</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-47-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-47\">u</script> by edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-235\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-236\">e</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-48-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-48\">e</script>. </p><p>In the first test case, one possible solution is:</p><ol> <li> Initially, you are at vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-237\"><span class=\"MJXp-mn\" id=\"MJXp-Span-238\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-49-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-49\">1</script>. </li><li> Mark edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-239\"><span class=\"MJXp-mn\" id=\"MJXp-Span-240\">3</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-50-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-50\">3</script> and move to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-241\"><span class=\"MJXp-mn\" id=\"MJXp-Span-242\">3</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-51-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-51\">3</script>, costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-243\"><span class=\"MJXp-mn\" id=\"MJXp-Span-244\">6</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-52-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-52\">6</script>. </li><li> Mark edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-245\"><span class=\"MJXp-mn\" id=\"MJXp-Span-246\">6</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-53-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-53\">6</script> and move to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-247\"><span class=\"MJXp-mn\" id=\"MJXp-Span-248\">4</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-54-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-54\">4</script>, costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-249\"><span class=\"MJXp-mn\" id=\"MJXp-Span-250\">7</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-55-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-55\">7</script>. </li><li> Mark edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-251\"><span class=\"MJXp-mn\" id=\"MJXp-Span-252\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-56-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-56\">1</script> and move to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-253\"><span class=\"MJXp-mn\" id=\"MJXp-Span-254\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-57-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-57\">2</script>, costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-255\"><span class=\"MJXp-mn\" id=\"MJXp-Span-256\">15</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-58-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-58\">15</script>. </li><li> Mark edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-257\"><span class=\"MJXp-mn\" id=\"MJXp-Span-258\">4</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-59-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-59\">4</script> and move to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-259\"><span class=\"MJXp-mn\" id=\"MJXp-Span-260\">3</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-60\">3</script>, costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-261\"><span class=\"MJXp-mn\" id=\"MJXp-Span-262\">9</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-61-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-61\">9</script>. </li><li> Transfer to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-263\"><span class=\"MJXp-mn\" id=\"MJXp-Span-264\">5</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-62-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-62\">5</script>. By choosing path <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-265\"><span class=\"MJXp-mn\" id=\"MJXp-Span-266\">3</span><span class=\"MJXp-munderover\" id=\"MJXp-Span-267\"><span><span class=\"MJXp-over\"><span class=\" MJXp-script\"><span class=\"MJXp-mpadded\" id=\"MJXp-Span-269\" style=\"vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;\"><span class=\"MJXp-box\" style=\"margin: -0.15em 0.333em 0.15em 0.278em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-270\">6</span></span></span></span><span class=\"\"><span class=\"MJXp-mo\" id=\"MJXp-Span-268\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">→</span></span></span></span></span><span class=\"MJXp-mn\" id=\"MJXp-Span-271\">4</span><span class=\"MJXp-munderover\" id=\"MJXp-Span-272\"><span><span class=\"MJXp-over\"><span class=\" MJXp-script\"><span class=\"MJXp-mpadded\" id=\"MJXp-Span-274\" style=\"vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;\"><span class=\"MJXp-box\" style=\"margin: -0.15em 0.333em 0.15em 0.278em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-275\">1</span></span></span></span><span class=\"\"><span class=\"MJXp-mo\" id=\"MJXp-Span-273\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">→</span></span></span></span></span><span class=\"MJXp-mn\" id=\"MJXp-Span-276\">2</span><span class=\"MJXp-munderover\" id=\"MJXp-Span-277\"><span><span class=\"MJXp-over\"><span class=\" MJXp-script\"><span class=\"MJXp-mpadded\" id=\"MJXp-Span-279\" style=\"vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;\"><span class=\"MJXp-box\" style=\"margin: -0.15em 0.333em 0.15em 0.278em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-280\">2</span></span></span></span><span class=\"\"><span class=\"MJXp-mo\" id=\"MJXp-Span-278\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">→</span></span></span></span></span><span class=\"MJXp-mn\" id=\"MJXp-Span-281\">5</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-63-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-63\">3 \\xrightarrow{6} 4 \\xrightarrow{1} 2 \\xrightarrow{2} 5</script>, we can achieve cost <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-282\"><span class=\"MJXp-mn\" id=\"MJXp-Span-283\">7</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-64-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-64\">7</script>, since the maximum index among the edges on the path is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-284\"><span class=\"MJXp-mn\" id=\"MJXp-Span-285\">6</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-65-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-65\">6</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-286\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-287\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-288\" style=\"margin-right: 0.05em;\">w</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-289\" style=\"vertical-align: -0.4em;\">6</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-290\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-291\">7</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-66-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-66\">w_6 = 7</script>. <span class=\"tex-font-style-bf\">Note that we don't care about the maximum weight on the path when using operation 2.</span> </li><li> Mark edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-292\"><span class=\"MJXp-mn\" id=\"MJXp-Span-293\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-67-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-67\">2</script> and move to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-294\"><span class=\"MJXp-mn\" id=\"MJXp-Span-295\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-68-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-68\">2</script>, costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-296\"><span class=\"MJXp-mn\" id=\"MJXp-Span-297\">4</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-69-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-69\">4</script>. </li><li> Mark edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-298\"><span class=\"MJXp-mn\" id=\"MJXp-Span-299\">5</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-70-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-70\">5</script> and move to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-300\"><span class=\"MJXp-mn\" id=\"MJXp-Span-301\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-71-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-71\">1</script>, costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-302\"><span class=\"MJXp-mn\" id=\"MJXp-Span-303\">10</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-72-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-72\">10</script>. </li></ol><p>The total cost is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-304\"><span class=\"MJXp-mn\" id=\"MJXp-Span-305\">6</span><span class=\"MJXp-mo\" id=\"MJXp-Span-306\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-307\">7</span><span class=\"MJXp-mo\" id=\"MJXp-Span-308\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-309\">15</span><span class=\"MJXp-mo\" id=\"MJXp-Span-310\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-311\">9</span><span class=\"MJXp-mo\" id=\"MJXp-Span-312\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-313\">7</span><span class=\"MJXp-mo\" id=\"MJXp-Span-314\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-315\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-316\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-317\">10</span><span class=\"MJXp-mo\" id=\"MJXp-Span-318\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-319\">58</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-73-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-73\">6+7+15+9+7+4+10=58</script>.</p><p>In the second test case, one possible solution is:</p><ol> <li> Mark edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-320\"><span class=\"MJXp-mn\" id=\"MJXp-Span-321\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-74-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-74\">1</script> and move to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-322\"><span class=\"MJXp-mn\" id=\"MJXp-Span-323\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-75-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-75\">2</script>, costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-324\"><span class=\"MJXp-mn\" id=\"MJXp-Span-325\">3</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-76-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-76\">3</script>. </li><li> Transfer to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-326\"><span class=\"MJXp-mn\" id=\"MJXp-Span-327\">3</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-77-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-77\">3</script> by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-328\"><span class=\"MJXp-mn\" id=\"MJXp-Span-329\">2</span><span class=\"MJXp-munderover\" id=\"MJXp-Span-330\"><span><span class=\"MJXp-over\"><span class=\" MJXp-script\"><span class=\"MJXp-mpadded\" id=\"MJXp-Span-332\" style=\"vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;\"><span class=\"MJXp-box\" style=\"margin: -0.15em 0.333em 0.15em 0.278em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-333\">1</span></span></span></span><span class=\"\"><span class=\"MJXp-mo\" id=\"MJXp-Span-331\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">→</span></span></span></span></span><span class=\"MJXp-mn\" id=\"MJXp-Span-334\">1</span><span class=\"MJXp-munderover\" id=\"MJXp-Span-335\"><span><span class=\"MJXp-over\"><span class=\" MJXp-script\"><span class=\"MJXp-mpadded\" id=\"MJXp-Span-337\" style=\"vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;\"><span class=\"MJXp-box\" style=\"margin: -0.15em 0.333em 0.15em 0.278em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-338\">3</span></span></span></span><span class=\"\"><span class=\"MJXp-mo\" id=\"MJXp-Span-336\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">→</span></span></span></span></span><span class=\"MJXp-mn\" id=\"MJXp-Span-339\">4</span><span class=\"MJXp-munderover\" id=\"MJXp-Span-340\"><span><span class=\"MJXp-over\"><span class=\" MJXp-script\"><span class=\"MJXp-mpadded\" id=\"MJXp-Span-342\" style=\"vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;\"><span class=\"MJXp-box\" style=\"margin: -0.15em 0.333em 0.15em 0.278em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-343\">3</span></span></span></span><span class=\"\"><span class=\"MJXp-mo\" id=\"MJXp-Span-341\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">→</span></span></span></span></span><span class=\"MJXp-mn\" id=\"MJXp-Span-344\">1</span><span class=\"MJXp-munderover\" id=\"MJXp-Span-345\"><span><span class=\"MJXp-over\"><span class=\" MJXp-script\"><span class=\"MJXp-mpadded\" id=\"MJXp-Span-347\" style=\"vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;\"><span class=\"MJXp-box\" style=\"margin: -0.15em 0.333em 0.15em 0.278em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-348\">2</span></span></span></span><span class=\"\"><span class=\"MJXp-mo\" id=\"MJXp-Span-346\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">→</span></span></span></span></span><span class=\"MJXp-mn\" id=\"MJXp-Span-349\">3</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-78-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-78\">2 \\xrightarrow{1} 1 \\xrightarrow{3} 4 \\xrightarrow{3} 1 \\xrightarrow{2} 3</script>, costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-350\"><span class=\"MJXp-mn\" id=\"MJXp-Span-351\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-79-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-79\">1</script>. <span class=\"tex-font-style-bf\">Note the path chosen in operation 2 may not be simple.</span> </li><li> Mark edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-352\"><span class=\"MJXp-mn\" id=\"MJXp-Span-353\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-80-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-80\">2</script> and move to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-354\"><span class=\"MJXp-mn\" id=\"MJXp-Span-355\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-81-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-81\">1</script>, costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-356\"><span class=\"MJXp-mn\" id=\"MJXp-Span-357\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-82-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-82\">2</script>. </li><li> Mark edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-358\"><span class=\"MJXp-mn\" id=\"MJXp-Span-359\">3</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-83-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-83\">3</script> and move to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-360\"><span class=\"MJXp-mn\" id=\"MJXp-Span-361\">4</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-84-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-84\">4</script>, costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-362\"><span class=\"MJXp-mn\" id=\"MJXp-Span-363\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-85-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-85\">1</script>. </li><li> Transfer to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-364\"><span class=\"MJXp-mn\" id=\"MJXp-Span-365\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-86-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-86\">1</script> by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-366\"><span class=\"MJXp-mn\" id=\"MJXp-Span-367\">4</span><span class=\"MJXp-munderover\" id=\"MJXp-Span-368\"><span><span class=\"MJXp-over\"><span class=\" MJXp-script\"><span class=\"MJXp-mpadded\" id=\"MJXp-Span-370\" style=\"vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;\"><span class=\"MJXp-box\" style=\"margin: -0.15em 0.333em 0.15em 0.278em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-371\">3</span></span></span></span><span class=\"\"><span class=\"MJXp-mo\" id=\"MJXp-Span-369\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">→</span></span></span></span></span><span class=\"MJXp-mn\" id=\"MJXp-Span-372\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-87-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-87\">4 \\xrightarrow{3} 1</script>, costs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-373\"><span class=\"MJXp-mn\" id=\"MJXp-Span-374\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-88-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-88\">1</script>. </li></ol>",
  "samples": [
    {
      "input": "55 62 4 152 5 41 3 62 3 91 2 103 4 74 31 2 31 3 21 4 12 31 2 12 1 31 1 46 62 3 101 3 105 6 106 6 14 5 103 4 105 51 2 45 1 54 3 62 4 101 4 7",
      "output": "58887143"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2164/problem/E",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>Since we need to <span class=\"tex-font-style-it\">mark</span> every edge at least once, the minimum cost is $$$\\sum_{i=1}^m w_i$$$. In fact, if the graph has an Eulerian circuit (i.e. every vertex has an even degree), this minimum cost can be achieved by simply traversing on such a circuit. Otherwise, we can imagine we add some \"virtual\" edges to this graph, where the cost of such an edge is the minimum cost of transferring between its two endpoints. It's not hard to show that we only need to pair up all the vertices with odd degree and add exactly one \"virtual\" edge between each pair, which is optimal. Further, we only need to calculate the minimum cost of adding those \"virtual\" edges.</p><p>Consider how to effectively calculate the cost of <span class=\"tex-font-style-it\">transferring</span>. Build a reconstruction-tree $$$T$$$ of G, where edges $$$1 \\ldots m$$$ are added in this order.</p><p>Suppose we want to transfer to $$$v$$$ from $$$u$$$. If the LCA of $$$u$$$ and $$$v$$$ is $$$o$$$, then the edge with the maximum index on every possible path from $$$u$$$ to $$$v$$$ should be $$$o$$$, or one of the ancestors of $$$o$$$. This is because of the basic properties of a reconstruction tree.</p><p>So for every vertex $$$i$$$ on $$$T$$$ which is not a leaf (i.e. it represents an edge in the original graph), precompute the minimum weight, $$$f_i$$$, among every edge that is $$$i$$$ or $$$i$$$'s ancestor. Now we have $$$f_i \\le f_{fa_i}$$$, which means it is optimal to pair up two vertices in the same subtree $$$p$$$ with cost $$$f_p$$$ as soon as possible. </p><p>In particular, perform a depth-first search on the tree. For every vertex $$$x$$$, enumerate its every child $$$y$$$ and recursively determine whether a leave (i.e. it represents a vertex in the original graph) in the subtree of $$$y$$$ with odd degree (in the original graph) remains unmatched. Match these vertices using cost $$$f_x$$$ immediately when possible. In the end at most one leaf (with odd degree) in the subtree of $$$x$$$ will remain unmatched when we leave $$$x$$$.</p><p>Implement this greedy approach and you will pass this problem. Time complexity is $$$O(n \\alpha(n))$$$ (since we need union find when building the reconstruction-tree) and space complexity is $$$O(n)$$$.</p></div></div></div></div>"
}