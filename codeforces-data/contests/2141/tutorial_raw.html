<html lang="en"><head>
        <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-K230KVN22K&amp;cx=c&amp;gtm=4e5ca1"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="0c368091a02c4475c4e229a2598e6ac6">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01">
    <meta name="robots" content="noai">
    <meta name="robots" content="noimageai">

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="l3">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <link rel="image_src" href="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <meta property="og:title" content="Kotlin Heroes 13 Editorial - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>Kotlin Heroes 13 Editorial - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/font-awesome.min.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/line-awesome.min.css" type="text/css" charset="utf-8">

        <link rel="preconnect" href="https://challenges.cloudflare.com">
        <link rel="dns-prefetch" href="https://challenges.cloudflare.com">
        <link href="//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">
        <link href="//fonts.googleapis.com/css?family=Cuprum&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.com/codeforces.org/s/52448/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.com/codeforces.org/s/52448/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.com/codeforces.org/s/52448/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.com/codeforces.org/s/52448/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.com/codeforces.org/s/52448/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.com/codeforces.org/s/52448/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.com/codeforces.org/s/52448/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.com/codeforces.org/s/52448/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.com/codeforces.org/s/52448/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="//codeforces.com/codeforces.org/s/52448/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.com/codeforces.org/s/52448/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.com/codeforces.org/s/52448/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.com/codeforces.org/s/52448/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.com/codeforces.org/s/52448/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.jgrowl.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.wysiwyg.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.autocomplete.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/codeforces.datepick.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.drafts.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/community.css" type="text/css" charset="utf-8">

    <!-- MathJax -->
    <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async="" src="https://codeforces.com/mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full">
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/5913b958cb6e1f2144469a313cc0ac6e/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/confetti.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/purify.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/skins/markitup/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/style.css" type="text/css" charset="utf-8">


    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888; display: contents}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css" media="screen">#swfcontainer {visibility:hidden}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.9') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.9') format('opentype')}
</style></head>
<body class=" "><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mo" id="MathJax-Span-3" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-4" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-5" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">p</span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-9"><span class="mn" id="MathJax-Span-10" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">p</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">n</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-15"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-16"><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">n</span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-22" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-24"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-25"><span class="mn" id="MathJax-Span-26" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">p</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">n</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-31"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-35"><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-37" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">n</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-41" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><br><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="munderover" id="MathJax-Span-48" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.41em, 4.602em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.14em, 4.278em, -999.997em); top: -2.919em; left: 0.165em;"><span class="texatom" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-53" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.195em, 1000.65em, 4.494em, -999.997em); top: -5.354em; left: 0.381em;"><span class="texatom" id="MathJax-Span-55"><span class="mrow" id="MathJax-Span-56"><span class="mfrac" id="MathJax-Span-57"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.628em, 1000.27em, 4.169em, -999.997em); top: -4.326em; left: 50%; margin-left: -0.16em;"><span class="mi" id="MathJax-Span-58" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.22em, 4.169em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.106em;"><span class="mn" id="MathJax-Span-59" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1000.44em, 1.247em, -999.997em); top: -1.242em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.436em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mn" id="MathJax-Span-60" style="font-family: MathJax_Main; padding-left: 0.165em;">4</span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.219em;">(</span><span class="mn" id="MathJax-Span-63" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">i</span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><br><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-67"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-68"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.273em;">4</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mfrac" id="MathJax-Span-74" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.322em;"><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.268em;"><span class="mn" id="MathJax-Span-76" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1000.71em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.706em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main; padding-left: 0.219em;">(</span><span class="mfrac" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -4.705em; left: 50%; margin-left: -0.322em;"><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -0.268em;"><span class="mn" id="MathJax-Span-81" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1000.71em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.706em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-83" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main; padding-left: 0.273em;">≈</span><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">n</span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main; padding-left: 0.219em;">(</span><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-91" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">n</span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main; padding-left: 0.219em;">(</span><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-99" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><br><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-104"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-108"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-110"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-111"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-113"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-114"><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-117" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-118"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-119"><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-122" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-123"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-124"><span class="msubsup" id="MathJax-Span-125"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-127" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-128"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-129"><span class="mn" id="MathJax-Span-130" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-131"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-132"><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-134"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-135"><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-138" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-139"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-142"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-143"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-146" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-147"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-148"><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-150"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-153"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-154"><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-156"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-157"><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-162"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-165" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">v</span><span class="mo" id="MathJax-Span-167" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="munderover" id="MathJax-Span-168" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-169" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.49em, 4.169em, -999.997em); top: -4.489em; left: 1.085em;"><span class="texatom" id="MathJax-Span-170"><span class="mrow" id="MathJax-Span-171"><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.25em, 4.169em, -999.997em); top: -3.731em; left: 1.085em;"><span class="texatom" id="MathJax-Span-173"><span class="mrow" id="MathJax-Span-174"><span class="mi" id="MathJax-Span-175" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-176" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-177" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="texatom" id="MathJax-Span-178" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-179"><span class="msubsup" id="MathJax-Span-180"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-182" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-183" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">k</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-185"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mrow" id="MathJax-Span-189" style="padding-left: 0.273em;"><span class="mo" id="MathJax-Span-190" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">⌊</span></span><span class="mfrac" id="MathJax-Span-191"><span style="display: inline-block; position: relative; width: 3.412em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.304em, 1003.3em, 4.386em, -999.997em); top: -4.597em; left: 50%; margin-left: -1.621em;"><span class="mrow" id="MathJax-Span-192"><span class="mi" id="MathJax-Span-193" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-194" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="munderover" id="MathJax-Span-195"><span style="display: inline-block; position: relative; width: 1.626em; height: 0px;"><span style="position: absolute; clip: rect(3.304em, 1000.71em, 4.332em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-196" style="font-size: 70.7%; font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.628em, 1000.38em, 4.169em, -999.997em); top: -4.326em; left: 0.76em;"><span class="texatom" id="MathJax-Span-197"><span class="mrow" id="MathJax-Span-198"><span class="mi" id="MathJax-Span-199" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.87em, 4.169em, -999.997em); top: -3.785em; left: 0.76em;"><span class="texatom" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-203" style="font-size: 50%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-204" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="texatom" id="MathJax-Span-205" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-206"><span class="msubsup" id="MathJax-Span-207"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-208" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.381em;"><span class="mi" id="MathJax-Span-209" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.44em, 4.169em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.214em;"><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1003.41em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.412em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="mo" id="MathJax-Span-211" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">⌋</span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-212"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-213"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-215"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-216"><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-218"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-219"><span class="msubsup" id="MathJax-Span-220"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-223"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-224"><span class="msubsup" id="MathJax-Span-225"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mn" id="MathJax-Span-227" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-229" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mn" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="msubsup" id="MathJax-Span-235" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-237" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-238"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-239"><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-241" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-242" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">v</span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-244" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-247"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-248"><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Main;">min</span><span class="texatom" id="MathJax-Span-250" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-251"><span class="msubsup" id="MathJax-Span-252"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-255"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-256"><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-258"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-259"><span class="mo" id="MathJax-Span-260" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main;">min</span><span class="texatom" id="MathJax-Span-262" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-263"><span class="msubsup" id="MathJax-Span-264"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-265" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-266" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-268" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Main; padding-left: 0.165em;">(</span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main;">min</span><span class="texatom" id="MathJax-Span-273" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-274"><span class="msubsup" id="MathJax-Span-275"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-277" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-279" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span><span class="mo" id="MathJax-Span-280" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main; padding-left: 0.165em;">(</span><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-287" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-289"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-290"><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-292"><span class="mtext" id="MathJax-Span-293" style="font-family: MathJax_Main;">number of minimums in&nbsp;</span><span class="texatom" id="MathJax-Span-294"><span class="mrow" id="MathJax-Span-295"></span></span><span class="texatom" id="MathJax-Span-296"><span class="mrow" id="MathJax-Span-297"><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math-italic;">a</span></span></span><span class="texatom" id="MathJax-Span-299"><span class="mrow" id="MathJax-Span-300"></span></span></span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main; padding-left: 0.219em;">(</span><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main; padding-left: 0.219em;">min</span><span class="texatom" id="MathJax-Span-307" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-308"><span class="msubsup" id="MathJax-Span-309"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-313" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-314" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-315"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-316"><span class="msubsup" id="MathJax-Span-317"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-320"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-324"><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-326" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">v</span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Size1; vertical-align: 0em; padding-left: 0.219em;">∑</span><span class="texatom" id="MathJax-Span-330" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-331"><span class="msubsup" id="MathJax-Span-332"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-334" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-335"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-336"><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-341"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-342"><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main; padding-left: 0.273em;">min</span><span class="texatom" id="MathJax-Span-346" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-347"><span class="msubsup" id="MathJax-Span-348"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-350" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-351"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-352"><span class="mn" id="MathJax-Span-353" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-354"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-355"><span class="msubsup" id="MathJax-Span-356"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-357" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-359"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-360"><span class="mi" id="MathJax-Span-361" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-45-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-362"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-363"><span class="msubsup" id="MathJax-Span-364"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-365" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-46-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-367"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-368"><span class="msubsup" id="MathJax-Span-369"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-370" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-371" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-373" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-47-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-374"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-375"><span class="msubsup" id="MathJax-Span-376"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-377" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-378" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-48-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-379"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-380"><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-49-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-382"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-383"><span class="mn" id="MathJax-Span-384" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-50-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-385"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-386"><span class="mn" id="MathJax-Span-387" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-51-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-388"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-52-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-391"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-53-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-394"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-395"><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-54-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-397"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-398"><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-55-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-400"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-401"><span class="msubsup" id="MathJax-Span-402"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mn" id="MathJax-Span-404" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-406" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mn" id="MathJax-Span-408" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-409" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="msubsup" id="MathJax-Span-412" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-414" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-56-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-415"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-416"><span class="msubsup" id="MathJax-Span-417"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-57-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-420"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-58-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-423"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-424"><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-59-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-426"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-427"><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-60-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-429"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-430"><span class="mn" id="MathJax-Span-431" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-61-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-432"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-433"><span class="mn" id="MathJax-Span-434" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-62-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-435"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-436"><span class="mn" id="MathJax-Span-437" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-63-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-438"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-439"><span class="mi" id="MathJax-Span-440" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-64-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-441"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-442"><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-65-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-445"><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-66-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-447"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-448"><span class="mn" id="MathJax-Span-449" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-67-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-450"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-451"><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-68-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-453"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-454"><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-458" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-69-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-460"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-461"><span class="mi" id="MathJax-Span-462" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-463" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-464"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-465" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.598em;"><span class="mn" id="MathJax-Span-466" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-467" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-70-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-468"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-469"><span class="mi" id="MathJax-Span-470" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-471" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-71-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-474"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-475"><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-72-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-477"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-478"><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-73-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-480"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-481"><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-74-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-483"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-484"><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-75-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-486"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-487"><span class="mo" id="MathJax-Span-488" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span class="msubsup" id="MathJax-Span-489" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-491" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">n</span><span class="mo" id="MathJax-Span-494" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mn" id="MathJax-Span-495" style="font-family: MathJax_Main; padding-left: 0.273em;">2</span><span class="mi" id="MathJax-Span-496" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-76-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-497"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-498"><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-77-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-500"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-501"><span class="mi" id="MathJax-Span-502" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-78-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-503"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-79-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-506"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-507"><span class="mi" id="MathJax-Span-508" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-80-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-509"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-510"><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-81-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-512"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-513"><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-82-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-515"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-516"><span class="mn" id="MathJax-Span-517" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-83-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-518"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-519"><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-84-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-521"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-522"><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-85-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-524"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-86-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-527"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-528"><span class="mn" id="MathJax-Span-529" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-87-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-530"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-531"><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-533" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-534" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-88-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-535"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-536"><span class="mi" id="MathJax-Span-537" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-539" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-89-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-540"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-541"><span class="mn" id="MathJax-Span-542" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-90-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-543"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-544"><span class="mi" id="MathJax-Span-545" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-91-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-546"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-547"><span class="mn" id="MathJax-Span-548" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-549" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-92-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-550"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-551"><span class="mn" id="MathJax-Span-552" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-553" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-93-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-554"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-555"><span class="mi" id="MathJax-Span-556" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-558" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-560" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-561" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">m</span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Main; padding-left: 0.165em;">log</span><span class="mo" id="MathJax-Span-564"></span><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">n</span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-94-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-567"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-568"><span class="mi" id="MathJax-Span-569" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-570" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-571"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.598em;"><span class="mn" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-574" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-95-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-575"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-576"><span class="mo" id="MathJax-Span-577" style="font-family: MathJax_Main;">⌈</span><span class="mfrac" id="MathJax-Span-578"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.52em, 1000.6em, 4.169em, -999.997em); top: -4.435em; left: 50%; margin-left: -0.322em;"><span class="mi" id="MathJax-Span-579" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1000.33em, 4.169em, -999.997em); top: -3.623em; left: 50%; margin-left: -0.16em;"><span class="mn" id="MathJax-Span-580" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1000.76em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.76em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="mo" id="MathJax-Span-581" style="font-family: MathJax_Main;">⌉</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-96-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-582"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-583"><span class="mi" id="MathJax-Span-584" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-97-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-585"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-586"><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-98-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-588"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-589"><span class="mo" id="MathJax-Span-590" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-591" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-592" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">b</span><span class="mo" id="MathJax-Span-594" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-99-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-595"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-596"><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-598" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-599" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-600" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-601" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-100-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-602"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-603"><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">c</span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-101-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-609"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-610"><span class="mo" id="MathJax-Span-611" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-612" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-613" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-614" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-615" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-102-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-616"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-617"><span class="mi" id="MathJax-Span-618" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-103-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-619"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-620"><span class="mi" id="MathJax-Span-621" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-104-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-622"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-623"><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic;">c</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-105-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-625"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-626"><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-106-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-629"><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-107-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-631"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-632"><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-108-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-634"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-635"><span class="mi" id="MathJax-Span-636" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-109-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-637"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-638"><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-640"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.52em, 1000.6em, 4.169em, -999.997em); top: -4.435em; left: 50%; margin-left: -0.322em;"><span class="mi" id="MathJax-Span-641" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1000.33em, 4.169em, -999.997em); top: -3.623em; left: 50%; margin-left: -0.16em;"><span class="mn" id="MathJax-Span-642" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1000.76em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.76em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span><span class="mo" id="MathJax-Span-643" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-644" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-645" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mi" id="MathJax-Span-646" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-110-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-647"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-648"><span class="mi" id="MathJax-Span-649" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-111-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-650"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-651"><span class="mi" id="MathJax-Span-652" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-112-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-653"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-654"><span class="msubsup" id="MathJax-Span-655"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-656" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-657"><span class="mrow" id="MathJax-Span-658"><span class="mi" id="MathJax-Span-659" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-660" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-661" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-113-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-662"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-663"><span class="mi" id="MathJax-Span-664" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-114-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-665"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-666"><span class="mi" id="MathJax-Span-667" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-115-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-668"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-669"><span class="msup" id="MathJax-Span-670"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-671" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.598em;"><span class="mo" id="MathJax-Span-672" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="texatom" id="MathJax-Span-673"><span class="mrow" id="MathJax-Span-674"><span class="mi" id="MathJax-Span-675" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-676" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-677" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">k</span><span class="mo" id="MathJax-Span-678" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-679" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">i</span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-116-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-680"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-681"><span class="mi" id="MathJax-Span-682" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-117-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-683"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-684"><span class="mi" id="MathJax-Span-685" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-118-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-686"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-687"><span class="mi" id="MathJax-Span-688" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-119-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-689"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-690"><span class="mi" id="MathJax-Span-691" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-120-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-692"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-693"><span class="msubsup" id="MathJax-Span-694"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-695" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-696"><span class="mrow" id="MathJax-Span-697"><span class="mi" id="MathJax-Span-698" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-699" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-700" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-121-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-701"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-702"><span class="mi" id="MathJax-Span-703" style="font-family: MathJax_Math-italic;">v</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-122-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-704"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-705"><span class="mi" id="MathJax-Span-706" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-123-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-707"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-708"><span class="mn" id="MathJax-Span-709" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-124-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-710"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-711"><span class="mn" id="MathJax-Span-712" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-125-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-713"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-714"><span class="mn" id="MathJax-Span-715" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-126-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-716"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-717"><span class="mn" id="MathJax-Span-718" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-127-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-719"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-720"><span class="mn" id="MathJax-Span-721" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-128-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-722"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-723"><span class="mi" id="MathJax-Span-724" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-129-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-725"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-726"><span class="mn" id="MathJax-Span-727" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-130-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-728"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-729"><span class="mi" id="MathJax-Span-730" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-131-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-731"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-732"><span class="mi" id="MathJax-Span-733" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-132-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-734"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-735"><span class="mn" id="MathJax-Span-736" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-133-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-737"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-738"><span class="mn" id="MathJax-Span-739" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-134-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-740"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-741"><span class="mi" id="MathJax-Span-742" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-135-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-743"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-744"><span class="mn" id="MathJax-Span-745" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-136-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-746"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-747"><span class="mi" id="MathJax-Span-748" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-137-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-749"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-750"><span class="mi" id="MathJax-Span-751" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-138-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-752"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-753"><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-755"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-756" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-757"><span class="mrow" id="MathJax-Span-758"><span class="mi" id="MathJax-Span-759" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-760" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-761" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-139-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-762"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-763"><span class="mi" id="MathJax-Span-764" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-765"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-766" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-767"><span class="mrow" id="MathJax-Span-768"><span class="mi" id="MathJax-Span-769" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-770" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-771" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-140-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-772"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-773"><span class="mn" id="MathJax-Span-774" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-141-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-775"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-776"><span class="mn" id="MathJax-Span-777" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br></div></div><div id="MathJax_Message" style="">Typesetting math: 100%</div><span style="display:none;" class="csrf-token" data-csrf="0c368091a02c4475c4e229a2598e6ac6">&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }, beforeSend: function(jqXHR, settings) {
        const url = new URL(settings.url, window.location.href);
        const urlHref = url.href;
        url.searchParams.set('rv', Math.random().toString(36).substr(2, 9)); // Generate a random value
        settings.url = url.href;
    }});

    window.updateTypography();
    Codeforces.signForms();
    Codeforces.applyDatatableJs("Hold Ctrl+Alt and click to hide column. Also, you can drag&drop columns to reorder them.");

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        if (json.t === "a") {
            setTimeout(function() {
               Codeforces.showAnnouncements(json.d, "en");
            }, Math.random() * 500);
        }
    }

    function showEventCatcherUserMessage(json) {
        if (json.t === "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        const title = $(this).attr("data-title");
        const clazz = $(this).attr("data-clazz");
        const props = {};
        if (typeof (clazz) !== 'undefined') {
            props['clazz'] = clazz;
        }
        if (title) {
            Codeforces.alert(title, null, null, props);
        } else {
            Codeforces.alert($(this).attr("title"), null, null, props);
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
        

<div class="side-bell" style="visibility: hidden; display: none; opacity: 0.7; width: 40px; position: fixed; right: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 1.5rem;">
    <span class="icon-stack" style="width: 100%;">
        <i class="icon-circle icon-stack-base"></i>
        <i class="icon-bell-alt icon-light"></i>
    </span>
    <br>
    <span class="side-bell__count" style="position: relative; top: -10px;"></span>
</div>


<div id="header" style="position: relative;">

    <div style="float:left; max-height: 60px;">
                            <a href="/"><img height="65" style="height: 65px;" alt="Codeforces" title="Codeforces" src="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png"></a>
    </div>
    <div class="lang-chooser">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" title="In English" alt="In English"></a>
                <a href="?locale=ru"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/ru.png" title="По-русски" alt="По-русски"></a>
            </div>

        <div>
                        <a href="/enter?back=%2Fblog%2Fentry%2F146347">Enter</a>
                     | 
                        <a href="/register">Register</a>
                    
        </div>

    </div>
    <br style="clear: both;">
</div>

        


    <div class="roundbox menu-box borderTopRound borderBottomRound" style="">
    <div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="/">Home</a></li>
                <li class=""><a href="/top">Top</a></li>
                <li class=""><a href="/catalog">Catalog</a></li>
                <li class=""><a href="/contests">Contests</a></li>
                <li class=""><a href="/gyms">Gym</a></li>
                <li class=""><a href="/problemset">Problemset</a></li>
                <li class=""><a href="/groups">Groups</a></li>
                <li class=""><a href="/ratings">Rating</a></li>
                <li class=""><a href="/edu/courses"><span class="edu-menu-item">Edu</span></a></li>
                <li class=""><a href="/apiHelp">API</a></li>
                <li class=""><a href="/calendar">Calendar</a></li>
                <li class=""><a href="/help">Help</a></li>
    </ul>
        <form method="post" action="/search"><input type="hidden" name="csrf_token" value="0c368091a02c4475c4e229a2598e6ac6">
            <input class="search" name="query" data-isplaceholder="true" value="">
        <input type="hidden" name="_tta" value="685"></form>
    <br style="clear: both;">
</div>

    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("input.search").focus(function () {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
        
            <br style="height: 3em; clear: both;">

        <div style="position: relative;">
                        <div id="sidebar">

    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Pay attention
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
        <div style="text-align:center;">
            <span class="contest-state-phase">Before contest</span><br><a href="/contests/2181">2025-2026 ICPC, NERC, Northern Eurasia Finals (Unrated, Online Mirror, ICPC Rules, Teams Preferred)</a><br><span class="countdown" home="//codeforces.com/codeforces.org/s/52448" noredirection="true" textbeforeredirect="" cdid="i1"><span title="68:09:07">3 days</span></span><br><a href="/contestRegistration/2181">Register now »</a>
        </div>
</div>
    </div>

<style data-nocturne="true" type="text/css">
._StreamsSidebarFrame_frame {
  padding: 0.5em 0.5em 0 0.5em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream {
  text-align: center;
  border-bottom: 1px solid #b9b9b9;
  margin: 0 -0.5em 0.5em -0.5em;
  padding: 0 1em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_user {
  margin: 0 0 0.5em 0;
  font-size: 0.8em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_timeMark {
  color: #777;
  font-size: 0.9em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream:last-of-type {
  border-bottom: unset;
  margin: unset;
  padding: 0 0.5em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._viewAll {
  text-align: right;
}
.moreRunningStreamsSidebarNote {
  color: #777 !important;
  text-decoration: none;
}
</style>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Streams
            <div class="top-links">
            </div>
        </div>
            <div class="_StreamsSidebarFrame_frame">
                    <div class="_StreamsSidebarFrame_stream">
                        <div class="_StreamsSidebarFrame_name">
        <p class="_englishName _name">
            
            <a href="/stream/865">Repovive Opening Contest — Solution Discussion</a>
        </p>

                        </div>

                        <div class="_StreamsSidebarFrame_user">
                            By <a href="/profile/Shayan" title="International Grandmaster Shayan" class="rated-user user-red">Shayan</a>
                        </div>

                            <div class="_StreamsSidebarFrame_countdown _StreamsSidebarFrame_timeMark">
                                Before stream
                                <span class="countdown" noredirection="true" cdid="i2">05:44:06</span>
                            </div>
                    </div>
            </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/streams">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

<script data-nocturne="true"> $(function () {

}); </script>


<div class="roundbox sidebox top-contributed borderTopRound " style="">
<div class="caption titled">→ Top rated
<div class="top-links">
</div>
</div>
<table class="rtable ">
<tbody>
<tr>
<th class="left" style="width:2.25em;">#</th>
<th class="">User</th>
<th class="" style="width:5em;">Rating</th>
</tr>
<tr>
<td class="left dark">1</td>
<td class=" dark"><a href="/profile/Kevin114514" title="Legendary Grandmaster Kevin114514" class="rated-user user-legendary"><span class="legendary-user-first-letter">K</span>evin114514</a></td>
<td class=" dark">3765</td>
</tr>
<tr>
<td class="left ">2</td>
<td class=""><a href="/profile/tourist" title="Legendary Grandmaster tourist" class="rated-user user-legendary"><span class="legendary-user-first-letter">t</span>ourist</a></td>
<td class="">3757</td>
</tr>
<tr>
<td class="left dark">3</td>
<td class=" dark"><a href="/profile/Benq" title="Legendary Grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></td>
<td class=" dark">3738</td>
</tr>
<tr>
<td class="left ">4</td>
<td class=""><a href="/profile/jiangly" title="Legendary Grandmaster jiangly" class="rated-user user-legendary"><span class="legendary-user-first-letter">j</span>iangly</a></td>
<td class="">3705</td>
</tr>
<tr>
<td class="left dark">5</td>
<td class=" dark"><a href="/profile/orzdevinwang" title="Legendary Grandmaster orzdevinwang" class="rated-user user-legendary"><span class="legendary-user-first-letter">o</span>rzdevinwang</a></td>
<td class=" dark">3670</td>
</tr>
<tr>
<td class="left ">6</td>
<td class=""><a href="/profile/ksun48" title="Legendary Grandmaster ksun48" class="rated-user user-legendary"><span class="legendary-user-first-letter">k</span>sun48</a></td>
<td class="">3668</td>
</tr>
<tr>
<td class="left dark">7</td>
<td class=" dark"><a href="/profile/Radewoosh" title="Legendary Grandmaster Radewoosh" class="rated-user user-legendary"><span class="legendary-user-first-letter">R</span>adewoosh</a></td>
<td class=" dark">3531</td>
</tr>
<tr>
<td class="left ">8</td>
<td class=""><a href="/profile/maroonrk" title="Legendary Grandmaster maroonrk" class="rated-user user-legendary"><span class="legendary-user-first-letter">m</span>aroonrk</a></td>
<td class="">3443</td>
</tr>
<tr>
<td class="left dark">9</td>
<td class=" dark"><a href="/profile/dXqwq" title="Legendary Grandmaster dXqwq" class="rated-user user-legendary"><span class="legendary-user-first-letter">d</span>Xqwq</a></td>
<td class=" dark">3436</td>
</tr>
<tr>
<td class="left bottom">10</td>
<td class="bottom"><a href="/profile/Nachia" title="Legendary Grandmaster Nachia" class="rated-user user-legendary"><span class="legendary-user-first-letter">N</span>achia</a></td>
<td class="bottom">3432</td>
</tr>
</tbody>
</table>
<div class="bottom-links">
<table style="width:100%;">
<tbody>
<tr>
<td style="text-align:left;">
<a href="/ratings/countries">Countries</a> |
<a href="/ratings/cities">Cities</a> |
<a href="/ratings/organizations">Organizations</a>
</td>
<td style="text-align:right;">
<a href="/ratings">View all →</a>
</td>
</tr>
</tbody>
</table>
</div>
</div>


    <div class="roundbox sidebox top-contributed borderTopRound " style="">
        <div class="caption titled">→ Top contributors
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:2.25em;">#</th>
                            <th class="">User</th>
                            <th class="" style="width:5em;">Contrib.</th>
                </tr>
                    <tr>
                                <td class="left  dark">1</td>
                                <td class=" dark"><a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a></td>
                                <td class=" dark">169</td>
                    </tr>
                    <tr>
                                <td class="left ">2</td>
                                <td class=""><a href="/profile/Qingyu" title="Legendary Grandmaster Qingyu" class="rated-user user-legendary"><span class="legendary-user-first-letter">Q</span>ingyu</a></td>
                                <td class="">166</td>
                    </tr>
                    <tr>
                                <td class="left  dark">3</td>
                                <td class=" dark"><a href="/profile/errorgorn" title="Legendary Grandmaster errorgorn" class="rated-user user-legendary"><span class="legendary-user-first-letter">e</span>rrorgorn</a></td>
                                <td class=" dark">163</td>
                    </tr>
                    <tr>
                                <td class="left ">4</td>
                                <td class=""><a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a></td>
                                <td class="">156</td>
                    </tr>
                    <tr>
                                <td class="left  dark">5</td>
                                <td class=" dark"><a href="/profile/Proof_by_QED" title="Master Proof_by_QED" class="rated-user user-orange">Proof_by_QED</a></td>
                                <td class=" dark">152</td>
                    </tr>
                    <tr>
                                <td class="left ">6</td>
                                <td class=""><a href="/profile/Dominater069" title="Legendary Grandmaster Dominater069" class="rated-user user-legendary"><span class="legendary-user-first-letter">D</span>ominater069</a></td>
                                <td class="">150</td>
                    </tr>
                    <tr>
                                <td class="left  dark">7</td>
                                <td class=" dark"><a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a></td>
                                <td class=" dark">149</td>
                    </tr>
                    <tr>
                                <td class="left ">8</td>
                                <td class=""><a href="/profile/TheScrasse" title="Grandmaster TheScrasse" class="rated-user user-red">TheScrasse</a></td>
                                <td class="">144</td>
                    </tr>
                    <tr>
                                <td class="left  dark">9</td>
                                <td class=" dark"><a href="/profile/soullless" title="Master soullless" class="rated-user user-orange">soullless</a></td>
                                <td class=" dark">143</td>
                    </tr>
                    <tr>
                                <td class="left bottom">10</td>
                                <td class="bottom"><a href="/profile/Arpa" title="International Master Arpa" class="rated-user user-orange">Arpa</a></td>
                                <td class="bottom">141</td>
                    </tr>
            </tbody>
        </table>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/top-contributed">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
        });
    </script>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Find user
            <div class="top-links">
            </div>
        </div>
        <form class="handleForm" method="post" autocomplete="off"><input type="hidden" name="csrf_token" value="0c368091a02c4475c4e229a2598e6ac6">
            <div style="padding:1em;text-align:right;">
                <label style="padding-right:1em;">Handle:
                    <input style="width:12em;" type="text" class="handleBox ac_input" autocomplete="off">
                </label>
            </div>
            <div style="padding: 0 1em 1em 1em;text-align:right;">
                <input style="height:1.65em;padding:0 0.75em;" type="submit" value="Find">
            </div>
        <input type="hidden" name="_tta" value="685"></form>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".handleBox").autocompleteHandle();
    $(".handleForm").attr("autocomplete", "off").submit(function () {
        var link = "/profile/userHandle".replace(
            "userHandle", $(this).find(".handleBox").val()
        );
        window.location = link;
        return false;
    });
        });
    </script>





    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Recent actions
            <div class="top-links">
            </div>
        </div>
        <div class="recent-actions">
            <ul>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/kisuke_007" title="Pupil kisuke_007" class="rated-user user-green">kisuke_007</a>        →
        <a href="/blog/entry/110589">How to fix this?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ABalobanov" title="Expert ABalobanov" class="rated-user user-blue">ABalobanov</a>        →
        <a href="/blog/entry/149154">Codeforces Round 1070 (Div.2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/atcoder_official" title="Unrated, atcoder_official" class="rated-user user-black">atcoder_official</a>        →
        <a href="/blog/entry/149183">AtCoder Beginner Contest 436 Announcement</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/147893">Hacker Cup Round 1 Recap</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/MathModel" title="Expert MathModel" class="rated-user user-blue">MathModel</a>        →
        <a href="/blog/entry/149013">Invitation to Eolymp Blitz #8 (Rating Upto 1750)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Coxin_Hor" title="Expert Coxin_Hor" class="rated-user user-blue">Coxin_Hor</a>        →
        <a href="/blog/entry/149220">A fun contest I created myself.</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/saPaul" title="Pupil saPaul" class="rated-user user-green">saPaul</a>        →
        <a href="/blog/entry/149221">[Update] CF FetchCodes v25.12.7: Smart Retries, Lazy Loading &amp; Instant Caching!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a>        →
        <a href="/blog/entry/149218">Finding all primes up to half a billion in 83 ms</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/awoo" title="Grandmaster awoo" class="rated-user user-red">awoo</a>        →
        <a href="/blog/entry/117791">Educational Codeforces Round 151 Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/alireza_kaviani" title="International Grandmaster alireza_kaviani" class="rated-user user-red">alireza_kaviani</a>        →
        <a href="/blog/entry/148411">Repovive Opening Contest</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/flamestorm" title="International Master flamestorm" class="rated-user user-orange">flamestorm</a>        →
        <a href="/blog/entry/104310">Codeforces Round #803 (Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SilverTongue1729" title="Candidate Master SilverTongue1729" class="rated-user user-violet">SilverTongue1729</a>        →
        <a href="/blog/entry/149213">Codeforces Profile Preview — Chrome Extension</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Xiaohuba" title="Master Xiaohuba" class="rated-user user-orange">Xiaohuba</a>        →
        <a href="/blog/entry/148062">Codeforces Global Round 30</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Ashwanth.K" title="Master Ashwanth.K" class="rated-user user-orange">Ashwanth.K</a>        →
        <a href="/blog/entry/149201">SOS DP easy understanding</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/BreakingNut" title="Specialist BreakingNut" class="rated-user user-cyan">BreakingNut</a>        →
        <a href="/blog/entry/149177">Solved the Problem, Lost the Girlfriend</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ProblemTerminator" title="International Master ProblemTerminator" class="rated-user user-orange">ProblemTerminator</a>        →
        <a href="/blog/entry/149005">pls ban cheater sinha_yash and rollback the rating</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a>        →
        <a href="/blog/entry/137325">GIFs in Problem Statements are Broken</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a>        →
        <a href="/blog/entry/146705">On AI ruining "solving math problems with computer" [a year later]</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/m_manasc" title="Pupil m_manasc" class="rated-user user-green">m_manasc</a>        →
        <a href="/blog/entry/149219">An interesting problem</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/148802">Meta Hacker Cup Round 3</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Top12" title="Expert Top12" class="rated-user user-blue">Top12</a>        →
        <a href="/blog/entry/149216">From TLE to AC using magic!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/TheScrasse" title="Grandmaster TheScrasse" class="rated-user user-red">TheScrasse</a>        →
        <a href="/blog/entry/148631">Codeforces Round 1066 (Div. 1 + Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/MohamedAboOkail" title="Specialist MohamedAboOkail" class="rated-user user-cyan">MohamedAboOkail</a>        →
        <a href="/blog/entry/149116">Removing the cheaters</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ibrm" title="Candidate Master ibrm" class="rated-user user-violet">ibrm</a>        →
        <a href="/blog/entry/147532">Bots?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Shisuko" title="Master Shisuko" class="rated-user user-orange">Shisuko</a>        →
        <a href="/blog/entry/149199">2025 ICPC Asia Manila Regional (Gym) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
            </ul>
        </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/recent-actions">Detailed →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>
</div>
                        <div id="pageContent" class="content-with-sidebar">
                    <div class="second-level-menu">
<ul class="second-level-menu-list"><li class="backLava" style="position: absolute; display: block; margin: 0px; padding: 0px; left: 61.0938px; top: 0px; width: 39px; height: 20px;"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li><a href="/profile/BledDest">BledDest</a></li>
        <li class="current selectedLava"><a href="/blog/BledDest">Blog</a></li>
        <li><a href="/teams/with/BledDest">Teams</a></li>
        <li><a href="/submissions/BledDest">Submissions</a></li>
        <li><a href="/groups/with/BledDest">Groups</a></li>
        <li><a href="/contests/with/BledDest">Contests</a></li>
        <li><a href="/contests/writer/BledDest">Problemsetting</a></li>
</ul>
</div>
    <div style="margin-top:0;">
    <div>
        <h3><a href="/blog/BledDest" style="text-decoration:none;color:black !important;">BledDest's blog</a></h3>
    </div>
        <div style="margin-top:2em;">


<div class="has-topic-id topic" topicid="146983">
    <div class="title">
            <a href="/blog/entry/146347">            <p>Kotlin Heroes 13 Editorial</p>
</a>
    </div>

        <div class="info" style="position:relative;">
                By&nbsp;<a href="/profile/BledDest" title="International Grandmaster BledDest" class="rated-user user-red">BledDest</a>,
                    <span class="format-humantime" title="Sep/13/2025 14:48 UTC">3 months ago</span>,
                
                <img style="position: relative;top: 5px;" src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" alt="In English" title="In English">



            <div class="topic-actions smaller">
                <ul>


                </ul>
            </div>
        </div>

    <div class="content">
        <div class="ttypography"><p>I hope you liked the problems! Thank you for participation. I am sorry that the difference between H and I turned out to be that big, I didn't expect that so many people would solve H.</p><p>The contest was prepared by me, <a class="rated-user user-violet" href="/profile/Neon" title="Candidate Master Neon">Neon</a>, <a class="rated-user user-orange" href="/profile/adedalic" title="International Master adedalic">adedalic</a>, <a class="rated-user user-orange" href="/profile/FelixArg" title="Master FelixArg">FelixArg</a> and <a class="rated-user user-orange" href="/profile/Roms" title="Master Roms">Roms</a>. I would like to express my gratitude to the testers who helped us improve the contest: <a class="rated-user user-red" href="/profile/pashka" title="International Grandmaster pashka">pashka</a>, <a class="rated-user user-red" href="/profile/shnirelman" title="International Grandmaster shnirelman">shnirelman</a> and <a class="rated-user user-red" href="/profile/awoo" title="Grandmaster awoo">awoo</a>.</p><p>See you in the next episode of Kotlin Heroes... sometime in the future (probably near the end of 2025).</p><p><a href="/contest/2141/problem/A" title="Kotlin Heroes: Episode 13">2141A - Furniture Store</a></p><p>Idea: <a class="rated-user user-red" href="/profile/BledDest" title="International Grandmaster BledDest">BledDest</a>, preparation: <a class="rated-user user-violet" href="/profile/Neon" title="Candidate Master Neon">Neon</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2141/problem/A" title="Kotlin Heroes: Episode 13">2141A - Furniture Store</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Observe that if there exists a model $$$j$$$ such that $$$j &lt; i$$$ and $$$a_j &lt; a_i$$$, no one will order the $$$i$$$-th model. Therefore, to solve the problem, we can iterate through the array, maintaining the minimum value on the prefix. If the next element is less than the minimum, then this model will be ordered. Otherwise, it must be included in the answer.</p><p>There is a more beautiful way to solve this problem, though it was not required. You can form an array of minimums on all prefixes of the given array (to do this, the function <span class="tex-font-style-tt">runningReduce</span> can help; it also allows to make an array of prefix sums or most other functions on prefix). Then, a model can be ordered if and only if it is the minimum on its prefix; you can use <span class="tex-font-style-tt">filter</span> to find those which are not minimums on the corresponding prefixes.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (Neon)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="pln">fun main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> repeat</span><span class="pun">(</span><span class="pln">readln</span><span class="pun">().</span><span class="pln">toInt</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  val n </span><span class="pun">=</span><span class="pln"> readln</span><span class="pun">().</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln">
  val a </span><span class="pun">=</span><span class="pln"> readln</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
  val p </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">runningReduce </span><span class="pun">{</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> y </span><span class="pun">-&gt;</span><span class="pln"> minOf</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
  val ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.</span><span class="pun">.</span><span class="pln">n</span><span class="pun">).</span><span class="pln">filter </span><span class="pun">{</span><span class="pln"> i </span><span class="pun">-&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
  println</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">size</span><span class="pun">)</span><span class="pln">
  println</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">joinToString</span><span class="pun">(</span><span class="str">" "</span><span class="pun">))</span><span class="pln">    
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2141/problem/B" title="Kotlin Heroes: Episode 13">2141B - Games</a></p><p>Idea: <a class="rated-user user-red" href="/profile/BledDest" title="International Grandmaster BledDest">BledDest</a>, preparation: <a class="rated-user user-violet" href="/profile/Neon" title="Candidate Master Neon">Neon</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2141/problem/B" title="Kotlin Heroes: Episode 13">2141B - Games</a></h3><div class="ttypography"><div class="problem-statement"><div><p>To keep the series of suggestions running as long as possible, players must first name the games that only one of them likes. Let $$$x$$$ be the number of games that only Alice likes, and $$$y$$$ be the number of games that only Bob likes. Then to solve the problem, you can either simulate the process by decreasing $$$x$$$ and $$$y$$$ alternately until one reaches $$$0$$$, or calculate the answer using a formula: $$$2\cdot\min(x, y) + 2$$$ if $$$x &gt; y$$$, and $$$2\cdot\min(x, y) + 1$$$ otherwise (the difference in formulas is due to the alternating turns).</p><p>In <span class="tex-font-style-tt">Kotlin</span>, you can use <span class="tex-font-style-tt">a.intersect(b).size</span> (let's denote it $$$k$$$) to calculate the number of games that both Alice and Bob like, then $$$x=n-k$$$ and $$$y=m-k$$$.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (Neon)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="pln">fun main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> repeat</span><span class="pun">(</span><span class="pln">readln</span><span class="pun">().</span><span class="pln">toInt</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  val </span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> readln</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
  val a </span><span class="pun">=</span><span class="pln"> readln</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
  val b </span><span class="pun">=</span><span class="pln"> readln</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
  val k </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">intersect</span><span class="pun">(</span><span class="pln">b</span><span class="pun">).</span><span class="pln">size
  println</span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> minOf</span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> m </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&gt;</span><span class="pln"> m</span><span class="pun">)</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2141/problem/C" title="Kotlin Heroes: Episode 13">2141C - Minimum on Subarrays</a></p><p>Idea: <a class="rated-user user-orange" href="/profile/FelixArg" title="Master FelixArg">FelixArg</a>, preparation: <a class="rated-user user-orange" href="/profile/FelixArg" title="Master FelixArg">FelixArg</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2141/problem/C" title="Kotlin Heroes: Episode 13">2141C - Minimum on Subarrays</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Using the structure described in the problem statement, we need to iterate through each subarray of the array and call the operation <span class="tex-font-style-tt">min</span> for it.</p><p>One way to do this is as follows:</p><ul> <li> We start by adding all elements to the end of the structure and calling the <span class="tex-font-style-tt">min</span> operation after each <span class="tex-font-style-tt">pushback</span>. This way, we will iterate through all segments of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mo" id="MJXp-Span-2" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-3">0</span><span class="MJXp-mo" id="MJXp-Span-4" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">p</span><span class="MJXp-mo" id="MJXp-Span-6" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-1">[0, p]</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mn" id="MJXp-Span-8">0</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">p</span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">n</span></span></span><script type="math/tex" id="MathJax-Element-2">0 \le p < n</script>. </li><li> Next, we will remove elements from the beginning of the structure, that is, we will call <span class="tex-font-style-tt">popfront</span> and <span class="tex-font-style-tt">min</span>. This way, we will iterate through all segments of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">p</span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">n</span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-19">1</span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-3">[p, n-1]</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mn" id="MJXp-Span-22">1</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">p</span><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">n</span></span></span><script type="math/tex" id="MathJax-Element-4">1 < p < n</script>. </li><li> After that, we will have an empty structure, and we will process all prefixes and suffixes of the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">a</span></span></span><script type="math/tex" id="MathJax-Element-5">a</script>. Therefore, we will repeat this process for the subarray <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-29"><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-31">1</span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">n</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-35">2</span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-6">[1, n-2]</script>. </li></ul><p>Let's estimate the number of operations in this algorithm. Each prefix and suffix requires one operation to iterate through it and one operation to call <span class="tex-font-style-tt">min</span>. Thus, we can express the number of operations as:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-37"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">p</span><span class="MJXp-mo" id="MJXp-Span-40" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-41"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-47" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mfrac" id="MJXp-Span-48" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-50">2</span></span></span></span></span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-43" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">i</span><span class="MJXp-mo" id="MJXp-Span-45">=</span><span class="MJXp-mn" id="MJXp-Span-46">0</span></span></span></span><span class="MJXp-mn" id="MJXp-Span-51">4</span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-54">2</span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">i</span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-7">op = \sum_{i = 0}^{\frac{n}{2}} 4 \cdot (2 \cdot i)</script></p><p>From this, we get:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-58"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">p</span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-62">4</span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mfrac" id="MJXp-Span-64" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-66">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-69" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-71">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-73">1</span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">n</span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">n</span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-81">1</span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">n</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">n</span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-89">2</span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-8">op = 4 \cdot \frac{n}{2} \cdot (\frac{n}{2} + 1) \approx n \cdot (n + 1) < n \cdot (n + 2)</script></p><p>Therefore, this algorithm solves the problem.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (pashka)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="lit">@file</span><span class="pun">:</span><span class="typ">Suppress</span><span class="pun">(</span><span class="str">"CanBeVal"</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">BufferedReader</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">InputStreamReader</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">OutputStreamWriter</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">PrintWriter</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> kotlin</span><span class="pun">.</span><span class="pln">math</span><span class="pun">.</span><span class="pln">max
</span><span class="kwd">import</span><span class="pln"> kotlin</span><span class="pun">.</span><span class="pln">math</span><span class="pun">.</span><span class="pln">min

</span><span class="kwd">private</span><span class="pln"> fun solveTest</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val n </span><span class="pun">=</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln">
    val res </span><span class="pun">=</span><span class="pln"> emptyList</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;().</span><span class="pln">toMutableList</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">0.</span><span class="pun">.</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="kwd">in</span><span class="pln"> i</span><span class="pun">..</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                res</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="str">"pushfront a["</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> j </span><span class="pun">+</span><span class="pln"> </span><span class="str">"]"</span><span class="pun">)</span><span class="pln">
                res</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="str">"min"</span><span class="pun">)</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            res</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="str">"popback"</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="kwd">in</span><span class="pln"> i</span><span class="pun">..</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                res</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="str">"min"</span><span class="pun">)</span><span class="pln">
                res</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="str">"popfront"</span><span class="pun">)</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">(</span><span class="pln">res</span><span class="pun">.</span><span class="pln">size</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="kwd">in</span><span class="pln"> res</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        println</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="com">//    repeat(readInt()) {</span><span class="pln">
    solveTest</span><span class="pun">()</span><span class="pln">
</span><span class="com">//    }</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">// TEMPLATE</span><span class="pln">
fun main</span><span class="pun">(</span><span class="pln">args</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    reader </span><span class="pun">=</span><span class="pln"> </span><span class="typ">BufferedReader</span><span class="pun">(</span><span class="typ">InputStreamReader</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="str">`in`</span><span class="pun">))</span><span class="pln">
    </span><span class="kwd">out</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PrintWriter</span><span class="pun">(</span><span class="typ">OutputStreamWriter</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">))</span><span class="pln">
    solve</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> lateinit </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">:</span><span class="pln"> </span><span class="typ">PrintWriter</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> lateinit </span><span class="kwd">var</span><span class="pln"> reader</span><span class="pun">:</span><span class="pln"> </span><span class="typ">BufferedReader</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">var</span><span class="pln"> tokenizer</span><span class="pun">:</span><span class="pln"> </span><span class="typ">StringTokenizer</span><span class="pun">?</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun read</span><span class="pun">():</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tokenizer </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="pun">!</span><span class="pln">tokenizer</span><span class="pun">!!.</span><span class="pln">hasMoreTokens</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        tokenizer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">StringTokenizer</span><span class="pun">(</span><span class="pln">readLn</span><span class="pun">())</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> tokenizer</span><span class="pun">!!.</span><span class="pln">nextToken</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun readInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">().</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">().</span><span class="pln">toLong</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLn</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> reader</span><span class="pun">.</span><span class="pln">readLine</span><span class="pun">()!!</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readInts</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> readLn</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readInts</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLongs</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> readLn</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLongs</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> readLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">b</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">b</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">d</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">l</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">l</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">s</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">message</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Any</span><span class="pun">?)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">message</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="kwd">out</span><span class="pln"> T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Collection</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">b</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">b</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">i</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">d</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">l</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">l</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">s</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">message</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Any</span><span class="pun">?)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">message</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="kwd">out</span><span class="pln"> T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">IntArray</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">LongArray</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Collection</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun intarr</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">IntArray</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> v </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun longarr</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">LongArray</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> v </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun intarr2d</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> intarr</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun longarr2d</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> longarr</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> init</span><span class="pun">(</span><span class="pln">vararg elements</span><span class="pun">:</span><span class="pln"> T</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> elements
</span><span class="kwd">private</span><span class="pln"> fun VI</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> init </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun VVI</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> VI</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T1 </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Comparable</span><span class="pun">&lt;</span><span class="pln">T1</span><span class="pun">&gt;,</span><span class="pln"> T2 </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Comparable</span><span class="pun">&lt;</span><span class="pln">T2</span><span class="pun">&gt;&gt;</span><span class="pln"> pairCmp</span><span class="pun">():</span><span class="pln"> </span><span class="typ">Comparator</span><span class="pun">&lt;</span><span class="typ">Pair</span><span class="pun">&lt;</span><span class="pln">T1</span><span class="pun">,</span><span class="pln"> T2</span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Comparator</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b </span><span class="pun">-&gt;</span><span class="pln">
        val res </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">compareTo</span><span class="pun">(</span><span class="pln">b</span><span class="pun">.</span><span class="pln">first</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">compareTo</span><span class="pun">(</span><span class="pln">b</span><span class="pun">.</span><span class="pln">second</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> res
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">


</span></code></pre></div></div><p><a href="/contest/2141/problem/D" title="Kotlin Heroes: Episode 13">2141D - Avoid Minimums</a></p><p>Idea: <a class="rated-user user-red" href="/profile/BledDest" title="International Grandmaster BledDest">BledDest</a>, preparation: <a class="rated-user user-orange" href="/profile/adedalic" title="International Master adedalic">adedalic</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2141/problem/D" title="Kotlin Heroes: Episode 13">2141D - Avoid Minimums</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's say that an operation that gives you a coin is a "good" operation.</p><p>Suppose that the resulting value of elements of the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">a</span></span></span><script type="math/tex" id="MathJax-Element-9">a</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-93"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">v</span></span></span><script type="math/tex" id="MathJax-Element-10">v</script>. Let's prove that it's optimal to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">v</span></span></span><script type="math/tex" id="MathJax-Element-11">v</script> as big as possible. It will be obvious if we prove that the total profit to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">v</span></span></span><script type="math/tex" id="MathJax-Element-12">v</script> is greater than or equal to the total profit of making <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">v</span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-102">1</span></span></span><script type="math/tex" id="MathJax-Element-13">v - 1</script>.</p><p>Let's take the best strategy to make values <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">v</span><span class="MJXp-mo" id="MJXp-Span-105" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-106">1</span></span></span><script type="math/tex" id="MathJax-Element-14">v - 1</script> and then let's increase each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-msubsup" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-110" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-15">a_i</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mn" id="MJXp-Span-112">1</span></span></span><script type="math/tex" id="MathJax-Element-16">1</script>. We'll get the whole array equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">v</span></span></span><script type="math/tex" id="MathJax-Element-17">v</script>. Each new operation will be "bad" (since each element is equal to the current minimum), so the <span class="tex-font-style-it">current</span> profit will be equal to the maximum profit to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">v</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-118">1</span></span></span><script type="math/tex" id="MathJax-Element-18">v - 1</script>. But it means that the <span class="tex-font-style-it">maximum</span> profit for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">v</span></span></span><script type="math/tex" id="MathJax-Element-19">v</script> is at least the maximum profit for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">v</span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-124">1</span></span></span><script type="math/tex" id="MathJax-Element-20">v - 1</script> or even bigger. So, maximizing the resulting value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">v</span></span></span><script type="math/tex" id="MathJax-Element-21">v</script> is always optimal.</p><p>Let's calculate the maximum value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">v</span></span></span><script type="math/tex" id="MathJax-Element-22">v</script>: since we have only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">k</span></span></span><script type="math/tex" id="MathJax-Element-23">k</script> operations, then the total increase of elements can't exceed <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">k</span></span></span><script type="math/tex" id="MathJax-Element-24">k</script>. In other words, we need the maximum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">v</span></span></span><script type="math/tex" id="MathJax-Element-25">v</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">n</span><span class="MJXp-mo" id="MJXp-Span-137" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">v</span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-140"><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">i</span><span class="MJXp-mo" id="MJXp-Span-144">=</span><span class="MJXp-mn" id="MJXp-Span-145">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-148"><span class="MJXp-msubsup" id="MJXp-Span-149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-151" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">k</span></span></span><script type="math/tex" id="MathJax-Element-26">n \cdot v - \sum_{i=1}^{n}{a_i} \le k</script>, or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">v</span><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-157"><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.28em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-159" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">k</span><span class="MJXp-mo" id="MJXp-Span-161">+</span><span class="MJXp-msubsup" id="MJXp-Span-162"><span class="MJXp-mo" id="MJXp-Span-163" style="margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">i</span><span class="MJXp-mo" id="MJXp-Span-166">=</span><span class="MJXp-mn" id="MJXp-Span-167">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-170"><span class="MJXp-msubsup" id="MJXp-Span-171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-173" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.28em;">⌋</span></span></span></span></span><script type="math/tex" id="MathJax-Element-27">v = \left\lfloor \frac{k + \sum_{i=1}^{n}{a_i}}{n} \right\rfloor</script>.</p><p>Ok, we found the desired value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">v</span></span></span><script type="math/tex" id="MathJax-Element-28">v</script>, now we need to maximize the number of good operations. Since the total number of operations to reach <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">v</span></span></span><script type="math/tex" id="MathJax-Element-29">v</script> is constant now, we can minimize the number of bad operations instead.</p><p>What is the minimum possible number of bad operations? Obviously, each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-180"><span class="MJXp-msubsup" id="MJXp-Span-181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-183" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-30">a_i</script> that is equal to the minimum in the initial array needs at least one bad operation to increase it.</p><p>Also, since the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-184"><span class="MJXp-msubsup" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-187" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-191" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-197" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-31">a_1, a_2, \dots, a_n</script> transforms to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">v</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">v</span><span class="MJXp-mo" id="MJXp-Span-202" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">v</span></span></span><script type="math/tex" id="MathJax-Element-32">v, v, \dots, v</script>, then its minimum will go from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-208"><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mrow" id="MJXp-Span-210"><span class="MJXp-msubsup" id="MJXp-Span-211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-213" style="vertical-align: -0.4em;">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-33">\min{a_i}</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">v</span></span></span><script type="math/tex" id="MathJax-Element-34">v</script>, "visiting" all intermediate values <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-216"><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mrow" id="MJXp-Span-219"><span class="MJXp-msubsup" id="MJXp-Span-220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-222" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-224">1</span><span class="MJXp-mo" id="MJXp-Span-225" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mrow" id="MJXp-Span-229"><span class="MJXp-msubsup" id="MJXp-Span-230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-232" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-234">2</span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">v</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-242">1</span><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-35">(\min{a_i} + 1), (\min{a_i} + 2), \dots, (v - 1)</script>. Since for each intermediate value there will be at least one minimum equal to it, then there will be at least one bad operation for each intermediate value.</p><p>In total, the number of bad operations can't be less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-244"><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-246"><span class="MJXp-mtext" id="MJXp-Span-247">number of minimums in&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-248"></span><span class="MJXp-mrow" id="MJXp-Span-249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">a</span></span><span class="MJXp-mrow" id="MJXp-Span-251"></span></span><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">v</span><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mrow" id="MJXp-Span-258"><span class="MJXp-msubsup" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-261" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-263">1</span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-36">(\text{number of minimums in $$$a$$$}) + (v - \min{a_i} - 1)</script>. And, actually, it can be reached with the following greedy algorithm: let's iterate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-265"><span class="MJXp-msubsup" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-268" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-37">a_i</script> in descending order and increase them to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">v</span></span></span><script type="math/tex" id="MathJax-Element-38">v</script> one by one.</p><p>The number of good operations is equal to the total number of operations <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">n</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">v</span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mrow" id="MJXp-Span-277"><span class="MJXp-msubsup" id="MJXp-Span-278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-280" style="vertical-align: -0.4em;">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-39">n \cdot v - \sum{a_i}</script> minus the number of bad operations, and can be calculated in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">O</span><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">n</span><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-40">O(n)</script> time. Note that the formula for bad operations assumes that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">v</span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mrow" id="MJXp-Span-290"><span class="MJXp-msubsup" id="MJXp-Span-291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-293" style="vertical-align: -0.4em;">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-41">v > \min{a_i}</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (adedalic)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="pln">fun main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    repeat</span><span class="pun">(</span><span class="pln">readln</span><span class="pun">().</span><span class="pln">toInt</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        val </span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> readln</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">' '</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
        val a </span><span class="pun">=</span><span class="pln"> readln</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">' '</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
        </span><span class="com">// n * resVal - a.sum() &lt;= k</span><span class="pln">
        val resVal </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">sum</span><span class="pun">())</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> n
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">resVal </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">maxOrNull</span><span class="pun">()!!)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            println</span><span class="pun">(-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">return</span><span class="lit">@repeat</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        val minEl </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">minOrNull</span><span class="pun">()!!</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">sumOf </span><span class="pun">{</span><span class="pln"> resVal </span><span class="pun">-</span><span class="pln"> it </span><span class="pun">}</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">resVal </span><span class="pun">-</span><span class="pln"> minEl</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">minEl </span><span class="pun">&lt;</span><span class="pln"> resVal</span><span class="pun">)</span><span class="pln">
            ans </span><span class="pun">-=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">count </span><span class="pun">{</span><span class="pln"> it </span><span class="pun">==</span><span class="pln"> minEl </span><span class="pun">}</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        println</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2141/problem/E" title="Kotlin Heroes: Episode 13">2141E - Perfect Cut</a></p><p>Idea: <a class="rated-user user-orange" href="/profile/FelixArg" title="Master FelixArg">FelixArg</a>, preparation: <a class="rated-user user-violet" href="/profile/Neon" title="Candidate Master Neon">Neon</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2141/problem/E" title="Kotlin Heroes: Episode 13">2141E - Perfect Cut</a></h3><div class="ttypography"><div class="problem-statement"><div><p>First, let's understand when a string is perfect. Note that if the string begins with <span class="tex-font-style-tt">1</span>, we can cut the prefix of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-294"><span class="MJXp-mn" id="MJXp-Span-295">1</span></span></span><script type="math/tex" id="MathJax-Element-42">1</script>, so the string is perfect. If it starts with <span class="tex-font-style-tt">0</span>, the suffix must also begin with <span class="tex-font-style-tt">0</span>. In this case, we can pick the second <span class="tex-font-style-tt">0</span> in the string, then the prefix looks like <span class="tex-font-style-tt">0111...111</span>, and the suffix starts with <span class="tex-font-style-tt">0</span>(the other characters of the suffix are irrelevant since there are ones in the prefix).</p><p>Thus, a string is not perfect only if it starts with <span class="tex-font-style-tt">0</span> and all other characters are <span class="tex-font-style-tt">1</span>.</p><p>To solve the problem, let's consider two cases. If the first character of the string is <span class="tex-font-style-tt">1</span> or <span class="tex-font-style-tt">?</span> (in the case we replace the first <span class="tex-font-style-tt">?</span> with <span class="tex-font-style-tt">1</span>), then all other question marks can be replaced with any characters, giving us <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-296"><span class="MJXp-msubsup" id="MJXp-Span-297"><span class="MJXp-mn" id="MJXp-Span-298" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-299" style="vertical-align: 0.5em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-43">2^k</script> possible ways, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">k</span></span></span><script type="math/tex" id="MathJax-Element-44">k</script> is the total number of question marks after the first position.</p><p>If the first character of the string is <span class="tex-font-style-tt">0</span> or <span class="tex-font-style-tt">?</span> (in the case we replace the first <span class="tex-font-style-tt">?</span> with <span class="tex-font-style-tt">0</span>), then all subsequent question marks can be replaced with any character, yielding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-302"><span class="MJXp-msubsup" id="MJXp-Span-303"><span class="MJXp-mn" id="MJXp-Span-304" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-305" style="vertical-align: 0.5em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-45">2^k</script> ways, except for the case when there are no zeroes after the first character. If there are no zeroes, we cannot replace all question marks with ones, resulting in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-msubsup" id="MJXp-Span-307"><span class="MJXp-mn" id="MJXp-Span-308" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-309" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-310" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-311">1</span></span></span><script type="math/tex" id="MathJax-Element-46">2^k - 1</script> ways.</p><p>Another way to solve the problem is to calculate the total number of ways to replace question marks (which is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-312"><span class="MJXp-msubsup" id="MJXp-Span-313"><span class="MJXp-mn" id="MJXp-Span-314" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-315" style="vertical-align: 0.5em;">q</span></span></span></span><script type="math/tex" id="MathJax-Element-47">2^q</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">q</span></span></span><script type="math/tex" id="MathJax-Element-48">q</script> is the number of question marks) and subtract the number of ways to get an imperfect string (which is either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-318"><span class="MJXp-mn" id="MJXp-Span-319">0</span></span></span><script type="math/tex" id="MathJax-Element-49">0</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-320"><span class="MJXp-mn" id="MJXp-Span-321">1</span></span></span><script type="math/tex" id="MathJax-Element-50">1</script>, depending on whether we can get the string <span class="tex-font-style-tt">0111...</span>).</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (Neon)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">const</span><span class="pln"> val MOD </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">

fun main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> repeat</span><span class="pun">(</span><span class="pln">readln</span><span class="pun">().</span><span class="pln">toInt</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  val s </span><span class="pun">=</span><span class="pln"> readln</span><span class="pun">()</span><span class="pln">
  </span><span class="kwd">var</span><span class="pln"> pw </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
  repeat</span><span class="pun">(</span><span class="pln">s</span><span class="pun">.</span><span class="pln">drop</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="pln">count </span><span class="pun">{</span><span class="pln"> it </span><span class="pun">==</span><span class="pln"> </span><span class="str">'?'</span><span class="pln"> </span><span class="pun">})</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    pw </span><span class="pun">=</span><span class="pln"> pw </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">var</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'1'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'?'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ans </span><span class="pun">+</span><span class="pln"> pw</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'0'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'?'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val x </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">.</span><span class="pln">indexOf</span><span class="pun">(</span><span class="str">'0'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> 
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ans </span><span class="pun">+</span><span class="pln"> pw </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD
  </span><span class="pun">}</span><span class="pln">
  println</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="/contest/2141/problem/F" title="Kotlin Heroes: Episode 13">2141F - Array Reduction</a></p><p>Idea: <a class="rated-user user-orange" href="/profile/Roms" title="Master Roms">Roms</a>, preparation: <a class="rated-user user-orange" href="/profile/Roms" title="Master Roms">Roms</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2141/problem/F" title="Kotlin Heroes: Episode 13">2141F - Array Reduction</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's slightly change the problem: we will learn to calculate the maximum number of elements we can remove for each number of operations. From this, it is quite easy to obtain the answer to the original problem (considering that if we can remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">m</span></span></span><script type="math/tex" id="MathJax-Element-51">m</script> elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">k</span></span></span><script type="math/tex" id="MathJax-Element-52">k</script> operations, we can also remove any number of elements less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">m</span></span></span><script type="math/tex" id="MathJax-Element-53">m</script> in no more than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">k</span></span></span><script type="math/tex" id="MathJax-Element-54">k</script> operations).</p><p>It is clear that in this version of the problem, we need to either remove one occurrence of all elements or all occurrences of the most frequent element during each operation. Let's construct a new array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-330"><span class="MJXp-msubsup" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-333" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-337" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-340" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-343" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-55">C_1, C_2, \dots, C_n</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-344"><span class="MJXp-msubsup" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-347" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-56">C_i</script> is the number of occurrences of the number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">i</span></span></span><script type="math/tex" id="MathJax-Element-57">i</script> in the original array. Since we actually do not care which specific elements are in the original array, we can sort this array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">C</span></span></span><script type="math/tex" id="MathJax-Element-58">C</script>.</p><p>Let's consider how our operations affect the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">C</span></span></span><script type="math/tex" id="MathJax-Element-59">C</script>. We either decrease all elements by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-354"><span class="MJXp-mn" id="MJXp-Span-355">1</span></span></span><script type="math/tex" id="MathJax-Element-60">1</script> (but do not make them less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-356"><span class="MJXp-mn" id="MJXp-Span-357">0</span></span></span><script type="math/tex" id="MathJax-Element-61">0</script>), or we set the maximum element to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-358"><span class="MJXp-mn" id="MJXp-Span-359">0</span></span></span><script type="math/tex" id="MathJax-Element-62">0</script>. The order of operations does not matter: if we perform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">x</span></span></span><script type="math/tex" id="MathJax-Element-63">x</script> operations of the first type and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">y</span></span></span><script type="math/tex" id="MathJax-Element-64">y</script> operations of the second type, then regardless of their order, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">y</span></span></span><script type="math/tex" id="MathJax-Element-65">y</script> maximums will turn into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-366"><span class="MJXp-mn" id="MJXp-Span-367">0</span></span></span><script type="math/tex" id="MathJax-Element-66">0</script>, and the remaining elements will decrease by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">x</span></span></span><script type="math/tex" id="MathJax-Element-67">x</script>.</p><p>Let's iterate through all possible pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-370"><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">x</span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">y</span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-68">(x, y)</script>. At first glance, it seems that there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">O</span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-381" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-69">O(n^2)</script> of them, but in reality, we need to consider only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">O</span><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">n</span><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-70">O(n)</script> pairs: if we have removed <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">y</span></span></span><script type="math/tex" id="MathJax-Element-71">y</script> maximum elements, there is no point in taking <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">x</span></span></span><script type="math/tex" id="MathJax-Element-72">x</script> greater than the value of the next maximum element; therefore, the total number of values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">x</span></span></span><script type="math/tex" id="MathJax-Element-73">x</script> that we need to consider for all values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">y</span></span></span><script type="math/tex" id="MathJax-Element-74">y</script> is no more than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-396"><span class="MJXp-mo" id="MJXp-Span-397" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-400" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-401" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">n</span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-404">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">n</span></span></span><script type="math/tex" id="MathJax-Element-75">\sum C_i + n \le 2n</script>.</p><p>We just need to understand how to calculate the sum in the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">C</span></span></span><script type="math/tex" id="MathJax-Element-76">C</script> if we perform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">x</span></span></span><script type="math/tex" id="MathJax-Element-77">x</script> operations of the first type and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">y</span></span></span><script type="math/tex" id="MathJax-Element-78">y</script> operations of the second type. For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">x</span></span></span><script type="math/tex" id="MathJax-Element-79">x</script>, we can use two pointers to pre-calculate the first element in the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">C</span></span></span><script type="math/tex" id="MathJax-Element-80">C</script> that is greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">x</span></span></span><script type="math/tex" id="MathJax-Element-81">x</script> — then the entire prefix up to that point will be set to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-418"><span class="MJXp-mn" id="MJXp-Span-419">0</span></span></span><script type="math/tex" id="MathJax-Element-82">0</script>, and all elements starting from that point will decrease by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">x</span></span></span><script type="math/tex" id="MathJax-Element-83">x</script>. Using prefix sums, we can also quickly calculate the sum of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">y</span></span></span><script type="math/tex" id="MathJax-Element-84">y</script> maximum elements in the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">C</span></span></span><script type="math/tex" id="MathJax-Element-85">C</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (pashka)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="lit">@file</span><span class="pun">:</span><span class="typ">Suppress</span><span class="pun">(</span><span class="str">"CanBeVal"</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">BufferedReader</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">InputStreamReader</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">OutputStreamWriter</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">PrintWriter</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> kotlin</span><span class="pun">.</span><span class="pln">math</span><span class="pun">.</span><span class="pln">max
</span><span class="kwd">import</span><span class="pln"> kotlin</span><span class="pun">.</span><span class="pln">math</span><span class="pun">.</span><span class="pln">min

</span><span class="kwd">private</span><span class="pln"> fun solveTest</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val n </span><span class="pun">=</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln">
    val a </span><span class="pun">=</span><span class="pln"> readInts</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
    val c </span><span class="pun">=</span><span class="pln"> intarr</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="kwd">in</span><span class="pln"> a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        c</span><span class="pun">[</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]++</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    val res </span><span class="pun">=</span><span class="pln"> intarr</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">.</span><span class="pln">MAX_VALUE</span><span class="pun">)</span><span class="pln">
    c</span><span class="pun">.</span><span class="pln">sort</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">0.</span><span class="pun">.</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">&amp;&amp;</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> j</span><span class="pun">++</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="kwd">in</span><span class="pln"> j</span><span class="pun">..</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            val d </span><span class="pun">=</span><span class="pln"> k </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">)</span><span class="pln">
            res</span><span class="pun">[</span><span class="pln">s</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">res</span><span class="pun">[</span><span class="pln">s</span><span class="pun">],</span><span class="pln"> d</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        res</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">res</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> res</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">(</span><span class="pln">res</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    repeat</span><span class="pun">(</span><span class="pln">readInt</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        solveTest</span><span class="pun">()</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">// TEMPLATE</span><span class="pln">
fun main</span><span class="pun">(</span><span class="pln">args</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    reader </span><span class="pun">=</span><span class="pln"> </span><span class="typ">BufferedReader</span><span class="pun">(</span><span class="typ">InputStreamReader</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="str">`in`</span><span class="pun">))</span><span class="pln">
    </span><span class="kwd">out</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PrintWriter</span><span class="pun">(</span><span class="typ">OutputStreamWriter</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">))</span><span class="pln">
    solve</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> lateinit </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">:</span><span class="pln"> </span><span class="typ">PrintWriter</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> lateinit </span><span class="kwd">var</span><span class="pln"> reader</span><span class="pun">:</span><span class="pln"> </span><span class="typ">BufferedReader</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">var</span><span class="pln"> tokenizer</span><span class="pun">:</span><span class="pln"> </span><span class="typ">StringTokenizer</span><span class="pun">?</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun read</span><span class="pun">():</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tokenizer </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="pun">!</span><span class="pln">tokenizer</span><span class="pun">!!.</span><span class="pln">hasMoreTokens</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        tokenizer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">StringTokenizer</span><span class="pun">(</span><span class="pln">readLn</span><span class="pun">())</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> tokenizer</span><span class="pun">!!.</span><span class="pln">nextToken</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun readInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">().</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">().</span><span class="pln">toLong</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLn</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> reader</span><span class="pun">.</span><span class="pln">readLine</span><span class="pun">()!!</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readInts</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> readLn</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readInts</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLongs</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> readLn</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLongs</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> readLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">b</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">b</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">d</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">l</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">l</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">s</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">message</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Any</span><span class="pun">?)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">message</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="kwd">out</span><span class="pln"> T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Collection</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">b</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">b</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">i</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">d</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">l</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">l</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">s</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">message</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Any</span><span class="pun">?)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">message</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="kwd">out</span><span class="pln"> T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">IntArray</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">LongArray</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Collection</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun intarr</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">IntArray</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> v </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun longarr</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">LongArray</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> v </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun intarr2d</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> intarr</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun longarr2d</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> longarr</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> init</span><span class="pun">(</span><span class="pln">vararg elements</span><span class="pun">:</span><span class="pln"> T</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> elements
</span><span class="kwd">private</span><span class="pln"> fun VI</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> init </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun VVI</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> VI</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T1 </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Comparable</span><span class="pun">&lt;</span><span class="pln">T1</span><span class="pun">&gt;,</span><span class="pln"> T2 </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Comparable</span><span class="pun">&lt;</span><span class="pln">T2</span><span class="pun">&gt;&gt;</span><span class="pln"> pairCmp</span><span class="pun">():</span><span class="pln"> </span><span class="typ">Comparator</span><span class="pun">&lt;</span><span class="typ">Pair</span><span class="pun">&lt;</span><span class="pln">T1</span><span class="pun">,</span><span class="pln"> T2</span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Comparator</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b </span><span class="pun">-&gt;</span><span class="pln">
        val res </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">compareTo</span><span class="pun">(</span><span class="pln">b</span><span class="pun">.</span><span class="pln">first</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">compareTo</span><span class="pun">(</span><span class="pln">b</span><span class="pun">.</span><span class="pln">second</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> res
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">


</span></code></pre></div></div><p><a href="/contest/2141/problem/G" title="Kotlin Heroes: Episode 13">2141G - Good Robot Paths</a></p><p>Idea: <a class="rated-user user-orange" href="/profile/FelixArg" title="Master FelixArg">FelixArg</a>, preparation: <a class="rated-user user-orange" href="/profile/FelixArg" title="Master FelixArg">FelixArg</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2141/problem/G" title="Kotlin Heroes: Episode 13">2141G - Good Robot Paths</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let there be two black points $$$A = (x_a, y_a)$$$ and $$$B = (x_b, y_b)$$$.</p><p>The shortest length of the robot's path in steps {<span class="tex-font-style-tt">U</span>, <span class="tex-font-style-tt">D</span>, <span class="tex-font-style-tt">L</span>, <span class="tex-font-style-tt">R</span>} between $$$A$$$ and $$$B$$$ is equal to the Manhattan metric:</p><p>$$$$$$d = |x_{a} - x_{b}| + |y_{a} - y_{b}|$$$$$$</p><p><span class="tex-font-style-bf">Fact</span>. The union of all shortest paths between $$$A$$$ and $$$B$$$ over the grid nodes is exactly all integer points inside and on the boundary of the rectangle with vertices $$$(x_{a}, y_{a})$$$ and $$$(x_{b}, y_{b})$$$.</p><p><span class="tex-font-style-it">Proof</span>. For any point $$$P = (x, y)$$$, where $$$x$$$ lies between $$$x_{a}$$$ and $$$x_{b}$$$, and $$$y$$$ lies between $$$y_{a}$$$ and $$$y_{b}$$$, the length of the path $$$A \to P \to B$$$ is equal to:</p><p>$$$$$$|x - x_{a}| + |y - y_{a}| + |x_{b} - x| + |y_{b} - y| = |x_{a} - x_{b}| + |y_{a} - y_{b}| = d$$$$$$</p><p>Thus, point $$$P$$$ lies on some shortest path. Conversely, any point on a shortest path cannot go beyond the specified rectangle. ∎</p><p>From this, it follows that we need to count the number of rectangles that consist entirely of black cells and multiply this count by some constant that depends on which pairs of points will be the starting and ending points of the path.</p><p>Let's divide all rectangles into two classes:</p><ul> <li> Rectangles $$$1 \times k$$$ and $$$k \times 1$$$, where $$$k &gt; 1$$$. </li><li> Other rectangles $$$k \times l$$$, where $$$k, l &gt; 1$$$. </li></ul><p>Let the number of rectangles of the first class be denoted as $$$R_{1}$$$, and the second class as $$$R_{2}$$$. For each class, the contribution to the answer is different; for the first, it is $$$2 \cdot R_{1}$$$, as there are only two ways to choose the starting and ending points (the edges of the rectangle), and for the second, it is $$$4 \cdot R_{2}$$$ for similar reasons (the corners of the rectangle).</p><p>Rectangles of the first type are quite simple to count. For this, let's take all points on some horizontal or vertical line and count the number of consecutive segments consisting of black cells. All of this can be implemented quite simply using a data structure set.</p><p>Rectangles of the second class are counted a bit more complicated. For this, let's use the idea of a sweeping line along the $$$y$$$ coordinate:</p><ul> <li> We scan downwards along $$$y$$$, maintaining a "height histogram" of the columns of black cells whose bottom point has the current $$$y$$$. </li><li> For each level $$$y$$$, we collect a sorted list of all $$$x$$$ such that $$$(x, y)$$$ is a black point. </li><li> We maintain a dictionary $$$H[x] =$$$ height of the column at the current $$$y$$$: how many consecutive black points are above, starting from $$$(x, y)$$$ (including it). </li><li> For the current $$$y$$$, we calculate the number of rectangles using a monotonic stack based on the subtracted $$$H$$$. </li></ul><p>Let's discuss in more detail how to compute the number of rectangles using $$$H$$$ with a monotonic stack:</p><p>Let the heights $$$h_{1}, h_{2}, \dots, h_{m}$$$ (these are the values of $$$H$$$) go from left to right in a block. We count the number of subrectangles whose bottom lies at the current $$$y$$$:</p><ul> <li> We maintain a stack of pairs $$$(height, count)$$$ with non-decreasing heights. </li><li> We keep the current value $$$sum$$$&nbsp;— the sum of the values in the stack. </li><li> When we add a new column $$$h_{i}$$$, we add $$$sum$$$ to the answer and update the stack with the value $$$h_{i} - 1$$$. </li><li> If the value of the key $$$h_{i}$$$ is not equal to the next key value $$$h_{i} - 1$$$, clear the entire stack (i.e., if the columns of the "histogram" are not adjacent). </li></ul><p>Thus, all of this can be implemented in $$$O(n \log n)$$$, requiring sorting, a dictionary, and a set.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (pashka)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="lit">@file</span><span class="pun">:</span><span class="typ">Suppress</span><span class="pun">(</span><span class="str">"CanBeVal"</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">BufferedReader</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">InputStreamReader</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">OutputStreamWriter</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">PrintWriter</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> kotlin</span><span class="pun">.</span><span class="pln">collections</span><span class="pun">.</span><span class="typ">HashMap</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> kotlin</span><span class="pun">.</span><span class="pln">math</span><span class="pun">.</span><span class="pln">max
</span><span class="kwd">import</span><span class="pln"> kotlin</span><span class="pun">.</span><span class="pln">math</span><span class="pun">.</span><span class="pln">min

</span><span class="kwd">private</span><span class="pln"> fun solveTest</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val n </span><span class="pun">=</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln">
    val p </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TreeMap</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;&gt;()</span><span class="pln">
    repeat</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        val x </span><span class="pun">=</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln">
        val y </span><span class="pun">=</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">p</span><span class="pun">.</span><span class="pln">containsKey</span><span class="pun">(</span><span class="pln">y</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            p</span><span class="pun">[</span><span class="pln">y</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mutableListOf</span><span class="pun">()</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        p</span><span class="pun">[</span><span class="pln">y</span><span class="pun">]!!.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> lastY </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">.</span><span class="pln">MIN_VALUE
    </span><span class="kwd">var</span><span class="pln"> lastD </span><span class="pun">=</span><span class="pln"> mutableMapOf</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">&gt;()</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0L</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y </span><span class="kwd">in</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">keys</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y </span><span class="pun">!=</span><span class="pln"> lastY </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            lastD</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">()</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> d </span><span class="pun">=</span><span class="pln"> mutableMapOf</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">&gt;()</span><span class="pln">

        val xx </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">y</span><span class="pun">]!!</span><span class="pln">
        xx</span><span class="pun">.</span><span class="pln">sort</span><span class="pun">()</span><span class="pln">

        </span><span class="kwd">var</span><span class="pln"> lastX </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">.</span><span class="pln">MIN_VALUE
        val st </span><span class="pun">=</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">Pair</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">&gt;&gt;()</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> sum1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0L</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> sum2 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0L</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="kwd">in</span><span class="pln"> xx</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            val dd </span><span class="pun">=</span><span class="pln"> lastD</span><span class="pun">.</span><span class="pln">getOrDefault</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            d</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dd

            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">!=</span><span class="pln"> lastX </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                st</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">()</span><span class="pln">
                sum1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
                sum2 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">

            </span><span class="kwd">var</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">st</span><span class="pun">.</span><span class="pln">isNotEmpty</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> st</span><span class="pun">.</span><span class="kwd">last</span><span class="pun">().</span><span class="pln">first </span><span class="pun">&gt;</span><span class="pln"> dd</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                c </span><span class="pun">+=</span><span class="pln"> st</span><span class="pun">.</span><span class="kwd">last</span><span class="pun">().</span><span class="pln">second
                sum1 </span><span class="pun">-=</span><span class="pln"> st</span><span class="pun">.</span><span class="kwd">last</span><span class="pun">().</span><span class="pln">first </span><span class="pun">*</span><span class="pln"> st</span><span class="pun">.</span><span class="kwd">last</span><span class="pun">().</span><span class="pln">second
                st</span><span class="pun">.</span><span class="pln">removeLast</span><span class="pun">()</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            sum1 </span><span class="pun">+=</span><span class="pln"> c </span><span class="pun">*</span><span class="pln"> dd
            st</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">dd to c</span><span class="pun">)</span><span class="pln">
            sum2</span><span class="pun">++</span><span class="pln">

            res </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sum1 </span><span class="pun">-</span><span class="pln"> sum2 </span><span class="pun">-</span><span class="pln"> dd </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
            res </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sum2 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
            res </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dd </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
</span><span class="com">//            println("" + y + " " + x + " " + dd + " " + sum1 + " " + sum2 + " " + res)</span><span class="pln">
            lastX </span><span class="pun">=</span><span class="pln"> x
        </span><span class="pun">}</span><span class="pln">

        lastY </span><span class="pun">=</span><span class="pln"> y
        lastD </span><span class="pun">=</span><span class="pln"> d
    </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">(</span><span class="pln">res</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    repeat</span><span class="pun">(</span><span class="pln">readInt</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        solveTest</span><span class="pun">()</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">// TEMPLATE</span><span class="pln">
fun main</span><span class="pun">(</span><span class="pln">args</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    reader </span><span class="pun">=</span><span class="pln"> </span><span class="typ">BufferedReader</span><span class="pun">(</span><span class="typ">InputStreamReader</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="str">`in`</span><span class="pun">))</span><span class="pln">
    </span><span class="kwd">out</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PrintWriter</span><span class="pun">(</span><span class="typ">OutputStreamWriter</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">))</span><span class="pln">
    solve</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> lateinit </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">:</span><span class="pln"> </span><span class="typ">PrintWriter</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> lateinit </span><span class="kwd">var</span><span class="pln"> reader</span><span class="pun">:</span><span class="pln"> </span><span class="typ">BufferedReader</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">var</span><span class="pln"> tokenizer</span><span class="pun">:</span><span class="pln"> </span><span class="typ">StringTokenizer</span><span class="pun">?</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun read</span><span class="pun">():</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tokenizer </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="pun">!</span><span class="pln">tokenizer</span><span class="pun">!!.</span><span class="pln">hasMoreTokens</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        tokenizer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">StringTokenizer</span><span class="pun">(</span><span class="pln">readLn</span><span class="pun">())</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> tokenizer</span><span class="pun">!!.</span><span class="pln">nextToken</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun readInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">().</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">().</span><span class="pln">toLong</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLn</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> reader</span><span class="pun">.</span><span class="pln">readLine</span><span class="pun">()!!</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readInts</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> readLn</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readInts</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLongs</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> readLn</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLongs</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> readLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">b</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">b</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">d</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">l</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">l</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">s</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">message</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Any</span><span class="pun">?)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">message</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="kwd">out</span><span class="pln"> T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Collection</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">b</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">b</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">i</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">d</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">l</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">l</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">s</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">message</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Any</span><span class="pun">?)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">message</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="kwd">out</span><span class="pln"> T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">IntArray</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">LongArray</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Collection</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun intarr</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">IntArray</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> v </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun longarr</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">LongArray</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> v </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun intarr2d</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> intarr</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun longarr2d</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> longarr</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> init</span><span class="pun">(</span><span class="pln">vararg elements</span><span class="pun">:</span><span class="pln"> T</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> elements
</span><span class="kwd">private</span><span class="pln"> fun VI</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> init </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun VVI</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> VI</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T1 </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Comparable</span><span class="pun">&lt;</span><span class="pln">T1</span><span class="pun">&gt;,</span><span class="pln"> T2 </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Comparable</span><span class="pun">&lt;</span><span class="pln">T2</span><span class="pun">&gt;&gt;</span><span class="pln"> pairCmp</span><span class="pun">():</span><span class="pln"> </span><span class="typ">Comparator</span><span class="pun">&lt;</span><span class="typ">Pair</span><span class="pun">&lt;</span><span class="pln">T1</span><span class="pun">,</span><span class="pln"> T2</span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Comparator</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b </span><span class="pun">-&gt;</span><span class="pln">
        val res </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">compareTo</span><span class="pun">(</span><span class="pln">b</span><span class="pun">.</span><span class="pln">first</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">compareTo</span><span class="pun">(</span><span class="pln">b</span><span class="pun">.</span><span class="pln">second</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> res
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">


</span></code></pre></div></div><p><a href="/contest/2141/problem/H" title="Kotlin Heroes: Episode 13">2141H - Merging Vertices in a Graph</a></p><p>Idea: <a class="rated-user user-red" href="/profile/BledDest" title="International Grandmaster BledDest">BledDest</a>, preparation: <a class="rated-user user-red" href="/profile/BledDest" title="International Grandmaster BledDest">BledDest</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2141/problem/H" title="Kotlin Heroes: Episode 13">2141H - Merging Vertices in a Graph</a></h3><div class="ttypography"><div class="problem-statement"><div><p>The main idea that helps to solve this problem is to consider the complement of the given graph instead of the graph itself (that is, a graph on the same vertices where two vertices are connected by an edge if and only if there is no edge between them in the original graph). How does the operation we perform affect the complement of the graph?</p><p>When merging vertices in the original graph, the <span class="tex-font-style-it">intersection</span> of their adjacency lists occurs, so in the complement, a <span class="tex-font-style-it">union</span> is performed instead. The operations end when there is at least one vertex that is connected to all other vertices — and in the complement, this will be an isolated vertex.</p><p>Thus, the problem can be reformulated as follows: given an undirected graph; in one operation, we can "merge" two vertices into one, uniting their adjacency lists. We need to obtain an isolated vertex in the minimum/maximum number of operations.</p><p>First, let's consider the minimum number of operations. To obtain an isolated vertex, we need to merge a set of vertices such that they are not connected to any other vertices (otherwise, the resulting vertex will not be isolated). That is, we are interested in the smallest set of vertices that are not connected to vertices outside the set — this is the minimum connected component. Therefore, the minimum number of operations depends only on the size of the minimum connected component in the complement of the given graph.</p><p>Now, let's consider the maximum number of operations. First, let's merge all components into one, and then compress it to size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-426"><span class="MJXp-mn" id="MJXp-Span-427">1</span></span></span><script type="math/tex" id="MathJax-Element-86">1</script>. This will take <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">n</span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-431">1</span></span></span><script type="math/tex" id="MathJax-Element-87">n-1</script> operations; if all components initially consisted of at least two vertices, then the resulting component will also consist of at least two vertices after merging. Therefore, if there is initially no vertex in the given graph that is connected to all others, we can perform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">n</span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-435">1</span></span></span><script type="math/tex" id="MathJax-Element-88">n-1</script> operations.</p><p>We only need to understand how to identify all connected components of the complement of the given graph. The issue is that there may be too many edges in the complement. We need to learn how to implicitly traverse the complement of the given graph.</p><p>Let's write a DFS or BFS and maintain the set of all vertices that have not yet been visited. During the traversal, we need to somehow find all vertices that are not in the adjacency list of the current vertex and have not yet been visited. We will do this as follows: we will go through the set of unvisited vertices and try to check for each of them whether it is in the current adjacency list (either by binary search or by treating the adjacency list as a set). If we find any vertices that are not in the adjacency list, we can continue the traversal from them — and each such vertex reduces the set of unvisited vertices by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-436"><span class="MJXp-mn" id="MJXp-Span-437">1</span></span></span><script type="math/tex" id="MathJax-Element-89">1</script> (therefore, there will be no more than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">n</span></span></span><script type="math/tex" id="MathJax-Element-90">n</script> such checks when we do not find a vertex in the adjacency list). As for the cases when a vertex is found in the adjacency list, there will be no more than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-440"><span class="MJXp-mn" id="MJXp-Span-441">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">m</span></span></span><script type="math/tex" id="MathJax-Element-91">2m</script> of them in total because the total size of the adjacency lists equals <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-443"><span class="MJXp-mn" id="MJXp-Span-444">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">m</span></span></span><script type="math/tex" id="MathJax-Element-92">2m</script>. Thus, this algorithm runs in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">O</span><span class="MJXp-mo" id="MJXp-Span-448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">n</span><span class="MJXp-mo" id="MJXp-Span-451" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">m</span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-454">log</span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">n</span><span class="MJXp-mo" id="MJXp-Span-457" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-93">O((n+m) \log n)</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (pashka)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="lit">@file</span><span class="pun">:</span><span class="typ">Suppress</span><span class="pun">(</span><span class="str">"CanBeVal"</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">BufferedReader</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">InputStreamReader</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">OutputStreamWriter</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">PrintWriter</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> kotlin</span><span class="pun">.</span><span class="pln">collections</span><span class="pun">.</span><span class="typ">HashMap</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> kotlin</span><span class="pun">.</span><span class="pln">math</span><span class="pun">.</span><span class="pln">max
</span><span class="kwd">import</span><span class="pln"> kotlin</span><span class="pun">.</span><span class="pln">math</span><span class="pun">.</span><span class="pln">min

</span><span class="kwd">private</span><span class="pln"> fun solveTest</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val n </span><span class="pun">=</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln">
    val m </span><span class="pun">=</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln">
    val g </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    repeat</span><span class="pun">(</span><span class="pln">m</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        val x </span><span class="pun">=</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        val y </span><span class="pun">=</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        g</span><span class="pun">[</span><span class="pln">x</span><span class="pun">].</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">y</span><span class="pun">)</span><span class="pln">
        g</span><span class="pun">[</span><span class="pln">y</span><span class="pun">].</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    val z </span><span class="pun">=</span><span class="pln"> intarr</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">0.</span><span class="pun">.</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">).</span><span class="pln">toMutableSet</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">.</span><span class="pln">MAX_VALUE

    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">a</span><span class="pun">.</span><span class="pln">isEmpty</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> v </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">iterator</span><span class="pun">().</span><span class="kwd">next</span><span class="pun">()</span><span class="pln">
        a</span><span class="pun">.</span><span class="kwd">remove</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln">
        z</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> mutableSetOf</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;()</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="kwd">in</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">z</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> s</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">true</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">var</span><span class="pln"> ok </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="kwd">in</span><span class="pln"> a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">s</span><span class="pun">.</span><span class="pln">contains</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> z</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    z</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
                    a</span><span class="pun">.</span><span class="kwd">remove</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">var</span><span class="pln"> ss </span><span class="pun">=</span><span class="pln"> mutableSetOf</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;()</span><span class="pln">
                    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y </span><span class="kwd">in</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">x</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">z</span><span class="pun">[</span><span class="pln">y</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> s</span><span class="pun">.</span><span class="pln">contains</span><span class="pun">(</span><span class="pln">y</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                            ss</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">y</span><span class="pun">)</span><span class="pln">
                        </span><span class="pun">}</span><span class="pln">
                    </span><span class="pun">}</span><span class="pln">
                    ok </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
                    s </span><span class="pun">=</span><span class="pln"> ss
                    k</span><span class="pun">++</span><span class="pln">
                    </span><span class="kwd">break</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">ok</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                res </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">res</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">break</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        println</span><span class="pun">(</span><span class="str">""</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> res </span><span class="pun">+</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        println</span><span class="pun">(</span><span class="str">""</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> res </span><span class="pun">+</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="com">//    repeat(readInt()) {</span><span class="pln">
        solveTest</span><span class="pun">()</span><span class="pln">
</span><span class="com">//    }</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">// TEMPLATE</span><span class="pln">
fun main</span><span class="pun">(</span><span class="pln">args</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    reader </span><span class="pun">=</span><span class="pln"> </span><span class="typ">BufferedReader</span><span class="pun">(</span><span class="typ">InputStreamReader</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="str">`in`</span><span class="pun">))</span><span class="pln">
    </span><span class="kwd">out</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PrintWriter</span><span class="pun">(</span><span class="typ">OutputStreamWriter</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">))</span><span class="pln">
    solve</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> lateinit </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">:</span><span class="pln"> </span><span class="typ">PrintWriter</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> lateinit </span><span class="kwd">var</span><span class="pln"> reader</span><span class="pun">:</span><span class="pln"> </span><span class="typ">BufferedReader</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">var</span><span class="pln"> tokenizer</span><span class="pun">:</span><span class="pln"> </span><span class="typ">StringTokenizer</span><span class="pun">?</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun read</span><span class="pun">():</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tokenizer </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="pun">!</span><span class="pln">tokenizer</span><span class="pun">!!.</span><span class="pln">hasMoreTokens</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        tokenizer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">StringTokenizer</span><span class="pun">(</span><span class="pln">readLn</span><span class="pun">())</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> tokenizer</span><span class="pun">!!.</span><span class="pln">nextToken</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun readInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">().</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">().</span><span class="pln">toLong</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLn</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> reader</span><span class="pun">.</span><span class="pln">readLine</span><span class="pun">()!!</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readInts</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> readLn</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readInts</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> readInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLongs</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> readLn</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun readLongs</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> readLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">b</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">b</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">d</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">l</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">l</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">s</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">message</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Any</span><span class="pun">?)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">message</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="kwd">out</span><span class="pln"> T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Collection</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">b</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">b</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">i</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">d</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">l</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">l</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">s</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">message</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Any</span><span class="pun">?)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">message</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="kwd">out</span><span class="pln"> T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">IntArray</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">LongArray</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> println</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Collection</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"$it "</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    println</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> fun intarr</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">IntArray</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> v </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun longarr</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">LongArray</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> v </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun intarr2d</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> intarr</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun longarr2d</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> longarr</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> init</span><span class="pun">(</span><span class="pln">vararg elements</span><span class="pun">:</span><span class="pln"> T</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> elements
</span><span class="kwd">private</span><span class="pln"> fun VI</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> init </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun VVI</span><span class="pun">(</span><span class="pln">n</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> VI</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> init</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">private</span><span class="pln"> fun </span><span class="pun">&lt;</span><span class="pln">T1 </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Comparable</span><span class="pun">&lt;</span><span class="pln">T1</span><span class="pun">&gt;,</span><span class="pln"> T2 </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Comparable</span><span class="pun">&lt;</span><span class="pln">T2</span><span class="pun">&gt;&gt;</span><span class="pln"> pairCmp</span><span class="pun">():</span><span class="pln"> </span><span class="typ">Comparator</span><span class="pun">&lt;</span><span class="typ">Pair</span><span class="pun">&lt;</span><span class="pln">T1</span><span class="pun">,</span><span class="pln"> T2</span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Comparator</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b </span><span class="pun">-&gt;</span><span class="pln">
        val res </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">compareTo</span><span class="pun">(</span><span class="pln">b</span><span class="pun">.</span><span class="pln">first</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">compareTo</span><span class="pun">(</span><span class="pln">b</span><span class="pun">.</span><span class="pln">second</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> res
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">


</span></code></pre></div></div><p><a href="/contest/2141/problem/I" title="Kotlin Heroes: Episode 13">2141I - Color the Tree</a></p><p>Idea: <a class="rated-user user-red" href="/profile/BledDest" title="International Grandmaster BledDest">BledDest</a>, preparation: <a class="rated-user user-red" href="/profile/BledDest" title="International Grandmaster BledDest">BledDest</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2141/problem/I" title="Kotlin Heroes: Episode 13">2141I - Color the Tree</a></h3><div class="ttypography"><div class="problem-statement"><div><p><span class="tex-font-style-bf">Disclaimer:</span> I actually do not know the asymptotic complexity of the model solution. It definitely works in polynomial time, and I wrote a program that calculates the maximum number of reachable states and transitions in the worst case to ensure that the solution does not take too long; however, I cannot accurately estimate the complexity. My guess is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">O</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-463" style="vertical-align: 0.5em;">7</span></span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-94">O(n^7)</script> with a very small hidden constant, but I cannot prove it formally.</p><p>Let's start by solving the "easy" part of the problem — calculating the number of operations required for a complete coloring of a tree. Each operation can affect no more than two leaves of the tree, so the minimum number of operations cannot be less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-465"><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mfrac" id="MJXp-Span-467" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">m</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-469">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-470" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span><script type="math/tex" id="MathJax-Element-95">\lceil \frac{m}{2} \rceil</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">m</span></span></span><script type="math/tex" id="MathJax-Element-96">m</script> is the number of leaves. It turns out that this number of operations is always sufficient. This can be proven as follows: in the case where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">m</span></span></span><script type="math/tex" id="MathJax-Element-97">m</script> is even, we can pair the leaves and color all paths between the corresponding pairs of leaves; either we will achieve a complete coloring, or one of the vertices will remain uncolored. If any vertex remains uncolored, let's learn how to color it without uncoloring the other vertices: we will root the tree at this vertex and consider the subtrees of its children. In each of these subtrees, there will definitely be an even number of leaves (otherwise, the root would definitely be colored); we can take a pair of leaves <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-475"><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">a</span><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">b</span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-98">(a, b)</script> from one subtree and a pair of leaves <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-481"><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">c</span><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">d</span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-99">(c, d)</script> from another subtree, and swap these pairs to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-487"><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">a</span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">c</span><span class="MJXp-mo" id="MJXp-Span-492" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-100">(a, c)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-493"><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">b</span><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">d</span><span class="MJXp-mo" id="MJXp-Span-498" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-101">(b, d)</script>. Then, for the path from the lowest common ancestor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">a</span></span></span><script type="math/tex" id="MathJax-Element-102">a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">b</span></span></span><script type="math/tex" id="MathJax-Element-103">b</script> to the lowest common ancestor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">c</span></span></span><script type="math/tex" id="MathJax-Element-104">c</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">d</span></span></span><script type="math/tex" id="MathJax-Element-105">d</script> (which includes the root), all vertices will be colored, while for the other vertices, the number of paths passing through them will not decrease. By repeating this process several times, we will obtain a correct coloring of the tree. For odd <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">m</span></span></span><script type="math/tex" id="MathJax-Element-106">m</script>, the proof can be conducted in a similar manner if we "split" one of the leaves.</p><p>Now, let's find out how to count the number of complete colorings that can be obtained with the minimum number of operations. For even <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">m</span></span></span><script type="math/tex" id="MathJax-Element-107">m</script>, it is not too complicated. If we fix the pairing of leaves and choose an operation index for each of these pairs, then the color for all other vertices of the tree will be determined automatically, and no two ways to pair and choose operation indices will yield the same coloring (the leaves will be colored differently each time). Therefore, the answer for even <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">m</span></span></span><script type="math/tex" id="MathJax-Element-108">m</script> can be calculated as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-513"><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-515" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">m</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-517">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-518" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0.111em; margin-right: 0em;">!</span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">C</span></span></span><script type="math/tex" id="MathJax-Element-109">(\frac{m}{2})! \cdot C</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">C</span></span></span><script type="math/tex" id="MathJax-Element-110">C</script> is the number of ways to pair the leaves such that each vertex of the tree belongs to at least one path. To calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">C</span></span></span><script type="math/tex" id="MathJax-Element-111">C</script>, we can root the tree at any non-leaf and use the following dynamic programming: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-526"><span class="MJXp-msubsup" id="MJXp-Span-527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-529" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">v</span><span class="MJXp-mo" id="MJXp-Span-531">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-112">d_{v,k}</script> is the number of ways to process the subtree of vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">v</span></span></span><script type="math/tex" id="MathJax-Element-113">v</script> such that exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">k</span></span></span><script type="math/tex" id="MathJax-Element-114">k</script> leaves from the subtree have a pair outside the subtree (and the remaining leaves in the subtree are paired within the subtree), and for each vertex in the subtree, there is at least one path covering it. For each vertex, this dynamic programming can be quite easily calculated using auxiliary dp of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-537"><span class="MJXp-msup" id="MJXp-Span-538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539" style="margin-right: 0.05em;">d</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-540" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">v</span><span class="MJXp-mo" id="MJXp-Span-543" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">k</span><span class="MJXp-mo" id="MJXp-Span-545" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">i</span></span></span></span><script type="math/tex" id="MathJax-Element-115">d'{v,k,i}</script> — we have processed the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">i</span></span></span><script type="math/tex" id="MathJax-Element-116">i</script> children of vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">v</span></span></span><script type="math/tex" id="MathJax-Element-117">v</script>, and there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">k</span></span></span><script type="math/tex" id="MathJax-Element-118">k</script> leaves without pairs among them (when processing the next child, we can iterate over how many leaves without pairs will be in it and how many of them we will pair with already processed leaves). Then the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">C</span></span></span><script type="math/tex" id="MathJax-Element-119">C</script> will be stored in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-555"><span class="MJXp-msubsup" id="MJXp-Span-556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-558" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">v</span><span class="MJXp-mo" id="MJXp-Span-560">,</span><span class="MJXp-mn" id="MJXp-Span-561">0</span></span></span></span></span><script type="math/tex" id="MathJax-Element-120">d_{v,0}</script> for the vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">v</span></span></span><script type="math/tex" id="MathJax-Element-121">v</script> that is the root.</p><p>What changes in the case of odd <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">m</span></span></span><script type="math/tex" id="MathJax-Element-122">m</script>? Unfortunately, quite a lot. We will have one leaf without a pair (which will not be colored in the color of any other leaf), however, the operation index at which we will color it, and the operation indices for the other pairs of leaves (as well as which internal vertex of the tree we will pair that extra leaf with) significantly affect the coloring. This means that we can no longer simply calculate the number of ways to pair and multiply by some factorial — now the order of operations affects the coloring much more strongly. Let's try to iterate over the leaf that will not have a pair, as well as the operation index at which we will color it — and now we need to count the number of colorings considering the operation index.</p><p>To do this, we will root the tree at the chosen leaf and mentally divide all pairs of the remaining leaves into two types: those with operation index greater than ours, and those with operation index less than ours. Why do we need such a division? It allows us to understand which vertices of the tree can be influenced by the index of our operation — only those that are not covered by any path with a larger operation index. We also need to handle the fact that all vertices colored in our chosen color for the root must belong to one path from the root to some other vertex (which is not a leaf).</p><p>All of this can be attempted to be processed with more complex dynamic programming, in which we will consider the following states:</p><ul> <li> which subtree of which vertex we were processing; </li><li> whether there is at least one vertex of "our" color in the subtree of this vertex (this is important to ensure that we have such a vertex only in one of the children); </li><li> how many leaves without pairs are in the subtree; </li><li> how many leaves without pairs are in the subtree <span class="tex-font-style-bf">with a smaller operation index</span>; </li><li> how many pairs of leaves <span class="tex-font-style-bf">with a smaller operation index</span> are in the subtree (from these three values, we will automatically understand how many pairs of leaves with a larger operation index are in the subtree); </li><li> a parameter indicating which paths cover the current vertex (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-566"><span class="MJXp-mn" id="MJXp-Span-567">0</span></span></span><script type="math/tex" id="MathJax-Element-123">0</script> — not covered by any path; <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-568"><span class="MJXp-mn" id="MJXp-Span-569">1</span></span></span><script type="math/tex" id="MathJax-Element-124">1</script> — covered only by paths with a smaller operation index; <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-570"><span class="MJXp-mn" id="MJXp-Span-571">2</span></span></span><script type="math/tex" id="MathJax-Element-125">2</script> — covered by at least one path with a larger operation index). </li></ul><p>To "merge" this dynamic programming from the children of each vertex, we can iterate over how many new pairs with smaller and larger numbers we will create and multiply by the corresponding number of ways to choose these pairs (while ensuring that we do not take more than one subtree that already has a vertex of "our" color). Depending on the last parameter, we sometimes may (if it equals <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-572"><span class="MJXp-mn" id="MJXp-Span-573">1</span></span></span><script type="math/tex" id="MathJax-Element-126">1</script>) or must (if it equals <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-574"><span class="MJXp-mn" id="MJXp-Span-575">0</span></span></span><script type="math/tex" id="MathJax-Element-127">0</script>) color the current vertex in our chosen color.</p><p>How do we extract the answer from this? Let our chosen operation index be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">x</span></span></span><script type="math/tex" id="MathJax-Element-128">x</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-578"><span class="MJXp-mn" id="MJXp-Span-579">0</span></span></span><script type="math/tex" id="MathJax-Element-129">0</script>-indexed), then there must be exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">x</span></span></span><script type="math/tex" id="MathJax-Element-130">x</script> pairs of leaves with operation indices less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">x</span></span></span><script type="math/tex" id="MathJax-Element-131">x</script>. We just need to look at the value of the dynamic programming in the state where:</p><ul> <li> the current vertex is the root of the tree; </li><li> there is definitely at least one vertex of our color in the subtree; </li><li> there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-584"><span class="MJXp-mn" id="MJXp-Span-585">0</span></span></span><script type="math/tex" id="MathJax-Element-132">0</script> leaves without pairs (as well as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-586"><span class="MJXp-mn" id="MJXp-Span-587">0</span></span></span><script type="math/tex" id="MathJax-Element-133">0</script> leaves without pairs with a smaller operation number); </li><li> there are exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">x</span></span></span><script type="math/tex" id="MathJax-Element-134">x</script> pairs of leaves with a smaller operation number; </li><li> the parameter for the current vertex is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-590"><span class="MJXp-mn" id="MJXp-Span-591">0</span></span></span><script type="math/tex" id="MathJax-Element-135">0</script> (since we rooted the tree at the only unpaired leaf). </li></ul><p>This still needs to be multiplied by the number of ways to choose operation indices for all pairs of leaves with smaller indices and for all pairs of leaves with larger indices (this is simply two factorials). In fact, we don't even need to iterate on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">x</span></span></span><script type="math/tex" id="MathJax-Element-136">x</script> (our chosen operation index); our dynamic programming will automatically be calculated for all possible values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">x</span></span></span><script type="math/tex" id="MathJax-Element-137">x</script>.</p><p>And now for the main question — how to implement all of this in a pleasant way. I cannot say that the model solution turned out to be short, but the process of coding it was quite simple and intuitive. First of all, I do not recommend writing this dynamic programming using six-dimensional arrays (you can do it, but the code will be quite cumbersome). Instead, I suggest creating a class that will store some states of dp and the corresponding number of ways (in the model solution, this is the <span class="tex-font-style-tt">State</span> structure, which stores everything except the current vertex and whether there is at least one vertex of "our" color in the subtree of our vertex); and store all reachable states as instances of this class.</p><p>Why do I suggest using a class? First, it will allow us not to process unreachable states (we will automatically not create any instances for unreachable states); second, it is quite easy to code the merging of two states while iterating over the number of pairs we form (look at the function <span class="tex-font-style-tt">merge2</span> in the model solution — it merges two lists of states with the corresponding values). Of course, when merging, we also need to combine identical dynamic states by summing their values — for this, it is enough to sort them and go through the sorted list (look at the function <span class="tex-font-style-tt">fix</span> in the model solution).</p><p>Now we can use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">d</span><span class="MJXp-msubsup" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-600" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">v</span><span class="MJXp-mo" id="MJXp-Span-602">,</span><span class="MJXp-mn" id="MJXp-Span-603">0</span></span></span></span></span><script type="math/tex" id="MathJax-Element-138">dp_{v,0}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">d</span><span class="MJXp-msubsup" id="MJXp-Span-606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-608" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">v</span><span class="MJXp-mo" id="MJXp-Span-610">,</span><span class="MJXp-mn" id="MJXp-Span-611">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-139">dp_{v,1}</script> to store the states and values corresponding to the dynamic programming for each vertex (where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-612"><span class="MJXp-mn" id="MJXp-Span-613">0</span></span></span><script type="math/tex" id="MathJax-Element-140">0</script> means that there is no vertex of "our" color in the subtree, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-614"><span class="MJXp-mn" id="MJXp-Span-615">1</span></span></span><script type="math/tex" id="MathJax-Element-141">1</script> means that there is at least one such vertex). This dynamic programming, by the way, will also automatically calculate the answer for the case with an even number of leaves.</p><p>I will briefly comment on what the other functions in the model solution do:</p><ul> <li> <span class="tex-font-style-tt">choose</span> simply calculates binomial coefficients using factorials and inverse factorials; </li><li> <span class="tex-font-style-tt">merge</span> allows "merging" the dynamic programming for some prefix of the children of the current vertex and the next child of the same vertex; </li><li> <span class="tex-font-style-tt">forceSpecial</span> processes the color of the current vertex, allowing to automatically determine whether we can have a vertex of "our" color in each state. </li></ul></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (BledDest)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> kotlin</span><span class="pun">.</span><span class="pln">math</span><span class="pun">.</span><span class="pln">min

</span><span class="kwd">const</span><span class="pln"> val K </span><span class="pun">=</span><span class="pln"> </span><span class="lit">17</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> val N </span><span class="pun">=</span><span class="pln"> K </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> val MOD </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998244353</span><span class="pln">

fun </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">x</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">):</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">((</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD </span><span class="pun">+</span><span class="pln"> MOD</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD
</span><span class="pun">}</span><span class="pln">

fun mul</span><span class="pun">(</span><span class="pln">x</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">):</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">toLong</span><span class="pun">()</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> y </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">).</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

fun binpow</span><span class="pun">(</span><span class="pln">x</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">):</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">base</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> x
    </span><span class="kwd">var</span><span class="pln"> exponent </span><span class="pun">=</span><span class="pln"> y
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">exponent </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">exponent </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">z</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">base</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">base</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="kwd">base</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">base</span><span class="pun">)</span><span class="pln">
        exponent </span><span class="pun">/=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> z
</span><span class="pun">}</span><span class="pln">

data </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">State</span><span class="pun">(</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> unpaired</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> unpairedLess</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> pairedLess</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> flag</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> ways</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
</span><span class="pun">)</span><span class="pln">

fun comp</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">State</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">:</span><span class="pln"> </span><span class="typ">State</span><span class="pun">):</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">unpaired </span><span class="pun">!=</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpaired</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">unpaired </span><span class="pun">&lt;</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpaired
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">unpairedLess </span><span class="pun">!=</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpairedLess</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">unpairedLess </span><span class="pun">&lt;</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpairedLess
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">pairedLess </span><span class="pun">!=</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">pairedLess</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">pairedLess </span><span class="pun">&lt;</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">pairedLess
    </span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">flag </span><span class="pun">&lt;</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">flag
</span><span class="pun">}</span><span class="pln">

fun fix</span><span class="pun">(</span><span class="pln">v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    v</span><span class="pun">.</span><span class="pln">sortWith</span><span class="pun">(</span><span class="pln">compareBy</span><span class="pun">(</span><span class="typ">State</span><span class="pun">::</span><span class="pln">unpaired</span><span class="pun">).</span><span class="pln">thenBy </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">unpairedLess </span><span class="pun">}.</span><span class="pln">thenBy </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">pairedLess </span><span class="pun">}.</span><span class="pln">thenBy </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">flag </span><span class="pun">})</span><span class="pln">
    val v2 </span><span class="pun">=</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="kwd">in</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">.</span><span class="pln">ways </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v2</span><span class="pun">.</span><span class="pln">isEmpty</span><span class="pun">()</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> comp</span><span class="pun">(</span><span class="pln">v2</span><span class="pun">.</span><span class="kwd">last</span><span class="pun">(),</span><span class="pln"> s</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            v2</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            v2</span><span class="pun">.</span><span class="kwd">last</span><span class="pun">().</span><span class="pln">ways </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">v2</span><span class="pun">.</span><span class="kwd">last</span><span class="pun">().</span><span class="pln">ways</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">.</span><span class="pln">ways</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    v</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">()</span><span class="pln">
    v</span><span class="pun">.</span><span class="pln">addAll</span><span class="pun">(</span><span class="pln">v2</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

val fact </span><span class="pun">=</span><span class="pln"> </span><span class="typ">IntArray</span><span class="pun">(</span><span class="pln">N</span><span class="pun">)</span><span class="pln">
val rfact </span><span class="pun">=</span><span class="pln"> </span><span class="typ">IntArray</span><span class="pun">(</span><span class="pln">N</span><span class="pun">)</span><span class="pln">
val g </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">N</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
val dp </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">(</span><span class="pln">N</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;&gt;()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> n </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">

fun choose</span><span class="pun">(</span><span class="pln">x</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">):</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">fact</span><span class="pun">[</span><span class="pln">x</span><span class="pun">],</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">rfact</span><span class="pun">[</span><span class="pln">y</span><span class="pun">],</span><span class="pln"> rfact</span><span class="pun">[</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> y</span><span class="pun">]))</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

fun merge2</span><span class="pun">(</span><span class="pln">x</span><span class="pun">:</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;,</span><span class="pln"> y</span><span class="pun">:</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;):</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val res </span><span class="pun">=</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="kwd">in</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">b </span><span class="kwd">in</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pairLess </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">0.</span><span class="pun">.</span><span class="pln">min</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">unpairedLess</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpairedLess</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pairGreater </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">0.</span><span class="pun">.</span><span class="pln">min</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">unpaired </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">unpairedLess</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpaired </span><span class="pun">-</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpairedLess</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    </span><span class="kwd">var</span><span class="pln"> numOfChoices </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">fact</span><span class="pun">[</span><span class="pln">pairLess</span><span class="pun">],</span><span class="pln"> fact</span><span class="pun">[</span><span class="pln">pairGreater</span><span class="pun">])</span><span class="pln">
                    numOfChoices </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">numOfChoices</span><span class="pun">,</span><span class="pln"> choose</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">unpairedLess</span><span class="pun">,</span><span class="pln"> pairLess</span><span class="pun">))</span><span class="pln">
                    numOfChoices </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">numOfChoices</span><span class="pun">,</span><span class="pln"> choose</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">unpaired </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">unpairedLess</span><span class="pun">,</span><span class="pln"> pairGreater</span><span class="pun">))</span><span class="pln">
                    numOfChoices </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">numOfChoices</span><span class="pun">,</span><span class="pln"> choose</span><span class="pun">(</span><span class="pln">b</span><span class="pun">.</span><span class="pln">unpairedLess</span><span class="pun">,</span><span class="pln"> pairLess</span><span class="pun">))</span><span class="pln">
                    numOfChoices </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">numOfChoices</span><span class="pun">,</span><span class="pln"> choose</span><span class="pun">(</span><span class="pln">b</span><span class="pun">.</span><span class="pln">unpaired </span><span class="pun">-</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpairedLess</span><span class="pun">,</span><span class="pln"> pairGreater</span><span class="pun">))</span><span class="pln">
                    numOfChoices </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">numOfChoices</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">ways</span><span class="pun">)</span><span class="pln">
                    numOfChoices </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">numOfChoices</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">ways</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">var</span><span class="pln"> flag </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">unpairedLess </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpairedLess </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> flag </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">unpairedLess </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">unpaired </span><span class="pun">||</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpairedLess </span><span class="pun">&lt;</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpaired</span><span class="pun">)</span><span class="pln"> flag </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
                    res</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="typ">State</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">unpaired </span><span class="pun">+</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpaired </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> pairLess </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> pairGreater</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">unpairedLess </span><span class="pun">+</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">unpairedLess </span><span class="pun">-</span><span class="pln"> pairLess </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">pairedLess </span><span class="pun">+</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">pairedLess </span><span class="pun">+</span><span class="pln"> pairLess</span><span class="pun">,</span><span class="pln"> maxOf</span><span class="pun">(</span><span class="pln">flag</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">flag</span><span class="pun">),</span><span class="pln"> numOfChoices</span><span class="pun">))</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    fix</span><span class="pun">(</span><span class="pln">res</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> res
</span><span class="pun">}</span><span class="pln">

fun merge</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;&gt;,</span><span class="pln"> b</span><span class="pun">:</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;&gt;):</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val res </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">0.</span><span class="pun">.</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">0.</span><span class="pun">.</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> j </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pln">
            val cur </span><span class="pun">=</span><span class="pln"> merge2</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])</span><span class="pln">
            res</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> j</span><span class="pun">].</span><span class="pln">addAll</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">0.</span><span class="pun">.</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> fix</span><span class="pun">(</span><span class="pln">res</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> res
</span><span class="pun">}</span><span class="pln">

fun getDp</span><span class="pun">(</span><span class="pln">s</span><span class="pun">:</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;,</span><span class="pln"> cntLess</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> flag</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">):</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="kwd">in</span><span class="pln"> s</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">unpaired </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> x</span><span class="pun">.</span><span class="pln">pairedLess </span><span class="pun">==</span><span class="pln"> cntLess </span><span class="pun">&amp;&amp;</span><span class="pln"> x</span><span class="pun">.</span><span class="pln">flag </span><span class="pun">==</span><span class="pln"> flag</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">.</span><span class="pln">ways
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

fun forceSpecial</span><span class="pun">(</span><span class="pln">a</span><span class="pun">:</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;&gt;):</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val res </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="kwd">in</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">when</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">flag</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="lit">0</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> res</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
            </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                res</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">copy</span><span class="pun">())</span><span class="pln">
                res</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">copy</span><span class="pun">())</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> res</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="kwd">in</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        res</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    fix</span><span class="pun">(</span><span class="pln">res</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span><span class="pln">
    fix</span><span class="pun">(</span><span class="pln">res</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> res
</span><span class="pun">}</span><span class="pln">

fun dfs</span><span class="pun">(</span><span class="pln">v</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val children </span><span class="pun">=</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="kwd">in</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            dfs</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">)</span><span class="pln">
            children</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">size </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> v </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        val s1 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">State</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        val s2 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">State</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        dp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mutableListOf</span><span class="pun">(</span><span class="pln">mutableListOf</span><span class="pun">(</span><span class="pln">s1</span><span class="pun">,</span><span class="pln"> s2</span><span class="pun">),</span><span class="pln"> mutableListOf</span><span class="pun">())</span><span class="pln">
        fix</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="lit">0</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> aux </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MutableList</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    aux</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="kwd">add</span><span class="pun">(</span><span class="typ">State</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c </span><span class="kwd">in</span><span class="pln"> children</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        aux </span><span class="pun">=</span><span class="pln"> merge</span><span class="pun">(</span><span class="pln">aux</span><span class="pun">,</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">c</span><span class="pun">])</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    dp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> forceSpecial</span><span class="pun">(</span><span class="pln">aux</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

fun main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val reader </span><span class="pun">=</span><span class="pln"> </span><span class="typ">System</span><span class="pun">.</span><span class="str">`in`</span><span class="pun">.</span><span class="pln">bufferedReader</span><span class="pun">()</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> reader</span><span class="pun">.</span><span class="pln">readLine</span><span class="pun">().</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">until</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        val </span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> reader</span><span class="pun">.</span><span class="pln">readLine</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">" "</span><span class="pun">).</span><span class="pln">map </span><span class="pun">{</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">toInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
        g</span><span class="pun">[</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">].</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        g</span><span class="pun">[</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">].</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    val leaves </span><span class="pun">=</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;()</span><span class="pln">
    val nonLeaves </span><span class="pun">=</span><span class="pln"> mutableListOf</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">until</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">g</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> leaves</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> nonLeaves</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    fact</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">1.</span><span class="pun">.</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> fact</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">fact</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> i</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">0.</span><span class="pun">.</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> rfact</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> binpow</span><span class="pun">(</span><span class="pln">fact</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">leaves</span><span class="pun">.</span><span class="pln">size </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        val root </span><span class="pun">=</span><span class="pln"> nonLeaves</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
        dfs</span><span class="pun">(</span><span class="pln">root</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">)</span><span class="pln">
        ans </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">fact</span><span class="pun">[</span><span class="pln">leaves</span><span class="pun">.</span><span class="pln">size </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">],</span><span class="pln"> getDp</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">root</span><span class="pun">][</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln">
        println</span><span class="pun">(</span><span class="str">"${leaves.size / 2} $ans"</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"${(leaves.size + 1) / 2} "</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="kwd">in</span><span class="pln"> leaves</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            dfs</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">0.</span><span class="pun">.</span><span class="pln">leaves</span><span class="pun">.</span><span class="pln">size </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                val cur </span><span class="pun">=</span><span class="pln"> getDp</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> j</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
                ans </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">,</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">fact</span><span class="pun">[</span><span class="pln">j</span><span class="pun">],</span><span class="pln"> fact</span><span class="pun">[</span><span class="pln">leaves</span><span class="pun">.</span><span class="pln">size </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> j</span><span class="pun">])))</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        println</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="/contest/2141" class="notice" style="text-decoration: none;">Kotlin Heroes: Episode 13</a> </span>
        </div>
        
            <script type="text/javascript">
    $(document).ready(function () {
        $(".delete-resource-link-53375-146983").click(function() {
            var that = this;
            Codeforces.confirm("Are you sure you want to detach a contest?", function () {
                $.post("/data/blogAndContest", {
                    action: "detachBlogFromContest",
                    blogId: "53375",
                    blogEntryId: "146347",
                    contestId: $(that).attr("data-contestId"),
                    resourceIds: $(that).attr("data-resourceIds")
                }, function(json) {        
                    Codeforces.reloadAndShowMessageOrShowError(json, "Contest detached");
                });
            }, function () {}, "Yes", "No");
        });
    });
</script>
        



    <div class="roundbox meta borderTopRound borderBottomRound" style="">
        <div class="left-meta">
            <ul>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-up-146983"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/voteup-gray.png" alt="Vote: I like it" title="Vote: I like it"></a>


</li>
                    <li style="line-height: 1.6em;">

        
        <span class="topic-rating topic-rating-146983" title="Topic rating" data-topicid="146983" data-rawrating="48" style="font-size:larger;position:relative;bottom:1px;font-weight:bold;color:green">+48</span>
        
</li>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-down-146983"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/votedown-gray.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>


</li>
            </ul>
        </div>


            <span style="position: relative; line-height: 1.65em; top: 0.75rem; left: 0.8em;">
            </span>

        <div class="right-meta">
            <ul>
                    <li>        <a href="/profile/BledDest"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/user_16x16.png" alt="Author" title="Author"></a>


        <a href="/profile/BledDest">
        BledDest
        </a>
</li>
                    <li>        <img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/date_16x16.png" alt="Publication date" title="Publication date">


        
        <span class="format-humantime" title="Sep/13/2025 14:48 UTC">3 months ago</span>
        
</li>
                    <li>        <a href="/blog/entry/146347#comments"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/comments_16x16.png" alt="Comments" title="Comments"></a>


        <a href="/blog/entry/146347#comments">
        0
        </a>
</li>
            </ul>
        </div>

        <br style="clear:both;">
    </div>


<style type="text/css">
    .comments .title {
        float: left;
    }

    .comments .comments-actions-div {
        float: right;
        margin-top: 3rem;
        margin-right: 0.5em;
    }

    .comments .comments-actions-div .separator {
        margin: 0 1rem;
    }

    .comments label.show-archived {
    }

    .comments label.show-archived, .comments label.show-archived * {
        font-size: 1.4rem !important;
        color: black !important;
        /*position: relative !important;*/
        /*bottom: 0.4rem !important;*/
    }

    .comments label.show-archived input {
        height: 1.4rem !important;
        width: 1.4rem !important;
        position: relative;
        top: 0.25rem;
    }

    .new-root-comment {
        font-size: 1.4rem !important;
    }
</style>

    <div class="comments" commentableid="161591">
        <div style="display: flow-root">
            <div class="title">
                <img src="//codeforces.com/codeforces.org/s/52448/images/icons/comments-48x48.png" alt="Comments" title="Comments" style="position:relative;top:0.6em;">
                <a name="comments">Comments (0)</a>

            </div>
            <div class="comments-actions-div">
                <a href="#" class="new-root-comment">Write comment?</a>
            </div>
        </div>
        <br>

<div id="editBox-161591" style="width:50em;display:none;">
    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
    <div style="width: 1px">&nbsp;</div>
    <div class="commentLocale" style="position: relative; top: 0.5em;left:4px;display: none;">
        <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
        <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
    </div>
    <textarea data-drafts-id="CommentReplyFrame" class="wysiwyg" name="editContent" rows="20" style="width:99%;"></textarea>
    <div class="error error__content"></div>
    <div style="text-align:center;">
        <input type="button" name="preview" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Preview">
        <input type="button" name="save" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Save">
    </div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {

var firstPreview161591 = true;
var lastPreviewContent161591 = '';

if (!window.moveCommentRevision) {
    moveCommentRevision = function(e, dir) {
        var p = e.parent();
        var revisionCount = parseInt(p.attr("revisionCount"));
        var revision = parseInt(p.attr("revision"));
        var next = revision + dir;
        var commentId = p.attr("commentId");
        if (next >= 1 && next <= revisionCount) {
            $.post(
                "/data/comment-data",
                {action: "revision", commentId: commentId, revision: next},
                function(json) {
                    if (json.success == "true") {
                        var parentDiv = e;

                        while (parentDiv !== null && (parentDiv[0].nodeName.toLowerCase() !== "td" || !parentDiv.hasClass("right"))) {
                            parentDiv = parentDiv.parent();
                        }

                        if (parentDiv === null) {
                            return;
                        }

                        parentDiv.find("div.comment-content-" + commentId + " .moveup").html(json.content);
                        Codeforces.setupSpoilers(parentDiv.find("div.comment-content-" + commentId + " .moveup"));
                        p.attr("revision", next);
                        p.find("span.revision").text(next);
                        if (next == 1) {
                            p.find("a.leftRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.leftRevision").css("visibility", "visible");
                        }
                        if (next == revisionCount) {
                            p.find("a.rightRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.rightRevision").css("visibility", "visible");
                        }

                        window.updateTypography();
                        MathJax.Hub.Typeset();
                    } else {
                        alert(e.error);
                    }
                },
                "json"
            );
        }
    };
}

$("div[commentableId=161591] a.leftRevision").click(function () {
    window.moveCommentRevision($(this), -1);
    return false;
});

$("div[commentableId=161591] a.rightRevision").click(function () {
    window.moveCommentRevision($(this), +1);
    return false;
});



        });
    </script>


        <script src="//codeforces.com/codeforces.org/s/52448/js/swfobject-2.2.min.js" type="text/javascript"></script>
        <script src="//codeforces.com/codeforces.org/s/52448/js/ftaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                if (window.evercookie) {
                    var ec = new evercookie({
                        history: false,
                        silverlight: false,
                        baseurl: '',
                        asseturi: '/assets',
                        phpuri: '/2fdcd78',
                        pngPath: '/eps',
                        etagPath: '/ees',
                        cachePath: '/ecs'
                    });

                    var randomNumber = function () {
                        return Math.random().toString(36).substr(2);
                    };

                    var randomToken = function () {
                        return (randomNumber() + randomNumber()).substring(0, 18);
                    };

                    window._ftaa = "";

                    ec.get("70a7c28f3de", function (value) {
                        window._ftaa = value;
                        if (!window._ftaa) {
                            window._ftaa = randomToken();
                            ec.set("70a7c28f3de", window._ftaa);
                        }
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                } else {
                    window._ftaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

        <script src="//codeforces.com/codeforces.org/s/52448/js/bfaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                var fpCallback = function() {
                    Fingerprint2.get({}, function(components) {
                        window._bfaa = Fingerprint2.x64hash128(components.map(function (pair) { return pair.value }).join(), 31);
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                };
                if (typeof Fingerprint2 !== 'undefined') {
                    if (window.requestIdleCallback) {
                        requestIdleCallback(fpCallback)
                    } else {
                        setTimeout(fpCallback, 500)
                    }
                } else {
                    window._bfaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

    <script type="text/javascript">
        $(document).ready(function () {
    $("a.new-root-comment").click(function () {
            window.location = "/enter";
        return false;
    });

    $(".comment-table .reply a").click(function () {
            window.location = "/enter";
        return false;
    });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
    function updateImg(element, direction, activated) {
        var votedDirection = element.closest(".CommentVoteFrame").attr("myVoteDirection");
        var directionString = direction == 1 ? "up" : "down";
        element.attr("src", "//codeforces.com/codeforces.org/s/52448/images/actions/comment-vote" + directionString + (activated ? "" : "-blue") + ".png");
        element.css("opacity", activated ? "1.0" : "0.35");
        var title;
        if (votedDirection == direction) {
            title = "Cancel vote";
        } else if (direction == 1) {
            title = "Vote: I like it";
        } else {
            title = "Vote: I do not like it";
        }
        element.attr("alt", title);
        element.attr("title", title);
    }

    $(".vote-for-comment").mouseover(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (!ownComment) {
            updateImg(vote.find("img"), direction, true);
        }
    });

    $(".vote-for-comment").mouseout(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (myVoteDirection != direction && !ownComment) {
            updateImg(vote.find("img"), direction, false);
        }
    });

    $(".vote-for-comment").click(function () {
        if ($(this).closest(".hidden-comment").length) {
            Codeforces.showMessage("Show the comment before voting");
            return;
        }
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var commentId = $(this).parent().attr("commentid");
        var commentRating = $(this).parent().attr("data-commentRating");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var direction = $(this).attr("voteDirection");
        var newDirection = direction;
        if (direction == myVoteDirection) {
            newDirection = 0; // Clicking same direction twice cancels the vote
        }
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        $.post("/data/comment/vote", {commentId: commentId, _tta: Codeforces.tta(), vote: newDirection, commentRating: commentRating}, function(data) {
            if (data["success"] == "true") {
                voteFrame.attr("myVoteDirection", newDirection);
                updateImg(voteFrame.find("[voteDirection=-1]>img"), -1, newDirection == -1);
                updateImg(voteFrame.find("[voteDirection=1]>img"), 1, newDirection == 1);
                if (newDirection == -1) {
                    voteFrame.find(".ComplaintFrame").css("display", "inline-block");
                } else {
                    voteFrame.find(".ComplaintFrame").hide();
                }
                vote.parent().find(".commentRating").html(data["commentRating"]);
            }
            Codeforces.showMessage(data["message"]);
        }, "json");
        return false;
    });

    $(".negative-comment-vote").closest(".comment-table").addClass("comment-bad");

    $(".troll-comment-vote").closest(".comment").css("display", "none");

    $(".too-negative-comment-vote").closest(".comment-table").each(function () {
        var e = $(this);
        e.addClass("comment-too-bad");
        var commentId = e.attr("commentId");
        $("<div class='bad-comment-replacement ttypography'>The comment is hidden because of too negative feedback, click <a href=# class=show-bad-comment-link>here</a> to view it</div>").appendTo(
            e.find(".right")
        );
        e.find(".comment-content").hide();
        e.find(".show-bad-comment-link").click(function () {
            e.find(".comment-content").show();
            e.find(".bad-comment-replacement").hide();
            return false;
        });
    });
        });
    </script>
    </div>

    <style type="text/css">
        .new-comments-box {
            padding: 0.5em;
            width: 22px;
            font-size: 1.3rem;
            font-weight: bold !important;

            position: fixed;
            top: 40%;
            right: 0;
            opacity: 0.2;
            color: white;
            text-align: center;

            border: 1px solid #222;
            background-color: #888 !important;
            border-radius: 3px;
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
        }

        .new-comments-box:hover {
            opacity: 1;
        }

        .new-comments-box .dir:hover {
            background: #3B5998 !important;
            cursor: pointer;
        }
    </style>

    <div class="new-comments-box" data-position="outside" data-index="-1" style="display: none;">
        <div class="up dir" title="Ctrl+Up">↑<hr>
        </div>
        <div class="info" title="New comments"></div>
        <div class="down dir" title="Ctrl+Down">
            <hr>↓
        </div>
    </div>

    <script>
        function makeSureElementIsShown(target) {
            let e = target;
            while (true) {
                e = e.parent().closest(".comment");
                if (e.length === 0) {
                    break;
                }
                e.find(">.hidden-comment").hide();
                e.find(">.shown-comment").show();
            }
        }

        $(function() {
            const hash = window.location.hash;
            if (hash) {
                const target = $(hash);
                if (target) {
                    makeSureElementIsShown(target);
                    setTimeout(() => target.scrollIntoView());
                }
            }
        });

        $(".show-archived-checkbox").change(function () {
            const checked = $(this).is(":checked");
            $.post("/data/comment-data", {action: "setShowArchived", checked}, function (json) {
                if (json["success"] !== "true") {
                    alert(json["error"]);
                } else {
                    if (checked) {
                        Codeforces.reloadAndShowMessage("Archived comments are now displayed")
                    } else {
                        Codeforces.reloadAndShowMessage("Archived comments are no longer displayed")
                    }
                }
            });
            return false;
        });

        function gotoComment(direction) {
            var box = $(".new-comments-box");
            var index = parseInt(box.attr("data-index"));
            if (index == -1)
                index = 0;
            else
                index = Math.max(0, Math.min(parseInt(box.find(".info").text()) - 1, index + direction));
            box.attr("data-index", index);
            var comment = $($(".comment>.shown-comment>.highlight-blue[commentId]").get(index));
            makeSureElementIsShown(comment);
            $('html, body').animate({
                'scrollTop': Math.max(0, comment.offset().top - ($(window).height() - comment.height()) / 2)
            });
            return false;
        }

        $(".new-comments-box .down").click(function () {
            return gotoComment(1);
        });

        $(".new-comments-box .up").click(function () {
            return gotoComment(-1);
        });

        $(document).keydown(function (e) {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (e.ctrlKey) {
                if (code == 38 || code == 40) {
                    gotoComment(code - 39);
                }
            }
        });

        var newCommentCount = $(".comment>.shown-comment>.highlight-blue[commentId]").length;
        if (newCommentCount > 0) {
            $(".new-comments-box .info").text(newCommentCount);
            $(".new-comments-box").show();
        }

        $('table.comment-table').mouseenter(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").addClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        $('table.comment-table').mouseleave(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").removeClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        const commentVoteFrameHolderSelector = ">.comment-table .commentVoteFrameHolder";
        $(".hidden-comment").each(function() {
            const comment = $(this).closest(".comment");
            $(this).find(".hidden-children").text(comment.find(".comment").length);
        });
        $('.hideComment').click(function () {
            const comment = $(this).closest(".comment");
            const shownComment = comment.find("> .shown-comment");
            const hiddenComment = comment.find("> .hidden-comment");
            shownComment.hide();
            hiddenComment.show();
            shownComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(hiddenComment.find(commentVoteFrameHolderSelector));
            return false;
        });
        $('.showComment').click(function () {
            const comment = $(this).closest(".comment");
            const hiddenComment = comment.find("> .hidden-comment");
            const shownComment = comment.find("> .shown-comment");
            hiddenComment.hide();
            shownComment.show();
            hiddenComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(shownComment.find(commentVoteFrameHolderSelector));
            return false;
        });
    </script>



    <script>
        function adjustTopicComplainFrames() {
            let topicIds = [];

            $(".has-topic-id").each(function () {
                const $this = $(this);
                const topicId = $this.attr("topicId");
                if (topicId) {
                    topicIds.push(topicId);
                }
            });

            $.post("/data/topics", {
                action: "findComplainableTopicIds",
                topicIds: topicIds.join(",")
            }, function (json) {
                if (json["success"] === "true") {
                    for (const topicId of json["complainableTopicIds"].split(",")) {
                        $(".has-topic-id[topicId=" + topicId + "]").each(function () {
                            $(this).find(".meta .ComplaintFrame").css("display", "inline-block");
                        });
                    }
                }
            }, "json");
        }

        function updateTopicVote(topicId, voteDirection, processed) {
            let ratingElement = $(".topic-rating-" + topicId);
            let newRating = parseInt(ratingElement.attr("data-rawRating"));
            if (!processed) newRating += voteDirection;
            if (newRating > 0) {
                ratingElement.text("+" + newRating.toString());
                ratingElement.css("color", "green");
            } else {
                ratingElement.text(newRating.toString());
                ratingElement.css("color", "gray");
            }
            let voteUpImg = $(".topic-vote-up-" + topicId + " img");
            voteUpImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === 1 ? "images/actions/voteup-voted.png" : "images/actions/voteup-gray.png"));
            voteUpImg.attr("title", voteDirection === 1 ? "Cancel vote" : "Vote: I like it");
            let voteDownImg = $(".topic-vote-down-" + topicId + " img");
            voteDownImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === -1 ? "images/actions/votedown-voted.png" : "images/actions/votedown-gray.png"));
            voteDownImg.attr("title", voteDirection === -1 ? "Cancel vote" : "Vote: I do not like it");
        }

        function getMyVotes() {
            let topicIds = [];
            $(".topic-rating").each(function () {
                topicIds.push($(this).attr("data-topicId"))
            });
            $.post("/data/topic/vote", {
                topicIds: topicIds.join(","),
                _tta: Codeforces.tta(),
                action: "getMyVotes"
            }, function (data) {
                if (data.success === "true") {
                    votes = JSON.parse(data.votes);
                    for (const vote of votes) {
                        updateTopicVote(vote.topicId, vote.direction, vote.processed);
                    }
                }
            }, "json");
        }

        $(function () {
        });
    </script>

<script type="text/javascript">
    $(document).ready(function () {
        let voteDirection = 0;

        function clickVote(direction) {
            if (direction === voteDirection) {
                direction = 0;
            }
            $.post("/data/topic/vote", {
                topicId: 146983,
                _tta: Codeforces.tta(),
                topicRevisionId: 406772,
                vote: direction,
            }, function (data) {
                if (data.success === "true") {
                    voteDirection = parseInt(data.voteDirection);
                    updateTopicVote(146983, voteDirection, data.processed === "true");
                }
                Codeforces.showMessage(data.message);
            }, "json");
        }

        $(".topic-vote-up-146983").click(function () {
            clickVote(+1);
            return false;
        });
        $(".topic-vote-down-146983").click(function () {
            clickVote(-1);
            return false;
        });
    });
</script></div>

    <script>
        $(function () {
            $(".topic-action-a").click(function () {
                const action = $(this).data("action");
                const topicTitle = $(this).data("topic-title");

                if (confirm("Are you sure you want to perform the action '" + action.toUpperCase()
                        + "' on the topic '" + topicTitle + "'?")) {
                    const topicId = $(this).data("topic-id");
                    const locale = $(this).data("topic-locale");
                    $.post("/data/topic", {action, topicId, locale}, function (json) {
                        Codeforces.reloadAndShowMessageOrShowError(json, json["message"]);
                    });
                }

                return false;
            });
        });
    </script>
        </div>
    </div>
                </div>
        </div>
            <br style="clear: both;">
            <div id="footer">
                <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2025 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: Dec/14/2025 11:55:54<sup title="timezone offset" style="font-size:8px;">UTC</sup> (l3).</div>
                    <div>Desktop version, switch to <a rel="nofollow" class="switchToMobile" href="?mobile=true">mobile version</a>.</div>
                <div class="smaller">
                    <a href="/privacy">Privacy Policy</a>
                    |
                    <a href="/terms">Terms and Conditions</a>
                </div>

                    <div style="margin-top: 25px;">
                        Supported by
                    </div>
                    <div class="footer-logo-div" style="left: 30px;">
                        <a href="https://ton.org/"><img style="margin-right: 2em; width: 60px;" src="//codeforces.com/codeforces.org/s/52448/images/ton-100x100.png" alt="TON" title="TON"></a>
                        <div class="sep">&nbsp;</div>
                        <a href="https://en.itmo.ru/en/" class="itmo-logo"><img style="width: 140px;" src="//codeforces.com/codeforces.org/s/52448/images/itmo_small_en-logo.png" alt="ITMO University" title="ITMO University"></a>
                    </div>

            </div>
        <script type="text/javascript">
            $(function() {
                $(".switchToMobile").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "true"));
                    return false;
                });
                $(".switchToDesktop").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "false"));
                    return false;
                });
            });
        </script>
    <script type="text/javascript">
        $(document).ready(function () {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function () {
                    $(this).animate({
                        'opacity':'1'
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function () {
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }

            Codeforces.focusOnError();

            Codeforces.setCopiedToClipboardText("Copied to clipboard");
            Codeforces.listenCopyable();
        });
    </script>
    <div class="userListsFacebox" style="display:none;">
        <div style="padding: 0.5em; width: 600px; max-height: 200px; overflow-y: auto">
<div class="datatable" style="background-color: #E1E1E1; padding-bottom: 3px;">
            <div class="lt">&nbsp;</div>
            <div class="rt">&nbsp;</div>
            <div class="lb">&nbsp;</div>
            <div class="rb">&nbsp;</div>

            <div style="padding: 4px 0 0 6px;font-size:1.4rem;position:relative;">
                User lists

                <div style="position:absolute;right:0.25em;top:0.35em;">
                    <span style="padding:0;position:relative;bottom:2px;" class="rowCount"></span>

                    <img class="closed" src="//codeforces.com/codeforces.org/s/52448/images/icons/magnifier-medium.png">

                    <span class="filter" style="display:none;">
                        <img class="opened" src="//codeforces.com/codeforces.org/s/52448/images/icons/control-270.png">
                        <input style="padding:0 0 0 20px;position:relative;bottom:2px;border:1px solid #aaa;height:17px;font-size:1.3rem;">
                    </span>
                </div>
            </div>
            <div style="background-color: white;margin:0.3em 3px 0 3px;position:relative;">
            <div class="ilt">&nbsp;</div>
            <div class="irt">&nbsp;</div>
            <table class="">
                <thead>
                <tr>
                    <th draggable="true" class="top left right">Name</th>
                </tr>
                </thead>
                <tbody>
                <tr class="no-items visible"><td style="text-align:left;" colspan="32" class="bottom dark left right">No items</td></tr></tbody>
            </table>
            </div>
        </div>
    <script type="text/javascript">
        $(document).ready(function () {
                // Create new ':containsIgnoreCase' selector for search
                jQuery.expr[':'].containsIgnoreCase = function(a, i, m) {
                    return jQuery(a).text().toUpperCase()
                            .indexOf(m[3].toUpperCase()) >= 0;
                };

                if (window.updateDatatableFilter == undefined) {
                    window.updateDatatableFilter = function(i) {
                        var parent = $(i).parent().parent().parent().parent();
                        $("tr.no-items", parent).remove();
                        $("tr", parent).hide().removeClass('visible');
                        var text = $(i).val();
                        if (text) {
                            $("tr" + ":containsIgnoreCase('" + text + "')", parent).show().addClass('visible');
                        } else {
                            parent.find(".rowCount").text("");
                            $("tr", parent).show().addClass('visible');
                        }

                        var found = false;
                        var visibleRowCount = 0;
                        $("tr", parent).each(function () {
                            if (!found) {
                                if ($(this).find("th").size() > 0) {
                                    $(this).show().addClass('visible');
                                    found = true;
                                }
                            }
                            if ($(this).hasClass('visible')) {
                                visibleRowCount++;
                            }
                        });
                        if (text) {
                            parent.find(".rowCount").text("Matches: " + (visibleRowCount - (found ? 1 : 0)));
                        }
                        if (visibleRowCount == (found ? 1 : 0)) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo($(parent).find('table'));
                        }
                        $(parent).find("tr td").removeClass("dark");
                        $(parent).find("tr.visible:odd td").addClass("dark");
                    }

                    $(".datatable .closed").click(function () {
                        var parent = $(this).parent();
                        $(this).hide();
                        $(".filter", parent).fadeIn(function () {
                            $("input", parent).val("").focus().css("border", "1px solid #aaa");
                        });
                    });

                    $(".datatable .opened").click(function () {
                        var parent = $(this).parent().parent();
                        $(".filter", parent).fadeOut(function () {
                            $(".closed", parent).show();
                            $("input", parent).val("").each(function () {
                                window.updateDatatableFilter(this);
                            });
                        });
                    });

                    $(".datatable .filter input").keyup(function(e) {
                        window.updateDatatableFilter(this);
                        e.preventDefault();
                        e.stopPropagation();
                    });

                    $(".datatable table").each(function () {
                        var found = false;
                        $("tr", this).each(function () {
                            if (!found && $(this).find("th").size() == 0) {
                                found = true;
                            }
                        });
                        if (!found) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo(this);
                        }
                    });

                    // Applies styles to datatables.
                    $(".datatable").each(function () {
                        $(this).find("tr:first th").addClass("top");
                        $(this).find("tr:last td").addClass("bottom");
                        $(this).find("tr:odd td").addClass("dark");
                        $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                        $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                    });

                    $(".datatable table.tablesorter").each(function () {
                        $(this).bind("sortEnd", function () {
                            $(".datatable").each(function () {
                                $(this).find("th, td")
                                    .removeClass("top").removeClass("bottom")
                                    .removeClass("left").removeClass("right")
                                    .removeClass("dark");
                                $(this).find("tr:first th").addClass("top");
                                $(this).find("tr:last td").addClass("bottom");
                                $(this).find("tr:odd td").addClass("dark");
                                $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                                $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                            });
                        });
                    });
                }
        });
    </script>
        </div>
    </div>
    <script type="application/javascript">
        $(function() {
            $(".userListMarker").click(function() {
                $.post("/data/lists", {action: "findTouched"}, function(json) {
                    Codeforces.facebox(".userListsFacebox");
                    var tbody = $("#facebox tbody");
                    tbody.empty();
                    for (var i in json) {
                        tbody.append(
                            $("<tr></tr>").append(
                                $("<td></td>").attr("data-readKey", json[i].readKey).text(json[i].name)
                            )
                        );
                    }
                    Codeforces.updateDatatables();
                    tbody.find("td").css("cursor", "pointer").click(function() {
                        document.location = Codeforces.updateUrlParameter(document.location.href, "list", $(this).attr("data-readKey"));
                    });
                }, "json");
            });
        });
    </script>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-52448.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9add83d00fada73f',t:'MTc2NTcxMzM1NA=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;version&quot;:&quot;2024.11.0&quot;,&quot;token&quot;:&quot;316c29dfa3804effb5a91c52a59b5bd0&quot;,&quot;server_timing&quot;:{&quot;name&quot;:{&quot;cfCacheStatus&quot;:true,&quot;cfEdge&quot;:true,&quot;cfExtPri&quot;:true,&quot;cfL4&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfSpeedBrain&quot;:true},&quot;location_startswith&quot;:null}}" crossorigin="anonymous"></script>


<div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div id="swfcontainer" style="visibility: visible;"></div><div id="userdata_el" style="visibility: hidden; position: absolute;"></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_AMS, monospace;"></div></div></body></html>