<html lang="en"><head>
        <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-K230KVN22K&amp;cx=c&amp;gtm=4e5ca1"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="dfc70cbdda3ac8170ab2f0a5fa5279ef">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01">
    <meta name="robots" content="noai">
    <meta name="robots" content="noimageai">

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="l3">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <link rel="image_src" href="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <meta property="og:title" content="Codeforces Round 1048 (Div. 1, Div. 2) Editorial - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>Codeforces Round 1048 (Div. 1, Div. 2) Editorial - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/font-awesome.min.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/line-awesome.min.css" type="text/css" charset="utf-8">

        <link rel="preconnect" href="https://challenges.cloudflare.com">
        <link rel="dns-prefetch" href="https://challenges.cloudflare.com">
        <link href="//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">
        <link href="//fonts.googleapis.com/css?family=Cuprum&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.com/codeforces.org/s/52448/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.com/codeforces.org/s/52448/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.com/codeforces.org/s/52448/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.com/codeforces.org/s/52448/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.com/codeforces.org/s/52448/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.com/codeforces.org/s/52448/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.com/codeforces.org/s/52448/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.com/codeforces.org/s/52448/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.com/codeforces.org/s/52448/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="//codeforces.com/codeforces.org/s/52448/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.com/codeforces.org/s/52448/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.com/codeforces.org/s/52448/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.com/codeforces.org/s/52448/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.com/codeforces.org/s/52448/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.jgrowl.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.wysiwyg.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.autocomplete.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/codeforces.datepick.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.drafts.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/community.css" type="text/css" charset="utf-8">

    <!-- MathJax -->
    <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async="" src="https://codeforces.com/mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full">
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/5913b958cb6e1f2144469a313cc0ac6e/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/confetti.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/purify.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/skins/markitup/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/style.css" type="text/css" charset="utf-8">


    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




<style type="text/css" media="screen">#swfcontainer {visibility:hidden}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888; display: contents}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.9') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" src="https://codeforces.com/mathjax.codeforces.org/jax/output/HTML-CSS/fonts/TeX/Typewriter/Regular/Main.js?V=2.7.9"></script></head>
<body class=" "><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-6"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-7"><span class="mn" id="MathJax-Span-8" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-9"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-13"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-15"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-16"><span class="mn" id="MathJax-Span-17" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-18"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-19"><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-21"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-22"><span class="mfrac" id="MathJax-Span-23"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.52em, 1000.38em, 4.169em, -999.997em); top: -4.435em; left: 50%; margin-left: -0.16em;"><span class="mi" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1000.33em, 4.169em, -999.997em); top: -3.623em; left: 50%; margin-left: -0.16em;"><span class="mi" id="MathJax-Span-25" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1000.49em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.49em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-26"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-29"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-30"><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-33"><span class="mn" id="MathJax-Span-34" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-35"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-36"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-38"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-39"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-42"><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-44"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-45"><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-47"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-48"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-50"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main; padding-left: 0.219em;">×</span><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-58"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-59"><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">min</span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">n</span><span class="mo" id="MathJax-Span-65" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-66"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-67"><span class="msubsup" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mn" id="MathJax-Span-70" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="msubsup" id="MathJax-Span-74" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-77"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-78"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-81"><span class="msubsup" id="MathJax-Span-82"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mn" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-85"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-86"><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-89" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-90"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-91"><span class="msubsup" id="MathJax-Span-92"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mn" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-95"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-96"><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-98"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-99"><span class="msubsup" id="MathJax-Span-100"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-102"><span class="mrow" id="MathJax-Span-103"><span class="msubsup" id="MathJax-Span-104"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.332em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-105" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-106" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main; padding-left: 0.219em;">max</span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-110" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-111" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">m</span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">i</span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-116" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-118"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-119"><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-122" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-123"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-124"><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-126"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-127"><span class="munderover" id="MathJax-Span-128"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.52em, 1000.49em, 4.169em, -999.997em); top: -4.489em; left: 1.085em;"><span class="mi" id="MathJax-Span-130" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.25em, 4.169em, -999.997em); top: -3.731em; left: 1.085em;"><span class="texatom" id="MathJax-Span-131"><span class="mrow" id="MathJax-Span-132"><span class="mi" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-136" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Main; padding-left: 0.219em;">max</span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-142" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">m</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">i</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-150"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-151"><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">b</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-157"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-158"><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-160"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-161"><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-163"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-164"><span class="mn" id="MathJax-Span-165" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-166"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-167"><span class="mn" id="MathJax-Span-168" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-169"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-170"><span class="mn" id="MathJax-Span-171" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">a</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="msubsup" id="MathJax-Span-175" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-176" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="texatom" id="MathJax-Span-177"><span class="mrow" id="MathJax-Span-178"><span class="mi" id="MathJax-Span-179" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-180"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-181"><span class="msubsup" id="MathJax-Span-182"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-183" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="texatom" id="MathJax-Span-184"><span class="mrow" id="MathJax-Span-185"><span class="mi" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">b</span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="msubsup" id="MathJax-Span-190" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.843em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-191" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="texatom" id="MathJax-Span-192"><span class="mrow" id="MathJax-Span-193"><span class="mi" id="MathJax-Span-194" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-195" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-196" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-197"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-198"><span class="mn" id="MathJax-Span-199" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-200"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-201"><span class="mn" id="MathJax-Span-202" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-203" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">b</span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="msubsup" id="MathJax-Span-206" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-207" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="texatom" id="MathJax-Span-208"><span class="mrow" id="MathJax-Span-209"><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-211"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-212"><span class="mn" id="MathJax-Span-213" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-214"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-215"><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-219" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.843em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-220" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="texatom" id="MathJax-Span-221"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-224" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-225" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">x</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-229"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-230"><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-232"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-233" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-234" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-236" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-237" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-238" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-240"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-241"><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-244" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">b</span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-247"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-248"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">b</span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main; padding-left: 0.273em;">≠</span><span class="mn" id="MathJax-Span-253" style="font-family: MathJax_Main; padding-left: 0.273em;">0</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-254"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-255"><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-258" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">i</span><span class="mo" id="MathJax-Span-259" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="msubsup" id="MathJax-Span-260" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.247em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-261" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="texatom" id="MathJax-Span-262"><span class="mrow" id="MathJax-Span-263"><span class="msubsup" id="MathJax-Span-264"><span style="display: inline-block; position: relative; width: 0.652em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.332em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-265" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-266" style="font-size: 50%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-268"><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">j</span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="msubsup" id="MathJax-Span-273" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-274" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="texatom" id="MathJax-Span-275"><span class="mrow" id="MathJax-Span-276"><span class="msubsup" id="MathJax-Span-277"><span style="display: inline-block; position: relative; width: 0.652em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.332em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-279" style="font-size: 50%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-45-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-280"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-281"><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-46-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-283"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-284"><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math-italic;">j</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-47-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-286"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-287"><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-289" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">b</span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="msubsup" id="MathJax-Span-292" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.843em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-293" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="texatom" id="MathJax-Span-294"><span class="mrow" id="MathJax-Span-295"><span class="mi" id="MathJax-Span-296" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-297" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-298" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-48-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-299"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-300"><span class="mn" id="MathJax-Span-301" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="msubsup" id="MathJax-Span-303" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="msubsup" id="MathJax-Span-307" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-309" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-310" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">k</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-49-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-312"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-313"><span class="mn" id="MathJax-Span-314" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-50-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-315"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-316"><span class="mn" id="MathJax-Span-317" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-51-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-318"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-319"><span class="msubsup" id="MathJax-Span-320"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-322" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-52-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-324"><span class="msubsup" id="MathJax-Span-325"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-326" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-327" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-53-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-328"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-329"><span class="mn" id="MathJax-Span-330" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-54-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-331"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-332"><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-55-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-334"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-338" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-56-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-341"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-342"><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-57-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-344"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-345"><span class="mi" id="MathJax-Span-346" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-349" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main; padding-left: 0.273em;">≠</span><span class="mi" id="MathJax-Span-351" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-354" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-58-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-355"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-356"><span class="mn" id="MathJax-Span-357" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-358" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">i</span><span class="mo" id="MathJax-Span-360" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-361" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">j</span><span class="mo" id="MathJax-Span-362" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">k</span><span class="mo" id="MathJax-Span-364" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-59-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-366"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-367"><span class="msubsup" id="MathJax-Span-368"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-370" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-371" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-372" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-373" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-374" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-375" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-376" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-378" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-60-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-379"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-380"><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-61-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-382"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-62-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-385"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-386"><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-388" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-389" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-390" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-63-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-391"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-64-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-394"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-395"><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-65-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-397"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-398"><span class="msubsup" id="MathJax-Span-399"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-401" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-402" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-403" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-405"><span class="mrow" id="MathJax-Span-406"><span class="mi" id="MathJax-Span-407" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-408" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-409" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-411" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-412" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-413"><span class="mrow" id="MathJax-Span-414"><span class="mi" id="MathJax-Span-415" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-416" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-417" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-66-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-418"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-419"><span class="mn" id="MathJax-Span-420" style="font-family: MathJax_Main;">3</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-67-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-421"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-422"><span class="mn" id="MathJax-Span-423" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-68-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-424"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-425"><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-429" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-69-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-430"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-431"><span class="mi" id="MathJax-Span-432" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-433" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-434" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-435" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-70-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-436"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-437"><span class="mn" id="MathJax-Span-438" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-71-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-439"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-440"><span class="mn" id="MathJax-Span-441" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">i</span><span class="mo" id="MathJax-Span-444" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-445" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">j</span><span class="mo" id="MathJax-Span-446" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">k</span><span class="mo" id="MathJax-Span-448" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mi" id="MathJax-Span-449" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">m</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-72-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-450"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-451"><span class="msubsup" id="MathJax-Span-452"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-454" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-456" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-458" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-460" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-461" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-462" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-73-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-463"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-466" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-467" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">k</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-74-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-468"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-469"><span class="msubsup" id="MathJax-Span-470"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-471" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-472" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-75-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-473"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-474"><span class="msubsup" id="MathJax-Span-475"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-477" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-76-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-478"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-479"><span class="msubsup" id="MathJax-Span-480"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-481" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-482" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-77-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-483"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-484"><span class="msubsup" id="MathJax-Span-485"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-486" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-487" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-78-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-488"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-489"><span class="msubsup" id="MathJax-Span-490"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-491" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-492" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-79-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-493"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-494"><span class="msubsup" id="MathJax-Span-495"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-496" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-497" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-498" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-499" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-500" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-501" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-80-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-502"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-503"><span class="msubsup" id="MathJax-Span-504"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-506" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-508" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-510" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-512" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-513" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-514" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-81-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-515"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-516"><span class="msubsup" id="MathJax-Span-517"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-519" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-82-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-520"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-521"><span class="msubsup" id="MathJax-Span-522"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-524" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-83-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-525"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-526"><span class="msubsup" id="MathJax-Span-527"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-528" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-529" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-530" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-531" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-533" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-535" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-536" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-537" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-84-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-538"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-539"><span class="mn" id="MathJax-Span-540" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-85-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-541"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-542"><span class="msubsup" id="MathJax-Span-543"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-544" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-86-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-546"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-547"><span class="mn" id="MathJax-Span-548" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-87-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-549"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-550"><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-88-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-552"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-553"><span class="msubsup" id="MathJax-Span-554"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-555" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-556" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-558" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="texatom" id="MathJax-Span-560"><span class="mrow" id="MathJax-Span-561"><span class="mi" id="MathJax-Span-562" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-563" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-564" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-89-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-565"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-566"><span class="mi" id="MathJax-Span-567" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-90-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-568"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-569"><span class="msubsup" id="MathJax-Span-570"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-571" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-573" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-574" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-575" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="texatom" id="MathJax-Span-576"><span class="mrow" id="MathJax-Span-577"><span class="mi" id="MathJax-Span-578" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-579" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-580" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-581" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-582" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="texatom" id="MathJax-Span-584"><span class="mrow" id="MathJax-Span-585"><span class="mi" id="MathJax-Span-586" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-587" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-588" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-91-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-589"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-590"><span class="mi" id="MathJax-Span-591" style="font-family: MathJax_Math-italic;">b</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-92-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-592"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-593"><span class="mn" id="MathJax-Span-594" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-93-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-595"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-596"><span class="mi" id="MathJax-Span-597" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-94-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-598"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-599"><span class="msubsup" id="MathJax-Span-600"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-602" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-603" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="msubsup" id="MathJax-Span-604" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="texatom" id="MathJax-Span-606"><span class="mrow" id="MathJax-Span-607"><span class="mi" id="MathJax-Span-608" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-609" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-610" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-95-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-611"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-612"><span class="mn" id="MathJax-Span-613" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-96-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-614"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-615"><span class="mn" id="MathJax-Span-616" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-97-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-617"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-618"><span class="mi" id="MathJax-Span-619" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-620" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-621" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-623" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-625" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-626" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-627" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-98-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-629"><span class="mn" id="MathJax-Span-630" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-99-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-631"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-632"><span class="mn" id="MathJax-Span-633" style="font-family: MathJax_Main;">3</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-100-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-634"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-635"><span class="mi" id="MathJax-Span-636" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-637" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-638" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-640" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-642" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-643" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-644" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-101-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-645"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-646"><span class="msubsup" id="MathJax-Span-647"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-648" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-649" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-102-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-650"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-651"><span class="msubsup" id="MathJax-Span-652"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mi" id="MathJax-Span-654" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-103-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-655"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-656"><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-658" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-104-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-659"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-660"><span class="msubsup" id="MathJax-Span-661"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-662" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-663"><span class="mrow" id="MathJax-Span-664"><span class="msubsup" id="MathJax-Span-665"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px;"><span style="position: absolute; clip: rect(3.358em, 1000.16em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-666" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.219em;"><span class="mi" id="MathJax-Span-667" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-668" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-669" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-670" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-671" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-105-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-672"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-673"><span class="msubsup" id="MathJax-Span-674"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-675" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-676" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-106-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-677"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-678"><span class="mo" id="MathJax-Span-679" style="font-family: MathJax_Main;">&gt;</span><span class="mi" id="MathJax-Span-680" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">i</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-107-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-681"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-682"><span class="msubsup" id="MathJax-Span-683"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-684" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-685"><span class="mrow" id="MathJax-Span-686"><span class="msubsup" id="MathJax-Span-687"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px;"><span style="position: absolute; clip: rect(3.52em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-688" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.893em; left: 0.327em;"><span class="mi" id="MathJax-Span-689" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-690" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="msubsup" id="MathJax-Span-691" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-692" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-693" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processed" id="MathJax-Element-108-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-694"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-695"><span class="mo" id="MathJax-Span-696" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-697" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-698" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-699" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-700" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0" style=""></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-112-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-113-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-116-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-118-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-121-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-123-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-125-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-127-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-132-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-134-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-135-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-140-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-141-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-142-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-143-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-144-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-145-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-146-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-147-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-148-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-149-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-150-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-151-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-152-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-153-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-154-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-155-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-156-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-157-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-158-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-159-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-160-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-161-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-162-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-163-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-164-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-165-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-166-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-167-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-168-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-169-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-170-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-171-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-172-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-173-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-174-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-175-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-176-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-177-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-178-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-179-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-180-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-181-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-182-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-183-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-184-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-185-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-186-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-187-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-190-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-191-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-192-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-193-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-194-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-195-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-196-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-197-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-198-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-199-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-200-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-201-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-202-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-203-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-204-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-205-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-206-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-207-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-208-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-209-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-210-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-211-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-212-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-213-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-214-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-215-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-216-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-217-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-218-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-219-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-220-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-221-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-222-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-223-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-224-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-225-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-226-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-227-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-228-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-229-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-230-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-231-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-232-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-233-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-234-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-235-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-236-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-237-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-238-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-239-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-240-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-241-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-242-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-243-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-244-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-245-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-246-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-247-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-248-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-249-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-250-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-251-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-252-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-253-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-254-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-255-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-256-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-257-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-258-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-259-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-260-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-261-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-262-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-263-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-264-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-265-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-266-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-267-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-268-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-269-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-270-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-271-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-272-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-273-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-274-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-275-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-276-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-277-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-278-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-279-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-280-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-281-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-282-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-283-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-284-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-285-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-286-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-287-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-288-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-289-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-290-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-291-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-292-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-293-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-294-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-295-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-296-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-297-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-298-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-299-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-300-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-301-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-302-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-303-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-304-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-305-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-306-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-307-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-308-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-309-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-310-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-311-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-312-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-313-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-314-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-315-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-316-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-317-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-318-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-319-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-320-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-321-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-322-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-323-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-324-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-325-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-326-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-327-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-328-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-329-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-330-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-331-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-332-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-333-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-334-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-335-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-336-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-337-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-338-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-339-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-340-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-341-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-342-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-343-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-344-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-345-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-346-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-347-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-348-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-349-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-350-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-351-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-352-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-353-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-354-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-355-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-356-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-357-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-358-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-359-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-360-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-361-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-362-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-363-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-364-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-365-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-366-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-367-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-368-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-369-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-370-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-371-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-372-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-373-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-374-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-375-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-376-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-377-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-378-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-379-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-380-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-381-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-382-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-383-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-384-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-385-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-386-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-387-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-388-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-389-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-390-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-391-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-392-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-393-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-394-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-395-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-396-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-397-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-398-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-399-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-400-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-401-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-402-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-403-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-404-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-405-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-406-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-407-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-408-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-409-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-410-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-411-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-413-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-414-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-415-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-416-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-417-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-418-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-419-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-420-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-421-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-422-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-423-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-424-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-425-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-426-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-427-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-428-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-429-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-430-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-431-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-432-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-433-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-434-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-435-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-436-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-437-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-438-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-439-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-440-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-441-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-442-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-443-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-444-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-445-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-446-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-447-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-448-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-449-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-450-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-451-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-452-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-453-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-454-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-455-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-456-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-457-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-458-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-459-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-460-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-461-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-462-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-463-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-464-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-465-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-466-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-467-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-468-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-469-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-470-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-471-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-472-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-473-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-474-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-475-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-476-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-477-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-478-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-479-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-480-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-481-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-482-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-483-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-484-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-485-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-486-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-487-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-488-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-489-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-490-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-491-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-492-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-493-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-494-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-495-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-496-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-497-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-498-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-499-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-500-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-501-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-502-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-503-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-504-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-505-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-506-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-507-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-508-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-509-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-510-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-511-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-512-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-513-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-514-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-515-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-516-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-517-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-518-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-519-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-520-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-521-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-522-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-523-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-524-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-525-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-526-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-527-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-528-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-529-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-530-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-531-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-532-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-533-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-534-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-535-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-536-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-537-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-538-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-539-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-540-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-541-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-542-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-543-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-544-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-545-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-546-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-547-Frame" tabindex="0"></span><br><span class="MathJax MathJax_Processing" id="MathJax-Element-548-Frame" tabindex="0"></span><br></div></div><div id="MathJax_Message" style="display: none;"></div><span style="display:none;" class="csrf-token" data-csrf="dfc70cbdda3ac8170ab2f0a5fa5279ef">&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }, beforeSend: function(jqXHR, settings) {
        const url = new URL(settings.url, window.location.href);
        const urlHref = url.href;
        url.searchParams.set('rv', Math.random().toString(36).substr(2, 9)); // Generate a random value
        settings.url = url.href;
    }});

    window.updateTypography();
    Codeforces.signForms();
    Codeforces.applyDatatableJs("Hold Ctrl+Alt and click to hide column. Also, you can drag&drop columns to reorder them.");

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        if (json.t === "a") {
            setTimeout(function() {
               Codeforces.showAnnouncements(json.d, "en");
            }, Math.random() * 500);
        }
    }

    function showEventCatcherUserMessage(json) {
        if (json.t === "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        const title = $(this).attr("data-title");
        const clazz = $(this).attr("data-clazz");
        const props = {};
        if (typeof (clazz) !== 'undefined') {
            props['clazz'] = clazz;
        }
        if (title) {
            Codeforces.alert(title, null, null, props);
        } else {
            Codeforces.alert($(this).attr("title"), null, null, props);
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
        

<div class="side-bell" style="visibility: hidden; display: none; opacity: 0.7; width: 40px; position: fixed; right: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 1.5rem;">
    <span class="icon-stack" style="width: 100%;">
        <i class="icon-circle icon-stack-base"></i>
        <i class="icon-bell-alt icon-light"></i>
    </span>
    <br>
    <span class="side-bell__count" style="position: relative; top: -10px;"></span>
</div>


<div id="header" style="position: relative;">

    <div style="float:left; max-height: 60px;">
                            <a href="/"><img height="65" style="height: 65px;" alt="Codeforces" title="Codeforces" src="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png"></a>
    </div>
    <div class="lang-chooser">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" title="In English" alt="In English"></a>
                <a href="?locale=ru"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/ru.png" title="По-русски" alt="По-русски"></a>
            </div>

        <div>
                        <a href="/enter?back=%2Fblog%2Fentry%2F146172">Enter</a>
                     | 
                        <a href="/register">Register</a>
                    
        </div>

    </div>
    <br style="clear: both;">
</div>

        


    <div class="roundbox menu-box borderTopRound borderBottomRound" style="">
    <div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="/">Home</a></li>
                <li class=""><a href="/top">Top</a></li>
                <li class=""><a href="/catalog">Catalog</a></li>
                <li class=""><a href="/contests">Contests</a></li>
                <li class=""><a href="/gyms">Gym</a></li>
                <li class=""><a href="/problemset">Problemset</a></li>
                <li class=""><a href="/groups">Groups</a></li>
                <li class=""><a href="/ratings">Rating</a></li>
                <li class=""><a href="/edu/courses"><span class="edu-menu-item">Edu</span></a></li>
                <li class=""><a href="/apiHelp">API</a></li>
                <li class=""><a href="/calendar">Calendar</a></li>
                <li class=""><a href="/help">Help</a></li>
    </ul>
        <form method="post" action="/search"><input type="hidden" name="csrf_token" value="dfc70cbdda3ac8170ab2f0a5fa5279ef">
            <input class="search" name="query" data-isplaceholder="true" value="">
        <input type="hidden" name="_tta" value="93"></form>
    <br style="clear: both;">
</div>

    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("input.search").focus(function () {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
        
            <br style="height: 3em; clear: both;">

        <div style="position: relative;">
                        <div id="sidebar">

    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Pay attention
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
        <div style="text-align:center;">
            <span class="contest-state-phase">Before contest</span><br><a href="/contests/2181">2025-2026 ICPC, NERC, Northern Eurasia Finals (Unrated, Online Mirror, ICPC Rules, Teams Preferred)</a><br><span class="countdown" home="//codeforces.com/codeforces.org/s/52448" noredirection="true" textbeforeredirect="" cdid="i1"><span title="68:05:32">3 days</span></span><br><a href="/contestRegistration/2181">Register now »</a>
        </div>
</div>
    </div>

<style data-nocturne="true" type="text/css">
._StreamsSidebarFrame_frame {
  padding: 0.5em 0.5em 0 0.5em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream {
  text-align: center;
  border-bottom: 1px solid #b9b9b9;
  margin: 0 -0.5em 0.5em -0.5em;
  padding: 0 1em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_user {
  margin: 0 0 0.5em 0;
  font-size: 0.8em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_timeMark {
  color: #777;
  font-size: 0.9em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream:last-of-type {
  border-bottom: unset;
  margin: unset;
  padding: 0 0.5em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._viewAll {
  text-align: right;
}
.moreRunningStreamsSidebarNote {
  color: #777 !important;
  text-decoration: none;
}
</style>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Streams
            <div class="top-links">
            </div>
        </div>
            <div class="_StreamsSidebarFrame_frame">
                    <div class="_StreamsSidebarFrame_stream">
                        <div class="_StreamsSidebarFrame_name">
        <p class="_englishName _name">
            
            <a href="/stream/865">Repovive Opening Contest — Solution Discussion</a>
        </p>

                        </div>

                        <div class="_StreamsSidebarFrame_user">
                            By <a href="/profile/Shayan" title="International Grandmaster Shayan" class="rated-user user-red">Shayan</a>
                        </div>

                            <div class="_StreamsSidebarFrame_countdown _StreamsSidebarFrame_timeMark">
                                Before stream
                                <span class="countdown" noredirection="true" cdid="i2">05:40:32</span>
                            </div>
                    </div>
            </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/streams">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

<script data-nocturne="true"> $(function () {

}); </script>


<div class="roundbox sidebox top-contributed borderTopRound " style="">
<div class="caption titled">→ Top rated
<div class="top-links">
</div>
</div>
<table class="rtable ">
<tbody>
<tr>
<th class="left" style="width:2.25em;">#</th>
<th class="">User</th>
<th class="" style="width:5em;">Rating</th>
</tr>
<tr>
<td class="left dark">1</td>
<td class=" dark"><a href="/profile/Kevin114514" title="Legendary Grandmaster Kevin114514" class="rated-user user-legendary"><span class="legendary-user-first-letter">K</span>evin114514</a></td>
<td class=" dark">3765</td>
</tr>
<tr>
<td class="left ">2</td>
<td class=""><a href="/profile/tourist" title="Legendary Grandmaster tourist" class="rated-user user-legendary"><span class="legendary-user-first-letter">t</span>ourist</a></td>
<td class="">3757</td>
</tr>
<tr>
<td class="left dark">3</td>
<td class=" dark"><a href="/profile/Benq" title="Legendary Grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></td>
<td class=" dark">3738</td>
</tr>
<tr>
<td class="left ">4</td>
<td class=""><a href="/profile/jiangly" title="Legendary Grandmaster jiangly" class="rated-user user-legendary"><span class="legendary-user-first-letter">j</span>iangly</a></td>
<td class="">3705</td>
</tr>
<tr>
<td class="left dark">5</td>
<td class=" dark"><a href="/profile/orzdevinwang" title="Legendary Grandmaster orzdevinwang" class="rated-user user-legendary"><span class="legendary-user-first-letter">o</span>rzdevinwang</a></td>
<td class=" dark">3670</td>
</tr>
<tr>
<td class="left ">6</td>
<td class=""><a href="/profile/ksun48" title="Legendary Grandmaster ksun48" class="rated-user user-legendary"><span class="legendary-user-first-letter">k</span>sun48</a></td>
<td class="">3668</td>
</tr>
<tr>
<td class="left dark">7</td>
<td class=" dark"><a href="/profile/Radewoosh" title="Legendary Grandmaster Radewoosh" class="rated-user user-legendary"><span class="legendary-user-first-letter">R</span>adewoosh</a></td>
<td class=" dark">3531</td>
</tr>
<tr>
<td class="left ">8</td>
<td class=""><a href="/profile/maroonrk" title="Legendary Grandmaster maroonrk" class="rated-user user-legendary"><span class="legendary-user-first-letter">m</span>aroonrk</a></td>
<td class="">3443</td>
</tr>
<tr>
<td class="left dark">9</td>
<td class=" dark"><a href="/profile/dXqwq" title="Legendary Grandmaster dXqwq" class="rated-user user-legendary"><span class="legendary-user-first-letter">d</span>Xqwq</a></td>
<td class=" dark">3436</td>
</tr>
<tr>
<td class="left bottom">10</td>
<td class="bottom"><a href="/profile/Nachia" title="Legendary Grandmaster Nachia" class="rated-user user-legendary"><span class="legendary-user-first-letter">N</span>achia</a></td>
<td class="bottom">3432</td>
</tr>
</tbody>
</table>
<div class="bottom-links">
<table style="width:100%;">
<tbody>
<tr>
<td style="text-align:left;">
<a href="/ratings/countries">Countries</a> |
<a href="/ratings/cities">Cities</a> |
<a href="/ratings/organizations">Organizations</a>
</td>
<td style="text-align:right;">
<a href="/ratings">View all →</a>
</td>
</tr>
</tbody>
</table>
</div>
</div>


    <div class="roundbox sidebox top-contributed borderTopRound " style="">
        <div class="caption titled">→ Top contributors
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:2.25em;">#</th>
                            <th class="">User</th>
                            <th class="" style="width:5em;">Contrib.</th>
                </tr>
                    <tr>
                                <td class="left  dark">1</td>
                                <td class=" dark"><a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a></td>
                                <td class=" dark">169</td>
                    </tr>
                    <tr>
                                <td class="left ">2</td>
                                <td class=""><a href="/profile/Qingyu" title="Legendary Grandmaster Qingyu" class="rated-user user-legendary"><span class="legendary-user-first-letter">Q</span>ingyu</a></td>
                                <td class="">166</td>
                    </tr>
                    <tr>
                                <td class="left  dark">3</td>
                                <td class=" dark"><a href="/profile/errorgorn" title="Legendary Grandmaster errorgorn" class="rated-user user-legendary"><span class="legendary-user-first-letter">e</span>rrorgorn</a></td>
                                <td class=" dark">163</td>
                    </tr>
                    <tr>
                                <td class="left ">4</td>
                                <td class=""><a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a></td>
                                <td class="">156</td>
                    </tr>
                    <tr>
                                <td class="left  dark">5</td>
                                <td class=" dark"><a href="/profile/Proof_by_QED" title="Master Proof_by_QED" class="rated-user user-orange">Proof_by_QED</a></td>
                                <td class=" dark">152</td>
                    </tr>
                    <tr>
                                <td class="left ">6</td>
                                <td class=""><a href="/profile/Dominater069" title="Legendary Grandmaster Dominater069" class="rated-user user-legendary"><span class="legendary-user-first-letter">D</span>ominater069</a></td>
                                <td class="">150</td>
                    </tr>
                    <tr>
                                <td class="left  dark">7</td>
                                <td class=" dark"><a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a></td>
                                <td class=" dark">149</td>
                    </tr>
                    <tr>
                                <td class="left ">8</td>
                                <td class=""><a href="/profile/TheScrasse" title="Grandmaster TheScrasse" class="rated-user user-red">TheScrasse</a></td>
                                <td class="">144</td>
                    </tr>
                    <tr>
                                <td class="left  dark">9</td>
                                <td class=" dark"><a href="/profile/soullless" title="Master soullless" class="rated-user user-orange">soullless</a></td>
                                <td class=" dark">143</td>
                    </tr>
                    <tr>
                                <td class="left bottom">10</td>
                                <td class="bottom"><a href="/profile/Arpa" title="International Master Arpa" class="rated-user user-orange">Arpa</a></td>
                                <td class="bottom">141</td>
                    </tr>
            </tbody>
        </table>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/top-contributed">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
        });
    </script>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Find user
            <div class="top-links">
            </div>
        </div>
        <form class="handleForm" method="post" autocomplete="off"><input type="hidden" name="csrf_token" value="dfc70cbdda3ac8170ab2f0a5fa5279ef">
            <div style="padding:1em;text-align:right;">
                <label style="padding-right:1em;">Handle:
                    <input style="width:12em;" type="text" class="handleBox ac_input" autocomplete="off">
                </label>
            </div>
            <div style="padding: 0 1em 1em 1em;text-align:right;">
                <input style="height:1.65em;padding:0 0.75em;" type="submit" value="Find">
            </div>
        <input type="hidden" name="_tta" value="93"></form>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".handleBox").autocompleteHandle();
    $(".handleForm").attr("autocomplete", "off").submit(function () {
        var link = "/profile/userHandle".replace(
            "userHandle", $(this).find(".handleBox").val()
        );
        window.location = link;
        return false;
    });
        });
    </script>





    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Recent actions
            <div class="top-links">
            </div>
        </div>
        <div class="recent-actions">
            <ul>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/kisuke_007" title="Pupil kisuke_007" class="rated-user user-green">kisuke_007</a>        →
        <a href="/blog/entry/110589">How to fix this?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ABalobanov" title="Expert ABalobanov" class="rated-user user-blue">ABalobanov</a>        →
        <a href="/blog/entry/149154">Codeforces Round 1070 (Div.2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/atcoder_official" title="Unrated, atcoder_official" class="rated-user user-black">atcoder_official</a>        →
        <a href="/blog/entry/149183">AtCoder Beginner Contest 436 Announcement</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/147893">Hacker Cup Round 1 Recap</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/MathModel" title="Expert MathModel" class="rated-user user-blue">MathModel</a>        →
        <a href="/blog/entry/149013">Invitation to Eolymp Blitz #8 (Rating Upto 1750)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Coxin_Hor" title="Expert Coxin_Hor" class="rated-user user-blue">Coxin_Hor</a>        →
        <a href="/blog/entry/149220">A fun contest I created myself.</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/saPaul" title="Pupil saPaul" class="rated-user user-green">saPaul</a>        →
        <a href="/blog/entry/149221">[Update] CF FetchCodes v25.12.7: Smart Retries, Lazy Loading &amp; Instant Caching!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a>        →
        <a href="/blog/entry/149218">Finding all primes up to half a billion in 83 ms</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/awoo" title="Grandmaster awoo" class="rated-user user-red">awoo</a>        →
        <a href="/blog/entry/117791">Educational Codeforces Round 151 Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/alireza_kaviani" title="International Grandmaster alireza_kaviani" class="rated-user user-red">alireza_kaviani</a>        →
        <a href="/blog/entry/148411">Repovive Opening Contest</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/flamestorm" title="International Master flamestorm" class="rated-user user-orange">flamestorm</a>        →
        <a href="/blog/entry/104310">Codeforces Round #803 (Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SilverTongue1729" title="Candidate Master SilverTongue1729" class="rated-user user-violet">SilverTongue1729</a>        →
        <a href="/blog/entry/149213">Codeforces Profile Preview — Chrome Extension</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Xiaohuba" title="Master Xiaohuba" class="rated-user user-orange">Xiaohuba</a>        →
        <a href="/blog/entry/148062">Codeforces Global Round 30</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Ashwanth.K" title="Master Ashwanth.K" class="rated-user user-orange">Ashwanth.K</a>        →
        <a href="/blog/entry/149201">SOS DP easy understanding</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/BreakingNut" title="Specialist BreakingNut" class="rated-user user-cyan">BreakingNut</a>        →
        <a href="/blog/entry/149177">Solved the Problem, Lost the Girlfriend</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ProblemTerminator" title="International Master ProblemTerminator" class="rated-user user-orange">ProblemTerminator</a>        →
        <a href="/blog/entry/149005">pls ban cheater sinha_yash and rollback the rating</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a>        →
        <a href="/blog/entry/137325">GIFs in Problem Statements are Broken</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a>        →
        <a href="/blog/entry/146705">On AI ruining "solving math problems with computer" [a year later]</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/m_manasc" title="Pupil m_manasc" class="rated-user user-green">m_manasc</a>        →
        <a href="/blog/entry/149219">An interesting problem</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/148802">Meta Hacker Cup Round 3</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Top12" title="Expert Top12" class="rated-user user-blue">Top12</a>        →
        <a href="/blog/entry/149216">From TLE to AC using magic!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/TheScrasse" title="Grandmaster TheScrasse" class="rated-user user-red">TheScrasse</a>        →
        <a href="/blog/entry/148631">Codeforces Round 1066 (Div. 1 + Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/MohamedAboOkail" title="Specialist MohamedAboOkail" class="rated-user user-cyan">MohamedAboOkail</a>        →
        <a href="/blog/entry/149116">Removing the cheaters</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ibrm" title="Candidate Master ibrm" class="rated-user user-violet">ibrm</a>        →
        <a href="/blog/entry/147532">Bots?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Shisuko" title="Master Shisuko" class="rated-user user-orange">Shisuko</a>        →
        <a href="/blog/entry/149199">2025 ICPC Asia Manila Regional (Gym) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
            </ul>
        </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/recent-actions">Detailed →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>
</div>
                        <div id="pageContent" class="content-with-sidebar">
                    <div class="second-level-menu">
<ul class="second-level-menu-list"><li class="backLava" style="position: absolute; display: block; margin: 0px; padding: 0px; left: 57.5781px; top: 0px; width: 39px; height: 20px;"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li><a href="/profile/installb">installb</a></li>
        <li class="current selectedLava"><a href="/blog/installb">Blog</a></li>
        <li><a href="/teams/with/installb">Teams</a></li>
        <li><a href="/submissions/installb">Submissions</a></li>
        <li><a href="/groups/with/installb">Groups</a></li>
        <li><a href="/contests/with/installb">Contests</a></li>
        <li><a href="/contests/writer/installb">Problemsetting</a></li>
</ul>
</div>
    <div style="margin-top:0;">
    <div>
        <h3><a href="/blog/installb" style="text-decoration:none;color:black !important;">installb's blog</a></h3>
    </div>
        <div style="margin-top:2em;">


<div class="has-topic-id topic" topicid="146808">
    <div class="title">
            <a href="/blog/entry/146172">            <p>Codeforces Round 1048 (Div. 1, Div. 2) Editorial</p>
</a>
    </div>

        <div class="info" style="position:relative;">
                By&nbsp;<a href="/profile/installb" title="Grandmaster installb" class="rated-user user-red">installb</a>,
                    <a href="/topic/146808/en33">history</a>,
                    <span class="format-humantime" title="Sep/08/2025 16:38 UTC">3 months ago</span>,
                
                <img style="position: relative;top: 5px;" src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" alt="In English" title="In English">



            <div class="topic-actions smaller">
                <ul>


                </ul>
            </div>
        </div>

    <div class="content">
        <div class="ttypography"><p><a href="https://codeforces.com/contest/2139/problem/A">2139A — Maple and Multiplication</a></p><p>Idea: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a> Preparation: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a>,<a class="rated-user user-orange" href="/profile/2014CAIS01" title="International Master 2014CAIS01">2014CAIS01</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">a</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">b</span></span></span><script type="math/tex" id="MathJax-Element-1">a=b</script> we need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mn" id="MJXp-Span-6">0</span></span></span><script type="math/tex" id="MathJax-Element-2">0</script> steps.</p><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">a</span></span></span><script type="math/tex" id="MathJax-Element-3">a</script> can be divided by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">b</span></span></span><script type="math/tex" id="MathJax-Element-4">b</script>, we only need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mn" id="MJXp-Span-12">1</span></span></span><script type="math/tex" id="MathJax-Element-5">1</script> step, which is to multiply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">b</span></span></span><script type="math/tex" id="MathJax-Element-6">b</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mfrac" id="MJXp-Span-16" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">a</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">b</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-7">\frac{a}{b}</script>. Same for the case when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">b</span></span></span><script type="math/tex" id="MathJax-Element-8">b</script> can be divided by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">a</span></span></span><script type="math/tex" id="MathJax-Element-9">a</script>.</p><p>Otherwise, we need at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mn" id="MJXp-Span-24">2</span></span></span><script type="math/tex" id="MathJax-Element-10">2</script> steps. As both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">a</span></span></span><script type="math/tex" id="MathJax-Element-11">a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">b</span></span></span><script type="math/tex" id="MathJax-Element-12">b</script> are positive integers, we can first multiply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">a</span></span></span><script type="math/tex" id="MathJax-Element-13">a</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">b</span></span></span><script type="math/tex" id="MathJax-Element-14">b</script> and then multiply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">b</span></span></span><script type="math/tex" id="MathJax-Element-15">b</script> by the original value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">a</span></span></span><script type="math/tex" id="MathJax-Element-16">a</script>. Both number will be equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">a</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">b</span></span></span><script type="math/tex" id="MathJax-Element-17">a\times b</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a </span><span class="pun">&gt;&gt;</span><span class="pln"> b</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a </span><span class="pun">==</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a </span><span class="pun">%</span><span class="pln"> b </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> b </span><span class="pun">%</span><span class="pln"> a </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> TC</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> TC</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">TC </span><span class="pun">--){</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: none;"><ul>   <li>Amazing problem: 
<style data-nocturne="true" type="text/css">

</style>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11893">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>

    <script>
        $(function() {
            const likeFormUtil = {};
            likeFormUtil.getCount = function ($count) {
                return Number($count.attr("data-value"));
            };
            likeFormUtil.setCount = function ($count, value) {
                $count.attr("data-value", value);
                $count.text(value);
            };
            likeFormUtil.like = function ($likeForm) {
                $likeForm.find(".likeState").addClass("liked");
                const $likeCount = $likeForm.find(".likeCount");
                likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) + 1);
            };
            likeFormUtil.unLike = function ($likeForm) {
                if ($likeForm.find(".likeState").hasClass("liked")) {
                    $likeForm.find(".likeState").removeClass("liked");
                    const $likeCount = $likeForm.find(".likeCount");
                    likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) - 1);
                }
            };
            likeFormUtil.dislike = function ($likeForm) {
                $likeForm.find(".dislikeState").addClass("disliked");
                const $dislikeCount = $likeForm.find(".dislikeCount");
                likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) + 1);
            };
            likeFormUtil.unDislike = function ($likeForm) {
                if ($likeForm.find(".dislikeState").hasClass("disliked")) {
                    $likeForm.find(".dislikeState").removeClass("disliked");
                    const $dislikeCount = $likeForm.find(".dislikeCount");
                    likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) - 1);
                }
            };
            likeFormUtil.disable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", function () {
                    return false;
                });
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", function () {
                    return false;
                });
            };
            likeFormUtil.enable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", onLike);
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", onDislike);
            };
            likeFormUtil.applyLikeableInformation = function(likeableInformation) {
                const id = likeableInformation.likeable.id;
                console.log(id);
                const $likeForm = $(".likeActionLink[data-likeableId='" + id + "']").closest(".likeForm");
                console.log($likeForm);
                likeFormUtil.setCount($likeForm.find(".likeCount"), likeableInformation.likeCount);
                likeFormUtil.setCount($likeForm.find(".dislikeCount"), likeableInformation.dislikeCount);
                if (likeableInformation.liked) {
                    $likeForm.find(".likeState").addClass("liked");
                } else {
                    $likeForm.find(".likeState").removeClass("liked");
                }
                if (likeableInformation.disliked) {
                    $likeForm.find(".likeState").addClass("disliked");
                } else {
                    $likeForm.find(".likeState").removeClass("disliked");
                }
            }
            likeFormUtil.applyLikeableInformations = function(likeableInformations) {
                likeableInformations.forEach((applyLikeableInformation) => {
                    likeFormUtil.applyLikeableInformation(applyLikeableInformation);
                });
            }

            function onLike() {
                const $likeActionLink = $(this);
                const likeableId = $likeActionLink.attr("data-likeableId");
                const $likeForm = $likeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "like",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["liked"]) {
                            Codeforces.showMessage('Added to liked');
                        } else {
                            Codeforces.showMessage('Removed from liked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            function onDislike() {
                const $dislikeActionLink = $(this);
                const likeableId = $dislikeActionLink.attr("data-likeableId");
                const $likeForm = $dislikeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "dislike",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["disliked"]) {
                            Codeforces.showMessage('Added to disliked');
                        } else {
                            Codeforces.showMessage('Removed from disliked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            $(".likeActionLink").click(onLike);
            $(".dislikeActionLink").click(onDislike);

            $(".likeCount").add(".dislikeCount").each(function () {
                const $count = $(this);
                likeFormUtil.setCount($count, likeFormUtil.getCount($count));
            });
        });
    </script>

<script data-nocturne="true"> $(function () {
}); </script>

</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11894">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="71">71</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11895">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="28">28</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11896">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11897">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2139/problem/B">2139B — Cake Collection</a></p><p>Idea: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a> Preparation: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>The number of cakes collected from an oven depends only on the last time Maple visits it. Therefore, in the optimal strategy, she should visit distinct ovens in the last <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-43"><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">m</span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">n</span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-18">\min(m,n)</script> seconds.</p><p>Let's think in reverse: suppose we fix an order <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-50"><span class="MJXp-msubsup" id="MJXp-Span-51"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-53" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-57"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-59" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-19">p_1,\dots,p_n</script> of the ovens. Then at second <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-60"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">m</span></span></span><script type="math/tex" id="MathJax-Element-20">m</script> we visit oven <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-62"><span class="MJXp-msubsup" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-65" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-21">p_1</script>, at second <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">m</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-69">1</span></span></span><script type="math/tex" id="MathJax-Element-22">m-1</script> we visit oven <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-70"><span class="MJXp-msubsup" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-73" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-23">p_2</script>, and so on. For the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">i</span></span></span><script type="math/tex" id="MathJax-Element-24">i</script>-th oven in this order, we collect <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-msubsup" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-79" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-82" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-86">0</span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">m</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">i</span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-92">1</span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-25">a_{p_i}\cdot \max(0, m-i+1)</script> cakes.</p><p>To maximize the total number of cakes collected, ovens with larger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-97" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-26">a_i</script> should be visited later (i.e., assigned larger multipliers). Thus we sort <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">a</span></span></span><script type="math/tex" id="MathJax-Element-27">a</script> in non-increasing order first.</p><p>The final answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-100"><span class="MJXp-msubsup" id="MJXp-Span-101"><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">i</span><span class="MJXp-mo" id="MJXp-Span-105">=</span><span class="MJXp-mn" id="MJXp-Span-106">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-110" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-114">0</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">m</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">i</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-120">1</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-28">\sum_{i=1}^n a_i \cdot \max(0, m-i+1)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> INF </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0x3f3f3f3f</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    ll ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    vector </span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    sort</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">a</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">greater </span><span class="str">&lt;int&gt;</span><span class="pun">());</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++)</span><span class="pln"> ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> max</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln">t </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> TC</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> TC</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">TC </span><span class="pun">--){</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: none;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11898">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="48">48</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11899">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="69">69</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11900">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11901">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11902">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/A">2138A — Cake Assignment</a></p><p>Idea: <a class="rated-user user-orange" href="/profile/wjy666" title="Master wjy666">wjy666</a> Preparation: <a class="rated-user user-orange" href="/profile/wjy666" title="Master wjy666">wjy666</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: none;"><p>You can backtrack from the final state.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>Denote the state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-122"><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">a</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">b</span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-29">(a,b)</script> that indicates Chocola has <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">a</span></span></span><script type="math/tex" id="MathJax-Element-30">a</script> cakes and Vanilla has <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">b</span></span></span><script type="math/tex" id="MathJax-Element-31">b</script> cakes.</p><p>After one operation of type <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-mn" id="MJXp-Span-133">1</span></span></span><script type="math/tex" id="MathJax-Element-32">1</script>, Vanilla's number of cakes will definitely be at least half of the total, and similarly for operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-134"><span class="MJXp-mn" id="MJXp-Span-135">2</span></span></span><script type="math/tex" id="MathJax-Element-33">2</script>. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-mn" id="MJXp-Span-137">0</span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">a</span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-141"><span class="MJXp-mn" id="MJXp-Span-142" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-143" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-34">0 < a < 2^{k}</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-msubsup" id="MJXp-Span-146"><span class="MJXp-mn" id="MJXp-Span-147" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-148" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">b</span><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-153"><span class="MJXp-mn" id="MJXp-Span-154" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-155" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">k</span><span class="MJXp-mo" id="MJXp-Span-157">+</span><span class="MJXp-mn" id="MJXp-Span-158">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-35">2^{k} < b < 2^{k+1}</script>, meaning the previous operation must have been type <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-159"><span class="MJXp-mn" id="MJXp-Span-160">1</span></span></span><script type="math/tex" id="MathJax-Element-36">1</script>. Similarly, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-161"><span class="MJXp-mn" id="MJXp-Span-162">0</span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">b</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mn" id="MJXp-Span-167" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-168" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-37">0 < b < 2^{k}</script>, the previous operation must have been type <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-mn" id="MJXp-Span-171">2</span></span></span><script type="math/tex" id="MathJax-Element-38">2</script>.</p><p>Therefore, you can backtrack from the final state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-172"><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">x</span><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-176"><span class="MJXp-mn" id="MJXp-Span-177" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-178" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">k</span><span class="MJXp-mo" id="MJXp-Span-180">+</span><span class="MJXp-mn" id="MJXp-Span-181">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">x</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-39">(x,2^{k+1}-x)</script>, until it reaches the initial state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-185"><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-187"><span class="MJXp-mn" id="MJXp-Span-188" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-189" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-191"><span class="MJXp-mn" id="MJXp-Span-192" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-193" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-40">(2^k,2^k)</script>.</p><p>Now let's analyze how many steps we need to do during the process.</p><p>For the state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-195"><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">a</span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">b</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-41">(a, b)</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">a</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">b</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mn" id="MJXp-Span-206">0</span></span></span><script type="math/tex" id="MathJax-Element-42">a, b \neq 0</script>, assume <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">a</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">i</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-212"><span class="MJXp-mn" id="MJXp-Span-213" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-214" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-217" style="vertical-align: -0.4em;">a</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-43">a = i \cdot 2^{p_a}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">b</span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">j</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-223"><span class="MJXp-mn" id="MJXp-Span-224" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-225" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-228" style="vertical-align: -0.4em;">b</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-44">b = j \cdot 2^{p_b}</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">i</span></span></span><script type="math/tex" id="MathJax-Element-45">i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">j</span></span></span><script type="math/tex" id="MathJax-Element-46">j</script> are positive odd integers.</p><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">a</span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">b</span><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-238"><span class="MJXp-mn" id="MJXp-Span-239" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-240" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">k</span><span class="MJXp-mo" id="MJXp-Span-242">+</span><span class="MJXp-mn" id="MJXp-Span-243">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-47">a + b = 2^{k+1}</script>, it must be true that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-244"><span class="MJXp-mn" id="MJXp-Span-245">0</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-249" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-253" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">k</span></span></span><script type="math/tex" id="MathJax-Element-48"> 0 \le p_a = p_b \le k</script> , and after one operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-256"><span class="MJXp-mn" id="MJXp-Span-257">1</span></span></span><script type="math/tex" id="MathJax-Element-49">1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-258"><span class="MJXp-mn" id="MJXp-Span-259">2</span></span></span><script type="math/tex" id="MathJax-Element-50">2</script>, both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-260"><span class="MJXp-msubsup" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-263" style="vertical-align: -0.4em;">a</span></span></span></span><script type="math/tex" id="MathJax-Element-51">p_a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-264"><span class="MJXp-msubsup" id="MJXp-Span-265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-267" style="vertical-align: -0.4em;">b</span></span></span></span><script type="math/tex" id="MathJax-Element-52">p_b</script> decrease by exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-268"><span class="MJXp-mn" id="MJXp-Span-269">1</span></span></span><script type="math/tex" id="MathJax-Element-53">1</script>.</p><p>Therefore, the whole process takes at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">k</span></span></span><script type="math/tex" id="MathJax-Element-54">k</script> steps, so we solve the problem with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">O</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">k</span><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-55">O(tk)</script> time complexity.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln"> 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> k</span><span class="pun">,</span><span class="pln">x</span><span class="pun">,</span><span class="pln">kk</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">k</span><span class="pun">&gt;&gt;</span><span class="pln">x</span><span class="pun">;</span><span class="pln"> kk</span><span class="pun">=</span><span class="lit">1ll</span><span class="pun">&lt;&lt;</span><span class="pln">k</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">x</span><span class="pun">||</span><span class="pln">x</span><span class="pun">==</span><span class="pln">kk</span><span class="pun">*</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">cout</span><span class="pun">&lt;&lt;</span><span class="str">"-1\n"</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">kk</span><span class="pun">*</span><span class="lit">2</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln"> ans</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">x</span><span class="pun">!=</span><span class="pln">kk</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="lit">2</span><span class="pun">),</span><span class="pln">x</span><span class="pun">-=</span><span class="pln">y</span><span class="pun">,</span><span class="pln">y</span><span class="pun">*=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="lit">1</span><span class="pun">),</span><span class="pln">y</span><span class="pun">-=</span><span class="pln">x</span><span class="pun">,</span><span class="pln">x</span><span class="pun">*=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()&lt;&lt;</span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">())</span><span class="pln"> cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()&lt;&lt;</span><span class="str">' '</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
        cout</span><span class="pun">&lt;&lt;</span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: none;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11903">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="184">184</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11904">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="79">79</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11905">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11906">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11907">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="69">69</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/B">2138B — Antiamuny Wants to Learn Swap</a></p><p>Idea: <a class="rated-user user-red" href="/profile/tarjen" title="International Grandmaster tarjen">tarjen</a> Preparation: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a>,<a class="rated-user user-red" href="/profile/tarjen" title="International Grandmaster tarjen">tarjen</a>,<a class="rated-user user-orange" href="/profile/2014CAIS01" title="International Master 2014CAIS01">2014CAIS01</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>For array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">b</span></span></span><script type="math/tex" id="MathJax-Element-56">b</script>, we can prove that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">f</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">b</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">g</span><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">b</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-57">f(b)\neq g(b)</script> <strong>if and only if</strong> there exist indexes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-mn" id="MJXp-Span-291">1</span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">i</span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">j</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">k</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">m</span></span></span><script type="math/tex" id="MathJax-Element-58">1\le i<j<k\le m</script> which satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-300"><span class="MJXp-msubsup" id="MJXp-Span-301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-303" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-307" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-311" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-59">b_i>b_j>b_k</script>.</p><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">a</span></span></span><script type="math/tex" id="MathJax-Element-60">a</script> is a permutation, all elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">b</span></span></span><script type="math/tex" id="MathJax-Element-61">b</script> should be distinct. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">g</span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">b</span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-62">g(b)</script> is equal to the number of inversions in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">b</span></span></span><script type="math/tex" id="MathJax-Element-63">b</script>. When there exists some index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">i</span></span></span><script type="math/tex" id="MathJax-Element-64">i</script> that satisfies <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-325"><span class="MJXp-msubsup" id="MJXp-Span-326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-328" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-332" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">i</span><span class="MJXp-mo" id="MJXp-Span-334">+</span><span class="MJXp-mn" id="MJXp-Span-335">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-339" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">i</span><span class="MJXp-mo" id="MJXp-Span-341">+</span><span class="MJXp-mn" id="MJXp-Span-342">2</span></span></span></span></span><script type="math/tex" id="MathJax-Element-65">a_i>a_{i+1}>a_{i+2}</script>, we can reduce the number of inversions by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-343"><span class="MJXp-mn" id="MJXp-Span-344">3</span></span></span><script type="math/tex" id="MathJax-Element-66">3</script> by applying operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-345"><span class="MJXp-mn" id="MJXp-Span-346">2</span></span></span><script type="math/tex" id="MathJax-Element-67">2</script>, allowing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">f</span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">b</span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-68">f(b)</script> to become less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">g</span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">b</span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-69">g(b)</script>. This is the only case where you can reduce more than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-357"><span class="MJXp-mn" id="MJXp-Span-358">1</span></span></span><script type="math/tex" id="MathJax-Element-70">1</script> inversion with one operation.</p><p>If there exist indexes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-359"><span class="MJXp-mn" id="MJXp-Span-360">1</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">i</span><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">j</span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">k</span><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">m</span></span></span><script type="math/tex" id="MathJax-Element-71">1\le i<j<k\le m</script> which satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-369"><span class="MJXp-msubsup" id="MJXp-Span-370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-372" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-376" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-380" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-72">b_i>b_j>b_k</script>, we can first choose indexes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">i</span><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">k</span></span></span><script type="math/tex" id="MathJax-Element-73">i,k</script>, then move all elements greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-385"><span class="MJXp-msubsup" id="MJXp-Span-386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-388" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-74">b_i</script> to the right of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-389"><span class="MJXp-msubsup" id="MJXp-Span-390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-392" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-75">b_k</script> and move all elements less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-393"><span class="MJXp-msubsup" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-396" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-76">b_k</script> to the left of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-397"><span class="MJXp-msubsup" id="MJXp-Span-398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-400" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-77">b_i</script> by swapping adjacent numbers (applying the first operation). Now all elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-401"><span class="MJXp-msubsup" id="MJXp-Span-402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-404" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-78">b_p</script> between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-405"><span class="MJXp-msubsup" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-408" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-412" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-79">b_i,b_k</script> satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-413"><span class="MJXp-msubsup" id="MJXp-Span-414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-416" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-420" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-421" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-424" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-80">b_i>b_p>b_k</script>. We then swap them to the left of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-425"><span class="MJXp-msubsup" id="MJXp-Span-426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-428" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-81">b_i</script> until there is only one element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-429"><span class="MJXp-msubsup" id="MJXp-Span-430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-432" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-82">b_j</script> left. Now <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-433"><span class="MJXp-msubsup" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-436" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-440" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-444" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-83">b_i>b_j>b_k</script> and they are adjacent, and we can apply operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-445"><span class="MJXp-mn" id="MJXp-Span-446">2</span></span></span><script type="math/tex" id="MathJax-Element-84">2</script> on the current index of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-447"><span class="MJXp-msubsup" id="MJXp-Span-448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-450" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-85">b_i</script>.</p><p>If we only apply operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-451"><span class="MJXp-mn" id="MJXp-Span-452">1</span></span></span><script type="math/tex" id="MathJax-Element-86">1</script> on indexes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">i</span></span></span><script type="math/tex" id="MathJax-Element-87">i</script> which satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-455"><span class="MJXp-msubsup" id="MJXp-Span-456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-458" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-462" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">i</span><span class="MJXp-mo" id="MJXp-Span-464">+</span><span class="MJXp-mn" id="MJXp-Span-465">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-88">b_i>b_{i+1}</script>, there will never exist any index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">i</span></span></span><script type="math/tex" id="MathJax-Element-89">i</script> satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-468"><span class="MJXp-msubsup" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-471" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-475" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">i</span><span class="MJXp-mo" id="MJXp-Span-477">+</span><span class="MJXp-mn" id="MJXp-Span-478">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-482" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">i</span><span class="MJXp-mo" id="MJXp-Span-484">+</span><span class="MJXp-mn" id="MJXp-Span-485">2</span></span></span></span></span><script type="math/tex" id="MathJax-Element-90">b_i>b_{i+1}>b_{i+2}</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">b</span></span></span><script type="math/tex" id="MathJax-Element-91">b</script> during the process. If we apply an operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-488"><span class="MJXp-mn" id="MJXp-Span-489">1</span></span></span><script type="math/tex" id="MathJax-Element-92">1</script> on some index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">i</span></span></span><script type="math/tex" id="MathJax-Element-93">i</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-msubsup" id="MJXp-Span-493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-495" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-499" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">i</span><span class="MJXp-mo" id="MJXp-Span-501">+</span><span class="MJXp-mn" id="MJXp-Span-502">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-94">b_i<b_{i+1}</script>, the number of inversions will be increased by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-503"><span class="MJXp-mn" id="MJXp-Span-504">1</span></span></span><script type="math/tex" id="MathJax-Element-95">1</script> instead of decreased by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-505"><span class="MJXp-mn" id="MJXp-Span-506">1</span></span></span><script type="math/tex" id="MathJax-Element-96">1</script>, which makes it impossible to reach <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">f</span><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">b</span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">g</span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">b</span><span class="MJXp-mo" id="MJXp-Span-516" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-97">f(b)<g(b)</script> with one operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-517"><span class="MJXp-mn" id="MJXp-Span-518">2</span></span></span><script type="math/tex" id="MathJax-Element-98">2</script>, even if it decreases the number of inversions by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-519"><span class="MJXp-mn" id="MJXp-Span-520">3</span></span></span><script type="math/tex" id="MathJax-Element-99">3</script>. Therefore, in this case <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">f</span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">b</span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">g</span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">b</span><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-100">f(b)=g(b)</script>.</p><p>For each element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-531"><span class="MJXp-msubsup" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-534" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-101">a_i</script>, we define:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-535"><span class="MJXp-msubsup" id="MJXp-Span-536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-538" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-102">l_i</script>: the maximum index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-539"><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">i</span></span></span><script type="math/tex" id="MathJax-Element-103">< i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-542"><span class="MJXp-msubsup" id="MJXp-Span-543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-545" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-548" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-552" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-104">a_{l_i} > a_i</script>,</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-553"><span class="MJXp-msubsup" id="MJXp-Span-554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-556" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-105">r_i</script>: the minimum index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-557"><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">i</span></span></span><script type="math/tex" id="MathJax-Element-106">> i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-560"><span class="MJXp-msubsup" id="MJXp-Span-561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-563" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-566" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-570" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-107">a_{r_i} < a_i</script>.</li> </ul><p>Then the answer to a query <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">l</span><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">r</span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-108">[l, r]</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-577"><span class="MJXp-mrow" id="MJXp-Span-578"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-579">NO</span></span></span></span><script type="math/tex" id="MathJax-Element-109">\texttt{NO}</script> if and only if some segment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-580"><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-584" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-585" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-588" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-110">[l_i, r_i]</script> lies fully inside <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-590"><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">l</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">r</span><span class="MJXp-mo" id="MJXp-Span-595" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-111">[l, r]</script>.</p><p>To answer multiple queries, you can preprocess the smallest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">r</span></span></span><script type="math/tex" id="MathJax-Element-112">r</script> for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">l</span></span></span><script type="math/tex" id="MathJax-Element-113">l</script> such that the answers for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-600"><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">l</span><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">x</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">x</span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">r</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-114">[l,x](x\ge r)</script> should be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-611"><span class="MJXp-mrow" id="MJXp-Span-612"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-613">NO</span></span></span></span><script type="math/tex" id="MathJax-Element-115">\texttt{NO}</script>.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">O</span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">n</span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-116">O(n)</script> if you find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-619"><span class="MJXp-msubsup" id="MJXp-Span-620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-622" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-626" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-117">l_i,r_i</script> with the Monotonic Stack trick. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">O</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">n</span><span class="MJXp-mi" id="MJXp-Span-631">log</span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">n</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-118">O(n\log n)</script> solutions can also pass.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> mxl</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> mir</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
            mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mxl</span><span class="pun">[</span><span class="pln">mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
            mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mir</span><span class="pun">[</span><span class="pln">mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> L</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            L</span><span class="pun">[</span><span class="pln">mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">L</span><span class="pun">[</span><span class="pln">mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]],</span><span class="pln"> mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        L</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">L</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> L</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&lt;=</span><span class="pln"> L</span><span class="pun">[</span><span class="pln">r</span><span class="pun">])</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"NO\n"</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"YES\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: none;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11908">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="79">79</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11909">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="20">20</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11910">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="15">15</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11911">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="4">4</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11912">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="173">173</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/C1">2138C1 — Maple and Tree Beauty (Easy Version)</a></p><p>Idea: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a> Preparation: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a>,<a class="rated-user user-red" href="/profile/tarjen" title="International Grandmaster tarjen">tarjen</a>,<a class="rated-user user-orange" href="/profile/2014CAIS01" title="International Master 2014CAIS01">2014CAIS01</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>We can first find out that the maximum possible answer is the minimum depth among all leaves <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">d</span><span class="MJXp-mo" id="MJXp-Span-637" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mrow" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">e</span><span class="MJXp-msubsup" id="MJXp-Span-642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-644" style="vertical-align: -0.4em;">u</span></span></span></span></span><script type="math/tex" id="MathJax-Element-119">d=\min{dep_u}</script>, as the LCS can't be greater than the minimum length of all names.</p><p>We consider a special case first where all leaves have the same depth. If we want to achieve the maximum answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">d</span></span></span><script type="math/tex" id="MathJax-Element-120">d</script>, the names of all leaves should be exactly the same. Which means, for any two vertices with the same depth, their labels has to be the same.</p><p>For each depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">i</span></span></span><script type="math/tex" id="MathJax-Element-121">i</script>, we group all vertices with depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">i</span></span></span><script type="math/tex" id="MathJax-Element-122">i</script> together as the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">i</span></span></span><script type="math/tex" id="MathJax-Element-123">i</script>-th group (suppose root has depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-653"><span class="MJXp-mn" id="MJXp-Span-654">1</span></span></span><script type="math/tex" id="MathJax-Element-124">1</script>). For each group, all vertices in the group should have the same label. Let the size of groups <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-655"><span class="MJXp-mn" id="MJXp-Span-656">1</span><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-658" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">d</span></span></span><script type="math/tex" id="MathJax-Element-125">1,\cdots,d</script> be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-661"><span class="MJXp-msubsup" id="MJXp-Span-662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-664" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-670" style="vertical-align: -0.4em;">d</span></span></span></span><script type="math/tex" id="MathJax-Element-126">c_1,\cdots,c_d</script>. Now the problem can be considered as a knapsack problem, where you have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">d</span></span></span><script type="math/tex" id="MathJax-Element-127">d</script> items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-673"><span class="MJXp-msubsup" id="MJXp-Span-674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-676" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-682" style="vertical-align: -0.4em;">d</span></span></span></span><script type="math/tex" id="MathJax-Element-128">c_1,\cdots,c_d</script>. We need to find out whether you can take several numbers from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">c</span></span></span><script type="math/tex" id="MathJax-Element-129">c</script> that have a sum equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-685"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">k</span></span></span><script type="math/tex" id="MathJax-Element-130">k</script>. This can be solved in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">O</span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-692" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-131">O(n^2)</script>.</p><p>If the maximum answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">d</span></span></span><script type="math/tex" id="MathJax-Element-132">d</script> is not achievable, we can show that you can always achieve <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">d</span><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-699">1</span></span></span><script type="math/tex" id="MathJax-Element-133">d-1</script>. For each group from the first to the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">d</span></span></span><script type="math/tex" id="MathJax-Element-134">d</script>-th, we assign an arbitrary label <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mn" id="MJXp-Span-703">0</span></span></span><script type="math/tex" id="MathJax-Element-135">0</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-704"><span class="MJXp-mn" id="MJXp-Span-705">1</span></span></span><script type="math/tex" id="MathJax-Element-136">1</script> which still has at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-706"><span class="MJXp-msubsup" id="MJXp-Span-707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-709" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-137">c_i</script> numbers remaining to all vertices in the group. As all leaves have the same depth, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-710"><span class="MJXp-msubsup" id="MJXp-Span-711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-713" style="vertical-align: -0.4em;">d</span></span></span></span><script type="math/tex" id="MathJax-Element-138">c_d</script> should be the maximum element in the array, so you are always able to select a label for groups <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-714"><span class="MJXp-mn" id="MJXp-Span-715">1</span></span></span><script type="math/tex" id="MathJax-Element-139">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">d</span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-719">1</span></span></span><script type="math/tex" id="MathJax-Element-140">d-1</script>. Then arbitrarily distribute the remaining labels among vertices in the last groups (which are leaves).</p><p>Now consider the general case where not all leaves have the same depth. If we want to achieve answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-720"><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">d</span></span></span><script type="math/tex" id="MathJax-Element-141">=d</script>, we need to select <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">d</span></span></span><script type="math/tex" id="MathJax-Element-142">d</script> groups. For each leaf vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">v</span></span></span><script type="math/tex" id="MathJax-Element-143">v</script>, there should exist a vertex in the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">d</span></span></span><script type="math/tex" id="MathJax-Element-144">d</script>-th group which is an ancestor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">v</span></span></span><script type="math/tex" id="MathJax-Element-145">v</script>. And for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-731"><span class="MJXp-mn" id="MJXp-Span-732">2</span><span class="MJXp-mo" id="MJXp-Span-733" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">i</span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">d</span></span></span><script type="math/tex" id="MathJax-Element-146">2\le i\le d</script>, for each vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">v</span></span></span><script type="math/tex" id="MathJax-Element-147">v</script> in the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">i</span></span></span><script type="math/tex" id="MathJax-Element-148">i</script>-th group, there should exist a vertex in the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">i</span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-744">1</span></span></span><script type="math/tex" id="MathJax-Element-149">i-1</script>-th group which is an ancestor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">v</span></span></span><script type="math/tex" id="MathJax-Element-150">v</script>. All vertices in the same group should have the same label. Suppose the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">i</span></span></span><script type="math/tex" id="MathJax-Element-151">i</script>-th group has label <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-749"><span class="MJXp-msubsup" id="MJXp-Span-750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-752" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-152">l_i</script>, then we can achieve <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-753"><span class="MJXp-mtext" id="MJXp-Span-754">LCS</span><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-758" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-761" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-765" style="vertical-align: -0.4em;">d</span></span></span></span><script type="math/tex" id="MathJax-Element-153">\text{LCS}=l_1l_2\ldots l_d</script> which has length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">d</span></span></span><script type="math/tex" id="MathJax-Element-154">d</script>.</p><p>We can still group all vertices with depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-768"><span class="MJXp-mn" id="MJXp-Span-769">1</span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">i</span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">d</span></span></span><script type="math/tex" id="MathJax-Element-155">1\le i\le d</script> together as the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">i</span></span></span><script type="math/tex" id="MathJax-Element-156">i</script>-th group. For all vertices with depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-776"><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">d</span></span></span><script type="math/tex" id="MathJax-Element-157">>d</script>, we can set their label arbitrarily. We can view them as items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-779"><span class="MJXp-mn" id="MJXp-Span-780">1</span></span></span><script type="math/tex" id="MathJax-Element-158">1</script> in the knapsack problem.</p><p>And we can show this is the optimal way to select <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">d</span></span></span><script type="math/tex" id="MathJax-Element-159">d</script> groups. If some vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">u</span></span></span><script type="math/tex" id="MathJax-Element-160">u</script> with depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-785"><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">d</span></span></span><script type="math/tex" id="MathJax-Element-161">\le d</script> is not selected, there must be some vertices selected in some group in the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">u</span></span></span><script type="math/tex" id="MathJax-Element-162">u</script>, because the path from the root to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">u</span></span></span><script type="math/tex" id="MathJax-Element-163">u</script> consists of fewer than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">d</span></span></span><script type="math/tex" id="MathJax-Element-164">d</script> vertices. If the smallest group index that some vertex in the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">u</span></span></span><script type="math/tex" id="MathJax-Element-165">u</script> belongs to is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">i</span></span></span><script type="math/tex" id="MathJax-Element-166">i</script>, we can instead let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">u</span></span></span><script type="math/tex" id="MathJax-Element-167">u</script> be inside the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">i</span></span></span><script type="math/tex" id="MathJax-Element-168">i</script>-th group, and then the labels of all vertices in the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">u</span></span></span><script type="math/tex" id="MathJax-Element-169">u</script> that were previously in group <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">i</span></span></span><script type="math/tex" id="MathJax-Element-170">i</script> can be selected arbitrarily. If we consider the knapsack problem, we have reduced some <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-806"><span class="MJXp-msubsup" id="MJXp-Span-807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-809" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-171">c_i</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">x</span></span></span><script type="math/tex" id="MathJax-Element-172">x</script> and added <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">x</span></span></span><script type="math/tex" id="MathJax-Element-173">x</script> items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-814"><span class="MJXp-mn" id="MJXp-Span-815">1</span></span></span><script type="math/tex" id="MathJax-Element-174">1</script>. All achievable values still remain achievable, while some previously unachievable values become achievable.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">O</span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-821" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-822" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-175">O(n^2)</script>, the bottleneck is knapsack.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">// n^2/w</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> fa</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> dep</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> noson</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> cnt</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]++;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]--;</span><span class="pln">
        dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dep</span><span class="pun">[</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        cnt</span><span class="pun">[</span><span class="pln">dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]++;</span><span class="pln">
        noson</span><span class="pun">[</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mxdep </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e9</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">noson</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> mxdep </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">mxdep</span><span class="pun">,</span><span class="pln"> dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> sum </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
 
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> dp</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> mxdep</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> sum</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">--)</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">|=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
        sum </span><span class="pun">+=</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sum </span><span class="pun">&lt;=</span><span class="pln"> k </span><span class="pun">||</span><span class="pln"> sum </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> mxdep </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> sum</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> k </span><span class="pun">&amp;&amp;</span><span class="pln"> sum </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> mxdep </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> mxdep</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: none;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11918">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="134">134</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11919">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11920">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11921">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11922">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/C2">2138C2 — Maple and Tree Beauty (Hard Version)</a></p><p>Idea: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a> Preparation: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a>,<a class="rated-user user-red" href="/profile/tarjen" title="International Grandmaster tarjen">tarjen</a>,<a class="rated-user user-orange" href="/profile/2014CAIS01" title="International Master 2014CAIS01">2014CAIS01</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>We focus on optimizing the knapsack problem. In the knapsack problem we only need to know <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-823"><span class="MJXp-msubsup" id="MJXp-Span-824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-826" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-828">0</span><span class="MJXp-mrow" id="MJXp-Span-829"><span class="MJXp-mo" id="MJXp-Span-830" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-831">1</span></span></span><script type="math/tex" id="MathJax-Element-176">f_i=0/1</script> which means whether you can achieve sum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">i</span></span></span><script type="math/tex" id="MathJax-Element-177">i</script>, so we can optimize the knapsack with bitset. The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">O</span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-837" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-840" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">ω</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-178">O(\frac{n^2}{\omega})</script> which is enough to pass E2.</p><p>But actually we can do better. For the knapsack problem, it has at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">n</span></span></span><script type="math/tex" id="MathJax-Element-179">n</script> items, and the sum of weights of all items is also at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">n</span></span></span><script type="math/tex" id="MathJax-Element-180">n</script>. We can do a sqrt decomposition trick here. </p> <ul>   <li>For items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-847"><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msqrt" id="MJXp-Span-849"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">n</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-181">\ge\sqrt{n}</script>, there are at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-851"><span class="MJXp-msqrt" id="MJXp-Span-852"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">n</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-182">\sqrt{n}</script> such items.</li>   <li>For items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-854"><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msqrt" id="MJXp-Span-856"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">n</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-183"><\sqrt{n}</script>, we count the number of items for each different weight. If there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-858"><span class="MJXp-msubsup" id="MJXp-Span-859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-861" style="vertical-align: -0.4em;">w</span></span></span></span><script type="math/tex" id="MathJax-Element-184">c_w</script> items for weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">w</span></span></span><script type="math/tex" id="MathJax-Element-185">w</script>, we decompose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">x</span></span></span><script type="math/tex" id="MathJax-Element-186">x</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-866"><span class="MJXp-msubsup" id="MJXp-Span-867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-869" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-mo" id="MJXp-Span-870" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-871"><span class="MJXp-mn" id="MJXp-Span-872" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-873" style="vertical-align: 0.5em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-874" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-875"><span class="MJXp-mn" id="MJXp-Span-876" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-877" style="vertical-align: 0.5em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-878" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-879" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-880" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-881"><span class="MJXp-mn" id="MJXp-Span-882" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-883" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-884" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">y</span></span></span><script type="math/tex" id="MathJax-Element-187">c_w=2^0+2^1+\cdots+2^k+y</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">k</span></span></span><script type="math/tex" id="MathJax-Element-188">k</script> is the largest integer satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-888"><span class="MJXp-msubsup" id="MJXp-Span-889"><span class="MJXp-mn" id="MJXp-Span-890" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-891" style="vertical-align: 0.5em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-892" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-893"><span class="MJXp-mn" id="MJXp-Span-894" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-895" style="vertical-align: 0.5em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-896" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-897" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-898" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-899"><span class="MJXp-mn" id="MJXp-Span-900" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-901" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-905" style="vertical-align: -0.4em;">w</span></span></span></span><script type="math/tex" id="MathJax-Element-189">2^0+2^1+\ldots+2^k\le c_w</script>. Then we create new items with weights <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-906"><span class="MJXp-msubsup" id="MJXp-Span-907"><span class="MJXp-mn" id="MJXp-Span-908" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-909" style="vertical-align: 0.5em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-910" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">w</span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-913"><span class="MJXp-mn" id="MJXp-Span-914" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-915" style="vertical-align: 0.5em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">w</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-921"><span class="MJXp-mn" id="MJXp-Span-922" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-923" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">w</span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">y</span><span class="MJXp-mo" id="MJXp-Span-928" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">w</span></span></span><script type="math/tex" id="MathJax-Element-190">2^0\cdot w,2^1\cdot w,\ldots,2^k\cdot w,y\cdot w</script>. The set of new items is the same as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-930"><span class="MJXp-msubsup" id="MJXp-Span-931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-933" style="vertical-align: -0.4em;">w</span></span></span></span><script type="math/tex" id="MathJax-Element-191">c_w</script> items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">w</span></span></span><script type="math/tex" id="MathJax-Element-192">w</script> if we only consider the different sum of weights the set of items can achieve. Now we only have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-936"><span class="MJXp-msubsup" id="MJXp-Span-937"><span class="MJXp-mo" id="MJXp-Span-938" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-943"><span class="MJXp-msqrt" id="MJXp-Span-944"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">w</span><span class="MJXp-mo" id="MJXp-Span-941">=</span><span class="MJXp-mn" id="MJXp-Span-942">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-946">log</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-948" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-951" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-mo" id="MJXp-Span-952" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-953" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-954"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">n</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-193">\sum_{w=1}^{\sqrt{n}}\log(c_w)=\sqrt{n}</script> items.</li> </ul><p>The total time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">O</span><span class="MJXp-mo" id="MJXp-Span-958" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msqrt" id="MJXp-Span-959"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-961" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">n</span><span class="MJXp-mo" id="MJXp-Span-963" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msqrt" id="MJXp-Span-964"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">n</span><span class="MJXp-mo" id="MJXp-Span-968" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">O</span><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">n</span><span class="MJXp-msqrt" id="MJXp-Span-973"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-194">O(\sqrt{n}\cdot n+\sqrt{n}\cdot n)=O(n\sqrt{n})</script>.</p><p>And this can also be optimized with bitset, leading to an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">O</span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-979" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">n</span><span class="MJXp-msqrt" id="MJXp-Span-981"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">n</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">ω</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-984" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-195">O(\frac{n\sqrt{n}}{\omega})</script> solution.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">// nsqrtn/w</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">template</span><span class="pln"> </span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pln"> maxn</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> solve</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">maxn </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> solve</span><span class="pun">&lt;</span><span class="pln">min</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln"> maxn </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)&gt;(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    bitset</span><span class="str">&lt;maxn&gt;</span><span class="pln"> dp</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> fa</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> dep</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> noson</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> cnt</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]++;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]--;</span><span class="pln">
        dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dep</span><span class="pun">[</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        cnt</span><span class="pun">[</span><span class="pln">dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]++;</span><span class="pln">
        noson</span><span class="pun">[</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    dp</span><span class="pun">.</span><span class="pln">reset</span><span class="pun">();</span><span class="pln">
    dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mxdep </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e9</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">noson</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> mxdep </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">mxdep</span><span class="pun">,</span><span class="pln"> dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> sum </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> cnt</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> mxdep </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    sort</span><span class="pun">(</span><span class="pln">all</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> all</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">all</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">all</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> all</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> all</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span><span class="pln"> j</span><span class="pun">++;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> t </span><span class="pun">=</span><span class="pln"> j </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> z </span><span class="pun">&lt;=</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> z </span><span class="pun">*=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            v</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">z </span><span class="pun">*</span><span class="pln"> all</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
            t </span><span class="pun">-=</span><span class="pln"> z</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> v</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">t </span><span class="pun">*</span><span class="pln"> all</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        i </span><span class="pun">=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> val </span><span class="pun">:</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        sum </span><span class="pun">+=</span><span class="pln"> val</span><span class="pun">;</span><span class="pln">
        dp </span><span class="pun">|=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp </span><span class="pun">&lt;&lt;</span><span class="pln"> val</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sum </span><span class="pun">&lt;=</span><span class="pln"> k </span><span class="pun">||</span><span class="pln"> sum </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> mxdep </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> sum</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> k </span><span class="pun">&amp;&amp;</span><span class="pln"> sum </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> mxdep </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> mxdep</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> solve</span><span class="pun">&lt;</span><span class="lit">1</span><span class="pun">&gt;(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: none;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11913">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="63">63</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11914">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="24">24</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11915">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11916">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="21">21</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11917">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="32">32</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/D">2139D — Antiamuny and Slider Movement</a></p><p>Idea: <a class="rated-user user-red" href="/profile/tarjen" title="International Grandmaster tarjen">tarjen</a>,<a class="rated-user user-red" href="/profile/StarSilk" title="International Grandmaster StarSilk">StarSilk</a> Preparation: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a>,<a class="rated-user user-red" href="/profile/tarjen" title="International Grandmaster tarjen">tarjen</a>,<a class="rated-user user-red" href="/profile/StarSilk" title="International Grandmaster StarSilk">StarSilk</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>Let’s define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-985"><span class="MJXp-msubsup" id="MJXp-Span-986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-988" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-196">b_i</script> as the position of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">i</span></span></span><script type="math/tex" id="MathJax-Element-197">i</script>-th slider decreased by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">i</span></span></span><script type="math/tex" id="MathJax-Element-198">i</script>. Every operation on the sliders can be interpreted as a modification of the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">b</span></span></span><script type="math/tex" id="MathJax-Element-199">b</script>.</p> <ul>   <li><p>If we increase the position of slider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-995"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">i</span></span></span><script type="math/tex" id="MathJax-Element-200">i</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-997"><span class="MJXp-msubsup" id="MJXp-Span-998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1000" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-201">b_i</script> increases. At the same time, every suffix element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1001"><span class="MJXp-msubsup" id="MJXp-Span-1002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1004" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">i</span><span class="MJXp-mo" id="MJXp-Span-1006">+</span><span class="MJXp-mn" id="MJXp-Span-1007">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1011" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">i</span><span class="MJXp-mo" id="MJXp-Span-1013">+</span><span class="MJXp-mn" id="MJXp-Span-1014">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1020" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-202">b_{i+1}, b_{i+2}, \dots, b_n</script> gets updated to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1021"><span class="MJXp-msubsup" id="MJXp-Span-1022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1024" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1030" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1034" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-203">b_j := \max(b_j, b_i)</script>.</p></li>   <li><p>If we decrease the position of slider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">i</span></span></span><script type="math/tex" id="MathJax-Element-204">i</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1038"><span class="MJXp-msubsup" id="MJXp-Span-1039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1041" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-205">b_i</script> decreases. At the same time, every prefix element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1042"><span class="MJXp-msubsup" id="MJXp-Span-1043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1045" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1047"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1049" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1052" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1055" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">i</span><span class="MJXp-mo" id="MJXp-Span-1057">−</span><span class="MJXp-mn" id="MJXp-Span-1058">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-206">b_1, b_2, \dots, b_{i-1}</script> gets updated to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1059"><span class="MJXp-msubsup" id="MJXp-Span-1060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1062" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1064" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1068" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1072" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1073" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-207">b_j := \min(b_j, b_i)</script>.</p></li> </ul><p>Since the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">b</span></span></span><script type="math/tex" id="MathJax-Element-208">b</script> always remains <strong>non-decreasing</strong>, we can reinterpret operations as follows:</p> <ul>   <li>Every operation simultaneously applies a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1076"><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span><script type="math/tex" id="MathJax-Element-209">\min</script> operation to all elements on the left, and a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1078"><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span></span><script type="math/tex" id="MathJax-Element-210">\max</script> operation to all elements on the right.</li> </ul><p>For a fixed slider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1080"><span class="MJXp-msubsup" id="MJXp-Span-1081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1083" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-211">b_i</script>, the effect of each operation on the slider should be one of the following:</p> <ol>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1084"><span class="MJXp-msubsup" id="MJXp-Span-1085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1087" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1088" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1089" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1090" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1093" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1094" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">x</span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-212">b_i := \max(b_i, x)</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1097"><span class="MJXp-msubsup" id="MJXp-Span-1098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1100" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1106" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">x</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-213">b_i := \min(b_i, x)</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1110"><span class="MJXp-msubsup" id="MJXp-Span-1111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1113" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1114" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">x</span></span></span><script type="math/tex" id="MathJax-Element-214">b_i := x</script> (assignment)</li> </ol><p>Our task is to compute the sum of final values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1116"><span class="MJXp-msubsup" id="MJXp-Span-1117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1119" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-215">b_i</script> after all possible sequences of operations.</p><p>We sort all operations by their parameter <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">x</span></span></span><script type="math/tex" id="MathJax-Element-216">x</script>. If multiple operations share the same <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">x</span></span></span><script type="math/tex" id="MathJax-Element-217">x</script>, we give them a consistent order and then assume all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">x</span></span></span><script type="math/tex" id="MathJax-Element-218">x</script> are distinct in the following part of the editorial.</p><p>We first suppose that the position of the slider is changed at least once. Suppose the final value for slider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">i</span></span></span><script type="math/tex" id="MathJax-Element-219">i</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1128"><span class="MJXp-msubsup" id="MJXp-Span-1129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1131" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-220">b_e</script>, let’s consider which operation sets <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1132"><span class="MJXp-msubsup" id="MJXp-Span-1133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1135" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1139" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-221">b_i = b_e</script> at the very end.</p><p>At this point, we no longer care about the exact value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1140"><span class="MJXp-msubsup" id="MJXp-Span-1141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1143" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-222">b_i</script> during the process — only whether it is less than, equal to, or greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1144"><span class="MJXp-msubsup" id="MJXp-Span-1145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1147" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-223">b_e</script>.</p><p>All operations of type <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1148"><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span></span><script type="math/tex" id="MathJax-Element-224">\max</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">x</span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1155" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-225">x < b_e</script> and type <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1156"><span class="MJXp-mo" id="MJXp-Span-1157" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span><script type="math/tex" id="MathJax-Element-226">\min</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">x</span><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1163" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-227">x > b_e</script> are irrelevant. We can insert them anywhere after deciding the order of other operations without affecting the result. We won't consider these operations in the following parts of the editorial.</p><p>All assignment operations <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1164"><span class="MJXp-msubsup" id="MJXp-Span-1165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1167" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">x</span></span></span><script type="math/tex" id="MathJax-Element-228">b_i := x</script> can be reinterpreted:</p> <ul>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">x</span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1175" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-229">x < b_e</script>, treat it as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1176"><span class="MJXp-msubsup" id="MJXp-Span-1177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1179" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1181" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1182" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1185" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">x</span><span class="MJXp-mo" id="MJXp-Span-1188" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-230">b_i := \min(b_i, x)</script>.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">x</span><span class="MJXp-mo" id="MJXp-Span-1191" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1194" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-231">x > b_e</script>, treat it as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1195"><span class="MJXp-msubsup" id="MJXp-Span-1196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1198" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1204" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1205" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">x</span><span class="MJXp-mo" id="MJXp-Span-1207" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-232">b_i := \max(b_i, x)</script>.</li> </ul><p>The last operation, that makes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1208"><span class="MJXp-msubsup" id="MJXp-Span-1209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1211" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1215" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-233">b_i = b_e</script> must be the one with parameter <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">x</span><span class="MJXp-mo" id="MJXp-Span-1218" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1221" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-234">x = b_e</script>.</p> <ul>   <li><p>If this operation is assignment, then all other operations can appear in any order.</p></li>   <li><p>If this operation is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1222"><span class="MJXp-mo" id="MJXp-Span-1223" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span></span><script type="math/tex" id="MathJax-Element-235">\max</script> type, then immediately before it we must have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1224"><span class="MJXp-msubsup" id="MJXp-Span-1225"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1227" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1231" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-236">b_i < b_e</script>.</p></li>   <li>   <ul>     <li>Either the last preceding valid operation is some <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1232"><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span><script type="math/tex" id="MathJax-Element-237">\min</script> type operation making <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1234"><span class="MJXp-msubsup" id="MJXp-Span-1235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1237" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1238" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1241" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-238">b_i < b_e</script>;</li>   </ul></li>   <li>   <ul>     <li>Or no other effective operation occurs, and the initial value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1242"><span class="MJXp-msubsup" id="MJXp-Span-1243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1245" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-239">b_i</script> was already smaller than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1246"><span class="MJXp-msubsup" id="MJXp-Span-1247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1249" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-240">b_e</script>.</li>   </ul></li>   <li><p>If this operation is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1250"><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span><script type="math/tex" id="MathJax-Element-241">\min</script> type operation, it is symmetric: either the last preceding valid operation is a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1252"><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span></span><script type="math/tex" id="MathJax-Element-242">\max</script> type operation, or the initial value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1254"><span class="MJXp-msubsup" id="MJXp-Span-1255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1257" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-243">b_i</script> was already larger than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1258"><span class="MJXp-msubsup" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1261" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-244">b_e</script>.</p></li> </ul><p>Finally, don’t forget the case where a slider is never touched, where it simply keeps its initial value.</p><p>For each of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">n</span></span></span><script type="math/tex" id="MathJax-Element-245">n</script> sliders, we need to check contributions over all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">m</span></span></span><script type="math/tex" id="MathJax-Element-246">m</script> operations. The overall time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">O</span><span class="MJXp-mo" id="MJXp-Span-1268" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">m</span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-247">O(nm)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> mod</span><span class="pun">=</span><span class="lit">1000000007</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">5000</span><span class="pun">],</span><span class="pln">ans</span><span class="pun">[</span><span class="lit">5000</span><span class="pun">],</span><span class="pln">tt</span><span class="pun">[</span><span class="lit">5001</span><span class="pun">],</span><span class="pln">inv</span><span class="pun">[</span><span class="lit">5001</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">struct</span><span class="pln"> apos</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> id</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">friend</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pun">&lt;(</span><span class="pln">apos a</span><span class="pun">,</span><span class="pln">apos b</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">x</span><span class="pun">&lt;</span><span class="pln">b</span><span class="pun">.</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">ap</span><span class="pun">[</span><span class="lit">5000</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">),</span><span class="pln">cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">flag</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">p</span><span class="pun">,</span><span class="pln">q</span><span class="pun">,</span><span class="pln">x</span><span class="pun">,</span><span class="pln">i</span><span class="pun">,</span><span class="pln">j</span><span class="pun">,</span><span class="pln">cl</span><span class="pun">,</span><span class="pln">cr</span><span class="pun">;</span><span class="pln">
	tt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">5000</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">tt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">tt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">i</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
	inv</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">5000</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">mod</span><span class="pun">-</span><span class="pln">mod</span><span class="pun">/</span><span class="pln">i</span><span class="pun">)*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">mod</span><span class="pun">%</span><span class="pln">i</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">cin</span><span class="pun">&gt;&gt;</span><span class="pln">T</span><span class="pun">;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="lit">0</span><span class="pun">;</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">&gt;&gt;</span><span class="pln">m</span><span class="pun">&gt;&gt;</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			cin</span><span class="pun">&gt;&gt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
			a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-=</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			cin</span><span class="pun">&gt;&gt;</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&gt;&gt;</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
			ap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">id</span><span class="pun">--;</span><span class="pln">
			ap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">x</span><span class="pun">-=</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">id</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		sort</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">,</span><span class="pln">ap</span><span class="pun">+</span><span class="pln">p</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			flag</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&lt;=</span><span class="pln">i</span><span class="pun">&amp;&amp;</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">&gt;=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">flag</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&gt;=</span><span class="pln">i</span><span class="pun">&amp;&amp;</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">&lt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">flag</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">flag</span><span class="pun">)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			cl</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			cr</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&lt;=</span><span class="pln">i</span><span class="pun">)</span><span class="pln">cr</span><span class="pun">++;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&lt;=</span><span class="pln">i</span><span class="pun">)</span><span class="pln">cr</span><span class="pun">--;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">==</span><span class="pln">i</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">+</span><span class="pln">i</span><span class="pun">)*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">cl</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">+</span><span class="lit">1</span><span class="pun">])%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&lt;</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cl</span><span class="pun">==</span><span class="lit">0</span><span class="pun">&amp;&amp;</span><span class="pln">cr</span><span class="pun">==</span><span class="lit">0</span><span class="pun">&amp;&amp;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;=</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">+</span><span class="pln">i</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">+</span><span class="pln">i</span><span class="pun">)*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">cl</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">cl</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">cl</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&gt;</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cl</span><span class="pun">==</span><span class="lit">0</span><span class="pun">&amp;&amp;</span><span class="pln">cr</span><span class="pun">==</span><span class="lit">0</span><span class="pun">&amp;&amp;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&gt;</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">+</span><span class="pln">i</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">+</span><span class="pln">i</span><span class="pun">)*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">cl</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">cl</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">cr</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&gt;=</span><span class="pln">i</span><span class="pun">)</span><span class="pln">cl</span><span class="pun">++;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">x </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">x </span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]*</span><span class="pln">tt</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">&lt;&lt;</span><span class="str">' '</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		cout</span><span class="pun">&lt;&lt;</span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: none;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11923">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="43">43</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11924">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11925">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="6">6</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11926">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11927">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/E1">2139E1 — Determinant Construction (Easy Version)</a></p><p>Idea: <a class="rated-user user-orange" href="/profile/wjy666" title="Master wjy666">wjy666</a> Preparation: <a class="rated-user user-orange" href="/profile/wjy666" title="Master wjy666">wjy666</a></p> <div class="spoiler"><b class="spoiler-title">Solution 1</b><div class="spoiler-content" style="display: none;"><p>Thanks to <a class="rated-user user-legendary" href="/profile/jqdai0815" title="Legendary Grandmaster jqdai0815"><span class="legendary-user-first-letter">j</span>qdai0815</a> for his significant contribution to this solution.</p> <div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: none;"><p>We can consider transforming the construction of a matrix into the construction of a directed graph, as the determinant and permutations are closely related to the cycle covers of a directed graph.</p><p>If we have a directed graph with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">n</span></span></span><script type="math/tex" id="MathJax-Element-248">n</script> vertices, a cycle cover is a set of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">n</span></span></span><script type="math/tex" id="MathJax-Element-249">n</script> edges such that each vertex has exactly one incoming edge and one outgoing edge in this set (self-loops are allowed). In other words, these <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">n</span></span></span><script type="math/tex" id="MathJax-Element-250">n</script> edges form one or more cycles that together cover all vertices in the graph.</p><p>In a complete directed graph (with self-loops), every permutation of the vertices determines a cycle cover and vice versa. (The cycles of the permutation are precisely the cycles in the cover.)</p><p>We consider the definition of the determinant:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1278"><span class="MJXp-mo" id="MJXp-Span-1279" style="margin-left: 0.333em; margin-right: 0.333em;">det</span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">M</span><span class="MJXp-mo" id="MJXp-Span-1282" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1283" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1284"><span class="MJXp-mo" id="MJXp-Span-1285" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1286" style="vertical-align: -0.4em;"><span class="MJXp-mstyle MJXp-script" id="MJXp-Span-1287"><span class="MJXp-mtable" id="MJXp-Span-1288"><span><span class="MJXp-mtr" id="MJXp-Span-1289" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1290" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">B</span><span class="MJXp-mo" id="MJXp-Span-1292">=</span><span class="MJXp-mo" id="MJXp-Span-1293">(</span><span class="MJXp-msubsup" id="MJXp-Span-1294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1296" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1297">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-1298">,</span><span class="MJXp-mo" id="MJXp-Span-1299">…</span><span class="MJXp-mo" id="MJXp-Span-1300">,</span><span class="MJXp-msubsup" id="MJXp-Span-1301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1303" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">n</span><span class="MJXp-mo" id="MJXp-Span-1305">−</span><span class="MJXp-mn" id="MJXp-Span-1306">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1307">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1308" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1309" style="padding-top: 0.1em; text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">B</span><span class="MJXp-mo" id="MJXp-Span-1311">∈</span><span class="MJXp-msubsup" id="MJXp-Span-1312"><span class="MJXp-mrow" id="MJXp-Span-1313" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1314">P</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1315" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">n</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1318" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1319">1</span><span class="MJXp-msubsup" id="MJXp-Span-1320"><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1322" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-1323"><span class="MJXp-mi" id="MJXp-Span-1324">i</span><span class="MJXp-mi" id="MJXp-Span-1325">n</span><span class="MJXp-mi" id="MJXp-Span-1326">v</span></span><span class="MJXp-mo" id="MJXp-Span-1327">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">B</span><span class="MJXp-mo" id="MJXp-Span-1329">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1330" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1331"><span class="MJXp-mo" id="MJXp-Span-1332" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">n</span><span class="MJXp-mo" id="MJXp-Span-1339">−</span><span class="MJXp-mn" id="MJXp-Span-1340">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">i</span><span class="MJXp-mo" id="MJXp-Span-1335">=</span><span class="MJXp-mn" id="MJXp-Span-1336">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1343" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">i</span><span class="MJXp-mo" id="MJXp-Span-1345">,</span><span class="MJXp-msubsup" id="MJXp-Span-1346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1348" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">i</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-251"> \det(M)=\sum_{\begin{subarray}{c}B=(b_{0},\ldots,b_{n-1})\\ B\in\mathcal{P}_{n}\end{subarray}}(-1)^{\mathrm{inv}(B)}\cdot\prod_{i=0}^{n-1}m_ {i,b_{i}} </script></center><p>This summation goes over all permutations <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">B</span></span></span><script type="math/tex" id="MathJax-Element-252">B</script>, in other words, over all cycle covers of the directed graph determined by the adjacency matrix <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">M</span></span></span><script type="math/tex" id="MathJax-Element-253">M</script>. We can also interpret <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1354"><span class="MJXp-msubsup" id="MJXp-Span-1355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1357" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">i</span><span class="MJXp-mo" id="MJXp-Span-1359">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1362">0</span></span></span><script type="math/tex" id="MathJax-Element-254">m_{i,j}=0</script> as "the edge from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">i</span></span></span><script type="math/tex" id="MathJax-Element-255">i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">j</span></span></span><script type="math/tex" id="MathJax-Element-256">j</script> does not exist at all". Thus, the product term <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1367"><span class="MJXp-msubsup" id="MJXp-Span-1368"><span class="MJXp-mo" id="MJXp-Span-1369" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">n</span><span class="MJXp-mo" id="MJXp-Span-1376">−</span><span class="MJXp-mn" id="MJXp-Span-1377">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">i</span><span class="MJXp-mo" id="MJXp-Span-1372">=</span><span class="MJXp-mn" id="MJXp-Span-1373">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1380" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">i</span><span class="MJXp-mo" id="MJXp-Span-1382">,</span><span class="MJXp-msubsup" id="MJXp-Span-1383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1385" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">i</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-257">\prod_{i=0}^{n-1}m_ {i,b_{i}}</script> is non-zero only if all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1387"><span class="MJXp-msubsup" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1390" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">i</span><span class="MJXp-mo" id="MJXp-Span-1392">,</span><span class="MJXp-msubsup" id="MJXp-Span-1393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1395" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mn" id="MJXp-Span-1398">0</span></span></span><script type="math/tex" id="MathJax-Element-258">m_ {i,b_{i}} \neq 0</script>, which corresponds to the existence of a cycle cover in the graph.</p><p>We want to construct a directed graph such that the sum of the weights of its cycle covers equals <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">x</span></span></span><script type="math/tex" id="MathJax-Element-259">x</script>. Since the current problem only allows the use of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1401"><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1403">1</span><span class="MJXp-mo" id="MJXp-Span-1404" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1405">0</span><span class="MJXp-mo" id="MJXp-Span-1406" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1407">1</span></span></span><script type="math/tex" id="MathJax-Element-260">-1, 0, 1</script>, the edge weights can only be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1408"><span class="MJXp-mn" id="MJXp-Span-1409">1</span></span></span><script type="math/tex" id="MathJax-Element-261">1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1410"><span class="MJXp-mo" id="MJXp-Span-1411" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1412">1</span></span></span><script type="math/tex" id="MathJax-Element-262">-1</script>, and the contribution of a valid cycle cover to the answer can only be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1413"><span class="MJXp-mn" id="MJXp-Span-1414">1</span></span></span><script type="math/tex" id="MathJax-Element-263">1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1415"><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1417">1</span></span></span><script type="math/tex" id="MathJax-Element-264">-1</script>.</p><p>PS: You can refer to pages 56-58 of <a href="https://ipsc.ksp.sk/2012/real/solutions/booklet.pdf">https://ipsc.ksp.sk/2012/real/solutions/booklet.pdf</a> for more information.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: none;"><p>There might be many ways to construct a legal directed graph. We will demonstrate a method that transforms the problem into constructing a DAG with exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">x</span></span></span><script type="math/tex" id="MathJax-Element-265">x</script> paths from source vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1420"><span class="MJXp-mn" id="MJXp-Span-1421">1</span></span></span><script type="math/tex" id="MathJax-Element-266">1</script> to sink vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">n</span></span></span><script type="math/tex" id="MathJax-Element-267">n</script>.</p><p>For a directed acyclic graph <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">G</span></span></span><script type="math/tex" id="MathJax-Element-268">G</script> with source vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1426"><span class="MJXp-mn" id="MJXp-Span-1427">1</span></span></span><script type="math/tex" id="MathJax-Element-269">1</script> and sink vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">n</span></span></span><script type="math/tex" id="MathJax-Element-270">n</script>, we can construct the following adjacency matrix:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1430"><span class="MJXp-msubsup" id="MJXp-Span-1431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1433" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">i</span><span class="MJXp-mo" id="MJXp-Span-1435">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1438" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1439">1</span></span></span><script type="math/tex" id="MathJax-Element-271">g_{i,j} = -1</script> if there is an edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">i</span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">j</span></span></span><script type="math/tex" id="MathJax-Element-272">i \rightarrow j</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">G</span></span></span><script type="math/tex" id="MathJax-Element-273">G</script>. Set the weight of all original edges in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">G</span></span></span><script type="math/tex" id="MathJax-Element-274">G</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1448"><span class="MJXp-mo" id="MJXp-Span-1449" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1450">1</span></span></span><script type="math/tex" id="MathJax-Element-275">-1</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1451"><span class="MJXp-msubsup" id="MJXp-Span-1452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1454" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">i</span><span class="MJXp-mo" id="MJXp-Span-1456">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1458" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1459">1</span></span></span><script type="math/tex" id="MathJax-Element-276">g_{i,i} = 1</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1460"><span class="MJXp-mn" id="MJXp-Span-1461">1</span><span class="MJXp-mo" id="MJXp-Span-1462" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">i</span><span class="MJXp-mo" id="MJXp-Span-1464" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">n</span></span></span><script type="math/tex" id="MathJax-Element-277">1 < i < n</script>. Add a self-loop with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1466"><span class="MJXp-mn" id="MJXp-Span-1467">1</span></span></span><script type="math/tex" id="MathJax-Element-278">1</script> to all vertices in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">G</span></span></span><script type="math/tex" id="MathJax-Element-279">G</script> except the source and sink.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1470"><span class="MJXp-msubsup" id="MJXp-Span-1471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1473" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">n</span><span class="MJXp-mo" id="MJXp-Span-1475">,</span><span class="MJXp-mn" id="MJXp-Span-1476">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1477" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1478">1</span></span></span><script type="math/tex" id="MathJax-Element-280">g_{n,1} = 1</script>. Add an edge from the sink to the source with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1479"><span class="MJXp-mn" id="MJXp-Span-1480">1</span></span></span><script type="math/tex" id="MathJax-Element-281">1</script>.</li>   <li>Everything else <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1481"><span class="MJXp-mo" id="MJXp-Span-1482" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1483">0</span></span></span><script type="math/tex" id="MathJax-Element-282">= 0</script>.</li> </ul><p>We analyze all cycle covers of this new graph. Due to the presence of the edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">n</span><span class="MJXp-mo" id="MJXp-Span-1486" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mn" id="MJXp-Span-1487">1</span></span></span><script type="math/tex" id="MathJax-Element-283">n \rightarrow 1</script> , any cycle cover must contain a main cycle that includes nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1488"><span class="MJXp-mn" id="MJXp-Span-1489">1</span></span></span><script type="math/tex" id="MathJax-Element-284">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">n</span></span></span><script type="math/tex" id="MathJax-Element-285">n</script>, formed by a path <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">P</span></span></span><script type="math/tex" id="MathJax-Element-286">P</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1494"><span class="MJXp-mn" id="MJXp-Span-1495">1</span></span></span><script type="math/tex" id="MathJax-Element-287">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">n</span></span></span><script type="math/tex" id="MathJax-Element-288">n</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">G</span></span></span><script type="math/tex" id="MathJax-Element-289">G</script> and the edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">n</span><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mn" id="MJXp-Span-1503">1</span></span></span><script type="math/tex" id="MathJax-Element-290">n \rightarrow 1</script>. For nodes not on path <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">P</span></span></span><script type="math/tex" id="MathJax-Element-291">P</script> (i.e., intermediate nodes not covered by path <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">P</span></span></span><script type="math/tex" id="MathJax-Element-292">P</script>), they must be covered by self-loops with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1508"><span class="MJXp-mn" id="MJXp-Span-1509">1</span></span></span><script type="math/tex" id="MathJax-Element-293">1</script>. Therefore, each cycle cover uniquely corresponds to a path <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">P</span></span></span><script type="math/tex" id="MathJax-Element-294">P</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1512"><span class="MJXp-mn" id="MJXp-Span-1513">1</span></span></span><script type="math/tex" id="MathJax-Element-295">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">n</span></span></span><script type="math/tex" id="MathJax-Element-296">n</script>.</p><p>Since there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">x</span></span></span><script type="math/tex" id="MathJax-Element-297">x</script> paths in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">G</span></span></span><script type="math/tex" id="MathJax-Element-298">G</script>, we only need to ensure that the contribution of each cycle cover is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1520"><span class="MJXp-mn" id="MJXp-Span-1521">1</span></span></span><script type="math/tex" id="MathJax-Element-299">1</script> to obtain a determinant value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">x</span></span></span><script type="math/tex" id="MathJax-Element-300">x</script>. Next, we will analyze how to achieve this by setting the weight of all original edges in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">G</span></span></span><script type="math/tex" id="MathJax-Element-301">G</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1526"><span class="MJXp-mo" id="MJXp-Span-1527" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1528">1</span></span></span><script type="math/tex" id="MathJax-Element-302">-1</script>.</p><p>For each cycle cover, first consider the product of all edge weights:</p> <ul>   <li>The main cycle has <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">k</span></span></span><script type="math/tex" id="MathJax-Element-303">k</script> edges, among which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">k</span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1534">1</span></span></span><script type="math/tex" id="MathJax-Element-304">k-1</script> edges come from path <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">P</span></span></span><script type="math/tex" id="MathJax-Element-305">P</script> (each with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1537"><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1539">1</span></span></span><script type="math/tex" id="MathJax-Element-306">-1</script>), and one edge is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">n</span><span class="MJXp-mo" id="MJXp-Span-1542" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mn" id="MJXp-Span-1543">1</span></span></span><script type="math/tex" id="MathJax-Element-307">n \rightarrow 1</script> (with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1544"><span class="MJXp-mn" id="MJXp-Span-1545">1</span></span></span><script type="math/tex" id="MathJax-Element-308">1</script>). Thus, the product term is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1546"><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1549">1</span><span class="MJXp-msubsup" id="MJXp-Span-1550"><span class="MJXp-mo" id="MJXp-Span-1551" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1552" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">k</span><span class="MJXp-mo" id="MJXp-Span-1554">−</span><span class="MJXp-mn" id="MJXp-Span-1555">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-309">(-1)^{k-1}</script>.</li>   <li>The weights of all other self-loops are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1556"><span class="MJXp-mn" id="MJXp-Span-1557">1</span></span></span><script type="math/tex" id="MathJax-Element-310">1</script>.</li> </ul><p>Therefore, the product of all edge weights is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1558"><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1561">1</span><span class="MJXp-msubsup" id="MJXp-Span-1562"><span class="MJXp-mo" id="MJXp-Span-1563" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1564" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">k</span><span class="MJXp-mo" id="MJXp-Span-1566">−</span><span class="MJXp-mn" id="MJXp-Span-1567">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-311">(-1)^{k-1}</script>.</p><p>Then we consider the sign term <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1568"><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1571">1</span><span class="MJXp-msubsup" id="MJXp-Span-1572"><span class="MJXp-mo" id="MJXp-Span-1573" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1574" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-1575"><span class="MJXp-mi" id="MJXp-Span-1576">i</span><span class="MJXp-mi" id="MJXp-Span-1577">n</span><span class="MJXp-mi" id="MJXp-Span-1578">v</span></span><span class="MJXp-mo" id="MJXp-Span-1579">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">B</span><span class="MJXp-mo" id="MJXp-Span-1581">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-312">(-1)^{\mathrm{inv}(B)}</script>. In fact, the parity of the number of inversions <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1582"><span class="MJXp-mrow" id="MJXp-Span-1583"><span class="MJXp-mi" id="MJXp-Span-1584">i</span><span class="MJXp-mi" id="MJXp-Span-1585">n</span><span class="MJXp-mi" id="MJXp-Span-1586">v</span></span><span class="MJXp-mo" id="MJXp-Span-1587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">B</span><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-313">\mathrm{inv}(B)</script> in the permutation is consistent with the parity of the number of even cycles in the permutation. The main cycle is a cycle of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">k</span></span></span><script type="math/tex" id="MathJax-Element-314">k</script>, and the self-loops are all cycles of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1592"><span class="MJXp-mn" id="MJXp-Span-1593">1</span></span></span><script type="math/tex" id="MathJax-Element-315">1</script>. Therefore, the sign term is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1594"><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1597">1</span><span class="MJXp-msubsup" id="MJXp-Span-1598"><span class="MJXp-mo" id="MJXp-Span-1599" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1600" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">k</span><span class="MJXp-mo" id="MJXp-Span-1602">−</span><span class="MJXp-mn" id="MJXp-Span-1603">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-316">(-1)^{k-1}</script>.</p><p>Thus, the contribution of each cycle cover is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1604"><span class="MJXp-mo" id="MJXp-Span-1605" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1606" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1607">1</span><span class="MJXp-msubsup" id="MJXp-Span-1608"><span class="MJXp-mo" id="MJXp-Span-1609" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1610" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">k</span><span class="MJXp-mo" id="MJXp-Span-1612">−</span><span class="MJXp-mn" id="MJXp-Span-1613">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1614" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1616" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1617">1</span><span class="MJXp-msubsup" id="MJXp-Span-1618"><span class="MJXp-mo" id="MJXp-Span-1619" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1620" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">k</span><span class="MJXp-mo" id="MJXp-Span-1622">−</span><span class="MJXp-mn" id="MJXp-Span-1623">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1625">1</span></span></span><script type="math/tex" id="MathJax-Element-317">(-1)^{k-1} \cdot (-1)^{k-1}=1</script>.</p><p>Due to the constraints in the problem that the matrix size is at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1626"><span class="MJXp-mn" id="MJXp-Span-1627">80</span></span></span><script type="math/tex" id="MathJax-Element-318">80</script> and there are at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1628"><span class="MJXp-mn" id="MJXp-Span-1629">3</span></span></span><script type="math/tex" id="MathJax-Element-319">3</script> non-zero entries per row and column, we need to construct a DAG that satisfies:</p> <ul>   <li>Exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">x</span></span></span><script type="math/tex" id="MathJax-Element-320">x</script> paths from source vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1632"><span class="MJXp-mn" id="MJXp-Span-1633">1</span></span></span><script type="math/tex" id="MathJax-Element-321">1</script> to sink vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">n</span></span></span><script type="math/tex" id="MathJax-Element-322">n</script>.</li>   <li>At most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1636"><span class="MJXp-mn" id="MJXp-Span-1637">80</span></span></span><script type="math/tex" id="MathJax-Element-323">80</script> nodes.</li>   <li>The in-degree of each node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1638"><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1640">2</span></span></span><script type="math/tex" id="MathJax-Element-324">\le 2</script> and the out-degree of each node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1641"><span class="MJXp-mo" id="MJXp-Span-1642" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1643">2</span></span></span><script type="math/tex" id="MathJax-Element-325">\le 2</script>.</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: none;"><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1644"><span class="MJXp-mn" id="MJXp-Span-1645">80</span></span></span><script type="math/tex" id="MathJax-Element-326">80</script> is a loose boundary, there might be many constructions that satisfy it. We will introduce a construction method that encodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">x</span></span></span><script type="math/tex" id="MathJax-Element-327">x</script> in base three.</p><p>The basic unit shown in the figure can form a base-three digit because the number of paths from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1648"><span class="MJXp-mn" id="MJXp-Span-1649">1</span></span></span><script type="math/tex" id="MathJax-Element-328">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1650"><span class="MJXp-mn" id="MJXp-Span-1651">3</span></span></span><script type="math/tex" id="MathJax-Element-329">3</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1652"><span class="MJXp-mn" id="MJXp-Span-1653">2</span></span></span><script type="math/tex" id="MathJax-Element-330">2</script>, and from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1654"><span class="MJXp-mn" id="MJXp-Span-1655">1</span></span></span><script type="math/tex" id="MathJax-Element-331">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1656"><span class="MJXp-mn" id="MJXp-Span-1657">4</span></span></span><script type="math/tex" id="MathJax-Element-332">4</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1658"><span class="MJXp-mn" id="MJXp-Span-1659">3</span></span></span><script type="math/tex" id="MathJax-Element-333">3</script>. Node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1660"><span class="MJXp-mn" id="MJXp-Span-1661">4</span></span></span><script type="math/tex" id="MathJax-Element-334">4</script> can be connected to the next unit, forming a chain of units, where each unit corresponds to a base-three digit. Nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1662"><span class="MJXp-mn" id="MJXp-Span-1663">3</span></span></span><script type="math/tex" id="MathJax-Element-335">3</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1664"><span class="MJXp-mn" id="MJXp-Span-1665">4</span></span></span><script type="math/tex" id="MathJax-Element-336">4</script> have one free out-degree, which can contribute to the final answer.</p><p><img alt=" " src="/predownloaded/8b/b1/8bb177d55c6f9946d3ba3ad2d809d52d4e2da9b2.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>The example figure below shows how to construct <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1666"><span class="MJXp-mn" id="MJXp-Span-1667">22</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1669">1</span><span class="MJXp-mo" id="MJXp-Span-1670" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1671">3</span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1673">2</span><span class="MJXp-mo" id="MJXp-Span-1674" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1675"><span class="MJXp-mn" id="MJXp-Span-1676" style="margin-right: 0.05em;">3</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1677" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-337">22=1+3+2 \cdot 3^2</script> in this way. There are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1678"><span class="MJXp-msubsup" id="MJXp-Span-1679"><span class="MJXp-mi" id="MJXp-Span-1680" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1681" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1682" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">n</span></span></span><script type="math/tex" id="MathJax-Element-338">\log_3 n</script> basic units, each with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1684"><span class="MJXp-mn" id="MJXp-Span-1685">4</span></span></span><script type="math/tex" id="MathJax-Element-339">4</script> nodes. The answer chain has at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1686"><span class="MJXp-msubsup" id="MJXp-Span-1687"><span class="MJXp-mi" id="MJXp-Span-1688" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1689" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">n</span></span></span><script type="math/tex" id="MathJax-Element-340">\log_3 n</script> nodes. Therefore, the total number of nodes is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1692"><span class="MJXp-mn" id="MJXp-Span-1693">5</span><span class="MJXp-msubsup" id="MJXp-Span-1694"><span class="MJXp-mi" id="MJXp-Span-1695" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1696" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">n</span><span class="MJXp-mo" id="MJXp-Span-1699" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">O</span><span class="MJXp-mo" id="MJXp-Span-1701" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1702">1</span><span class="MJXp-mo" id="MJXp-Span-1703" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-341">5\log_3 n + O(1)</script>, which can pass the problem.</p><p><img alt=" " src="/predownloaded/c3/ae/c3aef65143ebe908453ebf2cd1a515c1057222f4.png" style="max-width: 100.0%;max-height: 100.0%;"></p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln"> 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N</span><span class="pun">=</span><span class="lit">81</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">][</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
vector</span><span class="pun">&lt;</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;&gt;</span><span class="pln"> e</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    e</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">({</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">});</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> make_matrix</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">]:</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">y</span><span class="pun">]=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> _</span><span class="pun">;</span><span class="pln"> scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">_</span><span class="pun">);</span><span class="pln"> </span><span class="com">//cin&gt;&gt;_;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> max_bit</span><span class="pun">=</span><span class="lit">15</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">_</span><span class="pun">--){</span><span class="pln">
        memset</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">a</span><span class="pun">));</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">max_bit</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">2</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">2</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">3</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">3</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">4</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">3</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">2</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">4</span><span class="pun">);</span><span class="pln">
            n</span><span class="pun">+=</span><span class="lit">4</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln">bit_1</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">bit_2</span><span class="pun">=</span><span class="lit">4</span><span class="pun">;</span><span class="pln"> scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">x</span><span class="pun">);</span><span class="pln"> </span><span class="pun">++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">max_bit</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">%</span><span class="lit">3</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">bit_1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">),</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">%</span><span class="lit">3</span><span class="pun">==</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">bit_2</span><span class="pun">,</span><span class="pln">n</span><span class="pun">),</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
            bit_1</span><span class="pun">+=</span><span class="lit">4</span><span class="pun">;</span><span class="pln"> bit_2</span><span class="pun">+=</span><span class="lit">4</span><span class="pun">;</span><span class="pln"> x</span><span class="pun">/=</span><span class="lit">3</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        make_matrix</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> n </span><span class="pun">&lt;&lt;</span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> r </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> r</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> c </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> c</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                printf</span><span class="pun">(</span><span class="str">"%d "</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">r</span><span class="pun">][</span><span class="pln">c</span><span class="pun">]);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution 2</b><div class="spoiler-content" style="display: none;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: none;"><p>We can consider using Tridiagonal Matrices, where the advantage lies in transforming the calculation of the determinant value into a recursive formula.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1704"><span class="MJXp-msubsup" id="MJXp-Span-1705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1707" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">i</span><span class="MJXp-mo" id="MJXp-Span-1709">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-342">d_{i,j}</script> denote the element in the i-th row and j-th column of matrix <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712">D</span></span></span><script type="math/tex" id="MathJax-Element-343">D</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1713"><span class="MJXp-msubsup" id="MJXp-Span-1714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1716" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-344">D_k</script> represents the submatrix composed of the upper-left <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">k</span><span class="MJXp-mo" id="MJXp-Span-1719" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">k</span></span></span><script type="math/tex" id="MathJax-Element-345">k \times k</script> elements, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1721"><span class="MJXp-msubsup" id="MJXp-Span-1722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1724" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-346">A_k</script> denotes the determinant value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1725"><span class="MJXp-msubsup" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1728" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-347">D_k</script>.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">k</span><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1732">2</span></span></span><script type="math/tex" id="MathJax-Element-348">k \ge 2</script>, there are two ways to obtain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1733"><span class="MJXp-msubsup" id="MJXp-Span-1734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1736" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">k</span><span class="MJXp-mo" id="MJXp-Span-1738">+</span><span class="MJXp-mn" id="MJXp-Span-1739">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-349">D_{k+1}</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1740"><span class="MJXp-msubsup" id="MJXp-Span-1741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1743" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-350">D_k</script>:</p> <ul>   <li>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1744"><span class="MJXp-msubsup" id="MJXp-Span-1745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1747" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">k</span><span class="MJXp-mo" id="MJXp-Span-1749">+</span><span class="MJXp-mn" id="MJXp-Span-1750">1</span><span class="MJXp-mo" id="MJXp-Span-1751">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">k</span><span class="MJXp-mo" id="MJXp-Span-1753">+</span><span class="MJXp-mn" id="MJXp-Span-1754">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1755" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1756">1</span><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1760" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">k</span><span class="MJXp-mo" id="MJXp-Span-1762">+</span><span class="MJXp-mn" id="MJXp-Span-1763">1</span><span class="MJXp-mo" id="MJXp-Span-1764">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1767">1</span><span class="MJXp-mo" id="MJXp-Span-1768" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1771" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">k</span><span class="MJXp-mo" id="MJXp-Span-1773">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">k</span><span class="MJXp-mo" id="MJXp-Span-1775">+</span><span class="MJXp-mn" id="MJXp-Span-1776">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1777" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1778">1</span></span></span><script type="math/tex" id="MathJax-Element-351"> d_{k+1,k+1}=1, d_{k+1,k}=1,d_{k,k+1}=1</script> to get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1779"><span class="MJXp-msubsup" id="MJXp-Span-1780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1782" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">k</span><span class="MJXp-mo" id="MJXp-Span-1784">+</span><span class="MJXp-mn" id="MJXp-Span-1785">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1786" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1789" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1790" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1793" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">k</span><span class="MJXp-mo" id="MJXp-Span-1795">−</span><span class="MJXp-mn" id="MJXp-Span-1796">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-352">A_{k+1}=A_k-A_{k-1}</script></li>   <li>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1797"><span class="MJXp-msubsup" id="MJXp-Span-1798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1800" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">k</span><span class="MJXp-mo" id="MJXp-Span-1802">+</span><span class="MJXp-mn" id="MJXp-Span-1803">1</span><span class="MJXp-mo" id="MJXp-Span-1804">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">k</span><span class="MJXp-mo" id="MJXp-Span-1806">+</span><span class="MJXp-mn" id="MJXp-Span-1807">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1808" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1809">1</span><span class="MJXp-mo" id="MJXp-Span-1810" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1813" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814">k</span><span class="MJXp-mo" id="MJXp-Span-1815">+</span><span class="MJXp-mn" id="MJXp-Span-1816">1</span><span class="MJXp-mo" id="MJXp-Span-1817">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1819" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1820">1</span><span class="MJXp-mo" id="MJXp-Span-1821" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1824" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">k</span><span class="MJXp-mo" id="MJXp-Span-1826">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">k</span><span class="MJXp-mo" id="MJXp-Span-1828">+</span><span class="MJXp-mn" id="MJXp-Span-1829">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1830" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1832">1</span></span></span><script type="math/tex" id="MathJax-Element-353"> d_{k+1,k+1}=1, d_{k+1,k}=1,d_{k,k+1}=-1</script> to get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1833"><span class="MJXp-msubsup" id="MJXp-Span-1834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1836" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">k</span><span class="MJXp-mo" id="MJXp-Span-1838">+</span><span class="MJXp-mn" id="MJXp-Span-1839">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1840" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1843" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1847" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">k</span><span class="MJXp-mo" id="MJXp-Span-1849">−</span><span class="MJXp-mn" id="MJXp-Span-1850">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-354">A_{k+1}=A_k+A_{k-1}</script></li> </ul><p>Thus, we transform the problem into constructing a sequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1851"><span class="MJXp-msubsup" id="MJXp-Span-1852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1854" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1855" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1856" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1857" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1860" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-355">A_1,\ldots,A_m</script> satisfying:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1861"><span class="MJXp-msubsup" id="MJXp-Span-1862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1864" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1865" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1866"><span class="MJXp-mo" id="MJXp-Span-1867" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1870" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1871"><span class="MJXp-mo" id="MJXp-Span-1872" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1873" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1876" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1878"><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1880"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1882" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1883"><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-356">A_1 = |D_1|, A_2 = |D_2|</script></li>   <li>For any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">k</span><span class="MJXp-mo" id="MJXp-Span-1887" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1888">2</span><span class="MJXp-mo" id="MJXp-Span-1889" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1890">3</span><span class="MJXp-mo" id="MJXp-Span-1891" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1892" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1893" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">m</span><span class="MJXp-mo" id="MJXp-Span-1895" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1896">1</span></span></span><script type="math/tex" id="MathJax-Element-357">k=2,3,\ldots,m-1</script>, one of the following two equations holds: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1897"><span class="MJXp-msubsup" id="MJXp-Span-1898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1900" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">k</span><span class="MJXp-mo" id="MJXp-Span-1902">+</span><span class="MJXp-mn" id="MJXp-Span-1903">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1904" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1907" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1908" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1911" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912">k</span><span class="MJXp-mo" id="MJXp-Span-1913">−</span><span class="MJXp-mn" id="MJXp-Span-1914">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-358">A_{k+1}=A_k-A_{k-1}</script>, or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1915"><span class="MJXp-msubsup" id="MJXp-Span-1916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1918" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919">k</span><span class="MJXp-mo" id="MJXp-Span-1920">+</span><span class="MJXp-mn" id="MJXp-Span-1921">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1922" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1925" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1926" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1929" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1930">k</span><span class="MJXp-mo" id="MJXp-Span-1931">−</span><span class="MJXp-mn" id="MJXp-Span-1932">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-359">A_{k+1}=A_k+A_{k-1}</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1933"><span class="MJXp-msubsup" id="MJXp-Span-1934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1936" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-1937" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1938">n</span><span class="MJXp-mo" id="MJXp-Span-1939" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1940">m</span><span class="MJXp-mo" id="MJXp-Span-1941" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1942">80</span><span class="MJXp-mo" id="MJXp-Span-1943" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-360">A_m=n (m \le 80)</script></li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: none;"><p>Consider recursively generating the entire sequence from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1944"><span class="MJXp-msubsup" id="MJXp-Span-1945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1947" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-1948" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949">n</span></span></span><script type="math/tex" id="MathJax-Element-361">A_m=n</script> backwards.</p> <ul>   <li><p>Choose a positive integer as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1950"><span class="MJXp-msubsup" id="MJXp-Span-1951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1952" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1953" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954">m</span><span class="MJXp-mo" id="MJXp-Span-1955">−</span><span class="MJXp-mn" id="MJXp-Span-1956">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-362">A_{m−1}</script>.</p></li>   <li><p>At a certain moment, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1957"><span class="MJXp-msubsup" id="MJXp-Span-1958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1960" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-363">A_k</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1961"><span class="MJXp-msubsup" id="MJXp-Span-1962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1964" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965">k</span><span class="MJXp-mo" id="MJXp-Span-1966">+</span><span class="MJXp-mn" id="MJXp-Span-1967">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-364">A_{k+1}</script>, and obtain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1968"><span class="MJXp-msubsup" id="MJXp-Span-1969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1971" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972">k</span><span class="MJXp-mo" id="MJXp-Span-1973">−</span><span class="MJXp-mn" id="MJXp-Span-1974">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-365">A_{k−1}</script> as follows:</p><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1975"><span class="MJXp-msubsup" id="MJXp-Span-1976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1978" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1979" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1982" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983">k</span><span class="MJXp-mo" id="MJXp-Span-1984">+</span><span class="MJXp-mn" id="MJXp-Span-1985">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-366">A_k > A_{k+1}</script>, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1986"><span class="MJXp-msubsup" id="MJXp-Span-1987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1989" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1990">k</span><span class="MJXp-mo" id="MJXp-Span-1991">−</span><span class="MJXp-mn" id="MJXp-Span-1992">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1993" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1996" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1997" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2000" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001">k</span><span class="MJXp-mo" id="MJXp-Span-2002">+</span><span class="MJXp-mn" id="MJXp-Span-2003">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-367">A_{k-1}=A_k-A_{k+1}</script>; otherwise, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2004"><span class="MJXp-msubsup" id="MJXp-Span-2005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2007" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">k</span><span class="MJXp-mo" id="MJXp-Span-2009">−</span><span class="MJXp-mn" id="MJXp-Span-2010">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2011" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2014" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015">k</span><span class="MJXp-mo" id="MJXp-Span-2016">+</span><span class="MJXp-mn" id="MJXp-Span-2017">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2018" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2021" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-368">A_{k-1}=A_{k+1}-A_k</script></p><p>This ensures that each number in the sequence is a non-negative integer.</p></li>   <li><p>If at some point there exist <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2022"><span class="MJXp-msubsup" id="MJXp-Span-2023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2025" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2026" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2029" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-369">D_1,D_2</script> satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2030"><span class="MJXp-msubsup" id="MJXp-Span-2031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2032" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2033" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2034" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2035"><span class="MJXp-mo" id="MJXp-Span-2036" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2037"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2039" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2040"><span class="MJXp-mo" id="MJXp-Span-2041" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2042" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2044" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2045" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">k</span><span class="MJXp-mo" id="MJXp-Span-2047">+</span><span class="MJXp-mn" id="MJXp-Span-2048">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2049" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2050"><span class="MJXp-mo" id="MJXp-Span-2051" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2054" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-2055"><span class="MJXp-mo" id="MJXp-Span-2056" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-370">A_k = |D_1|, A_{k+1} = |D_2|</script>, successfully finish the construction.</p></li> </ul><p>For example,if we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2057"><span class="MJXp-msubsup" id="MJXp-Span-2058"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2060" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2062">7</span></span></span><script type="math/tex" id="MathJax-Element-371">A_m=7</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2063"><span class="MJXp-msubsup" id="MJXp-Span-2064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2065" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2066" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">m</span><span class="MJXp-mo" id="MJXp-Span-2068">−</span><span class="MJXp-mn" id="MJXp-Span-2069">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2070" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2071">3</span></span></span><script type="math/tex" id="MathJax-Element-372">A_{m−1}=3</script>, the final sequence will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2072"><span class="MJXp-mn" id="MJXp-Span-2073">1</span><span class="MJXp-mo" id="MJXp-Span-2074" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2075">2</span><span class="MJXp-mo" id="MJXp-Span-2076" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2077">3</span><span class="MJXp-mo" id="MJXp-Span-2078" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2079">1</span><span class="MJXp-mo" id="MJXp-Span-2080" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2081">4</span><span class="MJXp-mo" id="MJXp-Span-2082" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2083">3</span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2085">7</span></span></span><script type="math/tex" id="MathJax-Element-373">1,2,3,1,4,3,7</script>, and we will generate the matrix as</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2086"><span class="MJXp-mrow" id="MJXp-Span-2087"><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.75em;"><span class="MJXp-right MJXp-scale2" style="font-size: 12em; margin-left: -0.25em;">(</span></span><span class="MJXp-mtable" id="MJXp-Span-2089"><span><span class="MJXp-mtr" id="MJXp-Span-2090" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2091" style="text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2092">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2093" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2094" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-2095">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2096" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2097">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2098" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2099">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2100" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2101">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2102" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2103">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2104" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2105">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2106" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2107" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2108">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2109" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2110">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2111" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2112" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-2113">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2114" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2115">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2116" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2117">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2118" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2119">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2120" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2121">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2122" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2123" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2124">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2125" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2126">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2127" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2128">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2129" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2130">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2131" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2132">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2133" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2134">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2135" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2136">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2137" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2138" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2139">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2140" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2141">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2142" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2143">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2144" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2145">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2146" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2147" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-2148">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2149" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2150">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2151" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2152">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2153" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2154" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2155">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2156" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2157">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2158" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2159">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2160" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2161">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2162" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2163">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2164" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2165">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2166" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2167">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2168" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2169" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2170">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2171" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2172">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2173" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2174">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2175" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2176">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2177" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2178">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2179" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2180">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2181" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2182" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-2183">1</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2184" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2185" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2186">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2187" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2188">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2189" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2190">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2191" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2192">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2193" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2194">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2195" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2196">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2197" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2198">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2199" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.75em;"><span class="MJXp-right MJXp-scale2" style="font-size: 12em; margin-left: -0.25em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-374">\begin{pmatrix} 1 & -1 & 0 & 0 & 0 & 0 & 0 \\ 1 & 1 & -1 & 0 & 0 & 0 & 0 \\ 0 & 1 & 1 & 1 & 0 & 0 & 0 \\ 0 & 0 & 1 & 1 & -1 & 0 & 0 \\ 0 & 0 & 0 & 1 & 1 & 1 & 0 \\ 0 & 0 & 0 & 0 & 1 & 1 & -1 \\ 0 & 0 & 0 & 0 & 0 & 1 & 1 \end{pmatrix}</script></center><p>Denote <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2200"><span class="MJXp-mo" id="MJXp-Span-2201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2203" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2204" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2205" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2207" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2208" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2209">k</span><span class="MJXp-mo" id="MJXp-Span-2210">+</span><span class="MJXp-mn" id="MJXp-Span-2211">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2212" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2213" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2214" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2215">x</span><span class="MJXp-mo" id="MJXp-Span-2216" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217">y</span><span class="MJXp-mo" id="MJXp-Span-2218" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-375">(A_k,A_{k+1})=(x,y)</script>.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">x</span><span class="MJXp-mo" id="MJXp-Span-2221" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2222">y</span></span></span><script type="math/tex" id="MathJax-Element-376">x>y</script>, the recursion process can be written as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2223"><span class="MJXp-mo" id="MJXp-Span-2224" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2225">x</span><span class="MJXp-mo" id="MJXp-Span-2226" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227">y</span><span class="MJXp-mo" id="MJXp-Span-2228" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2229" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-2230" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231">x</span><span class="MJXp-mo" id="MJXp-Span-2232" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233">y</span><span class="MJXp-mo" id="MJXp-Span-2234" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235">x</span><span class="MJXp-mo" id="MJXp-Span-2236" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2237" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-2238" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239">y</span><span class="MJXp-mo" id="MJXp-Span-2240" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2241">x</span><span class="MJXp-mo" id="MJXp-Span-2242" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">y</span><span class="MJXp-mo" id="MJXp-Span-2244" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-377">(x,y) \rightarrow (x-y,x) \rightarrow (y,x-y)</script>, increasing the length of the sequence by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2245"><span class="MJXp-mn" id="MJXp-Span-2246">2</span></span></span><script type="math/tex" id="MathJax-Element-378">2</script>, completing one iteration of subtraction.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248">x</span><span class="MJXp-mo" id="MJXp-Span-2249" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2250">y</span></span></span><script type="math/tex" id="MathJax-Element-379">x \le y</script>, the recursion process can be written as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2251"><span class="MJXp-mo" id="MJXp-Span-2252" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253">x</span><span class="MJXp-mo" id="MJXp-Span-2254" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255">y</span><span class="MJXp-mo" id="MJXp-Span-2256" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2257" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-2258" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">y</span><span class="MJXp-mo" id="MJXp-Span-2260" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261">x</span><span class="MJXp-mo" id="MJXp-Span-2262" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">x</span><span class="MJXp-mo" id="MJXp-Span-2264" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-380">(x,y) \rightarrow (y-x,x)</script>, increasing the length of the sequence by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2265"><span class="MJXp-mn" id="MJXp-Span-2266">1</span></span></span><script type="math/tex" id="MathJax-Element-381">1</script>, completing one iteration of subtraction.</p><p>The process will eventually lead to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2267"><span class="MJXp-mo" id="MJXp-Span-2268" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">x</span><span class="MJXp-mo" id="MJXp-Span-2270" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2271">0</span><span class="MJXp-mo" id="MJXp-Span-2272" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-382">(x,0)</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2273"><span class="MJXp-mo" id="MJXp-Span-2274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2275">0</span><span class="MJXp-mo" id="MJXp-Span-2276" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2277">x</span><span class="MJXp-mo" id="MJXp-Span-2278" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-383">(0,x)</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280">x</span></span></span><script type="math/tex" id="MathJax-Element-384">x</script> is the GCD of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2281"><span class="MJXp-msubsup" id="MJXp-Span-2282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2283" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2284" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-385">A_m</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2285"><span class="MJXp-msubsup" id="MJXp-Span-2286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2287" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2288" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">m</span><span class="MJXp-mo" id="MJXp-Span-2290">−</span><span class="MJXp-mn" id="MJXp-Span-2291">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-386">A_{m−1}</script>.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2292"><span class="MJXp-msubsup" id="MJXp-Span-2293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2294" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2295" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-387">A_m</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2296"><span class="MJXp-msubsup" id="MJXp-Span-2297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2298" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2299" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2300">m</span><span class="MJXp-mo" id="MJXp-Span-2301">−</span><span class="MJXp-mn" id="MJXp-Span-2302">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-388">A_{m−1}</script> are coprime, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2304">x</span><span class="MJXp-mo" id="MJXp-Span-2305" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2306">1</span></span></span><script type="math/tex" id="MathJax-Element-389">x=1</script>, meeting the requirements for the sequence. In fact, we can stop earlier when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2307"><span class="MJXp-mo" id="MJXp-Span-2308" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2309">1</span><span class="MJXp-mo" id="MJXp-Span-2310" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2311">2</span><span class="MJXp-mo" id="MJXp-Span-2312" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-390">(1,2)</script>, and the sequence is still legal.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2313"><span class="MJXp-msubsup" id="MJXp-Span-2314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2315" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2316" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-391">A_m</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2317"><span class="MJXp-msubsup" id="MJXp-Span-2318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2319" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2320" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2321">m</span><span class="MJXp-mo" id="MJXp-Span-2322">−</span><span class="MJXp-mn" id="MJXp-Span-2323">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-392">A_{m−1}</script> are not coprime, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2325">x</span><span class="MJXp-mo" id="MJXp-Span-2326" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-2327">1</span></span></span><script type="math/tex" id="MathJax-Element-393">x>1</script>, and this method can't obtain a sequence that meets the requirements.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: none;"><p>Given <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2328"><span class="MJXp-msubsup" id="MJXp-Span-2329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2330" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2331" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2332" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333">n</span></span></span><script type="math/tex" id="MathJax-Element-394">A_m=n</script>, we need to find a suitable <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2334"><span class="MJXp-msubsup" id="MJXp-Span-2335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2337" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2338">m</span><span class="MJXp-mo" id="MJXp-Span-2339">−</span><span class="MJXp-mn" id="MJXp-Span-2340">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-395">A_{m−1}</script> such that the length of the final sequence is less than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2341"><span class="MJXp-mn" id="MJXp-Span-2342">80</span></span></span><script type="math/tex" id="MathJax-Element-396">80</script>.</p><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2343"><span class="MJXp-mn" id="MJXp-Span-2344">80</span></span></span><script type="math/tex" id="MathJax-Element-397">80</script> is a relaxed constraint, and you only need to find one valid <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2345"><span class="MJXp-msubsup" id="MJXp-Span-2346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2348" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2349">m</span><span class="MJXp-mo" id="MJXp-Span-2350">−</span><span class="MJXp-mn" id="MJXp-Span-2351">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-398">A_{m−1}</script>, you can try various approaches. </p><p>For example, you could enumerate all possibilities within the range <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2352"><span class="MJXp-mo" id="MJXp-Span-2353" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2354">1</span><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">n</span><span class="MJXp-mo" id="MJXp-Span-2357" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2358">1</span><span class="MJXp-mo" id="MJXp-Span-2359" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-399">[1, n-1]</script> for some large <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361">n</span></span></span><script type="math/tex" id="MathJax-Element-400">n</script>, and then discover that there are many valid <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2362"><span class="MJXp-msubsup" id="MJXp-Span-2363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2365" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">m</span><span class="MJXp-mo" id="MJXp-Span-2367">−</span><span class="MJXp-mn" id="MJXp-Span-2368">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-401">A_{m−1}</script> values that meet the criteria. </p><p>If you randomly search for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2369"><span class="MJXp-msubsup" id="MJXp-Span-2370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2372" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2373">m</span><span class="MJXp-mo" id="MJXp-Span-2374">−</span><span class="MJXp-mn" id="MJXp-Span-2375">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-402">A_{m−1}</script> within the range, the expected number of attempts required is very low. In fact, the verification program tested all integers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377">n</span></span></span><script type="math/tex" id="MathJax-Element-403">n</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2378"><span class="MJXp-mn" id="MJXp-Span-2379">10</span></span></span><script type="math/tex" id="MathJax-Element-404">10</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2380"><span class="MJXp-msubsup" id="MJXp-Span-2381"><span class="MJXp-mn" id="MJXp-Span-2382" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2383" style="vertical-align: 0.5em;">7</span></span></span></span><script type="math/tex" id="MathJax-Element-405">10^7</script>, randomly selecting <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2384"><span class="MJXp-mn" id="MJXp-Span-2385">1000</span></span></span><script type="math/tex" id="MathJax-Element-406">1000</script> possible <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2386"><span class="MJXp-msubsup" id="MJXp-Span-2387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2389" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2390">m</span><span class="MJXp-mo" id="MJXp-Span-2391">−</span><span class="MJXp-mn" id="MJXp-Span-2392">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-407">A_{m−1}</script> values for each n and testing them. The results showed that in the worst case (when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2394">n</span><span class="MJXp-mo" id="MJXp-Span-2395" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2396">9827370</span></span></span><script type="math/tex" id="MathJax-Element-408">n = 9827370</script>), there were still <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2397"><span class="MJXp-mn" id="MJXp-Span-2398">24</span></span></span><script type="math/tex" id="MathJax-Element-409">24</script> valid <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2399"><span class="MJXp-msubsup" id="MJXp-Span-2400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2402" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2403">m</span><span class="MJXp-mo" id="MJXp-Span-2404">−</span><span class="MJXp-mn" id="MJXp-Span-2405">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-410">A_{m−1}</script> values that met the requirements out of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2406"><span class="MJXp-mn" id="MJXp-Span-2407">1000</span></span></span><script type="math/tex" id="MathJax-Element-411">1000</script> randomly chosen values.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><p>Code:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> fl</span><span class="pun">[</span><span class="lit">1005</span><span class="pun">],</span><span class="pln">inf</span><span class="pun">=</span><span class="lit">1e9</span><span class="pun">,</span><span class="pln">cnt</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> work</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&amp;&amp;</span><span class="pln">ans</span><span class="pun">&lt;=</span><span class="lit">80</span><span class="pun">){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">ans</span><span class="pun">;</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> inf</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> gen</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="com">//printf("%d\n",work(x,y));</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> seq</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!(</span><span class="pln">x</span><span class="pun">==</span><span class="lit">2</span><span class="pun">&amp;&amp;</span><span class="pln">y</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)){</span><span class="pln">
        tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="com">//x=tmp;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln"> 
        seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">105</span><span class="pun">][</span><span class="lit">105</span><span class="pun">]={</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">(),</span><span class="pln">n</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">()){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()&gt;</span><span class="pln">pre</span><span class="pun">)</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">){</span><span class="pln">
            printf</span><span class="pun">(</span><span class="str">"%d "</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        printf</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> _</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">_</span><span class="pun">;</span><span class="pln"> mt19937 rd</span><span class="pun">(</span><span class="pln">time</span><span class="pun">(</span><span class="lit">0</span><span class="pun">));</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">_</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n0\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n1\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">rd</span><span class="pun">()%(</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">work</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">&lt;=</span><span class="lit">80</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Verification Program:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">#pragma</span><span class="pln"> GCC optimize</span><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span><span class="pln">
</span><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> inf</span><span class="pun">=</span><span class="lit">1e9</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> work</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&amp;&amp;</span><span class="pln">ans</span><span class="pun">&lt;=</span><span class="lit">80</span><span class="pun">){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">ans</span><span class="pun">;</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> inf</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    mt19937 rd</span><span class="pun">(</span><span class="lit">114514</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">=</span><span class="lit">1e7</span><span class="pun">,</span><span class="pln">minn</span><span class="pun">=</span><span class="lit">1e3</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&gt;=</span><span class="lit">5</span><span class="pun">;</span><span class="pln">x</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> _</span><span class="pun">=</span><span class="lit">1e3</span><span class="pun">,</span><span class="pln">c</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">_</span><span class="pun">--){</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">rd</span><span class="pun">()%(</span><span class="pln">x</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">work</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">&lt;=</span><span class="lit">80</span><span class="pun">)</span><span class="pln"> </span><span class="pun">++</span><span class="pln">c</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c</span><span class="pun">&lt;</span><span class="pln">minn</span><span class="pun">)</span><span class="pln"> minn</span><span class="pun">=</span><span class="pln">c</span><span class="pun">,</span><span class="pln">cout</span><span class="pun">&lt;&lt;</span><span class="str">' '</span><span class="pun">&lt;&lt;</span><span class="pln">minn</span><span class="pun">&lt;&lt;</span><span class="str">' '</span><span class="pun">&lt;&lt;</span><span class="pln">x</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">%</span><span class="lit">10000</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> cout</span><span class="pun">&lt;&lt;</span><span class="pln">clock</span><span class="pun">()&lt;&lt;</span><span class="str">'#'</span><span class="pun">&lt;&lt;</span><span class="pln">x</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: none;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11928">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11929">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="12">12</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11930">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11931">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11932">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="10">10</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/E2">2139E2 — Determinant Construction (Hard Version)</a></p><p>Idea: <a class="rated-user user-orange" href="/profile/wjy666" title="Master wjy666">wjy666</a> Preparation: <a class="rated-user user-orange" href="/profile/wjy666" title="Master wjy666">wjy666</a></p><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2408"><span class="MJXp-mn" id="MJXp-Span-2409">50</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-412-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-412">50</script> is a very tight constraint, the author did not find a method to construct the DAG for G2 as in Solution 1 of G1. If you have a better solution, please leave a comment below.</p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: none;"><p>In Solution 2, the first two steps remain consistent with G1, but we need a better method to find a suitable <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2410"><span class="MJXp-msubsup" id="MJXp-Span-2411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2412" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2413" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2414">m</span><span class="MJXp-mo" id="MJXp-Span-2415">−</span><span class="MJXp-mn" id="MJXp-Span-2416">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-413">A_{m−1}</script> such that the length of the final sequence is less than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2417"><span class="MJXp-mn" id="MJXp-Span-2418">50</span></span></span><script type="math/tex" id="MathJax-Element-414">50</script>. Randomly searching for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2419"><span class="MJXp-msubsup" id="MJXp-Span-2420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2421" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2422" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2423">m</span><span class="MJXp-mo" id="MJXp-Span-2424">−</span><span class="MJXp-mn" id="MJXp-Span-2425">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-415">A_{m−1}</script> within the range <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2426"><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2428">1</span><span class="MJXp-mo" id="MJXp-Span-2429" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430">n</span><span class="MJXp-mo" id="MJXp-Span-2431" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2432">1</span><span class="MJXp-mo" id="MJXp-Span-2433" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-416">[1, n-1]</script> may result in TLE.</p><p>We noticed that if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2434"><span class="MJXp-msubsup" id="MJXp-Span-2435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2436" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2437" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2438">m</span><span class="MJXp-mo" id="MJXp-Span-2439">−</span><span class="MJXp-mn" id="MJXp-Span-2440">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-417">A_{m−1}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2441"><span class="MJXp-msubsup" id="MJXp-Span-2442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2443" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2444" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-418">A_m</script> are two adjacent fibonacci numbers, the sequence will converge rapidly (with a length within <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2445"><span class="MJXp-mn" id="MJXp-Span-2446">40</span></span></span><script type="math/tex" id="MathJax-Element-419">40</script>). Although not all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2447"><span class="MJXp-msubsup" id="MJXp-Span-2448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2450" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2451" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452">n</span></span></span><script type="math/tex" id="MathJax-Element-420">A_m=n</script> are fibonacci numbers, we can still draw inspiration from this.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution A</b><div class="spoiler-content" style="display: none;"><p>We attempt to decompose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454">n</span></span></span><script type="math/tex" id="MathJax-Element-421">n</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2456">n</span><span class="MJXp-mo" id="MJXp-Span-2457" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2458">a</span><span class="MJXp-mo" id="MJXp-Span-2459" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2460">fib</span><span class="MJXp-mo" id="MJXp-Span-2461" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2462" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2463">i</span><span class="MJXp-mo" id="MJXp-Span-2464" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2465" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2466">b</span><span class="MJXp-mo" id="MJXp-Span-2467" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2468">fib</span><span class="MJXp-mo" id="MJXp-Span-2469" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2470" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2471">i</span><span class="MJXp-mo" id="MJXp-Span-2472" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2473">1</span><span class="MJXp-mo" id="MJXp-Span-2474" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2475" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476">a</span><span class="MJXp-mo" id="MJXp-Span-2477" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478">b</span><span class="MJXp-mo" id="MJXp-Span-2479" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-2480">0</span></span></span><script type="math/tex" id="MathJax-Element-422">n=a \cdot \operatorname{fib}(i)+b \cdot \operatorname{fib}(i-1), a,b \ge 0</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2481"><span class="MJXp-mi" id="MJXp-Span-2482">fib</span><span class="MJXp-mo" id="MJXp-Span-2483" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2484" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485">i</span><span class="MJXp-mo" id="MJXp-Span-2486" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-423">\operatorname{fib}(i)</script> denotes the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2488">i</span></span></span><script type="math/tex" id="MathJax-Element-424">i</script>-th fibonacci number.</p><p>Then, we set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2489"><span class="MJXp-msubsup" id="MJXp-Span-2490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2491" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2492" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493">m</span><span class="MJXp-mo" id="MJXp-Span-2494">−</span><span class="MJXp-mn" id="MJXp-Span-2495">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2496" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2497">a</span><span class="MJXp-mo" id="MJXp-Span-2498" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2499">fib</span><span class="MJXp-mo" id="MJXp-Span-2500" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2501" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502">i</span><span class="MJXp-mo" id="MJXp-Span-2503" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2504">1</span><span class="MJXp-mo" id="MJXp-Span-2505" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2506" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507">b</span><span class="MJXp-mo" id="MJXp-Span-2508" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2509">fib</span><span class="MJXp-mo" id="MJXp-Span-2510" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2511" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2512">i</span><span class="MJXp-mo" id="MJXp-Span-2513" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2514">2</span><span class="MJXp-mo" id="MJXp-Span-2515" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-425">A_{m-1}=a \cdot \operatorname{fib}(i-1)+b \cdot \operatorname{fib}(i-2)</script></p><p>By iterating further, we obtain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2516"><span class="MJXp-msubsup" id="MJXp-Span-2517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2518" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2519" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2520">m</span><span class="MJXp-mo" id="MJXp-Span-2521">−</span><span class="MJXp-mn" id="MJXp-Span-2522">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2523" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2524">a</span><span class="MJXp-mo" id="MJXp-Span-2525" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2526">fib</span><span class="MJXp-mo" id="MJXp-Span-2527" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2528" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2529">i</span><span class="MJXp-mo" id="MJXp-Span-2530" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2531">2</span><span class="MJXp-mo" id="MJXp-Span-2532" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2533" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2534">b</span><span class="MJXp-mo" id="MJXp-Span-2535" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2536">fib</span><span class="MJXp-mo" id="MJXp-Span-2537" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2538" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539">i</span><span class="MJXp-mo" id="MJXp-Span-2540" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2541">3</span><span class="MJXp-mo" id="MJXp-Span-2542" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-426">A_{m-2}=a \cdot \operatorname{fib}(i-2)+b \cdot \operatorname{fib}(i-3)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2543"><span class="MJXp-mo" id="MJXp-Span-2544" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-427">\dots</script></p><p>The purpose of this is to make the iteration process rapidly decrease the value in the initial steps, similar to the fibonacci sequence. Intuitively, the larger the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2546">i</span></span></span><script type="math/tex" id="MathJax-Element-428">i</script> chosen, the higher the probability of finding a legal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2547"><span class="MJXp-msubsup" id="MJXp-Span-2548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2550" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2551">m</span><span class="MJXp-mo" id="MJXp-Span-2552">−</span><span class="MJXp-mn" id="MJXp-Span-2553">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-429">A_{m-1}</script>.</p><p>The author did not provide a rigorous mathematical proof for this, but using a verification program which found a legal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2554"><span class="MJXp-msubsup" id="MJXp-Span-2555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2557" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558">m</span><span class="MJXp-mo" id="MJXp-Span-2559">−</span><span class="MJXp-mn" id="MJXp-Span-2560">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-430">A_{m-1}</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2561"><span class="MJXp-msubsup" id="MJXp-Span-2562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2564" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2565" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2566">n</span><span class="MJXp-mo" id="MJXp-Span-2567" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-2568" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2569">2</span><span class="MJXp-mo" id="MJXp-Span-2570" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2571"><span class="MJXp-mn" id="MJXp-Span-2572" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2573" style="vertical-align: 0.5em;">7</span></span><span class="MJXp-mo" id="MJXp-Span-2574" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-431">A_m=n \in [2,10^7]</script> within one minute. Therefore, it is feasible to prove the correctness of this approach within the data range during the contest.</p> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> fl</span><span class="pun">[</span><span class="lit">1005</span><span class="pun">],</span><span class="pln">inf</span><span class="pun">=</span><span class="lit">1e9</span><span class="pun">,</span><span class="pln">cnt</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> work</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&amp;&amp;</span><span class="pln">ans</span><span class="pun">&lt;=</span><span class="lit">50</span><span class="pun">){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">ans</span><span class="pun">;</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> inf</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> gen</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="com">//printf("%d\n",work(x,y));</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> seq</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!(</span><span class="pln">x</span><span class="pun">==</span><span class="lit">2</span><span class="pun">&amp;&amp;</span><span class="pln">y</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)){</span><span class="pln">
        tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="com">//x=tmp;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln"> 
        seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">55</span><span class="pun">][</span><span class="lit">55</span><span class="pun">]={</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">(),</span><span class="pln">n</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">()){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()&gt;</span><span class="pln">pre</span><span class="pun">)</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">){</span><span class="pln">
            printf</span><span class="pun">(</span><span class="str">"%d "</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        printf</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll fib</span><span class="pun">[</span><span class="lit">55</span><span class="pun">]={</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">};</span><span class="pln">
ll exgcd</span><span class="pun">(</span><span class="pln">ll a</span><span class="pun">,</span><span class="pln">ll b</span><span class="pun">,</span><span class="pln">ll </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">,</span><span class="pln">ll </span><span class="pun">&amp;</span><span class="pln">y</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">b</span><span class="pun">){</span><span class="pln">
		x</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> y</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	ll d</span><span class="pun">=</span><span class="pln">exgcd</span><span class="pun">(</span><span class="pln">b</span><span class="pun">,</span><span class="pln">a</span><span class="pun">%</span><span class="pln">b</span><span class="pun">,</span><span class="pln">y</span><span class="pun">,</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
	y</span><span class="pun">-=(</span><span class="pln">a</span><span class="pun">/</span><span class="pln">b</span><span class="pun">)*</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> d</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> mp</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">50</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> fib</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> _</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">_</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">_</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n0\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n1\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">&lt;=</span><span class="lit">10</span><span class="pun">){</span><span class="pln">
            gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> noww</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">noww</span><span class="pun">]&lt;</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">++</span><span class="pln">noww</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> now</span><span class="pun">=</span><span class="pln">noww</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">now</span><span class="pun">&gt;=</span><span class="lit">3</span><span class="pun">){</span><span class="pln">
            ll a</span><span class="pun">=</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">now</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">b</span><span class="pun">=</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">now</span><span class="pun">-</span><span class="lit">2</span><span class="pun">],</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">,</span><span class="pln">c</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
            ll d</span><span class="pun">=</span><span class="pln">exgcd</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
            x</span><span class="pun">*=</span><span class="pln">c</span><span class="pun">,</span><span class="pln">y</span><span class="pun">*=</span><span class="pln">c</span><span class="pun">;</span><span class="pln">
            </span><span class="com">//find x,y</span><span class="pln">
            x</span><span class="pun">=(</span><span class="pln">x</span><span class="pun">%</span><span class="pln">b</span><span class="pun">+</span><span class="pln">b</span><span class="pun">)%</span><span class="pln">b</span><span class="pun">;</span><span class="pln">  y</span><span class="pun">=(</span><span class="pln">c</span><span class="pun">-</span><span class="pln">a</span><span class="pun">*</span><span class="pln">x</span><span class="pun">)/</span><span class="pln">b</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{--</span><span class="pln">now</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> s</span><span class="pun">=</span><span class="pln">inf</span><span class="pun">,</span><span class="pln">o</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">){</span><span class="pln">
                o</span><span class="pun">=</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">now</span><span class="pun">-</span><span class="lit">2</span><span class="pun">]*</span><span class="pln">x</span><span class="pun">+</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">now</span><span class="pun">-</span><span class="lit">3</span><span class="pun">]*</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
                s</span><span class="pun">=</span><span class="pln">work</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">o</span><span class="pun">);</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">&gt;</span><span class="lit">50</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">x</span><span class="pun">+=</span><span class="pln">b</span><span class="pun">,</span><span class="pln">y</span><span class="pun">-=</span><span class="pln">a</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
                </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">&gt;</span><span class="lit">50</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{--</span><span class="pln">now</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
            </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
                gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">o</span><span class="pun">);</span><span class="pln"> mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="pln">o</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="com">//</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution B</b><div class="spoiler-content" style="display: none;"><p>We note that for the fibonacci sequence, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2575"><span class="MJXp-msubsup" id="MJXp-Span-2576"><span class="MJXp-mo" id="MJXp-Span-2577" style="margin-left: 0.333em; margin-right: 0.05em;">lim</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2578" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2579">x</span><span class="MJXp-mo" id="MJXp-Span-2580">→</span><span class="MJXp-mi" id="MJXp-Span-2581">∞</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2582" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2583">fib</span><span class="MJXp-mo" id="MJXp-Span-2584"></span><span class="MJXp-mo" id="MJXp-Span-2585">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2586">x</span><span class="MJXp-mo" id="MJXp-Span-2587">−</span><span class="MJXp-mn" id="MJXp-Span-2588">1</span><span class="MJXp-mo" id="MJXp-Span-2589">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2590">fib</span><span class="MJXp-mo" id="MJXp-Span-2591"></span><span class="MJXp-mo" id="MJXp-Span-2592">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2593">x</span><span class="MJXp-mo" id="MJXp-Span-2594">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2595" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2596" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-2597"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2598">5</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2599">−</span><span class="MJXp-mn" id="MJXp-Span-2600">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2601">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-432">\lim_{x \to \infty} \frac{\operatorname{fib}(x-1)}{\operatorname{fib}(x)} = \frac{\sqrt 5 -1}{2}</script>, which suggests that searching for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2602"><span class="MJXp-msubsup" id="MJXp-Span-2603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2604" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2605" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2606">m</span><span class="MJXp-mo" id="MJXp-Span-2607">−</span><span class="MJXp-mn" id="MJXp-Span-2608">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-433">A_{m-1}</script> around <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2609"><span class="MJXp-mfrac" id="MJXp-Span-2610" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-2611"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2612">5</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2613">−</span><span class="MJXp-mn" id="MJXp-Span-2614">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2615">2</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2616">n</span></span></span><script type="math/tex" id="MathJax-Element-434">\frac{\sqrt 5 -1}{2}n</script> might be a promising approach.</p><p>In fact, directly enumerating <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2617"><span class="MJXp-msubsup" id="MJXp-Span-2618"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2619" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2620" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621">m</span><span class="MJXp-mo" id="MJXp-Span-2622">−</span><span class="MJXp-mn" id="MJXp-Span-2623">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-435">A_{m-1}</script> starting from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2624"><span class="MJXp-mfrac" id="MJXp-Span-2625" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-2626"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2627">5</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2628">−</span><span class="MJXp-mn" id="MJXp-Span-2629">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2630">2</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2631">n</span></span></span><script type="math/tex" id="MathJax-Element-436">\frac{\sqrt 5 -1}{2}n</script> and trying each one is a efficient method. The author also verified through a verification program that for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2632"><span class="MJXp-msubsup" id="MJXp-Span-2633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2634" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2635" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2636" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2637">n</span><span class="MJXp-mo" id="MJXp-Span-2638" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-2639" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2640">2</span><span class="MJXp-mo" id="MJXp-Span-2641" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2642"><span class="MJXp-mn" id="MJXp-Span-2643" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2644" style="vertical-align: 0.5em;">7</span></span><span class="MJXp-mo" id="MJXp-Span-2645" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-437">A_m=n \in [2,10^7]</script>, a legal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2646"><span class="MJXp-msubsup" id="MJXp-Span-2647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2648" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2649" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2650">m</span><span class="MJXp-mo" id="MJXp-Span-2651">−</span><span class="MJXp-mn" id="MJXp-Span-2652">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-438">A_{m-1}</script> was found within one minute. Thus, it is feasible to prove the correctness of this approach within the data range during the contest.</p><p>Considering that the time limit for this problem is relatively loose (5s), most attempts to search for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2653"><span class="MJXp-msubsup" id="MJXp-Span-2654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2655" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2656" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2657">m</span><span class="MJXp-mo" id="MJXp-Span-2658">−</span><span class="MJXp-mn" id="MJXp-Span-2659">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-439">A_{m-1}</script> around <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2660"><span class="MJXp-mfrac" id="MJXp-Span-2661" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-2662"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2663">5</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2664">−</span><span class="MJXp-mn" id="MJXp-Span-2665">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2666">2</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2667">n</span></span></span><script type="math/tex" id="MathJax-Element-440">\frac{\sqrt 5 -1}{2}n</script> may be able to pass.</p> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> fl</span><span class="pun">[</span><span class="lit">1005</span><span class="pun">],</span><span class="pln">inf</span><span class="pun">=</span><span class="lit">1e9</span><span class="pun">,</span><span class="pln">cnt</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> work</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&amp;&amp;</span><span class="pln">ans</span><span class="pun">&lt;=</span><span class="lit">50</span><span class="pun">){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">ans</span><span class="pun">;</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> inf</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> gen</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="com">//printf("%d\n",work(x,y));</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> seq</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!(</span><span class="pln">x</span><span class="pun">==</span><span class="lit">2</span><span class="pun">&amp;&amp;</span><span class="pln">y</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)){</span><span class="pln">
        tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="com">//x=tmp;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln"> 
        seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">55</span><span class="pun">][</span><span class="lit">55</span><span class="pun">]={</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">(),</span><span class="pln">n</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">()){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()&gt;</span><span class="pln">pre</span><span class="pun">)</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">){</span><span class="pln">
            printf</span><span class="pun">(</span><span class="str">"%d "</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        printf</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> mp</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> _</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">_</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">_</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n0\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n1\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">double</span><span class="pln"> s</span><span class="pun">=(</span><span class="pln">sqrt</span><span class="pun">(</span><span class="lit">5</span><span class="pun">)-</span><span class="lit">1.0</span><span class="pun">)/</span><span class="lit">2.0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> st</span><span class="pun">=</span><span class="pln">s</span><span class="pun">*</span><span class="pln">n</span><span class="pun">,</span><span class="pln">l</span><span class="pun">=</span><span class="pln">max</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">st</span><span class="pun">),</span><span class="pln">r</span><span class="pun">=</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="com">//int l=1,r=n-1;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> nowy</span><span class="pun">,</span><span class="pln">nows</span><span class="pun">=</span><span class="lit">50</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">%</span><span class="lit">2</span><span class="pun">==</span><span class="lit">0</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">%</span><span class="lit">2</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">++</span><span class="pln">l</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">l</span><span class="pun">;</span><span class="pln">y</span><span class="pun">&lt;=</span><span class="pln">r</span><span class="pun">;</span><span class="pln">y</span><span class="pun">+=</span><span class="lit">2</span><span class="pun">){</span><span class="pln">
                </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">work</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">&lt;=</span><span class="pln">nows</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln"> mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">l</span><span class="pun">;</span><span class="pln">y</span><span class="pun">&lt;=</span><span class="pln">r</span><span class="pun">;++</span><span class="pln">y</span><span class="pun">){</span><span class="pln">
                </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">work</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">&lt;=</span><span class="pln">nows</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln"> mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: none;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11933">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="20">20</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11934">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11935">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11936">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11937">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/F">2139F — Ode to the Bridge Builder</a></p><p>Idea: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a> Preparation: <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><p>For convenience, we mark the targets point and the points on the initial segment with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2669">A</span><span class="MJXp-mo" id="MJXp-Span-2670" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2671">0</span><span class="MJXp-mo" id="MJXp-Span-2672" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2673">0</span><span class="MJXp-mo" id="MJXp-Span-2674" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2675" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2676">B</span><span class="MJXp-mo" id="MJXp-Span-2677" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2678">1</span><span class="MJXp-mo" id="MJXp-Span-2679" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2680">0</span><span class="MJXp-mo" id="MJXp-Span-2681" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2682" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2683">C</span><span class="MJXp-mo" id="MJXp-Span-2684" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685">p</span><span class="MJXp-mo" id="MJXp-Span-2686" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2687">q</span><span class="MJXp-mo" id="MJXp-Span-2688" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-441">A(0,0),B(1,0),C(p,q)</script>.</p><p>The problem asks us to do at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2689"><span class="MJXp-mrow" id="MJXp-Span-2690"><span class="MJXp-mo" id="MJXp-Span-2691" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-2692">2</span><span class="MJXp-mrow" id="MJXp-Span-2693"><span class="MJXp-mo" id="MJXp-Span-2694" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2695">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2696">C</span><span class="MJXp-mrow" id="MJXp-Span-2697"><span class="MJXp-mo" id="MJXp-Span-2698" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2699" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-442">\left\lceil 2|AC|\right\rceil</script> moves. This constraint is actually not quite usual. We can first show that the theoretical lower bound should be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2701">x</span><span class="MJXp-mo" id="MJXp-Span-2702" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2703"><span class="MJXp-mo" id="MJXp-Span-2704" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-2705"><span class="MJXp-mo" id="MJXp-Span-2706" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2707">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2708">C</span><span class="MJXp-mrow" id="MJXp-Span-2709"><span class="MJXp-mo" id="MJXp-Span-2710" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2711" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-2712" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-2713"><span class="MJXp-mo" id="MJXp-Span-2714" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-2715"><span class="MJXp-mo" id="MJXp-Span-2716" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2717">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2718">C</span><span class="MJXp-mrow" id="MJXp-Span-2719"><span class="MJXp-mo" id="MJXp-Span-2720" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2721" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-2722" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2723">1</span></span></span><script type="math/tex" id="MathJax-Element-443">x=\left\lceil |AC|\right\rceil+\left\lceil |BC|\right\rceil−1</script>. We can show we can't get less moves by following: If we have already constructed the final structure, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2725">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2726">C</span></span></span><script type="math/tex" id="MathJax-Element-444">AC</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2728">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2729">C</span></span></span><script type="math/tex" id="MathJax-Element-445">BC</script> should be connected with a path, and we can find a path from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2731">A</span></span></span><script type="math/tex" id="MathJax-Element-446">A</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2733">C</span></span></span><script type="math/tex" id="MathJax-Element-447">C</script> and a path from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2735">B</span></span></span><script type="math/tex" id="MathJax-Element-448">B</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2737">C</span></span></span><script type="math/tex" id="MathJax-Element-449">C</script> that don't intersect (except at point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2739">C</span></span></span><script type="math/tex" id="MathJax-Element-450">C</script>), otherwise the structure can't be built with non-degenerate triangles.</p><p>And we have to alternate progressing through two paths every time we construct a triangle, otherwise we must draw a line longer than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2740"><span class="MJXp-mn" id="MJXp-Span-2741">1</span></span></span><script type="math/tex" id="MathJax-Element-451">1</script>. The last triangle will cover both paths, so the number of steps will be decreased by one. The optimal path is two straight segments (which is not always possible).</p><p><strong>Case 1.1:</strong> We first try some simple strategies. Two triangles can form a parallelogram, so we can connect <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2743">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2744">C</span></span></span><script type="math/tex" id="MathJax-Element-452">AC</script>, choose a point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2746">D</span></span></span><script type="math/tex" id="MathJax-Element-453">D</script> on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2748">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2749">C</span></span></span><script type="math/tex" id="MathJax-Element-454">AC</script> which makes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2750"><span class="MJXp-mrow" id="MJXp-Span-2751"><span class="MJXp-mo" id="MJXp-Span-2752" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2753">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2754">D</span><span class="MJXp-mrow" id="MJXp-Span-2755"><span class="MJXp-mo" id="MJXp-Span-2756" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2757" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2758" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2759"><span class="MJXp-mo" id="MJXp-Span-2760">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2761">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2762">C</span><span class="MJXp-mrow" id="MJXp-Span-2763"><span class="MJXp-mo" id="MJXp-Span-2764">|</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-2765">⌈</span><span class="MJXp-mrow" id="MJXp-Span-2766"><span class="MJXp-mo" id="MJXp-Span-2767">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2768">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2769">C</span><span class="MJXp-mrow" id="MJXp-Span-2770"><span class="MJXp-mo" id="MJXp-Span-2771">|</span></span><span class="MJXp-mo" id="MJXp-Span-2772">⌉</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-455">|AD|=\frac{|AC|}{\lceil|AC|\rceil}</script>, which is always in range <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2773"><span class="MJXp-mo" id="MJXp-Span-2774" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2775">0.5</span><span class="MJXp-mo" id="MJXp-Span-2776" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2777">1</span><span class="MJXp-mo" id="MJXp-Span-2778" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-456">[0.5,1]</script> when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2779"><span class="MJXp-mrow" id="MJXp-Span-2780"><span class="MJXp-mo" id="MJXp-Span-2781" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2782">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2783">C</span><span class="MJXp-mrow" id="MJXp-Span-2784"><span class="MJXp-mo" id="MJXp-Span-2785" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2786" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-2787">1</span></span></span><script type="math/tex" id="MathJax-Element-457">|AC|\ge 1</script>. And from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2788"><span class="MJXp-mi" id="MJXp-Span-2789">△</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2790">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2791">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2792">B</span></span></span><script type="math/tex" id="MathJax-Element-458">\triangle ADB</script> we can construct a parallelogram. We draw a line passing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2794">D</span></span></span><script type="math/tex" id="MathJax-Element-459">D</script> that is parallel to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2796">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2797">B</span></span></span><script type="math/tex" id="MathJax-Element-460">AB</script>, a line passing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2799">B</span></span></span><script type="math/tex" id="MathJax-Element-461">B</script> that is parallel to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2801">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2802">C</span></span></span><script type="math/tex" id="MathJax-Element-462">AC</script>, and they intersect at <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2804">E</span></span></span><script type="math/tex" id="MathJax-Element-463">E</script>. Then we pile up the same parallelogram structure until we reach <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2806">C</span></span></span><script type="math/tex" id="MathJax-Element-464">C</script>. This always works when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2807"><span class="MJXp-msubsup" id="MJXp-Span-2808"><span class="MJXp-mn" id="MJXp-Span-2809" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2810" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-2811" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-2812">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2813">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2815">B</span><span class="MJXp-mo" id="MJXp-Span-2816" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2817"><span class="MJXp-mn" id="MJXp-Span-2818" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2819" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-465">30^\circ\le\angle CAB\le60^\circ</script>.</p><p>Proof: We first prove that all segments have length between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2820"><span class="MJXp-mn" id="MJXp-Span-2821">0.5</span></span></span><script type="math/tex" id="MathJax-Element-466">0.5</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2822"><span class="MJXp-mn" id="MJXp-Span-2823">1</span></span></span><script type="math/tex" id="MathJax-Element-467">1</script>. Because we stack the same parallelogram structure, all segments have length equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2825">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2826">B</span><span class="MJXp-mo" id="MJXp-Span-2827" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2828">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2829">D</span></span></span><script type="math/tex" id="MathJax-Element-468">AB,BD</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2831">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2832">D</span></span></span><script type="math/tex" id="MathJax-Element-469">AD</script>. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2834">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2835">B</span></span></span><script type="math/tex" id="MathJax-Element-470">AB</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2837">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2838">D</span></span></span><script type="math/tex" id="MathJax-Element-471">AD</script> already meet the requirement. When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2839"><span class="MJXp-msubsup" id="MJXp-Span-2840"><span class="MJXp-mn" id="MJXp-Span-2841" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2842" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-2843" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-2844">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2845">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2846">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2847">B</span><span class="MJXp-mo" id="MJXp-Span-2848" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2849"><span class="MJXp-mn" id="MJXp-Span-2850" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2851" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-472">30^\circ\le\angle CAB\le60^\circ</script>, the length of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2853">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2854">D</span></span></span><script type="math/tex" id="MathJax-Element-473">BD</script> is at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2855"><span class="MJXp-mn" id="MJXp-Span-2856">0.5</span></span></span><script type="math/tex" id="MathJax-Element-474">0.5</script> as the distance between two parallel lines is at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2857"><span class="MJXp-mn" id="MJXp-Span-2858">0.5</span></span></span><script type="math/tex" id="MathJax-Element-475">0.5</script>, and at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2859"><span class="MJXp-mn" id="MJXp-Span-2860">1</span></span></span><script type="math/tex" id="MathJax-Element-476">1</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2862">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2863">B</span><span class="MJXp-mo" id="MJXp-Span-2864" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2865">1</span></span></span><script type="math/tex" id="MathJax-Element-477">AB=1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2866"><span class="MJXp-mi" id="MJXp-Span-2867">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2869">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2870">B</span></span></span><script type="math/tex" id="MathJax-Element-478">\angle CAB</script> is never the largest angle in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2871"><span class="MJXp-mi" id="MJXp-Span-2872">△</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2873">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2874">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2875">B</span></span></span><script type="math/tex" id="MathJax-Element-479">\triangle DAB</script>. We can calculate that the number of moves we used is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2876"><span class="MJXp-mn" id="MJXp-Span-2877">2</span><span class="MJXp-mrow" id="MJXp-Span-2878"><span class="MJXp-mo" id="MJXp-Span-2879" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-2880"><span class="MJXp-mo" id="MJXp-Span-2881" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2882">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2883">C</span><span class="MJXp-mrow" id="MJXp-Span-2884"><span class="MJXp-mo" id="MJXp-Span-2885" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2886" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-2887" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2888">1</span><span class="MJXp-mo" id="MJXp-Span-2889" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-2890"><span class="MJXp-mo" id="MJXp-Span-2891" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-2892">2</span><span class="MJXp-mrow" id="MJXp-Span-2893"><span class="MJXp-mo" id="MJXp-Span-2894" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2895">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2896">C</span><span class="MJXp-mrow" id="MJXp-Span-2897"><span class="MJXp-mo" id="MJXp-Span-2898" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2899" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-480">2\left\lceil |AC|\right\rceil-1\le\left\lceil 2|AC|\right\rceil</script> which matches the requirement (for the last parallelogram we only need one triangle).</p><p><img alt=" " src="/predownloaded/a6/c3/a6c3323e11dddf322cfc8b3188b3564471665a92.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p><strong>Case 1.2:</strong> We can change the way we construct parallelograms (with sides <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2901">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2902">B</span><span class="MJXp-mo" id="MJXp-Span-2903" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2904">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2905">C</span></span></span><script type="math/tex" id="MathJax-Element-481">AB,BC</script>) and this method always works when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2906"><span class="MJXp-msubsup" id="MJXp-Span-2907"><span class="MJXp-mn" id="MJXp-Span-2908" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2909" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-2910" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-2911">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2912">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2913">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2914">x</span><span class="MJXp-mo" id="MJXp-Span-2915" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2916"><span class="MJXp-mn" id="MJXp-Span-2917" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2918" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-482">30^\circ\le\angle CBx\le60^\circ</script>. The number of moves is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2919"><span class="MJXp-mrow" id="MJXp-Span-2920"><span class="MJXp-mo" id="MJXp-Span-2921" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-2922">2</span><span class="MJXp-mrow" id="MJXp-Span-2923"><span class="MJXp-mo" id="MJXp-Span-2924" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2925">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2926">C</span><span class="MJXp-mrow" id="MJXp-Span-2927"><span class="MJXp-mo" id="MJXp-Span-2928" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2929" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-2930" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-2931"><span class="MJXp-mo" id="MJXp-Span-2932" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-2933">2</span><span class="MJXp-mrow" id="MJXp-Span-2934"><span class="MJXp-mo" id="MJXp-Span-2935" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2936">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2937">C</span><span class="MJXp-mrow" id="MJXp-Span-2938"><span class="MJXp-mo" id="MJXp-Span-2939" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2940" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-483">\left\lceil2|BC|\right\rceil\le \left\lceil 2|AC|\right\rceil</script>. This case is actually necessary, which will be explained in the following part.</p><p><img alt=" " src="/predownloaded/d5/83/d583339323c45df6492d338f0b207b364d914a94.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p><strong>Case 2:</strong> If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2941"><span class="MJXp-mi" id="MJXp-Span-2942">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2943">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2944">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2945">B</span><span class="MJXp-mo" id="MJXp-Span-2946" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi" id="MJXp-Span-2947">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2948">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2949">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2950">x</span><span class="MJXp-mo" id="MJXp-Span-2951" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2952"><span class="MJXp-mn" id="MJXp-Span-2953" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2954" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-484">\angle CAB< \angle CBx<30^\circ</script>. We first build a point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2956">D</span></span></span><script type="math/tex" id="MathJax-Element-485">D</script> which makes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2958">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2959">D</span><span class="MJXp-mo" id="MJXp-Span-2960" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2961">1</span></span></span><script type="math/tex" id="MathJax-Element-486">AD=1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2962"><span class="MJXp-mi" id="MJXp-Span-2963">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2964">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2965">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2966">B</span><span class="MJXp-mo" id="MJXp-Span-2967" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2968"><span class="MJXp-mn" id="MJXp-Span-2969" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2970" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-487">\angle DAB=30^\circ</script> and construct <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2971"><span class="MJXp-mi" id="MJXp-Span-2972">△</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2973">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2974">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2975">B</span></span></span><script type="math/tex" id="MathJax-Element-488">\triangle DAB</script>. </p><p>We can show that the constraint is actually easier to meet in this situation, because when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2976"><span class="MJXp-mi" id="MJXp-Span-2977">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2978">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2979">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2980">B</span><span class="MJXp-mo" id="MJXp-Span-2981" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi" id="MJXp-Span-2982">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2983">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2984">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2985">x</span><span class="MJXp-mo" id="MJXp-Span-2986" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2987"><span class="MJXp-mn" id="MJXp-Span-2988" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2989" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-489">\angle CAB<\angle CBx<30^\circ</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2990"><span class="MJXp-mrow" id="MJXp-Span-2991"><span class="MJXp-mo" id="MJXp-Span-2992" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2993">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2994">C</span><span class="MJXp-mrow" id="MJXp-Span-2995"><span class="MJXp-mo" id="MJXp-Span-2996" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2997" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mrow" id="MJXp-Span-2998"><span class="MJXp-mo" id="MJXp-Span-2999" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3000">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3001">C</span><span class="MJXp-mrow" id="MJXp-Span-3002"><span class="MJXp-mo" id="MJXp-Span-3003" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3004" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3005">0.5</span></span></span><script type="math/tex" id="MathJax-Element-490">|BC|<|AC|-0.5</script>. With this, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3006"><span class="MJXp-mrow" id="MJXp-Span-3007"><span class="MJXp-mo" id="MJXp-Span-3008" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3009"><span class="MJXp-mo" id="MJXp-Span-3010" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3011">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3012">C</span><span class="MJXp-mrow" id="MJXp-Span-3013"><span class="MJXp-mo" id="MJXp-Span-3014" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3015" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3016" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-3017"><span class="MJXp-mo" id="MJXp-Span-3018" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3019"><span class="MJXp-mo" id="MJXp-Span-3020" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3021">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3022">C</span><span class="MJXp-mrow" id="MJXp-Span-3023"><span class="MJXp-mo" id="MJXp-Span-3024" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3025" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3026" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3027">1</span><span class="MJXp-mo" id="MJXp-Span-3028" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3029"><span class="MJXp-mo" id="MJXp-Span-3030" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3031">2</span><span class="MJXp-mrow" id="MJXp-Span-3032"><span class="MJXp-mo" id="MJXp-Span-3033" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3034">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3035">C</span><span class="MJXp-mrow" id="MJXp-Span-3036"><span class="MJXp-mo" id="MJXp-Span-3037" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3038" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3039" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3040">1</span></span></span><script type="math/tex" id="MathJax-Element-491">\left\lceil |AC|\right\rceil+\left\lceil |BC|\right\rceil−1=\left\lceil 2|AC|\right\rceil-1</script> always holds, allowing us one extra move.</p><p>Then we draw a line passing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3042">D</span></span></span><script type="math/tex" id="MathJax-Element-492">D</script> parallel to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3044">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3045">C</span></span></span><script type="math/tex" id="MathJax-Element-493">BC</script>. We can show that if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3046"><span class="MJXp-mi" id="MJXp-Span-3047">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3048">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3049">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3050">B</span><span class="MJXp-mo" id="MJXp-Span-3051" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3052"><span class="MJXp-mn" id="MJXp-Span-3053" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3054" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-494">\angle DAB=30^\circ</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3055"><span class="MJXp-mn" id="MJXp-Span-3056">0</span><span class="MJXp-mo" id="MJXp-Span-3057" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-3058">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3059">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3060">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3061">B</span><span class="MJXp-mo" id="MJXp-Span-3062" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-3063"><span class="MJXp-mn" id="MJXp-Span-3064" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3065" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-495">0\le \angle CAB\le 30^\circ</script>, the distance from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3067">D</span></span></span><script type="math/tex" id="MathJax-Element-496">D</script> to line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3068"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3069">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3070">C</span></span></span><script type="math/tex" id="MathJax-Element-497">BC</script> is at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3071"><span class="MJXp-mn" id="MJXp-Span-3072">0.5</span></span></span><script type="math/tex" id="MathJax-Element-498">0.5</script>. So all segments with ends on different lines will have length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3073"><span class="MJXp-mo" id="MJXp-Span-3074" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-3075">0.5</span></span></span><script type="math/tex" id="MathJax-Element-499">\ge 0.5</script>.</p><p>Then we select a point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3077">E</span></span></span><script type="math/tex" id="MathJax-Element-500">E</script> on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3079">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3080">C</span></span></span><script type="math/tex" id="MathJax-Element-501">BC</script>, which makes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3082">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3083">E</span><span class="MJXp-mo" id="MJXp-Span-3084" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3085">1</span></span></span><script type="math/tex" id="MathJax-Element-502">DE=1</script>. We can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3086"><span class="MJXp-msqrt" id="MJXp-Span-3087"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3088">3</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3089" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3090">1</span><span class="MJXp-mo" id="MJXp-Span-3091" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-3092"><span class="MJXp-mo" id="MJXp-Span-3093" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3094">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3095">E</span><span class="MJXp-mrow" id="MJXp-Span-3096"><span class="MJXp-mo" id="MJXp-Span-3097" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3098" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3099">1</span></span></span><script type="math/tex" id="MathJax-Element-503">\sqrt{3}-1\le |BE|\le 1</script> based on some calculations in this case. Then we do a similar parallelogram construction process to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3101">C</span></span></span><script type="math/tex" id="MathJax-Element-504">C</script>. The total number of moves is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3102"><span class="MJXp-mn" id="MJXp-Span-3103">2</span><span class="MJXp-mrow" id="MJXp-Span-3104"><span class="MJXp-mo" id="MJXp-Span-3105" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3106"><span class="MJXp-mo" id="MJXp-Span-3107" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3108">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3109">E</span><span class="MJXp-mrow" id="MJXp-Span-3110"><span class="MJXp-mo" id="MJXp-Span-3111" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3112" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3113" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3114">2</span></span></span><script type="math/tex" id="MathJax-Element-505">2\left\lceil |CE|\right\rceil+2</script>.</p><p>There are still two cases here to analyze to prove the number of steps fulfills our requirement. We write <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3115"><span class="MJXp-mrow" id="MJXp-Span-3116"><span class="MJXp-mo" id="MJXp-Span-3117" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3118">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3119">C</span><span class="MJXp-mrow" id="MJXp-Span-3120"><span class="MJXp-mo" id="MJXp-Span-3121" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3122" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3123">a</span><span class="MJXp-mo" id="MJXp-Span-3124" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3125">b</span></span></span><script type="math/tex" id="MathJax-Element-506">|BC|=a+b</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3127">a</span></span></span><script type="math/tex" id="MathJax-Element-507">a</script> is the integer part of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3128"><span class="MJXp-mrow" id="MJXp-Span-3129"><span class="MJXp-mo" id="MJXp-Span-3130" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3131">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3132">C</span><span class="MJXp-mrow" id="MJXp-Span-3133"><span class="MJXp-mo" id="MJXp-Span-3134" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-508">|BC|</script>, then we analyze cases about <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3136">b</span></span></span><script type="math/tex" id="MathJax-Element-509">b</script>.</p> <ul>   <li><p>Case 2.1: When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3138">b</span><span class="MJXp-mo" id="MJXp-Span-3139" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msqrt" id="MJXp-Span-3140"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3141">3</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3142" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3143">1</span></span></span><script type="math/tex" id="MathJax-Element-510">b\ge\sqrt{3}-1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3145">b</span><span class="MJXp-mo" id="MJXp-Span-3146" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3147">0</span></span></span><script type="math/tex" id="MathJax-Element-511">b=0</script>, we can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3148"><span class="MJXp-mn" id="MJXp-Span-3149">2</span><span class="MJXp-mrow" id="MJXp-Span-3150"><span class="MJXp-mo" id="MJXp-Span-3151" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3152"><span class="MJXp-mo" id="MJXp-Span-3153" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3154">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3155">C</span><span class="MJXp-mrow" id="MJXp-Span-3156"><span class="MJXp-mo" id="MJXp-Span-3157" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3158" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3159" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3160"><span class="MJXp-mo" id="MJXp-Span-3161" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3162">2</span><span class="MJXp-mrow" id="MJXp-Span-3163"><span class="MJXp-mo" id="MJXp-Span-3164" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3165">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3166">C</span><span class="MJXp-mrow" id="MJXp-Span-3167"><span class="MJXp-mo" id="MJXp-Span-3168" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3169" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-512">2\left\lceil |AC|\right\rceil=\left\lceil 2|AC|\right\rceil</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3170"><span class="MJXp-mrow" id="MJXp-Span-3171"><span class="MJXp-mo" id="MJXp-Span-3172" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3173"><span class="MJXp-mo" id="MJXp-Span-3174" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3175">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3176">C</span><span class="MJXp-mrow" id="MJXp-Span-3177"><span class="MJXp-mo" id="MJXp-Span-3178" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3179" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3180" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3181"><span class="MJXp-mo" id="MJXp-Span-3182" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3183"><span class="MJXp-mo" id="MJXp-Span-3184" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3185">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3186">C</span><span class="MJXp-mrow" id="MJXp-Span-3187"><span class="MJXp-mo" id="MJXp-Span-3188" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3189" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3190" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3191">1</span></span></span><script type="math/tex" id="MathJax-Element-513">\left\lceil |AC|\right\rceil=\left\lceil |BC|\right\rceil+1</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3192"><span class="MJXp-mrow" id="MJXp-Span-3193"><span class="MJXp-mo" id="MJXp-Span-3194" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3195">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3196">C</span><span class="MJXp-mrow" id="MJXp-Span-3197"><span class="MJXp-mo" id="MJXp-Span-3198" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3199" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-3200">2</span></span></span><script type="math/tex" id="MathJax-Element-514">|AC|\ge 2</script>. The number of steps is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3201"><span class="MJXp-mn" id="MJXp-Span-3202">2</span><span class="MJXp-mrow" id="MJXp-Span-3203"><span class="MJXp-mo" id="MJXp-Span-3204" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3205"><span class="MJXp-mo" id="MJXp-Span-3206" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3207">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3208">C</span><span class="MJXp-mrow" id="MJXp-Span-3209"><span class="MJXp-mo" id="MJXp-Span-3210" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3211" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3212" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3213">2</span><span class="MJXp-mo" id="MJXp-Span-3214" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3215">2</span><span class="MJXp-mrow" id="MJXp-Span-3216"><span class="MJXp-mo" id="MJXp-Span-3217" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3218"><span class="MJXp-mo" id="MJXp-Span-3219" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3220">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3221">C</span><span class="MJXp-mrow" id="MJXp-Span-3222"><span class="MJXp-mo" id="MJXp-Span-3223" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3224" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3225" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3226">2</span><span class="MJXp-mo" id="MJXp-Span-3227" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3228">2</span><span class="MJXp-mrow" id="MJXp-Span-3229"><span class="MJXp-mo" id="MJXp-Span-3230" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3231"><span class="MJXp-mo" id="MJXp-Span-3232" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3233">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3234">C</span><span class="MJXp-mrow" id="MJXp-Span-3235"><span class="MJXp-mo" id="MJXp-Span-3236" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3237" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-515">2\left\lceil |EC|\right\rceil+2\le 2\left\lceil |BC|\right\rceil+2=2\left\lceil |AC|\right\rceil</script>.</p></li>   <li><p>Case 2.2: When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3238"><span class="MJXp-mn" id="MJXp-Span-3239">0</span><span class="MJXp-mo" id="MJXp-Span-3240" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3241">b</span><span class="MJXp-mo" id="MJXp-Span-3242" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msqrt" id="MJXp-Span-3243"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3244">3</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3245" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3246">1</span></span></span><script type="math/tex" id="MathJax-Element-516">0<b<\sqrt{3}-1</script>, we can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3247"><span class="MJXp-mrow" id="MJXp-Span-3248"><span class="MJXp-mo" id="MJXp-Span-3249" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3250"><span class="MJXp-mo" id="MJXp-Span-3251" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3252">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3253">C</span><span class="MJXp-mrow" id="MJXp-Span-3254"><span class="MJXp-mo" id="MJXp-Span-3255" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3256" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3257" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3258"><span class="MJXp-mo" id="MJXp-Span-3259" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3260"><span class="MJXp-mo" id="MJXp-Span-3261" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3262">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3263">C</span><span class="MJXp-mrow" id="MJXp-Span-3264"><span class="MJXp-mo" id="MJXp-Span-3265" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3266" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3267" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3268">1</span></span></span><script type="math/tex" id="MathJax-Element-517">\left\lceil |EC|\right\rceil=\left\lceil |BC|\right\rceil-1</script>. The number of steps equals to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3269"><span class="MJXp-mn" id="MJXp-Span-3270">2</span><span class="MJXp-mo" id="MJXp-Span-3271" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3272">2</span><span class="MJXp-mrow" id="MJXp-Span-3273"><span class="MJXp-mo" id="MJXp-Span-3274" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3275"><span class="MJXp-mo" id="MJXp-Span-3276" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3277">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3278">E</span><span class="MJXp-mrow" id="MJXp-Span-3279"><span class="MJXp-mo" id="MJXp-Span-3280" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3281" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3282" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3283">2</span><span class="MJXp-mrow" id="MJXp-Span-3284"><span class="MJXp-mo" id="MJXp-Span-3285" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3286"><span class="MJXp-mo" id="MJXp-Span-3287" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3288">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3289">C</span><span class="MJXp-mrow" id="MJXp-Span-3290"><span class="MJXp-mo" id="MJXp-Span-3291" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3292" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3293" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-3294"><span class="MJXp-mo" id="MJXp-Span-3295" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3296"><span class="MJXp-mo" id="MJXp-Span-3297" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3298">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3299">C</span><span class="MJXp-mrow" id="MJXp-Span-3300"><span class="MJXp-mo" id="MJXp-Span-3301" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3302" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3303" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-3304"><span class="MJXp-mo" id="MJXp-Span-3305" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3306"><span class="MJXp-mo" id="MJXp-Span-3307" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3308">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3309">C</span><span class="MJXp-mrow" id="MJXp-Span-3310"><span class="MJXp-mo" id="MJXp-Span-3311" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3312" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3313" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3314"><span class="MJXp-mo" id="MJXp-Span-3315" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3316">2</span><span class="MJXp-mrow" id="MJXp-Span-3317"><span class="MJXp-mo" id="MJXp-Span-3318" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3319">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3320">C</span><span class="MJXp-mrow" id="MJXp-Span-3321"><span class="MJXp-mo" id="MJXp-Span-3322" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3323" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-518">2+2\left\lceil |CE|\right\rceil=2\left\lceil |BC|\right\rceil\le \left\lceil |AC|\right\rceil+\left\lceil |BC|\right\rceil=\left\lceil 2|AC|\right\rceil</script>. </p></li> </ul><p>Be careful with small cases where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3324"><span class="MJXp-mrow" id="MJXp-Span-3325"><span class="MJXp-mo" id="MJXp-Span-3326" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3327">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3328">C</span><span class="MJXp-mrow" id="MJXp-Span-3329"><span class="MJXp-mo" id="MJXp-Span-3330" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-519">|BC|</script> is too short, which may make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3331"><span class="MJXp-mrow" id="MJXp-Span-3332"><span class="MJXp-mo" id="MJXp-Span-3333" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3334">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3335">F</span><span class="MJXp-mrow" id="MJXp-Span-3336"><span class="MJXp-mo" id="MJXp-Span-3337" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3338" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3339"><span class="MJXp-mo" id="MJXp-Span-3340" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3341">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3342">G</span><span class="MJXp-mrow" id="MJXp-Span-3343"><span class="MJXp-mo" id="MJXp-Span-3344" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3345" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-3346">0.5</span></span></span><script type="math/tex" id="MathJax-Element-520">|DF|=|EG|<0.5</script>.</p><p>Note that there are some cases where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3347"><span class="MJXp-mi" id="MJXp-Span-3348">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3349">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3350">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3351">x</span><span class="MJXp-mo" id="MJXp-Span-3352" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-3353"><span class="MJXp-mn" id="MJXp-Span-3354" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3355" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-521">\angle CBx>30^\circ</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3356"><span class="MJXp-mi" id="MJXp-Span-3357">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3358">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3359">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3360">B</span><span class="MJXp-mo" id="MJXp-Span-3361" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-3362"><span class="MJXp-mn" id="MJXp-Span-3363" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3364" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-522">\angle CAB<30^\circ</script>, where Case 2 strategy doesn't work. So case 1.2 is required.</p><p><img alt=" " src="/predownloaded/90/b2/90b2870a0ecc7f858552a5f8066e80cf47cc8494.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p><strong>Case 3:</strong> If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3365"><span class="MJXp-mi" id="MJXp-Span-3366">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3367">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3368">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3369">x</span><span class="MJXp-mo" id="MJXp-Span-3370" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi" id="MJXp-Span-3371">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3372">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3373">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3374">B</span><span class="MJXp-mo" id="MJXp-Span-3375" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-3376"><span class="MJXp-mn" id="MJXp-Span-3377" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3378" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-523">\angle CBx>\angle CAB>60^\circ</script>. We first build a point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3380">D</span></span></span><script type="math/tex" id="MathJax-Element-524">D</script> which makes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3382">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3383">D</span><span class="MJXp-mo" id="MJXp-Span-3384" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3385">1</span></span></span><script type="math/tex" id="MathJax-Element-525">AD=1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3386"><span class="MJXp-mi" id="MJXp-Span-3387">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3388">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3389">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3390">B</span><span class="MJXp-mo" id="MJXp-Span-3391" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3392"><span class="MJXp-mn" id="MJXp-Span-3393" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3394" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-526">\angle DAB=60^\circ</script> and construct <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3395"><span class="MJXp-mi" id="MJXp-Span-3396">△</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3397">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3398">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3399">B</span></span></span><script type="math/tex" id="MathJax-Element-527">\triangle DAB</script>. We write <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3400"><span class="MJXp-mrow" id="MJXp-Span-3401"><span class="MJXp-mo" id="MJXp-Span-3402" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3403">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3404">C</span><span class="MJXp-mrow" id="MJXp-Span-3405"><span class="MJXp-mo" id="MJXp-Span-3406" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3407" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3408">a</span><span class="MJXp-mo" id="MJXp-Span-3409" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3410">b</span></span></span><script type="math/tex" id="MathJax-Element-528">|AC|=a+b</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3412">a</span></span></span><script type="math/tex" id="MathJax-Element-529">a</script> is integer, then we analyze two cases about <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3414">b</span></span></span><script type="math/tex" id="MathJax-Element-530">b</script>.</p><p><strong>Case 3.1:</strong> When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3416">b</span><span class="MJXp-mo" id="MJXp-Span-3417" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-3418">0.5</span></span></span><script type="math/tex" id="MathJax-Element-531">b>0.5</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3420">b</span><span class="MJXp-mo" id="MJXp-Span-3421" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3422">0</span></span></span><script type="math/tex" id="MathJax-Element-532">b=0</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3423"><span class="MJXp-mn" id="MJXp-Span-3424">2</span><span class="MJXp-mrow" id="MJXp-Span-3425"><span class="MJXp-mo" id="MJXp-Span-3426" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3427"><span class="MJXp-mo" id="MJXp-Span-3428" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3429">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3430">C</span><span class="MJXp-mrow" id="MJXp-Span-3431"><span class="MJXp-mo" id="MJXp-Span-3432" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3433" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3434" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3435"><span class="MJXp-mo" id="MJXp-Span-3436" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3437">2</span><span class="MJXp-mrow" id="MJXp-Span-3438"><span class="MJXp-mo" id="MJXp-Span-3439" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3440">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3441">C</span><span class="MJXp-mrow" id="MJXp-Span-3442"><span class="MJXp-mo" id="MJXp-Span-3443" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3444" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-533">2\left\lceil |AC|\right\rceil=\left\lceil 2|AC|\right\rceil</script>. We begin a same parallelogram construction as Case 1 where the sides of parallelogram are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3446">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3447">C</span><span class="MJXp-mo" id="MJXp-Span-3448" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3449">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3450">D</span></span></span><script type="math/tex" id="MathJax-Element-534">BC,BD</script>. We can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3451"><span class="MJXp-msubsup" id="MJXp-Span-3452"><span class="MJXp-mn" id="MJXp-Span-3453" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3454" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-3455" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-3456">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3457">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3458">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3459">D</span><span class="MJXp-mo" id="MJXp-Span-3460" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-3461"><span class="MJXp-mn" id="MJXp-Span-3462" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3463" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-535">30^\circ\le\angle CBD\le60^\circ</script>. So it is possible to pile up to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3465">C</span></span></span><script type="math/tex" id="MathJax-Element-536">C</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3467">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3468">D</span></span></span><script type="math/tex" id="MathJax-Element-537">BD</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3469"><span class="MJXp-mn" id="MJXp-Span-3470">2</span><span class="MJXp-mrow" id="MJXp-Span-3471"><span class="MJXp-mo" id="MJXp-Span-3472" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3473"><span class="MJXp-mo" id="MJXp-Span-3474" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3475">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3476">C</span><span class="MJXp-mrow" id="MJXp-Span-3477"><span class="MJXp-mo" id="MJXp-Span-3478" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3479" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3480" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3481">1</span></span></span><script type="math/tex" id="MathJax-Element-538">2\left\lceil |BC|\right\rceil-1</script> moves. And in total we need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3482"><span class="MJXp-mn" id="MJXp-Span-3483">2</span><span class="MJXp-mrow" id="MJXp-Span-3484"><span class="MJXp-mo" id="MJXp-Span-3485" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3486"><span class="MJXp-mo" id="MJXp-Span-3487" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3488">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3489">C</span><span class="MJXp-mrow" id="MJXp-Span-3490"><span class="MJXp-mo" id="MJXp-Span-3491" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3492" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3493" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3494">2</span><span class="MJXp-mrow" id="MJXp-Span-3495"><span class="MJXp-mo" id="MJXp-Span-3496" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3497"><span class="MJXp-mo" id="MJXp-Span-3498" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3499">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3500">C</span><span class="MJXp-mrow" id="MJXp-Span-3501"><span class="MJXp-mo" id="MJXp-Span-3502" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3503" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3504" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3505"><span class="MJXp-mo" id="MJXp-Span-3506" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3507">2</span><span class="MJXp-mrow" id="MJXp-Span-3508"><span class="MJXp-mo" id="MJXp-Span-3509" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3510">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3511">C</span><span class="MJXp-mrow" id="MJXp-Span-3512"><span class="MJXp-mo" id="MJXp-Span-3513" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3514" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-539">2\left\lceil |BC|\right\rceil\le2\left\lceil |AC|\right\rceil=\left\lceil 2|AC|\right\rceil</script> moves.</p><p><img alt=" " src="/predownloaded/8c/dc/8cdc022ad3b685b90fac0681039b0ac07a8e8d76.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p><strong>Case 3.2:</strong> When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3515"><span class="MJXp-mn" id="MJXp-Span-3516">0</span><span class="MJXp-mo" id="MJXp-Span-3517" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3518">b</span><span class="MJXp-mo" id="MJXp-Span-3519" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3520">0.5</span></span></span><script type="math/tex" id="MathJax-Element-540">0<b\le 0.5</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3521"><span class="MJXp-mn" id="MJXp-Span-3522">2</span><span class="MJXp-mrow" id="MJXp-Span-3523"><span class="MJXp-mo" id="MJXp-Span-3524" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3525"><span class="MJXp-mo" id="MJXp-Span-3526" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3527">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3528">C</span><span class="MJXp-mrow" id="MJXp-Span-3529"><span class="MJXp-mo" id="MJXp-Span-3530" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3531" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3532" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3533"><span class="MJXp-mo" id="MJXp-Span-3534" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3535">2</span><span class="MJXp-mrow" id="MJXp-Span-3536"><span class="MJXp-mo" id="MJXp-Span-3537" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3538">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3539">C</span><span class="MJXp-mrow" id="MJXp-Span-3540"><span class="MJXp-mo" id="MJXp-Span-3541" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3542" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3543" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3544">1</span></span></span><script type="math/tex" id="MathJax-Element-541">2\left\lceil |AC|\right\rceil=\left\lceil 2|AC|\right\rceil+1</script>. We instead connect <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3546">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3547">D</span></span></span><script type="math/tex" id="MathJax-Element-542">CD</script> and construct parallelogram with sides <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3549">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3550">C</span><span class="MJXp-mo" id="MJXp-Span-3551" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3552">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3553">B</span></span></span><script type="math/tex" id="MathJax-Element-543">DC,DB</script>. We can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3554"><span class="MJXp-msubsup" id="MJXp-Span-3555"><span class="MJXp-mn" id="MJXp-Span-3556" style="margin-right: 0.05em;">120</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3557" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-3558" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-3559">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3560">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3561">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3562">B</span><span class="MJXp-mo" id="MJXp-Span-3563" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-3564"><span class="MJXp-mn" id="MJXp-Span-3565" style="margin-right: 0.05em;">150</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3566" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-544">120^\circ\le\angle CDB\le150^\circ</script> so we can still do the parallelogram construction. When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3567"><span class="MJXp-mrow" id="MJXp-Span-3568"><span class="MJXp-mo" id="MJXp-Span-3569" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3570">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3571">C</span><span class="MJXp-mrow" id="MJXp-Span-3572"><span class="MJXp-mo" id="MJXp-Span-3573" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3574" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msqrt" id="MJXp-Span-3575"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3576">3</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-545">|AC|\ge \sqrt{3}</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3577"><span class="MJXp-mrow" id="MJXp-Span-3578"><span class="MJXp-mo" id="MJXp-Span-3579" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3580"><span class="MJXp-mo" id="MJXp-Span-3581" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3582">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3583">D</span><span class="MJXp-mrow" id="MJXp-Span-3584"><span class="MJXp-mo" id="MJXp-Span-3585" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3586" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3587" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3588"><span class="MJXp-mo" id="MJXp-Span-3589" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3590"><span class="MJXp-mo" id="MJXp-Span-3591" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3592">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3593">C</span><span class="MJXp-mrow" id="MJXp-Span-3594"><span class="MJXp-mo" id="MJXp-Span-3595" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-3596"><span class="MJXp-mo" id="MJXp-Span-3597" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3598" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3599" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3600">1</span></span></span><script type="math/tex" id="MathJax-Element-546">\left\lceil |CD|\right\rceil=\left\lceil |AC||\right\rceil-1</script>, making the number of moves <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3601"><span class="MJXp-mn" id="MJXp-Span-3602">2</span><span class="MJXp-mrow" id="MJXp-Span-3603"><span class="MJXp-mo" id="MJXp-Span-3604" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3605"><span class="MJXp-mo" id="MJXp-Span-3606" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3607">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3608">D</span><span class="MJXp-mrow" id="MJXp-Span-3609"><span class="MJXp-mo" id="MJXp-Span-3610" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3611" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3612" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3613">1</span><span class="MJXp-mo" id="MJXp-Span-3614" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3615">2</span><span class="MJXp-mrow" id="MJXp-Span-3616"><span class="MJXp-mo" id="MJXp-Span-3617" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3618"><span class="MJXp-mo" id="MJXp-Span-3619" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3620">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3621">C</span><span class="MJXp-mrow" id="MJXp-Span-3622"><span class="MJXp-mo" id="MJXp-Span-3623" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3624" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3625" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3626">1</span><span class="MJXp-mo" id="MJXp-Span-3627" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3628"><span class="MJXp-mo" id="MJXp-Span-3629" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3630">2</span><span class="MJXp-mrow" id="MJXp-Span-3631"><span class="MJXp-mo" id="MJXp-Span-3632" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3633">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3634">C</span><span class="MJXp-mrow" id="MJXp-Span-3635"><span class="MJXp-mo" id="MJXp-Span-3636" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3637" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-547">2\left\lceil |CD|\right\rceil+1=2\left\lceil |AC|\right\rceil-1=\left\lceil 2|AC|\right\rceil</script>. </p><p><img alt=" " src="/predownloaded/18/39/18399c9d645d5245f21b9eb4559d9f6361683585.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>Actually case 1.1 is not required, because it is impossible to construct a testcase where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3638"><span class="MJXp-mi" id="MJXp-Span-3639">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3640">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3641">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3642">B</span><span class="MJXp-mo" id="MJXp-Span-3643" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-3644"><span class="MJXp-mn" id="MJXp-Span-3645" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3646" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-3647" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-3648">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3649">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3650">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3651">x</span><span class="MJXp-mo" id="MJXp-Span-3652" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-3653"><span class="MJXp-mn" id="MJXp-Span-3654" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3655" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-3656" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3657">0</span><span class="MJXp-mo" id="MJXp-Span-3658" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3659">b</span><span class="MJXp-mo" id="MJXp-Span-3660" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3661">0.5</span></span></span><script type="math/tex" id="MathJax-Element-548">\angle CAB<60^\circ, \angle CBx>60^\circ,0<b\le 0.5</script> and Case 3.2 fails.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> db</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> db pi </span><span class="pun">=</span><span class="pln"> acos</span><span class="pun">(-</span><span class="lit">1.0</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1000005</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> sgn</span><span class="pun">(</span><span class="pln">db x</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">1e-13</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> x </span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1e-13</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">struct</span><span class="pln"> point</span><span class="pun">{</span><span class="pln">
    db x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
    point </span><span class="pun">(</span><span class="pln">db _x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.0</span><span class="pun">,</span><span class="pln">db _y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> x</span><span class="pun">(</span><span class="pln">_x</span><span class="pun">),</span><span class="pln"> y</span><span class="pun">(</span><span class="pln">_y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
point </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> point </span><span class="pun">&amp;</span><span class="pln">p1</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> point </span><span class="pun">&amp;</span><span class="pln">p2</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> point</span><span class="pun">(</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">y </span><span class="pun">+</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
point </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> point </span><span class="pun">&amp;</span><span class="pln">p1</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> point </span><span class="pun">&amp;</span><span class="pln">p2</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> point</span><span class="pun">(</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
point </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">db x</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> point </span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> point</span><span class="pun">(</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> 
</span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="pun">(</span><span class="pln">point x</span><span class="pun">,</span><span class="pln">point y</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> sgn</span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> y</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> sgn</span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> y</span><span class="pun">.</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> db dot</span><span class="pun">(</span><span class="pln">point p1</span><span class="pun">,</span><span class="pln">point p2</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> p1</span><span class="pun">.</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> p1</span><span class="pun">.</span><span class="pln">y </span><span class="pun">*</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> db det</span><span class="pun">(</span><span class="pln">point p1</span><span class="pun">,</span><span class="pln">point p2</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> p1</span><span class="pun">.</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p1</span><span class="pun">.</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> db len</span><span class="pun">(</span><span class="pln">point p</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> sqrtl</span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">y </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

point project_point</span><span class="pun">(</span><span class="pln">point x</span><span class="pun">,</span><span class="pln">point ya</span><span class="pun">,</span><span class="pln">point yb</span><span class="pun">){</span><span class="pln">
	point v </span><span class="pun">=</span><span class="pln"> yb </span><span class="pun">-</span><span class="pln"> ya</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> ya </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dot</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> ya</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> dot</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln">v</span><span class="pun">))</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

db distp</span><span class="pun">(</span><span class="pln">point x</span><span class="pun">,</span><span class="pln">point ya</span><span class="pun">,</span><span class="pln">point yb</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> fabs</span><span class="pun">(</span><span class="pln">det</span><span class="pun">(</span><span class="pln">ya </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">,</span><span class="pln">yb </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">))</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">yb </span><span class="pun">-</span><span class="pln"> ya</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

point line_circle_intersec_point</span><span class="pun">(</span><span class="pln">point o</span><span class="pun">,</span><span class="pln">point la</span><span class="pun">,</span><span class="pln">point lb</span><span class="pun">){</span><span class="pln">
	db dis </span><span class="pun">=</span><span class="pln"> distp</span><span class="pun">(</span><span class="pln">o</span><span class="pun">,</span><span class="pln">la</span><span class="pun">,</span><span class="pln">lb</span><span class="pun">),</span><span class="pln">l</span><span class="pun">;</span><span class="pln">
	point pj </span><span class="pun">=</span><span class="pln"> project_point</span><span class="pun">(</span><span class="pln">o</span><span class="pun">,</span><span class="pln">la</span><span class="pun">,</span><span class="pln">lb</span><span class="pun">);</span><span class="pln">
	l </span><span class="pun">=</span><span class="pln"> sqrt</span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> dis </span><span class="pun">*</span><span class="pln"> dis</span><span class="pun">);</span><span class="pln">
	point ret </span><span class="pun">=</span><span class="pln"> pj </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">/</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">lb </span><span class="pun">-</span><span class="pln"> la</span><span class="pun">))</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lb </span><span class="pun">-</span><span class="pln"> la</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

tuple </span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
point p</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">target</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> step</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">bool</span><span class="pln"> check</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">set</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">pair </span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> st</span><span class="pun">;</span><span class="pln">
    st</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">({</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">});</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">n </span><span class="pun">&gt;</span><span class="pln"> step</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    db eps_len </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e-8</span><span class="pun">,</span><span class="pln">eps_dis </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e-4</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> fl </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">,</span><span class="pln">w</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">&gt;</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> swap</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">st</span><span class="pun">.</span><span class="pln">find</span><span class="pun">({</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">})</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> st</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0.5</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> eps_len </span><span class="pun">||</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> eps_len</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0.5</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> eps_len </span><span class="pun">||</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> eps_len</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        st</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">({</span><span class="pln">u</span><span class="pun">,</span><span class="pln">w</span><span class="pun">});</span><span class="pln"> st</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">({</span><span class="pln">v</span><span class="pun">,</span><span class="pln">w</span><span class="pun">});</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> target</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> eps_dis</span><span class="pun">)</span><span class="pln"> fl </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve1a</span><span class="pun">(){</span><span class="pln">
    point dir </span><span class="pun">=</span><span class="pln"> target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> split </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1e-9</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> split</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="com">// construct one parallelogram</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> target</span><span class="pun">;</span><span class="pln">
    ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve1b</span><span class="pun">(){</span><span class="pln">
    point dir </span><span class="pun">=</span><span class="pln"> target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> split </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1e-9</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> split</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve2</span><span class="pun">(){</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="pln">sqrt</span><span class="pun">(</span><span class="lit">3.0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="lit">0.5</span><span class="pun">);</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> line_circle_intersec_point</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">],</span><span class="pln">p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">],</span><span class="pln">target</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        p</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]))</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]);</span><span class="pln">
    ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">};</span><span class="pln">
    ans</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">4</span><span class="pun">};</span><span class="pln">
    point dir </span><span class="pun">=</span><span class="pln"> target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">4</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> split </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1e-9</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> split</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve3a</span><span class="pun">(){</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="lit">0.5</span><span class="pun">,</span><span class="pln">sqrt</span><span class="pun">(</span><span class="lit">3.0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
    ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">};</span><span class="pln">
    point dir </span><span class="pun">=</span><span class="pln"> target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> split </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1e-9</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> split</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> target</span><span class="pun">;</span><span class="pln">
    ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve3b</span><span class="pun">(){</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="lit">0.5</span><span class="pun">,</span><span class="pln">sqrt</span><span class="pun">(</span><span class="lit">3.0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
    ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">};</span><span class="pln">
    point dir </span><span class="pun">=</span><span class="pln"> target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> split </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1e-9</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> split</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> solve1a</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> solve1b</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> solve2</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> solve3a</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> solve3b</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> TC</span><span class="pun">;</span><span class="pln"> scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">TC</span><span class="pun">);</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">TC </span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> tx</span><span class="pun">,</span><span class="pln">ty</span><span class="pun">;</span><span class="pln">
        scanf</span><span class="pun">(</span><span class="str">"%d %d %d"</span><span class="pun">,&amp;</span><span class="pln">tx</span><span class="pun">,&amp;</span><span class="pln">ty</span><span class="pun">,&amp;</span><span class="pln">step</span><span class="pun">);</span><span class="pln">
        step </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="lit">2.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> sqrt</span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> tx </span><span class="pun">*</span><span class="pln"> tx </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> ty </span><span class="pun">*</span><span class="pln"> ty</span><span class="pun">));</span><span class="pln">
        target </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="pln">tx</span><span class="pun">,</span><span class="pln">ty</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n </span><span class="pun">=</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
        </span><span class="kwd">assert</span><span class="pun">(</span><span class="pln">n </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
        printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
            </span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">,</span><span class="pln">w</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
            printf</span><span class="pun">(</span><span class="str">"%d %d %.12lf %.12lf\n"</span><span class="pun">,</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">,</span><span class="pln">p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">].</span><span class="pln">x</span><span class="pun">,</span><span class="pln">p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">].</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: none;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11938">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11939">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11940">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="0">0</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11941">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="/data/like?action=like" data-likeableid="11942">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


</li> </ul></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="/contest/2138" class="notice" style="text-decoration: none;">Codeforces Round 1048 (Div. 1)</a> </span>
        </div>
        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="/contest/2139" class="notice" style="text-decoration: none;">Codeforces Round 1048 (Div. 2)</a> </span>
        </div>
        
            <script type="text/javascript">
    $(document).ready(function () {
        $(".delete-resource-link-123322-146808").click(function() {
            var that = this;
            Codeforces.confirm("Are you sure you want to detach a contest?", function () {
                $.post("/data/blogAndContest", {
                    action: "detachBlogFromContest",
                    blogId: "123322",
                    blogEntryId: "146172",
                    contestId: $(that).attr("data-contestId"),
                    resourceIds: $(that).attr("data-resourceIds")
                }, function(json) {        
                    Codeforces.reloadAndShowMessageOrShowError(json, "Contest detached");
                });
            }, function () {}, "Yes", "No");
        });
    });
</script>
        



    <div class="roundbox meta borderTopRound borderBottomRound" style="">
        <div class="left-meta">
            <ul>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-up-146808"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/voteup-gray.png" alt="Vote: I like it" title="Vote: I like it"></a>


</li>
                    <li style="line-height: 1.6em;">

        
        <span class="topic-rating topic-rating-146808" title="Topic rating" data-topicid="146808" data-rawrating="235" style="font-size:larger;position:relative;bottom:1px;font-weight:bold;color:green">+235</span>
        
</li>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-down-146808"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/votedown-gray.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>


</li>
            </ul>
        </div>


            <span style="position: relative; line-height: 1.65em; top: 0.75rem; left: 0.8em;">
            </span>

        <div class="right-meta">
            <ul>
                    <li>        <a href="/profile/installb"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/user_16x16.png" alt="Author" title="Author"></a>


        <a href="/profile/installb">
        installb
        </a>
</li>
                    <li>        <img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/date_16x16.png" alt="Publication date" title="Publication date">


        
        <span class="format-humantime" title="Sep/08/2025 16:38 UTC">3 months ago</span>
        
</li>
                    <li>        <a href="/blog/entry/146172#comments"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/comments_16x16.png" alt="Comments" title="Comments"></a>


        <a href="/blog/entry/146172#comments">
        64
        </a>
</li>
            </ul>
        </div>

        <br style="clear:both;">
    </div>


<style type="text/css">
    .comments .title {
        float: left;
    }

    .comments .comments-actions-div {
        float: right;
        margin-top: 3rem;
        margin-right: 0.5em;
    }

    .comments .comments-actions-div .separator {
        margin: 0 1rem;
    }

    .comments label.show-archived {
    }

    .comments label.show-archived, .comments label.show-archived * {
        font-size: 1.4rem !important;
        color: black !important;
        /*position: relative !important;*/
        /*bottom: 0.4rem !important;*/
    }

    .comments label.show-archived input {
        height: 1.4rem !important;
        width: 1.4rem !important;
        position: relative;
        top: 0.25rem;
    }

    .new-root-comment {
        font-size: 1.4rem !important;
    }
</style>

    <div class="comments" commentableid="161396">
        <div style="display: flow-root">
            <div class="title">
                <img src="//codeforces.com/codeforces.org/s/52448/images/icons/comments-48x48.png" alt="Comments" title="Comments" style="position:relative;top:0.6em;">
                <a name="comments">Comments (64)</a>

            </div>
            <div class="comments-actions-div">
                <a href="#" class="new-root-comment">Write comment?</a>
            </div>
        </div>

<div class="comment" commentid="1307415">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307415" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/installb" title="Grandmaster installb" class="rated-user user-red">installb</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 20:47 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307415" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/installb" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/595135/avatar/6cbc157af2767133.jpg">        </a>
        <div><a href="/profile/installb" title="Grandmaster installb" class="rated-user user-red">installb</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 20:47 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307415" href="?#comment-1307415" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307415" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="595135" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307415">
                        <div class="moveup">
                        <div class="ttypography"><p><i>Auto comment: topic has been updated by <a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a> (<a href="/topic/146808/en28">previous revision</a>, <a href="/topic/146808/en29">new revision</a>, <a href="/topic/146808/diff/en28/en29">compare</a>).</i></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307415 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307415 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307415">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307428">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307428" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/MOHAMEDYH00" title="Specialist MOHAMEDYH00" class="rated-user user-cyan">MOHAMEDYH00</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:16 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307428" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/MOHAMEDYH00" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4324162/avatar/71be22a9c743583e.jpg">        </a>
        <div><a href="/profile/MOHAMEDYH00" title="Specialist MOHAMEDYH00" class="rated-user user-cyan">MOHAMEDYH00</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:16 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307428" href="?#comment-1307428" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307428" revisioncount="3" revision="3">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">3</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307428" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-25" data-commentuserid="4324162" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-25</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307428">
                        <div class="moveup">
                        <div class="ttypography"><p>.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307428 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307428 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307428">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307431">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307431" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/bronze_coder" title="Grandmaster bronze_coder" class="rated-user user-red">bronze_coder</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:29 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307431" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/bronze_coder" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/bronze_coder" title="Grandmaster bronze_coder" class="rated-user user-red">bronze_coder</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:29 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307431" href="?#comment-1307431" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307431" class="CommentVoteFrame" myvotedirection="0" data-commentrating="18" data-commentuserid="1836481" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+18</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307431">
                        <div class="moveup">
                        <div class="ttypography"><p>The E2 construction seems to be related to last week's Project Euler problem: <a href="https://projecteuler.net/problem=958">Euclid's Labour</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307431 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307431 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307431">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307435">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307435" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/klein199" title="International Master klein199" class="rated-user user-orange">klein199</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:34 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307435" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/klein199" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2790796/avatar/1bc3c853169d5ea3.jpg">        </a>
        <div><a href="/profile/klein199" title="International Master klein199" class="rated-user user-orange">klein199</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:34 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307435" href="?#comment-1307435" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307435" revisioncount="3" revision="3">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">3</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307435" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-20" data-commentuserid="2790796" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-20</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307435">
                        <div class="moveup">
                        <div class="ttypography"><p>An easier way to construct the matrix from the DAG in solution 1 of E1:</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3663">A</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-549-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-549">A</script> be the adjacency matrix, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3664"><span class="MJXp-msubsup" id="MJXp-Span-3665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3666" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3667" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3668">i</span><span class="MJXp-mo" id="MJXp-Span-3669">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3670">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-3671" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3672">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-550-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-550">A_{i,j}=1</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3674">i</span><span class="MJXp-mo" id="MJXp-Span-3675" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3676">j</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-551-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-551">i\rightarrow j</script> exists and 0 otherwise. Then, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3677"><span class="MJXp-mo" id="MJXp-Span-3678" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3679">I</span><span class="MJXp-mo" id="MJXp-Span-3680" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3681">A</span><span class="MJXp-msubsup" id="MJXp-Span-3682"><span class="MJXp-mo" id="MJXp-Span-3683" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3684" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3685">−</span><span class="MJXp-mn" id="MJXp-Span-3686">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3687" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3688">I</span><span class="MJXp-mo" id="MJXp-Span-3689" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3690">A</span><span class="MJXp-mo" id="MJXp-Span-3691" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3693" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3694" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3695" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-3696" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-552-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-552">(I-A)^{-1}=I+A+A^2+\ldots</script>, so <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3697"><span class="MJXp-mo" id="MJXp-Span-3698" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3699">I</span><span class="MJXp-mo" id="MJXp-Span-3700" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3701">A</span><span class="MJXp-msubsup" id="MJXp-Span-3702"><span class="MJXp-mo" id="MJXp-Span-3703" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3704" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3705">−</span><span class="MJXp-mn" id="MJXp-Span-3706">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3707" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-3708">1</span><span class="MJXp-mo" id="MJXp-Span-3709" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3710" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3711">n</span><span class="MJXp-mo" id="MJXp-Span-3712" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-553-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-553">(I-A)^{-1}[1][n]</script> counts the number of directed paths from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3713"><span class="MJXp-mn" id="MJXp-Span-3714">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-554-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-554">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3715"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3716">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-555-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-555">n</script>. By Cramer's rule, since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3718">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3719">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3720">t</span><span class="MJXp-mo" id="MJXp-Span-3721" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3722">I</span><span class="MJXp-mo" id="MJXp-Span-3723" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3724">A</span><span class="MJXp-mo" id="MJXp-Span-3725" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3726" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3727">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-556-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-556">det(I-A)=1</script> (it's triangular), we also have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3728"><span class="MJXp-mo" id="MJXp-Span-3729" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3730">I</span><span class="MJXp-mo" id="MJXp-Span-3731" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3732">A</span><span class="MJXp-msubsup" id="MJXp-Span-3733"><span class="MJXp-mo" id="MJXp-Span-3734" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3735" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3736">−</span><span class="MJXp-mn" id="MJXp-Span-3737">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3738" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-3739">1</span><span class="MJXp-mo" id="MJXp-Span-3740" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3741" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3742">n</span><span class="MJXp-mo" id="MJXp-Span-3743" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3744" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3745">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3746">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3747">j</span><span class="MJXp-mo" id="MJXp-Span-3748" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3749">I</span><span class="MJXp-mo" id="MJXp-Span-3750" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3751">A</span><span class="MJXp-mo" id="MJXp-Span-3752" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3753" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-3754">1</span><span class="MJXp-mo" id="MJXp-Span-3755" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3756" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3757">n</span><span class="MJXp-mo" id="MJXp-Span-3758" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3759" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3760" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-3761" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3762">1</span><span class="MJXp-msubsup" id="MJXp-Span-3763"><span class="MJXp-mo" id="MJXp-Span-3764" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3765" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-3766">1</span><span class="MJXp-mo" id="MJXp-Span-3767">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3768">n</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3769">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3770">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3771">t</span><span class="MJXp-mo" id="MJXp-Span-3772" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3773">B</span><span class="MJXp-mo" id="MJXp-Span-3774" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-557-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-557">(I-A)^{-1}[1][n]=adj(I-A)[1][n]=(-1)^{1+n}det(B)</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3775"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3776">B</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-558-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-558">B</script> is the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3777"><span class="MJXp-mo" id="MJXp-Span-3778" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3779">n</span><span class="MJXp-mo" id="MJXp-Span-3780" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3781">1</span><span class="MJXp-mo" id="MJXp-Span-3782" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-559-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-559">(n,1)</script> minor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3784">I</span><span class="MJXp-mo" id="MJXp-Span-3785" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3786">A</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-560-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-560">I-A</script>, so it suffices to output <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3788">B</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-561-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-561">B</script> and possibly flip a row.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307435 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307435 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307435">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307436">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307436" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Gassa" title="International Master Gassa" class="rated-user user-orange">Gassa</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:35 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307436" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Gassa" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/111/avatar/eee0360a64e01cd1.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="//codeforces.com/codeforces.org/s/52448/images/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="/profile/Gassa" title="International Master Gassa" class="rated-user user-orange">Gassa</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:35 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307436" href="?#comment-1307436" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307436" class="CommentVoteFrame" myvotedirection="0" data-commentrating="14" data-commentuserid="111" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+14</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307436">
                        <div class="moveup">
                        <div class="ttypography"><p>E looks nice!</p><p>Managed to squeeze randomized solutions to E1 (<a href="/contest/2138/submission/337671518" title="Submission 337671518 by Gassa">337671518</a>) and E2 (<a href="/contest/2138/submission/337675705" title="Submission 337675705 by Gassa">337675705</a>), but after the contest (didn't participate).</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307436 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307436 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307436">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307439">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307439" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/invis_me" title="Newbie invis_me" class="rated-user user-gray">invis_me</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:48 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307439" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/invis_me" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/invis_me" title="Newbie invis_me" class="rated-user user-gray">invis_me</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:48 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307439" href="?#comment-1307439" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307439" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307439" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-13" data-commentuserid="5078761" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-13</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307439">
                        <div class="moveup">
                        <div class="ttypography"><p>one "ll"(long long) costed me problem b and c in the contest :) </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307439 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307439 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307439">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307441">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307441" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/FuelTheBurn" title="Candidate Master FuelTheBurn" class="rated-user user-violet">FuelTheBurn</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:50 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307441" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/FuelTheBurn" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2383763/avatar/a9f55f8739bdb755.jpg">        </a>
        <div><a href="/profile/FuelTheBurn" title="Candidate Master FuelTheBurn" class="rated-user user-violet">FuelTheBurn</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:50 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307441" href="?#comment-1307441" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307441" class="CommentVoteFrame" myvotedirection="0" data-commentrating="3" data-commentuserid="2383763" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307441">
                        <div class="moveup">
                        <div class="ttypography"><p>Why was the problem statement changed in Div 2 Problem D, Antiamuny Wants to Learn Swap? Can someone please show me an example where swapping 2 apart more than once is more optimal than only swapping one apart, but swapping 2 apart once is the same number of steps as swapping only one apart.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307441 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307441 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307441">
                <li>
<div class="comment" commentid="1307445">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307445" commentparentid="1307441">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/dynamic_flow" title="Expert dynamic_flow" class="rated-user user-blue">dynamic_flow</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 22:10 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307445" commentparentid="1307441">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/dynamic_flow" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/dynamic_flow" title="Expert dynamic_flow" class="rated-user user-blue">dynamic_flow</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 22:10 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307445" href="?#comment-1307445" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307441" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307445" class="CommentVoteFrame" myvotedirection="0" data-commentrating="20" data-commentuserid="3468542" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+20</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307445">
                        <div class="moveup">
                        <div class="ttypography"><p>Take the case of <code class="tt">3 4 1 2</code>.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307445 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307445 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307445">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307442">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307442" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/zundamon" title="Expert zundamon" class="rated-user user-blue">zundamon</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:52 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307442" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/zundamon" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/5084776/avatar/889472846615c41f.jpg">        </a>
        <div><a href="/profile/zundamon" title="Expert zundamon" class="rated-user user-blue">zundamon</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 21:52 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307442" href="?#comment-1307442" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307442" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="5084776" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307442">
                        <div class="moveup">
                        <div class="ttypography"><p>WTH is this "Monotonic Stack" work O(N) ?!.. With O(1) "extra" space . . . </p> <div class="spoiler"><b class="spoiler-title">left greater (from 2138B)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> mxl</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
        mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mxl</span><span class="pun">[</span><span class="pln">mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307442 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307442 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307442">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307448">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307448" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/invoker._" title="Specialist invoker._" class="rated-user user-cyan">invoker._</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 22:28 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307448" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/invoker._" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1445428/avatar/9457f0b0bdf4f52f.jpg">        </a>
        <div><a href="/profile/invoker._" title="Specialist invoker._" class="rated-user user-cyan">invoker._</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 22:28 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307448" href="?#comment-1307448" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307448" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307448" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="1445428" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307448">
                        <div class="moveup">
                        <div class="ttypography"><p>For problem C1: I was on track, but I do not understand this jump.</p><p>Now the problem can be considered as a knapsack problem, where you have d items with weight c1, …, cd. We need to find out whether you can take several numbers from c that have sum equal to k. This can be solved in O(n^2).</p><p>I was thinking along the lines of having 2 currencies (k, n-k). Finding the maximum number of items I can buy either using currency 0 or currency 1.</p><p>Item costs would be c1, …, cd</p><p>Meaning: assigning all 1 or 0 to that current level of the tree → this will increase subsequence by 1.</p><p>I think this should be a well-known problem (since the editorial skipped this transition). It would be really helpful if someone provides more context or an article link.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307448 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307448 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307448">
                <li>
<div class="comment" commentid="1307547">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307547" commentparentid="1307448">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/4991.aditya" title="Pupil 4991.aditya" class="rated-user user-green">4991.aditya</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:00 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307547" commentparentid="1307448">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/4991.aditya" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/4991.aditya" title="Pupil 4991.aditya" class="rated-user user-green">4991.aditya</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:00 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307547" href="?#comment-1307547" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307448" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307547" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2987009" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307547">
                        <div class="moveup">
                        <div class="ttypography"><p>Yep that was exactly how i was thinking.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307547 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307547 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307547">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307456">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307456" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/MarcosK" title="Master MarcosK" class="rated-user user-orange">MarcosK</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 23:08 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">4</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307456" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/MarcosK" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/501788/avatar/7fbcabce2cb8d719.jpg">        </a>
        <div><a href="/profile/MarcosK" title="Master MarcosK" class="rated-user user-orange">MarcosK</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 23:08 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307456" href="?#comment-1307456" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307456" class="CommentVoteFrame" myvotedirection="0" data-commentrating="41" data-commentuserid="501788" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+41</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307456">
                        <div class="moveup">
                        <div class="ttypography"><p>Div1 C1/C2 can be solved in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3789"><span class="MJXp-mrow" id="MJXp-Span-3790"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3791">O</span></span><span class="MJXp-mo" id="MJXp-Span-3792" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3793">n</span><span class="MJXp-mo" id="MJXp-Span-3794" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mi" id="MJXp-Span-3795">log</span><span class="MJXp-mo" id="MJXp-Span-3796" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3797" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3798">n</span><span class="MJXp-mo" id="MJXp-Span-3799" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3800" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-562-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-562">\mathcal{O}(n*\log (n))</script> by using formal power series of log function to compute the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3802">n</span><span class="MJXp-mo" id="MJXp-Span-3803" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3804">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-563-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-563">n+1</script> terms of:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3805"><span class="MJXp-mtable" id="MJXp-Span-3806"><span><span class="MJXp-mtr" id="MJXp-Span-3807" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3808" style="text-align: right;"><span class="MJXp-munderover" id="MJXp-Span-3809"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3815" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3816">n</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-3810" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3811" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3812">w</span><span class="MJXp-mo" id="MJXp-Span-3813">=</span><span class="MJXp-mn" id="MJXp-Span-3814">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3817" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3819" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3820" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-3821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3822" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3823" style="vertical-align: -0.4em;">w</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3824" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3825">1</span><span class="MJXp-mo" id="MJXp-Span-3826" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-564-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-564">\begin{align*}  \prod_{w=1}^{n} (x^{c_w} + 1) \end{align*}</script></p><p>Of course we need to do this under a NTT friendly modulo. Yes, I know this solution is “hackable” by choosing the input carefully so that the resulting numbers are divisible by the modulo, but I’m usually not interested in this (if we want, we could choose between multiple modulos randomly, use a few modulos, etc.).</p><p>Link to my submission: <a href="https://codeforces.com/contest/2138/submission/337680547">337680547</a> (my implementation of exp/log generating functions is not the best and it has high constant).</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307456 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307456 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307456">
                <li>
<div class="comment" commentid="1307508">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307508" commentparentid="1307456">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/B_3" title="Expert B_3" class="rated-user user-blue">B_3</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 04:59 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307508" commentparentid="1307456">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/B_3" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/B_3" title="Expert B_3" class="rated-user user-blue">B_3</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 04:59 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307508" href="?#comment-1307508" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307456" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307508" revisioncount="3" revision="3">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">3</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307508" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2669463" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307508">
                        <div class="moveup">
                        <div class="ttypography"><p>Actually, you don’t need the modulo, you can just reset every coefficient greater than 1 to 1, since you only care whether they can be formed or not :)</p><p>submission: <a href="/contest/2138/submission/337681349" title="Submission 337681349 by B_3">337681349</a></p><p>line 91</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307508 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307508 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307508">
                <li>
<div class="comment" commentid="1307540">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307540" commentparentid="1307508">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/MarcosK" title="Master MarcosK" class="rated-user user-orange">MarcosK</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 07:07 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307540" commentparentid="1307508">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/MarcosK" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/501788/avatar/7fbcabce2cb8d719.jpg">        </a>
        <div><a href="/profile/MarcosK" title="Master MarcosK" class="rated-user user-orange">MarcosK</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 07:07 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307540" href="?#comment-1307540" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307508" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307540" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="501788" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307540">
                        <div class="moveup">
                        <div class="ttypography"><p>Your solution is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3827"><span class="MJXp-mrow" id="MJXp-Span-3828"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3829">O</span></span><span class="MJXp-mo" id="MJXp-Span-3830" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3831">n</span><span class="MJXp-mo" id="MJXp-Span-3832" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-msubsup" id="MJXp-Span-3833"><span class="MJXp-mi" id="MJXp-Span-3834" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3835" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3836" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3837" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3838">n</span><span class="MJXp-mo" id="MJXp-Span-3839" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3840" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-565-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-565">\mathcal{O}(n*\log^2(n))</script>. I’m not using divide and conquer, I use generating functions (that way, I remove one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3841"><span class="MJXp-mi" id="MJXp-Span-3842">log</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-566-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-566">\log</script>).</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307540 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307540 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307540">
                <li>
<div class="comment" commentid="1307542">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307542" commentparentid="1307540">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/B_3" title="Expert B_3" class="rated-user user-blue">B_3</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 07:16 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307542" commentparentid="1307540">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/B_3" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/B_3" title="Expert B_3" class="rated-user user-blue">B_3</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 07:16 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307542" href="?#comment-1307542" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307540" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307542" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2669463" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307542">
                        <div class="moveup">
                        <div class="ttypography"><p>Wow, that's new to me </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307542 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307542 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307542">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1307561">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307561" commentparentid="1307456">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/peltorator" title="International Grandmaster peltorator" class="rated-user user-red">peltorator</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:45 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307561" commentparentid="1307456">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/peltorator" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/392368/avatar/d739fef45f3a6bf1.jpg">        </a>
        <div><a href="/profile/peltorator" title="International Grandmaster peltorator" class="rated-user user-red">peltorator</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:45 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307561" href="?#comment-1307561" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307456" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307561" class="CommentVoteFrame" myvotedirection="0" data-commentrating="8" data-commentuserid="392368" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307561">
                        <div class="moveup">
                        <div class="ttypography"><p>i think this is exactly what you're talking about <a href="https://arxiv.org/pdf/1807.11597">https://arxiv.org/pdf/1807.11597</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307561 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307561 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307561">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307458">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307458" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SarthakCP21" title="Specialist SarthakCP21" class="rated-user user-cyan">SarthakCP21</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 23:35 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307458" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SarthakCP21" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/SarthakCP21" title="Specialist SarthakCP21" class="rated-user user-cyan">SarthakCP21</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/08/2025 23:35 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307458" href="?#comment-1307458" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307458" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-8" data-commentuserid="3197828" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307458">
                        <div class="moveup">
                        <div class="ttypography"><p>Div2 E2/Div1 C2 can be solved by binary search on answer also. For any height, I am checking by greedily assigning zeros or ones from bottom to top.</p><p><a href="https://codeforces.com/contest/2139/submission/337622955">https://codeforces.com/contest/2139/submission/337622955</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307458 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307458 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307458">
                <li>
<div class="comment" commentid="1307475">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307475" commentparentid="1307458">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/lethan3" title="Grandmaster lethan3" class="rated-user user-red">lethan3</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 02:11 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307475" commentparentid="1307458">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/lethan3" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1714539/avatar/af41dd1ab09d12e3.jpg">        </a>
        <div><a href="/profile/lethan3" title="Grandmaster lethan3" class="rated-user user-red">lethan3</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 02:11 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307475" href="?#comment-1307475" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307458" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307475" class="CommentVoteFrame" myvotedirection="0" data-commentrating="15" data-commentuserid="1714539" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+15</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307475">
                        <div class="moveup">
                        <div class="ttypography"><p>Looks like it was hacked, in general doing something like this probably should contradict the NP-completeness of knapsack.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307475 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307475 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307475">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307465">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307465" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/hwpvector" title="Candidate Master hwpvector" class="rated-user user-violet">hwpvector</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 00:39 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">3</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307465" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/hwpvector" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2916655/avatar/7efc1387ad1245c3.jpg">        </a>
        <div><a href="/profile/hwpvector" title="Candidate Master hwpvector" class="rated-user user-violet">hwpvector</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 00:39 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307465" href="?#comment-1307465" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307465" class="CommentVoteFrame" myvotedirection="0" data-commentrating="45" data-commentuserid="2916655" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+45</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307465">
                        <div class="moveup">
                        <div class="ttypography"><p>In Div.1 C2 / Div.2 E2, I don't think <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3843"><span class="MJXp-msubsup" id="MJXp-Span-3844"><span class="MJXp-mo" id="MJXp-Span-3845" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3850"><span class="MJXp-msqrt" id="MJXp-Span-3851"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3852">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-3846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3847">i</span><span class="MJXp-mo" id="MJXp-Span-3848">=</span><span class="MJXp-mn" id="MJXp-Span-3849">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-3853">log</span><span class="MJXp-mo" id="MJXp-Span-3854" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3856" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3857" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3858" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3859">O</span><span class="MJXp-mo" id="MJXp-Span-3860" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msqrt" id="MJXp-Span-3861"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3862">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3863" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-567-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-567">\sum_{i=1}^{\sqrt{n}} \log c_i = O(\sqrt{n})</script> is trivial. Here is a proof.</p><p>Under <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3864"><span class="MJXp-msubsup" id="MJXp-Span-3865"><span class="MJXp-mo" id="MJXp-Span-3866" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3871"><span class="MJXp-msqrt" id="MJXp-Span-3872"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3873">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-3867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3868">i</span><span class="MJXp-mo" id="MJXp-Span-3869">=</span><span class="MJXp-mn" id="MJXp-Span-3870">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3874">i</span><span class="MJXp-mo" id="MJXp-Span-3875" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3877" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3878" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3879" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3880">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-568-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-568">\sum_{i=1}^{\sqrt{n}} i\cdot c_i = n</script>, maximaze <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3881"><span class="MJXp-msubsup" id="MJXp-Span-3882"><span class="MJXp-mo" id="MJXp-Span-3883" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3888"><span class="MJXp-msqrt" id="MJXp-Span-3889"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3890">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-3884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3885">i</span><span class="MJXp-mo" id="MJXp-Span-3886">=</span><span class="MJXp-mn" id="MJXp-Span-3887">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-3891">log</span><span class="MJXp-mo" id="MJXp-Span-3892" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3894" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3895" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3896" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3897" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3898">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3899">ln</span><span class="MJXp-mo" id="MJXp-Span-3900"></span><span class="MJXp-mrow" id="MJXp-Span-3901"><span class="MJXp-mn" id="MJXp-Span-3902">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3903" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3904"><span class="MJXp-mo" id="MJXp-Span-3905" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3910"><span class="MJXp-msqrt" id="MJXp-Span-3911"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3912">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-3906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3907">i</span><span class="MJXp-mo" id="MJXp-Span-3908">=</span><span class="MJXp-mn" id="MJXp-Span-3909">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-3913">ln</span><span class="MJXp-mo" id="MJXp-Span-3914" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3915"><span class="MJXp-msubsup" id="MJXp-Span-3916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3917" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3918" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-3919" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-569-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-569">\sum_{i=1}^{\sqrt{n}} \log c_i = \frac{1}{\ln{2}} (\sum_{i=1}^{\sqrt{n}} \ln{c_i})</script>. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3920"><span class="MJXp-msubsup" id="MJXp-Span-3921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3922" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3923" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3924" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-3925"><span class="MJXp-mi undefined" id="MJXp-Span-3926">R</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-570-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-570">c_i \in \mathbb{R}</script>.</p><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3928">f</span><span class="MJXp-mo" id="MJXp-Span-3929" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3931" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3932" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3933" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3934" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3935"><span class="MJXp-mo" id="MJXp-Span-3936" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3941"><span class="MJXp-msqrt" id="MJXp-Span-3942"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3943">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-3937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3938">i</span><span class="MJXp-mo" id="MJXp-Span-3939">=</span><span class="MJXp-mn" id="MJXp-Span-3940">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-3944">ln</span><span class="MJXp-mo" id="MJXp-Span-3945" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3946"><span class="MJXp-msubsup" id="MJXp-Span-3947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3948" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3949" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-3950" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3951">λ</span><span class="MJXp-mo" id="MJXp-Span-3952" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3953"><span class="MJXp-mo" id="MJXp-Span-3954" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3959"><span class="MJXp-msqrt" id="MJXp-Span-3960"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3961">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-3955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3956">i</span><span class="MJXp-mo" id="MJXp-Span-3957">=</span><span class="MJXp-mn" id="MJXp-Span-3958">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3962">i</span><span class="MJXp-mo" id="MJXp-Span-3963" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3965" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3966" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3967" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-571-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-571">f(c_i)=\sum_{i=1}^{\sqrt{n}} \ln{c_i} - \lambda (\sum_{i=1}^{\sqrt{n}} i\cdot c_i)</script> and then when maximazing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3968"><span class="MJXp-msubsup" id="MJXp-Span-3969"><span class="MJXp-mo" id="MJXp-Span-3970" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3975"><span class="MJXp-msqrt" id="MJXp-Span-3976"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3977">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-3971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3972">i</span><span class="MJXp-mo" id="MJXp-Span-3973">=</span><span class="MJXp-mn" id="MJXp-Span-3974">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-3978">log</span><span class="MJXp-mo" id="MJXp-Span-3979" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3981" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3982" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-572-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-572">\sum_{i=1}^{\sqrt{n}} \log c_i</script>, it should have: </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3983"><span class="MJXp-mfrac" id="MJXp-Span-3984" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3985">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3986">f</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3987">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3989" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3990" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3991" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3992" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3993">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3995" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3996" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3997" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3998">λ</span><span class="MJXp-mo" id="MJXp-Span-3999" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4000">i</span><span class="MJXp-mo" id="MJXp-Span-4001" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4002">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-573-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-573">\frac{\partial f}{\partial c_i} = \frac{1}{c_i} - \lambda \cdot i = 0</script></center><p>So, </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4003"><span class="MJXp-msubsup" id="MJXp-Span-4004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4005" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4006" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4007" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4008">i</span><span class="MJXp-mo" id="MJXp-Span-4009" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-4010" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4011">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4012">λ</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-574-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-574">c_i \cdot i = \frac{1}{\lambda}</script></center><p>So $c_i \cdot i$ is a constant.</p><p>Under <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4013"><span class="MJXp-msubsup" id="MJXp-Span-4014"><span class="MJXp-mo" id="MJXp-Span-4015" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4020"><span class="MJXp-msqrt" id="MJXp-Span-4021"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4022">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-4016"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4017">i</span><span class="MJXp-mo" id="MJXp-Span-4018">=</span><span class="MJXp-mn" id="MJXp-Span-4019">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4023">i</span><span class="MJXp-mo" id="MJXp-Span-4024" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-4025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4026" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4027" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4028" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4029">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-575-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-575">\sum_{i=1}^{\sqrt{n}} i \cdot c_i = n</script>, so <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4031">i</span><span class="MJXp-mo" id="MJXp-Span-4032" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-4033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4034" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4035" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4036" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-4037"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4038">n</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-576-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-576">i\cdot c_i = \sqrt{n}</script>, so <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4039"><span class="MJXp-msubsup" id="MJXp-Span-4040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4041" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4042" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4043" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-4044" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-4045"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4046">n</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4047">i</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-577-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-577">c_i = \frac{\sqrt{n}}{i}</script>.</p><p>So <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4048"><span class="MJXp-msubsup" id="MJXp-Span-4049"><span class="MJXp-mo" id="MJXp-Span-4050" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4051" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4053" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4054" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4055" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4056"><span class="MJXp-mo" id="MJXp-Span-4057" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4062"><span class="MJXp-msqrt" id="MJXp-Span-4063"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4064">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-4058"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4059">i</span><span class="MJXp-mo" id="MJXp-Span-4060">=</span><span class="MJXp-mn" id="MJXp-Span-4061">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4065">ln</span><span class="MJXp-mo" id="MJXp-Span-4066" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-4067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4068" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4069" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4070" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4071" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4072"><span class="MJXp-mo" id="MJXp-Span-4073" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4078"><span class="MJXp-msqrt" id="MJXp-Span-4079"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4080">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-4074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4075">i</span><span class="MJXp-mo" id="MJXp-Span-4076">=</span><span class="MJXp-mn" id="MJXp-Span-4077">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4081">ln</span><span class="MJXp-mo" id="MJXp-Span-4082" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-4083"><span class="MJXp-mfrac" id="MJXp-Span-4084" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-4085"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4086">n</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4087">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4088" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4089"><span class="MJXp-mo" id="MJXp-Span-4090" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4095"><span class="MJXp-msqrt" id="MJXp-Span-4096"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4097">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-4091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4092">i</span><span class="MJXp-mo" id="MJXp-Span-4093">=</span><span class="MJXp-mn" id="MJXp-Span-4094">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4098">ln</span><span class="MJXp-mo" id="MJXp-Span-4099" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-4100"><span class="MJXp-msqrt" id="MJXp-Span-4101"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4102">n</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4103" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi" id="MJXp-Span-4104">ln</span><span class="MJXp-mo" id="MJXp-Span-4105" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-4106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4107">i</span></span><span class="MJXp-mo" id="MJXp-Span-4108" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-msqrt" id="MJXp-Span-4109"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4110">n</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4111">ln</span><span class="MJXp-mo" id="MJXp-Span-4112" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-4113"><span class="MJXp-msqrt" id="MJXp-Span-4114"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4115">n</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4116" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-4117"><span class="MJXp-mo" id="MJXp-Span-4118" style="margin-left: 0em; margin-right: 0.05em;">∫</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4121"><span class="MJXp-msqrt" id="MJXp-Span-4122"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4123">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-4119"><span class="MJXp-mn" id="MJXp-Span-4120">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4124">ln</span><span class="MJXp-mo" id="MJXp-Span-4125" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-4126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4127">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4128">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4129">i</span><span class="MJXp-mo" id="MJXp-Span-4130" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4131">O</span><span class="MJXp-mo" id="MJXp-Span-4132" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msqrt" id="MJXp-Span-4133"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4134">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4135" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-578-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-578">\max_{c_i} (\sum_{i=1}^{\sqrt{n}} \ln c_i) = \sum_{i=1}^{\sqrt{n}} \ln{\frac{\sqrt{n}}{i}} = \sum_{i=1}^{\sqrt{n}} \ln{\sqrt{n}} - \ln{i} \sim \sqrt{n} \ln{\sqrt{n}} - \int_{1}^{\sqrt{n}} \ln{i} di = O(\sqrt{n})</script></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307465 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307465 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307465">
                <li>
<div class="comment" commentid="1307590">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307590" commentparentid="1307465">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Xellos" title="Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 10:49 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307590" commentparentid="1307465">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Xellos" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/69675/avatar/8526bcfc8e687b43.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="//codeforces.com/codeforces.org/s/52448/images/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="/profile/Xellos" title="Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 10:49 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307590" href="?#comment-1307590" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307465" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307590" class="CommentVoteFrame" myvotedirection="0" data-commentrating="6" data-commentuserid="69675" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307590">
                        <div class="moveup">
                        <div class="ttypography"><p>Note that your final tilde doesn't work on asymptotic <strong>differences</strong> and any arithmetic that uses them: if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4137">f</span><span class="MJXp-mo" id="MJXp-Span-4138" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4139">n</span><span class="MJXp-mo" id="MJXp-Span-4140" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4141" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4142">a</span><span class="MJXp-mo" id="MJXp-Span-4143" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4144">n</span><span class="MJXp-mo" id="MJXp-Span-4145" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-579-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-579">f(n) \sim a(n)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4147">g</span><span class="MJXp-mo" id="MJXp-Span-4148" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4149">n</span><span class="MJXp-mo" id="MJXp-Span-4150" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4151" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4152">a</span><span class="MJXp-mo" id="MJXp-Span-4153" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4154">n</span><span class="MJXp-mo" id="MJXp-Span-4155" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-580-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-580">g(n) \sim a(n)</script>, it doesn't mean <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4157">f</span><span class="MJXp-mo" id="MJXp-Span-4158" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4159">n</span><span class="MJXp-mo" id="MJXp-Span-4160" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4161" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4162">g</span><span class="MJXp-mo" id="MJXp-Span-4163" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4164">n</span><span class="MJXp-mo" id="MJXp-Span-4165" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4166" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4167">a</span><span class="MJXp-mo" id="MJXp-Span-4168" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4169">n</span><span class="MJXp-mo" id="MJXp-Span-4170" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-581-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-581">f(n) - g(n) \sim a(n)</script>. Instead, Stirling's approximation says <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4171"><span class="MJXp-msubsup" id="MJXp-Span-4172"><span class="MJXp-mo" id="MJXp-Span-4173" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4178">k</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4175">i</span><span class="MJXp-mo" id="MJXp-Span-4176">=</span><span class="MJXp-mn" id="MJXp-Span-4177">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4179">log</span><span class="MJXp-mo" id="MJXp-Span-4180" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4181">i</span><span class="MJXp-mo" id="MJXp-Span-4182" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-4183">log</span><span class="MJXp-mo" id="MJXp-Span-4184" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4185">k</span><span class="MJXp-mo" id="MJXp-Span-4186" style="margin-left: 0.111em; margin-right: 0em;">!</span><span class="MJXp-mo" id="MJXp-Span-4187" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4188">k</span><span class="MJXp-mi" id="MJXp-Span-4189">log</span><span class="MJXp-mo" id="MJXp-Span-4190" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4191">k</span><span class="MJXp-mo" id="MJXp-Span-4192" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4193">k</span><span class="MJXp-mi" id="MJXp-Span-4194">log</span><span class="MJXp-mo" id="MJXp-Span-4195" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4196">e</span><span class="MJXp-mo" id="MJXp-Span-4197" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4198">O</span><span class="MJXp-mo" id="MJXp-Span-4199" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4200">log</span><span class="MJXp-mo" id="MJXp-Span-4201" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4202">k</span><span class="MJXp-mo" id="MJXp-Span-4203" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-582-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-582">\sum_{i=1}^k \log i = \log k! = k \log k - k \log e + O(\log k)</script>, so <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4204"><span class="MJXp-msubsup" id="MJXp-Span-4205"><span class="MJXp-mo" id="MJXp-Span-4206" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4211"><span class="MJXp-msqrt" id="MJXp-Span-4212"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4213">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-4207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4208">i</span><span class="MJXp-mo" id="MJXp-Span-4209">=</span><span class="MJXp-mn" id="MJXp-Span-4210">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4214">log</span><span class="MJXp-mo" id="MJXp-Span-4215" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-4216" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-4217"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4218">n</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4219">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4220" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-4221"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4222">n</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4223">log</span><span class="MJXp-mo" id="MJXp-Span-4224" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4225">e</span><span class="MJXp-mo" id="MJXp-Span-4226" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4227">O</span><span class="MJXp-mo" id="MJXp-Span-4228" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4229">log</span><span class="MJXp-mo" id="MJXp-Span-4230" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4231">n</span><span class="MJXp-mo" id="MJXp-Span-4232" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-583-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-583">\sum_{i=1}^{\sqrt n} \log \frac{\sqrt{n}}{i} = \sqrt{n} \log e + O(\log n)</script>.</p><p>It only works out in this case because the next terms of the sum and integral are large enough and therefore similar enough. Consider the claim <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4233"><span class="MJXp-mfrac" id="MJXp-Span-4234" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4236" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4237" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4238">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4239" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-4240"><span class="MJXp-mo" id="MJXp-Span-4241" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4246">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4243">i</span><span class="MJXp-mo" id="MJXp-Span-4244">=</span><span class="MJXp-mn" id="MJXp-Span-4245">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4247">i</span><span class="MJXp-mo" id="MJXp-Span-4248" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mfrac" id="MJXp-Span-4249" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4251" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4252" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4253">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4254" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-4255"><span class="MJXp-mo" id="MJXp-Span-4256" style="margin-left: 0em; margin-right: 0.05em;">∫</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4261">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4258">i</span><span class="MJXp-mo" id="MJXp-Span-4259">=</span><span class="MJXp-mn" id="MJXp-Span-4260">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4262">i</span><span class="MJXp-mo" id="MJXp-Span-4263" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-4264"><span class="MJXp-mi" id="MJXp-Span-4265">d</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4266">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-584-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-584">\frac{n^2}{2} - \sum_{i=1}^n i \sim \frac{n^2}{2} - \int_{i=1}^n i \cdot \mathrm{d} i</script>: it'd simplify to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4267"><span class="MJXp-mo" id="MJXp-Span-4268" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-4269" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4270">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4271">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4272" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mfrac" id="MJXp-Span-4273" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4274">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4275">2</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-585-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-585">-\frac{n}{2} \sim \frac{1}{2}</script>, which is false.</p><p>Formal math is full of traps.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307590 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307590 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307590">
                <li>
<div class="comment" commentid="1307598">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307598" commentparentid="1307590">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/hwpvector" title="Candidate Master hwpvector" class="rated-user user-violet">hwpvector</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 11:09 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307598" commentparentid="1307590">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/hwpvector" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2916655/avatar/7efc1387ad1245c3.jpg">        </a>
        <div><a href="/profile/hwpvector" title="Candidate Master hwpvector" class="rated-user user-violet">hwpvector</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 11:09 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307598" href="?#comment-1307598" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307590" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307598" class="CommentVoteFrame" myvotedirection="0" data-commentrating="1" data-commentuserid="2916655" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307598">
                        <div class="moveup">
                        <div class="ttypography"><p>Thank you for pointing out the mistake.</p><p>Maybe this approach is also correct now?:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4276"><span class="MJXp-msubsup" id="MJXp-Span-4277"><span class="MJXp-mo" id="MJXp-Span-4278" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4283"><span class="MJXp-msqrt" id="MJXp-Span-4284"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4285">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-4279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4280">i</span><span class="MJXp-mo" id="MJXp-Span-4281">=</span><span class="MJXp-mn" id="MJXp-Span-4282">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4286" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4287">ln</span><span class="MJXp-mo" id="MJXp-Span-4288" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msqrt" id="MJXp-Span-4289"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4290">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4291" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi" id="MJXp-Span-4292">ln</span><span class="MJXp-mo" id="MJXp-Span-4293" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4294">i</span><span class="MJXp-mo" id="MJXp-Span-4295" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4296" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-4297">ln</span><span class="MJXp-mo" id="MJXp-Span-4298" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msqrt" id="MJXp-Span-4299"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4300">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4301" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-4302"><span class="MJXp-mo" id="MJXp-Span-4303" style="margin-left: 0em; margin-right: 0.05em;">∫</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4306"><span class="MJXp-msqrt" id="MJXp-Span-4307"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4308">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-4304"><span class="MJXp-mn" id="MJXp-Span-4305">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4309" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4310">ln</span><span class="MJXp-mo" id="MJXp-Span-4311" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msqrt" id="MJXp-Span-4312"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4313">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4314" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi" id="MJXp-Span-4315">ln</span><span class="MJXp-mo" id="MJXp-Span-4316" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4317">i</span><span class="MJXp-mo" id="MJXp-Span-4318" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4319">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4320">i</span><span class="MJXp-mo" id="MJXp-Span-4321" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-4322"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4323">n</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4324">ln</span><span class="MJXp-mo" id="MJXp-Span-4325" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msqrt" id="MJXp-Span-4326"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4327">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4328" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-4329"><span class="MJXp-mo" id="MJXp-Span-4330" style="margin-left: 0em; margin-right: 0.05em;">∫</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4333"><span class="MJXp-msqrt" id="MJXp-Span-4334"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4335">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-4331"><span class="MJXp-mn" id="MJXp-Span-4332">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4336">ln</span><span class="MJXp-mo" id="MJXp-Span-4337" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4338">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4339">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4340">i</span><span class="MJXp-mo" id="MJXp-Span-4341" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4342">O</span><span class="MJXp-mo" id="MJXp-Span-4343" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msqrt" id="MJXp-Span-4344"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4345">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4346" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-586-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-586">\sum_{i=1}^{\sqrt{n}} (\ln\sqrt{n} - \ln i) \le \ln \sqrt{n} + \int_{1}^{\sqrt{n}} (\ln\sqrt{n} - \ln i) di = \sqrt{n} \ln \sqrt{n} - \int_{1}^{\sqrt{n}} \ln i di= O(\sqrt{n})</script></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307598 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307598 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307598">
                <li>
<div class="comment" commentid="1307662">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307662" commentparentid="1307598">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Xellos" title="Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 14:42 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307662" commentparentid="1307598">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Xellos" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/69675/avatar/8526bcfc8e687b43.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="//codeforces.com/codeforces.org/s/52448/images/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="/profile/Xellos" title="Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 14:42 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307662" href="?#comment-1307662" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307598" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307662" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="69675" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307662">
                        <div class="moveup">
                        <div class="ttypography"><p>Well, the first equality isn't correct or incorrect, it's just unproved. What are your elementary steps?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307662 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307662 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307662">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307467">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307467" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/saras23" title="Pupil saras23" class="rated-user user-green">saras23</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 01:00 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307467" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/saras23" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3886902/avatar/c4c3a269b37cedf1.jpg">        </a>
        <div><a href="/profile/saras23" title="Pupil saras23" class="rated-user user-green">saras23</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 01:00 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307467" href="?#comment-1307467" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307467" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3886902" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307467">
                        <div class="moveup">
                        <div class="ttypography"><p>forward solution for div2C which i (elegantly) thought of last minute: after any operation Chocola's x becomes either x / 2 or x / 2 + 2^k, because Vanilla will always have 2^(k + 1) — x, so go over x bits (LSB to MSB) and its first 1 is already the 2^k at the beginning, and every operation we divide x by 2, if x's current bit is 1 we add 2^k and at the end just get rid of extra zeros at right</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307467 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307467 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307467">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307473">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307473" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/strapple" title="Legendary Grandmaster strapple" class="rated-user user-legendary"><span class="legendary-user-first-letter">s</span>trapple</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 02:02 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307473" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/strapple" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1569515/avatar/40caebea5869f243.jpg">        </a>
        <div><a href="/profile/strapple" title="Legendary Grandmaster strapple" class="rated-user user-legendary"><span class="legendary-user-first-letter">s</span>trapple</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 02:02 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307473" href="?#comment-1307473" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307473" revisioncount="3" revision="3">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">3</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307473" class="CommentVoteFrame" myvotedirection="0" data-commentrating="4" data-commentuserid="1569515" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+4</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307473">
                        <div class="moveup">
                        <div class="ttypography"><p>In problem E2, I have a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4347"><span class="MJXp-msubsup" id="MJXp-Span-4348"><span class="MJXp-mi" id="MJXp-Span-4349" style="margin-right: 0.05em;">log</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4350" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4351">1.378</span></span></span><span class="MJXp-mo" id="MJXp-Span-4352" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4353">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-587-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-587">\log_{1.378}n</script> solution if four non-zero numbers in a column is allowed.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307473 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307473 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307473">
                <li>
<div class="comment" commentid="1307479">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307479" commentparentid="1307473">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/strapple" title="Legendary Grandmaster strapple" class="rated-user user-legendary"><span class="legendary-user-first-letter">s</span>trapple</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 02:56 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307479" commentparentid="1307473">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/strapple" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1569515/avatar/40caebea5869f243.jpg">        </a>
        <div><a href="/profile/strapple" title="Legendary Grandmaster strapple" class="rated-user user-legendary"><span class="legendary-user-first-letter">s</span>trapple</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 02:56 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307479" href="?#comment-1307479" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307473" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307479" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307479" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="1569515" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307479">
                        <div class="moveup">
                        <div class="ttypography"><p>Additionally a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4354"><span class="MJXp-msubsup" id="MJXp-Span-4355"><span class="MJXp-mi" id="MJXp-Span-4356" style="margin-right: 0.05em;">log</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4357" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4358">1.319</span></span></span><span class="MJXp-mo" id="MJXp-Span-4359" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4360">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-588-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-588">\log_{1.319}n</script> valid solution:(</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307479 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307479 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307479">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307476">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307476" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/wjy666" title="Candidate Master wjy666" class="rated-user user-violet">wjy666</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 02:13 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307476" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/wjy666" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/590101/avatar/380f5e4a17b5a061.jpg">        </a>
        <div><a href="/profile/wjy666" title="Candidate Master wjy666" class="rated-user user-violet">wjy666</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 02:13 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307476" href="?#comment-1307476" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307476" class="CommentVoteFrame" myvotedirection="0" data-commentrating="100" data-commentuserid="590101" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+100</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307476">
                        <div class="moveup">
                        <div class="ttypography"><p>Though having a terrible contest, I still hope you can enjoy these problems. For me, div1E is one of my favorite ideas, and I may have spent a hundred hours thinking through various scenarios for this problem.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307476 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307476 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307476">
                <li>
<div class="comment" commentid="1308234">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1308234" commentparentid="1307476">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/William_ChenZiMo" title="Specialist William_ChenZiMo" class="rated-user user-cyan">William_ChenZiMo</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/11/2025 05:10 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1308234" commentparentid="1307476">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/William_ChenZiMo" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3598644/avatar/93068bc5dea9c5a4.jpg">        </a>
        <div><a href="/profile/William_ChenZiMo" title="Specialist William_ChenZiMo" class="rated-user user-cyan">William_ChenZiMo</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/11/2025 05:10 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1308234" href="?#comment-1308234" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307476" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1308234" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-13" data-commentuserid="3598644" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-13</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1308234">
                        <div class="moveup">
                        <div class="ttypography"><p>Do you know how hard it is for Chinese middle school students to participate in competitions? Especially when they are held on weekdays.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1308234 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1308234 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1308234">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307484">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307484" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Getaway_Car" title="Candidate Master Getaway_Car" class="rated-user user-violet">Getaway_Car</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 03:29 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307484" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Getaway_Car" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4713021/avatar/97c88de031fcb84.jpg">        </a>
        <div><a href="/profile/Getaway_Car" title="Candidate Master Getaway_Car" class="rated-user user-violet">Getaway_Car</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 03:29 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307484" href="?#comment-1307484" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307484" class="CommentVoteFrame" myvotedirection="0" data-commentrating="1" data-commentuserid="4713021" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307484">
                        <div class="moveup">
                        <div class="ttypography"><p>If there are some hints before the solution, it will become better.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307484 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307484 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307484">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307496">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307496" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/The_Last_Run" title="Pupil The_Last_Run" class="rated-user user-green">The_Last_Run</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 04:35 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307496" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/The_Last_Run" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3618703/avatar/cc90780f4bcbb07d.jpg">        </a>
        <div><a href="/profile/The_Last_Run" title="Pupil The_Last_Run" class="rated-user user-green">The_Last_Run</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 04:35 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307496" href="?#comment-1307496" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307496" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307496" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3618703" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307496">
                        <div class="moveup">
                        <div class="ttypography"><p>Is it possible to solve Div1A or Div2C using Dynamic programming by dp[k][k]? where dp[i][j] denotes we have performed i of 1st operation and j of 2nd operation....in every step,I will try to do 1st operation and 2nd operation if it is possible! my submission:<a href="/contest/2139/submission/337636880" title="Submission 337636880 by The_Last_Run">337636880</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307496 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307496 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307496">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307504">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307504" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Muhammad_Aneeq" title="Expert Muhammad_Aneeq" class="rated-user user-blue">Muhammad_Aneeq</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 04:53 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307504" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Muhammad_Aneeq" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Muhammad_Aneeq" title="Expert Muhammad_Aneeq" class="rated-user user-blue">Muhammad_Aneeq</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 04:53 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307504" href="?#comment-1307504" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307504" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2643656" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307504">
                        <div class="moveup">
                        <div class="ttypography"><p>I used greedy and binary search on C2 and surprisingly it worked.I tried to prove but I couldn't. I don't know whether the solution is correct or the test cases are weak.</p><p><a href="https://codeforces.com/contest/2139/submission/337638882">submission</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307504 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307504 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307504">
                <li>
<div class="comment" commentid="1307517">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307517" commentparentid="1307504">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/lgm_" title="Specialist lgm_" class="rated-user user-cyan">lgm_</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 05:37 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307517" commentparentid="1307504">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/lgm_" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3944826/avatar/61b995b3481462d1.jpg">        </a>
        <div><a href="/profile/lgm_" title="Specialist lgm_" class="rated-user user-cyan">lgm_</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 05:37 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307517" href="?#comment-1307517" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307504" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307517" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3944826" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307517">
                        <div class="moveup">
                        <div class="ttypography"><p>probably hackable as is the case <a href="https://codeforces.com/blog/entry/146172?#comment-1307458">here</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307517 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307517 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307517">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307510">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307510" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/LordAkaza" title="Specialist LordAkaza" class="rated-user user-cyan">LordAkaza</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 05:02 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307510" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/LordAkaza" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2831981/avatar/727ade6e33d65688.jpg">        </a>
        <div><a href="/profile/LordAkaza" title="Specialist LordAkaza" class="rated-user user-cyan">LordAkaza</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 05:02 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307510" href="?#comment-1307510" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307510" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2831981" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307510">
                        <div class="moveup">
                        <div class="ttypography"><p>During yesterday's contest I submitted Div2E1 with greedy (was sure it would fail) — <a href="/contest/2139/submission/337614514" title="Submission 337614514 by LordAkaza">337614514</a> but it didn't and passed all TCs (I ended up submitting another solution for E1 hence it was skipped in main testing). Then I submitted exact same solution to Div2E2 — <a href="/contest/2139/submission/337616400" title="Submission 337616400 by LordAkaza">337616400</a> which gave WA on TC13 instead of a TLE.</p><p>Since both problems only differ in time constraints, only explanation I found was weak pretest for Div2E1. But again after contest I submitted same code as I did in contest, it passed main tests as well — <a href="/contest/2139/submission/337667320" title="Submission 337667320 by LordAkaza">337667320</a>. Am I missing some point here or the tests for Div2E1 are actually weak?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307510 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307510 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307510">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307514">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307514" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/B_3" title="Expert B_3" class="rated-user user-blue">B_3</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 05:15 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">3</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307514" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/B_3" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/B_3" title="Expert B_3" class="rated-user user-blue">B_3</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 05:15 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307514" href="?#comment-1307514" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307514" class="CommentVoteFrame" myvotedirection="0" data-commentrating="11" data-commentuserid="2669463" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+11</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307514">
                        <div class="moveup">
                        <div class="ttypography"><p><a href="/contest/2138/submission/337680242" title="Submission 337680242 by B_3">337680242</a></p><p>A clean way to solve Div1A :)</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307514 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307514 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307514">
                <li>
<div class="comment" commentid="1307518">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307518" commentparentid="1307514">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/lgm_" title="Specialist lgm_" class="rated-user user-cyan">lgm_</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 05:38 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307518" commentparentid="1307514">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/lgm_" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3944826/avatar/61b995b3481462d1.jpg">        </a>
        <div><a href="/profile/lgm_" title="Specialist lgm_" class="rated-user user-cyan">lgm_</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 05:38 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307518" href="?#comment-1307518" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307514" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307518" class="CommentVoteFrame" myvotedirection="0" data-commentrating="8" data-commentuserid="3944826" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307518">
                        <div class="moveup">
                        <div class="ttypography"><p>may you explain this please?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307518 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307518 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307518">
                <li>
<div class="comment" commentid="1307524">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307524" commentparentid="1307518">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/B_3" title="Expert B_3" class="rated-user user-blue">B_3</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 06:16 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307524" commentparentid="1307518">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/B_3" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/B_3" title="Expert B_3" class="rated-user user-blue">B_3</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 06:16 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307524" href="?#comment-1307524" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307518" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307524" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2669463" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307524">
                        <div class="moveup">
                        <div class="ttypography"><p>At any time, if your current value is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4362">C</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-589-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-589">C</script>, you either become</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4363"><span class="MJXp-mfrac" id="MJXp-Span-4364" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4365">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4366">2</span></span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-4367" style="width: 1em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-4368">or</span><span class="MJXp-mspace" id="MJXp-Span-4369" style="width: 1em; height: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-4370" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4371">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4372">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4373" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-4374"><span class="MJXp-mn" id="MJXp-Span-4375" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4376" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-590-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-590">\frac{C}{2}\quad\text{or}\quad\frac{C}{2}+2^k</script></center><p>after applying the operation.</p><p>Visualize it:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4377"><span class="MJXp-mrow" id="MJXp-Span-4378"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4379">01010000</span></span><span class="MJXp-mo" id="MJXp-Span-4380" style="margin-left: 0.333em; margin-right: 0.333em;">⟶</span><span class="MJXp-mrow" id="MJXp-Span-4381"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4382">00101000</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-591-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-591">\texttt{01010000}\longrightarrow\texttt{00101000}</script></center> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4383"><span class="MJXp-mrow" id="MJXp-Span-4384"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4385">01010000</span></span><span class="MJXp-mo" id="MJXp-Span-4386" style="margin-left: 0.333em; margin-right: 0.333em;">⟶</span><span class="MJXp-mrow" id="MJXp-Span-4387"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4388">10101000</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-592-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-592">\texttt{01010000}\longrightarrow\texttt{10101000}</script></center><p>Either this or this... you shift and then either add one at the $k$-th bit or not.</p><p>So... you can see that no bit is disappearing after you add them (you can't use any operation after a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4389"><span class="MJXp-mn" id="MJXp-Span-4390">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-593-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-593">1</script> reaches the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4391"><span class="MJXp-mn" id="MJXp-Span-4392">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-594-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-594">0</script>-th bit; both become odd). The first one you add becomes the lowest bit, the second one becomes the second-lowest bit, etc.</p><p>If you want to build something like</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4393"><span class="MJXp-mrow" id="MJXp-Span-4394"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4395">011010</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-595-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-595">\texttt{011010}</script></center><p>starting from</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4396"><span class="MJXp-mrow" id="MJXp-Span-4397"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4398">100000</span></span><span class="MJXp-mo" id="MJXp-Span-4399" style="margin-left: 0.333em; margin-right: 0.333em;">⟶</span><span class="MJXp-mrow" id="MJXp-Span-4400"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4401">010000</span></span><span class="MJXp-mo" id="MJXp-Span-4402" style="margin-left: 0.333em; margin-right: 0.333em;">⟶</span><span class="MJXp-mrow" id="MJXp-Span-4403"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4404">101000</span></span><span class="MJXp-mo" id="MJXp-Span-4405" style="margin-left: 0.333em; margin-right: 0.333em;">⟶</span><span class="MJXp-mrow" id="MJXp-Span-4406"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4407">110100</span></span><span class="MJXp-mo" id="MJXp-Span-4408" style="margin-left: 0.333em; margin-right: 0.333em;">⟶</span><span class="MJXp-mrow" id="MJXp-Span-4409"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-4410">011010</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-596-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-596">\texttt{100000}\longrightarrow\texttt{010000}\longrightarrow\texttt{101000}\longrightarrow\texttt{110100}\longrightarrow\texttt{011010}</script></center><p>So it's like you are just building it from the lowest bit.</p><p>Since the one for the lowest bit already exists (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4411"><span class="MJXp-msubsup" id="MJXp-Span-4412"><span class="MJXp-mn" id="MJXp-Span-4413" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4414" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-597-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-597">2^k</script>), you start from the bit right after; if it's on, you use operation 2, otherwise use operation 1.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307524 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307524 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307524">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1307526">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307526" commentparentid="1307518">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/HarshSingh_24" title="Specialist HarshSingh_24" class="rated-user user-cyan">HarshSingh_24</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 06:18 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307526" commentparentid="1307518">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/HarshSingh_24" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/HarshSingh_24" title="Specialist HarshSingh_24" class="rated-user user-cyan">HarshSingh_24</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 06:18 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307526" href="?#comment-1307526" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307518" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307526" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307526" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2852455" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307526">
                        <div class="moveup">
                        <div class="ttypography"><p>key pattern comes from observing the bits of x and y = 2^(k+1) — x, starting from LSB. If the bits of x and y are same, no operation was needed at this level. If they differ, operation must have occurred and person whose bit is 0 at this position was one who gave half of their cakes.</p><p>You can check this: <a href="/contest/2138/submission/337705903" title="Submission 337705903 by HarshSingh_24">337705903</a> </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307526 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307526 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307526">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307531">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307531" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Engulf" title="Expert Engulf" class="rated-user user-blue">Engulf</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 06:30 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307531" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Engulf" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Engulf" title="Expert Engulf" class="rated-user user-blue">Engulf</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 06:30 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307531" href="?#comment-1307531" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307531" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307531" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-14" data-commentuserid="2352872" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-14</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307531">
                        <div class="moveup">
                        <div class="ttypography"><p>Very good problems! I like them</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307531 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307531 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307531">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307551">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307551" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/hzs090912" title="Specialist hzs090912" class="rated-user user-cyan">hzs090912</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:05 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307551" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/hzs090912" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/hzs090912" title="Specialist hzs090912" class="rated-user user-cyan">hzs090912</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:05 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307551" href="?#comment-1307551" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307551" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2689931" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307551">
                        <div class="moveup">
                        <div class="ttypography"><p>I think the solution of problem 2138C1 have a mistake. "If the maximum answer d is not achievable, we can show that you can always achieve w−1. " In my opinion,it would be d-1 instead of w-1.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307551 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307551 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307551">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307553">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307553" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/peltorator" title="International Grandmaster peltorator" class="rated-user user-red">peltorator</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:06 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307553" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/peltorator" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/392368/avatar/d739fef45f3a6bf1.jpg">        </a>
        <div><a href="/profile/peltorator" title="International Grandmaster peltorator" class="rated-user user-red">peltorator</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:06 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307553" href="?#comment-1307553" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307553" revisioncount="6" revision="6">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">6</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307553" class="CommentVoteFrame" myvotedirection="0" data-commentrating="3" data-commentuserid="392368" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307553">
                        <div class="moveup">
                        <div class="ttypography"><p>regarding the editorial of div1C2. machine word length is denoted by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4416">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-598-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-598">w</script> (w), not <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4418">ω</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-599-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-599">\omega</script> (omega).</p><p>also, i have a different algorithm for subset sum in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4420">O</span><span class="MJXp-mo" id="MJXp-Span-4421" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4422">n</span><span class="MJXp-msqrt" id="MJXp-Span-4423"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4424">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4425" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-600-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-600">O(n \sqrt n)</script> time for this problem, and i think it has a simpler explanation. say, you have a bunch of elements of total weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4427">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-601-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-601">n</script>. consider any weight that appears three times: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4429">x</span><span class="MJXp-mo" id="MJXp-Span-4430" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4431">x</span><span class="MJXp-mo" id="MJXp-Span-4432" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4433">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-602-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-602">x, x, x</script>. what weights can we get with these elements? we can get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4434"><span class="MJXp-mn" id="MJXp-Span-4435">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-603-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-603">0</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4437">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-604-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-604">x</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4438"><span class="MJXp-mn" id="MJXp-Span-4439">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4440">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-605-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-605">2x</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4441"><span class="MJXp-mn" id="MJXp-Span-4442">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4443">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-606-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-606">3x</script>. i claim that i can get the same weights with only two elements! i only need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4445">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-607-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-607">x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4446"><span class="MJXp-mn" id="MJXp-Span-4447">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4448">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-608-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-608">2x</script>. if i replace <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4450">x</span><span class="MJXp-mo" id="MJXp-Span-4451" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4452">x</span><span class="MJXp-mo" id="MJXp-Span-4453" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4454">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-609-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-609">x, x, x</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4456">x</span><span class="MJXp-mo" id="MJXp-Span-4457" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-4458">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4459">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-610-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-610">x, 2x</script> in the multiset of items, nothing changes. let's do this replacement process repeatedly. for each weight from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4460"><span class="MJXp-mn" id="MJXp-Span-4461">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-611-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-611">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4463">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-612-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-612">n</script> i will store the number of elements of this weight, then go through weights in the increasing order, and while some weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4465">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-613-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-613">x</script> appears at least three times, i take two of its appearances and replace them with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4466"><span class="MJXp-mn" id="MJXp-Span-4467">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4468">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-614-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-614">2x</script>. here is the code snippet:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> items</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]++;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>i claim that at the end of this process we have at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4470">O</span><span class="MJXp-mo" id="MJXp-Span-4471" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msqrt" id="MJXp-Span-4472"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4473">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4474" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-615-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-615">O(\sqrt n)</script> items. why? we did not change the sum of weights of all items. it is still <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4476">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-616-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-616">n</script>. however, now each weight appears in the list of items at most twice. it is a classical exercise that if the sum of some positive integers is equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4478">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-617-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-617">n</script>, then there are at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4479"><span class="MJXp-msqrt" id="MJXp-Span-4480"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4481">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4482">n</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-618-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-618">\sqrt{2n}</script> distinct values among them. as in our multiset the multiplicity of each element is not larger than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4483"><span class="MJXp-mn" id="MJXp-Span-4484">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-619-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-619">2</script>, it implies that we have at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4485"><span class="MJXp-mn" id="MJXp-Span-4486">2</span><span class="MJXp-msqrt" id="MJXp-Span-4487"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4488">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4489">n</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-620-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-620">2 \sqrt{2n}</script> items in our final list. after that, we can solve subset sum trivially which would give time complexity <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4491">O</span><span class="MJXp-mo" id="MJXp-Span-4492" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4493">n</span><span class="MJXp-msqrt" id="MJXp-Span-4494"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4495">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4496" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-621-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-621">O(n \sqrt n)</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4498">O</span><span class="MJXp-mo" id="MJXp-Span-4499" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4500">n</span><span class="MJXp-msqrt" id="MJXp-Span-4501"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4502">n</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4503"><span class="MJXp-mo" id="MJXp-Span-4504" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4505">w</span><span class="MJXp-mo" id="MJXp-Span-4506" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-622-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-622">O(n \sqrt n / w)</script> if we use bitsets.</p><p>i don't remember where i learned about this algorithm, so please share the source if you have it :)</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307553 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307553 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307553">
                <li>
<div class="comment" commentid="1307558">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307558" commentparentid="1307553">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/tfg" title="International Master tfg" class="rated-user user-orange">tfg</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:31 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307558" commentparentid="1307553">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/tfg" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/tfg" title="International Master tfg" class="rated-user user-orange">tfg</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:31 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307558" href="?#comment-1307558" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307553" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307558" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="456977" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307558">
                        <div class="moveup">
                        <div class="ttypography"><p>There are many sources for that, the main one nowadays is <a href="https://codeforces.com/blog/entry/98663">https://codeforces.com/blog/entry/98663</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307558 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307558 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307558">
                <li>
<div class="comment" commentid="1307560">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307560" commentparentid="1307558">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/peltorator" title="International Grandmaster peltorator" class="rated-user user-red">peltorator</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:32 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307560" commentparentid="1307558">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/peltorator" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/392368/avatar/d739fef45f3a6bf1.jpg">        </a>
        <div><a href="/profile/peltorator" title="International Grandmaster peltorator" class="rated-user user-red">peltorator</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:32 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307560" href="?#comment-1307560" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307558" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307560" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="392368" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307560">
                        <div class="moveup">
                        <div class="ttypography"><p>thanks! i think this is exactly the one where i learned it.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307560 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307560 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307560">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307559">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307559" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/0wuming0" title="Grandmaster 0wuming0" class="rated-user user-red">0wuming0</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:31 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307559" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/0wuming0" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/0wuming0" title="Grandmaster 0wuming0" class="rated-user user-red">0wuming0</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 08:31 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307559" href="?#comment-1307559" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307559" class="CommentVoteFrame" myvotedirection="0" data-commentrating="23" data-commentuserid="1163966" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+23</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307559">
                        <div class="moveup">
                        <div class="ttypography"><p>I seem to have discovered a new solution(<a href="/contest/2138/submission/337665794" title="Submission 337665794 by 0wuming0">337665794</a>) for Div1 E2(<a href="/contest/2138/problem/E2" title="Codeforces Round 1048 (Div. 1)">2138E2 - Determinant Construction (Hard Version)</a>). First, construct a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4507"><span class="MJXp-mn" id="MJXp-Span-4508">50</span><span class="MJXp-mo" id="MJXp-Span-4509" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-4510">50</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-623-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-623">50×50</script> matrix (with row and column indices from 0 to 49) as follows:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4511"><span class="MJXp-mrow" id="MJXp-Span-4512"><span class="MJXp-mo" id="MJXp-Span-4513" style="margin-left: 0em; margin-right: 0em; vertical-align: -5.417em;"><span class="MJXp-right MJXp-scale1" style="font-size: 22.667em; margin-left: -0.29em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-4514"><span><span class="MJXp-mtr" id="MJXp-Span-4515" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4516" style="text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4517">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4518" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4519">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4520" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4521">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4522" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4523">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4524" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4525">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4526" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4527">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4528" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4529" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4530" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4531">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4532" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4533">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4534" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4535">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4536" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4537">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4538" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4539">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4540" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4541">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4542" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4543" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4544">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4545" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4546">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4547" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4548">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4549" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4550">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4551" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4552">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4553" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4554">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4555" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4556" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4557" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4558">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4559" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4560">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4561" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4562">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4563" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4564">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4565" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4566">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4567" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4568">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4569" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4570" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4571" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-4572">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4573" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4574">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4575" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4576">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4577" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4578">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4579" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4580">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4581" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4582">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4583" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4584" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4585" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4586">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4587" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4588">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4589" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4590">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4591" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4592">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4593" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4594">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4595" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4596">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4597" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4598" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4599">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4600" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4601">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4602" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4603">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4604" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4605">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4606" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4607">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4608" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4609">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4610" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4611" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4612" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4613">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4614" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4615">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4616" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4617">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4618" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4619">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4620" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4621">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4622" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4623">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4624" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4625" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4626">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4627" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4628">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4629" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4630" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-4631">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4632" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4633">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4634" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4635">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4636" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4637">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4638" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4639" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4640" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4641">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4642" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4643">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4644" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4645">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4646" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4647">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4648" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4649">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4650" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4651">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4652" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4653" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4654">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4655" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4656">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4657" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4658">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4659" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4660">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4661" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4662">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4663" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4664">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4665" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4666" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4667" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4668">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4669" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4670">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4671" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4672">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4673" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4674">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4675" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4676">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4677" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4678">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4679" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4680" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4681">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4682" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4683">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4684" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4685">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4686" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4687">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4688" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4689" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-4690">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4691" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4692">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4693" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4694" style="margin-left: 0.333em; margin-right: 0.333em;">⋱</span></span><span class="MJXp-mtd" id="MJXp-Span-4695" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4696">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4697" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4698">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4699" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4700">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4701" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4702">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4703" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4704">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4705" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4706">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4707" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4708" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4709" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span><span class="MJXp-mtd" id="MJXp-Span-4710" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4711" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span><span class="MJXp-mtd" id="MJXp-Span-4712" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4713" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span><span class="MJXp-mtd" id="MJXp-Span-4714" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4715" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span><span class="MJXp-mtd" id="MJXp-Span-4716" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4717" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span><span class="MJXp-mtd" id="MJXp-Span-4718" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4719" style="margin-left: 0.333em; margin-right: 0.333em;">⋱</span></span><span class="MJXp-mtd" id="MJXp-Span-4720" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4721" style="margin-left: 0.333em; margin-right: 0.333em;">⋱</span></span><span class="MJXp-mtd" id="MJXp-Span-4722" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4723" style="margin-left: 0.333em; margin-right: 0.333em;">⋱</span></span><span class="MJXp-mtd" id="MJXp-Span-4724" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4725" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span><span class="MJXp-mtd" id="MJXp-Span-4726" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4727" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span><span class="MJXp-mtd" id="MJXp-Span-4728" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4729" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span><span class="MJXp-mtd" id="MJXp-Span-4730" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4731" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span><span class="MJXp-mtd" id="MJXp-Span-4732" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4733" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4734" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4735" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4736">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4737" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4738">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4739" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4740">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4741" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4742">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4743" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4744">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4745" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4746">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4747" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4748" style="margin-left: 0.333em; margin-right: 0.333em;">⋱</span></span><span class="MJXp-mtd" id="MJXp-Span-4749" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4750">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4751" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4752">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4753" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4754">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4755" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4756">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4757" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4758">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4759" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4760">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4761" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4762" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4763">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4764" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4765">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4766" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4767">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4768" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4769">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4770" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4771">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4772" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4773">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4774" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4775" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4776" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4777" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-4778">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4779" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4780">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4781" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4782">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4783" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4784">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4785" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4786">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4787" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4788">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4789" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4790" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4791">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4792" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4793">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4794" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4795">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4796" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4797">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4798" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4799">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4800" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4801">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4802" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4803" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4804" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4805">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4806" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4807">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4808" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4809">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4810" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4811">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4812" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4813">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4814" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4815">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4816" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4817" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4818">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4819" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4820">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4821" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4822">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4823" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4824">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4825" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4826">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4827" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4828">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4829" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4830" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4831" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4832">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4833" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4834">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4835" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4836" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-4837">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4838" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4839">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4840" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4841">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4842" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4843">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4844" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4845" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4846">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4847" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4848">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4849" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4850">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4851" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4852">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4853" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4854">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4855" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4856">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4857" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4858" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4859" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4860">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4861" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4862">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4863" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4864">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4865" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4866">0</span></span><span class="MJXp-mtd" id="MJXp-Span-4867" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4868">1</span></span><span class="MJXp-mtd" id="MJXp-Span-4869" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-4870">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4871" style="margin-left: 0em; margin-right: 0em; vertical-align: -5.417em;"><span class="MJXp-right MJXp-scale1" style="font-size: 22.667em; margin-left: -0.29em;">]</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-624-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-624"> \begin{bmatrix} 1 & 0 & 0 & 0& 0& 0 & \cdots&0& 0& 0& 0 & 0& 0\\ 1 & 1 & 0 & 0& 0& 0 & \cdots&0& 0& 0& 0 & 0& 0\\ -1 & 1 & 1 & 0& 0& 0 & \cdots&0& 0& 0& 0 & 0& 0\\ 0 & 0 & 1 & 1 & 0& 0 & \cdots&0& 0& 0& 0 & 0& 0\\ 0 & 0 & -1 & 1 & 1& 0 & \cdots&0& 0& 0& 0 & 0& 0\\ 0 & 0 & 0& 0 & 1 & 1 & \cdots&0& 0& 0& 0 & 0& 0\\ 0 & 0 & 0& 0 & -1 & 1 & \ddots&0 & 0& 0& 0 & 0& 0\\ \vdots & \vdots & \vdots& \vdots & \vdots & \ddots & \ddots&\ddots & \vdots& \vdots& \vdots & \vdots& \vdots \\ 0 & 0 & 0& 0 & 0 & 0 &\ddots& 1 & 1& 0& 0 & 0& 0 \\ 0 & 0 & 0& 0 & 0 & 0 &\cdots& -1 & 1& 1& 0 & 0 & 0\\ 0 & 0 & 0& 0 & 0 & 0 &\cdots& 0 & 0& 1& 1 & 0 & 0\\ 0 & 0 & 0& 0 & 0 & 0 &\cdots& 0 & 0& -1& 1 & 1 & 0\\ 0 & 0 & 0& 0 & 0 & 0 &\cdots& 0 & 0& 0& 0 & 1 & 1 \end{bmatrix} </script></center><p>Observing this matrix, we can see that all rows and columns with odd indices contain fewer than 3 non-zero elements. This means we can add non-zero elements to these odd-indexed rows or columns, with at most one addition per row or column. The initial determinant value of the matrix is 1. Considering adding non-zero elements in the upper-right region of the matrix, we find that if we modify the value at position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4872"><span class="MJXp-msubsup" id="MJXp-Span-4873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4874" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4875" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4876">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4877">j</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-625-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-625">a_{ij}</script> (where both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4879">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-626-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-626">i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4880"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4881">j</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-627-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-627">j</script> are odd, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4883">i</span><span class="MJXp-mo" id="MJXp-Span-4884" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4885">j</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-628-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-628">i < j</script>) to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4887">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-629-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-629">k</script>, the determinant value increases by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4889">k</span><span class="MJXp-mo" id="MJXp-Span-4890" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-msubsup" id="MJXp-Span-4891"><span class="MJXp-mn" id="MJXp-Span-4892" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4893" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4894">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4895">j</span><span class="MJXp-mo" id="MJXp-Span-4896">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4897">i</span><span class="MJXp-mo" id="MJXp-Span-4898">)</span><span class="MJXp-mrow" id="MJXp-Span-4899"><span class="MJXp-mo" id="MJXp-Span-4900">/</span></span><span class="MJXp-mn" id="MJXp-Span-4901">2</span><span class="MJXp-mo" id="MJXp-Span-4902">−</span><span class="MJXp-mn" id="MJXp-Span-4903">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-630-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-630">k \times 2^{(j-i)/2 - 1}</script>, and modifications at different positions do not interfere with each other.</p><p>Thus, the original problem is transformed into representing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4905">k</span><span class="MJXp-mo" id="MJXp-Span-4906" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-4907">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-631-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-631">k-1</script> as a sum of terms in the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4908"><span class="MJXp-mo" id="MJXp-Span-4909" style="margin-left: 0em; margin-right: 0.111em;">±</span><span class="MJXp-msubsup" id="MJXp-Span-4910"><span class="MJXp-mn" id="MJXp-Span-4911" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4912" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-4913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4914" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4915" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4916" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-4917" style="margin-left: 0.267em; margin-right: 0.267em;">±</span><span class="MJXp-msubsup" id="MJXp-Span-4918"><span class="MJXp-mn" id="MJXp-Span-4919" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4920" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-4921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4922" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4923" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4924" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-4925" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-4926" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-4927" style="margin-left: 0.267em; margin-right: 0.267em;">±</span><span class="MJXp-msubsup" id="MJXp-Span-4928"><span class="MJXp-mn" id="MJXp-Span-4929" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4930" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-4931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4932" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4933" style="vertical-align: -0.4em;">t</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-632-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-632">\pm 2^{k_1}, \pm 2^{k_2}, \dots, \pm 2^{k_t}</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4934"><span class="MJXp-msubsup" id="MJXp-Span-4935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4936" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4937" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-4938" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-4939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4940" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4941" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4942" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mo" id="MJXp-Span-4943" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-4944" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-4945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4946" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4947" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-633-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-633">k_1 \le k_2 \le \dots \le k_t</script>. The key point is that we can only find corresponding positions in the matrix for each exponent <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4948"><span class="MJXp-msubsup" id="MJXp-Span-4949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4950" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4951" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-634-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-634">k_i</script> if adjacent exponents satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4952"><span class="MJXp-msubsup" id="MJXp-Span-4953"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4954" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4955" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4956" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4957">2</span><span class="MJXp-mo" id="MJXp-Span-4958" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-4959"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4960" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4961" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4962">i</span><span class="MJXp-mo" id="MJXp-Span-4963">+</span><span class="MJXp-mn" id="MJXp-Span-4964">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-635-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-635">k_i + 2 \le k_{i+1}</script>—if the exponents are too close together, it becomes difficult to satisfy the constraint of adding at most one non-zero element per row or column. I adopted the following method: check the binary representation of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4965"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4966">k</span><span class="MJXp-mo" id="MJXp-Span-4967" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-4968">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-636-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-636">k-1</script> from the lowest to the highest bit. If the bit corresponding to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4969"><span class="MJXp-msubsup" id="MJXp-Span-4970"><span class="MJXp-mn" id="MJXp-Span-4971" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4972" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-637-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-637">2^k</script> is 1, then the term <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4973"><span class="MJXp-mo" id="MJXp-Span-4974" style="margin-left: 0em; margin-right: 0.111em;">±</span><span class="MJXp-msubsup" id="MJXp-Span-4975"><span class="MJXp-mn" id="MJXp-Span-4976" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4977" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-638-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-638">\pm 2^k</script> must be included. The strategy here is: if the bit corresponding to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4978"><span class="MJXp-msubsup" id="MJXp-Span-4979"><span class="MJXp-mn" id="MJXp-Span-4980" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4981" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4982">k</span><span class="MJXp-mo" id="MJXp-Span-4983">+</span><span class="MJXp-mn" id="MJXp-Span-4984">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-639-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-639">2^{k+1}</script> is also 1, we add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4985"><span class="MJXp-mo" id="MJXp-Span-4986" style="margin-left: 0em; margin-right: 0.111em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-4987"><span class="MJXp-mn" id="MJXp-Span-4988" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4989" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-640-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-640">+2^k</script>; otherwise, we add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4990"><span class="MJXp-mo" id="MJXp-Span-4991" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-4992"><span class="MJXp-mn" id="MJXp-Span-4993" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4994" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-641-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-641">-2^k</script>. This way, once we add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4995"><span class="MJXp-mo" id="MJXp-Span-4996" style="margin-left: 0em; margin-right: 0.111em;">±</span><span class="MJXp-msubsup" id="MJXp-Span-4997"><span class="MJXp-mn" id="MJXp-Span-4998" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4999" style="vertical-align: 0.5em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-642-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-642">\pm 2^k</script>, we won't add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5000"><span class="MJXp-mo" id="MJXp-Span-5001" style="margin-left: 0em; margin-right: 0.111em;">±</span><span class="MJXp-msubsup" id="MJXp-Span-5002"><span class="MJXp-mn" id="MJXp-Span-5003" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5004" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5005">k</span><span class="MJXp-mo" id="MJXp-Span-5006">+</span><span class="MJXp-mn" id="MJXp-Span-5007">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-643-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-643">\pm 2^{k+1}</script> subsequently. Since the binary representation of k=1e7 has its highest three bits as "100..." in magnitude, the maximum term we need to add is only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5008"><span class="MJXp-mo" id="MJXp-Span-5009" style="margin-left: 0em; margin-right: 0.111em;">±</span><span class="MJXp-msubsup" id="MJXp-Span-5010"><span class="MJXp-mn" id="MJXp-Span-5011" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5012" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-5013">23</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-644-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-644">\pm 2^{23}</script>, which matches requirements.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307559 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307559 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307559">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307569">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307569" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/HCCoder" title="Expert HCCoder" class="rated-user user-blue">HCCoder</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 09:10 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307569" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/HCCoder" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4232430/avatar/7dcb5bd2490c3fc5.jpg">        </a>
        <div><a href="/profile/HCCoder" title="Expert HCCoder" class="rated-user user-blue">HCCoder</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 09:10 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307569" href="?#comment-1307569" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307569" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4232430" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307569">
                        <div class="moveup">
                        <div class="ttypography"><p>I used a bin-searching + greedy approach in both E1 and E2 div2, which got accepted. But now when I am trying to submit it again, it is getting WA on test 68. Who can disprove my solution?https://codeforces.com/contest/2139/submission/337639284</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307569 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307569 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307569">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307578">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307578" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Luna_chan" title="Specialist Luna_chan" class="rated-user user-cyan">Luna_chan</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 09:35 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307578" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Luna_chan" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Luna_chan" title="Specialist Luna_chan" class="rated-user user-cyan">Luna_chan</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 09:35 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307578" href="?#comment-1307578" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307578" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4454377" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307578">
                        <div class="moveup">
                        <div class="ttypography"><p>I 've solved E1 and E2 using binary search + greedy. Can anyone prove my solution? <a href="/contest/2139/submission/337657306" title="Submission 337657306 by Luna_chan">337657306</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307578 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307578 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307578">
                <li>
<div class="comment" commentid="1307605">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307605" commentparentid="1307578">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/HCCoder" title="Expert HCCoder" class="rated-user user-blue">HCCoder</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 11:44 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307605" commentparentid="1307578">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/HCCoder" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4232430/avatar/7dcb5bd2490c3fc5.jpg">        </a>
        <div><a href="/profile/HCCoder" title="Expert HCCoder" class="rated-user user-blue">HCCoder</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 11:44 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307605" href="?#comment-1307605" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307578" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307605" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4232430" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307605">
                        <div class="moveup">
                        <div class="ttypography"><p>I also used this approach, but it turned out to be wrong solution</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307605 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307605 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307605">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307580">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307580" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/yeetholmes619" title="Expert yeetholmes619" class="rated-user user-blue">yeetholmes619</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 09:44 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307580" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/yeetholmes619" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1957631/avatar/69a0e7ed3307bf03.jpg">        </a>
        <div><a href="/profile/yeetholmes619" title="Expert yeetholmes619" class="rated-user user-blue">yeetholmes619</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 09:44 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307580" href="?#comment-1307580" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307580" revisioncount="23" revision="23">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">23</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307580" class="CommentVoteFrame" myvotedirection="0" data-commentrating="3" data-commentuserid="1957631" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307580">
                        <div class="moveup">
                        <div class="ttypography"><p><a class="rated-user user-red" href="/profile/installb" title="Grandmaster installb">installb</a> typo in C1's editorial : w-1 =&gt; d-1 </p> <div class="spoiler"><b class="spoiler-title">Image</b><div class="spoiler-content" style="display: none;"><p><img alt=" " src="https://cdn.discordapp.com/attachments/849713270113304649/1414909008824766494/Screenshot_2025-09-09_at_3.12.20_PM.png?ex=68c14833&amp;is=68bff6b3&amp;hm=bc1194d4ed4d2e7f408d7493bf33f126f9abe431527c1f646a8b180ea094ebce&amp;" style="max-width: 100.0%;max-height: 100.0%;"></p></div></div></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307580 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307580 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307580">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307589">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307589" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/AmanGuptacd" title="Pupil AmanGuptacd" class="rated-user user-green">AmanGuptacd</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 10:44 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307589" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/AmanGuptacd" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4233036/avatar/85c22cd0669e1675.jpg">        </a>
        <div><a href="/profile/AmanGuptacd" title="Pupil AmanGuptacd" class="rated-user user-green">AmanGuptacd</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 10:44 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307589" href="?#comment-1307589" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307589" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4233036" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307589">
                        <div class="moveup">
                        <div class="ttypography"><p>E1 question was very nice but in part E1 my solution passed on all test cases which uses a greedy approach after finding depths. But Greedy approach fails on the test case:</p><p>n=7,k=3 and parents followed by 1 2 2 3 4 4</p><p>Which confused me a lot during contest as the same solution failed on E2 because of missing test case in E1. I think there should be addition of such test case to E1 also as it lies within the constraints so that no one else faces the same problem.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307589 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307589 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307589">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307596">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307596" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/AnishchukT" title="Expert AnishchukT" class="rated-user user-blue">AnishchukT</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 10:59 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307596" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/AnishchukT" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/AnishchukT" title="Expert AnishchukT" class="rated-user user-blue">AnishchukT</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 10:59 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307596" href="?#comment-1307596" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307596" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307596" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2801317" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307596">
                        <div class="moveup">
                        <div class="ttypography"><p>Why is it always possible to achieve (min_depth_of_any_leaf) − 1 in E1?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307596 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307596 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307596">
                <li>
<div class="comment" commentid="1307614">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307614" commentparentid="1307596">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/yeetholmes619" title="Expert yeetholmes619" class="rated-user user-blue">yeetholmes619</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 12:32 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307614" commentparentid="1307596">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/yeetholmes619" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1957631/avatar/69a0e7ed3307bf03.jpg">        </a>
        <div><a href="/profile/yeetholmes619" title="Expert yeetholmes619" class="rated-user user-blue">yeetholmes619</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 12:32 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307614" href="?#comment-1307614" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307596" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307614" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="1957631" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307614">
                        <div class="moveup">
                        <div class="ttypography"><p><a href="https://codeforces.com/blog/entry/146172?#comment-1307613">https://codeforces.com/blog/entry/146172?#comment-1307613</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307614 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307614 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307614">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307604">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307604" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/riyadunnabi" title="Newbie riyadunnabi" class="rated-user user-gray">riyadunnabi</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 11:29 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307604" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/riyadunnabi" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3616699/avatar/142fa0e702dce596.jpg">        </a>
        <div><a href="/profile/riyadunnabi" title="Newbie riyadunnabi" class="rated-user user-gray">riyadunnabi</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 11:29 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307604" href="?#comment-1307604" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307604" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3616699" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307604">
                        <div class="moveup">
                        <div class="ttypography"><p>?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307604 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307604 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307604">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307613">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307613" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/yeetholmes619" title="Expert yeetholmes619" class="rated-user user-blue">yeetholmes619</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 12:32 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307613" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/yeetholmes619" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1957631/avatar/69a0e7ed3307bf03.jpg">        </a>
        <div><a href="/profile/yeetholmes619" title="Expert yeetholmes619" class="rated-user user-blue">yeetholmes619</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 12:32 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307613" href="?#comment-1307613" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1307613" revisioncount="4" revision="4">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">4</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307613" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="1957631" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307613">
                        <div class="moveup">
                        <div class="ttypography"><p>For my fellow low rated participants if the following statement from C1's editorial isn't clear on why its true :</p><p>"As all leaves have the same depth, c_d should be the maximum element in the array, so you are always able to select a label for groups 1 to d−1"</p><p>think about this statement :</p><p>"if there are k sources which have varying levels of some thing and you need s units from one source -- as long as sum of number of units in all sources is &gt;= k*s the source with maximum number of units will have &gt;= s units of that thing to give ! </p><p>this is because the average is established to be &gt;= s and the maximum will always be &gt;= average ! [pigeon hole principle]"</p><p>combined with the fact that the number of nodes in each level are non-decreasing so depths of all levels before the min depth of a leaf would have lesser than the average number of nodes per level we're concerned about -- you should now be able to reason why its true !</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307613 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307613 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307613">
                <li>
<div class="comment" commentid="1308100">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1308100" commentparentid="1307613">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/cosmere" title="Pupil cosmere" class="rated-user user-green">cosmere</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 14:37 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1308100" commentparentid="1307613">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/cosmere" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1527172/avatar/31918e01fa36585b.jpg">        </a>
        <div><a href="/profile/cosmere" title="Pupil cosmere" class="rated-user user-green">cosmere</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 14:37 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1308100" href="?#comment-1308100" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307613" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1308100" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="1527172" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1308100">
                        <div class="moveup">
                        <div class="ttypography"><p>Now the problem can be considered as a knapsack problem, where you have d items with weight c1,⋯,cd . We need to find out whether you can take several numbers from c that have a sum equal to k . This can be solved in O(n2) .</p><p>Can you please explain how it got transformed to a knapsack problem?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1308100 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1308100 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1308100">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1307630">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307630" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/TheInfiniteLoop" title="Specialist TheInfiniteLoop" class="rated-user user-cyan">TheInfiniteLoop</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 13:35 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307630" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/TheInfiniteLoop" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/TheInfiniteLoop" title="Specialist TheInfiniteLoop" class="rated-user user-cyan">TheInfiniteLoop</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/09/2025 13:35 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307630" href="?#comment-1307630" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307630" class="CommentVoteFrame" myvotedirection="0" data-commentrating="5" data-commentuserid="4994638" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307630">
                        <div class="moveup">
                        <div class="ttypography"><p>I am new to the concept of bitsets.</p><p>Could someone explain the bitsets solution for C2? Like how to go about doing it?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307630 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307630 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307630">
        </ul>
    </div>
</div>

<div class="comment" commentid="1307976">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1307976" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/nik-hil_1" title="Pupil nik-hil_1" class="rated-user user-green">nik-hil_1</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 05:21 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1307976" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/nik-hil_1" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4611806/avatar/8e8fb9284468797.jpg">        </a>
        <div><a href="/profile/nik-hil_1" title="Pupil nik-hil_1" class="rated-user user-green">nik-hil_1</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 05:21 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1307976" href="?#comment-1307976" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1307976" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4611806" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1307976">
                        <div class="moveup">
                        <div class="ttypography"><p>has Rating get updated for this contest 1048 div 2? because mine is still not updated yet</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1307976 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1307976 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1307976">
                <li>
<div class="comment" commentid="1308006">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1308006" commentparentid="1307976">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/6434554613" title="Pupil 6434554613" class="rated-user user-green">6434554613</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 08:29 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1308006" commentparentid="1307976">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/6434554613" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/6434554613" title="Pupil 6434554613" class="rated-user user-green">6434554613</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 08:29 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1308006" href="?#comment-1308006" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1307976" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1308006" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4663019" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1308006">
                        <div class="moveup">
                        <div class="ttypography"><p>See "Questions about problems".It was declared that this contest is unrated. Bro.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1308006 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1308006 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1308006">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1308009">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1308009" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/fanminghao000" title="Newbie fanminghao000" class="rated-user user-gray">fanminghao000</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 08:46 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1308009" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/fanminghao000" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3874534/avatar/de7aef17cd2b56bb.jpg">        </a>
        <div><a href="/profile/fanminghao000" title="Newbie fanminghao000" class="rated-user user-gray">fanminghao000</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 08:46 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1308009" href="?#comment-1308009" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1308009" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3874534" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1308009">
                        <div class="moveup">
                        <div class="ttypography"><p>Problem C is an excellent problem, but I don't see the point of C2. Is it just to test bitset optimization? The <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5014"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5015">O</span><span class="MJXp-mo" id="MJXp-Span-5016" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5017">n</span><span class="MJXp-msqrt" id="MJXp-Span-5018"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5019">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5020" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-645-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-645">O(n\sqrt{n})</script> multiple knapsack solution is so ingenious—why not make it a separate hard version instead?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1308009 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1308009 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1308009">
        </ul>
    </div>
</div>

<div class="comment" commentid="1308080">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1308080" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/qwq___qaq" title="Candidate Master qwq___qaq" class="rated-user user-violet">qwq___qaq</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 13:36 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1308080" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/qwq___qaq" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2164295/avatar/eba4e56ae8fffdc3.jpg">        </a>
        <div><a href="/profile/qwq___qaq" title="Candidate Master qwq___qaq" class="rated-user user-violet">qwq___qaq</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 13:36 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1308080" href="?#comment-1308080" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1308080" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2164295" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1308080">
                        <div class="moveup">
                        <div class="ttypography"><p>How to prove the solution of 1A reach the minimum?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1308080 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1308080 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1308080">
        </ul>
    </div>
</div>

<div class="comment" commentid="1308099">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1308099" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/cosmere" title="Pupil cosmere" class="rated-user user-green">cosmere</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 14:36 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1308099" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/cosmere" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1527172/avatar/31918e01fa36585b.jpg">        </a>
        <div><a href="/profile/cosmere" title="Pupil cosmere" class="rated-user user-green">cosmere</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/10/2025 14:36 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1308099" href="?#comment-1308099" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1308099" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="1527172" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1308099">
                        <div class="moveup">
                        <div class="ttypography"><p><code class="tt">Now the problem can be considered as a knapsack problem, where you have d  items with weight c1,⋯,cd . We need to find out whether you can take several numbers from c  that have a sum equal to k . This can be solved in O(n2) .</code></p><p>Can someone explain how it got transformed to a knapsack problem?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1308099 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1308099 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1308099">
                <li>
<div class="comment" commentid="1316798">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1316798" commentparentid="1308099">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/mrinmoy66sadhukhan" title="Specialist mrinmoy66sadhukhan" class="rated-user user-cyan">mrinmoy66sadhukhan</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/11/2025 20:36 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1316798" commentparentid="1308099">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/mrinmoy66sadhukhan" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3066219/avatar/fb18c426e88a104c.jpg">        </a>
        <div><a href="/profile/mrinmoy66sadhukhan" title="Specialist mrinmoy66sadhukhan" class="rated-user user-cyan">mrinmoy66sadhukhan</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Oct/11/2025 20:36 UTC">2 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1316798" href="?#comment-1316798" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1308099" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1316798" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3066219" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1316798">
                        <div class="moveup">
                        <div class="ttypography"><p>less of a knapsack.. more like mark all possible sums from subsets of the array</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1316798 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1316798 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1316798">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1308219">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1308219" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/shsh" title="Master shsh" class="rated-user user-orange">shsh</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/11/2025 03:30 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1308219" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/shsh" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1687643/avatar/a7c9bef19b3557e3.jpg">        </a>
        <div><a href="/profile/shsh" title="Master shsh" class="rated-user user-orange">shsh</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/11/2025 03:30 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1308219" href="?#comment-1308219" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1308219" revisioncount="3" revision="3">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">3</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1308219" class="CommentVoteFrame" myvotedirection="0" data-commentrating="5" data-commentuserid="1687643" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1308219">
                        <div class="moveup">
                        <div class="ttypography"><p>I think D1C is one of the coolest problems I've done! Here's a short editorial:</p><p>(By the way, since the answer is obviously bounded by the minimum depth of any leaf, just assume we've already truncated the tree by discarding all nodes with <code class="tt">depth &gt; min_depth</code> from here on out. This also means that instead of having to use exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5022">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-646-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-646">k</script> zeros, we can use anywhere between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5023"><span class="MJXp-mo" id="MJXp-Span-5024" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-5025" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5026">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5027">z</span><span class="MJXp-mo" id="MJXp-Span-5028" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-5029" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5030">n</span><span class="MJXp-mo" id="MJXp-Span-5031" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5032">k</span><span class="MJXp-mo" id="MJXp-Span-5033" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5034" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-5035">0</span><span class="MJXp-mo" id="MJXp-Span-5036" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-647-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-647">\max(sz - (n - k), 0)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5037"><span class="MJXp-mo" id="MJXp-Span-5038" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-5039" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5040">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5041">z</span><span class="MJXp-mo" id="MJXp-Span-5042" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5043">k</span><span class="MJXp-mo" id="MJXp-Span-5044" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-648-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-648">\min(sz, k)</script> zeros, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5045"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5046">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5047">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-649-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-649">sz</script> is the number of nodes that still remain in the tree after truncation.)</p><p>Off the bat, note that we're allowed a ton of freedom with how we fill values into the tree---the only constraint is the total number of 0s/1s, which gives us a huge number of possible configurations to work with. My friend <a class="rated-user user-violet" href="/profile/andrewgopher" title="Candidate Master andrewgopher">andrewgopher</a> would refer to such a problem as <strong>continuous</strong>.</p><p>This should make us suspect that we can never stray too far from a best-case coloring, in which every layer of the tree is either entirely <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5048"><span class="MJXp-mn" id="MJXp-Span-5049">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-650-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-650">0</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5050"><span class="MJXp-mn" id="MJXp-Span-5051">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-651-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-651">1</script>. And this suspicion turns out to be correct, as we can show that we can always color nodes such that at most <em>one layer</em> contains both 0s and 1s. One simple way to do this is to run a BFS from the root until we hit <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5053">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-652-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-652">k</script> nodes, color those <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5054"><span class="MJXp-mn" id="MJXp-Span-5055">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-653-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-653">0</script>, and color all remaining nodes with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5056"><span class="MJXp-mn" id="MJXp-Span-5057">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-654-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-654">1</script>.</p><p>Therefore, we can always color the tree in a way such that at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5058"><span class="MJXp-mn" id="MJXp-Span-5059">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-655-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-655">1</script> layer has a mix of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5060"><span class="MJXp-mn" id="MJXp-Span-5061">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-656-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-656">0</script>s and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5062"><span class="MJXp-mn" id="MJXp-Span-5063">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-657-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-657">1</script>s. This is actually really nice because if, hypothetically, there were <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5064"><span class="MJXp-mn" id="MJXp-Span-5065">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-658-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-658">2</script> mixed layers, the LCS length could be either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5067">d</span><span class="MJXp-mo" id="MJXp-Span-5068" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-5069">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-659-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-659">d - 2</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5071">d</span><span class="MJXp-mo" id="MJXp-Span-5072" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-5073">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-660-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-660">d - 1</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5075">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-661-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-661">d</script> is the depth of the tree. But, if there is one mixed layer, we know that the LCS length <em>must</em> be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5077">d</span><span class="MJXp-mo" id="MJXp-Span-5078" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-5079">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-662-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-662">d - 1</script>, and if there's no mixed layers the LCS is obviously <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5081">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-663-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-663">d</script>. This greatly reduces the complexity of the problem.</p><p>Thus, the question then becomes whether we can achieve a coloring with no mixed layers---this can be done with a simple knapsack. Here's my submission: <a href="/contest/2138/submission/337692707" title="Submission 337692707 by shsh">337692707</a></p><p>And that's it! The only thing I disliked about this problem isn't even an issue with the problem itself: rather, it's the fact that going from C1 to C2 is just "do you know bitset?"</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1308219 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1308219 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1308219">
                <li>
<div class="comment" commentid="1308224">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1308224" commentparentid="1308219">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/andrewgopher" title="Candidate Master andrewgopher" class="rated-user user-violet">andrewgopher</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/11/2025 04:16 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1308224" commentparentid="1308219">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/andrewgopher" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/andrewgopher" title="Candidate Master andrewgopher" class="rated-user user-violet">andrewgopher</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/11/2025 04:16 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1308224" href="?#comment-1308224" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1308219" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1308224" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2114505" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1308224">
                        <div class="moveup">
                        <div class="ttypography"><p>Touch this guy</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1308224 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1308224 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1308224">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1308529">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1308529" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/rumike" title="Pupil rumike" class="rated-user user-green">rumike</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/12/2025 14:04 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1308529" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/rumike" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/rumike" title="Pupil rumike" class="rated-user user-green">rumike</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/12/2025 14:04 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1308529" href="?#comment-1308529" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1308529" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3484504" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1308529">
                        <div class="moveup">
                        <div class="ttypography"><p>for DIV2D/DIV1A, if nxt[i] is the index of the next element that is less than a[i], can I assert that the result of [l, r] is NO only if nxt[nxt[l]] &lt;= r ?</p><p>For me it sounds logic, and currenlty having wa2, can someone explain what I am missing?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1308529 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1308529 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1308529">
        </ul>
    </div>
</div>

<div class="comment" commentid="1309928">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1309928" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Mohit-Chowdhary" title="Pupil Mohit-Chowdhary" class="rated-user user-green">Mohit-Chowdhary</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/16/2025 21:46 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1309928" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Mohit-Chowdhary" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Mohit-Chowdhary" title="Pupil Mohit-Chowdhary" class="rated-user user-green">Mohit-Chowdhary</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/16/2025 21:46 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1309928" href="?#comment-1309928" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1309928" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3643855" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1309928">
                        <div class="moveup">
                        <div class="ttypography"><p>I had a diffrent way of solving Cake Assignment <a href="https://medium.com/@mohit24c/cake-assignment-9dd8f49b76ca">here</a></p><p>Do check it out</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1309928 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1309928 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1309928">
        </ul>
    </div>
</div>

<div class="comment" commentid="1313089">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1313089" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/JessoGetsWA" title="Specialist JessoGetsWA" class="rated-user user-cyan">JessoGetsWA</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/27/2025 19:07 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1313089" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/JessoGetsWA" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/JessoGetsWA" title="Specialist JessoGetsWA" class="rated-user user-cyan">JessoGetsWA</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Sep/27/2025 19:07 UTC">3 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1313089" href="?#comment-1313089" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1313089" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="1489258" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1313089">
                        <div class="moveup">
                        <div class="ttypography"><p>Can anyone please tell me whats wrong with my solution to DIV2 D if possible? <a href="https://codeforces.com/problemset/submission/2138/340803037">https://codeforces.com/problemset/submission/2138/340803037</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1313089 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1313089 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1313089">
        </ul>
    </div>
</div>
        <br>

<div id="editBox-161396" style="width:50em;display:none;">
    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
    <div style="width: 1px">&nbsp;</div>
    <div class="commentLocale" style="position: relative; top: 0.5em;left:4px;display: none;">
        <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
        <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
    </div>
    <textarea data-drafts-id="CommentReplyFrame" class="wysiwyg" name="editContent" rows="20" style="width:99%;"></textarea>
    <div class="error error__content"></div>
    <div style="text-align:center;">
        <input type="button" name="preview" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Preview">
        <input type="button" name="save" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Save">
    </div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {

var firstPreview161396 = true;
var lastPreviewContent161396 = '';

if (!window.moveCommentRevision) {
    moveCommentRevision = function(e, dir) {
        var p = e.parent();
        var revisionCount = parseInt(p.attr("revisionCount"));
        var revision = parseInt(p.attr("revision"));
        var next = revision + dir;
        var commentId = p.attr("commentId");
        if (next >= 1 && next <= revisionCount) {
            $.post(
                "/data/comment-data",
                {action: "revision", commentId: commentId, revision: next},
                function(json) {
                    if (json.success == "true") {
                        var parentDiv = e;

                        while (parentDiv !== null && (parentDiv[0].nodeName.toLowerCase() !== "td" || !parentDiv.hasClass("right"))) {
                            parentDiv = parentDiv.parent();
                        }

                        if (parentDiv === null) {
                            return;
                        }

                        parentDiv.find("div.comment-content-" + commentId + " .moveup").html(json.content);
                        Codeforces.setupSpoilers(parentDiv.find("div.comment-content-" + commentId + " .moveup"));
                        p.attr("revision", next);
                        p.find("span.revision").text(next);
                        if (next == 1) {
                            p.find("a.leftRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.leftRevision").css("visibility", "visible");
                        }
                        if (next == revisionCount) {
                            p.find("a.rightRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.rightRevision").css("visibility", "visible");
                        }

                        window.updateTypography();
                        MathJax.Hub.Typeset();
                    } else {
                        alert(e.error);
                    }
                },
                "json"
            );
        }
    };
}

$("div[commentableId=161396] a.leftRevision").click(function () {
    window.moveCommentRevision($(this), -1);
    return false;
});

$("div[commentableId=161396] a.rightRevision").click(function () {
    window.moveCommentRevision($(this), +1);
    return false;
});



        });
    </script>


        <script src="//codeforces.com/codeforces.org/s/52448/js/swfobject-2.2.min.js" type="text/javascript"></script>
        <script src="//codeforces.com/codeforces.org/s/52448/js/ftaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                if (window.evercookie) {
                    var ec = new evercookie({
                        history: false,
                        silverlight: false,
                        baseurl: '',
                        asseturi: '/assets',
                        phpuri: '/2fdcd78',
                        pngPath: '/eps',
                        etagPath: '/ees',
                        cachePath: '/ecs'
                    });

                    var randomNumber = function () {
                        return Math.random().toString(36).substr(2);
                    };

                    var randomToken = function () {
                        return (randomNumber() + randomNumber()).substring(0, 18);
                    };

                    window._ftaa = "";

                    ec.get("70a7c28f3de", function (value) {
                        window._ftaa = value;
                        if (!window._ftaa) {
                            window._ftaa = randomToken();
                            ec.set("70a7c28f3de", window._ftaa);
                        }
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                } else {
                    window._ftaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

        <script src="//codeforces.com/codeforces.org/s/52448/js/bfaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                var fpCallback = function() {
                    Fingerprint2.get({}, function(components) {
                        window._bfaa = Fingerprint2.x64hash128(components.map(function (pair) { return pair.value }).join(), 31);
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                };
                if (typeof Fingerprint2 !== 'undefined') {
                    if (window.requestIdleCallback) {
                        requestIdleCallback(fpCallback)
                    } else {
                        setTimeout(fpCallback, 500)
                    }
                } else {
                    window._bfaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

    <script type="text/javascript">
        $(document).ready(function () {
    $("a.new-root-comment").click(function () {
            window.location = "/enter";
        return false;
    });

    $(".comment-table .reply a").click(function () {
            window.location = "/enter";
        return false;
    });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
    function updateImg(element, direction, activated) {
        var votedDirection = element.closest(".CommentVoteFrame").attr("myVoteDirection");
        var directionString = direction == 1 ? "up" : "down";
        element.attr("src", "//codeforces.com/codeforces.org/s/52448/images/actions/comment-vote" + directionString + (activated ? "" : "-blue") + ".png");
        element.css("opacity", activated ? "1.0" : "0.35");
        var title;
        if (votedDirection == direction) {
            title = "Cancel vote";
        } else if (direction == 1) {
            title = "Vote: I like it";
        } else {
            title = "Vote: I do not like it";
        }
        element.attr("alt", title);
        element.attr("title", title);
    }

    $(".vote-for-comment").mouseover(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (!ownComment) {
            updateImg(vote.find("img"), direction, true);
        }
    });

    $(".vote-for-comment").mouseout(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (myVoteDirection != direction && !ownComment) {
            updateImg(vote.find("img"), direction, false);
        }
    });

    $(".vote-for-comment").click(function () {
        if ($(this).closest(".hidden-comment").length) {
            Codeforces.showMessage("Show the comment before voting");
            return;
        }
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var commentId = $(this).parent().attr("commentid");
        var commentRating = $(this).parent().attr("data-commentRating");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var direction = $(this).attr("voteDirection");
        var newDirection = direction;
        if (direction == myVoteDirection) {
            newDirection = 0; // Clicking same direction twice cancels the vote
        }
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        $.post("/data/comment/vote", {commentId: commentId, _tta: Codeforces.tta(), vote: newDirection, commentRating: commentRating}, function(data) {
            if (data["success"] == "true") {
                voteFrame.attr("myVoteDirection", newDirection);
                updateImg(voteFrame.find("[voteDirection=-1]>img"), -1, newDirection == -1);
                updateImg(voteFrame.find("[voteDirection=1]>img"), 1, newDirection == 1);
                if (newDirection == -1) {
                    voteFrame.find(".ComplaintFrame").css("display", "inline-block");
                } else {
                    voteFrame.find(".ComplaintFrame").hide();
                }
                vote.parent().find(".commentRating").html(data["commentRating"]);
            }
            Codeforces.showMessage(data["message"]);
        }, "json");
        return false;
    });

    $(".negative-comment-vote").closest(".comment-table").addClass("comment-bad");

    $(".troll-comment-vote").closest(".comment").css("display", "none");

    $(".too-negative-comment-vote").closest(".comment-table").each(function () {
        var e = $(this);
        e.addClass("comment-too-bad");
        var commentId = e.attr("commentId");
        $("<div class='bad-comment-replacement ttypography'>The comment is hidden because of too negative feedback, click <a href=# class=show-bad-comment-link>here</a> to view it</div>").appendTo(
            e.find(".right")
        );
        e.find(".comment-content").hide();
        e.find(".show-bad-comment-link").click(function () {
            e.find(".comment-content").show();
            e.find(".bad-comment-replacement").hide();
            return false;
        });
    });
        });
    </script>
    </div>

    <style type="text/css">
        .new-comments-box {
            padding: 0.5em;
            width: 22px;
            font-size: 1.3rem;
            font-weight: bold !important;

            position: fixed;
            top: 40%;
            right: 0;
            opacity: 0.2;
            color: white;
            text-align: center;

            border: 1px solid #222;
            background-color: #888 !important;
            border-radius: 3px;
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
        }

        .new-comments-box:hover {
            opacity: 1;
        }

        .new-comments-box .dir:hover {
            background: #3B5998 !important;
            cursor: pointer;
        }
    </style>

    <div class="new-comments-box" data-position="outside" data-index="-1" style="display: none;">
        <div class="up dir" title="Ctrl+Up">↑<hr>
        </div>
        <div class="info" title="New comments"></div>
        <div class="down dir" title="Ctrl+Down">
            <hr>↓
        </div>
    </div>

    <script>
        function makeSureElementIsShown(target) {
            let e = target;
            while (true) {
                e = e.parent().closest(".comment");
                if (e.length === 0) {
                    break;
                }
                e.find(">.hidden-comment").hide();
                e.find(">.shown-comment").show();
            }
        }

        $(function() {
            const hash = window.location.hash;
            if (hash) {
                const target = $(hash);
                if (target) {
                    makeSureElementIsShown(target);
                    setTimeout(() => target.scrollIntoView());
                }
            }
        });

        $(".show-archived-checkbox").change(function () {
            const checked = $(this).is(":checked");
            $.post("/data/comment-data", {action: "setShowArchived", checked}, function (json) {
                if (json["success"] !== "true") {
                    alert(json["error"]);
                } else {
                    if (checked) {
                        Codeforces.reloadAndShowMessage("Archived comments are now displayed")
                    } else {
                        Codeforces.reloadAndShowMessage("Archived comments are no longer displayed")
                    }
                }
            });
            return false;
        });

        function gotoComment(direction) {
            var box = $(".new-comments-box");
            var index = parseInt(box.attr("data-index"));
            if (index == -1)
                index = 0;
            else
                index = Math.max(0, Math.min(parseInt(box.find(".info").text()) - 1, index + direction));
            box.attr("data-index", index);
            var comment = $($(".comment>.shown-comment>.highlight-blue[commentId]").get(index));
            makeSureElementIsShown(comment);
            $('html, body').animate({
                'scrollTop': Math.max(0, comment.offset().top - ($(window).height() - comment.height()) / 2)
            });
            return false;
        }

        $(".new-comments-box .down").click(function () {
            return gotoComment(1);
        });

        $(".new-comments-box .up").click(function () {
            return gotoComment(-1);
        });

        $(document).keydown(function (e) {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (e.ctrlKey) {
                if (code == 38 || code == 40) {
                    gotoComment(code - 39);
                }
            }
        });

        var newCommentCount = $(".comment>.shown-comment>.highlight-blue[commentId]").length;
        if (newCommentCount > 0) {
            $(".new-comments-box .info").text(newCommentCount);
            $(".new-comments-box").show();
        }

        $('table.comment-table').mouseenter(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").addClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        $('table.comment-table').mouseleave(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").removeClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        const commentVoteFrameHolderSelector = ">.comment-table .commentVoteFrameHolder";
        $(".hidden-comment").each(function() {
            const comment = $(this).closest(".comment");
            $(this).find(".hidden-children").text(comment.find(".comment").length);
        });
        $('.hideComment').click(function () {
            const comment = $(this).closest(".comment");
            const shownComment = comment.find("> .shown-comment");
            const hiddenComment = comment.find("> .hidden-comment");
            shownComment.hide();
            hiddenComment.show();
            shownComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(hiddenComment.find(commentVoteFrameHolderSelector));
            return false;
        });
        $('.showComment').click(function () {
            const comment = $(this).closest(".comment");
            const hiddenComment = comment.find("> .hidden-comment");
            const shownComment = comment.find("> .shown-comment");
            hiddenComment.hide();
            shownComment.show();
            hiddenComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(shownComment.find(commentVoteFrameHolderSelector));
            return false;
        });
    </script>



    <script>
        function adjustTopicComplainFrames() {
            let topicIds = [];

            $(".has-topic-id").each(function () {
                const $this = $(this);
                const topicId = $this.attr("topicId");
                if (topicId) {
                    topicIds.push(topicId);
                }
            });

            $.post("/data/topics", {
                action: "findComplainableTopicIds",
                topicIds: topicIds.join(",")
            }, function (json) {
                if (json["success"] === "true") {
                    for (const topicId of json["complainableTopicIds"].split(",")) {
                        $(".has-topic-id[topicId=" + topicId + "]").each(function () {
                            $(this).find(".meta .ComplaintFrame").css("display", "inline-block");
                        });
                    }
                }
            }, "json");
        }

        function updateTopicVote(topicId, voteDirection, processed) {
            let ratingElement = $(".topic-rating-" + topicId);
            let newRating = parseInt(ratingElement.attr("data-rawRating"));
            if (!processed) newRating += voteDirection;
            if (newRating > 0) {
                ratingElement.text("+" + newRating.toString());
                ratingElement.css("color", "green");
            } else {
                ratingElement.text(newRating.toString());
                ratingElement.css("color", "gray");
            }
            let voteUpImg = $(".topic-vote-up-" + topicId + " img");
            voteUpImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === 1 ? "images/actions/voteup-voted.png" : "images/actions/voteup-gray.png"));
            voteUpImg.attr("title", voteDirection === 1 ? "Cancel vote" : "Vote: I like it");
            let voteDownImg = $(".topic-vote-down-" + topicId + " img");
            voteDownImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === -1 ? "images/actions/votedown-voted.png" : "images/actions/votedown-gray.png"));
            voteDownImg.attr("title", voteDirection === -1 ? "Cancel vote" : "Vote: I do not like it");
        }

        function getMyVotes() {
            let topicIds = [];
            $(".topic-rating").each(function () {
                topicIds.push($(this).attr("data-topicId"))
            });
            $.post("/data/topic/vote", {
                topicIds: topicIds.join(","),
                _tta: Codeforces.tta(),
                action: "getMyVotes"
            }, function (data) {
                if (data.success === "true") {
                    votes = JSON.parse(data.votes);
                    for (const vote of votes) {
                        updateTopicVote(vote.topicId, vote.direction, vote.processed);
                    }
                }
            }, "json");
        }

        $(function () {
        });
    </script>

<script type="text/javascript">
    $(document).ready(function () {
        let voteDirection = 0;

        function clickVote(direction) {
            if (direction === voteDirection) {
                direction = 0;
            }
            $.post("/data/topic/vote", {
                topicId: 146808,
                _tta: Codeforces.tta(),
                topicRevisionId: 406422,
                vote: direction,
            }, function (data) {
                if (data.success === "true") {
                    voteDirection = parseInt(data.voteDirection);
                    updateTopicVote(146808, voteDirection, data.processed === "true");
                }
                Codeforces.showMessage(data.message);
            }, "json");
        }

        $(".topic-vote-up-146808").click(function () {
            clickVote(+1);
            return false;
        });
        $(".topic-vote-down-146808").click(function () {
            clickVote(-1);
            return false;
        });
    });
</script></div>

    <script>
        $(function () {
            $(".topic-action-a").click(function () {
                const action = $(this).data("action");
                const topicTitle = $(this).data("topic-title");

                if (confirm("Are you sure you want to perform the action '" + action.toUpperCase()
                        + "' on the topic '" + topicTitle + "'?")) {
                    const topicId = $(this).data("topic-id");
                    const locale = $(this).data("topic-locale");
                    $.post("/data/topic", {action, topicId, locale}, function (json) {
                        Codeforces.reloadAndShowMessageOrShowError(json, json["message"]);
                    });
                }

                return false;
            });
        });
    </script>
        </div>
    </div>
                </div>
        </div>
            <br style="clear: both;">
            <div id="footer">
                <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2025 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: Dec/14/2025 11:59:28<sup title="timezone offset" style="font-size:8px;">UTC</sup> (l3).</div>
                    <div>Desktop version, switch to <a rel="nofollow" class="switchToMobile" href="?mobile=true">mobile version</a>.</div>
                <div class="smaller">
                    <a href="/privacy">Privacy Policy</a>
                    |
                    <a href="/terms">Terms and Conditions</a>
                </div>

                    <div style="margin-top: 25px;">
                        Supported by
                    </div>
                    <div class="footer-logo-div" style="left: 30px;">
                        <a href="https://ton.org/"><img style="margin-right: 2em; width: 60px;" src="//codeforces.com/codeforces.org/s/52448/images/ton-100x100.png" alt="TON" title="TON"></a>
                        <div class="sep">&nbsp;</div>
                        <a href="https://en.itmo.ru/en/" class="itmo-logo"><img style="width: 140px;" src="//codeforces.com/codeforces.org/s/52448/images/itmo_small_en-logo.png" alt="ITMO University" title="ITMO University"></a>
                    </div>

            </div>
        <script type="text/javascript">
            $(function() {
                $(".switchToMobile").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "true"));
                    return false;
                });
                $(".switchToDesktop").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "false"));
                    return false;
                });
            });
        </script>
    <script type="text/javascript">
        $(document).ready(function () {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function () {
                    $(this).animate({
                        'opacity':'1'
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function () {
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }

            Codeforces.focusOnError();

            Codeforces.setCopiedToClipboardText("Copied to clipboard");
            Codeforces.listenCopyable();
        });
    </script>
    <div class="userListsFacebox" style="display:none;">
        <div style="padding: 0.5em; width: 600px; max-height: 200px; overflow-y: auto">
<div class="datatable" style="background-color: #E1E1E1; padding-bottom: 3px;">
            <div class="lt">&nbsp;</div>
            <div class="rt">&nbsp;</div>
            <div class="lb">&nbsp;</div>
            <div class="rb">&nbsp;</div>

            <div style="padding: 4px 0 0 6px;font-size:1.4rem;position:relative;">
                User lists

                <div style="position:absolute;right:0.25em;top:0.35em;">
                    <span style="padding:0;position:relative;bottom:2px;" class="rowCount"></span>

                    <img class="closed" src="//codeforces.com/codeforces.org/s/52448/images/icons/magnifier-medium.png">

                    <span class="filter" style="display:none;">
                        <img class="opened" src="//codeforces.com/codeforces.org/s/52448/images/icons/control-270.png">
                        <input style="padding:0 0 0 20px;position:relative;bottom:2px;border:1px solid #aaa;height:17px;font-size:1.3rem;">
                    </span>
                </div>
            </div>
            <div style="background-color: white;margin:0.3em 3px 0 3px;position:relative;">
            <div class="ilt">&nbsp;</div>
            <div class="irt">&nbsp;</div>
            <table class="">
                <thead>
                <tr>
                    <th draggable="true" class="top left right">Name</th>
                </tr>
                </thead>
                <tbody>
                <tr class="no-items visible"><td style="text-align:left;" colspan="32" class="bottom dark left right">No items</td></tr></tbody>
            </table>
            </div>
        </div>
    <script type="text/javascript">
        $(document).ready(function () {
                // Create new ':containsIgnoreCase' selector for search
                jQuery.expr[':'].containsIgnoreCase = function(a, i, m) {
                    return jQuery(a).text().toUpperCase()
                            .indexOf(m[3].toUpperCase()) >= 0;
                };

                if (window.updateDatatableFilter == undefined) {
                    window.updateDatatableFilter = function(i) {
                        var parent = $(i).parent().parent().parent().parent();
                        $("tr.no-items", parent).remove();
                        $("tr", parent).hide().removeClass('visible');
                        var text = $(i).val();
                        if (text) {
                            $("tr" + ":containsIgnoreCase('" + text + "')", parent).show().addClass('visible');
                        } else {
                            parent.find(".rowCount").text("");
                            $("tr", parent).show().addClass('visible');
                        }

                        var found = false;
                        var visibleRowCount = 0;
                        $("tr", parent).each(function () {
                            if (!found) {
                                if ($(this).find("th").size() > 0) {
                                    $(this).show().addClass('visible');
                                    found = true;
                                }
                            }
                            if ($(this).hasClass('visible')) {
                                visibleRowCount++;
                            }
                        });
                        if (text) {
                            parent.find(".rowCount").text("Matches: " + (visibleRowCount - (found ? 1 : 0)));
                        }
                        if (visibleRowCount == (found ? 1 : 0)) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo($(parent).find('table'));
                        }
                        $(parent).find("tr td").removeClass("dark");
                        $(parent).find("tr.visible:odd td").addClass("dark");
                    }

                    $(".datatable .closed").click(function () {
                        var parent = $(this).parent();
                        $(this).hide();
                        $(".filter", parent).fadeIn(function () {
                            $("input", parent).val("").focus().css("border", "1px solid #aaa");
                        });
                    });

                    $(".datatable .opened").click(function () {
                        var parent = $(this).parent().parent();
                        $(".filter", parent).fadeOut(function () {
                            $(".closed", parent).show();
                            $("input", parent).val("").each(function () {
                                window.updateDatatableFilter(this);
                            });
                        });
                    });

                    $(".datatable .filter input").keyup(function(e) {
                        window.updateDatatableFilter(this);
                        e.preventDefault();
                        e.stopPropagation();
                    });

                    $(".datatable table").each(function () {
                        var found = false;
                        $("tr", this).each(function () {
                            if (!found && $(this).find("th").size() == 0) {
                                found = true;
                            }
                        });
                        if (!found) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo(this);
                        }
                    });

                    // Applies styles to datatables.
                    $(".datatable").each(function () {
                        $(this).find("tr:first th").addClass("top");
                        $(this).find("tr:last td").addClass("bottom");
                        $(this).find("tr:odd td").addClass("dark");
                        $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                        $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                    });

                    $(".datatable table.tablesorter").each(function () {
                        $(this).bind("sortEnd", function () {
                            $(".datatable").each(function () {
                                $(this).find("th, td")
                                    .removeClass("top").removeClass("bottom")
                                    .removeClass("left").removeClass("right")
                                    .removeClass("dark");
                                $(this).find("tr:first th").addClass("top");
                                $(this).find("tr:last td").addClass("bottom");
                                $(this).find("tr:odd td").addClass("dark");
                                $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                                $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                            });
                        });
                    });
                }
        });
    </script>
        </div>
    </div>
    <script type="application/javascript">
        $(function() {
            $(".userListMarker").click(function() {
                $.post("/data/lists", {action: "findTouched"}, function(json) {
                    Codeforces.facebox(".userListsFacebox");
                    var tbody = $("#facebox tbody");
                    tbody.empty();
                    for (var i in json) {
                        tbody.append(
                            $("<tr></tr>").append(
                                $("<td></td>").attr("data-readKey", json[i].readKey).text(json[i].name)
                            )
                        );
                    }
                    Codeforces.updateDatatables();
                    tbody.find("td").css("cursor", "pointer").click(function() {
                        document.location = Codeforces.updateUrlParameter(document.location.href, "list", $(this).attr("data-readKey"));
                    });
                }, "json");
            });
        });
    </script>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-52448.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9add8909095da756',t:'MTc2NTcxMzU2OA=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;version&quot;:&quot;2024.11.0&quot;,&quot;token&quot;:&quot;316c29dfa3804effb5a91c52a59b5bd0&quot;,&quot;server_timing&quot;:{&quot;name&quot;:{&quot;cfCacheStatus&quot;:true,&quot;cfEdge&quot;:true,&quot;cfExtPri&quot;:true,&quot;cfL4&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfSpeedBrain&quot;:true},&quot;location_startswith&quot;:null}}" crossorigin="anonymous"></script>


<div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div id="swfcontainer" style="visibility: visible;"></div><div id="userdata_el" style="visibility: hidden; position: absolute;"></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size1, sans-serif;"></div></div></body></html>