<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/146172" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p><a href="https://codeforces.com/contest/2139/problem/A">2139A — Maple and Multiplication</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a> Preparation: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a>,<a class="rated-user user-orange" href="https://codeforces.com/profile/2014CAIS01" title="International Master 2014CAIS01">2014CAIS01</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">a</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">b</span></span></span><script type="math/tex" id="MathJax-Element-1">a=b</script> we need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mn" id="MJXp-Span-6">0</span></span></span><script type="math/tex" id="MathJax-Element-2">0</script> steps.</p><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">a</span></span></span><script type="math/tex" id="MathJax-Element-3">a</script> can be divided by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">b</span></span></span><script type="math/tex" id="MathJax-Element-4">b</script>, we only need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mn" id="MJXp-Span-12">1</span></span></span><script type="math/tex" id="MathJax-Element-5">1</script> step, which is to multiply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">b</span></span></span><script type="math/tex" id="MathJax-Element-6">b</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mfrac" id="MJXp-Span-16" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">a</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">b</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-7">\frac{a}{b}</script>. Same for the case when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">b</span></span></span><script type="math/tex" id="MathJax-Element-8">b</script> can be divided by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">a</span></span></span><script type="math/tex" id="MathJax-Element-9">a</script>.</p><p>Otherwise, we need at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mn" id="MJXp-Span-24">2</span></span></span><script type="math/tex" id="MathJax-Element-10">2</script> steps. As both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">a</span></span></span><script type="math/tex" id="MathJax-Element-11">a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">b</span></span></span><script type="math/tex" id="MathJax-Element-12">b</script> are positive integers, we can first multiply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">a</span></span></span><script type="math/tex" id="MathJax-Element-13">a</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">b</span></span></span><script type="math/tex" id="MathJax-Element-14">b</script> and then multiply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">b</span></span></span><script type="math/tex" id="MathJax-Element-15">b</script> by the original value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">a</span></span></span><script type="math/tex" id="MathJax-Element-16">a</script>. Both number will be equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">a</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">b</span></span></span><script type="math/tex" id="MathJax-Element-17">a\times b</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a </span><span class="pun">&gt;&gt;</span><span class="pln"> b</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a </span><span class="pun">==</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a </span><span class="pun">%</span><span class="pln"> b </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> b </span><span class="pun">%</span><span class="pln"> a </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> TC</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> TC</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">TC </span><span class="pun">--){</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 
<style data-nocturne="true" type="text/css">

</style>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11893">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>

    <script>
        $(function() {
            const likeFormUtil = {};
            likeFormUtil.getCount = function ($count) {
                return Number($count.attr("data-value"));
            };
            likeFormUtil.setCount = function ($count, value) {
                $count.attr("data-value", value);
                $count.text(value);
            };
            likeFormUtil.like = function ($likeForm) {
                $likeForm.find(".likeState").addClass("liked");
                const $likeCount = $likeForm.find(".likeCount");
                likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) + 1);
            };
            likeFormUtil.unLike = function ($likeForm) {
                if ($likeForm.find(".likeState").hasClass("liked")) {
                    $likeForm.find(".likeState").removeClass("liked");
                    const $likeCount = $likeForm.find(".likeCount");
                    likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) - 1);
                }
            };
            likeFormUtil.dislike = function ($likeForm) {
                $likeForm.find(".dislikeState").addClass("disliked");
                const $dislikeCount = $likeForm.find(".dislikeCount");
                likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) + 1);
            };
            likeFormUtil.unDislike = function ($likeForm) {
                if ($likeForm.find(".dislikeState").hasClass("disliked")) {
                    $likeForm.find(".dislikeState").removeClass("disliked");
                    const $dislikeCount = $likeForm.find(".dislikeCount");
                    likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) - 1);
                }
            };
            likeFormUtil.disable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", function () {
                    return false;
                });
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", function () {
                    return false;
                });
            };
            likeFormUtil.enable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", onLike);
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", onDislike);
            };
            likeFormUtil.applyLikeableInformation = function(likeableInformation) {
                const id = likeableInformation.likeable.id;
                console.log(id);
                const $likeForm = $(".likeActionLink[data-likeableId='" + id + "']").closest(".likeForm");
                console.log($likeForm);
                likeFormUtil.setCount($likeForm.find(".likeCount"), likeableInformation.likeCount);
                likeFormUtil.setCount($likeForm.find(".dislikeCount"), likeableInformation.dislikeCount);
                if (likeableInformation.liked) {
                    $likeForm.find(".likeState").addClass("liked");
                } else {
                    $likeForm.find(".likeState").removeClass("liked");
                }
                if (likeableInformation.disliked) {
                    $likeForm.find(".likeState").addClass("disliked");
                } else {
                    $likeForm.find(".likeState").removeClass("disliked");
                }
            }
            likeFormUtil.applyLikeableInformations = function(likeableInformations) {
                likeableInformations.forEach((applyLikeableInformation) => {
                    likeFormUtil.applyLikeableInformation(applyLikeableInformation);
                });
            }

            function onLike() {
                const $likeActionLink = $(this);
                const likeableId = $likeActionLink.attr("data-likeableId");
                const $likeForm = $likeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "like",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["liked"]) {
                            Codeforces.showMessage('Added to liked');
                        } else {
                            Codeforces.showMessage('Removed from liked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            function onDislike() {
                const $dislikeActionLink = $(this);
                const likeableId = $dislikeActionLink.attr("data-likeableId");
                const $likeForm = $dislikeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "dislike",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["disliked"]) {
                            Codeforces.showMessage('Added to disliked');
                        } else {
                            Codeforces.showMessage('Removed from disliked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            $(".likeActionLink").click(onLike);
            $(".dislikeActionLink").click(onDislike);

            $(".likeCount").add(".dislikeCount").each(function () {
                const $count = $(this);
                likeFormUtil.setCount($count, likeFormUtil.getCount($count));
            });
        });
    </script>

<script data-nocturne="true"> $(function () {
}); </script>

</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11894">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="71">71</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11895">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="28">28</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11896">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11897">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2139/problem/B">2139B — Cake Collection</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a> Preparation: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>The number of cakes collected from an oven depends only on the last time Maple visits it. Therefore, in the optimal strategy, she should visit distinct ovens in the last <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-43"><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">m</span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">n</span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-18">\min(m,n)</script> seconds.</p><p>Let's think in reverse: suppose we fix an order <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-50"><span class="MJXp-msubsup" id="MJXp-Span-51"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-53" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-57"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-59" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-19">p_1,\dots,p_n</script> of the ovens. Then at second <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-60"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">m</span></span></span><script type="math/tex" id="MathJax-Element-20">m</script> we visit oven <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-62"><span class="MJXp-msubsup" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-65" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-21">p_1</script>, at second <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">m</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-69">1</span></span></span><script type="math/tex" id="MathJax-Element-22">m-1</script> we visit oven <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-70"><span class="MJXp-msubsup" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-73" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-23">p_2</script>, and so on. For the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">i</span></span></span><script type="math/tex" id="MathJax-Element-24">i</script>-th oven in this order, we collect <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-msubsup" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-79" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-82" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-86">0</span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">m</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">i</span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-92">1</span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-25">a_{p_i}\cdot \max(0, m-i+1)</script> cakes.</p><p>To maximize the total number of cakes collected, ovens with larger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-97" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-26">a_i</script> should be visited later (i.e., assigned larger multipliers). Thus we sort <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">a</span></span></span><script type="math/tex" id="MathJax-Element-27">a</script> in non-increasing order first.</p><p>The final answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-100"><span class="MJXp-msubsup" id="MJXp-Span-101"><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">i</span><span class="MJXp-mo" id="MJXp-Span-105">=</span><span class="MJXp-mn" id="MJXp-Span-106">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-110" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-114">0</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">m</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">i</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-120">1</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-28">\sum_{i=1}^n a_i \cdot \max(0, m-i+1)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> INF </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0x3f3f3f3f</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    ll ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    vector </span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    sort</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">a</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">greater </span><span class="str">&lt;int&gt;</span><span class="pun">());</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++)</span><span class="pln"> ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> max</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln">t </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> TC</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> TC</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">TC </span><span class="pun">--){</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11898">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="48">48</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11899">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="69">69</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11900">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11901">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11902">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/A">2138A — Cake Assignment</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/wjy666" title="Master wjy666">wjy666</a> Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/wjy666" title="Master wjy666">wjy666</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>You can backtrack from the final state.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Denote the state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-122"><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">a</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">b</span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-29">(a,b)</script> that indicates Chocola has <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">a</span></span></span><script type="math/tex" id="MathJax-Element-30">a</script> cakes and Vanilla has <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">b</span></span></span><script type="math/tex" id="MathJax-Element-31">b</script> cakes.</p><p>After one operation of type <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-mn" id="MJXp-Span-133">1</span></span></span><script type="math/tex" id="MathJax-Element-32">1</script>, Vanilla's number of cakes will definitely be at least half of the total, and similarly for operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-134"><span class="MJXp-mn" id="MJXp-Span-135">2</span></span></span><script type="math/tex" id="MathJax-Element-33">2</script>. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-mn" id="MJXp-Span-137">0</span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">a</span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-141"><span class="MJXp-mn" id="MJXp-Span-142" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-143" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-34">0 < a < 2^{k}</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-msubsup" id="MJXp-Span-146"><span class="MJXp-mn" id="MJXp-Span-147" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-148" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">b</span><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-153"><span class="MJXp-mn" id="MJXp-Span-154" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-155" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">k</span><span class="MJXp-mo" id="MJXp-Span-157">+</span><span class="MJXp-mn" id="MJXp-Span-158">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-35">2^{k} < b < 2^{k+1}</script>, meaning the previous operation must have been type <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-159"><span class="MJXp-mn" id="MJXp-Span-160">1</span></span></span><script type="math/tex" id="MathJax-Element-36">1</script>. Similarly, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-161"><span class="MJXp-mn" id="MJXp-Span-162">0</span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">b</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mn" id="MJXp-Span-167" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-168" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-37">0 < b < 2^{k}</script>, the previous operation must have been type <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-mn" id="MJXp-Span-171">2</span></span></span><script type="math/tex" id="MathJax-Element-38">2</script>.</p><p>Therefore, you can backtrack from the final state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-172"><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">x</span><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-176"><span class="MJXp-mn" id="MJXp-Span-177" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-178" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">k</span><span class="MJXp-mo" id="MJXp-Span-180">+</span><span class="MJXp-mn" id="MJXp-Span-181">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">x</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-39">(x,2^{k+1}-x)</script>, until it reaches the initial state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-185"><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-187"><span class="MJXp-mn" id="MJXp-Span-188" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-189" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-191"><span class="MJXp-mn" id="MJXp-Span-192" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-193" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-40">(2^k,2^k)</script>.</p><p>Now let's analyze how many steps we need to do during the process.</p><p>For the state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-195"><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">a</span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">b</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-41">(a, b)</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">a</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">b</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mn" id="MJXp-Span-206">0</span></span></span><script type="math/tex" id="MathJax-Element-42">a, b \neq 0</script>, assume <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">a</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">i</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-212"><span class="MJXp-mn" id="MJXp-Span-213" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-214" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-217" style="vertical-align: -0.4em;">a</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-43">a = i \cdot 2^{p_a}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">b</span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">j</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-223"><span class="MJXp-mn" id="MJXp-Span-224" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-225" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-228" style="vertical-align: -0.4em;">b</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-44">b = j \cdot 2^{p_b}</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">i</span></span></span><script type="math/tex" id="MathJax-Element-45">i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">j</span></span></span><script type="math/tex" id="MathJax-Element-46">j</script> are positive odd integers.</p><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">a</span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">b</span><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-238"><span class="MJXp-mn" id="MJXp-Span-239" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-240" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">k</span><span class="MJXp-mo" id="MJXp-Span-242">+</span><span class="MJXp-mn" id="MJXp-Span-243">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-47">a + b = 2^{k+1}</script>, it must be true that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-244"><span class="MJXp-mn" id="MJXp-Span-245">0</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-249" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-253" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">k</span></span></span><script type="math/tex" id="MathJax-Element-48"> 0 \le p_a = p_b \le k</script> , and after one operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-256"><span class="MJXp-mn" id="MJXp-Span-257">1</span></span></span><script type="math/tex" id="MathJax-Element-49">1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-258"><span class="MJXp-mn" id="MJXp-Span-259">2</span></span></span><script type="math/tex" id="MathJax-Element-50">2</script>, both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-260"><span class="MJXp-msubsup" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-263" style="vertical-align: -0.4em;">a</span></span></span></span><script type="math/tex" id="MathJax-Element-51">p_a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-264"><span class="MJXp-msubsup" id="MJXp-Span-265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-267" style="vertical-align: -0.4em;">b</span></span></span></span><script type="math/tex" id="MathJax-Element-52">p_b</script> decrease by exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-268"><span class="MJXp-mn" id="MJXp-Span-269">1</span></span></span><script type="math/tex" id="MathJax-Element-53">1</script>.</p><p>Therefore, the whole process takes at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">k</span></span></span><script type="math/tex" id="MathJax-Element-54">k</script> steps, so we solve the problem with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">O</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">k</span><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-55">O(tk)</script> time complexity.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln"> 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> k</span><span class="pun">,</span><span class="pln">x</span><span class="pun">,</span><span class="pln">kk</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">k</span><span class="pun">&gt;&gt;</span><span class="pln">x</span><span class="pun">;</span><span class="pln"> kk</span><span class="pun">=</span><span class="lit">1ll</span><span class="pun">&lt;&lt;</span><span class="pln">k</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">x</span><span class="pun">||</span><span class="pln">x</span><span class="pun">==</span><span class="pln">kk</span><span class="pun">*</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">cout</span><span class="pun">&lt;&lt;</span><span class="str">"-1\n"</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">kk</span><span class="pun">*</span><span class="lit">2</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln"> ans</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">x</span><span class="pun">!=</span><span class="pln">kk</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="lit">2</span><span class="pun">),</span><span class="pln">x</span><span class="pun">-=</span><span class="pln">y</span><span class="pun">,</span><span class="pln">y</span><span class="pun">*=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="lit">1</span><span class="pun">),</span><span class="pln">y</span><span class="pun">-=</span><span class="pln">x</span><span class="pun">,</span><span class="pln">x</span><span class="pun">*=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()&lt;&lt;</span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">())</span><span class="pln"> cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()&lt;&lt;</span><span class="str">' '</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
        cout</span><span class="pun">&lt;&lt;</span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11903">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="184">184</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11904">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="79">79</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11905">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11906">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11907">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="69">69</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/B">2138B — Antiamuny Wants to Learn Swap</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/tarjen" title="International Grandmaster tarjen">tarjen</a> Preparation: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a>,<a class="rated-user user-red" href="https://codeforces.com/profile/tarjen" title="International Grandmaster tarjen">tarjen</a>,<a class="rated-user user-orange" href="https://codeforces.com/profile/2014CAIS01" title="International Master 2014CAIS01">2014CAIS01</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>For array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">b</span></span></span><script type="math/tex" id="MathJax-Element-56">b</script>, we can prove that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">f</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">b</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">g</span><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">b</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-57">f(b)\neq g(b)</script> <strong>if and only if</strong> there exist indexes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-mn" id="MJXp-Span-291">1</span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">i</span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">j</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">k</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">m</span></span></span><script type="math/tex" id="MathJax-Element-58">1\le i<j<k\le m</script> which satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-300"><span class="MJXp-msubsup" id="MJXp-Span-301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-303" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-307" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-311" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-59">b_i>b_j>b_k</script>.</p><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">a</span></span></span><script type="math/tex" id="MathJax-Element-60">a</script> is a permutation, all elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">b</span></span></span><script type="math/tex" id="MathJax-Element-61">b</script> should be distinct. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">g</span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">b</span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-62">g(b)</script> is equal to the number of inversions in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">b</span></span></span><script type="math/tex" id="MathJax-Element-63">b</script>. When there exists some index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">i</span></span></span><script type="math/tex" id="MathJax-Element-64">i</script> that satisfies <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-325"><span class="MJXp-msubsup" id="MJXp-Span-326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-328" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-332" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">i</span><span class="MJXp-mo" id="MJXp-Span-334">+</span><span class="MJXp-mn" id="MJXp-Span-335">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-339" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">i</span><span class="MJXp-mo" id="MJXp-Span-341">+</span><span class="MJXp-mn" id="MJXp-Span-342">2</span></span></span></span></span><script type="math/tex" id="MathJax-Element-65">a_i>a_{i+1}>a_{i+2}</script>, we can reduce the number of inversions by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-343"><span class="MJXp-mn" id="MJXp-Span-344">3</span></span></span><script type="math/tex" id="MathJax-Element-66">3</script> by applying operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-345"><span class="MJXp-mn" id="MJXp-Span-346">2</span></span></span><script type="math/tex" id="MathJax-Element-67">2</script>, allowing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">f</span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">b</span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-68">f(b)</script> to become less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">g</span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">b</span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-69">g(b)</script>. This is the only case where you can reduce more than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-357"><span class="MJXp-mn" id="MJXp-Span-358">1</span></span></span><script type="math/tex" id="MathJax-Element-70">1</script> inversion with one operation.</p><p>If there exist indexes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-359"><span class="MJXp-mn" id="MJXp-Span-360">1</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">i</span><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">j</span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">k</span><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">m</span></span></span><script type="math/tex" id="MathJax-Element-71">1\le i<j<k\le m</script> which satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-369"><span class="MJXp-msubsup" id="MJXp-Span-370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-372" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-376" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-380" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-72">b_i>b_j>b_k</script>, we can first choose indexes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">i</span><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">k</span></span></span><script type="math/tex" id="MathJax-Element-73">i,k</script>, then move all elements greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-385"><span class="MJXp-msubsup" id="MJXp-Span-386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-388" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-74">b_i</script> to the right of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-389"><span class="MJXp-msubsup" id="MJXp-Span-390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-392" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-75">b_k</script> and move all elements less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-393"><span class="MJXp-msubsup" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-396" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-76">b_k</script> to the left of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-397"><span class="MJXp-msubsup" id="MJXp-Span-398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-400" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-77">b_i</script> by swapping adjacent numbers (applying the first operation). Now all elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-401"><span class="MJXp-msubsup" id="MJXp-Span-402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-404" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-78">b_p</script> between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-405"><span class="MJXp-msubsup" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-408" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-412" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-79">b_i,b_k</script> satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-413"><span class="MJXp-msubsup" id="MJXp-Span-414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-416" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-420" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-421" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-424" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-80">b_i>b_p>b_k</script>. We then swap them to the left of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-425"><span class="MJXp-msubsup" id="MJXp-Span-426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-428" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-81">b_i</script> until there is only one element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-429"><span class="MJXp-msubsup" id="MJXp-Span-430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-432" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-82">b_j</script> left. Now <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-433"><span class="MJXp-msubsup" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-436" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-440" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-444" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-83">b_i>b_j>b_k</script> and they are adjacent, and we can apply operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-445"><span class="MJXp-mn" id="MJXp-Span-446">2</span></span></span><script type="math/tex" id="MathJax-Element-84">2</script> on the current index of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-447"><span class="MJXp-msubsup" id="MJXp-Span-448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-450" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-85">b_i</script>.</p><p>If we only apply operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-451"><span class="MJXp-mn" id="MJXp-Span-452">1</span></span></span><script type="math/tex" id="MathJax-Element-86">1</script> on indexes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">i</span></span></span><script type="math/tex" id="MathJax-Element-87">i</script> which satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-455"><span class="MJXp-msubsup" id="MJXp-Span-456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-458" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-462" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">i</span><span class="MJXp-mo" id="MJXp-Span-464">+</span><span class="MJXp-mn" id="MJXp-Span-465">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-88">b_i>b_{i+1}</script>, there will never exist any index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">i</span></span></span><script type="math/tex" id="MathJax-Element-89">i</script> satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-468"><span class="MJXp-msubsup" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-471" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-475" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">i</span><span class="MJXp-mo" id="MJXp-Span-477">+</span><span class="MJXp-mn" id="MJXp-Span-478">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-482" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">i</span><span class="MJXp-mo" id="MJXp-Span-484">+</span><span class="MJXp-mn" id="MJXp-Span-485">2</span></span></span></span></span><script type="math/tex" id="MathJax-Element-90">b_i>b_{i+1}>b_{i+2}</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">b</span></span></span><script type="math/tex" id="MathJax-Element-91">b</script> during the process. If we apply an operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-488"><span class="MJXp-mn" id="MJXp-Span-489">1</span></span></span><script type="math/tex" id="MathJax-Element-92">1</script> on some index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">i</span></span></span><script type="math/tex" id="MathJax-Element-93">i</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-msubsup" id="MJXp-Span-493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-495" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-499" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">i</span><span class="MJXp-mo" id="MJXp-Span-501">+</span><span class="MJXp-mn" id="MJXp-Span-502">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-94">b_i<b_{i+1}</script>, the number of inversions will be increased by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-503"><span class="MJXp-mn" id="MJXp-Span-504">1</span></span></span><script type="math/tex" id="MathJax-Element-95">1</script> instead of decreased by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-505"><span class="MJXp-mn" id="MJXp-Span-506">1</span></span></span><script type="math/tex" id="MathJax-Element-96">1</script>, which makes it impossible to reach <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">f</span><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">b</span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">g</span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">b</span><span class="MJXp-mo" id="MJXp-Span-516" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-97">f(b)<g(b)</script> with one operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-517"><span class="MJXp-mn" id="MJXp-Span-518">2</span></span></span><script type="math/tex" id="MathJax-Element-98">2</script>, even if it decreases the number of inversions by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-519"><span class="MJXp-mn" id="MJXp-Span-520">3</span></span></span><script type="math/tex" id="MathJax-Element-99">3</script>. Therefore, in this case <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">f</span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">b</span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">g</span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">b</span><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-100">f(b)=g(b)</script>.</p><p>For each element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-531"><span class="MJXp-msubsup" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-534" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-101">a_i</script>, we define:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-535"><span class="MJXp-msubsup" id="MJXp-Span-536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-538" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-102">l_i</script>: the maximum index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-539"><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">i</span></span></span><script type="math/tex" id="MathJax-Element-103">< i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-542"><span class="MJXp-msubsup" id="MJXp-Span-543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-545" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-548" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-552" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-104">a_{l_i} > a_i</script>,</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-553"><span class="MJXp-msubsup" id="MJXp-Span-554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-556" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-105">r_i</script>: the minimum index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-557"><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">i</span></span></span><script type="math/tex" id="MathJax-Element-106">> i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-560"><span class="MJXp-msubsup" id="MJXp-Span-561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-563" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-566" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-570" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-107">a_{r_i} < a_i</script>.</li> </ul><p>Then the answer to a query <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">l</span><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">r</span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-108">[l, r]</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-577"><span class="MJXp-mrow" id="MJXp-Span-578"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-579">NO</span></span></span></span><script type="math/tex" id="MathJax-Element-109">\texttt{NO}</script> if and only if some segment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-580"><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-584" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-585" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-588" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-110">[l_i, r_i]</script> lies fully inside <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-590"><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">l</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">r</span><span class="MJXp-mo" id="MJXp-Span-595" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-111">[l, r]</script>.</p><p>To answer multiple queries, you can preprocess the smallest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">r</span></span></span><script type="math/tex" id="MathJax-Element-112">r</script> for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">l</span></span></span><script type="math/tex" id="MathJax-Element-113">l</script> such that the answers for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-600"><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">l</span><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">x</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">x</span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">r</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-114">[l,x](x\ge r)</script> should be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-611"><span class="MJXp-mrow" id="MJXp-Span-612"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-613">NO</span></span></span></span><script type="math/tex" id="MathJax-Element-115">\texttt{NO}</script>.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">O</span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">n</span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-116">O(n)</script> if you find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-619"><span class="MJXp-msubsup" id="MJXp-Span-620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-622" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-626" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-117">l_i,r_i</script> with the Monotonic Stack trick. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">O</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">n</span><span class="MJXp-mi" id="MJXp-Span-631">log</span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">n</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-118">O(n\log n)</script> solutions can also pass.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> mxl</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> mir</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
            mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mxl</span><span class="pun">[</span><span class="pln">mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
            mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mir</span><span class="pun">[</span><span class="pln">mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> L</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            L</span><span class="pun">[</span><span class="pln">mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">L</span><span class="pun">[</span><span class="pln">mir</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]],</span><span class="pln"> mxl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        L</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">L</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> L</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&lt;=</span><span class="pln"> L</span><span class="pun">[</span><span class="pln">r</span><span class="pun">])</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"NO\n"</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"YES\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11908">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="79">79</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11909">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="20">20</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11910">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="15">15</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11911">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="4">4</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11912">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="173">173</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/C1">2138C1 — Maple and Tree Beauty (Easy Version)</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a> Preparation: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a>,<a class="rated-user user-red" href="https://codeforces.com/profile/tarjen" title="International Grandmaster tarjen">tarjen</a>,<a class="rated-user user-orange" href="https://codeforces.com/profile/2014CAIS01" title="International Master 2014CAIS01">2014CAIS01</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>We can first find out that the maximum possible answer is the minimum depth among all leaves <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">d</span><span class="MJXp-mo" id="MJXp-Span-637" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mrow" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">e</span><span class="MJXp-msubsup" id="MJXp-Span-642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-644" style="vertical-align: -0.4em;">u</span></span></span></span></span><script type="math/tex" id="MathJax-Element-119">d=\min{dep_u}</script>, as the LCS can't be greater than the minimum length of all names.</p><p>We consider a special case first where all leaves have the same depth. If we want to achieve the maximum answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">d</span></span></span><script type="math/tex" id="MathJax-Element-120">d</script>, the names of all leaves should be exactly the same. Which means, for any two vertices with the same depth, their labels has to be the same.</p><p>For each depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">i</span></span></span><script type="math/tex" id="MathJax-Element-121">i</script>, we group all vertices with depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">i</span></span></span><script type="math/tex" id="MathJax-Element-122">i</script> together as the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">i</span></span></span><script type="math/tex" id="MathJax-Element-123">i</script>-th group (suppose root has depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-653"><span class="MJXp-mn" id="MJXp-Span-654">1</span></span></span><script type="math/tex" id="MathJax-Element-124">1</script>). For each group, all vertices in the group should have the same label. Let the size of groups <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-655"><span class="MJXp-mn" id="MJXp-Span-656">1</span><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-658" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">d</span></span></span><script type="math/tex" id="MathJax-Element-125">1,\cdots,d</script> be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-661"><span class="MJXp-msubsup" id="MJXp-Span-662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-664" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-670" style="vertical-align: -0.4em;">d</span></span></span></span><script type="math/tex" id="MathJax-Element-126">c_1,\cdots,c_d</script>. Now the problem can be considered as a knapsack problem, where you have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">d</span></span></span><script type="math/tex" id="MathJax-Element-127">d</script> items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-673"><span class="MJXp-msubsup" id="MJXp-Span-674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-676" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-682" style="vertical-align: -0.4em;">d</span></span></span></span><script type="math/tex" id="MathJax-Element-128">c_1,\cdots,c_d</script>. We need to find out whether you can take several numbers from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">c</span></span></span><script type="math/tex" id="MathJax-Element-129">c</script> that have a sum equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-685"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">k</span></span></span><script type="math/tex" id="MathJax-Element-130">k</script>. This can be solved in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">O</span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-692" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-131">O(n^2)</script>.</p><p>If the maximum answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">d</span></span></span><script type="math/tex" id="MathJax-Element-132">d</script> is not achievable, we can show that you can always achieve <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">d</span><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-699">1</span></span></span><script type="math/tex" id="MathJax-Element-133">d-1</script>. For each group from the first to the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">d</span></span></span><script type="math/tex" id="MathJax-Element-134">d</script>-th, we assign an arbitrary label <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mn" id="MJXp-Span-703">0</span></span></span><script type="math/tex" id="MathJax-Element-135">0</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-704"><span class="MJXp-mn" id="MJXp-Span-705">1</span></span></span><script type="math/tex" id="MathJax-Element-136">1</script> which still has at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-706"><span class="MJXp-msubsup" id="MJXp-Span-707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-709" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-137">c_i</script> numbers remaining to all vertices in the group. As all leaves have the same depth, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-710"><span class="MJXp-msubsup" id="MJXp-Span-711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-713" style="vertical-align: -0.4em;">d</span></span></span></span><script type="math/tex" id="MathJax-Element-138">c_d</script> should be the maximum element in the array, so you are always able to select a label for groups <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-714"><span class="MJXp-mn" id="MJXp-Span-715">1</span></span></span><script type="math/tex" id="MathJax-Element-139">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">d</span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-719">1</span></span></span><script type="math/tex" id="MathJax-Element-140">d-1</script>. Then arbitrarily distribute the remaining labels among vertices in the last groups (which are leaves).</p><p>Now consider the general case where not all leaves have the same depth. If we want to achieve answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-720"><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">d</span></span></span><script type="math/tex" id="MathJax-Element-141">=d</script>, we need to select <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">d</span></span></span><script type="math/tex" id="MathJax-Element-142">d</script> groups. For each leaf vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">v</span></span></span><script type="math/tex" id="MathJax-Element-143">v</script>, there should exist a vertex in the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">d</span></span></span><script type="math/tex" id="MathJax-Element-144">d</script>-th group which is an ancestor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">v</span></span></span><script type="math/tex" id="MathJax-Element-145">v</script>. And for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-731"><span class="MJXp-mn" id="MJXp-Span-732">2</span><span class="MJXp-mo" id="MJXp-Span-733" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">i</span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">d</span></span></span><script type="math/tex" id="MathJax-Element-146">2\le i\le d</script>, for each vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">v</span></span></span><script type="math/tex" id="MathJax-Element-147">v</script> in the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">i</span></span></span><script type="math/tex" id="MathJax-Element-148">i</script>-th group, there should exist a vertex in the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">i</span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-744">1</span></span></span><script type="math/tex" id="MathJax-Element-149">i-1</script>-th group which is an ancestor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">v</span></span></span><script type="math/tex" id="MathJax-Element-150">v</script>. All vertices in the same group should have the same label. Suppose the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">i</span></span></span><script type="math/tex" id="MathJax-Element-151">i</script>-th group has label <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-749"><span class="MJXp-msubsup" id="MJXp-Span-750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-752" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-152">l_i</script>, then we can achieve <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-753"><span class="MJXp-mtext" id="MJXp-Span-754">LCS</span><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-758" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-761" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-765" style="vertical-align: -0.4em;">d</span></span></span></span><script type="math/tex" id="MathJax-Element-153">\text{LCS}=l_1l_2\ldots l_d</script> which has length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">d</span></span></span><script type="math/tex" id="MathJax-Element-154">d</script>.</p><p>We can still group all vertices with depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-768"><span class="MJXp-mn" id="MJXp-Span-769">1</span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">i</span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">d</span></span></span><script type="math/tex" id="MathJax-Element-155">1\le i\le d</script> together as the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">i</span></span></span><script type="math/tex" id="MathJax-Element-156">i</script>-th group. For all vertices with depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-776"><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">d</span></span></span><script type="math/tex" id="MathJax-Element-157">>d</script>, we can set their label arbitrarily. We can view them as items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-779"><span class="MJXp-mn" id="MJXp-Span-780">1</span></span></span><script type="math/tex" id="MathJax-Element-158">1</script> in the knapsack problem.</p><p>And we can show this is the optimal way to select <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">d</span></span></span><script type="math/tex" id="MathJax-Element-159">d</script> groups. If some vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">u</span></span></span><script type="math/tex" id="MathJax-Element-160">u</script> with depth <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-785"><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">d</span></span></span><script type="math/tex" id="MathJax-Element-161">\le d</script> is not selected, there must be some vertices selected in some group in the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">u</span></span></span><script type="math/tex" id="MathJax-Element-162">u</script>, because the path from the root to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">u</span></span></span><script type="math/tex" id="MathJax-Element-163">u</script> consists of fewer than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">d</span></span></span><script type="math/tex" id="MathJax-Element-164">d</script> vertices. If the smallest group index that some vertex in the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">u</span></span></span><script type="math/tex" id="MathJax-Element-165">u</script> belongs to is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">i</span></span></span><script type="math/tex" id="MathJax-Element-166">i</script>, we can instead let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">u</span></span></span><script type="math/tex" id="MathJax-Element-167">u</script> be inside the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">i</span></span></span><script type="math/tex" id="MathJax-Element-168">i</script>-th group, and then the labels of all vertices in the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">u</span></span></span><script type="math/tex" id="MathJax-Element-169">u</script> that were previously in group <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">i</span></span></span><script type="math/tex" id="MathJax-Element-170">i</script> can be selected arbitrarily. If we consider the knapsack problem, we have reduced some <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-806"><span class="MJXp-msubsup" id="MJXp-Span-807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-809" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-171">c_i</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">x</span></span></span><script type="math/tex" id="MathJax-Element-172">x</script> and added <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">x</span></span></span><script type="math/tex" id="MathJax-Element-173">x</script> items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-814"><span class="MJXp-mn" id="MJXp-Span-815">1</span></span></span><script type="math/tex" id="MathJax-Element-174">1</script>. All achievable values still remain achievable, while some previously unachievable values become achievable.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">O</span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-821" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-822" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-175">O(n^2)</script>, the bottleneck is knapsack.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">// n^2/w</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> fa</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> dep</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> noson</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> cnt</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]++;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]--;</span><span class="pln">
        dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dep</span><span class="pun">[</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        cnt</span><span class="pun">[</span><span class="pln">dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]++;</span><span class="pln">
        noson</span><span class="pun">[</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mxdep </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e9</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">noson</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> mxdep </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">mxdep</span><span class="pun">,</span><span class="pln"> dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> sum </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
 
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> dp</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> mxdep</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> sum</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">--)</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">|=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
        sum </span><span class="pun">+=</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sum </span><span class="pun">&lt;=</span><span class="pln"> k </span><span class="pun">||</span><span class="pln"> sum </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> mxdep </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> sum</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> k </span><span class="pun">&amp;&amp;</span><span class="pln"> sum </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> mxdep </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> mxdep</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11918">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="134">134</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11919">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11920">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11921">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11922">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/C2">2138C2 — Maple and Tree Beauty (Hard Version)</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a> Preparation: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a>,<a class="rated-user user-red" href="https://codeforces.com/profile/tarjen" title="International Grandmaster tarjen">tarjen</a>,<a class="rated-user user-orange" href="https://codeforces.com/profile/2014CAIS01" title="International Master 2014CAIS01">2014CAIS01</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>We focus on optimizing the knapsack problem. In the knapsack problem we only need to know <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-823"><span class="MJXp-msubsup" id="MJXp-Span-824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-826" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-828">0</span><span class="MJXp-mrow" id="MJXp-Span-829"><span class="MJXp-mo" id="MJXp-Span-830" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-831">1</span></span></span><script type="math/tex" id="MathJax-Element-176">f_i=0/1</script> which means whether you can achieve sum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">i</span></span></span><script type="math/tex" id="MathJax-Element-177">i</script>, so we can optimize the knapsack with bitset. The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">O</span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-837" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-840" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">ω</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-178">O(\frac{n^2}{\omega})</script> which is enough to pass E2.</p><p>But actually we can do better. For the knapsack problem, it has at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">n</span></span></span><script type="math/tex" id="MathJax-Element-179">n</script> items, and the sum of weights of all items is also at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">n</span></span></span><script type="math/tex" id="MathJax-Element-180">n</script>. We can do a sqrt decomposition trick here. </p> <ul>   <li>For items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-847"><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msqrt" id="MJXp-Span-849"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">n</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-181">\ge\sqrt{n}</script>, there are at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-851"><span class="MJXp-msqrt" id="MJXp-Span-852"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">n</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-182">\sqrt{n}</script> such items.</li>   <li>For items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-854"><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msqrt" id="MJXp-Span-856"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">n</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-183"><\sqrt{n}</script>, we count the number of items for each different weight. If there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-858"><span class="MJXp-msubsup" id="MJXp-Span-859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-861" style="vertical-align: -0.4em;">w</span></span></span></span><script type="math/tex" id="MathJax-Element-184">c_w</script> items for weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">w</span></span></span><script type="math/tex" id="MathJax-Element-185">w</script>, we decompose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">x</span></span></span><script type="math/tex" id="MathJax-Element-186">x</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-866"><span class="MJXp-msubsup" id="MJXp-Span-867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-869" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-mo" id="MJXp-Span-870" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-871"><span class="MJXp-mn" id="MJXp-Span-872" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-873" style="vertical-align: 0.5em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-874" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-875"><span class="MJXp-mn" id="MJXp-Span-876" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-877" style="vertical-align: 0.5em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-878" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-879" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-880" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-881"><span class="MJXp-mn" id="MJXp-Span-882" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-883" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-884" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">y</span></span></span><script type="math/tex" id="MathJax-Element-187">c_w=2^0+2^1+\cdots+2^k+y</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">k</span></span></span><script type="math/tex" id="MathJax-Element-188">k</script> is the largest integer satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-888"><span class="MJXp-msubsup" id="MJXp-Span-889"><span class="MJXp-mn" id="MJXp-Span-890" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-891" style="vertical-align: 0.5em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-892" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-893"><span class="MJXp-mn" id="MJXp-Span-894" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-895" style="vertical-align: 0.5em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-896" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-897" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-898" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-899"><span class="MJXp-mn" id="MJXp-Span-900" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-901" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-905" style="vertical-align: -0.4em;">w</span></span></span></span><script type="math/tex" id="MathJax-Element-189">2^0+2^1+\ldots+2^k\le c_w</script>. Then we create new items with weights <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-906"><span class="MJXp-msubsup" id="MJXp-Span-907"><span class="MJXp-mn" id="MJXp-Span-908" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-909" style="vertical-align: 0.5em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-910" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">w</span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-913"><span class="MJXp-mn" id="MJXp-Span-914" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-915" style="vertical-align: 0.5em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">w</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-921"><span class="MJXp-mn" id="MJXp-Span-922" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-923" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">w</span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">y</span><span class="MJXp-mo" id="MJXp-Span-928" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">w</span></span></span><script type="math/tex" id="MathJax-Element-190">2^0\cdot w,2^1\cdot w,\ldots,2^k\cdot w,y\cdot w</script>. The set of new items is the same as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-930"><span class="MJXp-msubsup" id="MJXp-Span-931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-933" style="vertical-align: -0.4em;">w</span></span></span></span><script type="math/tex" id="MathJax-Element-191">c_w</script> items with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">w</span></span></span><script type="math/tex" id="MathJax-Element-192">w</script> if we only consider the different sum of weights the set of items can achieve. Now we only have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-936"><span class="MJXp-msubsup" id="MJXp-Span-937"><span class="MJXp-mo" id="MJXp-Span-938" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.004em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-943"><span class="MJXp-msqrt" id="MJXp-Span-944"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">n</span></span></span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -1.03em;"><span class="MJXp-mrow" id="MJXp-Span-939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">w</span><span class="MJXp-mo" id="MJXp-Span-941">=</span><span class="MJXp-mn" id="MJXp-Span-942">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-946">log</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-948" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-951" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-mo" id="MJXp-Span-952" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-953" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-954"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">n</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-193">\sum_{w=1}^{\sqrt{n}}\log(c_w)=\sqrt{n}</script> items.</li> </ul><p>The total time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">O</span><span class="MJXp-mo" id="MJXp-Span-958" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msqrt" id="MJXp-Span-959"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-961" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">n</span><span class="MJXp-mo" id="MJXp-Span-963" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msqrt" id="MJXp-Span-964"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">n</span><span class="MJXp-mo" id="MJXp-Span-968" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">O</span><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">n</span><span class="MJXp-msqrt" id="MJXp-Span-973"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-194">O(\sqrt{n}\cdot n+\sqrt{n}\cdot n)=O(n\sqrt{n})</script>.</p><p>And this can also be optimized with bitset, leading to an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">O</span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-979" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">n</span><span class="MJXp-msqrt" id="MJXp-Span-981"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">n</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">ω</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-984" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-195">O(\frac{n\sqrt{n}}{\omega})</script> solution.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">// nsqrtn/w</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">template</span><span class="pln"> </span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pln"> maxn</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> solve</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">maxn </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> solve</span><span class="pun">&lt;</span><span class="pln">min</span><span class="pun">(</span><span class="pln">N</span><span class="pun">,</span><span class="pln"> maxn </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)&gt;(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    bitset</span><span class="str">&lt;maxn&gt;</span><span class="pln"> dp</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> fa</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> dep</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> noson</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> cnt</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]++;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]--;</span><span class="pln">
        dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dep</span><span class="pun">[</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        cnt</span><span class="pun">[</span><span class="pln">dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]++;</span><span class="pln">
        noson</span><span class="pun">[</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    dp</span><span class="pun">.</span><span class="pln">reset</span><span class="pun">();</span><span class="pln">
    dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mxdep </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e9</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">noson</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> mxdep </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">mxdep</span><span class="pun">,</span><span class="pln"> dep</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> sum </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> cnt</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> mxdep </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    sort</span><span class="pun">(</span><span class="pln">all</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> all</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">all</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">all</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> all</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> all</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span><span class="pln"> j</span><span class="pun">++;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> t </span><span class="pun">=</span><span class="pln"> j </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> z </span><span class="pun">&lt;=</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> z </span><span class="pun">*=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            v</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">z </span><span class="pun">*</span><span class="pln"> all</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
            t </span><span class="pun">-=</span><span class="pln"> z</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> v</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">t </span><span class="pun">*</span><span class="pln"> all</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        i </span><span class="pun">=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> val </span><span class="pun">:</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        sum </span><span class="pun">+=</span><span class="pln"> val</span><span class="pun">;</span><span class="pln">
        dp </span><span class="pun">|=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp </span><span class="pun">&lt;&lt;</span><span class="pln"> val</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sum </span><span class="pun">&lt;=</span><span class="pln"> k </span><span class="pun">||</span><span class="pln"> sum </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> mxdep </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> sum</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> k </span><span class="pun">&amp;&amp;</span><span class="pln"> sum </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> mxdep </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> mxdep</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> solve</span><span class="pun">&lt;</span><span class="lit">1</span><span class="pun">&gt;(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11913">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="63">63</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11914">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="24">24</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11915">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11916">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="21">21</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11917">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="32">32</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/D">2139D — Antiamuny and Slider Movement</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/tarjen" title="International Grandmaster tarjen">tarjen</a>,<a class="rated-user user-red" href="https://codeforces.com/profile/StarSilk" title="International Grandmaster StarSilk">StarSilk</a> Preparation: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a>,<a class="rated-user user-red" href="https://codeforces.com/profile/tarjen" title="International Grandmaster tarjen">tarjen</a>,<a class="rated-user user-red" href="https://codeforces.com/profile/StarSilk" title="International Grandmaster StarSilk">StarSilk</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let’s define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-985"><span class="MJXp-msubsup" id="MJXp-Span-986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-988" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-196">b_i</script> as the position of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">i</span></span></span><script type="math/tex" id="MathJax-Element-197">i</script>-th slider decreased by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">i</span></span></span><script type="math/tex" id="MathJax-Element-198">i</script>. Every operation on the sliders can be interpreted as a modification of the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">b</span></span></span><script type="math/tex" id="MathJax-Element-199">b</script>.</p> <ul>   <li><p>If we increase the position of slider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-995"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">i</span></span></span><script type="math/tex" id="MathJax-Element-200">i</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-997"><span class="MJXp-msubsup" id="MJXp-Span-998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1000" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-201">b_i</script> increases. At the same time, every suffix element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1001"><span class="MJXp-msubsup" id="MJXp-Span-1002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1004" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">i</span><span class="MJXp-mo" id="MJXp-Span-1006">+</span><span class="MJXp-mn" id="MJXp-Span-1007">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1011" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">i</span><span class="MJXp-mo" id="MJXp-Span-1013">+</span><span class="MJXp-mn" id="MJXp-Span-1014">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1020" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-202">b_{i+1}, b_{i+2}, \dots, b_n</script> gets updated to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1021"><span class="MJXp-msubsup" id="MJXp-Span-1022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1024" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1030" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1034" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-203">b_j := \max(b_j, b_i)</script>.</p></li>   <li><p>If we decrease the position of slider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">i</span></span></span><script type="math/tex" id="MathJax-Element-204">i</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1038"><span class="MJXp-msubsup" id="MJXp-Span-1039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1041" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-205">b_i</script> decreases. At the same time, every prefix element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1042"><span class="MJXp-msubsup" id="MJXp-Span-1043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1045" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1047"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1049" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1052" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1055" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">i</span><span class="MJXp-mo" id="MJXp-Span-1057">−</span><span class="MJXp-mn" id="MJXp-Span-1058">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-206">b_1, b_2, \dots, b_{i-1}</script> gets updated to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1059"><span class="MJXp-msubsup" id="MJXp-Span-1060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1062" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1064" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1068" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1072" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1073" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-207">b_j := \min(b_j, b_i)</script>.</p></li> </ul><p>Since the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">b</span></span></span><script type="math/tex" id="MathJax-Element-208">b</script> always remains <strong>non-decreasing</strong>, we can reinterpret operations as follows:</p> <ul>   <li>Every operation simultaneously applies a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1076"><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span><script type="math/tex" id="MathJax-Element-209">\min</script> operation to all elements on the left, and a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1078"><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span></span><script type="math/tex" id="MathJax-Element-210">\max</script> operation to all elements on the right.</li> </ul><p>For a fixed slider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1080"><span class="MJXp-msubsup" id="MJXp-Span-1081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1083" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-211">b_i</script>, the effect of each operation on the slider should be one of the following:</p> <ol>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1084"><span class="MJXp-msubsup" id="MJXp-Span-1085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1087" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1088" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1089" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1090" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1093" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1094" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">x</span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-212">b_i := \max(b_i, x)</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1097"><span class="MJXp-msubsup" id="MJXp-Span-1098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1100" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1106" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">x</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-213">b_i := \min(b_i, x)</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1110"><span class="MJXp-msubsup" id="MJXp-Span-1111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1113" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1114" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">x</span></span></span><script type="math/tex" id="MathJax-Element-214">b_i := x</script> (assignment)</li> </ol><p>Our task is to compute the sum of final values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1116"><span class="MJXp-msubsup" id="MJXp-Span-1117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1119" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-215">b_i</script> after all possible sequences of operations.</p><p>We sort all operations by their parameter <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">x</span></span></span><script type="math/tex" id="MathJax-Element-216">x</script>. If multiple operations share the same <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">x</span></span></span><script type="math/tex" id="MathJax-Element-217">x</script>, we give them a consistent order and then assume all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">x</span></span></span><script type="math/tex" id="MathJax-Element-218">x</script> are distinct in the following part of the editorial.</p><p>We first suppose that the position of the slider is changed at least once. Suppose the final value for slider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">i</span></span></span><script type="math/tex" id="MathJax-Element-219">i</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1128"><span class="MJXp-msubsup" id="MJXp-Span-1129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1131" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-220">b_e</script>, let’s consider which operation sets <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1132"><span class="MJXp-msubsup" id="MJXp-Span-1133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1135" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1139" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-221">b_i = b_e</script> at the very end.</p><p>At this point, we no longer care about the exact value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1140"><span class="MJXp-msubsup" id="MJXp-Span-1141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1143" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-222">b_i</script> during the process — only whether it is less than, equal to, or greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1144"><span class="MJXp-msubsup" id="MJXp-Span-1145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1147" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-223">b_e</script>.</p><p>All operations of type <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1148"><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span></span><script type="math/tex" id="MathJax-Element-224">\max</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">x</span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1155" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-225">x < b_e</script> and type <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1156"><span class="MJXp-mo" id="MJXp-Span-1157" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span><script type="math/tex" id="MathJax-Element-226">\min</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">x</span><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1163" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-227">x > b_e</script> are irrelevant. We can insert them anywhere after deciding the order of other operations without affecting the result. We won't consider these operations in the following parts of the editorial.</p><p>All assignment operations <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1164"><span class="MJXp-msubsup" id="MJXp-Span-1165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1167" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">x</span></span></span><script type="math/tex" id="MathJax-Element-228">b_i := x</script> can be reinterpreted:</p> <ul>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">x</span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1175" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-229">x < b_e</script>, treat it as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1176"><span class="MJXp-msubsup" id="MJXp-Span-1177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1179" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1181" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1182" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1185" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">x</span><span class="MJXp-mo" id="MJXp-Span-1188" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-230">b_i := \min(b_i, x)</script>.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">x</span><span class="MJXp-mo" id="MJXp-Span-1191" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1194" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-231">x > b_e</script>, treat it as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1195"><span class="MJXp-msubsup" id="MJXp-Span-1196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1198" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1204" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1205" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">x</span><span class="MJXp-mo" id="MJXp-Span-1207" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-232">b_i := \max(b_i, x)</script>.</li> </ul><p>The last operation, that makes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1208"><span class="MJXp-msubsup" id="MJXp-Span-1209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1211" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1215" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-233">b_i = b_e</script> must be the one with parameter <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">x</span><span class="MJXp-mo" id="MJXp-Span-1218" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1221" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-234">x = b_e</script>.</p> <ul>   <li><p>If this operation is assignment, then all other operations can appear in any order.</p></li>   <li><p>If this operation is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1222"><span class="MJXp-mo" id="MJXp-Span-1223" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span></span><script type="math/tex" id="MathJax-Element-235">\max</script> type, then immediately before it we must have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1224"><span class="MJXp-msubsup" id="MJXp-Span-1225"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1227" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1231" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-236">b_i < b_e</script>.</p></li>   <li>   <ul>     <li>Either the last preceding valid operation is some <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1232"><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span><script type="math/tex" id="MathJax-Element-237">\min</script> type operation making <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1234"><span class="MJXp-msubsup" id="MJXp-Span-1235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1237" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1238" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1241" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-238">b_i < b_e</script>;</li>   </ul></li>   <li>   <ul>     <li>Or no other effective operation occurs, and the initial value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1242"><span class="MJXp-msubsup" id="MJXp-Span-1243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1245" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-239">b_i</script> was already smaller than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1246"><span class="MJXp-msubsup" id="MJXp-Span-1247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1249" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-240">b_e</script>.</li>   </ul></li>   <li><p>If this operation is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1250"><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span><script type="math/tex" id="MathJax-Element-241">\min</script> type operation, it is symmetric: either the last preceding valid operation is a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1252"><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span></span><script type="math/tex" id="MathJax-Element-242">\max</script> type operation, or the initial value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1254"><span class="MJXp-msubsup" id="MJXp-Span-1255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1257" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-243">b_i</script> was already larger than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1258"><span class="MJXp-msubsup" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1261" style="vertical-align: -0.4em;">e</span></span></span></span><script type="math/tex" id="MathJax-Element-244">b_e</script>.</p></li> </ul><p>Finally, don’t forget the case where a slider is never touched, where it simply keeps its initial value.</p><p>For each of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">n</span></span></span><script type="math/tex" id="MathJax-Element-245">n</script> sliders, we need to check contributions over all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">m</span></span></span><script type="math/tex" id="MathJax-Element-246">m</script> operations. The overall time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">O</span><span class="MJXp-mo" id="MJXp-Span-1268" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">m</span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-247">O(nm)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> mod</span><span class="pun">=</span><span class="lit">1000000007</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">5000</span><span class="pun">],</span><span class="pln">ans</span><span class="pun">[</span><span class="lit">5000</span><span class="pun">],</span><span class="pln">tt</span><span class="pun">[</span><span class="lit">5001</span><span class="pun">],</span><span class="pln">inv</span><span class="pun">[</span><span class="lit">5001</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">struct</span><span class="pln"> apos</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> id</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">friend</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pun">&lt;(</span><span class="pln">apos a</span><span class="pun">,</span><span class="pln">apos b</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">x</span><span class="pun">&lt;</span><span class="pln">b</span><span class="pun">.</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">ap</span><span class="pun">[</span><span class="lit">5000</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">),</span><span class="pln">cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">flag</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">p</span><span class="pun">,</span><span class="pln">q</span><span class="pun">,</span><span class="pln">x</span><span class="pun">,</span><span class="pln">i</span><span class="pun">,</span><span class="pln">j</span><span class="pun">,</span><span class="pln">cl</span><span class="pun">,</span><span class="pln">cr</span><span class="pun">;</span><span class="pln">
	tt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">5000</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">tt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">tt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">i</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
	inv</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">5000</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">mod</span><span class="pun">-</span><span class="pln">mod</span><span class="pun">/</span><span class="pln">i</span><span class="pun">)*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">mod</span><span class="pun">%</span><span class="pln">i</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">cin</span><span class="pun">&gt;&gt;</span><span class="pln">T</span><span class="pun">;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="lit">0</span><span class="pun">;</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">&gt;&gt;</span><span class="pln">m</span><span class="pun">&gt;&gt;</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			cin</span><span class="pun">&gt;&gt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
			a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-=</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			cin</span><span class="pun">&gt;&gt;</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&gt;&gt;</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
			ap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">id</span><span class="pun">--;</span><span class="pln">
			ap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">x</span><span class="pun">-=</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">id</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		sort</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">,</span><span class="pln">ap</span><span class="pun">+</span><span class="pln">p</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			flag</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&lt;=</span><span class="pln">i</span><span class="pun">&amp;&amp;</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">&gt;=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">flag</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&gt;=</span><span class="pln">i</span><span class="pun">&amp;&amp;</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">&lt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">flag</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">flag</span><span class="pun">)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			cl</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			cr</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&lt;=</span><span class="pln">i</span><span class="pun">)</span><span class="pln">cr</span><span class="pun">++;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&lt;=</span><span class="pln">i</span><span class="pun">)</span><span class="pln">cr</span><span class="pun">--;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">==</span><span class="pln">i</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">+</span><span class="pln">i</span><span class="pun">)*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">cl</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">+</span><span class="lit">1</span><span class="pun">])%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&lt;</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cl</span><span class="pun">==</span><span class="lit">0</span><span class="pun">&amp;&amp;</span><span class="pln">cr</span><span class="pun">==</span><span class="lit">0</span><span class="pun">&amp;&amp;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;=</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">+</span><span class="pln">i</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">+</span><span class="pln">i</span><span class="pun">)*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">cl</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">cl</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">cl</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&gt;</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cl</span><span class="pun">==</span><span class="lit">0</span><span class="pun">&amp;&amp;</span><span class="pln">cr</span><span class="pun">==</span><span class="lit">0</span><span class="pun">&amp;&amp;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&gt;</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">+</span><span class="pln">i</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">x</span><span class="pun">+</span><span class="pln">i</span><span class="pun">)*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">cl</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">cl</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">cr</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ap</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">id</span><span class="pun">&gt;=</span><span class="pln">i</span><span class="pun">)</span><span class="pln">cl</span><span class="pun">++;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">x </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">x </span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]*</span><span class="pln">tt</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">&lt;&lt;</span><span class="str">' '</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		cout</span><span class="pun">&lt;&lt;</span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11923">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="43">43</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11924">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11925">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="6">6</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11926">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11927">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/E1">2139E1 — Determinant Construction (Easy Version)</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/wjy666" title="Master wjy666">wjy666</a> Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/wjy666" title="Master wjy666">wjy666</a></p> <div class="spoiler"><b class="spoiler-title">Solution 1</b><div class="spoiler-content" style="display: block;"><p>Thanks to <a class="rated-user user-legendary" href="https://codeforces.com/profile/jqdai0815" title="Legendary Grandmaster jqdai0815"><span class="legendary-user-first-letter">j</span>qdai0815</a> for his significant contribution to this solution.</p> <div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>We can consider transforming the construction of a matrix into the construction of a directed graph, as the determinant and permutations are closely related to the cycle covers of a directed graph.</p><p>If we have a directed graph with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">n</span></span></span><script type="math/tex" id="MathJax-Element-248">n</script> vertices, a cycle cover is a set of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">n</span></span></span><script type="math/tex" id="MathJax-Element-249">n</script> edges such that each vertex has exactly one incoming edge and one outgoing edge in this set (self-loops are allowed). In other words, these <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">n</span></span></span><script type="math/tex" id="MathJax-Element-250">n</script> edges form one or more cycles that together cover all vertices in the graph.</p><p>In a complete directed graph (with self-loops), every permutation of the vertices determines a cycle cover and vice versa. (The cycles of the permutation are precisely the cycles in the cover.)</p><p>We consider the definition of the determinant:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1278"><span class="MJXp-mo" id="MJXp-Span-1279" style="margin-left: 0.333em; margin-right: 0.333em;">det</span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">M</span><span class="MJXp-mo" id="MJXp-Span-1282" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1283" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1284"><span class="MJXp-mo" id="MJXp-Span-1285" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1286" style="vertical-align: -0.4em;"><span class="MJXp-mstyle MJXp-script" id="MJXp-Span-1287"><span class="MJXp-mtable" id="MJXp-Span-1288"><span><span class="MJXp-mtr" id="MJXp-Span-1289" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1290" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">B</span><span class="MJXp-mo" id="MJXp-Span-1292">=</span><span class="MJXp-mo" id="MJXp-Span-1293">(</span><span class="MJXp-msubsup" id="MJXp-Span-1294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1296" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1297">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-1298">,</span><span class="MJXp-mo" id="MJXp-Span-1299">…</span><span class="MJXp-mo" id="MJXp-Span-1300">,</span><span class="MJXp-msubsup" id="MJXp-Span-1301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1303" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">n</span><span class="MJXp-mo" id="MJXp-Span-1305">−</span><span class="MJXp-mn" id="MJXp-Span-1306">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1307">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1308" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1309" style="padding-top: 0.1em; text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">B</span><span class="MJXp-mo" id="MJXp-Span-1311">∈</span><span class="MJXp-msubsup" id="MJXp-Span-1312"><span class="MJXp-mrow" id="MJXp-Span-1313" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1314">P</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1315" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">n</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1318" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1319">1</span><span class="MJXp-msubsup" id="MJXp-Span-1320"><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1322" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-1323"><span class="MJXp-mi" id="MJXp-Span-1324">i</span><span class="MJXp-mi" id="MJXp-Span-1325">n</span><span class="MJXp-mi" id="MJXp-Span-1326">v</span></span><span class="MJXp-mo" id="MJXp-Span-1327">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">B</span><span class="MJXp-mo" id="MJXp-Span-1329">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1330" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1331"><span class="MJXp-mo" id="MJXp-Span-1332" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">n</span><span class="MJXp-mo" id="MJXp-Span-1339">−</span><span class="MJXp-mn" id="MJXp-Span-1340">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">i</span><span class="MJXp-mo" id="MJXp-Span-1335">=</span><span class="MJXp-mn" id="MJXp-Span-1336">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1343" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">i</span><span class="MJXp-mo" id="MJXp-Span-1345">,</span><span class="MJXp-msubsup" id="MJXp-Span-1346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1348" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">i</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-251"> \det(M)=\sum_{\begin{subarray}{c}B=(b_{0},\ldots,b_{n-1})\\ B\in\mathcal{P}_{n}\end{subarray}}(-1)^{\mathrm{inv}(B)}\cdot\prod_{i=0}^{n-1}m_ {i,b_{i}} </script></center><p>This summation goes over all permutations <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">B</span></span></span><script type="math/tex" id="MathJax-Element-252">B</script>, in other words, over all cycle covers of the directed graph determined by the adjacency matrix <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">M</span></span></span><script type="math/tex" id="MathJax-Element-253">M</script>. We can also interpret <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1354"><span class="MJXp-msubsup" id="MJXp-Span-1355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1357" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">i</span><span class="MJXp-mo" id="MJXp-Span-1359">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1362">0</span></span></span><script type="math/tex" id="MathJax-Element-254">m_{i,j}=0</script> as "the edge from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">i</span></span></span><script type="math/tex" id="MathJax-Element-255">i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">j</span></span></span><script type="math/tex" id="MathJax-Element-256">j</script> does not exist at all". Thus, the product term <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1367"><span class="MJXp-msubsup" id="MJXp-Span-1368"><span class="MJXp-mo" id="MJXp-Span-1369" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">n</span><span class="MJXp-mo" id="MJXp-Span-1376">−</span><span class="MJXp-mn" id="MJXp-Span-1377">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">i</span><span class="MJXp-mo" id="MJXp-Span-1372">=</span><span class="MJXp-mn" id="MJXp-Span-1373">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1380" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">i</span><span class="MJXp-mo" id="MJXp-Span-1382">,</span><span class="MJXp-msubsup" id="MJXp-Span-1383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1385" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">i</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-257">\prod_{i=0}^{n-1}m_ {i,b_{i}}</script> is non-zero only if all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1387"><span class="MJXp-msubsup" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1390" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">i</span><span class="MJXp-mo" id="MJXp-Span-1392">,</span><span class="MJXp-msubsup" id="MJXp-Span-1393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1395" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mn" id="MJXp-Span-1398">0</span></span></span><script type="math/tex" id="MathJax-Element-258">m_ {i,b_{i}} \neq 0</script>, which corresponds to the existence of a cycle cover in the graph.</p><p>We want to construct a directed graph such that the sum of the weights of its cycle covers equals <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">x</span></span></span><script type="math/tex" id="MathJax-Element-259">x</script>. Since the current problem only allows the use of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1401"><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1403">1</span><span class="MJXp-mo" id="MJXp-Span-1404" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1405">0</span><span class="MJXp-mo" id="MJXp-Span-1406" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1407">1</span></span></span><script type="math/tex" id="MathJax-Element-260">-1, 0, 1</script>, the edge weights can only be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1408"><span class="MJXp-mn" id="MJXp-Span-1409">1</span></span></span><script type="math/tex" id="MathJax-Element-261">1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1410"><span class="MJXp-mo" id="MJXp-Span-1411" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1412">1</span></span></span><script type="math/tex" id="MathJax-Element-262">-1</script>, and the contribution of a valid cycle cover to the answer can only be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1413"><span class="MJXp-mn" id="MJXp-Span-1414">1</span></span></span><script type="math/tex" id="MathJax-Element-263">1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1415"><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1417">1</span></span></span><script type="math/tex" id="MathJax-Element-264">-1</script>.</p><p>PS: You can refer to pages 56-58 of <a href="https://ipsc.ksp.sk/2012/real/solutions/booklet.pdf">https://ipsc.ksp.sk/2012/real/solutions/booklet.pdf</a> for more information.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>There might be many ways to construct a legal directed graph. We will demonstrate a method that transforms the problem into constructing a DAG with exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">x</span></span></span><script type="math/tex" id="MathJax-Element-265">x</script> paths from source vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1420"><span class="MJXp-mn" id="MJXp-Span-1421">1</span></span></span><script type="math/tex" id="MathJax-Element-266">1</script> to sink vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">n</span></span></span><script type="math/tex" id="MathJax-Element-267">n</script>.</p><p>For a directed acyclic graph <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">G</span></span></span><script type="math/tex" id="MathJax-Element-268">G</script> with source vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1426"><span class="MJXp-mn" id="MJXp-Span-1427">1</span></span></span><script type="math/tex" id="MathJax-Element-269">1</script> and sink vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">n</span></span></span><script type="math/tex" id="MathJax-Element-270">n</script>, we can construct the following adjacency matrix:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1430"><span class="MJXp-msubsup" id="MJXp-Span-1431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1433" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">i</span><span class="MJXp-mo" id="MJXp-Span-1435">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1438" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1439">1</span></span></span><script type="math/tex" id="MathJax-Element-271">g_{i,j} = -1</script> if there is an edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">i</span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">j</span></span></span><script type="math/tex" id="MathJax-Element-272">i \rightarrow j</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">G</span></span></span><script type="math/tex" id="MathJax-Element-273">G</script>. Set the weight of all original edges in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">G</span></span></span><script type="math/tex" id="MathJax-Element-274">G</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1448"><span class="MJXp-mo" id="MJXp-Span-1449" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1450">1</span></span></span><script type="math/tex" id="MathJax-Element-275">-1</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1451"><span class="MJXp-msubsup" id="MJXp-Span-1452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1454" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">i</span><span class="MJXp-mo" id="MJXp-Span-1456">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1458" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1459">1</span></span></span><script type="math/tex" id="MathJax-Element-276">g_{i,i} = 1</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1460"><span class="MJXp-mn" id="MJXp-Span-1461">1</span><span class="MJXp-mo" id="MJXp-Span-1462" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">i</span><span class="MJXp-mo" id="MJXp-Span-1464" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">n</span></span></span><script type="math/tex" id="MathJax-Element-277">1 < i < n</script>. Add a self-loop with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1466"><span class="MJXp-mn" id="MJXp-Span-1467">1</span></span></span><script type="math/tex" id="MathJax-Element-278">1</script> to all vertices in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">G</span></span></span><script type="math/tex" id="MathJax-Element-279">G</script> except the source and sink.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1470"><span class="MJXp-msubsup" id="MJXp-Span-1471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1473" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">n</span><span class="MJXp-mo" id="MJXp-Span-1475">,</span><span class="MJXp-mn" id="MJXp-Span-1476">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1477" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1478">1</span></span></span><script type="math/tex" id="MathJax-Element-280">g_{n,1} = 1</script>. Add an edge from the sink to the source with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1479"><span class="MJXp-mn" id="MJXp-Span-1480">1</span></span></span><script type="math/tex" id="MathJax-Element-281">1</script>.</li>   <li>Everything else <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1481"><span class="MJXp-mo" id="MJXp-Span-1482" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1483">0</span></span></span><script type="math/tex" id="MathJax-Element-282">= 0</script>.</li> </ul><p>We analyze all cycle covers of this new graph. Due to the presence of the edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">n</span><span class="MJXp-mo" id="MJXp-Span-1486" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mn" id="MJXp-Span-1487">1</span></span></span><script type="math/tex" id="MathJax-Element-283">n \rightarrow 1</script> , any cycle cover must contain a main cycle that includes nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1488"><span class="MJXp-mn" id="MJXp-Span-1489">1</span></span></span><script type="math/tex" id="MathJax-Element-284">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">n</span></span></span><script type="math/tex" id="MathJax-Element-285">n</script>, formed by a path <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">P</span></span></span><script type="math/tex" id="MathJax-Element-286">P</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1494"><span class="MJXp-mn" id="MJXp-Span-1495">1</span></span></span><script type="math/tex" id="MathJax-Element-287">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">n</span></span></span><script type="math/tex" id="MathJax-Element-288">n</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">G</span></span></span><script type="math/tex" id="MathJax-Element-289">G</script> and the edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">n</span><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mn" id="MJXp-Span-1503">1</span></span></span><script type="math/tex" id="MathJax-Element-290">n \rightarrow 1</script>. For nodes not on path <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">P</span></span></span><script type="math/tex" id="MathJax-Element-291">P</script> (i.e., intermediate nodes not covered by path <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">P</span></span></span><script type="math/tex" id="MathJax-Element-292">P</script>), they must be covered by self-loops with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1508"><span class="MJXp-mn" id="MJXp-Span-1509">1</span></span></span><script type="math/tex" id="MathJax-Element-293">1</script>. Therefore, each cycle cover uniquely corresponds to a path <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">P</span></span></span><script type="math/tex" id="MathJax-Element-294">P</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1512"><span class="MJXp-mn" id="MJXp-Span-1513">1</span></span></span><script type="math/tex" id="MathJax-Element-295">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">n</span></span></span><script type="math/tex" id="MathJax-Element-296">n</script>.</p><p>Since there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">x</span></span></span><script type="math/tex" id="MathJax-Element-297">x</script> paths in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">G</span></span></span><script type="math/tex" id="MathJax-Element-298">G</script>, we only need to ensure that the contribution of each cycle cover is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1520"><span class="MJXp-mn" id="MJXp-Span-1521">1</span></span></span><script type="math/tex" id="MathJax-Element-299">1</script> to obtain a determinant value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">x</span></span></span><script type="math/tex" id="MathJax-Element-300">x</script>. Next, we will analyze how to achieve this by setting the weight of all original edges in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">G</span></span></span><script type="math/tex" id="MathJax-Element-301">G</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1526"><span class="MJXp-mo" id="MJXp-Span-1527" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1528">1</span></span></span><script type="math/tex" id="MathJax-Element-302">-1</script>.</p><p>For each cycle cover, first consider the product of all edge weights:</p> <ul>   <li>The main cycle has <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">k</span></span></span><script type="math/tex" id="MathJax-Element-303">k</script> edges, among which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">k</span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1534">1</span></span></span><script type="math/tex" id="MathJax-Element-304">k-1</script> edges come from path <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">P</span></span></span><script type="math/tex" id="MathJax-Element-305">P</script> (each with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1537"><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1539">1</span></span></span><script type="math/tex" id="MathJax-Element-306">-1</script>), and one edge is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">n</span><span class="MJXp-mo" id="MJXp-Span-1542" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mn" id="MJXp-Span-1543">1</span></span></span><script type="math/tex" id="MathJax-Element-307">n \rightarrow 1</script> (with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1544"><span class="MJXp-mn" id="MJXp-Span-1545">1</span></span></span><script type="math/tex" id="MathJax-Element-308">1</script>). Thus, the product term is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1546"><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1549">1</span><span class="MJXp-msubsup" id="MJXp-Span-1550"><span class="MJXp-mo" id="MJXp-Span-1551" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1552" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">k</span><span class="MJXp-mo" id="MJXp-Span-1554">−</span><span class="MJXp-mn" id="MJXp-Span-1555">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-309">(-1)^{k-1}</script>.</li>   <li>The weights of all other self-loops are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1556"><span class="MJXp-mn" id="MJXp-Span-1557">1</span></span></span><script type="math/tex" id="MathJax-Element-310">1</script>.</li> </ul><p>Therefore, the product of all edge weights is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1558"><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1561">1</span><span class="MJXp-msubsup" id="MJXp-Span-1562"><span class="MJXp-mo" id="MJXp-Span-1563" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1564" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">k</span><span class="MJXp-mo" id="MJXp-Span-1566">−</span><span class="MJXp-mn" id="MJXp-Span-1567">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-311">(-1)^{k-1}</script>.</p><p>Then we consider the sign term <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1568"><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1571">1</span><span class="MJXp-msubsup" id="MJXp-Span-1572"><span class="MJXp-mo" id="MJXp-Span-1573" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1574" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-1575"><span class="MJXp-mi" id="MJXp-Span-1576">i</span><span class="MJXp-mi" id="MJXp-Span-1577">n</span><span class="MJXp-mi" id="MJXp-Span-1578">v</span></span><span class="MJXp-mo" id="MJXp-Span-1579">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">B</span><span class="MJXp-mo" id="MJXp-Span-1581">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-312">(-1)^{\mathrm{inv}(B)}</script>. In fact, the parity of the number of inversions <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1582"><span class="MJXp-mrow" id="MJXp-Span-1583"><span class="MJXp-mi" id="MJXp-Span-1584">i</span><span class="MJXp-mi" id="MJXp-Span-1585">n</span><span class="MJXp-mi" id="MJXp-Span-1586">v</span></span><span class="MJXp-mo" id="MJXp-Span-1587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">B</span><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-313">\mathrm{inv}(B)</script> in the permutation is consistent with the parity of the number of even cycles in the permutation. The main cycle is a cycle of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">k</span></span></span><script type="math/tex" id="MathJax-Element-314">k</script>, and the self-loops are all cycles of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1592"><span class="MJXp-mn" id="MJXp-Span-1593">1</span></span></span><script type="math/tex" id="MathJax-Element-315">1</script>. Therefore, the sign term is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1594"><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1597">1</span><span class="MJXp-msubsup" id="MJXp-Span-1598"><span class="MJXp-mo" id="MJXp-Span-1599" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1600" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">k</span><span class="MJXp-mo" id="MJXp-Span-1602">−</span><span class="MJXp-mn" id="MJXp-Span-1603">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-316">(-1)^{k-1}</script>.</p><p>Thus, the contribution of each cycle cover is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1604"><span class="MJXp-mo" id="MJXp-Span-1605" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1606" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1607">1</span><span class="MJXp-msubsup" id="MJXp-Span-1608"><span class="MJXp-mo" id="MJXp-Span-1609" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1610" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">k</span><span class="MJXp-mo" id="MJXp-Span-1612">−</span><span class="MJXp-mn" id="MJXp-Span-1613">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1614" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1616" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1617">1</span><span class="MJXp-msubsup" id="MJXp-Span-1618"><span class="MJXp-mo" id="MJXp-Span-1619" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1620" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">k</span><span class="MJXp-mo" id="MJXp-Span-1622">−</span><span class="MJXp-mn" id="MJXp-Span-1623">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1625">1</span></span></span><script type="math/tex" id="MathJax-Element-317">(-1)^{k-1} \cdot (-1)^{k-1}=1</script>.</p><p>Due to the constraints in the problem that the matrix size is at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1626"><span class="MJXp-mn" id="MJXp-Span-1627">80</span></span></span><script type="math/tex" id="MathJax-Element-318">80</script> and there are at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1628"><span class="MJXp-mn" id="MJXp-Span-1629">3</span></span></span><script type="math/tex" id="MathJax-Element-319">3</script> non-zero entries per row and column, we need to construct a DAG that satisfies:</p> <ul>   <li>Exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">x</span></span></span><script type="math/tex" id="MathJax-Element-320">x</script> paths from source vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1632"><span class="MJXp-mn" id="MJXp-Span-1633">1</span></span></span><script type="math/tex" id="MathJax-Element-321">1</script> to sink vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">n</span></span></span><script type="math/tex" id="MathJax-Element-322">n</script>.</li>   <li>At most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1636"><span class="MJXp-mn" id="MJXp-Span-1637">80</span></span></span><script type="math/tex" id="MathJax-Element-323">80</script> nodes.</li>   <li>The in-degree of each node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1638"><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1640">2</span></span></span><script type="math/tex" id="MathJax-Element-324">\le 2</script> and the out-degree of each node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1641"><span class="MJXp-mo" id="MJXp-Span-1642" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1643">2</span></span></span><script type="math/tex" id="MathJax-Element-325">\le 2</script>.</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1644"><span class="MJXp-mn" id="MJXp-Span-1645">80</span></span></span><script type="math/tex" id="MathJax-Element-326">80</script> is a loose boundary, there might be many constructions that satisfy it. We will introduce a construction method that encodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">x</span></span></span><script type="math/tex" id="MathJax-Element-327">x</script> in base three.</p><p>The basic unit shown in the figure can form a base-three digit because the number of paths from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1648"><span class="MJXp-mn" id="MJXp-Span-1649">1</span></span></span><script type="math/tex" id="MathJax-Element-328">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1650"><span class="MJXp-mn" id="MJXp-Span-1651">3</span></span></span><script type="math/tex" id="MathJax-Element-329">3</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1652"><span class="MJXp-mn" id="MJXp-Span-1653">2</span></span></span><script type="math/tex" id="MathJax-Element-330">2</script>, and from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1654"><span class="MJXp-mn" id="MJXp-Span-1655">1</span></span></span><script type="math/tex" id="MathJax-Element-331">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1656"><span class="MJXp-mn" id="MJXp-Span-1657">4</span></span></span><script type="math/tex" id="MathJax-Element-332">4</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1658"><span class="MJXp-mn" id="MJXp-Span-1659">3</span></span></span><script type="math/tex" id="MathJax-Element-333">3</script>. Node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1660"><span class="MJXp-mn" id="MJXp-Span-1661">4</span></span></span><script type="math/tex" id="MathJax-Element-334">4</script> can be connected to the next unit, forming a chain of units, where each unit corresponds to a base-three digit. Nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1662"><span class="MJXp-mn" id="MJXp-Span-1663">3</span></span></span><script type="math/tex" id="MathJax-Element-335">3</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1664"><span class="MJXp-mn" id="MJXp-Span-1665">4</span></span></span><script type="math/tex" id="MathJax-Element-336">4</script> have one free out-degree, which can contribute to the final answer.</p><p><img alt=" " src="https://codeforces.com/predownloaded/8b/b1/8bb177d55c6f9946d3ba3ad2d809d52d4e2da9b2.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>The example figure below shows how to construct <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1666"><span class="MJXp-mn" id="MJXp-Span-1667">22</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1669">1</span><span class="MJXp-mo" id="MJXp-Span-1670" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1671">3</span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1673">2</span><span class="MJXp-mo" id="MJXp-Span-1674" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1675"><span class="MJXp-mn" id="MJXp-Span-1676" style="margin-right: 0.05em;">3</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1677" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-337">22=1+3+2 \cdot 3^2</script> in this way. There are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1678"><span class="MJXp-msubsup" id="MJXp-Span-1679"><span class="MJXp-mi" id="MJXp-Span-1680" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1681" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1682" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">n</span></span></span><script type="math/tex" id="MathJax-Element-338">\log_3 n</script> basic units, each with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1684"><span class="MJXp-mn" id="MJXp-Span-1685">4</span></span></span><script type="math/tex" id="MathJax-Element-339">4</script> nodes. The answer chain has at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1686"><span class="MJXp-msubsup" id="MJXp-Span-1687"><span class="MJXp-mi" id="MJXp-Span-1688" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1689" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">n</span></span></span><script type="math/tex" id="MathJax-Element-340">\log_3 n</script> nodes. Therefore, the total number of nodes is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1692"><span class="MJXp-mn" id="MJXp-Span-1693">5</span><span class="MJXp-msubsup" id="MJXp-Span-1694"><span class="MJXp-mi" id="MJXp-Span-1695" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1696" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">n</span><span class="MJXp-mo" id="MJXp-Span-1699" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">O</span><span class="MJXp-mo" id="MJXp-Span-1701" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1702">1</span><span class="MJXp-mo" id="MJXp-Span-1703" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-341">5\log_3 n + O(1)</script>, which can pass the problem.</p><p><img alt=" " src="https://codeforces.com/predownloaded/c3/ae/c3aef65143ebe908453ebf2cd1a515c1057222f4.png" style="max-width: 100.0%;max-height: 100.0%;"></p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln"> 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N</span><span class="pun">=</span><span class="lit">81</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">][</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
vector</span><span class="pun">&lt;</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;&gt;</span><span class="pln"> e</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    e</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">({</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">});</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> make_matrix</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">]:</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">y</span><span class="pun">]=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> _</span><span class="pun">;</span><span class="pln"> scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">_</span><span class="pun">);</span><span class="pln"> </span><span class="com">//cin&gt;&gt;_;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> max_bit</span><span class="pun">=</span><span class="lit">15</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">_</span><span class="pun">--){</span><span class="pln">
        memset</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">a</span><span class="pun">));</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">max_bit</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">2</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">2</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">3</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">3</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">4</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">3</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">2</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">4</span><span class="pun">);</span><span class="pln">
            n</span><span class="pun">+=</span><span class="lit">4</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln">bit_1</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">bit_2</span><span class="pun">=</span><span class="lit">4</span><span class="pun">;</span><span class="pln"> scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">x</span><span class="pun">);</span><span class="pln"> </span><span class="pun">++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">max_bit</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">%</span><span class="lit">3</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">bit_1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">),</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">%</span><span class="lit">3</span><span class="pun">==</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">bit_2</span><span class="pun">,</span><span class="pln">n</span><span class="pun">),</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
            bit_1</span><span class="pun">+=</span><span class="lit">4</span><span class="pun">;</span><span class="pln"> bit_2</span><span class="pun">+=</span><span class="lit">4</span><span class="pun">;</span><span class="pln"> x</span><span class="pun">/=</span><span class="lit">3</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        make_matrix</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> n </span><span class="pun">&lt;&lt;</span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> r </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> r</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> c </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> c</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                printf</span><span class="pun">(</span><span class="str">"%d "</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">r</span><span class="pun">][</span><span class="pln">c</span><span class="pun">]);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution 2</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>We can consider using Tridiagonal Matrices, where the advantage lies in transforming the calculation of the determinant value into a recursive formula.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1704"><span class="MJXp-msubsup" id="MJXp-Span-1705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1707" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">i</span><span class="MJXp-mo" id="MJXp-Span-1709">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-342">d_{i,j}</script> denote the element in the i-th row and j-th column of matrix <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712">D</span></span></span><script type="math/tex" id="MathJax-Element-343">D</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1713"><span class="MJXp-msubsup" id="MJXp-Span-1714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1716" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-344">D_k</script> represents the submatrix composed of the upper-left <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">k</span><span class="MJXp-mo" id="MJXp-Span-1719" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">k</span></span></span><script type="math/tex" id="MathJax-Element-345">k \times k</script> elements, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1721"><span class="MJXp-msubsup" id="MJXp-Span-1722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1724" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-346">A_k</script> denotes the determinant value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1725"><span class="MJXp-msubsup" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1728" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-347">D_k</script>.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">k</span><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1732">2</span></span></span><script type="math/tex" id="MathJax-Element-348">k \ge 2</script>, there are two ways to obtain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1733"><span class="MJXp-msubsup" id="MJXp-Span-1734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1736" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">k</span><span class="MJXp-mo" id="MJXp-Span-1738">+</span><span class="MJXp-mn" id="MJXp-Span-1739">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-349">D_{k+1}</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1740"><span class="MJXp-msubsup" id="MJXp-Span-1741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1743" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-350">D_k</script>:</p> <ul>   <li>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1744"><span class="MJXp-msubsup" id="MJXp-Span-1745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1747" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">k</span><span class="MJXp-mo" id="MJXp-Span-1749">+</span><span class="MJXp-mn" id="MJXp-Span-1750">1</span><span class="MJXp-mo" id="MJXp-Span-1751">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">k</span><span class="MJXp-mo" id="MJXp-Span-1753">+</span><span class="MJXp-mn" id="MJXp-Span-1754">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1755" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1756">1</span><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1760" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">k</span><span class="MJXp-mo" id="MJXp-Span-1762">+</span><span class="MJXp-mn" id="MJXp-Span-1763">1</span><span class="MJXp-mo" id="MJXp-Span-1764">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1767">1</span><span class="MJXp-mo" id="MJXp-Span-1768" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1771" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">k</span><span class="MJXp-mo" id="MJXp-Span-1773">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">k</span><span class="MJXp-mo" id="MJXp-Span-1775">+</span><span class="MJXp-mn" id="MJXp-Span-1776">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1777" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1778">1</span></span></span><script type="math/tex" id="MathJax-Element-351"> d_{k+1,k+1}=1, d_{k+1,k}=1,d_{k,k+1}=1</script> to get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1779"><span class="MJXp-msubsup" id="MJXp-Span-1780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1782" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">k</span><span class="MJXp-mo" id="MJXp-Span-1784">+</span><span class="MJXp-mn" id="MJXp-Span-1785">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1786" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1789" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1790" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1793" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">k</span><span class="MJXp-mo" id="MJXp-Span-1795">−</span><span class="MJXp-mn" id="MJXp-Span-1796">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-352">A_{k+1}=A_k-A_{k-1}</script></li>   <li>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1797"><span class="MJXp-msubsup" id="MJXp-Span-1798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1800" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">k</span><span class="MJXp-mo" id="MJXp-Span-1802">+</span><span class="MJXp-mn" id="MJXp-Span-1803">1</span><span class="MJXp-mo" id="MJXp-Span-1804">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">k</span><span class="MJXp-mo" id="MJXp-Span-1806">+</span><span class="MJXp-mn" id="MJXp-Span-1807">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1808" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1809">1</span><span class="MJXp-mo" id="MJXp-Span-1810" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1813" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814">k</span><span class="MJXp-mo" id="MJXp-Span-1815">+</span><span class="MJXp-mn" id="MJXp-Span-1816">1</span><span class="MJXp-mo" id="MJXp-Span-1817">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1819" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1820">1</span><span class="MJXp-mo" id="MJXp-Span-1821" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1824" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">k</span><span class="MJXp-mo" id="MJXp-Span-1826">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">k</span><span class="MJXp-mo" id="MJXp-Span-1828">+</span><span class="MJXp-mn" id="MJXp-Span-1829">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1830" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1832">1</span></span></span><script type="math/tex" id="MathJax-Element-353"> d_{k+1,k+1}=1, d_{k+1,k}=1,d_{k,k+1}=-1</script> to get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1833"><span class="MJXp-msubsup" id="MJXp-Span-1834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1836" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">k</span><span class="MJXp-mo" id="MJXp-Span-1838">+</span><span class="MJXp-mn" id="MJXp-Span-1839">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1840" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1843" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1847" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">k</span><span class="MJXp-mo" id="MJXp-Span-1849">−</span><span class="MJXp-mn" id="MJXp-Span-1850">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-354">A_{k+1}=A_k+A_{k-1}</script></li> </ul><p>Thus, we transform the problem into constructing a sequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1851"><span class="MJXp-msubsup" id="MJXp-Span-1852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1854" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1855" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1856" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1857" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1860" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-355">A_1,\ldots,A_m</script> satisfying:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1861"><span class="MJXp-msubsup" id="MJXp-Span-1862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1864" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1865" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1866"><span class="MJXp-mo" id="MJXp-Span-1867" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1870" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1871"><span class="MJXp-mo" id="MJXp-Span-1872" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1873" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1876" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1878"><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1880"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1882" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1883"><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-356">A_1 = |D_1|, A_2 = |D_2|</script></li>   <li>For any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">k</span><span class="MJXp-mo" id="MJXp-Span-1887" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1888">2</span><span class="MJXp-mo" id="MJXp-Span-1889" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1890">3</span><span class="MJXp-mo" id="MJXp-Span-1891" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1892" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1893" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">m</span><span class="MJXp-mo" id="MJXp-Span-1895" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1896">1</span></span></span><script type="math/tex" id="MathJax-Element-357">k=2,3,\ldots,m-1</script>, one of the following two equations holds: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1897"><span class="MJXp-msubsup" id="MJXp-Span-1898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1900" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">k</span><span class="MJXp-mo" id="MJXp-Span-1902">+</span><span class="MJXp-mn" id="MJXp-Span-1903">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1904" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1907" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1908" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1911" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912">k</span><span class="MJXp-mo" id="MJXp-Span-1913">−</span><span class="MJXp-mn" id="MJXp-Span-1914">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-358">A_{k+1}=A_k-A_{k-1}</script>, or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1915"><span class="MJXp-msubsup" id="MJXp-Span-1916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1918" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919">k</span><span class="MJXp-mo" id="MJXp-Span-1920">+</span><span class="MJXp-mn" id="MJXp-Span-1921">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1922" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1925" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1926" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1929" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1930">k</span><span class="MJXp-mo" id="MJXp-Span-1931">−</span><span class="MJXp-mn" id="MJXp-Span-1932">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-359">A_{k+1}=A_k+A_{k-1}</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1933"><span class="MJXp-msubsup" id="MJXp-Span-1934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1936" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-1937" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1938">n</span><span class="MJXp-mo" id="MJXp-Span-1939" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1940">m</span><span class="MJXp-mo" id="MJXp-Span-1941" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1942">80</span><span class="MJXp-mo" id="MJXp-Span-1943" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-360">A_m=n (m \le 80)</script></li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Consider recursively generating the entire sequence from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1944"><span class="MJXp-msubsup" id="MJXp-Span-1945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1947" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-1948" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949">n</span></span></span><script type="math/tex" id="MathJax-Element-361">A_m=n</script> backwards.</p> <ul>   <li><p>Choose a positive integer as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1950"><span class="MJXp-msubsup" id="MJXp-Span-1951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1952" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1953" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954">m</span><span class="MJXp-mo" id="MJXp-Span-1955">−</span><span class="MJXp-mn" id="MJXp-Span-1956">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-362">A_{m−1}</script>.</p></li>   <li><p>At a certain moment, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1957"><span class="MJXp-msubsup" id="MJXp-Span-1958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1960" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-363">A_k</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1961"><span class="MJXp-msubsup" id="MJXp-Span-1962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1964" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965">k</span><span class="MJXp-mo" id="MJXp-Span-1966">+</span><span class="MJXp-mn" id="MJXp-Span-1967">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-364">A_{k+1}</script>, and obtain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1968"><span class="MJXp-msubsup" id="MJXp-Span-1969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1971" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972">k</span><span class="MJXp-mo" id="MJXp-Span-1973">−</span><span class="MJXp-mn" id="MJXp-Span-1974">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-365">A_{k−1}</script> as follows:</p><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1975"><span class="MJXp-msubsup" id="MJXp-Span-1976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1978" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1979" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1982" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983">k</span><span class="MJXp-mo" id="MJXp-Span-1984">+</span><span class="MJXp-mn" id="MJXp-Span-1985">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-366">A_k > A_{k+1}</script>, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1986"><span class="MJXp-msubsup" id="MJXp-Span-1987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1989" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1990">k</span><span class="MJXp-mo" id="MJXp-Span-1991">−</span><span class="MJXp-mn" id="MJXp-Span-1992">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1993" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1996" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1997" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2000" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001">k</span><span class="MJXp-mo" id="MJXp-Span-2002">+</span><span class="MJXp-mn" id="MJXp-Span-2003">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-367">A_{k-1}=A_k-A_{k+1}</script>; otherwise, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2004"><span class="MJXp-msubsup" id="MJXp-Span-2005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2007" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">k</span><span class="MJXp-mo" id="MJXp-Span-2009">−</span><span class="MJXp-mn" id="MJXp-Span-2010">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2011" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2014" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015">k</span><span class="MJXp-mo" id="MJXp-Span-2016">+</span><span class="MJXp-mn" id="MJXp-Span-2017">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2018" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2021" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-368">A_{k-1}=A_{k+1}-A_k</script></p><p>This ensures that each number in the sequence is a non-negative integer.</p></li>   <li><p>If at some point there exist <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2022"><span class="MJXp-msubsup" id="MJXp-Span-2023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2025" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2026" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2029" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-369">D_1,D_2</script> satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2030"><span class="MJXp-msubsup" id="MJXp-Span-2031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2032" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2033" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2034" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2035"><span class="MJXp-mo" id="MJXp-Span-2036" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2037"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2039" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2040"><span class="MJXp-mo" id="MJXp-Span-2041" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2042" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2044" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2045" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">k</span><span class="MJXp-mo" id="MJXp-Span-2047">+</span><span class="MJXp-mn" id="MJXp-Span-2048">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2049" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2050"><span class="MJXp-mo" id="MJXp-Span-2051" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053" style="margin-right: 0.05em;">D</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2054" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-2055"><span class="MJXp-mo" id="MJXp-Span-2056" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-370">A_k = |D_1|, A_{k+1} = |D_2|</script>, successfully finish the construction.</p></li> </ul><p>For example,if we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2057"><span class="MJXp-msubsup" id="MJXp-Span-2058"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2060" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2062">7</span></span></span><script type="math/tex" id="MathJax-Element-371">A_m=7</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2063"><span class="MJXp-msubsup" id="MJXp-Span-2064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2065" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2066" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">m</span><span class="MJXp-mo" id="MJXp-Span-2068">−</span><span class="MJXp-mn" id="MJXp-Span-2069">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2070" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2071">3</span></span></span><script type="math/tex" id="MathJax-Element-372">A_{m−1}=3</script>, the final sequence will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2072"><span class="MJXp-mn" id="MJXp-Span-2073">1</span><span class="MJXp-mo" id="MJXp-Span-2074" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2075">2</span><span class="MJXp-mo" id="MJXp-Span-2076" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2077">3</span><span class="MJXp-mo" id="MJXp-Span-2078" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2079">1</span><span class="MJXp-mo" id="MJXp-Span-2080" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2081">4</span><span class="MJXp-mo" id="MJXp-Span-2082" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2083">3</span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2085">7</span></span></span><script type="math/tex" id="MathJax-Element-373">1,2,3,1,4,3,7</script>, and we will generate the matrix as</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2086"><span class="MJXp-mrow" id="MJXp-Span-2087"><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.75em;"><span class="MJXp-right MJXp-scale2" style="font-size: 12em; margin-left: -0.25em;">(</span></span><span class="MJXp-mtable" id="MJXp-Span-2089"><span><span class="MJXp-mtr" id="MJXp-Span-2090" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2091" style="text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2092">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2093" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2094" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-2095">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2096" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2097">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2098" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2099">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2100" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2101">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2102" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2103">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2104" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2105">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2106" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2107" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2108">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2109" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2110">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2111" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2112" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-2113">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2114" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2115">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2116" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2117">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2118" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2119">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2120" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2121">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2122" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2123" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2124">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2125" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2126">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2127" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2128">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2129" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2130">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2131" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2132">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2133" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2134">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2135" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2136">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2137" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2138" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2139">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2140" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2141">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2142" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2143">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2144" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2145">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2146" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2147" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-2148">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2149" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2150">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2151" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2152">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2153" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2154" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2155">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2156" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2157">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2158" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2159">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2160" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2161">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2162" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2163">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2164" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2165">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2166" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2167">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2168" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2169" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2170">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2171" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2172">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2173" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2174">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2175" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2176">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2177" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2178">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2179" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2180">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2181" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2182" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-2183">1</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2184" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2185" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2186">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2187" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2188">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2189" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2190">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2191" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2192">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2193" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2194">0</span></span><span class="MJXp-mtd" id="MJXp-Span-2195" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2196">1</span></span><span class="MJXp-mtd" id="MJXp-Span-2197" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-2198">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2199" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.75em;"><span class="MJXp-right MJXp-scale2" style="font-size: 12em; margin-left: -0.25em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-374">\begin{pmatrix} 1 & -1 & 0 & 0 & 0 & 0 & 0 \\ 1 & 1 & -1 & 0 & 0 & 0 & 0 \\ 0 & 1 & 1 & 1 & 0 & 0 & 0 \\ 0 & 0 & 1 & 1 & -1 & 0 & 0 \\ 0 & 0 & 0 & 1 & 1 & 1 & 0 \\ 0 & 0 & 0 & 0 & 1 & 1 & -1 \\ 0 & 0 & 0 & 0 & 0 & 1 & 1 \end{pmatrix}</script></center><p>Denote <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2200"><span class="MJXp-mo" id="MJXp-Span-2201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2203" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2204" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2205" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2207" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2208" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2209">k</span><span class="MJXp-mo" id="MJXp-Span-2210">+</span><span class="MJXp-mn" id="MJXp-Span-2211">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2212" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2213" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2214" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2215">x</span><span class="MJXp-mo" id="MJXp-Span-2216" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217">y</span><span class="MJXp-mo" id="MJXp-Span-2218" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-375">(A_k,A_{k+1})=(x,y)</script>.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">x</span><span class="MJXp-mo" id="MJXp-Span-2221" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2222">y</span></span></span><script type="math/tex" id="MathJax-Element-376">x>y</script>, the recursion process can be written as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2223"><span class="MJXp-mo" id="MJXp-Span-2224" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2225">x</span><span class="MJXp-mo" id="MJXp-Span-2226" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227">y</span><span class="MJXp-mo" id="MJXp-Span-2228" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2229" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-2230" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231">x</span><span class="MJXp-mo" id="MJXp-Span-2232" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233">y</span><span class="MJXp-mo" id="MJXp-Span-2234" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235">x</span><span class="MJXp-mo" id="MJXp-Span-2236" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2237" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-2238" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239">y</span><span class="MJXp-mo" id="MJXp-Span-2240" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2241">x</span><span class="MJXp-mo" id="MJXp-Span-2242" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">y</span><span class="MJXp-mo" id="MJXp-Span-2244" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-377">(x,y) \rightarrow (x-y,x) \rightarrow (y,x-y)</script>, increasing the length of the sequence by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2245"><span class="MJXp-mn" id="MJXp-Span-2246">2</span></span></span><script type="math/tex" id="MathJax-Element-378">2</script>, completing one iteration of subtraction.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248">x</span><span class="MJXp-mo" id="MJXp-Span-2249" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2250">y</span></span></span><script type="math/tex" id="MathJax-Element-379">x \le y</script>, the recursion process can be written as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2251"><span class="MJXp-mo" id="MJXp-Span-2252" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253">x</span><span class="MJXp-mo" id="MJXp-Span-2254" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255">y</span><span class="MJXp-mo" id="MJXp-Span-2256" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2257" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-2258" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">y</span><span class="MJXp-mo" id="MJXp-Span-2260" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261">x</span><span class="MJXp-mo" id="MJXp-Span-2262" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">x</span><span class="MJXp-mo" id="MJXp-Span-2264" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-380">(x,y) \rightarrow (y-x,x)</script>, increasing the length of the sequence by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2265"><span class="MJXp-mn" id="MJXp-Span-2266">1</span></span></span><script type="math/tex" id="MathJax-Element-381">1</script>, completing one iteration of subtraction.</p><p>The process will eventually lead to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2267"><span class="MJXp-mo" id="MJXp-Span-2268" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">x</span><span class="MJXp-mo" id="MJXp-Span-2270" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2271">0</span><span class="MJXp-mo" id="MJXp-Span-2272" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-382">(x,0)</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2273"><span class="MJXp-mo" id="MJXp-Span-2274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2275">0</span><span class="MJXp-mo" id="MJXp-Span-2276" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2277">x</span><span class="MJXp-mo" id="MJXp-Span-2278" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-383">(0,x)</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280">x</span></span></span><script type="math/tex" id="MathJax-Element-384">x</script> is the GCD of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2281"><span class="MJXp-msubsup" id="MJXp-Span-2282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2283" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2284" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-385">A_m</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2285"><span class="MJXp-msubsup" id="MJXp-Span-2286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2287" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2288" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">m</span><span class="MJXp-mo" id="MJXp-Span-2290">−</span><span class="MJXp-mn" id="MJXp-Span-2291">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-386">A_{m−1}</script>.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2292"><span class="MJXp-msubsup" id="MJXp-Span-2293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2294" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2295" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-387">A_m</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2296"><span class="MJXp-msubsup" id="MJXp-Span-2297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2298" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2299" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2300">m</span><span class="MJXp-mo" id="MJXp-Span-2301">−</span><span class="MJXp-mn" id="MJXp-Span-2302">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-388">A_{m−1}</script> are coprime, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2304">x</span><span class="MJXp-mo" id="MJXp-Span-2305" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2306">1</span></span></span><script type="math/tex" id="MathJax-Element-389">x=1</script>, meeting the requirements for the sequence. In fact, we can stop earlier when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2307"><span class="MJXp-mo" id="MJXp-Span-2308" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2309">1</span><span class="MJXp-mo" id="MJXp-Span-2310" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2311">2</span><span class="MJXp-mo" id="MJXp-Span-2312" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-390">(1,2)</script>, and the sequence is still legal.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2313"><span class="MJXp-msubsup" id="MJXp-Span-2314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2315" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2316" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-391">A_m</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2317"><span class="MJXp-msubsup" id="MJXp-Span-2318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2319" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2320" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2321">m</span><span class="MJXp-mo" id="MJXp-Span-2322">−</span><span class="MJXp-mn" id="MJXp-Span-2323">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-392">A_{m−1}</script> are not coprime, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2325">x</span><span class="MJXp-mo" id="MJXp-Span-2326" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-2327">1</span></span></span><script type="math/tex" id="MathJax-Element-393">x>1</script>, and this method can't obtain a sequence that meets the requirements.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>Given <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2328"><span class="MJXp-msubsup" id="MJXp-Span-2329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2330" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2331" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2332" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333">n</span></span></span><script type="math/tex" id="MathJax-Element-394">A_m=n</script>, we need to find a suitable <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2334"><span class="MJXp-msubsup" id="MJXp-Span-2335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2337" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2338">m</span><span class="MJXp-mo" id="MJXp-Span-2339">−</span><span class="MJXp-mn" id="MJXp-Span-2340">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-395">A_{m−1}</script> such that the length of the final sequence is less than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2341"><span class="MJXp-mn" id="MJXp-Span-2342">80</span></span></span><script type="math/tex" id="MathJax-Element-396">80</script>.</p><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2343"><span class="MJXp-mn" id="MJXp-Span-2344">80</span></span></span><script type="math/tex" id="MathJax-Element-397">80</script> is a relaxed constraint, and you only need to find one valid <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2345"><span class="MJXp-msubsup" id="MJXp-Span-2346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2348" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2349">m</span><span class="MJXp-mo" id="MJXp-Span-2350">−</span><span class="MJXp-mn" id="MJXp-Span-2351">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-398">A_{m−1}</script>, you can try various approaches. </p><p>For example, you could enumerate all possibilities within the range <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2352"><span class="MJXp-mo" id="MJXp-Span-2353" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2354">1</span><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">n</span><span class="MJXp-mo" id="MJXp-Span-2357" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2358">1</span><span class="MJXp-mo" id="MJXp-Span-2359" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-399">[1, n-1]</script> for some large <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361">n</span></span></span><script type="math/tex" id="MathJax-Element-400">n</script>, and then discover that there are many valid <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2362"><span class="MJXp-msubsup" id="MJXp-Span-2363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2365" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">m</span><span class="MJXp-mo" id="MJXp-Span-2367">−</span><span class="MJXp-mn" id="MJXp-Span-2368">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-401">A_{m−1}</script> values that meet the criteria. </p><p>If you randomly search for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2369"><span class="MJXp-msubsup" id="MJXp-Span-2370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2372" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2373">m</span><span class="MJXp-mo" id="MJXp-Span-2374">−</span><span class="MJXp-mn" id="MJXp-Span-2375">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-402">A_{m−1}</script> within the range, the expected number of attempts required is very low. In fact, the verification program tested all integers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377">n</span></span></span><script type="math/tex" id="MathJax-Element-403">n</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2378"><span class="MJXp-mn" id="MJXp-Span-2379">10</span></span></span><script type="math/tex" id="MathJax-Element-404">10</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2380"><span class="MJXp-msubsup" id="MJXp-Span-2381"><span class="MJXp-mn" id="MJXp-Span-2382" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2383" style="vertical-align: 0.5em;">7</span></span></span></span><script type="math/tex" id="MathJax-Element-405">10^7</script>, randomly selecting <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2384"><span class="MJXp-mn" id="MJXp-Span-2385">1000</span></span></span><script type="math/tex" id="MathJax-Element-406">1000</script> possible <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2386"><span class="MJXp-msubsup" id="MJXp-Span-2387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2389" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2390">m</span><span class="MJXp-mo" id="MJXp-Span-2391">−</span><span class="MJXp-mn" id="MJXp-Span-2392">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-407">A_{m−1}</script> values for each n and testing them. The results showed that in the worst case (when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2394">n</span><span class="MJXp-mo" id="MJXp-Span-2395" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2396">9827370</span></span></span><script type="math/tex" id="MathJax-Element-408">n = 9827370</script>), there were still <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2397"><span class="MJXp-mn" id="MJXp-Span-2398">24</span></span></span><script type="math/tex" id="MathJax-Element-409">24</script> valid <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2399"><span class="MJXp-msubsup" id="MJXp-Span-2400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2402" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2403">m</span><span class="MJXp-mo" id="MJXp-Span-2404">−</span><span class="MJXp-mn" id="MJXp-Span-2405">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-410">A_{m−1}</script> values that met the requirements out of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2406"><span class="MJXp-mn" id="MJXp-Span-2407">1000</span></span></span><script type="math/tex" id="MathJax-Element-411">1000</script> randomly chosen values.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><p>Code:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> fl</span><span class="pun">[</span><span class="lit">1005</span><span class="pun">],</span><span class="pln">inf</span><span class="pun">=</span><span class="lit">1e9</span><span class="pun">,</span><span class="pln">cnt</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> work</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&amp;&amp;</span><span class="pln">ans</span><span class="pun">&lt;=</span><span class="lit">80</span><span class="pun">){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">ans</span><span class="pun">;</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> inf</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> gen</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="com">//printf("%d\n",work(x,y));</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> seq</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!(</span><span class="pln">x</span><span class="pun">==</span><span class="lit">2</span><span class="pun">&amp;&amp;</span><span class="pln">y</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)){</span><span class="pln">
        tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="com">//x=tmp;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln"> 
        seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">105</span><span class="pun">][</span><span class="lit">105</span><span class="pun">]={</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">(),</span><span class="pln">n</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">()){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()&gt;</span><span class="pln">pre</span><span class="pun">)</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">){</span><span class="pln">
            printf</span><span class="pun">(</span><span class="str">"%d "</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        printf</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> _</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">_</span><span class="pun">;</span><span class="pln"> mt19937 rd</span><span class="pun">(</span><span class="pln">time</span><span class="pun">(</span><span class="lit">0</span><span class="pun">));</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">_</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n0\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n1\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">rd</span><span class="pun">()%(</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">work</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">&lt;=</span><span class="lit">80</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Verification Program:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">#pragma</span><span class="pln"> GCC optimize</span><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span><span class="pln">
</span><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> inf</span><span class="pun">=</span><span class="lit">1e9</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> work</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&amp;&amp;</span><span class="pln">ans</span><span class="pun">&lt;=</span><span class="lit">80</span><span class="pun">){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">ans</span><span class="pun">;</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> inf</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    mt19937 rd</span><span class="pun">(</span><span class="lit">114514</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">=</span><span class="lit">1e7</span><span class="pun">,</span><span class="pln">minn</span><span class="pun">=</span><span class="lit">1e3</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&gt;=</span><span class="lit">5</span><span class="pun">;</span><span class="pln">x</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> _</span><span class="pun">=</span><span class="lit">1e3</span><span class="pun">,</span><span class="pln">c</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">_</span><span class="pun">--){</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">rd</span><span class="pun">()%(</span><span class="pln">x</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">work</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">&lt;=</span><span class="lit">80</span><span class="pun">)</span><span class="pln"> </span><span class="pun">++</span><span class="pln">c</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c</span><span class="pun">&lt;</span><span class="pln">minn</span><span class="pun">)</span><span class="pln"> minn</span><span class="pun">=</span><span class="pln">c</span><span class="pun">,</span><span class="pln">cout</span><span class="pun">&lt;&lt;</span><span class="str">' '</span><span class="pun">&lt;&lt;</span><span class="pln">minn</span><span class="pun">&lt;&lt;</span><span class="str">' '</span><span class="pun">&lt;&lt;</span><span class="pln">x</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">%</span><span class="lit">10000</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> cout</span><span class="pun">&lt;&lt;</span><span class="pln">clock</span><span class="pun">()&lt;&lt;</span><span class="str">'#'</span><span class="pun">&lt;&lt;</span><span class="pln">x</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11928">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11929">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="12">12</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11930">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11931">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11932">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="10">10</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/E2">2139E2 — Determinant Construction (Hard Version)</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/wjy666" title="Master wjy666">wjy666</a> Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/wjy666" title="Master wjy666">wjy666</a></p><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2408"><span class="MJXp-mn" id="MJXp-Span-2409">50</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-412-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-412">50</script> is a very tight constraint, the author did not find a method to construct the DAG for G2 as in Solution 1 of G1. If you have a better solution, please leave a comment below.</p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>In Solution 2, the first two steps remain consistent with G1, but we need a better method to find a suitable <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2410"><span class="MJXp-msubsup" id="MJXp-Span-2411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2412" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2413" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2414">m</span><span class="MJXp-mo" id="MJXp-Span-2415">−</span><span class="MJXp-mn" id="MJXp-Span-2416">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-413">A_{m−1}</script> such that the length of the final sequence is less than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2417"><span class="MJXp-mn" id="MJXp-Span-2418">50</span></span></span><script type="math/tex" id="MathJax-Element-414">50</script>. Randomly searching for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2419"><span class="MJXp-msubsup" id="MJXp-Span-2420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2421" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2422" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2423">m</span><span class="MJXp-mo" id="MJXp-Span-2424">−</span><span class="MJXp-mn" id="MJXp-Span-2425">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-415">A_{m−1}</script> within the range <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2426"><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2428">1</span><span class="MJXp-mo" id="MJXp-Span-2429" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430">n</span><span class="MJXp-mo" id="MJXp-Span-2431" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2432">1</span><span class="MJXp-mo" id="MJXp-Span-2433" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-416">[1, n-1]</script> may result in TLE.</p><p>We noticed that if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2434"><span class="MJXp-msubsup" id="MJXp-Span-2435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2436" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2437" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2438">m</span><span class="MJXp-mo" id="MJXp-Span-2439">−</span><span class="MJXp-mn" id="MJXp-Span-2440">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-417">A_{m−1}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2441"><span class="MJXp-msubsup" id="MJXp-Span-2442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2443" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2444" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-418">A_m</script> are two adjacent fibonacci numbers, the sequence will converge rapidly (with a length within <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2445"><span class="MJXp-mn" id="MJXp-Span-2446">40</span></span></span><script type="math/tex" id="MathJax-Element-419">40</script>). Although not all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2447"><span class="MJXp-msubsup" id="MJXp-Span-2448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2450" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2451" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452">n</span></span></span><script type="math/tex" id="MathJax-Element-420">A_m=n</script> are fibonacci numbers, we can still draw inspiration from this.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution A</b><div class="spoiler-content" style="display: block;"><p>We attempt to decompose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454">n</span></span></span><script type="math/tex" id="MathJax-Element-421">n</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2456">n</span><span class="MJXp-mo" id="MJXp-Span-2457" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2458">a</span><span class="MJXp-mo" id="MJXp-Span-2459" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2460">fib</span><span class="MJXp-mo" id="MJXp-Span-2461" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2462" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2463">i</span><span class="MJXp-mo" id="MJXp-Span-2464" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2465" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2466">b</span><span class="MJXp-mo" id="MJXp-Span-2467" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2468">fib</span><span class="MJXp-mo" id="MJXp-Span-2469" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2470" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2471">i</span><span class="MJXp-mo" id="MJXp-Span-2472" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2473">1</span><span class="MJXp-mo" id="MJXp-Span-2474" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2475" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476">a</span><span class="MJXp-mo" id="MJXp-Span-2477" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478">b</span><span class="MJXp-mo" id="MJXp-Span-2479" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-2480">0</span></span></span><script type="math/tex" id="MathJax-Element-422">n=a \cdot \operatorname{fib}(i)+b \cdot \operatorname{fib}(i-1), a,b \ge 0</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2481"><span class="MJXp-mi" id="MJXp-Span-2482">fib</span><span class="MJXp-mo" id="MJXp-Span-2483" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2484" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485">i</span><span class="MJXp-mo" id="MJXp-Span-2486" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-423">\operatorname{fib}(i)</script> denotes the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2488">i</span></span></span><script type="math/tex" id="MathJax-Element-424">i</script>-th fibonacci number.</p><p>Then, we set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2489"><span class="MJXp-msubsup" id="MJXp-Span-2490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2491" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2492" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493">m</span><span class="MJXp-mo" id="MJXp-Span-2494">−</span><span class="MJXp-mn" id="MJXp-Span-2495">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2496" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2497">a</span><span class="MJXp-mo" id="MJXp-Span-2498" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2499">fib</span><span class="MJXp-mo" id="MJXp-Span-2500" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2501" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502">i</span><span class="MJXp-mo" id="MJXp-Span-2503" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2504">1</span><span class="MJXp-mo" id="MJXp-Span-2505" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2506" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507">b</span><span class="MJXp-mo" id="MJXp-Span-2508" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2509">fib</span><span class="MJXp-mo" id="MJXp-Span-2510" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2511" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2512">i</span><span class="MJXp-mo" id="MJXp-Span-2513" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2514">2</span><span class="MJXp-mo" id="MJXp-Span-2515" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-425">A_{m-1}=a \cdot \operatorname{fib}(i-1)+b \cdot \operatorname{fib}(i-2)</script></p><p>By iterating further, we obtain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2516"><span class="MJXp-msubsup" id="MJXp-Span-2517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2518" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2519" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2520">m</span><span class="MJXp-mo" id="MJXp-Span-2521">−</span><span class="MJXp-mn" id="MJXp-Span-2522">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2523" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2524">a</span><span class="MJXp-mo" id="MJXp-Span-2525" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2526">fib</span><span class="MJXp-mo" id="MJXp-Span-2527" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2528" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2529">i</span><span class="MJXp-mo" id="MJXp-Span-2530" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2531">2</span><span class="MJXp-mo" id="MJXp-Span-2532" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2533" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2534">b</span><span class="MJXp-mo" id="MJXp-Span-2535" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2536">fib</span><span class="MJXp-mo" id="MJXp-Span-2537" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2538" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539">i</span><span class="MJXp-mo" id="MJXp-Span-2540" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2541">3</span><span class="MJXp-mo" id="MJXp-Span-2542" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-426">A_{m-2}=a \cdot \operatorname{fib}(i-2)+b \cdot \operatorname{fib}(i-3)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2543"><span class="MJXp-mo" id="MJXp-Span-2544" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-427">\dots</script></p><p>The purpose of this is to make the iteration process rapidly decrease the value in the initial steps, similar to the fibonacci sequence. Intuitively, the larger the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2546">i</span></span></span><script type="math/tex" id="MathJax-Element-428">i</script> chosen, the higher the probability of finding a legal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2547"><span class="MJXp-msubsup" id="MJXp-Span-2548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2550" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2551">m</span><span class="MJXp-mo" id="MJXp-Span-2552">−</span><span class="MJXp-mn" id="MJXp-Span-2553">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-429">A_{m-1}</script>.</p><p>The author did not provide a rigorous mathematical proof for this, but using a verification program which found a legal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2554"><span class="MJXp-msubsup" id="MJXp-Span-2555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2557" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558">m</span><span class="MJXp-mo" id="MJXp-Span-2559">−</span><span class="MJXp-mn" id="MJXp-Span-2560">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-430">A_{m-1}</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2561"><span class="MJXp-msubsup" id="MJXp-Span-2562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2564" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2565" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2566">n</span><span class="MJXp-mo" id="MJXp-Span-2567" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-2568" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2569">2</span><span class="MJXp-mo" id="MJXp-Span-2570" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2571"><span class="MJXp-mn" id="MJXp-Span-2572" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2573" style="vertical-align: 0.5em;">7</span></span><span class="MJXp-mo" id="MJXp-Span-2574" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-431">A_m=n \in [2,10^7]</script> within one minute. Therefore, it is feasible to prove the correctness of this approach within the data range during the contest.</p> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> fl</span><span class="pun">[</span><span class="lit">1005</span><span class="pun">],</span><span class="pln">inf</span><span class="pun">=</span><span class="lit">1e9</span><span class="pun">,</span><span class="pln">cnt</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> work</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&amp;&amp;</span><span class="pln">ans</span><span class="pun">&lt;=</span><span class="lit">50</span><span class="pun">){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">ans</span><span class="pun">;</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> inf</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> gen</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="com">//printf("%d\n",work(x,y));</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> seq</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!(</span><span class="pln">x</span><span class="pun">==</span><span class="lit">2</span><span class="pun">&amp;&amp;</span><span class="pln">y</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)){</span><span class="pln">
        tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="com">//x=tmp;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln"> 
        seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">55</span><span class="pun">][</span><span class="lit">55</span><span class="pun">]={</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">(),</span><span class="pln">n</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">()){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()&gt;</span><span class="pln">pre</span><span class="pun">)</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">){</span><span class="pln">
            printf</span><span class="pun">(</span><span class="str">"%d "</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        printf</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll fib</span><span class="pun">[</span><span class="lit">55</span><span class="pun">]={</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">};</span><span class="pln">
ll exgcd</span><span class="pun">(</span><span class="pln">ll a</span><span class="pun">,</span><span class="pln">ll b</span><span class="pun">,</span><span class="pln">ll </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">,</span><span class="pln">ll </span><span class="pun">&amp;</span><span class="pln">y</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">b</span><span class="pun">){</span><span class="pln">
		x</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> y</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	ll d</span><span class="pun">=</span><span class="pln">exgcd</span><span class="pun">(</span><span class="pln">b</span><span class="pun">,</span><span class="pln">a</span><span class="pun">%</span><span class="pln">b</span><span class="pun">,</span><span class="pln">y</span><span class="pun">,</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
	y</span><span class="pun">-=(</span><span class="pln">a</span><span class="pun">/</span><span class="pln">b</span><span class="pun">)*</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> d</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> mp</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">50</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> fib</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> _</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">_</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">_</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n0\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n1\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">&lt;=</span><span class="lit">10</span><span class="pun">){</span><span class="pln">
            gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> noww</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">noww</span><span class="pun">]&lt;</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">++</span><span class="pln">noww</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> now</span><span class="pun">=</span><span class="pln">noww</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">now</span><span class="pun">&gt;=</span><span class="lit">3</span><span class="pun">){</span><span class="pln">
            ll a</span><span class="pun">=</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">now</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">b</span><span class="pun">=</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">now</span><span class="pun">-</span><span class="lit">2</span><span class="pun">],</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">,</span><span class="pln">c</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
            ll d</span><span class="pun">=</span><span class="pln">exgcd</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
            x</span><span class="pun">*=</span><span class="pln">c</span><span class="pun">,</span><span class="pln">y</span><span class="pun">*=</span><span class="pln">c</span><span class="pun">;</span><span class="pln">
            </span><span class="com">//find x,y</span><span class="pln">
            x</span><span class="pun">=(</span><span class="pln">x</span><span class="pun">%</span><span class="pln">b</span><span class="pun">+</span><span class="pln">b</span><span class="pun">)%</span><span class="pln">b</span><span class="pun">;</span><span class="pln">  y</span><span class="pun">=(</span><span class="pln">c</span><span class="pun">-</span><span class="pln">a</span><span class="pun">*</span><span class="pln">x</span><span class="pun">)/</span><span class="pln">b</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{--</span><span class="pln">now</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> s</span><span class="pun">=</span><span class="pln">inf</span><span class="pun">,</span><span class="pln">o</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">){</span><span class="pln">
                o</span><span class="pun">=</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">now</span><span class="pun">-</span><span class="lit">2</span><span class="pun">]*</span><span class="pln">x</span><span class="pun">+</span><span class="pln">fib</span><span class="pun">[</span><span class="pln">now</span><span class="pun">-</span><span class="lit">3</span><span class="pun">]*</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
                s</span><span class="pun">=</span><span class="pln">work</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">o</span><span class="pun">);</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">&gt;</span><span class="lit">50</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">x</span><span class="pun">+=</span><span class="pln">b</span><span class="pun">,</span><span class="pln">y</span><span class="pun">-=</span><span class="pln">a</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
                </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">&gt;</span><span class="lit">50</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{--</span><span class="pln">now</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
            </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
                gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">o</span><span class="pun">);</span><span class="pln"> mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="pln">o</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="com">//</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution B</b><div class="spoiler-content" style="display: block;"><p>We note that for the fibonacci sequence, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2575"><span class="MJXp-msubsup" id="MJXp-Span-2576"><span class="MJXp-mo" id="MJXp-Span-2577" style="margin-left: 0.333em; margin-right: 0.05em;">lim</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2578" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2579">x</span><span class="MJXp-mo" id="MJXp-Span-2580">→</span><span class="MJXp-mi" id="MJXp-Span-2581">∞</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2582" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2583">fib</span><span class="MJXp-mo" id="MJXp-Span-2584"></span><span class="MJXp-mo" id="MJXp-Span-2585">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2586">x</span><span class="MJXp-mo" id="MJXp-Span-2587">−</span><span class="MJXp-mn" id="MJXp-Span-2588">1</span><span class="MJXp-mo" id="MJXp-Span-2589">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2590">fib</span><span class="MJXp-mo" id="MJXp-Span-2591"></span><span class="MJXp-mo" id="MJXp-Span-2592">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2593">x</span><span class="MJXp-mo" id="MJXp-Span-2594">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2595" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2596" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-2597"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2598">5</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2599">−</span><span class="MJXp-mn" id="MJXp-Span-2600">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2601">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-432">\lim_{x \to \infty} \frac{\operatorname{fib}(x-1)}{\operatorname{fib}(x)} = \frac{\sqrt 5 -1}{2}</script>, which suggests that searching for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2602"><span class="MJXp-msubsup" id="MJXp-Span-2603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2604" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2605" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2606">m</span><span class="MJXp-mo" id="MJXp-Span-2607">−</span><span class="MJXp-mn" id="MJXp-Span-2608">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-433">A_{m-1}</script> around <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2609"><span class="MJXp-mfrac" id="MJXp-Span-2610" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-2611"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2612">5</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2613">−</span><span class="MJXp-mn" id="MJXp-Span-2614">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2615">2</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2616">n</span></span></span><script type="math/tex" id="MathJax-Element-434">\frac{\sqrt 5 -1}{2}n</script> might be a promising approach.</p><p>In fact, directly enumerating <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2617"><span class="MJXp-msubsup" id="MJXp-Span-2618"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2619" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2620" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621">m</span><span class="MJXp-mo" id="MJXp-Span-2622">−</span><span class="MJXp-mn" id="MJXp-Span-2623">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-435">A_{m-1}</script> starting from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2624"><span class="MJXp-mfrac" id="MJXp-Span-2625" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-2626"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2627">5</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2628">−</span><span class="MJXp-mn" id="MJXp-Span-2629">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2630">2</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2631">n</span></span></span><script type="math/tex" id="MathJax-Element-436">\frac{\sqrt 5 -1}{2}n</script> and trying each one is a efficient method. The author also verified through a verification program that for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2632"><span class="MJXp-msubsup" id="MJXp-Span-2633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2634" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2635" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2636" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2637">n</span><span class="MJXp-mo" id="MJXp-Span-2638" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-2639" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2640">2</span><span class="MJXp-mo" id="MJXp-Span-2641" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2642"><span class="MJXp-mn" id="MJXp-Span-2643" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2644" style="vertical-align: 0.5em;">7</span></span><span class="MJXp-mo" id="MJXp-Span-2645" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-437">A_m=n \in [2,10^7]</script>, a legal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2646"><span class="MJXp-msubsup" id="MJXp-Span-2647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2648" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2649" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2650">m</span><span class="MJXp-mo" id="MJXp-Span-2651">−</span><span class="MJXp-mn" id="MJXp-Span-2652">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-438">A_{m-1}</script> was found within one minute. Thus, it is feasible to prove the correctness of this approach within the data range during the contest.</p><p>Considering that the time limit for this problem is relatively loose (5s), most attempts to search for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2653"><span class="MJXp-msubsup" id="MJXp-Span-2654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2655" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2656" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2657">m</span><span class="MJXp-mo" id="MJXp-Span-2658">−</span><span class="MJXp-mn" id="MJXp-Span-2659">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-439">A_{m-1}</script> around <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2660"><span class="MJXp-mfrac" id="MJXp-Span-2661" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-2662"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2663">5</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2664">−</span><span class="MJXp-mn" id="MJXp-Span-2665">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2666">2</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2667">n</span></span></span><script type="math/tex" id="MathJax-Element-440">\frac{\sqrt 5 -1}{2}n</script> may be able to pass.</p> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> fl</span><span class="pun">[</span><span class="lit">1005</span><span class="pun">],</span><span class="pln">inf</span><span class="pun">=</span><span class="lit">1e9</span><span class="pun">,</span><span class="pln">cnt</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> work</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&amp;&amp;</span><span class="pln">ans</span><span class="pun">&lt;=</span><span class="lit">50</span><span class="pun">){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">ans</span><span class="pun">;</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> inf</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> gen</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
    </span><span class="com">//printf("%d\n",work(x,y));</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> seq</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!(</span><span class="pln">x</span><span class="pun">==</span><span class="lit">2</span><span class="pun">&amp;&amp;</span><span class="pln">y</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)){</span><span class="pln">
        tmp</span><span class="pun">=</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="com">//x=tmp;</span><span class="pln">
        x</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln"> 
        seq</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">55</span><span class="pun">][</span><span class="lit">55</span><span class="pun">]={</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">(),</span><span class="pln">n</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">()){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()&gt;</span><span class="pln">pre</span><span class="pun">)</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        pre</span><span class="pun">=</span><span class="pln">seq</span><span class="pun">.</span><span class="pln">back</span><span class="pun">();</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">){</span><span class="pln">
            printf</span><span class="pun">(</span><span class="str">"%d "</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        printf</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> mp</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> _</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">_</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">_</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n0\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"1\n1\n"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
        </span><span class="kwd">double</span><span class="pln"> s</span><span class="pun">=(</span><span class="pln">sqrt</span><span class="pun">(</span><span class="lit">5</span><span class="pun">)-</span><span class="lit">1.0</span><span class="pun">)/</span><span class="lit">2.0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> st</span><span class="pun">=</span><span class="pln">s</span><span class="pun">*</span><span class="pln">n</span><span class="pun">,</span><span class="pln">l</span><span class="pun">=</span><span class="pln">max</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">st</span><span class="pun">),</span><span class="pln">r</span><span class="pun">=</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="com">//int l=1,r=n-1;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> nowy</span><span class="pun">,</span><span class="pln">nows</span><span class="pun">=</span><span class="lit">50</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">%</span><span class="lit">2</span><span class="pun">==</span><span class="lit">0</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">%</span><span class="lit">2</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">++</span><span class="pln">l</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">l</span><span class="pun">;</span><span class="pln">y</span><span class="pun">&lt;=</span><span class="pln">r</span><span class="pun">;</span><span class="pln">y</span><span class="pun">+=</span><span class="lit">2</span><span class="pun">){</span><span class="pln">
                </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">work</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">&lt;=</span><span class="pln">nows</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln"> mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">l</span><span class="pun">;</span><span class="pln">y</span><span class="pun">&lt;=</span><span class="pln">r</span><span class="pun">;++</span><span class="pln">y</span><span class="pun">){</span><span class="pln">
                </span><span class="kwd">int</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">work</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">&lt;=</span><span class="pln">nows</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">gen</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln"> mp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="pln">y</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11933">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="20">20</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11934">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11935">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11936">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11937">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2138/problem/F">2139F — Ode to the Bridge Builder</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a> Preparation: <a class="rated-user user-red" href="https://codeforces.com/profile/installb" title="Grandmaster installb">installb</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>For convenience, we mark the targets point and the points on the initial segment with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2669">A</span><span class="MJXp-mo" id="MJXp-Span-2670" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2671">0</span><span class="MJXp-mo" id="MJXp-Span-2672" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2673">0</span><span class="MJXp-mo" id="MJXp-Span-2674" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2675" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2676">B</span><span class="MJXp-mo" id="MJXp-Span-2677" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2678">1</span><span class="MJXp-mo" id="MJXp-Span-2679" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2680">0</span><span class="MJXp-mo" id="MJXp-Span-2681" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2682" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2683">C</span><span class="MJXp-mo" id="MJXp-Span-2684" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685">p</span><span class="MJXp-mo" id="MJXp-Span-2686" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2687">q</span><span class="MJXp-mo" id="MJXp-Span-2688" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-441">A(0,0),B(1,0),C(p,q)</script>.</p><p>The problem asks us to do at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2689"><span class="MJXp-mrow" id="MJXp-Span-2690"><span class="MJXp-mo" id="MJXp-Span-2691" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-2692">2</span><span class="MJXp-mrow" id="MJXp-Span-2693"><span class="MJXp-mo" id="MJXp-Span-2694" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2695">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2696">C</span><span class="MJXp-mrow" id="MJXp-Span-2697"><span class="MJXp-mo" id="MJXp-Span-2698" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2699" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-442">\left\lceil 2|AC|\right\rceil</script> moves. This constraint is actually not quite usual. We can first show that the theoretical lower bound should be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2701">x</span><span class="MJXp-mo" id="MJXp-Span-2702" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2703"><span class="MJXp-mo" id="MJXp-Span-2704" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-2705"><span class="MJXp-mo" id="MJXp-Span-2706" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2707">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2708">C</span><span class="MJXp-mrow" id="MJXp-Span-2709"><span class="MJXp-mo" id="MJXp-Span-2710" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2711" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-2712" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-2713"><span class="MJXp-mo" id="MJXp-Span-2714" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-2715"><span class="MJXp-mo" id="MJXp-Span-2716" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2717">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2718">C</span><span class="MJXp-mrow" id="MJXp-Span-2719"><span class="MJXp-mo" id="MJXp-Span-2720" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2721" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-2722" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2723">1</span></span></span><script type="math/tex" id="MathJax-Element-443">x=\left\lceil |AC|\right\rceil+\left\lceil |BC|\right\rceil−1</script>. We can show we can't get less moves by following: If we have already constructed the final structure, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2725">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2726">C</span></span></span><script type="math/tex" id="MathJax-Element-444">AC</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2728">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2729">C</span></span></span><script type="math/tex" id="MathJax-Element-445">BC</script> should be connected with a path, and we can find a path from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2731">A</span></span></span><script type="math/tex" id="MathJax-Element-446">A</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2733">C</span></span></span><script type="math/tex" id="MathJax-Element-447">C</script> and a path from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2735">B</span></span></span><script type="math/tex" id="MathJax-Element-448">B</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2737">C</span></span></span><script type="math/tex" id="MathJax-Element-449">C</script> that don't intersect (except at point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2739">C</span></span></span><script type="math/tex" id="MathJax-Element-450">C</script>), otherwise the structure can't be built with non-degenerate triangles.</p><p>And we have to alternate progressing through two paths every time we construct a triangle, otherwise we must draw a line longer than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2740"><span class="MJXp-mn" id="MJXp-Span-2741">1</span></span></span><script type="math/tex" id="MathJax-Element-451">1</script>. The last triangle will cover both paths, so the number of steps will be decreased by one. The optimal path is two straight segments (which is not always possible).</p><p><strong>Case 1.1:</strong> We first try some simple strategies. Two triangles can form a parallelogram, so we can connect <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2743">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2744">C</span></span></span><script type="math/tex" id="MathJax-Element-452">AC</script>, choose a point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2746">D</span></span></span><script type="math/tex" id="MathJax-Element-453">D</script> on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2748">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2749">C</span></span></span><script type="math/tex" id="MathJax-Element-454">AC</script> which makes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2750"><span class="MJXp-mrow" id="MJXp-Span-2751"><span class="MJXp-mo" id="MJXp-Span-2752" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2753">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2754">D</span><span class="MJXp-mrow" id="MJXp-Span-2755"><span class="MJXp-mo" id="MJXp-Span-2756" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2757" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2758" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2759"><span class="MJXp-mo" id="MJXp-Span-2760">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2761">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2762">C</span><span class="MJXp-mrow" id="MJXp-Span-2763"><span class="MJXp-mo" id="MJXp-Span-2764">|</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-2765">⌈</span><span class="MJXp-mrow" id="MJXp-Span-2766"><span class="MJXp-mo" id="MJXp-Span-2767">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2768">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2769">C</span><span class="MJXp-mrow" id="MJXp-Span-2770"><span class="MJXp-mo" id="MJXp-Span-2771">|</span></span><span class="MJXp-mo" id="MJXp-Span-2772">⌉</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-455">|AD|=\frac{|AC|}{\lceil|AC|\rceil}</script>, which is always in range <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2773"><span class="MJXp-mo" id="MJXp-Span-2774" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2775">0.5</span><span class="MJXp-mo" id="MJXp-Span-2776" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2777">1</span><span class="MJXp-mo" id="MJXp-Span-2778" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-456">[0.5,1]</script> when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2779"><span class="MJXp-mrow" id="MJXp-Span-2780"><span class="MJXp-mo" id="MJXp-Span-2781" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2782">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2783">C</span><span class="MJXp-mrow" id="MJXp-Span-2784"><span class="MJXp-mo" id="MJXp-Span-2785" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2786" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-2787">1</span></span></span><script type="math/tex" id="MathJax-Element-457">|AC|\ge 1</script>. And from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2788"><span class="MJXp-mi" id="MJXp-Span-2789">△</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2790">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2791">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2792">B</span></span></span><script type="math/tex" id="MathJax-Element-458">\triangle ADB</script> we can construct a parallelogram. We draw a line passing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2794">D</span></span></span><script type="math/tex" id="MathJax-Element-459">D</script> that is parallel to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2796">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2797">B</span></span></span><script type="math/tex" id="MathJax-Element-460">AB</script>, a line passing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2799">B</span></span></span><script type="math/tex" id="MathJax-Element-461">B</script> that is parallel to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2801">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2802">C</span></span></span><script type="math/tex" id="MathJax-Element-462">AC</script>, and they intersect at <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2804">E</span></span></span><script type="math/tex" id="MathJax-Element-463">E</script>. Then we pile up the same parallelogram structure until we reach <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2806">C</span></span></span><script type="math/tex" id="MathJax-Element-464">C</script>. This always works when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2807"><span class="MJXp-msubsup" id="MJXp-Span-2808"><span class="MJXp-mn" id="MJXp-Span-2809" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2810" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-2811" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-2812">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2813">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2815">B</span><span class="MJXp-mo" id="MJXp-Span-2816" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2817"><span class="MJXp-mn" id="MJXp-Span-2818" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2819" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-465">30^\circ\le\angle CAB\le60^\circ</script>.</p><p>Proof: We first prove that all segments have length between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2820"><span class="MJXp-mn" id="MJXp-Span-2821">0.5</span></span></span><script type="math/tex" id="MathJax-Element-466">0.5</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2822"><span class="MJXp-mn" id="MJXp-Span-2823">1</span></span></span><script type="math/tex" id="MathJax-Element-467">1</script>. Because we stack the same parallelogram structure, all segments have length equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2825">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2826">B</span><span class="MJXp-mo" id="MJXp-Span-2827" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2828">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2829">D</span></span></span><script type="math/tex" id="MathJax-Element-468">AB,BD</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2831">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2832">D</span></span></span><script type="math/tex" id="MathJax-Element-469">AD</script>. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2834">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2835">B</span></span></span><script type="math/tex" id="MathJax-Element-470">AB</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2837">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2838">D</span></span></span><script type="math/tex" id="MathJax-Element-471">AD</script> already meet the requirement. When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2839"><span class="MJXp-msubsup" id="MJXp-Span-2840"><span class="MJXp-mn" id="MJXp-Span-2841" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2842" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-2843" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-2844">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2845">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2846">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2847">B</span><span class="MJXp-mo" id="MJXp-Span-2848" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2849"><span class="MJXp-mn" id="MJXp-Span-2850" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2851" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-472">30^\circ\le\angle CAB\le60^\circ</script>, the length of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2853">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2854">D</span></span></span><script type="math/tex" id="MathJax-Element-473">BD</script> is at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2855"><span class="MJXp-mn" id="MJXp-Span-2856">0.5</span></span></span><script type="math/tex" id="MathJax-Element-474">0.5</script> as the distance between two parallel lines is at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2857"><span class="MJXp-mn" id="MJXp-Span-2858">0.5</span></span></span><script type="math/tex" id="MathJax-Element-475">0.5</script>, and at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2859"><span class="MJXp-mn" id="MJXp-Span-2860">1</span></span></span><script type="math/tex" id="MathJax-Element-476">1</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2862">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2863">B</span><span class="MJXp-mo" id="MJXp-Span-2864" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2865">1</span></span></span><script type="math/tex" id="MathJax-Element-477">AB=1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2866"><span class="MJXp-mi" id="MJXp-Span-2867">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2869">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2870">B</span></span></span><script type="math/tex" id="MathJax-Element-478">\angle CAB</script> is never the largest angle in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2871"><span class="MJXp-mi" id="MJXp-Span-2872">△</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2873">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2874">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2875">B</span></span></span><script type="math/tex" id="MathJax-Element-479">\triangle DAB</script>. We can calculate that the number of moves we used is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2876"><span class="MJXp-mn" id="MJXp-Span-2877">2</span><span class="MJXp-mrow" id="MJXp-Span-2878"><span class="MJXp-mo" id="MJXp-Span-2879" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-2880"><span class="MJXp-mo" id="MJXp-Span-2881" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2882">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2883">C</span><span class="MJXp-mrow" id="MJXp-Span-2884"><span class="MJXp-mo" id="MJXp-Span-2885" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2886" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-2887" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2888">1</span><span class="MJXp-mo" id="MJXp-Span-2889" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-2890"><span class="MJXp-mo" id="MJXp-Span-2891" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-2892">2</span><span class="MJXp-mrow" id="MJXp-Span-2893"><span class="MJXp-mo" id="MJXp-Span-2894" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2895">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2896">C</span><span class="MJXp-mrow" id="MJXp-Span-2897"><span class="MJXp-mo" id="MJXp-Span-2898" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2899" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-480">2\left\lceil |AC|\right\rceil-1\le\left\lceil 2|AC|\right\rceil</script> which matches the requirement (for the last parallelogram we only need one triangle).</p><p><img alt=" " src="https://codeforces.com/predownloaded/a6/c3/a6c3323e11dddf322cfc8b3188b3564471665a92.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p><strong>Case 1.2:</strong> We can change the way we construct parallelograms (with sides <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2901">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2902">B</span><span class="MJXp-mo" id="MJXp-Span-2903" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2904">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2905">C</span></span></span><script type="math/tex" id="MathJax-Element-481">AB,BC</script>) and this method always works when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2906"><span class="MJXp-msubsup" id="MJXp-Span-2907"><span class="MJXp-mn" id="MJXp-Span-2908" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2909" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-2910" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-2911">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2912">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2913">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2914">x</span><span class="MJXp-mo" id="MJXp-Span-2915" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2916"><span class="MJXp-mn" id="MJXp-Span-2917" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2918" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-482">30^\circ\le\angle CBx\le60^\circ</script>. The number of moves is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2919"><span class="MJXp-mrow" id="MJXp-Span-2920"><span class="MJXp-mo" id="MJXp-Span-2921" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-2922">2</span><span class="MJXp-mrow" id="MJXp-Span-2923"><span class="MJXp-mo" id="MJXp-Span-2924" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2925">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2926">C</span><span class="MJXp-mrow" id="MJXp-Span-2927"><span class="MJXp-mo" id="MJXp-Span-2928" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2929" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-2930" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-2931"><span class="MJXp-mo" id="MJXp-Span-2932" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-2933">2</span><span class="MJXp-mrow" id="MJXp-Span-2934"><span class="MJXp-mo" id="MJXp-Span-2935" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2936">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2937">C</span><span class="MJXp-mrow" id="MJXp-Span-2938"><span class="MJXp-mo" id="MJXp-Span-2939" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2940" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-483">\left\lceil2|BC|\right\rceil\le \left\lceil 2|AC|\right\rceil</script>. This case is actually necessary, which will be explained in the following part.</p><p><img alt=" " src="https://codeforces.com/predownloaded/d5/83/d583339323c45df6492d338f0b207b364d914a94.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p><strong>Case 2:</strong> If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2941"><span class="MJXp-mi" id="MJXp-Span-2942">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2943">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2944">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2945">B</span><span class="MJXp-mo" id="MJXp-Span-2946" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi" id="MJXp-Span-2947">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2948">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2949">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2950">x</span><span class="MJXp-mo" id="MJXp-Span-2951" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2952"><span class="MJXp-mn" id="MJXp-Span-2953" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2954" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-484">\angle CAB< \angle CBx<30^\circ</script>. We first build a point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2956">D</span></span></span><script type="math/tex" id="MathJax-Element-485">D</script> which makes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2958">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2959">D</span><span class="MJXp-mo" id="MJXp-Span-2960" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2961">1</span></span></span><script type="math/tex" id="MathJax-Element-486">AD=1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2962"><span class="MJXp-mi" id="MJXp-Span-2963">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2964">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2965">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2966">B</span><span class="MJXp-mo" id="MJXp-Span-2967" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2968"><span class="MJXp-mn" id="MJXp-Span-2969" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2970" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-487">\angle DAB=30^\circ</script> and construct <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2971"><span class="MJXp-mi" id="MJXp-Span-2972">△</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2973">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2974">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2975">B</span></span></span><script type="math/tex" id="MathJax-Element-488">\triangle DAB</script>. </p><p>We can show that the constraint is actually easier to meet in this situation, because when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2976"><span class="MJXp-mi" id="MJXp-Span-2977">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2978">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2979">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2980">B</span><span class="MJXp-mo" id="MJXp-Span-2981" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi" id="MJXp-Span-2982">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2983">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2984">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2985">x</span><span class="MJXp-mo" id="MJXp-Span-2986" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2987"><span class="MJXp-mn" id="MJXp-Span-2988" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2989" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-489">\angle CAB<\angle CBx<30^\circ</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2990"><span class="MJXp-mrow" id="MJXp-Span-2991"><span class="MJXp-mo" id="MJXp-Span-2992" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2993">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2994">C</span><span class="MJXp-mrow" id="MJXp-Span-2995"><span class="MJXp-mo" id="MJXp-Span-2996" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2997" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mrow" id="MJXp-Span-2998"><span class="MJXp-mo" id="MJXp-Span-2999" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3000">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3001">C</span><span class="MJXp-mrow" id="MJXp-Span-3002"><span class="MJXp-mo" id="MJXp-Span-3003" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3004" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3005">0.5</span></span></span><script type="math/tex" id="MathJax-Element-490">|BC|<|AC|-0.5</script>. With this, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3006"><span class="MJXp-mrow" id="MJXp-Span-3007"><span class="MJXp-mo" id="MJXp-Span-3008" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3009"><span class="MJXp-mo" id="MJXp-Span-3010" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3011">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3012">C</span><span class="MJXp-mrow" id="MJXp-Span-3013"><span class="MJXp-mo" id="MJXp-Span-3014" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3015" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3016" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-3017"><span class="MJXp-mo" id="MJXp-Span-3018" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3019"><span class="MJXp-mo" id="MJXp-Span-3020" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3021">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3022">C</span><span class="MJXp-mrow" id="MJXp-Span-3023"><span class="MJXp-mo" id="MJXp-Span-3024" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3025" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3026" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3027">1</span><span class="MJXp-mo" id="MJXp-Span-3028" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3029"><span class="MJXp-mo" id="MJXp-Span-3030" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3031">2</span><span class="MJXp-mrow" id="MJXp-Span-3032"><span class="MJXp-mo" id="MJXp-Span-3033" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3034">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3035">C</span><span class="MJXp-mrow" id="MJXp-Span-3036"><span class="MJXp-mo" id="MJXp-Span-3037" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3038" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3039" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3040">1</span></span></span><script type="math/tex" id="MathJax-Element-491">\left\lceil |AC|\right\rceil+\left\lceil |BC|\right\rceil−1=\left\lceil 2|AC|\right\rceil-1</script> always holds, allowing us one extra move.</p><p>Then we draw a line passing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3042">D</span></span></span><script type="math/tex" id="MathJax-Element-492">D</script> parallel to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3044">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3045">C</span></span></span><script type="math/tex" id="MathJax-Element-493">BC</script>. We can show that if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3046"><span class="MJXp-mi" id="MJXp-Span-3047">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3048">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3049">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3050">B</span><span class="MJXp-mo" id="MJXp-Span-3051" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3052"><span class="MJXp-mn" id="MJXp-Span-3053" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3054" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-494">\angle DAB=30^\circ</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3055"><span class="MJXp-mn" id="MJXp-Span-3056">0</span><span class="MJXp-mo" id="MJXp-Span-3057" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-3058">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3059">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3060">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3061">B</span><span class="MJXp-mo" id="MJXp-Span-3062" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-3063"><span class="MJXp-mn" id="MJXp-Span-3064" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3065" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-495">0\le \angle CAB\le 30^\circ</script>, the distance from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3067">D</span></span></span><script type="math/tex" id="MathJax-Element-496">D</script> to line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3068"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3069">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3070">C</span></span></span><script type="math/tex" id="MathJax-Element-497">BC</script> is at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3071"><span class="MJXp-mn" id="MJXp-Span-3072">0.5</span></span></span><script type="math/tex" id="MathJax-Element-498">0.5</script>. So all segments with ends on different lines will have length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3073"><span class="MJXp-mo" id="MJXp-Span-3074" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-3075">0.5</span></span></span><script type="math/tex" id="MathJax-Element-499">\ge 0.5</script>.</p><p>Then we select a point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3077">E</span></span></span><script type="math/tex" id="MathJax-Element-500">E</script> on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3079">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3080">C</span></span></span><script type="math/tex" id="MathJax-Element-501">BC</script>, which makes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3082">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3083">E</span><span class="MJXp-mo" id="MJXp-Span-3084" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3085">1</span></span></span><script type="math/tex" id="MathJax-Element-502">DE=1</script>. We can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3086"><span class="MJXp-msqrt" id="MJXp-Span-3087"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3088">3</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3089" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3090">1</span><span class="MJXp-mo" id="MJXp-Span-3091" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-3092"><span class="MJXp-mo" id="MJXp-Span-3093" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3094">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3095">E</span><span class="MJXp-mrow" id="MJXp-Span-3096"><span class="MJXp-mo" id="MJXp-Span-3097" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3098" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3099">1</span></span></span><script type="math/tex" id="MathJax-Element-503">\sqrt{3}-1\le |BE|\le 1</script> based on some calculations in this case. Then we do a similar parallelogram construction process to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3101">C</span></span></span><script type="math/tex" id="MathJax-Element-504">C</script>. The total number of moves is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3102"><span class="MJXp-mn" id="MJXp-Span-3103">2</span><span class="MJXp-mrow" id="MJXp-Span-3104"><span class="MJXp-mo" id="MJXp-Span-3105" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3106"><span class="MJXp-mo" id="MJXp-Span-3107" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3108">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3109">E</span><span class="MJXp-mrow" id="MJXp-Span-3110"><span class="MJXp-mo" id="MJXp-Span-3111" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3112" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3113" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3114">2</span></span></span><script type="math/tex" id="MathJax-Element-505">2\left\lceil |CE|\right\rceil+2</script>.</p><p>There are still two cases here to analyze to prove the number of steps fulfills our requirement. We write <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3115"><span class="MJXp-mrow" id="MJXp-Span-3116"><span class="MJXp-mo" id="MJXp-Span-3117" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3118">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3119">C</span><span class="MJXp-mrow" id="MJXp-Span-3120"><span class="MJXp-mo" id="MJXp-Span-3121" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3122" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3123">a</span><span class="MJXp-mo" id="MJXp-Span-3124" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3125">b</span></span></span><script type="math/tex" id="MathJax-Element-506">|BC|=a+b</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3127">a</span></span></span><script type="math/tex" id="MathJax-Element-507">a</script> is the integer part of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3128"><span class="MJXp-mrow" id="MJXp-Span-3129"><span class="MJXp-mo" id="MJXp-Span-3130" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3131">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3132">C</span><span class="MJXp-mrow" id="MJXp-Span-3133"><span class="MJXp-mo" id="MJXp-Span-3134" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-508">|BC|</script>, then we analyze cases about <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3136">b</span></span></span><script type="math/tex" id="MathJax-Element-509">b</script>.</p> <ul>   <li><p>Case 2.1: When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3138">b</span><span class="MJXp-mo" id="MJXp-Span-3139" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msqrt" id="MJXp-Span-3140"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3141">3</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3142" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3143">1</span></span></span><script type="math/tex" id="MathJax-Element-510">b\ge\sqrt{3}-1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3145">b</span><span class="MJXp-mo" id="MJXp-Span-3146" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3147">0</span></span></span><script type="math/tex" id="MathJax-Element-511">b=0</script>, we can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3148"><span class="MJXp-mn" id="MJXp-Span-3149">2</span><span class="MJXp-mrow" id="MJXp-Span-3150"><span class="MJXp-mo" id="MJXp-Span-3151" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3152"><span class="MJXp-mo" id="MJXp-Span-3153" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3154">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3155">C</span><span class="MJXp-mrow" id="MJXp-Span-3156"><span class="MJXp-mo" id="MJXp-Span-3157" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3158" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3159" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3160"><span class="MJXp-mo" id="MJXp-Span-3161" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3162">2</span><span class="MJXp-mrow" id="MJXp-Span-3163"><span class="MJXp-mo" id="MJXp-Span-3164" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3165">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3166">C</span><span class="MJXp-mrow" id="MJXp-Span-3167"><span class="MJXp-mo" id="MJXp-Span-3168" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3169" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-512">2\left\lceil |AC|\right\rceil=\left\lceil 2|AC|\right\rceil</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3170"><span class="MJXp-mrow" id="MJXp-Span-3171"><span class="MJXp-mo" id="MJXp-Span-3172" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3173"><span class="MJXp-mo" id="MJXp-Span-3174" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3175">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3176">C</span><span class="MJXp-mrow" id="MJXp-Span-3177"><span class="MJXp-mo" id="MJXp-Span-3178" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3179" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3180" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3181"><span class="MJXp-mo" id="MJXp-Span-3182" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3183"><span class="MJXp-mo" id="MJXp-Span-3184" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3185">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3186">C</span><span class="MJXp-mrow" id="MJXp-Span-3187"><span class="MJXp-mo" id="MJXp-Span-3188" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3189" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3190" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3191">1</span></span></span><script type="math/tex" id="MathJax-Element-513">\left\lceil |AC|\right\rceil=\left\lceil |BC|\right\rceil+1</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3192"><span class="MJXp-mrow" id="MJXp-Span-3193"><span class="MJXp-mo" id="MJXp-Span-3194" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3195">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3196">C</span><span class="MJXp-mrow" id="MJXp-Span-3197"><span class="MJXp-mo" id="MJXp-Span-3198" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3199" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-3200">2</span></span></span><script type="math/tex" id="MathJax-Element-514">|AC|\ge 2</script>. The number of steps is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3201"><span class="MJXp-mn" id="MJXp-Span-3202">2</span><span class="MJXp-mrow" id="MJXp-Span-3203"><span class="MJXp-mo" id="MJXp-Span-3204" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3205"><span class="MJXp-mo" id="MJXp-Span-3206" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3207">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3208">C</span><span class="MJXp-mrow" id="MJXp-Span-3209"><span class="MJXp-mo" id="MJXp-Span-3210" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3211" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3212" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3213">2</span><span class="MJXp-mo" id="MJXp-Span-3214" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3215">2</span><span class="MJXp-mrow" id="MJXp-Span-3216"><span class="MJXp-mo" id="MJXp-Span-3217" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3218"><span class="MJXp-mo" id="MJXp-Span-3219" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3220">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3221">C</span><span class="MJXp-mrow" id="MJXp-Span-3222"><span class="MJXp-mo" id="MJXp-Span-3223" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3224" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3225" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3226">2</span><span class="MJXp-mo" id="MJXp-Span-3227" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3228">2</span><span class="MJXp-mrow" id="MJXp-Span-3229"><span class="MJXp-mo" id="MJXp-Span-3230" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3231"><span class="MJXp-mo" id="MJXp-Span-3232" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3233">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3234">C</span><span class="MJXp-mrow" id="MJXp-Span-3235"><span class="MJXp-mo" id="MJXp-Span-3236" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3237" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-515">2\left\lceil |EC|\right\rceil+2\le 2\left\lceil |BC|\right\rceil+2=2\left\lceil |AC|\right\rceil</script>.</p></li>   <li><p>Case 2.2: When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3238"><span class="MJXp-mn" id="MJXp-Span-3239">0</span><span class="MJXp-mo" id="MJXp-Span-3240" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3241">b</span><span class="MJXp-mo" id="MJXp-Span-3242" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msqrt" id="MJXp-Span-3243"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3244">3</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3245" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3246">1</span></span></span><script type="math/tex" id="MathJax-Element-516">0<b<\sqrt{3}-1</script>, we can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3247"><span class="MJXp-mrow" id="MJXp-Span-3248"><span class="MJXp-mo" id="MJXp-Span-3249" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3250"><span class="MJXp-mo" id="MJXp-Span-3251" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3252">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3253">C</span><span class="MJXp-mrow" id="MJXp-Span-3254"><span class="MJXp-mo" id="MJXp-Span-3255" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3256" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3257" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3258"><span class="MJXp-mo" id="MJXp-Span-3259" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3260"><span class="MJXp-mo" id="MJXp-Span-3261" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3262">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3263">C</span><span class="MJXp-mrow" id="MJXp-Span-3264"><span class="MJXp-mo" id="MJXp-Span-3265" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3266" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3267" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3268">1</span></span></span><script type="math/tex" id="MathJax-Element-517">\left\lceil |EC|\right\rceil=\left\lceil |BC|\right\rceil-1</script>. The number of steps equals to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3269"><span class="MJXp-mn" id="MJXp-Span-3270">2</span><span class="MJXp-mo" id="MJXp-Span-3271" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3272">2</span><span class="MJXp-mrow" id="MJXp-Span-3273"><span class="MJXp-mo" id="MJXp-Span-3274" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3275"><span class="MJXp-mo" id="MJXp-Span-3276" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3277">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3278">E</span><span class="MJXp-mrow" id="MJXp-Span-3279"><span class="MJXp-mo" id="MJXp-Span-3280" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3281" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3282" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3283">2</span><span class="MJXp-mrow" id="MJXp-Span-3284"><span class="MJXp-mo" id="MJXp-Span-3285" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3286"><span class="MJXp-mo" id="MJXp-Span-3287" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3288">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3289">C</span><span class="MJXp-mrow" id="MJXp-Span-3290"><span class="MJXp-mo" id="MJXp-Span-3291" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3292" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3293" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-3294"><span class="MJXp-mo" id="MJXp-Span-3295" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3296"><span class="MJXp-mo" id="MJXp-Span-3297" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3298">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3299">C</span><span class="MJXp-mrow" id="MJXp-Span-3300"><span class="MJXp-mo" id="MJXp-Span-3301" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3302" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3303" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-3304"><span class="MJXp-mo" id="MJXp-Span-3305" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3306"><span class="MJXp-mo" id="MJXp-Span-3307" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3308">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3309">C</span><span class="MJXp-mrow" id="MJXp-Span-3310"><span class="MJXp-mo" id="MJXp-Span-3311" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3312" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3313" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3314"><span class="MJXp-mo" id="MJXp-Span-3315" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3316">2</span><span class="MJXp-mrow" id="MJXp-Span-3317"><span class="MJXp-mo" id="MJXp-Span-3318" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3319">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3320">C</span><span class="MJXp-mrow" id="MJXp-Span-3321"><span class="MJXp-mo" id="MJXp-Span-3322" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3323" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-518">2+2\left\lceil |CE|\right\rceil=2\left\lceil |BC|\right\rceil\le \left\lceil |AC|\right\rceil+\left\lceil |BC|\right\rceil=\left\lceil 2|AC|\right\rceil</script>. </p></li> </ul><p>Be careful with small cases where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3324"><span class="MJXp-mrow" id="MJXp-Span-3325"><span class="MJXp-mo" id="MJXp-Span-3326" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3327">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3328">C</span><span class="MJXp-mrow" id="MJXp-Span-3329"><span class="MJXp-mo" id="MJXp-Span-3330" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-519">|BC|</script> is too short, which may make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3331"><span class="MJXp-mrow" id="MJXp-Span-3332"><span class="MJXp-mo" id="MJXp-Span-3333" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3334">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3335">F</span><span class="MJXp-mrow" id="MJXp-Span-3336"><span class="MJXp-mo" id="MJXp-Span-3337" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3338" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3339"><span class="MJXp-mo" id="MJXp-Span-3340" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3341">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3342">G</span><span class="MJXp-mrow" id="MJXp-Span-3343"><span class="MJXp-mo" id="MJXp-Span-3344" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3345" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-3346">0.5</span></span></span><script type="math/tex" id="MathJax-Element-520">|DF|=|EG|<0.5</script>.</p><p>Note that there are some cases where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3347"><span class="MJXp-mi" id="MJXp-Span-3348">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3349">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3350">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3351">x</span><span class="MJXp-mo" id="MJXp-Span-3352" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-3353"><span class="MJXp-mn" id="MJXp-Span-3354" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3355" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-521">\angle CBx>30^\circ</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3356"><span class="MJXp-mi" id="MJXp-Span-3357">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3358">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3359">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3360">B</span><span class="MJXp-mo" id="MJXp-Span-3361" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-3362"><span class="MJXp-mn" id="MJXp-Span-3363" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3364" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-522">\angle CAB<30^\circ</script>, where Case 2 strategy doesn't work. So case 1.2 is required.</p><p><img alt=" " src="https://codeforces.com/predownloaded/90/b2/90b2870a0ecc7f858552a5f8066e80cf47cc8494.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p><strong>Case 3:</strong> If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3365"><span class="MJXp-mi" id="MJXp-Span-3366">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3367">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3368">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3369">x</span><span class="MJXp-mo" id="MJXp-Span-3370" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi" id="MJXp-Span-3371">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3372">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3373">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3374">B</span><span class="MJXp-mo" id="MJXp-Span-3375" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-3376"><span class="MJXp-mn" id="MJXp-Span-3377" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3378" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-523">\angle CBx>\angle CAB>60^\circ</script>. We first build a point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3380">D</span></span></span><script type="math/tex" id="MathJax-Element-524">D</script> which makes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3382">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3383">D</span><span class="MJXp-mo" id="MJXp-Span-3384" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3385">1</span></span></span><script type="math/tex" id="MathJax-Element-525">AD=1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3386"><span class="MJXp-mi" id="MJXp-Span-3387">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3388">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3389">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3390">B</span><span class="MJXp-mo" id="MJXp-Span-3391" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3392"><span class="MJXp-mn" id="MJXp-Span-3393" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3394" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-526">\angle DAB=60^\circ</script> and construct <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3395"><span class="MJXp-mi" id="MJXp-Span-3396">△</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3397">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3398">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3399">B</span></span></span><script type="math/tex" id="MathJax-Element-527">\triangle DAB</script>. We write <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3400"><span class="MJXp-mrow" id="MJXp-Span-3401"><span class="MJXp-mo" id="MJXp-Span-3402" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3403">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3404">C</span><span class="MJXp-mrow" id="MJXp-Span-3405"><span class="MJXp-mo" id="MJXp-Span-3406" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3407" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3408">a</span><span class="MJXp-mo" id="MJXp-Span-3409" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3410">b</span></span></span><script type="math/tex" id="MathJax-Element-528">|AC|=a+b</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3412">a</span></span></span><script type="math/tex" id="MathJax-Element-529">a</script> is integer, then we analyze two cases about <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3414">b</span></span></span><script type="math/tex" id="MathJax-Element-530">b</script>.</p><p><strong>Case 3.1:</strong> When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3416">b</span><span class="MJXp-mo" id="MJXp-Span-3417" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-3418">0.5</span></span></span><script type="math/tex" id="MathJax-Element-531">b>0.5</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3420">b</span><span class="MJXp-mo" id="MJXp-Span-3421" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3422">0</span></span></span><script type="math/tex" id="MathJax-Element-532">b=0</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3423"><span class="MJXp-mn" id="MJXp-Span-3424">2</span><span class="MJXp-mrow" id="MJXp-Span-3425"><span class="MJXp-mo" id="MJXp-Span-3426" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3427"><span class="MJXp-mo" id="MJXp-Span-3428" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3429">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3430">C</span><span class="MJXp-mrow" id="MJXp-Span-3431"><span class="MJXp-mo" id="MJXp-Span-3432" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3433" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3434" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3435"><span class="MJXp-mo" id="MJXp-Span-3436" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3437">2</span><span class="MJXp-mrow" id="MJXp-Span-3438"><span class="MJXp-mo" id="MJXp-Span-3439" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3440">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3441">C</span><span class="MJXp-mrow" id="MJXp-Span-3442"><span class="MJXp-mo" id="MJXp-Span-3443" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3444" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-533">2\left\lceil |AC|\right\rceil=\left\lceil 2|AC|\right\rceil</script>. We begin a same parallelogram construction as Case 1 where the sides of parallelogram are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3446">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3447">C</span><span class="MJXp-mo" id="MJXp-Span-3448" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3449">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3450">D</span></span></span><script type="math/tex" id="MathJax-Element-534">BC,BD</script>. We can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3451"><span class="MJXp-msubsup" id="MJXp-Span-3452"><span class="MJXp-mn" id="MJXp-Span-3453" style="margin-right: 0.05em;">30</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3454" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-3455" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-3456">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3457">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3458">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3459">D</span><span class="MJXp-mo" id="MJXp-Span-3460" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-3461"><span class="MJXp-mn" id="MJXp-Span-3462" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3463" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-535">30^\circ\le\angle CBD\le60^\circ</script>. So it is possible to pile up to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3465">C</span></span></span><script type="math/tex" id="MathJax-Element-536">C</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3467">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3468">D</span></span></span><script type="math/tex" id="MathJax-Element-537">BD</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3469"><span class="MJXp-mn" id="MJXp-Span-3470">2</span><span class="MJXp-mrow" id="MJXp-Span-3471"><span class="MJXp-mo" id="MJXp-Span-3472" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3473"><span class="MJXp-mo" id="MJXp-Span-3474" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3475">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3476">C</span><span class="MJXp-mrow" id="MJXp-Span-3477"><span class="MJXp-mo" id="MJXp-Span-3478" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3479" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3480" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3481">1</span></span></span><script type="math/tex" id="MathJax-Element-538">2\left\lceil |BC|\right\rceil-1</script> moves. And in total we need <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3482"><span class="MJXp-mn" id="MJXp-Span-3483">2</span><span class="MJXp-mrow" id="MJXp-Span-3484"><span class="MJXp-mo" id="MJXp-Span-3485" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3486"><span class="MJXp-mo" id="MJXp-Span-3487" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3488">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3489">C</span><span class="MJXp-mrow" id="MJXp-Span-3490"><span class="MJXp-mo" id="MJXp-Span-3491" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3492" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3493" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3494">2</span><span class="MJXp-mrow" id="MJXp-Span-3495"><span class="MJXp-mo" id="MJXp-Span-3496" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3497"><span class="MJXp-mo" id="MJXp-Span-3498" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3499">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3500">C</span><span class="MJXp-mrow" id="MJXp-Span-3501"><span class="MJXp-mo" id="MJXp-Span-3502" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3503" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3504" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3505"><span class="MJXp-mo" id="MJXp-Span-3506" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3507">2</span><span class="MJXp-mrow" id="MJXp-Span-3508"><span class="MJXp-mo" id="MJXp-Span-3509" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3510">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3511">C</span><span class="MJXp-mrow" id="MJXp-Span-3512"><span class="MJXp-mo" id="MJXp-Span-3513" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3514" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-539">2\left\lceil |BC|\right\rceil\le2\left\lceil |AC|\right\rceil=\left\lceil 2|AC|\right\rceil</script> moves.</p><p><img alt=" " src="https://codeforces.com/predownloaded/8c/dc/8cdc022ad3b685b90fac0681039b0ac07a8e8d76.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p><strong>Case 3.2:</strong> When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3515"><span class="MJXp-mn" id="MJXp-Span-3516">0</span><span class="MJXp-mo" id="MJXp-Span-3517" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3518">b</span><span class="MJXp-mo" id="MJXp-Span-3519" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3520">0.5</span></span></span><script type="math/tex" id="MathJax-Element-540">0<b\le 0.5</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3521"><span class="MJXp-mn" id="MJXp-Span-3522">2</span><span class="MJXp-mrow" id="MJXp-Span-3523"><span class="MJXp-mo" id="MJXp-Span-3524" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3525"><span class="MJXp-mo" id="MJXp-Span-3526" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3527">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3528">C</span><span class="MJXp-mrow" id="MJXp-Span-3529"><span class="MJXp-mo" id="MJXp-Span-3530" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3531" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3532" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3533"><span class="MJXp-mo" id="MJXp-Span-3534" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3535">2</span><span class="MJXp-mrow" id="MJXp-Span-3536"><span class="MJXp-mo" id="MJXp-Span-3537" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3538">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3539">C</span><span class="MJXp-mrow" id="MJXp-Span-3540"><span class="MJXp-mo" id="MJXp-Span-3541" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3542" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3543" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3544">1</span></span></span><script type="math/tex" id="MathJax-Element-541">2\left\lceil |AC|\right\rceil=\left\lceil 2|AC|\right\rceil+1</script>. We instead connect <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3546">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3547">D</span></span></span><script type="math/tex" id="MathJax-Element-542">CD</script> and construct parallelogram with sides <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3549">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3550">C</span><span class="MJXp-mo" id="MJXp-Span-3551" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3552">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3553">B</span></span></span><script type="math/tex" id="MathJax-Element-543">DC,DB</script>. We can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3554"><span class="MJXp-msubsup" id="MJXp-Span-3555"><span class="MJXp-mn" id="MJXp-Span-3556" style="margin-right: 0.05em;">120</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3557" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-3558" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi" id="MJXp-Span-3559">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3560">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3561">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3562">B</span><span class="MJXp-mo" id="MJXp-Span-3563" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-3564"><span class="MJXp-mn" id="MJXp-Span-3565" style="margin-right: 0.05em;">150</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3566" style="vertical-align: 0.5em;">∘</span></span></span></span><script type="math/tex" id="MathJax-Element-544">120^\circ\le\angle CDB\le150^\circ</script> so we can still do the parallelogram construction. When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3567"><span class="MJXp-mrow" id="MJXp-Span-3568"><span class="MJXp-mo" id="MJXp-Span-3569" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3570">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3571">C</span><span class="MJXp-mrow" id="MJXp-Span-3572"><span class="MJXp-mo" id="MJXp-Span-3573" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3574" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msqrt" id="MJXp-Span-3575"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3576">3</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-545">|AC|\ge \sqrt{3}</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3577"><span class="MJXp-mrow" id="MJXp-Span-3578"><span class="MJXp-mo" id="MJXp-Span-3579" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3580"><span class="MJXp-mo" id="MJXp-Span-3581" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3582">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3583">D</span><span class="MJXp-mrow" id="MJXp-Span-3584"><span class="MJXp-mo" id="MJXp-Span-3585" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3586" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3587" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3588"><span class="MJXp-mo" id="MJXp-Span-3589" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3590"><span class="MJXp-mo" id="MJXp-Span-3591" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3592">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3593">C</span><span class="MJXp-mrow" id="MJXp-Span-3594"><span class="MJXp-mo" id="MJXp-Span-3595" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-3596"><span class="MJXp-mo" id="MJXp-Span-3597" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3598" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3599" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3600">1</span></span></span><script type="math/tex" id="MathJax-Element-546">\left\lceil |CD|\right\rceil=\left\lceil |AC||\right\rceil-1</script>, making the number of moves <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3601"><span class="MJXp-mn" id="MJXp-Span-3602">2</span><span class="MJXp-mrow" id="MJXp-Span-3603"><span class="MJXp-mo" id="MJXp-Span-3604" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3605"><span class="MJXp-mo" id="MJXp-Span-3606" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3607">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3608">D</span><span class="MJXp-mrow" id="MJXp-Span-3609"><span class="MJXp-mo" id="MJXp-Span-3610" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3611" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3612" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3613">1</span><span class="MJXp-mo" id="MJXp-Span-3614" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3615">2</span><span class="MJXp-mrow" id="MJXp-Span-3616"><span class="MJXp-mo" id="MJXp-Span-3617" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mrow" id="MJXp-Span-3618"><span class="MJXp-mo" id="MJXp-Span-3619" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3620">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3621">C</span><span class="MJXp-mrow" id="MJXp-Span-3622"><span class="MJXp-mo" id="MJXp-Span-3623" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3624" style="margin-left: 0em; margin-right: 0em;">⌉</span></span><span class="MJXp-mo" id="MJXp-Span-3625" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3626">1</span><span class="MJXp-mo" id="MJXp-Span-3627" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3628"><span class="MJXp-mo" id="MJXp-Span-3629" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mn" id="MJXp-Span-3630">2</span><span class="MJXp-mrow" id="MJXp-Span-3631"><span class="MJXp-mo" id="MJXp-Span-3632" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3633">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3634">C</span><span class="MJXp-mrow" id="MJXp-Span-3635"><span class="MJXp-mo" id="MJXp-Span-3636" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-3637" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span></span><script type="math/tex" id="MathJax-Element-547">2\left\lceil |CD|\right\rceil+1=2\left\lceil |AC|\right\rceil-1=\left\lceil 2|AC|\right\rceil</script>. </p><p><img alt=" " src="https://codeforces.com/predownloaded/18/39/18399c9d645d5245f21b9eb4559d9f6361683585.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>Actually case 1.1 is not required, because it is impossible to construct a testcase where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3638"><span class="MJXp-mi" id="MJXp-Span-3639">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3640">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3641">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3642">B</span><span class="MJXp-mo" id="MJXp-Span-3643" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-3644"><span class="MJXp-mn" id="MJXp-Span-3645" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3646" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-3647" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-3648">∠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3649">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3650">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3651">x</span><span class="MJXp-mo" id="MJXp-Span-3652" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-3653"><span class="MJXp-mn" id="MJXp-Span-3654" style="margin-right: 0.05em;">60</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3655" style="vertical-align: 0.5em;">∘</span></span><span class="MJXp-mo" id="MJXp-Span-3656" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3657">0</span><span class="MJXp-mo" id="MJXp-Span-3658" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3659">b</span><span class="MJXp-mo" id="MJXp-Span-3660" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3661">0.5</span></span></span><script type="math/tex" id="MathJax-Element-548">\angle CAB<60^\circ, \angle CBx>60^\circ,0<b\le 0.5</script> and Case 3.2 fails.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> db</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> db pi </span><span class="pun">=</span><span class="pln"> acos</span><span class="pun">(-</span><span class="lit">1.0</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1000005</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> sgn</span><span class="pun">(</span><span class="pln">db x</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">1e-13</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> x </span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1e-13</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">struct</span><span class="pln"> point</span><span class="pun">{</span><span class="pln">
    db x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
    point </span><span class="pun">(</span><span class="pln">db _x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.0</span><span class="pun">,</span><span class="pln">db _y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> x</span><span class="pun">(</span><span class="pln">_x</span><span class="pun">),</span><span class="pln"> y</span><span class="pun">(</span><span class="pln">_y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
point </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> point </span><span class="pun">&amp;</span><span class="pln">p1</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> point </span><span class="pun">&amp;</span><span class="pln">p2</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> point</span><span class="pun">(</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">y </span><span class="pun">+</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
point </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> point </span><span class="pun">&amp;</span><span class="pln">p1</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> point </span><span class="pun">&amp;</span><span class="pln">p2</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> point</span><span class="pun">(</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
point </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">db x</span><span class="pun">,</span><span class="kwd">const</span><span class="pln"> point </span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> point</span><span class="pun">(</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> 
</span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="pun">(</span><span class="pln">point x</span><span class="pun">,</span><span class="pln">point y</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> sgn</span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> y</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> sgn</span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> y</span><span class="pun">.</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> db dot</span><span class="pun">(</span><span class="pln">point p1</span><span class="pun">,</span><span class="pln">point p2</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> p1</span><span class="pun">.</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> p1</span><span class="pun">.</span><span class="pln">y </span><span class="pun">*</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> db det</span><span class="pun">(</span><span class="pln">point p1</span><span class="pun">,</span><span class="pln">point p2</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> p1</span><span class="pun">.</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p1</span><span class="pun">.</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> db len</span><span class="pun">(</span><span class="pln">point p</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> sqrtl</span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">y </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

point project_point</span><span class="pun">(</span><span class="pln">point x</span><span class="pun">,</span><span class="pln">point ya</span><span class="pun">,</span><span class="pln">point yb</span><span class="pun">){</span><span class="pln">
	point v </span><span class="pun">=</span><span class="pln"> yb </span><span class="pun">-</span><span class="pln"> ya</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> ya </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dot</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> ya</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> dot</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln">v</span><span class="pun">))</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

db distp</span><span class="pun">(</span><span class="pln">point x</span><span class="pun">,</span><span class="pln">point ya</span><span class="pun">,</span><span class="pln">point yb</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> fabs</span><span class="pun">(</span><span class="pln">det</span><span class="pun">(</span><span class="pln">ya </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">,</span><span class="pln">yb </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">))</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">yb </span><span class="pun">-</span><span class="pln"> ya</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

point line_circle_intersec_point</span><span class="pun">(</span><span class="pln">point o</span><span class="pun">,</span><span class="pln">point la</span><span class="pun">,</span><span class="pln">point lb</span><span class="pun">){</span><span class="pln">
	db dis </span><span class="pun">=</span><span class="pln"> distp</span><span class="pun">(</span><span class="pln">o</span><span class="pun">,</span><span class="pln">la</span><span class="pun">,</span><span class="pln">lb</span><span class="pun">),</span><span class="pln">l</span><span class="pun">;</span><span class="pln">
	point pj </span><span class="pun">=</span><span class="pln"> project_point</span><span class="pun">(</span><span class="pln">o</span><span class="pun">,</span><span class="pln">la</span><span class="pun">,</span><span class="pln">lb</span><span class="pun">);</span><span class="pln">
	l </span><span class="pun">=</span><span class="pln"> sqrt</span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> dis </span><span class="pun">*</span><span class="pln"> dis</span><span class="pun">);</span><span class="pln">
	point ret </span><span class="pun">=</span><span class="pln"> pj </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">/</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">lb </span><span class="pun">-</span><span class="pln"> la</span><span class="pun">))</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lb </span><span class="pun">-</span><span class="pln"> la</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

tuple </span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
point p</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">target</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> step</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">bool</span><span class="pln"> check</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">set</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">pair </span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> st</span><span class="pun">;</span><span class="pln">
    st</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">({</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">});</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">n </span><span class="pun">&gt;</span><span class="pln"> step</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    db eps_len </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e-8</span><span class="pun">,</span><span class="pln">eps_dis </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e-4</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> fl </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">,</span><span class="pln">w</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">&gt;</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> swap</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">st</span><span class="pun">.</span><span class="pln">find</span><span class="pun">({</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">})</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> st</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0.5</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> eps_len </span><span class="pun">||</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> eps_len</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0.5</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> eps_len </span><span class="pun">||</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> eps_len</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        st</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">({</span><span class="pln">u</span><span class="pun">,</span><span class="pln">w</span><span class="pun">});</span><span class="pln"> st</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">({</span><span class="pln">v</span><span class="pun">,</span><span class="pln">w</span><span class="pun">});</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> target</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> eps_dis</span><span class="pun">)</span><span class="pln"> fl </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve1a</span><span class="pun">(){</span><span class="pln">
    point dir </span><span class="pun">=</span><span class="pln"> target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> split </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1e-9</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> split</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="com">// construct one parallelogram</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> target</span><span class="pun">;</span><span class="pln">
    ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve1b</span><span class="pun">(){</span><span class="pln">
    point dir </span><span class="pun">=</span><span class="pln"> target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> split </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1e-9</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> split</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve2</span><span class="pun">(){</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="pln">sqrt</span><span class="pun">(</span><span class="lit">3.0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="lit">0.5</span><span class="pun">);</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> line_circle_intersec_point</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">],</span><span class="pln">p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">],</span><span class="pln">target</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        p</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]))</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]);</span><span class="pln">
    ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">};</span><span class="pln">
    ans</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">4</span><span class="pun">};</span><span class="pln">
    point dir </span><span class="pun">=</span><span class="pln"> target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">4</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> split </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1e-9</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> split</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve3a</span><span class="pun">(){</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="lit">0.5</span><span class="pun">,</span><span class="pln">sqrt</span><span class="pun">(</span><span class="lit">3.0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
    ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">};</span><span class="pln">
    point dir </span><span class="pun">=</span><span class="pln"> target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> split </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1e-9</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> split</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> target</span><span class="pun">;</span><span class="pln">
    ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve3b</span><span class="pun">(){</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="lit">0.5</span><span class="pun">,</span><span class="pln">sqrt</span><span class="pun">(</span><span class="lit">3.0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
    ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">};</span><span class="pln">
    point dir </span><span class="pun">=</span><span class="pln"> target </span><span class="pun">-</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> split </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1e-9</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> split</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
        </span><span class="pun">++</span><span class="pln"> c</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">/</span><span class="pln"> split</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dir</span><span class="pun">;</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">c</span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> c </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> solve1a</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> solve1b</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> solve2</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> solve3a</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> solve3b</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> TC</span><span class="pun">;</span><span class="pln"> scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">TC</span><span class="pun">);</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">TC </span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> tx</span><span class="pun">,</span><span class="pln">ty</span><span class="pun">;</span><span class="pln">
        scanf</span><span class="pun">(</span><span class="str">"%d %d %d"</span><span class="pun">,&amp;</span><span class="pln">tx</span><span class="pun">,&amp;</span><span class="pln">ty</span><span class="pun">,&amp;</span><span class="pln">step</span><span class="pun">);</span><span class="pln">
        step </span><span class="pun">=</span><span class="pln"> ceil</span><span class="pun">(</span><span class="lit">2.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> sqrt</span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> tx </span><span class="pun">*</span><span class="pln"> tx </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> ty </span><span class="pun">*</span><span class="pln"> ty</span><span class="pun">));</span><span class="pln">
        target </span><span class="pun">=</span><span class="pln"> point</span><span class="pun">(</span><span class="pln">tx</span><span class="pun">,</span><span class="pln">ty</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n </span><span class="pun">=</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
        </span><span class="kwd">assert</span><span class="pun">(</span><span class="pln">n </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
        printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++){</span><span class="pln">
            </span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">,</span><span class="pln">w</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
            printf</span><span class="pun">(</span><span class="str">"%d %d %.12lf %.12lf\n"</span><span class="pun">,</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">,</span><span class="pln">p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">].</span><span class="pln">x</span><span class="pun">,</span><span class="pln">p</span><span class="pun">[</span><span class="pln">w</span><span class="pun">].</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate this problem</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11938">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11939">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11940">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="0">0</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11941">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11942">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


</li> </ul></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2138" class="notice" style="text-decoration: none;">Codeforces Round 1048 (Div. 1)</a> </span>
        </div>
        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2139" class="notice" style="text-decoration: none;">Codeforces Round 1048 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>