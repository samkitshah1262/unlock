<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: 'â–¶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: 'â–¼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/147761" target="_blank">View on Codeforces â†’</a></p>
  
  <div class="ttypography"><h3>Thank you for participating !</h3><p>Special Thanks to <a class="rated-user user-orange" href="https://codeforces.com/profile/hxu10" title="Master hxu10">hxu10</a> for giving me the chance to write the editorial and for <a class="rated-user user-red" href="https://codeforces.com/profile/maomao90" title="International Grandmaster maomao90">maomao90</a> for enhancing the editorial !.</p><p>Editorial of Problems E and F are written by hxu10, and the rest are written by me. I hope they're insightful and concise, please let me hear your opinion about it or any feedback in general ðŸ’™.</p><h4><a href="https://codeforces.com/contest/2156/problem/A" title="Codeforces Round 1061 (Div. 2)">2156A - Pizza Time</a></h4> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-msubsup" id="MJXp-Span-2"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-6"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-8" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-1">m_1 \le m_2</script>, the total number of slices Alice ate is always at least as much as the total number of slices Bob ate. What's optimal construction ?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>We want to try to minimize the difference between the total number of slices Alice ate and the total number of slices Bob ate.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>The optimal construction is to let both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-msubsup" id="MJXp-Span-10"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-12" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-2">m_1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-16" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-3">m_2</script> to be equals to one. The sequence of operations, denoted by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-21" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-23"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-25" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-29" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-4">(m_1, m_2, m_3)</script>, is as follows:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-mstyle" id="MJXp-Span-32"><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-34">1</span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-36">1</span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">n</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-40">2</span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.333em; margin-right: 0.333em;">â†’</span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-44">1</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-46">1</span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">n</span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-50">4</span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0.333em; margin-right: 0.333em;">â†’</span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0em;">â€¦</span></span></span></span><script type="math/tex" id="MathJax-Element-5">\displaystyle (1,1,n-2) \rightarrow (1,1,n-4) \rightarrow \ldots </script></center></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>The general form of the sequence</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-54"><span class="MJXp-mstyle" id="MJXp-Span-55"><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-57">1</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-59">1</span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">n</span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-63">2</span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0.333em; margin-right: 0.333em;">â†’</span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-67">1</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-69">1</span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">n</span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-73">4</span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0.333em; margin-right: 0.333em;">â†’</span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;">â€¦</span></span></span></span><script type="math/tex" id="MathJax-Element-6">\displaystyle (1,1,n-2) \rightarrow (1,1,n-4) \rightarrow \ldots </script></center><p>Note that we're considering the operations when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-77"><span class="MJXp-msubsup" id="MJXp-Span-78"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-80" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-82"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-84" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-86"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-88" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-7">m_1 \le m_2 \le m_3</script>.</p><p>Consider the case where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">n</span></span></span><script type="math/tex" id="MathJax-Element-8">n</script> is even: </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mstyle" id="MJXp-Span-92"><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-94">1</span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-96">1</span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">n</span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-100">2</span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0.333em; margin-right: 0.333em;">â†’</span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-104">1</span><span class="MJXp-mo" id="MJXp-Span-105" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-106">1</span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">n</span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-110">4</span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0.333em; margin-right: 0.333em;">â†’</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.333em; margin-right: 0.333em;">â†’</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-116">1</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-118">1</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-120">2</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-9">\displaystyle (1,1,n-2) \rightarrow (1,1,n-4) \rightarrow \ldots \rightarrow (1,1,2)</script></center><p>The number of operations is the length of the sequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-122"><span class="MJXp-mrow" id="MJXp-Span-123"><span class="MJXp-mn" id="MJXp-Span-124">2</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-126">4</span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-128">6</span><span class="MJXp-mo" id="MJXp-Span-129" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-132">2</span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-134" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-136">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-137" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-138">1</span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-10">{2,4,6,\ldots, 2(\frac{n}{2}-1)}</script> which is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-140"><span class="MJXp-mfrac" id="MJXp-Span-141" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-143">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-145">1</span></span></span><script type="math/tex" id="MathJax-Element-11">\frac{n}{2}-1</script>.</p><p>Consider the case where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">n</span></span></span><script type="math/tex" id="MathJax-Element-12">n</script> is odd: </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-148"><span class="MJXp-mstyle" id="MJXp-Span-149"><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-151">1</span><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-153">1</span><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">n</span><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-157">2</span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0.333em; margin-right: 0.333em;">â†’</span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-161">1</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-163">1</span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">n</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-167">4</span><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0.333em; margin-right: 0.333em;">â†’</span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0.333em; margin-right: 0.333em;">â†’</span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-173">1</span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-175">1</span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-177">1</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-13">\displaystyle (1,1,n-2) \rightarrow (1,1,n-4) \rightarrow \ldots \rightarrow (1,1,1)</script></center><p>The number of operations is the length of the sequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-179"><span class="MJXp-mrow" id="MJXp-Span-180"><span class="MJXp-mn" id="MJXp-Span-181">1</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-183">3</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-185">5</span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-187">7</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-191">2</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0em;">âŒŠ</span><span class="MJXp-mfrac" id="MJXp-Span-194" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-196">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0em; margin-right: 0em;">âŒ‹</span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-199">1</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-202">1</span></span></span></span><script type="math/tex" id="MathJax-Element-14">{1,3,5,7,\ldots, 2(\lfloor \frac{n}{2} \rfloor-1)+1}</script> </p><p>By the representation of odd numbers we've <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-203"><span class="MJXp-mrow" id="MJXp-Span-204"><span class="MJXp-mn" id="MJXp-Span-205">2</span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-207">0</span><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-210">1</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-212">2</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-214">1</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mn" id="MJXp-Span-216">1</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-221">2</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0em;">âŒŠ</span><span class="MJXp-mfrac" id="MJXp-Span-224" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-226">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0em; margin-right: 0em;">âŒ‹</span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-229">1</span><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-232">1</span></span></span></span><script type="math/tex" id="MathJax-Element-15">{2(0)+1,2(1)1+,\ldots, 2(\lfloor \frac{n}{2} \rfloor-1)+1}</script> , which is equivalent to the length of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-233"><span class="MJXp-mrow" id="MJXp-Span-234"><span class="MJXp-mn" id="MJXp-Span-235">0</span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-237">1</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-239">2</span><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mfrac" id="MJXp-Span-243" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">n</span><span class="MJXp-mo" id="MJXp-Span-245">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-246">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-247">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-249">1</span></span></span></span><script type="math/tex" id="MathJax-Element-16">{0,1,2,\ldots, \frac{n-1}{2}-1}</script> which gives the length of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mfrac" id="MJXp-Span-251" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">n</span><span class="MJXp-mo" id="MJXp-Span-253">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-254">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-255">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-17">\frac{n-1}{2}</script>.</p><p>Both cases are equivalent to the close form </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-256"><span class="MJXp-mrow" id="MJXp-Span-257"><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒŠ</span></span><span class="MJXp-mfrac" id="MJXp-Span-259" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">n</span><span class="MJXp-mo" id="MJXp-Span-261">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-262">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-263">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒ‹</span></span></span></span></span><script type="math/tex" id="MathJax-Element-18">\left \lfloor \frac{n-1}{2} \right \rfloor</script></center><p>Complexity <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-265"><span class="MJXp-mrow" id="MJXp-Span-266"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-267">O</span></span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-269">1</span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-19">\mathcal{O}(1)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation 1 (MathModel)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">from</span><span class="pln"> math </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">*</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n</span><span class="pun">=</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">((</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="com">//2)</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
    solve</span><span class="pun">()</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Solution 2</b><div class="spoiler-content" style="display: block;"><p>It's possible to use fair split that's we use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-292"><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0em; margin-right: 0em;">âŒŠ</span><span class="MJXp-mfrac" id="MJXp-Span-294" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-296">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0em;">âŒ‹</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-299" style="margin-left: 0em; margin-right: 0em;">âŒŠ</span><span class="MJXp-mfrac" id="MJXp-Span-300" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-302">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0em; margin-right: 0em;">âŒ‹</span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0em; margin-right: 0em;">âŒŠ</span><span class="MJXp-mfrac" id="MJXp-Span-306" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-308">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0em; margin-right: 0em;">âŒ‹</span><span class="MJXp-mo" id="MJXp-Span-310" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">n</span><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-313">3</span></span></span><script type="math/tex" id="MathJax-Element-20">\lfloor \frac{n}{3} \rfloor , \lfloor \frac{n}{3} \rfloor , \lfloor \frac{n}{3} \rfloor + n \bmod 3</script> and keep simulating with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">n</span><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-319" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-21">n=m_3</script> on steps except the first step until you reach <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-320"><span class="MJXp-msubsup" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-323" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mn" id="MJXp-Span-325">2</span></span></span><script type="math/tex" id="MathJax-Element-22">m_2 \le 2</script>.</p><p>Complexity <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-326"><span class="MJXp-mrow" id="MJXp-Span-327"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-328">O</span></span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-330"><span class="MJXp-mi" id="MJXp-Span-331" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-332" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">n</span><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-23">\mathcal{O}(\log_3(n))</script></p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation 2 (MathModel)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">from</span><span class="pln"> math </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">*</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n</span><span class="pun">=</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
    a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">c</span><span class="pun">=</span><span class="pln">n</span><span class="com">//3,n//3,n//3+(n%3)</span><span class="pln">
    ans</span><span class="pun">=</span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">n</span><span class="pun">&gt;</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        ans</span><span class="pun">+=</span><span class="pln">n</span><span class="com">//3</span><span class="pln">
        n</span><span class="pun">=</span><span class="pln">n</span><span class="com">//3+(n%3)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
    solve</span><span class="pun">()</span><span class="pln">

</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem !</b><div class="spoiler-content" style="display: block;"><p>
<style data-nocturne="true" type="text/css">

</style>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13043">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="274">274</span>
            </i>
        </a>
    </span>

    <script>
        $(function() {
            const likeFormUtil = {};
            likeFormUtil.getCount = function ($count) {
                return Number($count.attr("data-value"));
            };
            likeFormUtil.setCount = function ($count, value) {
                $count.attr("data-value", value);
                $count.text(value);
            };
            likeFormUtil.like = function ($likeForm) {
                $likeForm.find(".likeState").addClass("liked");
                const $likeCount = $likeForm.find(".likeCount");
                likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) + 1);
            };
            likeFormUtil.unLike = function ($likeForm) {
                if ($likeForm.find(".likeState").hasClass("liked")) {
                    $likeForm.find(".likeState").removeClass("liked");
                    const $likeCount = $likeForm.find(".likeCount");
                    likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) - 1);
                }
            };
            likeFormUtil.dislike = function ($likeForm) {
                $likeForm.find(".dislikeState").addClass("disliked");
                const $dislikeCount = $likeForm.find(".dislikeCount");
                likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) + 1);
            };
            likeFormUtil.unDislike = function ($likeForm) {
                if ($likeForm.find(".dislikeState").hasClass("disliked")) {
                    $likeForm.find(".dislikeState").removeClass("disliked");
                    const $dislikeCount = $likeForm.find(".dislikeCount");
                    likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) - 1);
                }
            };
            likeFormUtil.disable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", function () {
                    return false;
                });
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", function () {
                    return false;
                });
            };
            likeFormUtil.enable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", onLike);
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", onDislike);
            };
            likeFormUtil.applyLikeableInformation = function(likeableInformation) {
                const id = likeableInformation.likeable.id;
                console.log(id);
                const $likeForm = $(".likeActionLink[data-likeableId='" + id + "']").closest(".likeForm");
                console.log($likeForm);
                likeFormUtil.setCount($likeForm.find(".likeCount"), likeableInformation.likeCount);
                likeFormUtil.setCount($likeForm.find(".dislikeCount"), likeableInformation.dislikeCount);
                if (likeableInformation.liked) {
                    $likeForm.find(".likeState").addClass("liked");
                } else {
                    $likeForm.find(".likeState").removeClass("liked");
                }
                if (likeableInformation.disliked) {
                    $likeForm.find(".likeState").addClass("disliked");
                } else {
                    $likeForm.find(".likeState").removeClass("disliked");
                }
            }
            likeFormUtil.applyLikeableInformations = function(likeableInformations) {
                likeableInformations.forEach((applyLikeableInformation) => {
                    likeFormUtil.applyLikeableInformation(applyLikeableInformation);
                });
            }

            function onLike() {
                const $likeActionLink = $(this);
                const likeableId = $likeActionLink.attr("data-likeableId");
                const $likeForm = $likeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "like",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["liked"]) {
                            Codeforces.showMessage('Added to liked');
                        } else {
                            Codeforces.showMessage('Removed from liked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            function onDislike() {
                const $dislikeActionLink = $(this);
                const likeableId = $dislikeActionLink.attr("data-likeableId");
                const $likeForm = $dislikeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "dislike",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["disliked"]) {
                            Codeforces.showMessage('Added to disliked');
                        } else {
                            Codeforces.showMessage('Removed from disliked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            $(".likeActionLink").click(onLike);
            $(".dislikeActionLink").click(onDislike);

            $(".likeCount").add(".dislikeCount").each(function () {
                const $count = $(this);
                likeFormUtil.setCount($count, likeFormUtil.getCount($count));
            });
        });
    </script>

<script data-nocturne="true"> $(function () {
}); </script>

 Great</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13044">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="89">89</span>
            </i>
        </a>
    </span>


 Good</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13045">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="67">67</span>
            </i>
        </a>
    </span>


 Neutral</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13046">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="22">22</span>
            </i>
        </a>
    </span>


 Bad</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13047">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="13">13</span>
            </i>
        </a>
    </span>


 Didn't Solve</p></div></div><h4><a href="https://codeforces.com/contest/2156/problem/B" title="Codeforces Round 1061 (Div. 2)">2156B - Strange Machine</a></h4> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>What's the consuming part of processing the string of operations <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">s</span></span></span><script type="math/tex" id="MathJax-Element-24">s</script> ?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>If the string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">s</span></span></span><script type="math/tex" id="MathJax-Element-25">s</script> contained at least one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-342"><span class="MJXp-mrow" id="MJXp-Span-343"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-344">B</span></span></span></span><script type="math/tex" id="MathJax-Element-26">\mathtt{B}</script> operation , What's the maximum count of iterations we're going to run so that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">a</span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-348">0</span></span></span><script type="math/tex" id="MathJax-Element-27">a=0</script> ?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>If the string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">s</span></span></span><script type="math/tex" id="MathJax-Element-28">s</script> contains <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">x</span></span></span><script type="math/tex" id="MathJax-Element-29">x</script> copies of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-353"><span class="MJXp-mrow" id="MJXp-Span-354"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-355">B</span></span></span></span><script type="math/tex" id="MathJax-Element-30">\mathtt{B}</script> then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">a</span></span></span><script type="math/tex" id="MathJax-Element-31">a</script> is guaranteed to be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">a</span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-361">0</span></span></span><script type="math/tex" id="MathJax-Element-32">a=0</script> in at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-362"><span class="MJXp-mrow" id="MJXp-Span-363"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-364">O</span></span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-366"><span class="MJXp-mi" id="MJXp-Span-367" style="margin-right: 0.05em;">log</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-368" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-369">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">A</span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-33">\mathcal{O}(\log_{2x} A)</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">A</span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-381" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-385" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-391" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-34">A=\max(a_1,a_2,\ldots ,a_n)</script> , that's at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-393"><span class="MJXp-mrow" id="MJXp-Span-394"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-395">O</span></span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">n</span><span class="MJXp-msubsup" id="MJXp-Span-398"><span class="MJXp-mi" id="MJXp-Span-399" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-400" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-401" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">A</span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0.333em; margin-right: 0.333em;">âˆ¼</span><span class="MJXp-mrow" id="MJXp-Span-405"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-406">O</span></span><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-408">30</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">n</span><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-35">\mathcal{O}(n \log_2 A) \sim \mathcal{O}(30n)</script> operations are required .</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>How to manage too many appearances of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-411"><span class="MJXp-mrow" id="MJXp-Span-412"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-413">A</span></span></span></span><script type="math/tex" id="MathJax-Element-36">\mathtt{A}</script> for efficiency ?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 5</b><div class="spoiler-content" style="display: block;"><p>It's enough to handle the case where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-414"><span class="MJXp-munderover" id="MJXp-Span-415"><span class=""><span class="MJXp-mrow" id="MJXp-Span-416"><span class="MJXp-munderover" id="MJXp-Span-417"><span class=""><span class="MJXp-mstyle" id="MJXp-Span-418" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-419"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-420">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-421">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-422">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-423">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-424">A</span><span class="MJXp-mo" id="MJXp-Span-425" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-426">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-427">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-428">A</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0px; margin-right: 0em;">âŸ</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-430" style="margin-left: 0px;"></span></span></span></span></span><script type="math/tex" id="MathJax-Element-37">\underbrace{\color{red}{\mathtt{AAAAA\ldots AAA}}}_{}</script> that's the answer for query <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">a</span></span></span><script type="math/tex" id="MathJax-Element-38">a</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">a</span></span></span><script type="math/tex" id="MathJax-Element-39">a</script> because we're incrementing by 1 at each iteration ; otherwise the complexity becomes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-435"><span class="MJXp-mrow" id="MJXp-Span-436"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-437">O</span></span><span class="MJXp-mo" id="MJXp-Span-438" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-439"><span class="MJXp-mn" id="MJXp-Span-440" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-441" style="vertical-align: 0.5em;">9</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">q</span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-40">\mathcal{O}(10^9q)</script> for such cases which is slow. and the rest can be done in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-444"><span class="MJXp-mrow" id="MJXp-Span-445"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-446">O</span></span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">q</span><span class="MJXp-msubsup" id="MJXp-Span-450"><span class="MJXp-mi" id="MJXp-Span-451" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-452" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-455"><span class="MJXp-mn" id="MJXp-Span-456" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-457" style="vertical-align: 0.5em;">9</span></span><span class="MJXp-mo" id="MJXp-Span-458" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-41">\mathcal{O}(nq \log_2(10^9))</script> which is safe according to the constraints.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution 1 : O(nq log A)</b><div class="spoiler-content" style="display: block;"><p>If you've one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-460"><span class="MJXp-mstyle" id="MJXp-Span-461" style="color: blue;"><span class="MJXp-mrow" id="MJXp-Span-462"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-463">B</span></span></span></span></span><script type="math/tex" id="MathJax-Element-42">\color{blue}{\mathtt{B}}</script> in string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">s</span></span></span><script type="math/tex" id="MathJax-Element-43">s</script> , then you'll have to do operations in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-466"><span class="MJXp-mrow" id="MJXp-Span-467"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-468">O</span></span><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">n</span><span class="MJXp-msubsup" id="MJXp-Span-471"><span class="MJXp-mi" id="MJXp-Span-472" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-473" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">A</span><span class="MJXp-mo" id="MJXp-Span-477" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-44">\mathcal{O}(n\log_2(A))</script> which is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-479"><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0.333em; margin-right: 0.333em;">âˆ¼</span><span class="MJXp-mrow" id="MJXp-Span-481"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-482">O</span></span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-484">20</span><span class="MJXp-mo" id="MJXp-Span-485" style="margin-left: 0.267em; margin-right: 0.267em;">â‹…</span><span class="MJXp-mn" id="MJXp-Span-486">30</span><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-45">\sim \mathcal{O}(20 \cdot 30)</script> which is fine for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">n</span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mn" id="MJXp-Span-491">20</span></span></span><script type="math/tex" id="MathJax-Element-46">n \le 20</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0.111em; margin-right: 0.167em;">âˆ‘</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">q</span><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-496"><span class="MJXp-mn" id="MJXp-Span-497" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-498" style="vertical-align: 0.5em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-47">\sum q \le 10^4</script> , at worst case this is roughly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-499"><span class="MJXp-mrow" id="MJXp-Span-500"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-501">O</span></span><span class="MJXp-mo" id="MJXp-Span-502" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-503">6</span><span class="MJXp-mo" id="MJXp-Span-504" style="margin-left: 0.267em; margin-right: 0.267em;">â‹…</span><span class="MJXp-msubsup" id="MJXp-Span-505"><span class="MJXp-mn" id="MJXp-Span-506" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-507" style="vertical-align: 0.5em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-48">\mathcal{O}(6 \cdot 10^5)</script> which is safe.</p><p>If we've a string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">s</span></span></span><script type="math/tex" id="MathJax-Element-49">s</script> that's all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-511"><span class="MJXp-mstyle" id="MJXp-Span-512" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-513"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-514">A</span></span></span></span></span><script type="math/tex" id="MathJax-Element-50">\color{red}{\mathtt{A}}</script> i.e. :</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">s</span><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-518"><span class=""><span class="MJXp-mrow" id="MJXp-Span-519"><span class="MJXp-munderover" id="MJXp-Span-520"><span class=""><span class="MJXp-mstyle" id="MJXp-Span-521" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-522"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-523">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-524">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-525">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-526">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-527">A</span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-529">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-530">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-531">A</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0px; margin-right: 0em;">âŸ</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-533" style="margin-left: 0px;"></span></span></span></span></span><script type="math/tex" id="MathJax-Element-51">s=\underbrace{\color{red}{\mathtt{AAAAA\ldots AAA}}}_{}</script></center><p>then answer is simply for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-534"><span class="MJXp-msubsup" id="MJXp-Span-535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-537" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-52">a_i</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-538"><span class="MJXp-msubsup" id="MJXp-Span-539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-541" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-53">a_i</script> itself because we cannot do anything except just subtracting by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-542"><span class="MJXp-mn" id="MJXp-Span-543">1</span></span></span><script type="math/tex" id="MathJax-Element-54">1</script> many times ; otherwise the complexity becomes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-544"><span class="MJXp-mrow" id="MJXp-Span-545"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-546">O</span></span><span class="MJXp-mo" id="MJXp-Span-547" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-548"><span class="MJXp-mn" id="MJXp-Span-549" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-550" style="vertical-align: 0.5em;">9</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">q</span><span class="MJXp-mo" id="MJXp-Span-552" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-55">\mathcal{O}(10^9q)</script> for such cases which is slow.</p><p>Complexity <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-553"><span class="MJXp-mrow" id="MJXp-Span-554"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-555">O</span></span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">q</span><span class="MJXp-msubsup" id="MJXp-Span-559"><span class="MJXp-mi" id="MJXp-Span-560" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-561" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-562" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-564"><span class="MJXp-mn" id="MJXp-Span-565" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-566" style="vertical-align: 0.5em;">9</span></span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-56">\mathcal{O}(nq \log_2(10^9))</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation 1 (MathModel)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n</span><span class="pun">,</span><span class="pln">q</span><span class="pun">=</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
    s</span><span class="pun">=</span><span class="pln">input</span><span class="pun">().</span><span class="pln">strip</span><span class="pun">()</span><span class="pln">
    a</span><span class="pun">=</span><span class="pln">list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))</span><span class="pln">
    A</span><span class="pun">,</span><span class="pln">B</span><span class="pun">=</span><span class="pln">s</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(</span><span class="str">'A'</span><span class="pun">),</span><span class="pln">s</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(</span><span class="str">'B'</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">q</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">B</span><span class="pun">==</span><span class="lit">0</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            ans</span><span class="pun">=</span><span class="lit">0</span><span class="pln">
            </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]):</span><span class="pln">
                </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> s</span><span class="pun">:</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="lit">0</span><span class="pun">):</span><span class="kwd">break</span><span class="pln">
                    ans</span><span class="pun">+=</span><span class="lit">1</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">==</span><span class="str">'A'</span><span class="pun">):</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-=</span><span class="lit">1</span><span class="pln">
                    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="com">//=2</span><span class="pln">
            </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
    solve</span><span class="pun">()</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Bonus Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Compress the string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">s</span></span></span><script type="math/tex" id="MathJax-Element-57">s</script> into sequence of "Move Blocks" that's for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">s</span><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-574"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-575">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-576">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-577">B</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-578">B</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-579">B</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-580">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-581">B</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-582">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-583">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-584">A</span></span></span></span><script type="math/tex" id="MathJax-Element-58">s=\mathtt{AABBBABAAA}</script> the sequence of moves will be </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-585"><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-588"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-589">A</span></span><span class="MJXp-mo" id="MJXp-Span-590" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-591">2</span><span class="MJXp-mo" id="MJXp-Span-592" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-595"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-596">B</span></span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-598">3</span><span class="MJXp-mo" id="MJXp-Span-599" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-600" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-602"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-603">A</span></span><span class="MJXp-mo" id="MJXp-Span-604" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-605">1</span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-609"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-610">B</span></span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-612">1</span><span class="MJXp-mo" id="MJXp-Span-613" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-614" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-616"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-617">A</span></span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-619">3</span><span class="MJXp-mo" id="MJXp-Span-620" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-59">\{[\mathtt{A},2],[\mathtt{B},3],[\mathtt{A},1],[\mathtt{B},1],[\mathtt{A},3]\}</script></center></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Be careful in simulation</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution 2 (Bonus) : O(n+qlog^2 A)</b><div class="spoiler-content" style="display: block;"><p><strong>Observation :</strong> The consuming part of processing the operations where a segment of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-622"><span class="MJXp-munderover" id="MJXp-Span-623"><span class=""><span class="MJXp-mrow" id="MJXp-Span-624"><span class="MJXp-munderover" id="MJXp-Span-625"><span class=""><span class="MJXp-mstyle" id="MJXp-Span-626" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-627"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-628">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-629">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-630">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-631">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-632">A</span><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-634">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-635">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-636">A</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-637" style="margin-left: 0px; margin-right: 0em;">âŸ</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-638" style="margin-left: 0px;"></span></span></span></span></span><script type="math/tex" id="MathJax-Element-60">\underbrace{\color{red}{\mathtt{AAAAA\ldots AAA}}}_{}</script> because we're processing one by one which is inefficient and answering query will take <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-639"><span class="MJXp-mrow" id="MJXp-Span-640"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-641">O</span></span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">q</span><span class="MJXp-msubsup" id="MJXp-Span-645"><span class="MJXp-mi" id="MJXp-Span-646" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-647" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-648" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-650"><span class="MJXp-mn" id="MJXp-Span-651" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-652" style="vertical-align: 0.5em;">9</span></span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-61">\mathcal{O}(nq \log_2(10^9))</script> , why ? , because processing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-655"><span class="MJXp-munderover" id="MJXp-Span-656"><span class=""><span class="MJXp-mrow" id="MJXp-Span-657"><span class="MJXp-munderover" id="MJXp-Span-658"><span class=""><span class="MJXp-mstyle" id="MJXp-Span-659" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-660"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-661">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-662">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-663">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-664">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-665">A</span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-667">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-668">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-669">A</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-670" style="margin-left: 0px; margin-right: 0em;">âŸ</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-671" style="margin-left: 0px;"></span></span></span></span></span><script type="math/tex" id="MathJax-Element-62">\underbrace{\color{red}{\mathtt{AAAAA\ldots AAA}}}_{}</script> operation-by-operation is slow , for example consider the sequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-672"><span class="MJXp-munderover" id="MJXp-Span-673"><span class=""><span class="MJXp-mrow" id="MJXp-Span-674"><span class="MJXp-munderover" id="MJXp-Span-675"><span class=""><span class="MJXp-mstyle" id="MJXp-Span-676" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-677"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-678">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-679">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-680">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-681">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-682">A</span><span class="MJXp-mo" id="MJXp-Span-683" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-684">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-685">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-686">A</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-687" style="color: blue;"><span class="MJXp-mrow" id="MJXp-Span-688"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-689">B</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0px; margin-right: 0em;">âŸ</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-691" style="margin-left: 0px;"></span></span></span></span></span><script type="math/tex" id="MathJax-Element-63">\underbrace{\color{red}{\mathtt{AAAAA\ldots AAA}} \color{blue}{\mathtt{B}}}_{}</script> </p><p>This case will take <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-692"><span class="MJXp-mrow" id="MJXp-Span-693"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-694">O</span></span><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">q</span><span class="MJXp-msubsup" id="MJXp-Span-698"><span class="MJXp-mi" id="MJXp-Span-699" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-700" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-703"><span class="MJXp-mn" id="MJXp-Span-704" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-705" style="vertical-align: 0.5em;">9</span></span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-64">\mathcal{O}(nq \log_2(10^9))</script> at worst case , which is inefficient.</p><p>A good way to optimize is by compress the blocks of same type of operations as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-708"><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-710"><span class="MJXp-mi" id="MJXp-Span-711">t</span><span class="MJXp-mi" id="MJXp-Span-712">y</span><span class="MJXp-mi" id="MJXp-Span-713">p</span><span class="MJXp-mi" id="MJXp-Span-714">e</span></span><span class="MJXp-mo" id="MJXp-Span-715" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-716"><span class="MJXp-mi" id="MJXp-Span-717">c</span><span class="MJXp-mi" id="MJXp-Span-718">o</span><span class="MJXp-mi" id="MJXp-Span-719">u</span><span class="MJXp-mi" id="MJXp-Span-720">n</span><span class="MJXp-mi" id="MJXp-Span-721">t</span></span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-65">(\mathrm{type},\mathrm{count})</script> that way all long blocks of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-723"><span class="MJXp-mstyle" id="MJXp-Span-724" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-725"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-726">A</span></span></span></span></span><script type="math/tex" id="MathJax-Element-66">\color{red}{\mathtt{A}}</script> will be performed much faster , For blocks of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-727"><span class="MJXp-mstyle" id="MJXp-Span-728" style="color: blue;"><span class="MJXp-mrow" id="MJXp-Span-729"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-730">B</span></span></span></span></span><script type="math/tex" id="MathJax-Element-67">\color{blue}{\mathtt{B}}</script> it's already fast to process them in order because of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-731"><span class="MJXp-mrow" id="MJXp-Span-732"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-733">O</span></span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-735"><span class="MJXp-mi" id="MJXp-Span-736" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-737" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">a</span><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-68">\mathcal{O}(\log_2(a))</script> and it reduces <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">a</span></span></span><script type="math/tex" id="MathJax-Element-69">a</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-745"><span class="MJXp-mn" id="MJXp-Span-746">0</span></span></span><script type="math/tex" id="MathJax-Element-70">0</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-747"><span class="MJXp-mrow" id="MJXp-Span-748"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-749">O</span></span><span class="MJXp-mo" id="MJXp-Span-750" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-751"><span class="MJXp-mi" id="MJXp-Span-752" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-753" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-756"><span class="MJXp-mn" id="MJXp-Span-757" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-758" style="vertical-align: 0.5em;">9</span></span><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-760" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0.333em; margin-right: 0.333em;">âˆ¼</span><span class="MJXp-mn" id="MJXp-Span-762">30</span></span></span><script type="math/tex" id="MathJax-Element-71">\mathcal{O}(\log_2(10^9)) \sim 30</script> at most , However compressing the operations is still better to compose the operations.</p><p>That's we're going to process at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-763"><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0.333em; margin-right: 0.333em;">âˆ¼</span><span class="MJXp-mn" id="MJXp-Span-765">60</span></span></span><script type="math/tex" id="MathJax-Element-72">\sim 60</script> blocks , because if we started with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-766"><span class="MJXp-mstyle" id="MJXp-Span-767" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-768"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-769">A</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-770" style="color: blue;"><span class="MJXp-mrow" id="MJXp-Span-771"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-772">B</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-773" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-774"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-775">A</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-776" style="color: blue;"><span class="MJXp-mrow" id="MJXp-Span-777"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-778">B</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-779" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-780"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-781">A</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-782" style="color: blue;"><span class="MJXp-mrow" id="MJXp-Span-783"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-784">B</span></span></span><span class="MJXp-mo" id="MJXp-Span-785" style="margin-left: 0em; margin-right: 0em;">â€¦</span></span></span><script type="math/tex" id="MathJax-Element-73">\color{red}{\mathtt{A}}\color{blue}{\mathtt{B}}\color{red}{\mathtt{A}}\color{blue}{\mathtt{B}}\color{red}{\mathtt{A}}\color{blue}{\mathtt{B}}\ldots </script> assuming <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">a</span><span class="MJXp-mo" id="MJXp-Span-788" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-789"><span class="MJXp-mn" id="MJXp-Span-790" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-791" style="vertical-align: 0.5em;">9</span></span></span></span><script type="math/tex" id="MathJax-Element-74">a=10^9</script> , which is the worst case of the algorithm. </p><p>Now after composing the blocks as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-792"><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-794"><span class="MJXp-mi" id="MJXp-Span-795">t</span><span class="MJXp-mi" id="MJXp-Span-796">y</span><span class="MJXp-mi" id="MJXp-Span-797">p</span><span class="MJXp-mi" id="MJXp-Span-798">e</span></span><span class="MJXp-mo" id="MJXp-Span-799" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-800"><span class="MJXp-mi" id="MJXp-Span-801">c</span><span class="MJXp-mi" id="MJXp-Span-802">o</span><span class="MJXp-mi" id="MJXp-Span-803">u</span><span class="MJXp-mi" id="MJXp-Span-804">n</span><span class="MJXp-mi" id="MJXp-Span-805">t</span></span><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-75">(\mathrm{type},\mathrm{count})</script> , you should iterate through them :</p> <ul>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-807"><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-810" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-812" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-813"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-814">A</span></span></span></span></span><script type="math/tex" id="MathJax-Element-76">s_i=\color{red}{\mathtt{A}}</script> then we perform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-815"><span class="MJXp-msubsup" id="MJXp-Span-816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-818" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-822" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-823" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mo" id="MJXp-Span-824" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-826"><span class="MJXp-mi" id="MJXp-Span-827">c</span><span class="MJXp-mi" id="MJXp-Span-828">o</span><span class="MJXp-mi" id="MJXp-Span-829">u</span><span class="MJXp-mi" id="MJXp-Span-830">n</span><span class="MJXp-mi" id="MJXp-Span-831">t</span></span><span class="MJXp-mo" id="MJXp-Span-832" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-835" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-77">a_i=a_i-\min(\mathrm{count},a_i)</script></li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-837"><span class="MJXp-msubsup" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-840" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-842" style="color: blue;"><span class="MJXp-mrow" id="MJXp-Span-843"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-844">B</span></span></span></span></span><script type="math/tex" id="MathJax-Element-78">s_i=\color{blue}{\mathtt{B}}</script> then we perform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-845"><span class="MJXp-mstyle" id="MJXp-Span-846"><span class="MJXp-msubsup" id="MJXp-Span-847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-849" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-851"><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">âŒŠ</span></span><span class="MJXp-mfrac" id="MJXp-Span-853" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-856" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mstyle" id="MJXp-Span-857"><span class="MJXp-msubsup" id="MJXp-Span-858"><span class="MJXp-mn" id="MJXp-Span-859" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-860" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-861">min</span><span class="MJXp-mo" id="MJXp-Span-862">(</span><span class="MJXp-mtext" id="MJXp-Span-863">count</span><span class="MJXp-mo" id="MJXp-Span-864">,</span><span class="MJXp-mo" id="MJXp-Span-865">âŒˆ</span><span class="MJXp-msubsup" id="MJXp-Span-866"><span class="MJXp-mi" id="MJXp-Span-867" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-868" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-869"></span><span class="MJXp-mo" id="MJXp-Span-870">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">n</span><span class="MJXp-mo" id="MJXp-Span-872">)</span><span class="MJXp-mo" id="MJXp-Span-873">âŒ‰</span><span class="MJXp-mo" id="MJXp-Span-874">)</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-875" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">âŒ‹</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-79">\displaystyle a_i=\left \lfloor \frac{a_i}{\displaystyle 2^{\min(\text{count},\lceil \log_2(n) \rceil)}} \right \rfloor</script></li> </ul><p>make sure to update number of operations accordingly.</p><p>Complexity <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-876"><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0.333em; margin-right: 0.333em;">âˆ¼</span><span class="MJXp-mrow" id="MJXp-Span-878"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-879">O</span></span><span class="MJXp-mo" id="MJXp-Span-880" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">n</span><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">q</span><span class="MJXp-msubsup" id="MJXp-Span-884"><span class="MJXp-mi" id="MJXp-Span-885" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-886" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-888" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-889"><span class="MJXp-mn" id="MJXp-Span-890" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-891" style="vertical-align: 0.5em;">9</span></span><span class="MJXp-mo" id="MJXp-Span-892" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-80">\sim \mathcal{O}(n+q \log^2(10^9))</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation 2 (MathModel)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n</span><span class="pun">,</span><span class="pln">q</span><span class="pun">=</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
    s</span><span class="pun">=</span><span class="pln">input</span><span class="pun">()</span><span class="pln">
    a</span><span class="pun">=</span><span class="pln">list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))</span><span class="pln">
    A</span><span class="pun">=</span><span class="pln">s</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(</span><span class="str">'A'</span><span class="pun">)</span><span class="pln">
    B</span><span class="pun">=</span><span class="pln">s</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(</span><span class="str">'B'</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">last</span><span class="pun">=</span><span class="pln">s</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
    seq</span><span class="pun">=[]</span><span class="pln"> 
    cur</span><span class="pun">=</span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="kwd">last</span><span class="pun">):</span><span class="pln"> cur</span><span class="pun">+=</span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            seq</span><span class="pun">.</span><span class="pln">append</span><span class="pun">([</span><span class="kwd">last</span><span class="pun">,</span><span class="pln">cur</span><span class="pun">])</span><span class="pln">
            cur</span><span class="pun">=</span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">last</span><span class="pun">=</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">!=</span><span class="lit">0</span><span class="pun">):</span><span class="pln"> seq</span><span class="pun">.</span><span class="pln">append</span><span class="pun">([</span><span class="kwd">last</span><span class="pun">,</span><span class="pln">cur</span><span class="pun">])</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">B</span><span class="pun">==</span><span class="lit">0</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> a</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">q</span><span class="pun">):</span><span class="pln">
            ans</span><span class="pun">=</span><span class="lit">0</span><span class="pln">
            </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&gt;</span><span class="lit">0</span><span class="pun">):</span><span class="pln">
                </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> seq</span><span class="pun">:</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="lit">0</span><span class="pun">):</span><span class="pln"> </span><span class="kwd">break</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]==</span><span class="str">'A'</span><span class="pun">):</span><span class="pln">
                        mn</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">j</span><span class="pun">[</span><span class="lit">1</span><span class="pun">],</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
                        ans</span><span class="pun">+=</span><span class="pln">mn
                        a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-=</span><span class="pln">mn
                    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
                        </span><span class="kwd">if</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="lit">0</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">break</span><span class="pln">
                        x</span><span class="pun">=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
                        p</span><span class="pun">=</span><span class="lit">0</span><span class="pln">
                        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">x</span><span class="pun">):</span><span class="pln">
                            x</span><span class="com">//=2</span><span class="pln">
                            p</span><span class="pun">+=</span><span class="lit">1</span><span class="pln">
                        mn</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">p</span><span class="pun">,</span><span class="pln">j</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln">
                        ans</span><span class="pun">+=</span><span class="pln">mn
                        a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="com">//=(2**mn)</span><span class="pln">
            </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
    solve</span><span class="pun">()</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem !</b><div class="spoiler-content" style="display: block;"><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13048">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="315">315</span>
            </i>
        </a>
    </span>


 Great</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13049">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="97">97</span>
            </i>
        </a>
    </span>


 Good</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13050">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="50">50</span>
            </i>
        </a>
    </span>


 Neutral</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13051">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="40">40</span>
            </i>
        </a>
    </span>


 Bad</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13052">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="35">35</span>
            </i>
        </a>
    </span>


 Didn't Solve</p></div></div><h4><a href="https://codeforces.com/contest/2156/problem/C" title="Codeforces Round 1061 (Div. 2)">2156C - Maximum GCD on Whiteboard</a></h4> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>You can do all the <strong>Erase</strong> operations before the <strong>Split</strong> operations.</p> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>Suppose there exists an optimal solution where you do an <strong>Erase</strong> operation on an element that was produced from a <strong>Split</strong> operation. You can instead do an <strong>Erase</strong> operation on the original element that it was being <strong>Split</strong> from, which will result in the whiteboard containing a subset of the elements in the optimal solution. Hence, it will have a beauty of at least as much as the optimal solution.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Fix a target gcd <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-894"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">g</span></span></span><script type="math/tex" id="MathJax-Element-81">g</script>. Which numbers can be made divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-896"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">g</span></span></span><script type="math/tex" id="MathJax-Element-82">g</script> using the <strong>Split</strong> operation?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">x</span></span></span><script type="math/tex" id="MathJax-Element-83">x</script> is a multiple of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901">g</span></span></span><script type="math/tex" id="MathJax-Element-84">g</script>, we do not need any <strong>Split</strong> operation. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">x</span><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-905">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">g</span></span></span><script type="math/tex" id="MathJax-Element-85">x\ge 4g</script>, one split can result in two multiples of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">g</span></span></span><script type="math/tex" id="MathJax-Element-86">g</script> (discard the middle).</p> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>Split <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">x</span></span></span><script type="math/tex" id="MathJax-Element-87">x</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-911"><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">g</span><span class="MJXp-mo" id="MJXp-Span-914" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">g</span><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">x</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">g</span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">x</span><span class="MJXp-mo" id="MJXp-Span-922" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-923">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">g</span><span class="MJXp-mo" id="MJXp-Span-925" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">x</span><span class="MJXp-mo" id="MJXp-Span-927" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">g</span><span class="MJXp-mo" id="MJXp-Span-929" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-88">(g, g + x\bmod g, x - 2g - x\bmod g)</script>. Both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">g</span></span></span><script type="math/tex" id="MathJax-Element-89">g</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">x</span><span class="MJXp-mo" id="MJXp-Span-934" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-935">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">g</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">x</span><span class="MJXp-mo" id="MJXp-Span-939" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">g</span></span></span><script type="math/tex" id="MathJax-Element-90">x - 2g - x\bmod g</script> are divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">g</span></span></span><script type="math/tex" id="MathJax-Element-91">g</script>. </p> <ul>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-943"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">x</span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-946">5</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">g</span></span></span><script type="math/tex" id="MathJax-Element-92">x \lt 5g</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-948"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">x</span><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-951">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">g</span><span class="MJXp-mo" id="MJXp-Span-953" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">x</span><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">g</span><span class="MJXp-mo" id="MJXp-Span-957" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-958">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">g</span></span></span><script type="math/tex" id="MathJax-Element-93">x - 2g - x\bmod g = 2g</script>. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">g</span><span class="MJXp-mo" id="MJXp-Span-962" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">x</span><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">g</span><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mn" id="MJXp-Span-967">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">g</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">x</span><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-972">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">g</span><span class="MJXp-mo" id="MJXp-Span-974" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">x</span><span class="MJXp-mo" id="MJXp-Span-976" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">g</span></span></span><script type="math/tex" id="MathJax-Element-94">g + x\bmod g \le 2g = x - 2g - x\bmod g</script>, hence, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-978"><span class="MJXp-msubsup" id="MJXp-Span-979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-981" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-982" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-985" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-986" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-989" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-95">x_1 \le x_2 \le x_3</script> is satisfied.</li>   <li>Otherwise, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-990"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">x</span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-993">5</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">g</span></span></span><script type="math/tex" id="MathJax-Element-96">x \ge 5g</script>. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-995"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">x</span><span class="MJXp-mo" id="MJXp-Span-997" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-998">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">g</span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">x</span><span class="MJXp-mo" id="MJXp-Span-1002" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">g</span><span class="MJXp-mo" id="MJXp-Span-1004" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-1005">5</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">g</span><span class="MJXp-mo" id="MJXp-Span-1007" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1008">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">g</span><span class="MJXp-mo" id="MJXp-Span-1010" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">g</span><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1013">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">g</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">g</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">x</span><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">g</span></span></span><script type="math/tex" id="MathJax-Element-97">x - 2g - x\bmod g \ge 5g - 2g - g = 2g \ge g + x\bmod g</script>, hence, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1021"><span class="MJXp-msubsup" id="MJXp-Span-1022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1024" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-1026"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1028" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1029" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-1030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1032" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-98">x_1 \le x_2 \le x_3</script> is satisfied.</li> </ul></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>Conversely, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">x</span><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1036">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">g</span></span></span><script type="math/tex" id="MathJax-Element-99">x\lt 4g</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">x</span></span></span><script type="math/tex" id="MathJax-Element-100">x</script> is not divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">g</span></span></span><script type="math/tex" id="MathJax-Element-101">g</script>, you canâ€™t make it good by splits â†’ it must be erased.</p> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>We will prove this by strong induction. </p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1042"><span class="MJXp-msubsup" id="MJXp-Span-1043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1045" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-102">P_i</script> be the statement: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">i</span></span></span><script type="math/tex" id="MathJax-Element-103">i</script> cannot be made divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">g</span></span></span><script type="math/tex" id="MathJax-Element-104">g</script> using any number of splits if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">i</span><span class="MJXp-mo" id="MJXp-Span-1052" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1053">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">g</span></span></span><script type="math/tex" id="MathJax-Element-105">i \lt 4g</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">i</span></span></span><script type="math/tex" id="MathJax-Element-106">i</script> is not divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">g</span></span></span><script type="math/tex" id="MathJax-Element-107">g</script>.</p><p>Base case: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1059"><span class="MJXp-msubsup" id="MJXp-Span-1060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1062" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-108">P_1</script> is true as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1063"><span class="MJXp-mn" id="MJXp-Span-1064">1</span></span></span><script type="math/tex" id="MathJax-Element-109">1</script> cannot be split.</p><p>Suppose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1065"><span class="MJXp-msubsup" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1068" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-110">P_i</script> is true for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">i</span><span class="MJXp-mo" id="MJXp-Span-1071" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">K</span></span></span><script type="math/tex" id="MathJax-Element-111">i \lt K</script> for some <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">K</span><span class="MJXp-mo" id="MJXp-Span-1075" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-1076">2</span></span></span><script type="math/tex" id="MathJax-Element-112">K \ge 2</script>. We will prove that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-msubsup" id="MJXp-Span-1078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1080" style="vertical-align: -0.4em;">K</span></span></span></span><script type="math/tex" id="MathJax-Element-113">P_K</script> is also true.</p><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">K</span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-1084">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">g</span></span></span><script type="math/tex" id="MathJax-Element-114">K \ge 4g</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1086"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">K</span></span></span><script type="math/tex" id="MathJax-Element-115">K</script> is divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">g</span></span></span><script type="math/tex" id="MathJax-Element-116">g</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1090"><span class="MJXp-msubsup" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1093" style="vertical-align: -0.4em;">K</span></span></span></span><script type="math/tex" id="MathJax-Element-117">P_K</script> is vacuously true. From here on, we will assume that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">K</span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1097">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">g</span></span></span><script type="math/tex" id="MathJax-Element-118">K \lt 4g</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">K</span></span></span><script type="math/tex" id="MathJax-Element-119">K</script> is not divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">g</span></span></span><script type="math/tex" id="MathJax-Element-120">g</script>.</p><p>Suppose we split <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">K</span></span></span><script type="math/tex" id="MathJax-Element-121">K</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1105"><span class="MJXp-msubsup" id="MJXp-Span-1106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1108" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-1110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1112" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-1114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1116" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">K</span></span></span><script type="math/tex" id="MathJax-Element-122">x_1\le x_2\le x_3 \lt K</script>. If either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1119"><span class="MJXp-msubsup" id="MJXp-Span-1120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1122" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-123">x_1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1123"><span class="MJXp-msubsup" id="MJXp-Span-1124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1126" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-124">x_3</script> is not divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">g</span></span></span><script type="math/tex" id="MathJax-Element-125">g</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1129"><span class="MJXp-msubsup" id="MJXp-Span-1130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1132" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1135" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-126">P_{x_1}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1136"><span class="MJXp-msubsup" id="MJXp-Span-1137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1139" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1142" style="vertical-align: -0.4em;">3</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-127">P_{x_3}</script> implies that they can never be made divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">g</span></span></span><script type="math/tex" id="MathJax-Element-128">g</script> using any number of splits. Hence, if we want to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">K</span></span></span><script type="math/tex" id="MathJax-Element-129">K</script> divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">g</span></span></span><script type="math/tex" id="MathJax-Element-130">g</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1149"><span class="MJXp-msubsup" id="MJXp-Span-1150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1152" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-131">x_1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1153"><span class="MJXp-msubsup" id="MJXp-Span-1154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1156" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-132">x_3</script> have to both be divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">g</span></span></span><script type="math/tex" id="MathJax-Element-133">g</script>.</p><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1159"><span class="MJXp-msubsup" id="MJXp-Span-1160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1162" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1163" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-1164">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">g</span></span></span><script type="math/tex" id="MathJax-Element-134">x_1 \ge 2g</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1166"><span class="MJXp-msubsup" id="MJXp-Span-1167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1169" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-msubsup" id="MJXp-Span-1171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1173" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-msubsup" id="MJXp-Span-1175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1177" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1178" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-1179">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">g</span></span></span><script type="math/tex" id="MathJax-Element-135">x_3 \ge x_2 \ge x_1 \ge 2g</script>, which means that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">K</span><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1186" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1190" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1191" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1194" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-1196">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">g</span><span class="MJXp-mo" id="MJXp-Span-1198" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1199">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">g</span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1202">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">g</span><span class="MJXp-mo" id="MJXp-Span-1204" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1205">6</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">g</span></span></span><script type="math/tex" id="MathJax-Element-136">K = x_1 + x_2 + x_3 \ge 2g + 2g + 2g = 6g</script>, which contradicts <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">K</span><span class="MJXp-mo" id="MJXp-Span-1209" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1210">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">g</span></span></span><script type="math/tex" id="MathJax-Element-137">K \lt 4g</script>. Hence, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1212"><span class="MJXp-msubsup" id="MJXp-Span-1213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1215" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">g</span></span></span><script type="math/tex" id="MathJax-Element-138">x_1 = g</script> is the only possibility.</p> <ul>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1218"><span class="MJXp-msubsup" id="MJXp-Span-1219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1221" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1222" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">g</span></span></span><script type="math/tex" id="MathJax-Element-139">x_3 = g</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1224"><span class="MJXp-msubsup" id="MJXp-Span-1225"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1227" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-1229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1231" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-1233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1235" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1236" style="margin-left: 0.333em; margin-right: 0.333em;">â†’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">g</span><span class="MJXp-mo" id="MJXp-Span-1238" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-1239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1241" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">g</span></span></span><script type="math/tex" id="MathJax-Element-140">x_1 \le x_2 \le x_3 \rightarrow g \le x_2 \le g</script>. Hence, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1244"><span class="MJXp-msubsup" id="MJXp-Span-1245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1247" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1248" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">g</span></span></span><script type="math/tex" id="MathJax-Element-141">x_2 = g</script> as well, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">K</span><span class="MJXp-mo" id="MJXp-Span-1252" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1255" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1256" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1259" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1260" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1263" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">g</span><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">g</span><span class="MJXp-mo" id="MJXp-Span-1268" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">g</span><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1271">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">g</span></span></span><script type="math/tex" id="MathJax-Element-142">K = x_1 + x_2 + x_3 = g + g + g = 3g</script>, contradicting that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">K</span></span></span><script type="math/tex" id="MathJax-Element-143">K</script> is not divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">g</span></span></span><script type="math/tex" id="MathJax-Element-144">g</script>.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1277"><span class="MJXp-msubsup" id="MJXp-Span-1278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1280" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1281" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-1282">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">g</span></span></span><script type="math/tex" id="MathJax-Element-145">x_3 \ge 2g</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">K</span><span class="MJXp-mo" id="MJXp-Span-1286" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1289" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1290" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1293" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1294" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1297" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1298" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">g</span><span class="MJXp-mo" id="MJXp-Span-1300" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">g</span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1303">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">g</span><span class="MJXp-mo" id="MJXp-Span-1305" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1306">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">g</span></span></span><script type="math/tex" id="MathJax-Element-146">K = x_1 + x_2 + x_3 \le g + g + 2g = 4g</script>, contradicting <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">K</span><span class="MJXp-mo" id="MJXp-Span-1310" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1311">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">g</span></span></span><script type="math/tex" id="MathJax-Element-147">K \lt 4g</script>.</li> </ul><p>Hence, it is not posible to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">K</span></span></span><script type="math/tex" id="MathJax-Element-148">K</script> divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">g</span></span></span><script type="math/tex" id="MathJax-Element-149">g</script> using any number of splits.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 5</b><div class="spoiler-content" style="display: block;"><p>So <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">g</span></span></span><script type="math/tex" id="MathJax-Element-150">g</script> is good if </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1319"><span class="MJXp-mi" id="MJXp-Span-1320">#</span><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">x</span><span class="MJXp-mo" id="MJXp-Span-1323" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-1324">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">g</span><span class="MJXp-mo" id="MJXp-Span-1326" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-1327" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-1328">#</span><span class="MJXp-mo" id="MJXp-Span-1329" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">x</span><span class="MJXp-mo" id="MJXp-Span-1331" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">g</span><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-1334" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-1335">#</span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">x</span><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1339">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">g</span><span class="MJXp-mo" id="MJXp-Span-1341" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-1342" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-1343">#</span><span class="MJXp-mo" id="MJXp-Span-1344" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">x</span><span class="MJXp-mo" id="MJXp-Span-1346" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1347">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">g</span><span class="MJXp-mo" id="MJXp-Span-1349" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mtext" id="MJXp-Span-1350">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1351" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mtext" id="MJXp-Span-1352">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">n</span><span class="MJXp-mo" id="MJXp-Span-1354" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">k</span><span class="MJXp-mo" id="MJXp-Span-1356" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-151"> \#\{x\ge 4g\}+\#\{x=g\}+\#\{x=2g\}+\#\{x=3g\}\ \ge\ n-k. </script></center></div></div> <div class="spoiler"><b class="spoiler-title">Hint 6</b><div class="spoiler-content" style="display: block;"><p>Count with a frequency array / map and a prefix sum for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">g</span><span class="MJXp-mo" id="MJXp-Span-1359" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1360">1</span><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1362">2</span><span class="MJXp-mo" id="MJXp-Span-1363" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1365" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">n</span></span></span><script type="math/tex" id="MathJax-Element-152">g=1,2,\ldots ,n</script></p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>We want the maximum gcd <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">g</span></span></span><script type="math/tex" id="MathJax-Element-153">g</script> achievable after <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1369"><span class="MJXp-mo" id="MJXp-Span-1370" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">k</span></span></span><script type="math/tex" id="MathJax-Element-154">\le k</script> erases and any splits.</p><p>For a fixed <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">g</span></span></span><script type="math/tex" id="MathJax-Element-155">g</script>, the elements that wonâ€™t consume an erase are:</p> <ul>   <li>all multiples of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">g</span></span></span><script type="math/tex" id="MathJax-Element-156">g</script> (already good), and</li>   <li>any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">x</span><span class="MJXp-mo" id="MJXp-Span-1378" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-1379">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">g</span></span></span><script type="math/tex" id="MathJax-Element-157">x\ge 4g</script> (can be made good via one split using the construction in hint 3).</li> </ul><p>Thus, the only "bad" numbers (that would have to be erased) are those with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">x</span><span class="MJXp-mo" id="MJXp-Span-1383" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1384">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">g</span></span></span><script type="math/tex" id="MathJax-Element-158">x\lt 4g</script> that are not multiples of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">g</span></span></span><script type="math/tex" id="MathJax-Element-159">g</script>. Therefore <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">g</span></span></span><script type="math/tex" id="MathJax-Element-160">g</script> is good if</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1390"><span class="MJXp-mtext" id="MJXp-Span-1391">good</span><span class="MJXp-mo" id="MJXp-Span-1392" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">g</span><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1395" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-1396">#</span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">x</span><span class="MJXp-mo" id="MJXp-Span-1399" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-1400">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">g</span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-1403" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-1404">#</span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">x</span><span class="MJXp-mo" id="MJXp-Span-1407" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">g</span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-1410" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-1411">#</span><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">x</span><span class="MJXp-mo" id="MJXp-Span-1414" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1415">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">g</span><span class="MJXp-mo" id="MJXp-Span-1417" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-1419">#</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">x</span><span class="MJXp-mo" id="MJXp-Span-1422" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1423">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">g</span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mtext" id="MJXp-Span-1426">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mtext" id="MJXp-Span-1428">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">n</span><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">k</span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-161">\text{good}(g)=\#\{x\ge 4g\}+\#\{x=g\}+\#\{x=2g\}+\#\{x=3g\}\ \ge\ n-k.</script></center><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1433"><span class="MJXp-mn" id="MJXp-Span-1434">1</span><span class="MJXp-mo" id="MJXp-Span-1435" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-msubsup" id="MJXp-Span-1436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1438" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1439" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">n</span></span></span><script type="math/tex" id="MathJax-Element-162">1\le a_i\le n</script>, precompute a frequency array and prefix sums <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">p</span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">v</span><span class="MJXp-mo" id="MJXp-Span-1445" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1446" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1447"><span class="MJXp-mo" id="MJXp-Span-1448" style="margin-left: 0.111em; margin-right: 0.05em;">âˆ‘</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1449" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">u</span><span class="MJXp-mo" id="MJXp-Span-1451">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">v</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">f</span><span class="MJXp-mo" id="MJXp-Span-1454" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">u</span><span class="MJXp-mo" id="MJXp-Span-1456" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-163">p[v]=\sum_{u\le v}f[u]</script>. Then</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1457"><span class="MJXp-mi" id="MJXp-Span-1458">#</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">x</span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-1462">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">g</span><span class="MJXp-mo" id="MJXp-Span-1464" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-1465" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">n</span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">p</span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">n</span><span class="MJXp-mo" id="MJXp-Span-1473" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1474">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">g</span><span class="MJXp-mo" id="MJXp-Span-1476" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1477">1</span><span class="MJXp-mo" id="MJXp-Span-1478" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1479" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1480" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-164"> \#\{x\ge 4g\}=n-p[\min(n,4g-1)]. </script></center><p>Iterate through <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">g</span><span class="MJXp-mo" id="MJXp-Span-1483" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1484">1</span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1486">2</span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1488">3</span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1490" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">n</span></span></span><script type="math/tex" id="MathJax-Element-165">g=1,2,3,\ldots ,n</script> and keep the largest good <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">g</span></span></span><script type="math/tex" id="MathJax-Element-166">g</script>.</p><p>Complexity : <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1495"><span class="MJXp-mrow" id="MJXp-Span-1496"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1497">O</span></span><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">n</span><span class="MJXp-mo" id="MJXp-Span-1500" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-167">\mathcal{O}(n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation (MathModel)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">k</span><span class="pun">;</span><span class="pln">cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">&gt;&gt;</span><span class="pln">k</span><span class="pun">;</span><span class="pln">
  vector</span><span class="str">&lt;int&gt;</span><span class="pln">a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">),</span><span class="pln">mp</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),</span><span class="pln">p</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">i</span><span class="pun">:</span><span class="pln">a</span><span class="pun">){</span><span class="pln">
     cin</span><span class="pun">&gt;&gt;</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
     mp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]++;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
      p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">mp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> g</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">g</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">g</span><span class="pun">++){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="lit">4</span><span class="pun">*</span><span class="pln">g</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> good</span><span class="pun">=</span><span class="pln">n</span><span class="pun">-</span><span class="pln">p</span><span class="pun">[</span><span class="pln">t</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">g</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln">good</span><span class="pun">+=</span><span class="pln">mp</span><span class="pun">[</span><span class="pln">g</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="lit">2</span><span class="pun">*</span><span class="pln">g</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln">good</span><span class="pun">+=</span><span class="pln">mp</span><span class="pun">[</span><span class="lit">2</span><span class="pun">*</span><span class="pln">g</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="lit">3</span><span class="pun">*</span><span class="pln">g</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln">good</span><span class="pun">+=</span><span class="pln">mp</span><span class="pun">[</span><span class="lit">3</span><span class="pun">*</span><span class="pln">g</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">good</span><span class="pun">&gt;=</span><span class="pln">n</span><span class="pun">-</span><span class="pln">k</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">=</span><span class="pln">g</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">&lt;&lt;</span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
  ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
  cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">cin</span><span class="pun">&gt;&gt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem !</b><div class="spoiler-content" style="display: block;"><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13053">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="598">598</span>
            </i>
        </a>
    </span>


 Great</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13054">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="46">46</span>
            </i>
        </a>
    </span>


 Good</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13055">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="19">19</span>
            </i>
        </a>
    </span>


 Neutral</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13056">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="38">38</span>
            </i>
        </a>
    </span>


 Bad</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13057">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="166">166</span>
            </i>
        </a>
    </span>


 Didn't Solve</p></div></div><h4><a href="https://codeforces.com/contest/2156/problem/D" title="Codeforces Round 1061 (Div. 2)">2156D - Find the Last Number</a></h4> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>We determine the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">k</span></span></span><script type="math/tex" id="MathJax-Element-168">k</script>-th bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1503"><span class="MJXp-msubsup" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1506" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-169">p_n</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">k</span><span class="MJXp-mo" id="MJXp-Span-1509" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1510">0</span><span class="MJXp-mo" id="MJXp-Span-1511" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1512">1</span><span class="MJXp-mo" id="MJXp-Span-1513" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1514" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0em; margin-right: 0em;">âŒŠ</span><span class="MJXp-msubsup" id="MJXp-Span-1517"><span class="MJXp-mi" id="MJXp-Span-1518" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1519" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1520" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">n</span><span class="MJXp-mo" id="MJXp-Span-1522" style="margin-left: 0em; margin-right: 0em;">âŒ‹</span></span></span><script type="math/tex" id="MathJax-Element-170">k=0,1,\ldots,\lfloor\log_2 n\rfloor</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1523"><span class="MJXp-msubsup" id="MJXp-Span-1524"><span class="MJXp-mtext" id="MJXp-Span-1525" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1526" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1527" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">i</span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-171">\text{bit}_k(i)</script> denote the whether the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">k</span></span></span><script type="math/tex" id="MathJax-Element-172">k</script>-th bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">i</span></span></span><script type="math/tex" id="MathJax-Element-173">i</script> is zero or one. How can we determine the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">k</span></span></span><script type="math/tex" id="MathJax-Element-174">k</script>-th bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1536"><span class="MJXp-msubsup" id="MJXp-Span-1537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1539" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-175">p_n</script>, i.e. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1540"><span class="MJXp-msubsup" id="MJXp-Span-1541"><span class="MJXp-mtext" id="MJXp-Span-1542" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1543" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1547" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-176">\text{bit}_k(p_n)</script>, from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1549"><span class="MJXp-msubsup" id="MJXp-Span-1550"><span class="MJXp-mtext" id="MJXp-Span-1551" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1552" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1553" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1556" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1558" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1559"><span class="MJXp-mtext" id="MJXp-Span-1560" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1561" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1565" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1567" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1568" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1570"><span class="MJXp-mtext" id="MJXp-Span-1571" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1572" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1573" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1576" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">n</span><span class="MJXp-mo" id="MJXp-Span-1578">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1579">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1580" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-177">\text{bit}_k(p_1) + \text{bit}_k(p_2) + \ldots + \text{bit}_k(p_{n - 1})</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1581"><span class="MJXp-msubsup" id="MJXp-Span-1582"><span class="MJXp-mo" id="MJXp-Span-1583" style="margin-left: 0.111em; margin-right: 0.05em;">âˆ‘</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1588"><span class="MJXp-mo" id="MJXp-Span-1589">âŒŠ</span><span class="MJXp-msubsup" id="MJXp-Span-1590"><span class="MJXp-mi" id="MJXp-Span-1591" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1592" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1593"></span><span class="MJXp-mo" id="MJXp-Span-1594">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">n</span><span class="MJXp-mo" id="MJXp-Span-1596">)</span><span class="MJXp-mo" id="MJXp-Span-1597">âŒ‹</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">k</span><span class="MJXp-mo" id="MJXp-Span-1586">=</span><span class="MJXp-mn" id="MJXp-Span-1587">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1598"><span class="MJXp-mo" id="MJXp-Span-1599" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">âŒˆ</span></span><span class="MJXp-mfrac" id="MJXp-Span-1600" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">n</span><span class="MJXp-mo" id="MJXp-Span-1602">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1603">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1604"><span class="MJXp-mn" id="MJXp-Span-1605" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1606" style="vertical-align: 0.5em;">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">âŒ‰</span></span></span><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">n</span><span class="MJXp-mo" id="MJXp-Span-1610" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1611">1</span><span class="MJXp-mo" id="MJXp-Span-1612" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1613"><span class="MJXp-mo" id="MJXp-Span-1614" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒˆ</span></span><span class="MJXp-mfrac" id="MJXp-Span-1615" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616">n</span><span class="MJXp-mo" id="MJXp-Span-1617">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1618">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1619">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒ‰</span></span></span><span class="MJXp-mo" id="MJXp-Span-1621" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1622"><span class="MJXp-mo" id="MJXp-Span-1623" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒˆ</span></span><span class="MJXp-mfrac" id="MJXp-Span-1624" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">n</span><span class="MJXp-mo" id="MJXp-Span-1626">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1627">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1628">4</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1629" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒ‰</span></span></span><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1631"><span class="MJXp-mo" id="MJXp-Span-1632" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒˆ</span></span><span class="MJXp-mfrac" id="MJXp-Span-1633" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">n</span><span class="MJXp-mo" id="MJXp-Span-1635">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1636">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1637">8</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1638" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒ‰</span></span></span><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1642">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">n</span></span></span><script type="math/tex" id="MathJax-Element-178"> \sum_{k=0}^{\lfloor \log_2(n) \rfloor} \left \lceil \frac{n-1}{2^k} \right \rceil =n-1 + \left \lceil \frac{n-1}{2} \right \rceil + \left \lceil \frac{n-1}{4} \right \rceil + \left \lceil \frac{n-1}{8} \right \rceil+\ldots \lt 2n </script></center><p>How can we achieve this halving?</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Recall from Hint 2 that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1644"><span class="MJXp-msubsup" id="MJXp-Span-1645"><span class="MJXp-mtext" id="MJXp-Span-1646" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1647" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1648" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">i</span><span class="MJXp-mo" id="MJXp-Span-1650" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-179">\text{bit}_k(i)</script> is defined as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">k</span></span></span><script type="math/tex" id="MathJax-Element-180">k</script>-th bit of the integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">i</span></span></span><script type="math/tex" id="MathJax-Element-181">i</script>. A naive solution using <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1655"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">n</span><span class="MJXp-msubsup" id="MJXp-Span-1657"><span class="MJXp-mi" id="MJXp-Span-1658" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1659" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661">n</span></span></span><script type="math/tex" id="MathJax-Element-182">n\log_2 n</script> queries is as follows:</p> <ul>   <li><p>Compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1662"><span class="MJXp-msubsup" id="MJXp-Span-1663"><span class="MJXp-mtext" id="MJXp-Span-1664" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1665" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1669" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1670" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1671" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1672"><span class="MJXp-mtext" id="MJXp-Span-1673" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1674" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1675" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1676"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1678" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1679" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1680" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1681" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1682" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1683"><span class="MJXp-mtext" id="MJXp-Span-1684" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1685" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1686" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1689" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">n</span><span class="MJXp-mo" id="MJXp-Span-1691">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1692">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1693" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-183">\text{bit}_k(p_1) + \text{bit}_k(p_2) + \ldots + \text{bit}_k(p_{n - 1})</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">k</span><span class="MJXp-mo" id="MJXp-Span-1696" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1697">0</span><span class="MJXp-mo" id="MJXp-Span-1698" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1699">1</span><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1701" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1702" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1703" style="margin-left: 0em; margin-right: 0em;">âŒŠ</span><span class="MJXp-msubsup" id="MJXp-Span-1704"><span class="MJXp-mi" id="MJXp-Span-1705" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1706" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1707" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">n</span><span class="MJXp-mo" id="MJXp-Span-1709" style="margin-left: 0em; margin-right: 0em;">âŒ‹</span></span></span><script type="math/tex" id="MathJax-Element-184">k=0,1,\ldots,\lfloor\log_2 n\rfloor</script>.</p>   <ul>     <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1710"><span class="MJXp-msubsup" id="MJXp-Span-1711"><span class="MJXp-mtext" id="MJXp-Span-1712" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1713" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1714" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1715"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1717" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1718" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-185">\text{bit}_k(p_i)</script> can be computed with a single query <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1719"><span class="MJXp-msubsup" id="MJXp-Span-1720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1722" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-1723">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1724"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-1725">A</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-1726">N</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-1727">D</span></span><span class="MJXp-mtext" id="MJXp-Span-1728">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1729"><span class="MJXp-mn" id="MJXp-Span-1730" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1731" style="vertical-align: 0.5em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-186">p_i \ \mathtt{AND} \ 2^k</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1732"><span class="MJXp-mn" id="MJXp-Span-1733">1</span><span class="MJXp-mo" id="MJXp-Span-1734" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">i</span><span class="MJXp-mo" id="MJXp-Span-1736" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">n</span><span class="MJXp-mo" id="MJXp-Span-1738" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1739">1</span></span></span><script type="math/tex" id="MathJax-Element-187">1\le i\le n - 1</script>).</li>   </ul></li>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1740"><span class="MJXp-msubsup" id="MJXp-Span-1741"><span class="MJXp-mtext" id="MJXp-Span-1742" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1743" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1744" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1745">1</span><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1747" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1748"><span class="MJXp-mtext" id="MJXp-Span-1749" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1750" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1751" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1752">2</span><span class="MJXp-mo" id="MJXp-Span-1753" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1754" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1755" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1757"><span class="MJXp-mtext" id="MJXp-Span-1758" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1759" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1760" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">n</span><span class="MJXp-mo" id="MJXp-Span-1762" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1763" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1764"><span class="MJXp-mtext" id="MJXp-Span-1765" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1766" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1767" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1770" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1772" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1773"><span class="MJXp-mtext" id="MJXp-Span-1774" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1775" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1776" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1777"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1779" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1781" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1782" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1783" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1784"><span class="MJXp-mtext" id="MJXp-Span-1785" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1786" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1787" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1790" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">n</span><span class="MJXp-mo" id="MJXp-Span-1792">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1793">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1794" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-188">\text{bit}_k(1) + \text{bit}_k(2) + \ldots + \text{bit}_k(n) = \text{bit}_k(p_1) + \text{bit}_k(p_2) + \ldots + \text{bit}_k(p_{n - 1})</script>, it means that the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">k</span></span></span><script type="math/tex" id="MathJax-Element-189">k</script>-th bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1797"><span class="MJXp-msubsup" id="MJXp-Span-1798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1800" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-190">p_n</script> is zero. Otherwise, it is one.</p>   <ul>     <li>This works due to the fact that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1801"><span class="MJXp-msubsup" id="MJXp-Span-1802"><span class="MJXp-mtext" id="MJXp-Span-1803" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1804" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1805" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1808" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1809" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1810" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1811"><span class="MJXp-mtext" id="MJXp-Span-1812" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1813" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1814" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1817" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1818" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1819" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1820" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1821" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1822"><span class="MJXp-mtext" id="MJXp-Span-1823" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1824" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1828" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829">n</span><span class="MJXp-mo" id="MJXp-Span-1830">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1831">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1832" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1834"><span class="MJXp-mtext" id="MJXp-Span-1835" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1836" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1837" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1838">1</span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1840" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1841"><span class="MJXp-mtext" id="MJXp-Span-1842" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1843" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1845">2</span><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1847" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1848" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1850"><span class="MJXp-mtext" id="MJXp-Span-1851" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1852" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1853" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">n</span><span class="MJXp-mo" id="MJXp-Span-1855" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1856" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-msubsup" id="MJXp-Span-1857"><span class="MJXp-mtext" id="MJXp-Span-1858" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1859" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1860" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1863" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1864" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-191">\text{bit}_k(p_1) + \text{bit}_k(p_2) + \ldots + \text{bit}_k(p_{n - 1}) = \text{bit}_k(1) + \text{bit}_k(2) + \ldots + \text{bit}_k(n) - \text{bit}_k(p_n)</script>.</li>   </ul></li> </ul><p>To optimise this, we will half the search space after each step. Starting from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">k</span><span class="MJXp-mo" id="MJXp-Span-1867" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1868">0</span></span></span><script type="math/tex" id="MathJax-Element-192">k = 0</script>, we still use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">n</span><span class="MJXp-mo" id="MJXp-Span-1871" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1872">1</span></span></span><script type="math/tex" id="MathJax-Element-193">n - 1</script> queries to calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1873"><span class="MJXp-msubsup" id="MJXp-Span-1874"><span class="MJXp-mtext" id="MJXp-Span-1875" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1876" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1880" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1881" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1882" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1883"><span class="MJXp-mtext" id="MJXp-Span-1884" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1885" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1886" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1888" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1889" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1890" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1891" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1892" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-1893" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1894"><span class="MJXp-mtext" id="MJXp-Span-1895" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1896" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1897" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1900" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">n</span><span class="MJXp-mo" id="MJXp-Span-1902">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1903">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1904" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-194">\text{bit}_k(p_1) + \text{bit}_k(p_2) + \ldots + \text{bit}_k(p_{n - 1})</script>. After using this to determine the value of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1905"><span class="MJXp-mn" id="MJXp-Span-1906">0</span></span></span><script type="math/tex" id="MathJax-Element-195">0</script>-th bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1907"><span class="MJXp-msubsup" id="MJXp-Span-1908"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1910" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-196">p_n</script>, we can discard all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1911"><span class="MJXp-msubsup" id="MJXp-Span-1912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1914" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-197">p_i</script> that has a different <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1915"><span class="MJXp-mn" id="MJXp-Span-1916">0</span></span></span><script type="math/tex" id="MathJax-Element-198">0</script>-th bit from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1917"><span class="MJXp-msubsup" id="MJXp-Span-1918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1920" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-199">p_n</script>.</p><p>More formally, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1921"><span class="MJXp-msubsup" id="MJXp-Span-1922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1924" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-200">S_0</script> denote the set of elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1926">i</span></span></span><script type="math/tex" id="MathJax-Element-201">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">i</span></span></span><script type="math/tex" id="MathJax-Element-202">i</script> has the same <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1929"><span class="MJXp-mn" id="MJXp-Span-1930">0</span></span></span><script type="math/tex" id="MathJax-Element-203">0</script>-th bit as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1931"><span class="MJXp-msubsup" id="MJXp-Span-1932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1934" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-204">p_n</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1935"><span class="MJXp-msubsup" id="MJXp-Span-1936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1938" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-205">P_0</script> denote the set of elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1940">i</span></span></span><script type="math/tex" id="MathJax-Element-206">i</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1941"><span class="MJXp-mn" id="MJXp-Span-1942">1</span><span class="MJXp-mo" id="MJXp-Span-1943" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1944">i</span><span class="MJXp-mo" id="MJXp-Span-1945" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946">n</span><span class="MJXp-mo" id="MJXp-Span-1947" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1948">1</span></span></span><script type="math/tex" id="MathJax-Element-207">1\le i\le n - 1</script>) such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1949"><span class="MJXp-msubsup" id="MJXp-Span-1950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1952" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-208">p_i</script> has the same <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1953"><span class="MJXp-mn" id="MJXp-Span-1954">0</span></span></span><script type="math/tex" id="MathJax-Element-209">0</script>-th bit as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1955"><span class="MJXp-msubsup" id="MJXp-Span-1956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1957" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1958" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-210">p_n</script>. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1959"><span class="MJXp-msubsup" id="MJXp-Span-1960"><span class="MJXp-mo" id="MJXp-Span-1961" style="margin-left: 0.111em; margin-right: 0.05em;">âˆ‘</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1962" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963">i</span><span class="MJXp-mo" id="MJXp-Span-1964">âˆˆ</span><span class="MJXp-msubsup" id="MJXp-Span-1965"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1966" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1967" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1968"><span class="MJXp-mtext" id="MJXp-Span-1969" style="margin-right: 0.05em;">bit</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1970" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1971" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1974" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1975" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1976" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1977"><span class="MJXp-mo" id="MJXp-Span-1978" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.396em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.582em; margin-left: -0.13em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-1979"><span class="MJXp-mo" id="MJXp-Span-1980" style="margin-left: 0.111em; margin-right: 0.05em;">âˆ‘</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1981" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1982">i</span><span class="MJXp-mo" id="MJXp-Span-1983">âˆˆ</span><span class="MJXp-msubsup" id="MJXp-Span-1984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1985" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1986" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1987"><span class="MJXp-mtext" id="MJXp-Span-1988" style="margin-right: 0.05em;">bit</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1989" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1990" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">i</span><span class="MJXp-mo" id="MJXp-Span-1992" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1993" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.396em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.582em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1994" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-msubsup" id="MJXp-Span-1995"><span class="MJXp-mtext" id="MJXp-Span-1996" style="margin-right: 0.05em;">bit</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1997" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1998" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1999"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2001" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2002" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-211">\sum_{i\in P_0} \text{bit}_1(p_i) = \left(\sum_{i\in S_0} \text{bit}_1(i)\right) - \text{bit}_1(p_n)</script>, so the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2003"><span class="MJXp-mn" id="MJXp-Span-2004">1</span></span></span><script type="math/tex" id="MathJax-Element-212">1</script>-st bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2005"><span class="MJXp-msubsup" id="MJXp-Span-2006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2007" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2008" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-213">p_n</script> is zero if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2009"><span class="MJXp-msubsup" id="MJXp-Span-2010"><span class="MJXp-mo" id="MJXp-Span-2011" style="margin-left: 0.111em; margin-right: 0.05em;">âˆ‘</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2012" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013">i</span><span class="MJXp-mo" id="MJXp-Span-2014">âˆˆ</span><span class="MJXp-msubsup" id="MJXp-Span-2015"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2017" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2018"><span class="MJXp-mtext" id="MJXp-Span-2019" style="margin-right: 0.05em;">bit</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2020" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2021" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2023" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2024" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2025" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2026" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2027"><span class="MJXp-mo" id="MJXp-Span-2028" style="margin-left: 0.111em; margin-right: 0.05em;">âˆ‘</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2029" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030">i</span><span class="MJXp-mo" id="MJXp-Span-2031">âˆˆ</span><span class="MJXp-msubsup" id="MJXp-Span-2032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2033" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2034" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2035"><span class="MJXp-mtext" id="MJXp-Span-2036" style="margin-right: 0.05em;">bit</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2037" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2038" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2039">i</span><span class="MJXp-mo" id="MJXp-Span-2040" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-214">\sum_{i\in P_0} \text{bit}_1(p_i) = \sum_{i\in S_0} \text{bit}_1(i)</script>.</p><p>In general, we can let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2041"><span class="MJXp-msubsup" id="MJXp-Span-2042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2044" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-215">S_k</script> denote the set of elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2045"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">i</span></span></span><script type="math/tex" id="MathJax-Element-216">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2047"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048">i</span></span></span><script type="math/tex" id="MathJax-Element-217">i</script> has the same <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2049"><span class="MJXp-mn" id="MJXp-Span-2050">0</span></span></span><script type="math/tex" id="MathJax-Element-218">0</script>-th, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2051"><span class="MJXp-mn" id="MJXp-Span-2052">1</span></span></span><script type="math/tex" id="MathJax-Element-219">1</script>-st, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2053"><span class="MJXp-mo" id="MJXp-Span-2054" style="margin-left: 0em; margin-right: 0em;">â€¦</span></span></span><script type="math/tex" id="MathJax-Element-220">\ldots</script> , <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056">k</span></span></span><script type="math/tex" id="MathJax-Element-221">k</script>-th bit as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2057"><span class="MJXp-msubsup" id="MJXp-Span-2058"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2060" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-222">p_n</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2061"><span class="MJXp-msubsup" id="MJXp-Span-2062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2064" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-223">P_k</script> denote the set of elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2066">i</span></span></span><script type="math/tex" id="MathJax-Element-224">i</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2067"><span class="MJXp-mn" id="MJXp-Span-2068">1</span><span class="MJXp-mo" id="MJXp-Span-2069" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070">i</span><span class="MJXp-mo" id="MJXp-Span-2071" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072">n</span><span class="MJXp-mo" id="MJXp-Span-2073" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2074">1</span></span></span><script type="math/tex" id="MathJax-Element-225">1\le i\le n - 1</script>) such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2075"><span class="MJXp-msubsup" id="MJXp-Span-2076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2078" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-226">p_i</script> has the same <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2079"><span class="MJXp-mn" id="MJXp-Span-2080">0</span></span></span><script type="math/tex" id="MathJax-Element-227">0</script>-th, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2081"><span class="MJXp-mn" id="MJXp-Span-2082">1</span></span></span><script type="math/tex" id="MathJax-Element-228">1</script>-st, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2083"><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0em; margin-right: 0em;">â€¦</span></span></span><script type="math/tex" id="MathJax-Element-229">\ldots</script> , <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086">k</span></span></span><script type="math/tex" id="MathJax-Element-230">k</script>-th bit as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2087"><span class="MJXp-msubsup" id="MJXp-Span-2088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2090" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-231">p_n</script>. Then, the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">k</span></span></span><script type="math/tex" id="MathJax-Element-232">k</script>-th bit of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2093"><span class="MJXp-msubsup" id="MJXp-Span-2094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2096" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-233">p_n</script> is zero if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2097"><span class="MJXp-msubsup" id="MJXp-Span-2098"><span class="MJXp-mo" id="MJXp-Span-2099" style="margin-left: 0.111em; margin-right: 0.05em;">âˆ‘</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2100" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101">i</span><span class="MJXp-mo" id="MJXp-Span-2102">âˆˆ</span><span class="MJXp-msubsup" id="MJXp-Span-2103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2104" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2105" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2106">k</span><span class="MJXp-mo" id="MJXp-Span-2107">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2108">1</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2109"><span class="MJXp-mtext" id="MJXp-Span-2110" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2111" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2112" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2114" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2115" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2116" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2117" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2118"><span class="MJXp-mo" id="MJXp-Span-2119" style="margin-left: 0.111em; margin-right: 0.05em;">âˆ‘</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2120" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2121">i</span><span class="MJXp-mo" id="MJXp-Span-2122">âˆˆ</span><span class="MJXp-msubsup" id="MJXp-Span-2123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2125" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">k</span><span class="MJXp-mo" id="MJXp-Span-2127">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2128">1</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2129"><span class="MJXp-mtext" id="MJXp-Span-2130" style="margin-right: 0.05em;">bit</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2131" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2132" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2133">i</span><span class="MJXp-mo" id="MJXp-Span-2134" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-234">\sum_{i\in P_{k-1}} \text{bit}_k(p_i) = \sum_{i\in S_{k-1}} \text{bit}_k(i)</script>.</p><p>Observe that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2135"><span class="MJXp-mrow" id="MJXp-Span-2136"><span class="MJXp-mo" id="MJXp-Span-2137" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2140" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mrow" id="MJXp-Span-2141"><span class="MJXp-mo" id="MJXp-Span-2142" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2143" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mrow" id="MJXp-Span-2144"><span class="MJXp-mo" id="MJXp-Span-2145" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">âŒˆ</span></span><span class="MJXp-mfrac" id="MJXp-Span-2146" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2147"><span class="MJXp-mo" id="MJXp-Span-2148">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2151" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2152">k</span><span class="MJXp-mo" id="MJXp-Span-2153">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2154">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2155"><span class="MJXp-mo" id="MJXp-Span-2156">|</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2157">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2158" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">âŒ‰</span></span></span></span></span><script type="math/tex" id="MathJax-Element-235">|P_k| \le \left\lceil \frac{|P_{k - 1}|}{2} \right\rceil</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2160">k</span><span class="MJXp-mo" id="MJXp-Span-2161" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-2162">1</span></span></span><script type="math/tex" id="MathJax-Element-236">k\ge 1</script>. Hence, the total number of queries used is </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164">n</span><span class="MJXp-mo" id="MJXp-Span-2165" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2166">1</span><span class="MJXp-mo" id="MJXp-Span-2167" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2168"><span class="MJXp-mo" id="MJXp-Span-2169" style="margin-left: 0.111em; margin-right: 0.05em;">âˆ‘</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-2174"><span class="MJXp-mo" id="MJXp-Span-2175">âŒŠ</span><span class="MJXp-msubsup" id="MJXp-Span-2176"><span class="MJXp-mi" id="MJXp-Span-2177" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2178" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2179"></span><span class="MJXp-mo" id="MJXp-Span-2180">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">n</span><span class="MJXp-mo" id="MJXp-Span-2182">)</span><span class="MJXp-mo" id="MJXp-Span-2183">âŒ‹</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">k</span><span class="MJXp-mo" id="MJXp-Span-2172">=</span><span class="MJXp-mn" id="MJXp-Span-2173">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2184"><span class="MJXp-mo" id="MJXp-Span-2185" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2187" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2188" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2189">k</span><span class="MJXp-mo" id="MJXp-Span-2190">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2191">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2192"><span class="MJXp-mo" id="MJXp-Span-2193" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2194" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195">n</span><span class="MJXp-mo" id="MJXp-Span-2196" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2197">1</span><span class="MJXp-mo" id="MJXp-Span-2198" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-2199"><span class="MJXp-mo" id="MJXp-Span-2200" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒˆ</span></span><span class="MJXp-mfrac" id="MJXp-Span-2201" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202">n</span><span class="MJXp-mo" id="MJXp-Span-2203">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2204">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2205">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2206" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒ‰</span></span></span><span class="MJXp-mo" id="MJXp-Span-2207" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-2208"><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒˆ</span></span><span class="MJXp-mfrac" id="MJXp-Span-2210" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2211">n</span><span class="MJXp-mo" id="MJXp-Span-2212">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2213">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2214">4</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2215" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒ‰</span></span></span><span class="MJXp-mo" id="MJXp-Span-2216" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-2217"><span class="MJXp-mo" id="MJXp-Span-2218" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒˆ</span></span><span class="MJXp-mfrac" id="MJXp-Span-2219" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">n</span><span class="MJXp-mo" id="MJXp-Span-2221">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2222">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2223">8</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2224" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">âŒ‰</span></span></span><span class="MJXp-mo" id="MJXp-Span-2225" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2226" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-2227" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-2228">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2229">n</span></span></span><script type="math/tex" id="MathJax-Element-237">n - 1 + \sum_{k=1}^{\lfloor \log_2(n) \rfloor} |P_{k - 1}| \le n-1 + \left \lceil \frac{n-1}{2} \right \rceil + \left \lceil \frac{n-1}{4} \right \rceil + \left \lceil \frac{n-1}{8} \right \rceil+\ldots \lt 2n</script></center></div></div> <div class="spoiler"><b class="spoiler-title">Implementation (hxu10)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">def</span><span class="pln"> query</span><span class="pun">(</span><span class="pln">index</span><span class="pun">,</span><span class="pln">num</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"?"</span><span class="pun">,</span><span class="pln">index</span><span class="pun">,</span><span class="pln">num</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
    rest </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">()</span><span class="pln">
    likely </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        rest</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        likely</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
    D </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">bin</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)[</span><span class="lit">2</span><span class="pun">:])</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> d </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">D</span><span class="pun">):</span><span class="pln">
        index_0 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">()</span><span class="pln">
        index_1 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">()</span><span class="pln"> 
        likely_0 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">()</span><span class="pln">
        likely_1 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> index </span><span class="kwd">in</span><span class="pln"> rest</span><span class="pun">:</span><span class="pln">
            res </span><span class="pun">=</span><span class="pln"> query</span><span class="pun">(</span><span class="pln">index</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">d</span><span class="pun">)</span><span class="pln">   
            </span><span class="kwd">if</span><span class="pln"> res </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
                index_0</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
                index_1</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln">  
        zeros </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
        ones </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">  
        </span><span class="kwd">for</span><span class="pln"> num </span><span class="kwd">in</span><span class="pln"> likely</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> num </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">d</span><span class="pun">):</span><span class="pln">
                ones </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
                likely_1</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">num</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
                zeros </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
                likely_0</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">num</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> zeros </span><span class="pun">==</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">index_0</span><span class="pun">):</span><span class="pln">
            ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> d
            rest </span><span class="pun">=</span><span class="pln"> index_1
            likely </span><span class="pun">=</span><span class="pln"> likely_1
        </span><span class="kwd">elif</span><span class="pln"> ones </span><span class="pun">==</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">index_1</span><span class="pun">):</span><span class="pln">
            rest </span><span class="pun">=</span><span class="pln"> index_0
            likely </span><span class="pun">=</span><span class="pln"> likely_0
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Error"</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> 
    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"!"</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">

T </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
t </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
</span><span class="kwd">while</span><span class="pln"> t </span><span class="pun">&lt;=</span><span class="pln"> T</span><span class="pun">:</span><span class="pln">
    main</span><span class="pun">()</span><span class="pln">
    t </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem !</b><div class="spoiler-content" style="display: block;"><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13058">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="342">342</span>
            </i>
        </a>
    </span>


 Great</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13059">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="35">35</span>
            </i>
        </a>
    </span>


 Good</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13060">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


 Neutral</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13061">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="32">32</span>
            </i>
        </a>
    </span>


 Bad</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13062">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="64">64</span>
            </i>
        </a>
    </span>


 Didn't Solve</p></div></div><h4><a href="https://codeforces.com/contest/2156/problem/E" title="Codeforces Round 1061 (Div. 2)">2156E - Best Time to Buy and Sell Stock</a></h4> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Consider the simplified version of the game where Alex moves first.</p> <div class="spoiler"><b class="spoiler-title">Hint 1.1</b><div class="spoiler-content" style="display: block;"><p>Suppose Alex wants to ensure a beauty of at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231">g</span></span></span><script type="math/tex" id="MathJax-Element-238">g</script> (the goal), while Hao tries to keep it below <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233">g</span></span></span><script type="math/tex" id="MathJax-Element-239">g</script>. Which indices should Alex lock to achieve this goal?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 1.2</b><div class="spoiler-content" style="display: block;"><p>We can binary search on the goal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235">g</span></span></span><script type="math/tex" id="MathJax-Element-240">g</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 1.3</b><div class="spoiler-content" style="display: block;"><p>For a given <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">g</span></span></span><script type="math/tex" id="MathJax-Element-241">g</script> and an index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239">i</span></span></span><script type="math/tex" id="MathJax-Element-242">i</script>, we define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2240"><span class="MJXp-msubsup" id="MJXp-Span-2241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2243" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2244" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2245">a</span><span class="MJXp-mo" id="MJXp-Span-2246" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247">i</span><span class="MJXp-mo" id="MJXp-Span-2248" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-243">f_g(a, i)</script> as the number of indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2250">j</span><span class="MJXp-mo" id="MJXp-Span-2251" style="margin-left: 0.333em; margin-right: 0.333em;">â‰ </span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252">i</span></span></span><script type="math/tex" id="MathJax-Element-244">j\neq i</script> satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2253"><span class="MJXp-msubsup" id="MJXp-Span-2254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2256" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-2257">max</span><span class="MJXp-mo" id="MJXp-Span-2258">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">i</span><span class="MJXp-mo" id="MJXp-Span-2260">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261">j</span><span class="MJXp-mo" id="MJXp-Span-2262">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2263" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-msubsup" id="MJXp-Span-2264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2265" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2266" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-2267">min</span><span class="MJXp-mo" id="MJXp-Span-2268">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">i</span><span class="MJXp-mo" id="MJXp-Span-2270">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2271">j</span><span class="MJXp-mo" id="MJXp-Span-2272">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2273" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2274">g</span></span></span><script type="math/tex" id="MathJax-Element-245">a_{\max(i, j)} - a_{\min(i, j)} \ge g</script>.</p><p>If there exists an index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276">i</span></span></span><script type="math/tex" id="MathJax-Element-246">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2277"><span class="MJXp-msubsup" id="MJXp-Span-2278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2279" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2280" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2281" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2282">a</span><span class="MJXp-mo" id="MJXp-Span-2283" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2284">i</span><span class="MJXp-mo" id="MJXp-Span-2285" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2286" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-2287">2</span></span></span><script type="math/tex" id="MathJax-Element-247">f_g(a, i) \ge 2</script>, then Alex can lock index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">i</span></span></span><script type="math/tex" id="MathJax-Element-248">i</script> on the first move. No matter which index Hao removes next, there will still exist at least one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2291">j</span></span></span><script type="math/tex" id="MathJax-Element-249">j</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2292"><span class="MJXp-mrow" id="MJXp-Span-2293"><span class="MJXp-mo" id="MJXp-Span-2294" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2296" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2297" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2298" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-msubsup" id="MJXp-Span-2299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2300" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2301" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-2302"><span class="MJXp-mo" id="MJXp-Span-2303" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2304" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305">g</span></span></span><script type="math/tex" id="MathJax-Element-250">|a_i - a_j| \ge g</script>. Thus, Alex can secure that pair and guarantee a beauty of at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">g</span></span></span><script type="math/tex" id="MathJax-Element-251">g</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 1.4</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2308"><span class="MJXp-msubsup" id="MJXp-Span-2309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2310" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2311" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2312" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2313">a</span><span class="MJXp-mo" id="MJXp-Span-2314" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2315">i</span><span class="MJXp-mo" id="MJXp-Span-2316" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2317" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mn" id="MJXp-Span-2318">1</span></span></span><script type="math/tex" id="MathJax-Element-252">f_g(a, i) \le 1</script> for all indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320">i</span></span></span><script type="math/tex" id="MathJax-Element-253">i</script>, Alex cannot achieve his goal. Whichever index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2322">i</span></span></span><script type="math/tex" id="MathJax-Element-254">i</script> Alex locks first, Hao can remove the single <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2324">j</span></span></span><script type="math/tex" id="MathJax-Element-255">j</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2325"><span class="MJXp-mrow" id="MJXp-Span-2326"><span class="MJXp-mo" id="MJXp-Span-2327" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2329" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2330" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2331" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-msubsup" id="MJXp-Span-2332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2334" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-2335"><span class="MJXp-mo" id="MJXp-Span-2336" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2337" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2338">g</span></span></span><script type="math/tex" id="MathJax-Element-256">|a_i - a_j| \ge g</script>. Hence, Alex will never be able to lock two indices with a difference <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2339"><span class="MJXp-mo" id="MJXp-Span-2340" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">g</span></span></span><script type="math/tex" id="MathJax-Element-257">\ge g</script>, and the resulting beauty will be strictly less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343">g</span></span></span><script type="math/tex" id="MathJax-Element-258">g</script>.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Now return to the original problem, where Hao moves first.</p><p>To keep the final beauty below <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345">g</span></span></span><script type="math/tex" id="MathJax-Element-259">g</script>, Hao must remove an index such that after the removal, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2346"><span class="MJXp-msubsup" id="MJXp-Span-2347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2348" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2349" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2350" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2351">a</span><span class="MJXp-mo" id="MJXp-Span-2352" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353">i</span><span class="MJXp-mo" id="MJXp-Span-2354" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-2356">2</span></span></span><script type="math/tex" id="MathJax-Element-260">f_g(a, i) \lt 2</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2358">i</span></span></span><script type="math/tex" id="MathJax-Element-261">i</script>. Otherwise, Alex will have a winning move as shown in Hint 1.3.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2360">i</span></span></span><script type="math/tex" id="MathJax-Element-262">i</script>, we only need to track whether <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2361"><span class="MJXp-msubsup" id="MJXp-Span-2362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2363" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2364" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2365" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">a</span><span class="MJXp-mo" id="MJXp-Span-2367" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2368">i</span><span class="MJXp-mo" id="MJXp-Span-2369" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-263">f_g(a, i)</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2370"><span class="MJXp-mn" id="MJXp-Span-2371">0</span></span></span><script type="math/tex" id="MathJax-Element-264">0</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2372"><span class="MJXp-mn" id="MJXp-Span-2373">1</span></span></span><script type="math/tex" id="MathJax-Element-265">1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2374"><span class="MJXp-mn" id="MJXp-Span-2375">2</span></span></span><script type="math/tex" id="MathJax-Element-266">2</script>, or greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2376"><span class="MJXp-mn" id="MJXp-Span-2377">2</span></span></span><script type="math/tex" id="MathJax-Element-267">2</script>. This is because if there are any index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">i</span></span></span><script type="math/tex" id="MathJax-Element-268">i</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2380"><span class="MJXp-msubsup" id="MJXp-Span-2381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2382" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2383" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2384" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385">a</span><span class="MJXp-mo" id="MJXp-Span-2386" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2387">i</span><span class="MJXp-mo" id="MJXp-Span-2388" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2389" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-2390">2</span></span></span><script type="math/tex" id="MathJax-Element-269">f_g(a, i) \gt 2</script>, Hao has to remove index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2392">i</span></span></span><script type="math/tex" id="MathJax-Element-270">i</script> on his first move. Otherwise, we will have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2393"><span class="MJXp-msubsup" id="MJXp-Span-2394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2395" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2396" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2397" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398">a</span><span class="MJXp-mo" id="MJXp-Span-2399" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2400">i</span><span class="MJXp-mo" id="MJXp-Span-2401" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2402" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-2403">2</span></span></span><script type="math/tex" id="MathJax-Element-271">f_g(a, i) \ge 2</script> after Hao's first move, allowing Alex to have a beauty of at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2405">g</span></span></span><script type="math/tex" id="MathJax-Element-272">g</script> as mentioned in Hint 2.</p><p>This observation allows us to compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2406"><span class="MJXp-msubsup" id="MJXp-Span-2407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2409" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2410" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2411">a</span><span class="MJXp-mo" id="MJXp-Span-2412" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413">i</span><span class="MJXp-mo" id="MJXp-Span-2414" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-273">f_g(a, i)</script> efficiently.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Read the above hints before continuing.</p><p>As noted in Hint 1.2, we can binary search on the target beauty <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2416">g</span></span></span><script type="math/tex" id="MathJax-Element-274">g</script>.</p><p>For each index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2417"><span class="MJXp-mn" id="MJXp-Span-2418">1</span><span class="MJXp-mo" id="MJXp-Span-2419" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2420">i</span><span class="MJXp-mo" id="MJXp-Span-2421" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2422">n</span></span></span><script type="math/tex" id="MathJax-Element-275">1 \le i \le n</script>, recall that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2423"><span class="MJXp-msubsup" id="MJXp-Span-2424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2425" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2426" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2428">a</span><span class="MJXp-mo" id="MJXp-Span-2429" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430">i</span><span class="MJXp-mo" id="MJXp-Span-2431" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-276">f_g(a, i)</script> is the number of indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2433">j</span><span class="MJXp-mo" id="MJXp-Span-2434" style="margin-left: 0.333em; margin-right: 0.333em;">â‰ </span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435">i</span></span></span><script type="math/tex" id="MathJax-Element-277">j\neq i</script> satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2436"><span class="MJXp-msubsup" id="MJXp-Span-2437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2438" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2439" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-2440">max</span><span class="MJXp-mo" id="MJXp-Span-2441">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442">i</span><span class="MJXp-mo" id="MJXp-Span-2443">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2444">j</span><span class="MJXp-mo" id="MJXp-Span-2445">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2446" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-msubsup" id="MJXp-Span-2447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2448" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2449" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-2450">min</span><span class="MJXp-mo" id="MJXp-Span-2451">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452">i</span><span class="MJXp-mo" id="MJXp-Span-2453">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454">j</span><span class="MJXp-mo" id="MJXp-Span-2455">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2456" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2457">g</span></span></span><script type="math/tex" id="MathJax-Element-278">a_{\max(i, j)} - a_{\min(i, j)} \ge g</script>.</p><p>As mentioned in Hint 3, we only care whether <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2458"><span class="MJXp-msubsup" id="MJXp-Span-2459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2460" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2461" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2462" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2463">a</span><span class="MJXp-mo" id="MJXp-Span-2464" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2465">i</span><span class="MJXp-mo" id="MJXp-Span-2466" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-279">f_g(a, i)</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2467"><span class="MJXp-mn" id="MJXp-Span-2468">0</span></span></span><script type="math/tex" id="MathJax-Element-280">0</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2469"><span class="MJXp-mn" id="MJXp-Span-2470">1</span></span></span><script type="math/tex" id="MathJax-Element-281">1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2471"><span class="MJXp-mn" id="MJXp-Span-2472">2</span></span></span><script type="math/tex" id="MathJax-Element-282">2</script>, or greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2473"><span class="MJXp-mn" id="MJXp-Span-2474">2</span></span></span><script type="math/tex" id="MathJax-Element-283">2</script>. We iterate through <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476">i</span><span class="MJXp-mo" id="MJXp-Span-2477" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2478">1</span><span class="MJXp-mo" id="MJXp-Span-2479" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2480" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-2481" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2482">n</span></span></span><script type="math/tex" id="MathJax-Element-284">i = 1, \ldots, n</script>, and maintain the three smallest previous values <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2483"><span class="MJXp-msubsup" id="MJXp-Span-2484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2486" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-285">a_j</script> (for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2488">j</span><span class="MJXp-mo" id="MJXp-Span-2489" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2490">i</span></span></span><script type="math/tex" id="MathJax-Element-286">j \lt i</script>). For each of these, we check whether the condition holds and increment both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2491"><span class="MJXp-msubsup" id="MJXp-Span-2492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2494" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2496">a</span><span class="MJXp-mo" id="MJXp-Span-2497" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2498">i</span><span class="MJXp-mo" id="MJXp-Span-2499" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-287">f_g(a, i)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2500"><span class="MJXp-msubsup" id="MJXp-Span-2501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2503" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2504" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2505">a</span><span class="MJXp-mo" id="MJXp-Span-2506" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507">j</span><span class="MJXp-mo" id="MJXp-Span-2508" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-288">f_g(a, j)</script> if it does. This leads to an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2509"><span class="MJXp-mrow" id="MJXp-Span-2510"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2511">O</span></span><span class="MJXp-mo" id="MJXp-Span-2512" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2513">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514">n</span><span class="MJXp-mo" id="MJXp-Span-2515" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2516" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2517"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2518">O</span></span><span class="MJXp-mo" id="MJXp-Span-2519" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2520">n</span><span class="MJXp-mo" id="MJXp-Span-2521" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-289">\mathcal{O}(3n) = \mathcal{O}(n)</script> computation per <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2523">g</span></span></span><script type="math/tex" id="MathJax-Element-290">g</script>.</p><p>We simulate each possible first move <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2525">p</span></span></span><script type="math/tex" id="MathJax-Element-291">p</script> by Hao. Let array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2527">b</span></span></span><script type="math/tex" id="MathJax-Element-292">b</script> be array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2529">a</span></span></span><script type="math/tex" id="MathJax-Element-293">a</script> after removing index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2531">p</span></span></span><script type="math/tex" id="MathJax-Element-294">p</script>. When Hao removes index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2533">p</span></span></span><script type="math/tex" id="MathJax-Element-295">p</script>, only the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2534"><span class="MJXp-msubsup" id="MJXp-Span-2535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2536" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2537" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2538" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539">a</span><span class="MJXp-mo" id="MJXp-Span-2540" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2541">p</span><span class="MJXp-mo" id="MJXp-Span-2542" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-296">f_g(a, p)</script> indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2544">q</span></span></span><script type="math/tex" id="MathJax-Element-297">q</script> satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2545"><span class="MJXp-mrow" id="MJXp-Span-2546"><span class="MJXp-mo" id="MJXp-Span-2547" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2550" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-2551" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-msubsup" id="MJXp-Span-2552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2553" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2554" style="vertical-align: -0.4em;">q</span></span><span class="MJXp-mrow" id="MJXp-Span-2555"><span class="MJXp-mo" id="MJXp-Span-2556" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2557" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558">g</span></span></span><script type="math/tex" id="MathJax-Element-298">|a_p - a_q| \ge g</script> will have their <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2559"><span class="MJXp-msubsup" id="MJXp-Span-2560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2561" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2562" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2563" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2564">b</span><span class="MJXp-mo" id="MJXp-Span-2565" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2566">q</span><span class="MJXp-mo" id="MJXp-Span-2567" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2568" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2570" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2571" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2572" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2573">a</span><span class="MJXp-mo" id="MJXp-Span-2574" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2575">q</span><span class="MJXp-mo" id="MJXp-Span-2576" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2577" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2578">1</span></span></span><script type="math/tex" id="MathJax-Element-299">f_g(b, q) = f_g(a, q) - 1</script>, while all others remain unchanged.</p><p>Hao succeeds in keeping the beauty below <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2580">g</span></span></span><script type="math/tex" id="MathJax-Element-300">g</script> if and only if removing index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2581"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2582">p</span></span></span><script type="math/tex" id="MathJax-Element-301">p</script> results in all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2583"><span class="MJXp-msubsup" id="MJXp-Span-2584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2585" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2586" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2588">b</span><span class="MJXp-mo" id="MJXp-Span-2589" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2590">i</span><span class="MJXp-mo" id="MJXp-Span-2591" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2592" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mn" id="MJXp-Span-2593">1</span></span></span><script type="math/tex" id="MathJax-Element-302">f_g(b, i) \le 1</script>. Equivalently, the indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595">q</span></span></span><script type="math/tex" id="MathJax-Element-303">q</script> paired with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2597">p</span></span></span><script type="math/tex" id="MathJax-Element-304">p</script> must include all indices that initially had <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2598"><span class="MJXp-msubsup" id="MJXp-Span-2599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2600" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2601" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2602" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2603">a</span><span class="MJXp-mo" id="MJXp-Span-2604" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2605">i</span><span class="MJXp-mo" id="MJXp-Span-2606" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2607" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2608">2</span></span></span><script type="math/tex" id="MathJax-Element-305">f_g(a, i) = 2</script>.</p><p>If no such removal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2610">p</span></span></span><script type="math/tex" id="MathJax-Element-306">p</script> works, Alex can achieve his goal of keeping the beauty at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2612">g</span></span></span><script type="math/tex" id="MathJax-Element-307">g</script>.</p><p>Checking each first move <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2614">p</span></span></span><script type="math/tex" id="MathJax-Element-308">p</script> requires <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2615"><span class="MJXp-mrow" id="MJXp-Span-2616"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2617">O</span></span><span class="MJXp-mo" id="MJXp-Span-2618" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2620" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2621" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2622" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2623">a</span><span class="MJXp-mo" id="MJXp-Span-2624" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2625">p</span><span class="MJXp-mo" id="MJXp-Span-2626" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2627" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-309">\mathcal{O}(f_g(a, p))</script> time, and summing up over <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2628"><span class="MJXp-msubsup" id="MJXp-Span-2629"><span class="MJXp-mo" id="MJXp-Span-2630" style="margin-left: 0.111em; margin-right: 0.05em;">âˆ‘</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2631" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2632">1</span><span class="MJXp-mo" id="MJXp-Span-2633">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2634">p</span><span class="MJXp-mo" id="MJXp-Span-2635">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2636">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2638" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2639" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2640" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2641">a</span><span class="MJXp-mo" id="MJXp-Span-2642" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2643">p</span><span class="MJXp-mo" id="MJXp-Span-2644" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2645" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mn" id="MJXp-Span-2646">2</span><span class="MJXp-mo" id="MJXp-Span-2647" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2648">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2649">n</span><span class="MJXp-mo" id="MJXp-Span-2650" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2651" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2652"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2653">O</span></span><span class="MJXp-mo" id="MJXp-Span-2654" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2655">n</span><span class="MJXp-mo" id="MJXp-Span-2656" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-310">\sum_{1\le p\le n} f_g(a, p) \le 2(3n) = \mathcal{O}(n)</script> since we only maintain at most three previous values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2657"><span class="MJXp-msubsup" id="MJXp-Span-2658"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2659" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2660" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-311">a_j</script> (for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2662">j</span><span class="MJXp-mo" id="MJXp-Span-2663" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2664">i</span></span></span><script type="math/tex" id="MathJax-Element-312">j \lt i</script>) during the calculation of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2665"><span class="MJXp-msubsup" id="MJXp-Span-2666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2667" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2668" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2669" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2670">a</span><span class="MJXp-mo" id="MJXp-Span-2671" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2672">i</span><span class="MJXp-mo" id="MJXp-Span-2673" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-313">f_g(a, i)</script>.</p><p>The total time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2674"><span class="MJXp-mrow" id="MJXp-Span-2675"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2676">O</span></span><span class="MJXp-mo" id="MJXp-Span-2677" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2678">n</span><span class="MJXp-msubsup" id="MJXp-Span-2679"><span class="MJXp-mi" id="MJXp-Span-2680" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2681" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2682" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2683"><span class="MJXp-mn" id="MJXp-Span-2684" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2685" style="vertical-align: 0.5em;">9</span></span><span class="MJXp-mo" id="MJXp-Span-2686" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-314">\mathcal{O}(n \log_2 10^9)</script> since we perform a binary search over <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2688">g</span></span></span><script type="math/tex" id="MathJax-Element-315">g</script> and compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2689"><span class="MJXp-msubsup" id="MJXp-Span-2690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2691" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2692" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2693" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2694">a</span><span class="MJXp-mo" id="MJXp-Span-2695" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2696">i</span><span class="MJXp-mo" id="MJXp-Span-2697" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-316">f_g(a, i)</script> in linear time per iteration.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation (hxu,PyPy)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
    arr </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))</span><span class="pln">

    </span><span class="com"># calculate the number of j for each i that satisfy arr[max(i,j)] - arr[min(i,j)] &gt;= target</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> measurecount</span><span class="pun">(</span><span class="pln">arr</span><span class="pun">,</span><span class="pln">target</span><span class="pun">):</span><span class="pln">
        m </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">arr</span><span class="pun">)</span><span class="pln">
        count </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">]*</span><span class="pln">m
        minimum </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">m</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">minimum</span><span class="pun">)):</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> minimum</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> target </span><span class="pun">&lt;=</span><span class="pln"> arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
                    count</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            minimum</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
            minimum</span><span class="pun">.</span><span class="pln">sort</span><span class="pun">()</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">minimum</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">:</span><span class="pln">
                minimum</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">()</span><span class="pln">
        maximum </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">m</span><span class="pun">-</span><span class="lit">1</span><span class="pun">,-</span><span class="lit">1</span><span class="pun">,-</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">maximum</span><span class="pun">)):</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> maximum</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> target </span><span class="pun">&gt;=</span><span class="pln"> arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
                    count</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            maximum</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
            maximum</span><span class="pun">.</span><span class="pln">sort</span><span class="pun">(</span><span class="pln">reverse</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">maximum</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">:</span><span class="pln">
                maximum</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> count

    </span><span class="com"># binary search to judge if we can find such pair</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> judge</span><span class="pun">(</span><span class="pln">target</span><span class="pun">):</span><span class="pln">
        count </span><span class="pun">=</span><span class="pln"> measurecount</span><span class="pun">(</span><span class="pln">arr</span><span class="pun">,</span><span class="pln">target</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">count</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
        pick </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">count</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">2</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> count</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">2</span><span class="pun">:</span><span class="pln">
                    pick </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
                    </span><span class="kwd">break</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> count</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">:</span><span class="pln"> 
                    </span><span class="kwd">continue</span><span class="pln"> 
                </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> j</span><span class="pun">==</span><span class="pln">i</span><span class="pun">:</span><span class="pln"> 
                        pick</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">j</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">elif</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> i </span><span class="kwd">and</span><span class="pln"> arr</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> target </span><span class="pun">&lt;=</span><span class="pln"> arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln"> 
                        pick</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">j</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">elif</span><span class="pln"> j </span><span class="pun">&gt;</span><span class="pln"> i </span><span class="kwd">and</span><span class="pln"> arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> target </span><span class="pun">&lt;=</span><span class="pln"> arr</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]:</span><span class="pln">
                        pick</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">j</span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">break</span><span class="pln">

        </span><span class="kwd">for</span><span class="pln"> p </span><span class="kwd">in</span><span class="pln"> pick</span><span class="pun">:</span><span class="pln">
            count2 </span><span class="pun">=</span><span class="pln"> measurecount</span><span class="pun">(</span><span class="pln">arr</span><span class="pun">[:</span><span class="pln">p</span><span class="pun">]+</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">p</span><span class="pun">+</span><span class="lit">1</span><span class="pun">:],</span><span class="pln"> target</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">count2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">       

    front </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">10</span><span class="pun">**</span><span class="lit">9</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">10</span><span class="pln">
    rear </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10</span><span class="pun">**</span><span class="lit">9</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">10</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> front </span><span class="pun">&lt;</span><span class="pln"> rear</span><span class="pun">:</span><span class="pln">
        mid </span><span class="pun">=</span><span class="pln"> front </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rear</span><span class="pun">-</span><span class="pln">front</span><span class="pun">)</span><span class="com">//2</span><span class="pln">
        res </span><span class="pun">=</span><span class="pln"> judge</span><span class="pun">(</span><span class="pln">mid</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> res</span><span class="pun">:</span><span class="pln">
            front </span><span class="pun">=</span><span class="pln"> mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            rear </span><span class="pun">=</span><span class="pln"> mid 
    ans </span><span class="pun">=</span><span class="pln"> front </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">
                       
T </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
t </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
</span><span class="kwd">while</span><span class="pln"> t </span><span class="pun">&lt;=</span><span class="pln"> T</span><span class="pun">:</span><span class="pln">
    main</span><span class="pun">()</span><span class="pln">
    t </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Implementation (maomao90,C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">"bits/stdc++.h"</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAXN </span><span class="pun">=</span><span class="pln"> </span><span class="lit">200005</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> INF </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1000000005</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> fdiv</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> num</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> denom</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> num </span><span class="pun">/</span><span class="pln"> denom </span><span class="pun">-</span><span class="pln"> </span><span class="pun">((</span><span class="pln">num </span><span class="pun">^</span><span class="pln"> denom</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> num </span><span class="pun">%</span><span class="pln"> denom</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> cdiv</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> num</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> denom</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> fdiv</span><span class="pun">(</span><span class="pln">num </span><span class="pun">+</span><span class="pln"> denom </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> denom</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">
 
vector</span><span class="str">&lt;int&gt;</span><span class="pln"> adj</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> add_edge</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  adj</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
  adj</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">bool</span><span class="pln"> check</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    adj</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">set</span><span class="pun">&lt;</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;&gt;</span><span class="pln"> st</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">prv</span><span class="pun">,</span><span class="pln"> prv_id</span><span class="pun">]</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> st</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> prv </span><span class="pun">&gt;=</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        add_edge</span><span class="pun">(</span><span class="pln">prv_id</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    st</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">({</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> i</span><span class="pun">});</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)</span><span class="pln"> st</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        st</span><span class="pun">.</span><span class="pln">erase</span><span class="pun">(</span><span class="pln">prev</span><span class="pun">(</span><span class="pln">st</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()));</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
 
  </span><span class="kwd">int</span><span class="pln"> bad_cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">adj</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      bad_cnt</span><span class="pun">++;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> delta </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">adj</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v </span><span class="pun">:</span><span class="pln"> adj</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">adj</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        delta</span><span class="pun">++;</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">delta </span><span class="pun">==</span><span class="pln"> bad_cnt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> lo </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="pln">INF</span><span class="pun">,</span><span class="pln"> hi </span><span class="pun">=</span><span class="pln"> INF</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lo </span><span class="pun">&lt;</span><span class="pln"> hi</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">int</span><span class="pln"> mid </span><span class="pun">=</span><span class="pln"> cdiv</span><span class="pun">(</span><span class="pln">lo </span><span class="pun">+</span><span class="pln"> hi</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">mid</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        lo </span><span class="pun">=</span><span class="pln"> mid</span><span class="pun">;</span><span class="pln">
      </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        hi </span><span class="pun">=</span><span class="pln"> mid </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> lo </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem !</b><div class="spoiler-content" style="display: block;"><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13063">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="99">99</span>
            </i>
        </a>
    </span>


 Great</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13064">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="12">12</span>
            </i>
        </a>
    </span>


 Good</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13065">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


 Neutral</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13066">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="10">10</span>
            </i>
        </a>
    </span>


 Bad</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13067">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="49">49</span>
            </i>
        </a>
    </span>


 Didn't Solve</p></div></div><h4><a href="https://codeforces.com/contest/2156/problem/F1" title="Codeforces Round 1061 (Div. 2)">2156F1 - Strange Operation (Easy Version)</a></h4> <div class="spoiler"><b class="spoiler-title">hxu10's Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>What will the first element of permutation be for the final result?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>If the first element is odd, we can always reduce it to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2698"><span class="MJXp-mn" id="MJXp-Span-2699">1</span></span></span><script type="math/tex" id="MathJax-Element-317">1</script>, otherwise, we can always reduce it to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2700"><span class="MJXp-mn" id="MJXp-Span-2701">2</span></span></span><script type="math/tex" id="MathJax-Element-318">2</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>If the first element is even, before reducing the first element to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2702"><span class="MJXp-mn" id="MJXp-Span-2703">2</span></span></span><script type="math/tex" id="MathJax-Element-319">2</script>, we must reduce some element to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2704"><span class="MJXp-mn" id="MJXp-Span-2705">1</span></span></span><script type="math/tex" id="MathJax-Element-320">1</script> at first. Which one to choose?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>You should choose the leftmost odd elements that all elements to the left is greater than it. </p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 5</b><div class="spoiler-content" style="display: block;"><p>Treat the rest of elements as a new permutation</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Since we need to find the lexicographically smallest permutation, our goal is to make the numbers on the left as small as possible.</p><p>Suppose we have a permutation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2706"><span class="MJXp-mo" id="MJXp-Span-2707" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2709" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2710" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2711" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2713" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2714" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2715" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2716" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-2717" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2719" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2720" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2721" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-321">[p_1, p_2, \ldots , p_n]</script>.<br>The first question we would like to answer is: where will the number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2722"><span class="MJXp-mn" id="MJXp-Span-2723">1</span></span></span><script type="math/tex" id="MathJax-Element-322">1</script> appear in the final lexicographically smallest permutation?</p><p><strong>Case 1: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2724"><span class="MJXp-msubsup" id="MJXp-Span-2725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2726" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2727" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-323">p_1</script> is odd.</strong></p><p>In this case, the answer is straightforward â€” <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2728"><span class="MJXp-msubsup" id="MJXp-Span-2729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2731" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-324">p_1</script> can always be decreased to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2732"><span class="MJXp-mn" id="MJXp-Span-2733">1</span></span></span><script type="math/tex" id="MathJax-Element-325">1</script>. Hence, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2734"><span class="MJXp-mn" id="MJXp-Span-2735">1</span></span></span><script type="math/tex" id="MathJax-Element-326">1</script> will appear at the first position.</p><p><strong>Case 2: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2736"><span class="MJXp-msubsup" id="MJXp-Span-2737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2738" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2739" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-327">p_1</script> is even.</strong></p><p>This case is more complicated. For a number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2740"><span class="MJXp-msubsup" id="MJXp-Span-2741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2742" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2743" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-328">p_i</script> to be reduced to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2744"><span class="MJXp-mn" id="MJXp-Span-2745">1</span></span></span><script type="math/tex" id="MathJax-Element-329">1</script>, two conditions must hold:</p> <ol>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2746"><span class="MJXp-msubsup" id="MJXp-Span-2747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2748" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2749" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-330">p_i</script> is odd.</li>   <li>All numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2750"><span class="MJXp-mn" id="MJXp-Span-2751">1</span><span class="MJXp-mo" id="MJXp-Span-2752" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2753">2</span><span class="MJXp-mo" id="MJXp-Span-2754" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2755" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-2756" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2758" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2759" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2760" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2761">1</span></span></span><script type="math/tex" id="MathJax-Element-331">1, 2, \ldots, p_i - 1</script> appear to the right of index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2763">i</span></span></span><script type="math/tex" id="MathJax-Element-332">i</script>.<br> In other words, for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2765">j</span><span class="MJXp-mo" id="MJXp-Span-2766" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2767">i</span></span></span><script type="math/tex" id="MathJax-Element-333">j \lt i</script>, we must have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2768"><span class="MJXp-msubsup" id="MJXp-Span-2769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2770" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2771" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-2772" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-2773"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2774" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2775" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-334">p_j \gt p_i</script>.</li> </ol><p>We find the minimum possible index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2777">i</span></span></span><script type="math/tex" id="MathJax-Element-335">i</script> that satisfies both of the above condition, and reduce <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2778"><span class="MJXp-msubsup" id="MJXp-Span-2779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2780" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2781" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-336">p_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2782"><span class="MJXp-mn" id="MJXp-Span-2783">1</span></span></span><script type="math/tex" id="MathJax-Element-337">1</script>.<br>After that, since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2784"><span class="MJXp-msubsup" id="MJXp-Span-2785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2786" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2787" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-338">p_1</script> is even, we reduce <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2788"><span class="MJXp-msubsup" id="MJXp-Span-2789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2790" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2791" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-339">p_1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2792"><span class="MJXp-mn" id="MJXp-Span-2793">2</span></span></span><script type="math/tex" id="MathJax-Element-340">2</script>.</p><p>It can be proven that choosing the smallest such index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2795">i</span></span></span><script type="math/tex" id="MathJax-Element-341">i</script> and performing these two reductions, first decreasing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2796"><span class="MJXp-msubsup" id="MJXp-Span-2797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2798" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2799" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-342">p_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2800"><span class="MJXp-mn" id="MJXp-Span-2801">1</span></span></span><script type="math/tex" id="MathJax-Element-343">1</script>, then decreasing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2802"><span class="MJXp-msubsup" id="MJXp-Span-2803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2804" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2805" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-344">p_1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2806"><span class="MJXp-mn" id="MJXp-Span-2807">2</span></span></span><script type="math/tex" id="MathJax-Element-345">2</script>, will always yield the lexicographically smallest permutation. A formal proof will be given later.</p><p><strong>Recursive construction:</strong></p> <ul>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2808"><span class="MJXp-msubsup" id="MJXp-Span-2809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2810" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2811" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-346">p_1</script> is odd, reducing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2812"><span class="MJXp-msubsup" id="MJXp-Span-2813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2815" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-347">p_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2816"><span class="MJXp-mn" id="MJXp-Span-2817">1</span></span></span><script type="math/tex" id="MathJax-Element-348">1</script> transforms the remaining multiset <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2818"><span class="MJXp-mo" id="MJXp-Span-2819" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2821" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2822" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2823" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2825" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2826" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-2827" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2828" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-2829" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2831" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2832" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2833" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-349">[p_2, p_3, \ldots , p_n]</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2834"><span class="MJXp-mo" id="MJXp-Span-2835" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2836">2</span><span class="MJXp-mo" id="MJXp-Span-2837" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2838">3</span><span class="MJXp-mo" id="MJXp-Span-2839" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2840" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-2841" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2842">n</span><span class="MJXp-mo" id="MJXp-Span-2843" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-350">[2, 3, \ldots, n]</script>. This can be treated as a new permutation problem of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2845">n</span><span class="MJXp-mo" id="MJXp-Span-2846" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2847">1</span></span></span><script type="math/tex" id="MathJax-Element-351">n - 1</script>.</p></li>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2848"><span class="MJXp-msubsup" id="MJXp-Span-2849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2850" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2851" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-352">p_1</script> is even, after reducing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2852"><span class="MJXp-msubsup" id="MJXp-Span-2853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2854" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2855" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-353">p_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2856"><span class="MJXp-mn" id="MJXp-Span-2857">1</span></span></span><script type="math/tex" id="MathJax-Element-354">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2858"><span class="MJXp-msubsup" id="MJXp-Span-2859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2860" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2861" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-355">p_1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2862"><span class="MJXp-mn" id="MJXp-Span-2863">2</span></span></span><script type="math/tex" id="MathJax-Element-356">2</script>,<br> the remaining multiset <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2864"><span class="MJXp-mo" id="MJXp-Span-2865" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2867" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2868" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2869" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2871" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2872" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-2873" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2874" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-2875" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2877" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2878" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2879">i</span><span class="MJXp-mo" id="MJXp-Span-2880">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2881">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2882" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2884" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2885" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2886">i</span><span class="MJXp-mo" id="MJXp-Span-2887">+</span><span class="MJXp-mn" id="MJXp-Span-2888">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2889" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2890" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-2891" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2893" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2894" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2895" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-357">[p_2, p_3, \ldots, p_{i-1}, p_{i+1}, \ldots, p_n]</script> becomes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2896"><span class="MJXp-mo" id="MJXp-Span-2897" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2898">3</span><span class="MJXp-mo" id="MJXp-Span-2899" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2900">4</span><span class="MJXp-mo" id="MJXp-Span-2901" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2902" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-2903" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2904">n</span><span class="MJXp-mo" id="MJXp-Span-2905" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-358">[3, 4, \ldots, n]</script>, which again forms a smaller permutation problem of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2907">n</span><span class="MJXp-mo" id="MJXp-Span-2908" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2909">2</span></span></span><script type="math/tex" id="MathJax-Element-359">n - 2</script>.</p></li> </ul><p>Thus, the process can be applied recursively.</p><p><strong>Complexity Analysis:</strong></p><p>The overall time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2910"><span class="MJXp-mrow" id="MJXp-Span-2911"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2912">O</span></span><span class="MJXp-mo" id="MJXp-Span-2913" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2915" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2916" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2917" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-360">\mathcal{O}(n^2)</script>, which is efficient enough to pass the first subtask (F1).</p></div></div> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>Now let's prove that this solution always lead the permutation to smallest lexigraphically possible. </p><p>Suppose we have permutation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2918"><span class="MJXp-mo" id="MJXp-Span-2919" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2921" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2922" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2923" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2925" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2926" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2927" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2928" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-2929" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2931" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2932" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2933" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-361">[p_1, p_2, \ldots, p_n]</script></p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2934"><span class="MJXp-msubsup" id="MJXp-Span-2935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2936" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2937" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-362">p_1</script> is odd, the conclusion is straightforward. We can always decrease <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2938"><span class="MJXp-msubsup" id="MJXp-Span-2939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2940" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2941" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-363">p_1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2942"><span class="MJXp-mn" id="MJXp-Span-2943">1</span></span></span><script type="math/tex" id="MathJax-Element-364">1</script> and treat the remaining elements as a new permutation.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2944"><span class="MJXp-msubsup" id="MJXp-Span-2945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2946" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2947" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-365">p_1</script> is even, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2948"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2949">i</span></span></span><script type="math/tex" id="MathJax-Element-366">i</script> be the minimum possible index such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2950"><span class="MJXp-msubsup" id="MJXp-Span-2951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2952" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2953" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-367">p_i</script> can be decreased to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2954"><span class="MJXp-mn" id="MJXp-Span-2955">1</span></span></span><script type="math/tex" id="MathJax-Element-368">1</script>. In other words, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2957">i</span></span></span><script type="math/tex" id="MathJax-Element-369">i</script> is the smallest index such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2958"><span class="MJXp-mo" id="MJXp-Span-2959" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-2960" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2962" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2963" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2964" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2965"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2966" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2967" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2968" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2969" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-2970" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2972" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2973" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2974">i</span><span class="MJXp-mo" id="MJXp-Span-2975">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-2976">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2977" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2978" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-2979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2980" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2981" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-370">\min(p_1, p_2, \ldots, p_{i - 1}) \gt p_i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2982"><span class="MJXp-msubsup" id="MJXp-Span-2983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2984" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2985" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-371">p_i</script> is odd. We need to prove that decreasing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2986"><span class="MJXp-msubsup" id="MJXp-Span-2987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2988" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2989" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-372">p_i</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2990"><span class="MJXp-mn" id="MJXp-Span-2991">1</span><span class="MJXp-mo" id="MJXp-Span-2992" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2993">i</span><span class="MJXp-mo" id="MJXp-Span-2994" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2995">n</span></span></span><script type="math/tex" id="MathJax-Element-373">1 \lt i \le n</script>) to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2996"><span class="MJXp-mn" id="MJXp-Span-2997">1</span></span></span><script type="math/tex" id="MathJax-Element-374">1</script> does not affect the lexicographically smallest possible prefix <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2998"><span class="MJXp-mo" id="MJXp-Span-2999" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3001" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3002" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3003" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3005" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3006" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3007" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3008" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3009" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3011" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3012" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3013">i</span><span class="MJXp-mo" id="MJXp-Span-3014">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-3015">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3016" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-375">[p_1, p_2, \ldots, p_{i-1}]</script> that can be formed.</p><p>Transforming <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3017"><span class="MJXp-mo" id="MJXp-Span-3018" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3020" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3021" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3022" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3024" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3025" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3026" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3027" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3028" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3030" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3031" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3032">i</span><span class="MJXp-mo" id="MJXp-Span-3033">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-3034">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3035" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-376">[p_1, p_2, \ldots, p_{i-1}]</script> into its lexicographically smallest possible form involves three types of operations. Suppose an operation chooses indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3037">x</span><span class="MJXp-mo" id="MJXp-Span-3038" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3039">y</span><span class="MJXp-mo" id="MJXp-Span-3040" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3041">z</span></span></span><script type="math/tex" id="MathJax-Element-377">x \lt y \lt z</script> and performs the following steps: 1) item subtract <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3042"><span class="MJXp-mn" id="MJXp-Span-3043">2</span></span></span><script type="math/tex" id="MathJax-Element-378">2</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3044"><span class="MJXp-msubsup" id="MJXp-Span-3045"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3046" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3047" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-379">p_x</script>, 2) add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3048"><span class="MJXp-mn" id="MJXp-Span-3049">1</span></span></span><script type="math/tex" id="MathJax-Element-380">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3050"><span class="MJXp-msubsup" id="MJXp-Span-3051"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3052" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3053" style="vertical-align: -0.4em;">y</span></span></span></span><script type="math/tex" id="MathJax-Element-381">p_y</script>, and 3) add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3054"><span class="MJXp-mn" id="MJXp-Span-3055">1</span></span></span><script type="math/tex" id="MathJax-Element-382">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3056"><span class="MJXp-msubsup" id="MJXp-Span-3057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3058" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3059" style="vertical-align: -0.4em;">z</span></span></span></span><script type="math/tex" id="MathJax-Element-383">p_z</script>.</p><p>We analyze each possible case relative to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3061">i</span></span></span><script type="math/tex" id="MathJax-Element-384">i</script>:</p><p>Case 1: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3063">x</span><span class="MJXp-mo" id="MJXp-Span-3064" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3065">y</span><span class="MJXp-mo" id="MJXp-Span-3066" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3067">z</span><span class="MJXp-mo" id="MJXp-Span-3068" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3069">i</span></span></span><script type="math/tex" id="MathJax-Element-385">x \lt y \lt z \lt i</script></p> <ul>   <li>This case is trivial. Changing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3070"><span class="MJXp-msubsup" id="MJXp-Span-3071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3072" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3073" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-386">p_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3074"><span class="MJXp-mn" id="MJXp-Span-3075">1</span></span></span><script type="math/tex" id="MathJax-Element-387">1</script> only affects indices greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3077">i</span></span></span><script type="math/tex" id="MathJax-Element-388">i</script>, so these operations remain completely valid.</li> </ul><p>Case 2: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3079">x</span><span class="MJXp-mo" id="MJXp-Span-3080" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3081">y</span><span class="MJXp-mo" id="MJXp-Span-3082" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3083">i</span><span class="MJXp-mo" id="MJXp-Span-3084" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3085">z</span></span></span><script type="math/tex" id="MathJax-Element-389">x \lt y \lt i \lt z</script></p> <ul>   <li>Suppose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3086"><span class="MJXp-msubsup" id="MJXp-Span-3087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3088" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3089" style="vertical-align: -0.4em;">z</span></span></span></span><script type="math/tex" id="MathJax-Element-390">p_z</script> is within the subarray <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3090"><span class="MJXp-mo" id="MJXp-Span-3091" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3093" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3094" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3095" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3096" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3097" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3099" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3100" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-3101" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-391">[p_i, \ldots, p_n]</script>. After changing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3102"><span class="MJXp-msubsup" id="MJXp-Span-3103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3104" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3105" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-392">p_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3106"><span class="MJXp-mn" id="MJXp-Span-3107">1</span></span></span><script type="math/tex" id="MathJax-Element-393">1</script>, the element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3108"><span class="MJXp-msubsup" id="MJXp-Span-3109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3110" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3111" style="vertical-align: -0.4em;">z</span></span></span></span><script type="math/tex" id="MathJax-Element-394">p_z</script> (or its value) still exists, perhaps at a different position, but the multiset of values in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3112"><span class="MJXp-mo" id="MJXp-Span-3113" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3115" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3116" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3117" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3118" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3119" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3121" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3122" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-3123" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-395">[p_i, \ldots, p_n]</script> remains unchanged. Therefore, the operation can still be performed.</li> </ul><p>Case 3: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3125">x</span><span class="MJXp-mo" id="MJXp-Span-3126" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3127">i</span><span class="MJXp-mo" id="MJXp-Span-3128" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3129">y</span><span class="MJXp-mo" id="MJXp-Span-3130" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3131">z</span></span></span><script type="math/tex" id="MathJax-Element-396">x \lt i \lt y \lt z</script></p> <ul>   <li>Since the operation does not depend on the relative order or values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3132"><span class="MJXp-msubsup" id="MJXp-Span-3133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3134" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3135" style="vertical-align: -0.4em;">y</span></span></span></span><script type="math/tex" id="MathJax-Element-397">p_y</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3136"><span class="MJXp-msubsup" id="MJXp-Span-3137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3138" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3139" style="vertical-align: -0.4em;">z</span></span></span></span><script type="math/tex" id="MathJax-Element-398">p_z</script>, and the multiset <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3140"><span class="MJXp-mo" id="MJXp-Span-3141" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3143" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3144" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3145" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3146" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3147" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3149" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3150" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-3151" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-399">[p_i, \ldots, p_n]</script> is preserved, we can still find suitable <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3152"><span class="MJXp-msubsup" id="MJXp-Span-3153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3154" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3155" style="vertical-align: -0.4em;">y</span></span></span></span><script type="math/tex" id="MathJax-Element-400">p_y</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3156"><span class="MJXp-msubsup" id="MJXp-Span-3157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3158" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3159" style="vertical-align: -0.4em;">z</span></span></span></span><script type="math/tex" id="MathJax-Element-401">p_z</script> to perform the operation. Hence, this case also remains valid.</li> </ul><p>Case 4: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3161">y</span><span class="MJXp-mo" id="MJXp-Span-3162" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3163">i</span></span></span><script type="math/tex" id="MathJax-Element-402">y = i</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3165">z</span><span class="MJXp-mo" id="MJXp-Span-3166" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3167">i</span></span></span><script type="math/tex" id="MathJax-Element-403">z = i</script></p> <ul>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3168"><span class="MJXp-msubsup" id="MJXp-Span-3169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3170" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3171" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3172" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-3173">1</span></span></span><script type="math/tex" id="MathJax-Element-404">p_i \gt 1</script>, then after decreasing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3174"><span class="MJXp-msubsup" id="MJXp-Span-3175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3176" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3177" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-405">p_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3178"><span class="MJXp-mn" id="MJXp-Span-3179">1</span></span></span><script type="math/tex" id="MathJax-Element-406">1</script>, there must exist some index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3181">j</span><span class="MJXp-mo" id="MJXp-Span-3182" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3183">i</span></span></span><script type="math/tex" id="MathJax-Element-407">j \gt i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3184"><span class="MJXp-msubsup" id="MJXp-Span-3185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3186" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3187" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-408">p_j</script> equals the original value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3188"><span class="MJXp-msubsup" id="MJXp-Span-3189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3190" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3191" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-409">p_i</script>. Thus, the operation can still be performed using <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3192"><span class="MJXp-msubsup" id="MJXp-Span-3193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3194" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3195" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-410">p_j</script>.</p></li>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3196"><span class="MJXp-msubsup" id="MJXp-Span-3197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3198" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3199" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3200" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3201">1</span></span></span><script type="math/tex" id="MathJax-Element-411">p_i = 1</script>, then it is impossible for any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3203">j</span><span class="MJXp-mo" id="MJXp-Span-3204" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3205">i</span></span></span><script type="math/tex" id="MathJax-Element-412">j \lt i</script> to have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3206"><span class="MJXp-msubsup" id="MJXp-Span-3207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3208" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3209" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-3210" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3211">1</span></span></span><script type="math/tex" id="MathJax-Element-413">p_j = 1</script>, as that would violate the rule of minimality. This is precisely why we must choose the smallest possible index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3213">i</span></span></span><script type="math/tex" id="MathJax-Element-414">i</script> for which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3214"><span class="MJXp-msubsup" id="MJXp-Span-3215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3216" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3217" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-415">p_i</script> can be reduced to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3218"><span class="MJXp-mn" id="MJXp-Span-3219">1</span></span></span><script type="math/tex" id="MathJax-Element-416">1</script>; otherwise, the prefix could incorrectly contain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3220"><span class="MJXp-mn" id="MJXp-Span-3221">1</span></span></span><script type="math/tex" id="MathJax-Element-417">1</script>.</p></li> </ul><p>Therefore, if there exists a sequence of operations that transforms <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3222"><span class="MJXp-mo" id="MJXp-Span-3223" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3225" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3226" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3227" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3229" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3230" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3231" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3232" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3233" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3235" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3236" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3237">i</span><span class="MJXp-mo" id="MJXp-Span-3238">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-3239">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3240" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-418">[p_1, p_2, \ldots, p_{i-1}]</script> into the lexicographically smallest possible prefix, none of these operations will be affected by decreasing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3241"><span class="MJXp-msubsup" id="MJXp-Span-3242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3243" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3244" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-419">p_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3245"><span class="MJXp-mn" id="MJXp-Span-3246">1</span></span></span><script type="math/tex" id="MathJax-Element-420">1</script> beforehand.</p><p>Hence, we can always decrease <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3247"><span class="MJXp-msubsup" id="MJXp-Span-3248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3249" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3250" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-421">p_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3251"><span class="MJXp-mn" id="MJXp-Span-3252">1</span></span></span><script type="math/tex" id="MathJax-Element-422">1</script> without affecting the lexicographically smallest prefix.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation (PyPy)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
    p </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    seq </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
    indexes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">i </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)]</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> update</span><span class="pun">(</span><span class="pln">indexes</span><span class="pun">):</span><span class="pln">
        count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> indexes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">  </span><span class="kwd">continue</span><span class="pln">
            indexes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> count
            count </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    curr </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[-</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">n
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">  
            </span><span class="kwd">continue</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> indexes</span><span class="pun">[</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
            ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curr
            curr </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            indexes</span><span class="pun">[</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln">
            update</span><span class="pun">(</span><span class="pln">indexes</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">continue</span><span class="pln"> 
        prefix </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
        pick </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">continue</span><span class="pln"> 
            </span><span class="kwd">if</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> prefix </span><span class="kwd">or</span><span class="pln"> indexes</span><span class="pun">[</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
                prefix </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">prefix</span><span class="pun">,</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])</span><span class="pln">
                </span><span class="kwd">continue</span><span class="pln">
            pick </span><span class="pun">=</span><span class="pln"> j 
            </span><span class="kwd">break</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curr 
        curr </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curr
        curr </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        indexes</span><span class="pun">[</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln">
        indexes</span><span class="pun">[</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln">
        update</span><span class="pun">(</span><span class="pln">indexes</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(*</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">      
T </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">T</span><span class="pun">):</span><span class="pln">
    main</span><span class="pun">()</span><span class="pln"> </span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Tester's Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Each move only shuffles the triple of <strong>consecutive values</strong> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3253"><span class="MJXp-mrow" id="MJXp-Span-3254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3255">a</span><span class="MJXp-mo" id="MJXp-Span-3256" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3257">a</span><span class="MJXp-mo" id="MJXp-Span-3258" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3259">1</span><span class="MJXp-mo" id="MJXp-Span-3260" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3261">a</span><span class="MJXp-mo" id="MJXp-Span-3262" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3263">2</span></span></span></span><script type="math/tex" id="MathJax-Element-423">{a,a+1,a+2}</script> and places the <strong>smallest</strong> among them at the <strong>leftmost</strong> of the three chosen positions.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Think in terms of a valueâ€™s <strong>rank</strong> among the not-yet-fixed values: one move on a value is like moving it <strong>two places to the left</strong> in that order. A value at rank <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3265">r</span></span></span><script type="math/tex" id="MathJax-Element-424">r</script> can move at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3266"><span class="MJXp-mo" id="MJXp-Span-3267" style="margin-left: 0em; margin-right: 0em;">âŒŠ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3268">r</span><span class="MJXp-mrow" id="MJXp-Span-3269"><span class="MJXp-mo" id="MJXp-Span-3270" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-3271">2</span><span class="MJXp-mo" id="MJXp-Span-3272" style="margin-left: 0em; margin-right: 0em;">âŒ‹</span></span></span><script type="math/tex" id="MathJax-Element-425">\lfloor r/2\rfloor</script> steps.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>To minimize lexicographically, process positions from left to right and push the current choice as far left as allowed. Parity matters: when the current rank is odd, you must â€œpairâ€ with a smaller value to make the plan realizable.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>We want the lexicographically smallest permutation reachable by the triple move. Focus on the <strong>first position</strong> :</p> <ul>   <li>If the first value is <strong>odd</strong>, we can keep applying moves that reduce it by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3273"><span class="MJXp-mn" id="MJXp-Span-3274">2</span></span></span><script type="math/tex" id="MathJax-Element-426">2</script> until it becomes <strong><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3275"><span class="MJXp-mn" id="MJXp-Span-3276">1</span></span></span><script type="math/tex" id="MathJax-Element-427">1</script></strong>.</li>   <li>If it is <strong>even</strong>, we can keep reducing by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3277"><span class="MJXp-mn" id="MJXp-Span-3278">2</span></span></span><script type="math/tex" id="MathJax-Element-428">2</script> until it becomes <strong><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3279"><span class="MJXp-mn" id="MJXp-Span-3280">2</span></span></span><script type="math/tex" id="MathJax-Element-429">2</script></strong>.</li> </ul><p>Why? Each move that subtracts <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3281"><span class="MJXp-mn" id="MJXp-Span-3282">2</span></span></span><script type="math/tex" id="MathJax-Element-430">2</script> from some position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3284">i</span></span></span><script type="math/tex" id="MathJax-Element-431">i</script> uses two positions <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3286">j</span><span class="MJXp-mo" id="MJXp-Span-3287" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3288">k</span></span></span><script type="math/tex" id="MathJax-Element-432">j,k</script> to its right that currently hold the two consecutive values just below it. In a permutation these exist until you reach <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3289"><span class="MJXp-mn" id="MJXp-Span-3290">1</span></span></span><script type="math/tex" id="MathJax-Element-433">1</script> (odd start) or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3291"><span class="MJXp-mn" id="MJXp-Span-3292">2</span></span></span><script type="math/tex" id="MathJax-Element-434">2</script> (even start). Using them only increases those right-side values by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3293"><span class="MJXp-mn" id="MJXp-Span-3294">1</span></span></span><script type="math/tex" id="MathJax-Element-435">1</script>, so they never block making the first value as small as parity allows.</p><p>Now suppose the first value is even and we set it to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3295"><span class="MJXp-mn" id="MJXp-Span-3296">2</span></span></span><script type="math/tex" id="MathJax-Element-436">2</script>. The next question is: <strong>where should <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3297"><span class="MJXp-mn" id="MJXp-Span-3298">1</span></span></span><script type="math/tex" id="MathJax-Element-437">1</script> go?</strong> The correct choice is the <strong>leftmost</strong> value that can be reduced to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3299"><span class="MJXp-mn" id="MJXp-Span-3300">1</span></span></span><script type="math/tex" id="MathJax-Element-438">1</script>.</p><p>Two simple facts characterize when a value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3302">v</span></span></span><script type="math/tex" id="MathJax-Element-439">v</script> can be reduced to a target <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3304">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3305">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3306">t</span></span></span><script type="math/tex" id="MathJax-Element-440">cnt</script>:</p> <ol>   <li><strong>Parity:</strong> moves change a value by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3307"><span class="MJXp-mo" id="MJXp-Span-3308" style="margin-left: 0em; margin-right: 0.111em;">Â±</span><span class="MJXp-mn" id="MJXp-Span-3309">2</span></span></span><script type="math/tex" id="MathJax-Element-441">\pm 2</script> overall, so <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3311">v</span><span class="MJXp-mo" id="MJXp-Span-3312" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¡</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3313">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3314">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3315">t</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3316"><span class="MJXp-mspace" id="MJXp-Span-3317" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-3318" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-3319">mod</span><span class="MJXp-mspace" id="MJXp-Span-3320" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-3321">2</span><span class="MJXp-mo" id="MJXp-Span-3322" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-442">v \equiv cnt \pmod 2</script> is necessary.</li>   <li><strong>No smaller blockers to the left:</strong> to reduce <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3324">v</span></span></span><script type="math/tex" id="MathJax-Element-443">v</script> down step by step, for each intermediate step you must pick the pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3325"><span class="MJXp-mrow" id="MJXp-Span-3326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3327">x</span><span class="MJXp-mo" id="MJXp-Span-3328" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3329">x</span><span class="MJXp-mo" id="MJXp-Span-3330" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3331">1</span></span></span></span><script type="math/tex" id="MathJax-Element-444">{x,x+1}</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3333">x</span><span class="MJXp-mo" id="MJXp-Span-3334" style="margin-left: 0.333em; margin-right: 0.333em;">âˆˆ</span><span class="MJXp-mrow" id="MJXp-Span-3335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3336">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3337">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3338">t</span><span class="MJXp-mo" id="MJXp-Span-3339" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3340">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3341">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3342">t</span><span class="MJXp-mo" id="MJXp-Span-3343" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3344">1</span><span class="MJXp-mo" id="MJXp-Span-3345" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3346" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3347" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3348">v</span><span class="MJXp-mo" id="MJXp-Span-3349" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-3350">1</span></span></span></span><script type="math/tex" id="MathJax-Element-445">x \in {cnt,cnt+1,\dots,v-1}</script> to the <strong>right</strong> of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3352">v</span></span></span><script type="math/tex" id="MathJax-Element-446">v</script>. So <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3354">v</span></span></span><script type="math/tex" id="MathJax-Element-447">v</script> must lie to the <strong>left</strong> of <strong>all</strong> values in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3355"><span class="MJXp-mo" id="MJXp-Span-3356" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3357">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3358">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3359">t</span><span class="MJXp-mo" id="MJXp-Span-3360" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3361">v</span><span class="MJXp-mo" id="MJXp-Span-3362" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-3363">1</span><span class="MJXp-mo" id="MJXp-Span-3364" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-448">[cnt, v-1]</script>.</li> </ol><p>This gives a clean greedy: at step <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3366">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3367">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3368">t</span><span class="MJXp-mo" id="MJXp-Span-3369" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3370">1</span><span class="MJXp-mo" id="MJXp-Span-3371" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3372">2</span><span class="MJXp-mo" id="MJXp-Span-3373" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3374" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3375" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3376">n</span></span></span><script type="math/tex" id="MathJax-Element-449">cnt=1,2,\dots,n</script>, among values <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3378">i</span><span class="MJXp-mo" id="MJXp-Span-3379" style="margin-left: 0.333em; margin-right: 0.333em;">âˆˆ</span><span class="MJXp-mo" id="MJXp-Span-3380" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3381">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3382">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3383">t</span><span class="MJXp-mo" id="MJXp-Span-3384" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3385">n</span><span class="MJXp-mo" id="MJXp-Span-3386" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-450">i\in[cnt\ldots n]</script>, scan by increasing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3388">i</span></span></span><script type="math/tex" id="MathJax-Element-451">i</script> and keep the running <strong>minimum position</strong> seen so far. Every time that minimum improves (a â€œrecord minimumâ€), if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3390">i</span><span class="MJXp-mo" id="MJXp-Span-3391" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¡</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3392">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3393">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3394">t</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3395"><span class="MJXp-mspace" id="MJXp-Span-3396" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-3397" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-3398">mod</span><span class="MJXp-mspace" id="MJXp-Span-3399" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-3400">2</span><span class="MJXp-mo" id="MJXp-Span-3401" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-452">i \equiv cnt \pmod 2</script> then value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3403">i</span></span></span><script type="math/tex" id="MathJax-Element-453">i</script> is feasible to reduce to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3405">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3406">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3407">t</span></span></span><script type="math/tex" id="MathJax-Element-454">cnt</script>; among all feasible ones, the final record minimum is <strong>leftmost</strong> and is the one we must take.</p><p>Why lexicographically optimal? The array first differs where we place <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3409">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3410">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3411">t</span></span></span><script type="math/tex" id="MathJax-Element-455">cnt</script>. Picking the <strong>leftmost feasible</strong> position ensures the smallest possible number at that index. Any alternative that puts <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3413">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3414">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3415">t</span></span></span><script type="math/tex" id="MathJax-Element-456">cnt</script> strictly to the right makes the prefix strictly larger and cannot be beaten later.</p><p>After choosing the index <code class="tt">cur</code> where we install <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3417">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3418">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3419">t</span></span></span><script type="math/tex" id="MathJax-Element-457">cnt</script>, we conceptually â€œpull downâ€ the current value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3421">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3422">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3423">l</span><span class="MJXp-mo" id="MJXp-Span-3424" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3425">p</span><span class="MJXp-mo" id="MJXp-Span-3426" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3427">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3428">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3429">r</span><span class="MJXp-mo" id="MJXp-Span-3430" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-458">val=p[cur]</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3432">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3433">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3434">t</span></span></span><script type="math/tex" id="MathJax-Element-459">cnt</script> by a chain of moves. Each such move also raises exactly one of the values in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3435"><span class="MJXp-mrow" id="MJXp-Span-3436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3437">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3438">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3439">t</span><span class="MJXp-mo" id="MJXp-Span-3440" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3441" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3442" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3443">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3444">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3445">l</span><span class="MJXp-mo" id="MJXp-Span-3446" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-3447">1</span></span></span></span><script type="math/tex" id="MathJax-Element-460">{cnt,\ldots,val-1}</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3448"><span class="MJXp-mn" id="MJXp-Span-3449">1</span></span></span><script type="math/tex" id="MathJax-Element-461">1</script>. Over the whole chain, <strong>every</strong> number in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3450"><span class="MJXp-mrow" id="MJXp-Span-3451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3452">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3453">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3454">t</span><span class="MJXp-mo" id="MJXp-Span-3455" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3456" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3457" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3458">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3459">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3460">l</span><span class="MJXp-mo" id="MJXp-Span-3461" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-3462">1</span></span></span></span><script type="math/tex" id="MathJax-Element-462">{cnt,\dots,val-1}</script> gets raised exactly once. So, in one shot, we can <strong>set</strong> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3464">p</span><span class="MJXp-mo" id="MJXp-Span-3465" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3466">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3467">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3468">r</span><span class="MJXp-mo" id="MJXp-Span-3469" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3470" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3471">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3472">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3473">t</span></span></span><script type="math/tex" id="MathJax-Element-463">p[cur]=cnt</script> and <strong>increase</strong> all values in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3474"><span class="MJXp-mo" id="MJXp-Span-3475" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3476">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3477">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3478">t</span><span class="MJXp-mo" id="MJXp-Span-3479" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3480">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3481">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3482">l</span><span class="MJXp-mo" id="MJXp-Span-3483" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-3484">1</span><span class="MJXp-mo" id="MJXp-Span-3485" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-464">[cnt \ldots val-1]</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3486"><span class="MJXp-mn" id="MJXp-Span-3487">1</span></span></span><script type="math/tex" id="MathJax-Element-465">1</script>. The remaining numbers still form a permutation of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3488"><span class="MJXp-mrow" id="MJXp-Span-3489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3490">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3491">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3492">t</span><span class="MJXp-mo" id="MJXp-Span-3493" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3494">1</span><span class="MJXp-mo" id="MJXp-Span-3495" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3496" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3497" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3498">n</span></span></span></span><script type="math/tex" id="MathJax-Element-466">{cnt+1,\dots,n}</script>, and we repeat with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3500">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3501">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3502">t</span><span class="MJXp-mo" id="MJXp-Span-3503" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3504">1</span></span></span><script type="math/tex" id="MathJax-Element-467">cnt+1</script>.</p><p>Because each step is just a linear scan over values and a few local updates, this runs in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3505"><span class="MJXp-mrow" id="MJXp-Span-3506"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3507">O</span></span><span class="MJXp-mo" id="MJXp-Span-3508" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3510" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3511" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3512" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-468">\mathcal{O}(n^2)</script> per test.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;numeric&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;tuple&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;deque&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;functional&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cassert&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;immintrin.h&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">100005</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> pos</span><span class="pun">[</span><span class="lit">100005</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
</span><span class="com">#if _LOCAL_</span><span class="pln">
    freopen</span><span class="pun">(</span><span class="str">"case.txt"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"r"</span><span class="pun">,</span><span class="pln"> stdin</span><span class="pun">);</span><span class="pln">
</span><span class="com">#endif</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">

    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            cin </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            pos</span><span class="pun">[</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> cnt </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">cnt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> cnt</span><span class="pun">,</span><span class="pln"> mn </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> mn</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    mn </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pun">((</span><span class="pln">i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                        cur </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
                    </span><span class="pun">}</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> val </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">cur</span><span class="pun">];</span><span class="pln">
            p</span><span class="pun">[</span><span class="pln">cur</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> cnt</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> cnt</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> val</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                p</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]++;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> val</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> cnt</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            pos</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> cur</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">MathModel's Solution (Bonus/Challenge)</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>A move is only possible on three consecutive values: there must exist an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3514">m</span></span></span><script type="math/tex" id="MathJax-Element-469">m</script> such that the values involved are exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3515"><span class="MJXp-mrow" id="MJXp-Span-3516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3517">m</span><span class="MJXp-mo" id="MJXp-Span-3518" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3519">m</span><span class="MJXp-mo" id="MJXp-Span-3520" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3521">1</span><span class="MJXp-mo" id="MJXp-Span-3522" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3523">m</span><span class="MJXp-mo" id="MJXp-Span-3524" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3525">2</span></span></span></span><script type="math/tex" id="MathJax-Element-470">{m,m+1,m+2}</script> at indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3527">i</span><span class="MJXp-mo" id="MJXp-Span-3528" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3529">j</span><span class="MJXp-mo" id="MJXp-Span-3530" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3531">k</span></span></span><script type="math/tex" id="MathJax-Element-471">i\lt j\lt k</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3532"><span class="MJXp-msubsup" id="MJXp-Span-3533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3534" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3535" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3536" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3537" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-3538" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3540" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3541" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-3542" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3544" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3545" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-3546" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3547" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3548">1</span></span></span><script type="math/tex" id="MathJax-Element-472">p_i=\max(p_j,p_k)+1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3549"><span class="MJXp-msubsup" id="MJXp-Span-3550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3551" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3552" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3553" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3554" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-3555" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3557" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3558" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-3559" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3561" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3562" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-3563" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3564" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3565">2</span></span></span><script type="math/tex" id="MathJax-Element-473">p_i=\min(p_j,p_k)+2</script></p><p>Those equations force the three values to be consecutive and the largest to sit at the leftmost index, which is exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3567">c</span><span class="MJXp-mo" id="MJXp-Span-3568" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mo" id="MJXp-Span-3569" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-3570" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3571">a</span><span class="MJXp-mo" id="MJXp-Span-3572" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3573">b</span><span class="MJXp-mo" id="MJXp-Span-3574" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-474">c\lt \min(a,b)</script> with values <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3575"><span class="MJXp-mrow" id="MJXp-Span-3576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3577">m</span><span class="MJXp-mo" id="MJXp-Span-3578" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3579">m</span><span class="MJXp-mo" id="MJXp-Span-3580" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3581">1</span><span class="MJXp-mo" id="MJXp-Span-3582" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3583">m</span><span class="MJXp-mo" id="MJXp-Span-3584" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3585">2</span></span></span></span><script type="math/tex" id="MathJax-Element-475">{m,m+1,m+2}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>Each move strictly decreases lexicographic order: the first changed index is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3587">i</span><span class="MJXp-mo" id="MJXp-Span-3588" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3589">c</span></span></span><script type="math/tex" id="MathJax-Element-476">i=c</script>, whose value drops from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3591">m</span><span class="MJXp-mo" id="MJXp-Span-3592" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3593">2</span></span></span><script type="math/tex" id="MathJax-Element-477">m+2</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3595">m</span></span></span><script type="math/tex" id="MathJax-Element-478">m</script>; earlier indices remain unchanged.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>Each move removes at least two inversions among the triple (and never adds inversions before <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3597">i</span></span></span><script type="math/tex" id="MathJax-Element-479">i</script>), so the process is acyclic and must terminate.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 5</b><div class="spoiler-content" style="display: block;"><p>Number of operations is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3598"><span class="MJXp-mo" id="MJXp-Span-3599" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mrow" id="MJXp-Span-3600"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3601">O</span></span><span class="MJXp-mo" id="MJXp-Span-3602" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3604" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3605" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3606" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-480">\le \mathcal{O}(n^2)</script> (each removes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3607"><span class="MJXp-mo" id="MJXp-Span-3608" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mn" id="MJXp-Span-3609">2</span></span></span><script type="math/tex" id="MathJax-Element-481">\ge2</script> inversions). The pointer-walk advances by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3610"><span class="MJXp-mo" id="MJXp-Span-3611" style="margin-left: 0em; margin-right: 0.111em;">+</span><span class="MJXp-mn" id="MJXp-Span-3612">1</span></span></span><script type="math/tex" id="MathJax-Element-482">+1</script> when no operations, and jumps back by at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3613"><span class="MJXp-mn" id="MJXp-Span-3614">2</span></span></span><script type="math/tex" id="MathJax-Element-483">2</script> per op. Total steps are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3615"><span class="MJXp-mrow" id="MJXp-Span-3616"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3617">O</span></span><span class="MJXp-mo" id="MJXp-Span-3618" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3619">n</span><span class="MJXp-mo" id="MJXp-Span-3620" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-3621">ops</span><span class="MJXp-mo" id="MJXp-Span-3622" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3623" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3624"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3625">O</span></span><span class="MJXp-mo" id="MJXp-Span-3626" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3628" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3629" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3630" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-484">\mathcal{O}(n+\text{ops})=\mathcal{O}(n^2)</script> overall.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p><strong>Please Read Hints</strong></p><p>Maintain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3632">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3633">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3634">s</span><span class="MJXp-mo" id="MJXp-Span-3635" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3636">v</span><span class="MJXp-mo" id="MJXp-Span-3637" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-485">pos[v]</script>. Iterate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3639">m</span></span></span><script type="math/tex" id="MathJax-Element-486">m</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3640"><span class="MJXp-mn" id="MJXp-Span-3641">0</span></span></span><script type="math/tex" id="MathJax-Element-487">0</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3643">n</span><span class="MJXp-mo" id="MJXp-Span-3644" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-3645">3</span></span></span><script type="math/tex" id="MathJax-Element-488">n-3</script>:</p> <ul>   <li>Let</li> </ul> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3647">a</span><span class="MJXp-mo" id="MJXp-Span-3648" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3649">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3650">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3651">s</span><span class="MJXp-mo" id="MJXp-Span-3652" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3653">m</span><span class="MJXp-mo" id="MJXp-Span-3654" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3655" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-3656" style="width: 1em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3657">b</span><span class="MJXp-mo" id="MJXp-Span-3658" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3659">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3660">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3661">s</span><span class="MJXp-mo" id="MJXp-Span-3662" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3663">m</span><span class="MJXp-mo" id="MJXp-Span-3664" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3665">1</span><span class="MJXp-mo" id="MJXp-Span-3666" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3667" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-3668" style="width: 1em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3669">c</span><span class="MJXp-mo" id="MJXp-Span-3670" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3671">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3672">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3673">s</span><span class="MJXp-mo" id="MJXp-Span-3674" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3675">m</span><span class="MJXp-mo" id="MJXp-Span-3676" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3677">2</span><span class="MJXp-mo" id="MJXp-Span-3678" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3679" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-489"> a=pos[m],\quad b=pos[m+1],\quad c=pos[m+2]. </script></center> <ul>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3681">c</span><span class="MJXp-mo" id="MJXp-Span-3682" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mo" id="MJXp-Span-3683" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-3684" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3685">a</span><span class="MJXp-mo" id="MJXp-Span-3686" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3687">b</span><span class="MJXp-mo" id="MJXp-Span-3688" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-490">c\lt \min(a,b)</script>, apply the operation on indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3689"><span class="MJXp-mrow" id="MJXp-Span-3690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3691">a</span><span class="MJXp-mo" id="MJXp-Span-3692" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3693">b</span><span class="MJXp-mo" id="MJXp-Span-3694" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3695">c</span></span></span></span><script type="math/tex" id="MathJax-Element-491">{a,b,c}</script>:</p>   <ul>     <li>Set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3697">i</span><span class="MJXp-mo" id="MJXp-Span-3698" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3699">c</span></span></span><script type="math/tex" id="MathJax-Element-492">i=c</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3701">j</span><span class="MJXp-mo" id="MJXp-Span-3702" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3703" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-3704" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3705">a</span><span class="MJXp-mo" id="MJXp-Span-3706" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3707">b</span><span class="MJXp-mo" id="MJXp-Span-3708" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-493">j=\min(a,b)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3709"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3710">k</span><span class="MJXp-mo" id="MJXp-Span-3711" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3712" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-3713" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3714">a</span><span class="MJXp-mo" id="MJXp-Span-3715" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3716">b</span><span class="MJXp-mo" id="MJXp-Span-3717" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-494">k=\max(a,b)</script>.</li>     <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3719">a</span><span class="MJXp-mo" id="MJXp-Span-3720" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3721">b</span></span></span><script type="math/tex" id="MathJax-Element-495">a\lt b</script>, write <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3722"><span class="MJXp-mo" id="MJXp-Span-3723" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3724">m</span><span class="MJXp-mo" id="MJXp-Span-3725" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3726">m</span><span class="MJXp-mo" id="MJXp-Span-3727" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3728">1</span><span class="MJXp-mo" id="MJXp-Span-3729" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3730">m</span><span class="MJXp-mo" id="MJXp-Span-3731" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3732">2</span><span class="MJXp-mo" id="MJXp-Span-3733" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-496">(m,m+1,m+2)</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3734"><span class="MJXp-mo" id="MJXp-Span-3735" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3736">i</span><span class="MJXp-mo" id="MJXp-Span-3737" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3738">j</span><span class="MJXp-mo" id="MJXp-Span-3739" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3740">k</span><span class="MJXp-mo" id="MJXp-Span-3741" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-497">(i,j,k)</script> and set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3742"><span class="MJXp-mo" id="MJXp-Span-3743" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3744">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3745">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3746">s</span><span class="MJXp-mo" id="MJXp-Span-3747" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3748">m</span><span class="MJXp-mo" id="MJXp-Span-3749" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3750" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3751">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3752">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3753">s</span><span class="MJXp-mo" id="MJXp-Span-3754" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3755">m</span><span class="MJXp-mo" id="MJXp-Span-3756" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3757">1</span><span class="MJXp-mo" id="MJXp-Span-3758" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3759" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3760">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3761">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3762">s</span><span class="MJXp-mo" id="MJXp-Span-3763" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3764">m</span><span class="MJXp-mo" id="MJXp-Span-3765" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3766">2</span><span class="MJXp-mo" id="MJXp-Span-3767" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3768" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3769" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3770" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3771">i</span><span class="MJXp-mo" id="MJXp-Span-3772" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3773">j</span><span class="MJXp-mo" id="MJXp-Span-3774" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3775">k</span><span class="MJXp-mo" id="MJXp-Span-3776" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-498">(pos[m],pos[m+1],pos[m+2])=(i,j,k)</script>.</li>     <li>Else write <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3777"><span class="MJXp-mo" id="MJXp-Span-3778" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3779">m</span><span class="MJXp-mo" id="MJXp-Span-3780" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3781">m</span><span class="MJXp-mo" id="MJXp-Span-3782" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3783">2</span><span class="MJXp-mo" id="MJXp-Span-3784" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3785">m</span><span class="MJXp-mo" id="MJXp-Span-3786" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3787">1</span><span class="MJXp-mo" id="MJXp-Span-3788" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-499">(m,m+2,m+1)</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3789"><span class="MJXp-mo" id="MJXp-Span-3790" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3791">i</span><span class="MJXp-mo" id="MJXp-Span-3792" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3793">j</span><span class="MJXp-mo" id="MJXp-Span-3794" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3795">k</span><span class="MJXp-mo" id="MJXp-Span-3796" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-500">(i,j,k)</script> and set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3797"><span class="MJXp-mo" id="MJXp-Span-3798" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3799">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3800">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3801">s</span><span class="MJXp-mo" id="MJXp-Span-3802" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3803">m</span><span class="MJXp-mo" id="MJXp-Span-3804" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3805" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3806">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3807">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3808">s</span><span class="MJXp-mo" id="MJXp-Span-3809" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3810">m</span><span class="MJXp-mo" id="MJXp-Span-3811" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3812">2</span><span class="MJXp-mo" id="MJXp-Span-3813" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3814" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3815">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3816">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3817">s</span><span class="MJXp-mo" id="MJXp-Span-3818" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3819">m</span><span class="MJXp-mo" id="MJXp-Span-3820" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3821">1</span><span class="MJXp-mo" id="MJXp-Span-3822" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3823" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3824" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3825" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3826">i</span><span class="MJXp-mo" id="MJXp-Span-3827" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3828">j</span><span class="MJXp-mo" id="MJXp-Span-3829" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3830">k</span><span class="MJXp-mo" id="MJXp-Span-3831" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-501">(pos[m],pos[m+2],pos[m+1])=(i,j,k)</script>.</li>     <li>Then set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3833">m</span><span class="MJXp-mo" id="MJXp-Span-3834" style="margin-left: 0.333em; margin-right: 0.333em;">â†</span><span class="MJXp-mo" id="MJXp-Span-3835" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-3836" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3837">m</span><span class="MJXp-mo" id="MJXp-Span-3838" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-3839">2</span><span class="MJXp-mo" id="MJXp-Span-3840" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3841">0</span><span class="MJXp-mo" id="MJXp-Span-3842" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-502">m\leftarrow\max(m-2,0)</script>.</li>   </ul></li>   <li>Otherwise, set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3844">m</span><span class="MJXp-mo" id="MJXp-Span-3845" style="margin-left: 0.333em; margin-right: 0.333em;">â†</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3846">m</span><span class="MJXp-mo" id="MJXp-Span-3847" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3848">1</span></span></span><script type="math/tex" id="MathJax-Element-503">m\leftarrow m+1</script>.</li> </ul><p>This process terminates when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3850">m</span><span class="MJXp-mo" id="MJXp-Span-3851" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3852">n</span><span class="MJXp-mo" id="MJXp-Span-3853" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-3854">2</span></span></span><script type="math/tex" id="MathJax-Element-504">m=n-2</script>, at which point every triple satisfies <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3856">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3857">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3858">s</span><span class="MJXp-mo" id="MJXp-Span-3859" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3860">m</span><span class="MJXp-mo" id="MJXp-Span-3861" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3862">2</span><span class="MJXp-mo" id="MJXp-Span-3863" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3864" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¥</span><span class="MJXp-mo" id="MJXp-Span-3865" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-3866" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3867">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3868">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3869">s</span><span class="MJXp-mo" id="MJXp-Span-3870" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3871">m</span><span class="MJXp-mo" id="MJXp-Span-3872" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3873" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3874">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3875">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3876">s</span><span class="MJXp-mo" id="MJXp-Span-3877" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3878">m</span><span class="MJXp-mo" id="MJXp-Span-3879" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3880">1</span><span class="MJXp-mo" id="MJXp-Span-3881" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3882" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-505">pos[m+2]\ge\min(pos[m],pos[m+1])</script>, so no legal move exists anywhere. Because each step is lexicographically decreasing (when an operation is performed) and the space of permutations is finite and acyclic under these moves, the result is the lexicographically smallest reachable permutation. The pointer-walk guarantees total time <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3883"><span class="MJXp-mrow" id="MJXp-Span-3884"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3885">O</span></span><span class="MJXp-mo" id="MJXp-Span-3886" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3888" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3889" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3890" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-506">\mathcal{O}(n^2)</script>.</p><p><strong>Challenge: Can you prove the solution?</strong></p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
    n</span><span class="pun">=</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
    p</span><span class="pun">=</span><span class="pln">list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))</span><span class="pln">
    pos</span><span class="pun">=[</span><span class="lit">0</span><span class="pun">]*</span><span class="pln">n
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        pos</span><span class="pun">[</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">]=</span><span class="pln">i
    ch</span><span class="pun">=</span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> ch</span><span class="pun">:</span><span class="pln">
        ch</span><span class="pun">=</span><span class="lit">0</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> m </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">-</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
            a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">c</span><span class="pun">=</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">m</span><span class="pun">],</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">],</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">m</span><span class="pun">+</span><span class="lit">2</span><span class="pun">]</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">c</span><span class="pun">&lt;</span><span class="pln">min</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">)):</span><span class="pln">
                i</span><span class="pun">=</span><span class="pln">c
                </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">&lt;</span><span class="pln">b</span><span class="pun">):</span><span class="pln">
                    j</span><span class="pun">,</span><span class="pln">k</span><span class="pun">=</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b
                    p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">],</span><span class="pln">p</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]=</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">m</span><span class="pun">+</span><span class="lit">2</span><span class="pun">,</span><span class="pln">m</span><span class="pun">+</span><span class="lit">3</span><span class="pln">
                    pos</span><span class="pun">[</span><span class="pln">m</span><span class="pun">],</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">],</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">m</span><span class="pun">+</span><span class="lit">2</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">,</span><span class="pln">j</span><span class="pun">,</span><span class="pln">k
                </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
                    j</span><span class="pun">,</span><span class="pln">k</span><span class="pun">=</span><span class="pln">b</span><span class="pun">,</span><span class="pln">a
                    p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">],</span><span class="pln">p</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]=</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">m</span><span class="pun">+</span><span class="lit">3</span><span class="pun">,</span><span class="pln">m</span><span class="pun">+</span><span class="lit">2</span><span class="pln">
                    pos</span><span class="pun">[</span><span class="pln">m</span><span class="pun">],</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">m</span><span class="pun">+</span><span class="lit">2</span><span class="pun">],</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">,</span><span class="pln">j</span><span class="pun">,</span><span class="pln">k
                ch</span><span class="pun">=</span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(*</span><span class="pln">p</span><span class="pun">)</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem !</b><div class="spoiler-content" style="display: block;"><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13068">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="50">50</span>
            </i>
        </a>
    </span>


 Great</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13069">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


 Good</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13070">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Neutral</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13071">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="62">62</span>
            </i>
        </a>
    </span>


 Bad</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13072">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="27">27</span>
            </i>
        </a>
    </span>


 Didn't Solve</p></div></div><h4><a href="https://codeforces.com/contest/2156/problem/F2" title="Codeforces Round 1061 (Div. 2)">2156F2 - Strange Operation (Hard Version)</a></h4> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Suppose the operation changes indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3892">i</span><span class="MJXp-mo" id="MJXp-Span-3893" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3894">j</span><span class="MJXp-mo" id="MJXp-Span-3895" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3896">k</span></span></span><script type="math/tex" id="MathJax-Element-507">i, j, k</script>, other than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3898">i</span></span></span><script type="math/tex" id="MathJax-Element-508">i</script>, all the other indices relative position doesn't change. </p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Use segment tree and fenwick tree</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>Iterate from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3899"><span class="MJXp-mn" id="MJXp-Span-3900">1</span></span></span><script type="math/tex" id="MathJax-Element-509">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3902">n</span></span></span><script type="math/tex" id="MathJax-Element-510">n</script>, during the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3904">t</span></span></span><script type="math/tex" id="MathJax-Element-511">t</script>-th iteration, find the leftmost element that can be decreased by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3906">t</span></span></span><script type="math/tex" id="MathJax-Element-512">t</script>. </p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>Acclerate the procedure by finding next smaller element.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p><strong>You should Read Editorial of F1 First</strong></p><p>Let the initial permutation be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3908">p</span><span class="MJXp-mo" id="MJXp-Span-3909" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3910" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3912" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3913" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3914" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3915"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3916" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3917" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3918" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3919" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3920" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3922" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3923" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-3924" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-513">p=(p_1,p_2,\dots,p_n)</script>, and let the final array be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3926">q</span><span class="MJXp-mo" id="MJXp-Span-3927" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3928" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3930" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3931" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3932" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3934" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3935" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3936" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3937" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-3938" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3940" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3941" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-3942" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-514">q=(q_1,q_2,\dots,q_n)</script>. Initialize <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3943"><span class="MJXp-msubsup" id="MJXp-Span-3944"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3945" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3946" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3947" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3948">0</span></span></span><script type="math/tex" id="MathJax-Element-515">q_i=0</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3950">i</span></span></span><script type="math/tex" id="MathJax-Element-516">i</script>, meaning every position in the output is still undetermined. During the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3952">t</span></span></span><script type="math/tex" id="MathJax-Element-517">t</script>-th iteration, find the smallest index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3953"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3954">i</span></span></span><script type="math/tex" id="MathJax-Element-518">i</script> whose value can be decreased to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3956">t</span></span></span><script type="math/tex" id="MathJax-Element-519">t</script>. Repeatedly choose this <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3958">i</span></span></span><script type="math/tex" id="MathJax-Element-520">i</script>, locate indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3959"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3960">j</span><span class="MJXp-mo" id="MJXp-Span-3961" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3962">k</span></span></span><script type="math/tex" id="MathJax-Element-521">j,k</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3963"><span class="MJXp-msubsup" id="MJXp-Span-3964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3965" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3966" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3967" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3968" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-3969" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3970"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3971" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3972" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-3973" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3975" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3976" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-3977" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3978" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3979">1</span></span></span><script type="math/tex" id="MathJax-Element-522">p_i=\max(p_j,p_k)+1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3980"><span class="MJXp-msubsup" id="MJXp-Span-3981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3982" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3983" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3984" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3985" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-3986" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3988" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3989" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-3990" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3992" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3993" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-3994" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3995" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3996">2</span></span></span><script type="math/tex" id="MathJax-Element-523">p_i=\min(p_j,p_k)+2</script>, and perform the updates <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3997"><span class="MJXp-msubsup" id="MJXp-Span-3998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3999" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4000" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4001" style="margin-left: 0.333em; margin-right: 0.333em;">â†</span><span class="MJXp-msubsup" id="MJXp-Span-4002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4003" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4004" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4005" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-4006">2</span></span></span><script type="math/tex" id="MathJax-Element-524">p_i\leftarrow p_i-2</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4007"><span class="MJXp-msubsup" id="MJXp-Span-4008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4009" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4010" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-4011" style="margin-left: 0.333em; margin-right: 0.333em;">â†</span><span class="MJXp-msubsup" id="MJXp-Span-4012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4013" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4014" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-4015" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4016">1</span></span></span><script type="math/tex" id="MathJax-Element-525">p_j\leftarrow p_j+1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4017"><span class="MJXp-msubsup" id="MJXp-Span-4018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4019" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4020" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-4021" style="margin-left: 0.333em; margin-right: 0.333em;">â†</span><span class="MJXp-msubsup" id="MJXp-Span-4022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4023" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4024" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-4025" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4026">1</span></span></span><script type="math/tex" id="MathJax-Element-526">p_k\leftarrow p_k+1</script>. This is equivalent to removing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4027"><span class="MJXp-msubsup" id="MJXp-Span-4028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4029" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4030" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-527">p_i</script> and setting <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4031"><span class="MJXp-msubsup" id="MJXp-Span-4032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4033" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4034" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4035" style="margin-left: 0.333em; margin-right: 0.333em;">â†</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4036">t</span></span></span><script type="math/tex" id="MathJax-Element-528">q_i\gets t</script>. After removing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4037"><span class="MJXp-msubsup" id="MJXp-Span-4038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4039" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4040" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-529">p_i</script>, the remaining elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4041"><span class="MJXp-msubsup" id="MJXp-Span-4042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4043" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4044" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-4045" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-4046" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-4047" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4049" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4050" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4051">i</span><span class="MJXp-mo" id="MJXp-Span-4052">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-4053">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4054" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4056" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4057" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4058">i</span><span class="MJXp-mo" id="MJXp-Span-4059">+</span><span class="MJXp-mn" id="MJXp-Span-4060">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4061" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-4062" style="margin-left: 0em; margin-right: 0em;">â€¦</span><span class="MJXp-mo" id="MJXp-Span-4063" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4065" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4066" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-530">p_1,\dots,p_{i-1},p_{i+1},\dots,p_n</script> close the gap (preserving relative order), forming a permutation of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4068">n</span><span class="MJXp-mo" id="MJXp-Span-4069" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-4070">1</span></span></span><script type="math/tex" id="MathJax-Element-531">n-1</script>.</p><p>This remove-and-assign simulation can be supported by a Fenwick tree or a segment tree so that each update and query runs in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4071"><span class="MJXp-mrow" id="MJXp-Span-4072"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-4073">O</span></span><span class="MJXp-mo" id="MJXp-Span-4074" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4075">log</span><span class="MJXp-mo" id="MJXp-Span-4076" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4077">n</span><span class="MJXp-mo" id="MJXp-Span-4078" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-532">\mathcal{O}(\log n)</script> time; however, naively finding the correct index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4080">i</span></span></span><script type="math/tex" id="MathJax-Element-533">i</script> could still cost <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4081"><span class="MJXp-mrow" id="MJXp-Span-4082"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-4083">O</span></span><span class="MJXp-mo" id="MJXp-Span-4084" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4085">n</span><span class="MJXp-mo" id="MJXp-Span-4086" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-534">\mathcal{O}(n)</script> per step. Define the rank of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4087"><span class="MJXp-msubsup" id="MJXp-Span-4088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4089" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4090" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-535">p_i</script> as the number of alive (not yet removed) elements that are not greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4091"><span class="MJXp-msubsup" id="MJXp-Span-4092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4093" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4094" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-536">p_i</script>, including <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4095"><span class="MJXp-msubsup" id="MJXp-Span-4096"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4097" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4098" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-537">p_i</script> itself.</p><p>To speed up the process, keep a pointer at the smallest alive index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4100">i</span></span></span><script type="math/tex" id="MathJax-Element-538">i</script> and check its rank. If the rank is odd, remove this element immediately. If the rank is even, move the pointer to the next smaller element to its right, that is, to the smallest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4102">j</span><span class="MJXp-mo" id="MJXp-Span-4103" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4104">i</span></span></span><script type="math/tex" id="MathJax-Element-539"> j \gt i</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4105"><span class="MJXp-msubsup" id="MJXp-Span-4106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4107" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4108" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-4109" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-4110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4111" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4112" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-540">p_j \lt p_i</script>. Continue until you reach an element with odd rank.</p><p>Although a single "move to the next smaller on the right" step may look linear, the total number of such moves over the whole algorithm is at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4113"><span class="MJXp-mn" id="MJXp-Span-4114">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4115">n</span></span></span><script type="math/tex" id="MathJax-Element-541">2n</script>. If an element is first visited when its rank is even, after some element to its right is removed, its rank becomes odd the next time it is visited; if an elementâ€™s rank is already odd, it is removed immediately upon visit. Therefore each index is visited at most twice.</p><p>To implement this, we maintain two data structures: </p> <ol>   <li><p>A Fenwick tree over values, where a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4116"><span class="MJXp-mn" id="MJXp-Span-4117">1</span></span></span><script type="math/tex" id="MathJax-Element-542">1</script> at position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4118"><span class="MJXp-msubsup" id="MJXp-Span-4119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4120" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4121" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-543">p_i</script> indicates that the value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4122"><span class="MJXp-msubsup" id="MJXp-Span-4123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4124" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4125" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-544">p_i</script> is still alive (and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4126"><span class="MJXp-mn" id="MJXp-Span-4127">0</span></span></span><script type="math/tex" id="MathJax-Element-545">0</script> otherwise). This lets you query the current rank of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4128"><span class="MJXp-msubsup" id="MJXp-Span-4129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4130" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4131" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-546">p_i</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4132"><span class="MJXp-mrow" id="MJXp-Span-4133"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-4134">O</span></span><span class="MJXp-mo" id="MJXp-Span-4135" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4136">log</span><span class="MJXp-mo" id="MJXp-Span-4137" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4138">n</span><span class="MJXp-mo" id="MJXp-Span-4139" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-547">\mathcal{O}(\log n)</script> time.</p></li>   <li><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4141">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4142">p</span></span></span><script type="math/tex" id="MathJax-Element-548">ip</script> denote the array that is the inverse of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4144">p</span></span></span><script type="math/tex" id="MathJax-Element-549">p</script>, i.e., <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4146">i</span><span class="MJXp-msubsup" id="MJXp-Span-4147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4148" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4149" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4151" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4152" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4153" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4154">i</span></span></span><script type="math/tex" id="MathJax-Element-550">ip_{p_i} = i</script>. Store a range-min segment tree over the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4156">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4157">p</span></span></span><script type="math/tex" id="MathJax-Element-551">ip</script> . When the value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4158"><span class="MJXp-msubsup" id="MJXp-Span-4159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4160" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4161" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-552">p_i</script> is removed, set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4163">i</span><span class="MJXp-msubsup" id="MJXp-Span-4164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4165" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4166" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4168" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4169" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4170" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-4171">âˆž</span></span></span><script type="math/tex" id="MathJax-Element-553">ip_{p_i}=\infty</script>. If the current visited index is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4173">i</span></span></span><script type="math/tex" id="MathJax-Element-554">i</script>, then a range-min query on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4174"><span class="MJXp-mo" id="MJXp-Span-4175" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-4176">1</span><span class="MJXp-mo" id="MJXp-Span-4177" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4179" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4180" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4181" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-4182">1</span><span class="MJXp-mo" id="MJXp-Span-4183" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-555">[1,p_i-1]</script> returns the minimum position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4185">j</span></span></span><script type="math/tex" id="MathJax-Element-556">j</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4187">j</span><span class="MJXp-mo" id="MJXp-Span-4188" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4189">i</span></span></span><script type="math/tex" id="MathJax-Element-557">j \gt i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4190"><span class="MJXp-msubsup" id="MJXp-Span-4191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4192" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4193" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-4194" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-4195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4196" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4197" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-558">p_j \lt p_i</script> (the next smaller element on the right by value). Each query and update costs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4198"><span class="MJXp-mrow" id="MJXp-Span-4199"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-4200">O</span></span><span class="MJXp-mo" id="MJXp-Span-4201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4202">log</span><span class="MJXp-mo" id="MJXp-Span-4203" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4204">n</span><span class="MJXp-mo" id="MJXp-Span-4205" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-559">\mathcal{O}(\log n)</script>, and each index is examined at most twice, so the overall complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4206"><span class="MJXp-mrow" id="MJXp-Span-4207"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-4208">O</span></span><span class="MJXp-mo" id="MJXp-Span-4209" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4210">n</span><span class="MJXp-mi" id="MJXp-Span-4211">log</span><span class="MJXp-mo" id="MJXp-Span-4212" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4213">n</span><span class="MJXp-mo" id="MJXp-Span-4214" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-560">\mathcal{O}(n\log n)</script>, which is sufficient for the F2 constraints.</p></li> </ol></div></div> <div class="spoiler"><b class="spoiler-title">Implementation (hxu10,PyPy)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="pln">inf </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10</span><span class="pun">**</span><span class="lit">9</span><span class="pln">

</span><span class="kwd">class</span><span class="pln"> fenwick</span><span class="pun">(</span><span class="kwd">object</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">n </span><span class="pun">=</span><span class="pln"> n
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">cul </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">]*</span><span class="pln">n
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">maxd </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">bin</span><span class="pun">(</span><span class="pln">n</span><span class="pun">))-</span><span class="lit">3</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> update</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln">index</span><span class="pun">,</span><span class="pln">diff</span><span class="pun">):</span><span class="pln">
        i </span><span class="pun">=</span><span class="pln"> index
        </span><span class="kwd">while</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">n</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">cul</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> diff
            i </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)&amp;(-</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> getaccu</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln">index</span><span class="pun">):</span><span class="pln">
        output </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
        i </span><span class="pun">=</span><span class="pln"> index
        </span><span class="kwd">while</span><span class="pln"> i</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">:</span><span class="pln">
            output </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">cul</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
            i </span><span class="pun">-=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)&amp;(-</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> output

</span><span class="kwd">class</span><span class="pln"> segment_tree</span><span class="pun">(</span><span class="kwd">object</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> merge</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln">num</span><span class="pun">,</span><span class="pln">accu</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">accu</span><span class="pun">,</span><span class="pln">num</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">initial</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">n </span><span class="pun">=</span><span class="pln"> n
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">inf </span><span class="pun">=</span><span class="pln"> inf
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">inf</span><span class="pun">]*(</span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,-</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> i</span><span class="pun">&gt;=</span><span class="pln">n</span><span class="pun">:</span><span class="pln">  </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> initial</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="pln">n</span><span class="pun">]</span><span class="pln">
            </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">     </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">merge</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">],</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">])</span><span class="pln">

    </span><span class="kwd">def</span><span class="pln"> update</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln">index</span><span class="pun">,</span><span class="pln">target</span><span class="pun">):</span><span class="pln">
        index </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">n
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">index</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> target
        </span><span class="kwd">while</span><span class="pln"> index </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> index </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
                nexttarget </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">merge</span><span class="pun">(</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">index</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">index</span><span class="pun">-</span><span class="lit">1</span><span class="pun">])</span><span class="pln">
            </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
                nexttarget </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">merge</span><span class="pun">(</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">index</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">index</span><span class="pun">+</span><span class="lit">1</span><span class="pun">])</span><span class="pln">
            </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">index</span><span class="pun">&gt;&gt;</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> nexttarget
            index </span><span class="pun">=</span><span class="pln"> index </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">

    </span><span class="kwd">def</span><span class="pln"> addnum</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln">index</span><span class="pun">,</span><span class="pln">diff</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">index</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">index</span><span class="pun">+</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> diff</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">def</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln">left</span><span class="pun">,</span><span class="pln">right</span><span class="pun">):</span><span class="pln">
        i</span><span class="pun">,</span><span class="pln">j </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">n</span><span class="pun">+</span><span class="pln">left</span><span class="pun">,</span><span class="pln">  </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">n</span><span class="pun">+</span><span class="pln">right</span><span class="pun">+</span><span class="lit">1</span><span class="pln">
        output </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">inf  </span><span class="com"># initial output should be changed if you want to change the merge function</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">j</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> i</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">
                output </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">merge</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">output</span><span class="pun">)</span><span class="pln">
                i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> j</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">
                j </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
                output </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">merge</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">j</span><span class="pun">],</span><span class="pln">output</span><span class="pun">)</span><span class="pln">
            i </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            j </span><span class="pun">=</span><span class="pln"> j </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> output

</span><span class="kwd">def</span><span class="pln"> main</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
    p </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))</span><span class="pln">
    location </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">]*</span><span class="pln">n
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        location</span><span class="pun">[</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i 
    seg </span><span class="pun">=</span><span class="pln"> segment_tree</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> location</span><span class="pun">)</span><span class="pln">
    fen </span><span class="pun">=</span><span class="pln"> fenwick</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        fen</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[-</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">n
    curr </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">  
            </span><span class="kwd">continue</span><span class="pln"> 
        index </span><span class="pun">=</span><span class="pln"> fen</span><span class="pun">.</span><span class="pln">getaccu</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> index </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
            fen</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            seg</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">inf</span><span class="pun">)</span><span class="pln">
            ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curr 
            curr </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">continue</span><span class="pln">
        j </span><span class="pun">=</span><span class="pln"> i 
        </span><span class="kwd">while</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">:</span><span class="pln">
            j </span><span class="pun">=</span><span class="pln"> seg</span><span class="pun">.</span><span class="pln">query</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> 
            nextindex </span><span class="pun">=</span><span class="pln"> fen</span><span class="pun">.</span><span class="pln">getaccu</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> nextindex </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">continue</span><span class="pln"> 
            </span><span class="kwd">break</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curr 
        ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curr </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        curr </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
        seg</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">inf</span><span class="pun">)</span><span class="pln">
        seg</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">],</span><span class="pln">inf</span><span class="pun">)</span><span class="pln">
        fen</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        fen</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">],-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(*</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">

T </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> t </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">T</span><span class="pun">):</span><span class="pln">
    main</span><span class="pun">(</span><span class="pln">t</span><span class="pun">)</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate The Problem !</b><div class="spoiler-content" style="display: block;"><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13073">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="24">24</span>
            </i>
        </a>
    </span>


 Great</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13074">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


 Good</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13075">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="0">0</span>
            </i>
        </a>
    </span>


 Neutral</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13076">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="4">4</span>
            </i>
        </a>
    </span>


 Bad</p><p>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="13077">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="38">38</span>
            </i>
        </a>
    </span>


 Didn't Solve</p></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2156" class="notice" style="text-decoration: none;">Codeforces Round 1061 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>