{
  "contestId": 2087,
  "index": "H",
  "title": "Nim with Special Numbers",
  "timeLimit": "8 seconds",
  "memoryLimit": "512 megabytes",
  "rating": null,
  "tags": [
    "*special",
    "*special"
  ],
  "statementHtml": "<p>Let's recall the rules of the game \"Nim\". The game is played by two players who take turns. They have a certain number of piles of stones (the piles can be of the same size or different sizes; the size is defined as the number of stones in a pile). On their turn, a player must choose any non-empty pile of stones and remove any number of stones from it (at least one). The player who cannot make a move loses.</p>\n<p>In this problem, a modified version of the game will be used. There is a special set of numbers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2\">S</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"></span><script type=\"math/tex\" id=\"MathJax-Element-1\">S</script> that prohibits certain moves. For each number <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-4\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-5\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-6\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-2\">s_i</script> in this set, if the current size of the pile of stones is <span class=\"tex-font-style-bf\">strictly greater</span> than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-7\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-8\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-9\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-10\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-3\">s_i</script>, it cannot be made <span class=\"tex-font-style-bf\">strictly less</span> than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-11\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-12\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-13\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-14\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-4\">s_i</script> in one move. In other words, if the current size of the pile is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-15\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-16\">x</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-5\">x</script>, and the player tries to make a move that results in a size of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-17\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-18\">y</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-6\">y</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-19\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-20\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-21\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-22\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-23\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-24\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-25\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-26\">y</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-7\">x > s_i > y</script> for some number <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-27\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-28\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-29\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-30\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-31\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">∈</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-32\">S</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-8\">s_i \\in S</script>, such a move is not allowed.</p>\n<p>Your task is as follows. Initially, the set <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-33\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-34\">S</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-9\">S</script> is empty. You need to process queries of three types:</p>",
  "inputSpecHtml": "<p>The first line contains a single integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-57\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-58\">q</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-13\">q</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-59\"><span class=\"MJXp-mn\" id=\"MJXp-Span-60\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-61\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-62\">q</span><span class=\"MJXp-mo\" id=\"MJXp-Span-63\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-64\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-65\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-66\"><span class=\"MJXp-mn\" id=\"MJXp-Span-67\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-68\" style=\"vertical-align: 0.5em;\">5</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-14\">1 \\le q \\le 3 \\cdot 10^5</script>) — the number of queries.</p><p>Each query is given in one line in one of the following formats:</p><ul> <li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-69\"><span class=\"MJXp-mn\" id=\"MJXp-Span-70\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-15\">1</script> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-71\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-72\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-73\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-74\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-16\">s_i</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-75\"><span class=\"MJXp-mn\" id=\"MJXp-Span-76\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-77\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-78\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-79\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-80\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-81\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-82\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-83\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-84\"><span class=\"MJXp-mn\" id=\"MJXp-Span-85\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-86\" style=\"vertical-align: 0.5em;\">5</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-17\">1 \\le s_i \\le 3 \\cdot 10^5</script>) — if the number <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-87\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-88\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-89\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-90\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-18\">s_i</script> is in the set <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-91\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-92\">S</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-19\">S</script>, remove it; otherwise, add it to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-93\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-94\">S</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-20\">S</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-95\"><span class=\"MJXp-mn\" id=\"MJXp-Span-96\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-21\">2</script> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-97\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-98\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-99\" style=\"margin-right: 0.05em;\">k</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-100\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-22\">k_i</script> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-101\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-102\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-103\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-104\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-105\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-106\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-107\">1</span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-23\">a_{i,1}</script> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-108\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-109\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-110\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-111\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-112\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-113\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-114\">2</span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-24\">a_{i,2}</script> ... <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-115\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-116\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-117\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-118\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-119\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-120\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-121\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-122\" style=\"margin-right: 0.05em;\">k</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-123\" style=\"vertical-align: -0.4em;\">i</span></span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-25\">a_{i,k_i}</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-124\"><span class=\"MJXp-mn\" id=\"MJXp-Span-125\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-126\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-127\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-128\" style=\"margin-right: 0.05em;\">k</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-129\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-130\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-131\">3</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-26\">1 \\le k_i \\le 3</script>; <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-132\"><span class=\"MJXp-mn\" id=\"MJXp-Span-133\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-134\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-135\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-136\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-137\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-138\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-139\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-140\">j</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-141\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-142\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-143\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-144\"><span class=\"MJXp-mn\" id=\"MJXp-Span-145\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-146\" style=\"vertical-align: 0.5em;\">5</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-27\">1 \\le a_{i,j} \\le 3 \\cdot 10^5</script>) — determine who will win the game if it uses <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-147\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-148\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-149\" style=\"margin-right: 0.05em;\">k</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-150\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-28\">k_i</script> piles of stones with sizes <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-151\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-152\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-153\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-154\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-155\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-156\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-157\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-158\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-159\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-160\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-161\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-162\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-163\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-164\">2</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-165\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-166\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-167\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-168\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-169\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-170\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-171\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-172\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-173\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-174\" style=\"margin-right: 0.05em;\">k</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-175\" style=\"vertical-align: -0.4em;\">i</span></span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-29\">a_{i,1}, a_{i,2}, \\dots, a_{i,k_i}</script>. </li></ul>",
  "outputSpecHtml": "<p>For each query of type <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-176\"><span class=\"MJXp-mn\" id=\"MJXp-Span-177\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-30\">2</script>, output <span class=\"tex-font-style-tt\">First</span> if the player making the first move will win, or <span class=\"tex-font-style-tt\">Second</span> if they will lose.</p>",
  "noteHtml": "",
  "samples": [
    {
      "input": "112 2 1 41 22 2 1 42 3 3 1 41 32 3 3 1 42 2 1 41 42 2 1 51 22 2 1 5",
      "output": "First\nSecond\nSecond\nSecond\nSecond\nFirst\nSecond"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2087/problem/H",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>To solve this problem, we first need to understand how the values of the Grundy function look for this modification of Nim. Let the value of the Grundy function at <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-741\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-742\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-122\">x</script> be denoted as <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-743\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-744\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-745\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-746\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-747\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-123\">G(x)</script>. Let the set <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-748\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-749\">S</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-124\">S</script> consist of numbers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-750\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-751\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-752\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-753\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-754\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-755\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-756\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-757\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-758\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-759\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-760\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-761\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-762\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-763\" style=\"vertical-align: -0.4em;\">k</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-125\">s_1, s_2, \\dots, s_k</script>, with <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-764\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-765\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-766\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-767\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-768\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-769\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-770\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-771\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-772\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mo\" id=\"MJXp-Span-773\" style=\"margin-left: 0em; margin-right: 0em;\">⋯</span><span class=\"MJXp-mo\" id=\"MJXp-Span-774\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-775\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-776\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-777\" style=\"vertical-align: -0.4em;\">k</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-126\">s_1 < s_2 < \\dots < s_k</script>. For all numbers from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-778\"><span class=\"MJXp-mn\" id=\"MJXp-Span-779\">0</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-127\">0</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-780\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-781\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-782\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-783\" style=\"vertical-align: -0.4em;\">1</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-128\">s_1</script>, the Grundy function is equal to the number itself, since the allowed moves for them are the same as in regular Nim. Starting from the value <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-784\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-785\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-786\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-787\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-788\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-789\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-129\">s_1 + 1</script>, the Grundy function will change, but how?</p><p>For the value <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-790\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-791\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-792\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-793\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-794\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-795\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-130\">s_1 + 1</script>, the only possible move leads to the value <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-796\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-797\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-798\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-799\" style=\"vertical-align: -0.4em;\">1</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-131\">s_1</script>, so <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-800\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-801\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-802\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-803\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-804\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-805\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-806\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-807\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-808\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-809\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-810\">0</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-132\">G(s_1 + 1) = 0</script> (except when <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-811\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-812\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-813\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-814\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-815\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-816\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-817\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-818\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-819\">0</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-133\">G(s_1) = 0</script>, in which case <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-820\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-821\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-822\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-823\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-824\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-825\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-826\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-827\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-828\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-829\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-830\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-134\">G(s_1 + 1) = 1</script>). For the value <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-831\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-832\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-833\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-834\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-835\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-836\">2</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-135\">s_1 + 2</script>, there are moves to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-837\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-838\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-839\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-840\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-841\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-842\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-136\">s_1 + 1</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-843\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-844\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-845\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-846\" style=\"vertical-align: -0.4em;\">1</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-137\">s_1</script>; among the values of the Grundy function for them, there will definitely be <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-847\"><span class=\"MJXp-mn\" id=\"MJXp-Span-848\">0</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-138\">0</script>, and if there is also <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-849\"><span class=\"MJXp-mn\" id=\"MJXp-Span-850\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-139\">1</script>, then <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-851\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-852\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-853\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-854\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-855\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-856\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-857\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-858\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-859\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-860\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-861\">2</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-140\">G(s_1 + 2) = 2</script>, otherwise <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-862\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-863\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-864\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-865\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-866\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-867\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-868\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-869\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-870\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-871\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-872\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-141\">G(s_1 + 2) = 1</script>. And so on; by induction, it can be shown that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-873\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-874\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-875\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-876\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-877\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-878\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-879\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-880\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-881\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-882\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-883\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-142\">G(s_1 + i) = i</script> if <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-884\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-885\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-886\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-887\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-888\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-889\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-890\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-891\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-892\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-143\">G(s_1) < i</script>, or <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-893\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-894\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-895\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-896\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-897\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-898\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-899\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-900\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-901\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-902\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-903\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-904\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-905\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-144\">G(s_1 + i) = i - 1</script> otherwise. In other words, in the interval <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-906\"><span class=\"MJXp-mo\" id=\"MJXp-Span-907\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-908\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-909\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-910\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-911\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-912\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-913\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-914\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-915\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-916\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-917\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-145\">[s_1 + 1, s_2]</script>, the values of the Grundy function are <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-918\"><span class=\"MJXp-mn\" id=\"MJXp-Span-919\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-920\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-921\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-922\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-923\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-924\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-925\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-926\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-927\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-928\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-929\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-930\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-931\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-932\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-933\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-934\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-935\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-936\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-937\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-938\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-939\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-940\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-941\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-942\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-943\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-944\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-945\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-946\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-947\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-948\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-949\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-950\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-951\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-952\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-953\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-954\" style=\"margin-left: 0em; margin-right: 0em;\">…</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-146\">0, 1, 2, \\dots, G(s_1) - 1, G(s_1) + 1, G(s_1) + 2, \\dots</script> The same dependency will hold for the interval <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-955\"><span class=\"MJXp-mo\" id=\"MJXp-Span-956\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-957\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-958\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-959\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-960\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-961\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-962\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-963\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-964\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-965\" style=\"vertical-align: -0.4em;\">3</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-966\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-147\">[s_2 + 1, s_3]</script>, and so on.</p><p>Let's start by understanding how to find and maintain the Grundy function for the numbers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-967\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-968\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-969\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-970\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-971\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-972\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-973\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-974\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-975\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-976\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-977\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-978\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-979\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-980\" style=\"vertical-align: -0.4em;\">k</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-148\">s_1, s_2, \\dots, s_k</script>. For each such number, the value of the Grundy function depends on two parameters: the Grundy function at the previous <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-981\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-982\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-983\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-984\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-149\">s_i</script> and the distance to it. Formally, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-985\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-986\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-987\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-988\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-989\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-990\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-991\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-992\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-993\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-994\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-150\">G(s_{i+1})</script> is computed as follows: if <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-995\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-996\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-997\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-998\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-999\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1000\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1001\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1002\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1003\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1004\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1005\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1006\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1007\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1008\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1009\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1010\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1011\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1012\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1013\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1014\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1015\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1016\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-151\">G(s_i) < |s_{i+1} - s_i|</script>, then <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1017\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1018\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1019\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1020\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1021\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1022\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1023\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1024\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1025\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1026\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1027\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1028\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1029\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1030\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1031\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1032\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1033\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1034\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1035\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1036\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1037\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1038\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1039\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1040\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1041\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-152\">G(s_{i+1}) = |s_{i+1} - s_i|</script>, otherwise <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1042\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1043\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1044\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1045\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1046\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1047\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1048\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1049\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1050\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1051\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1052\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1053\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1054\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1055\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1056\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1057\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1058\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1059\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1060\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1061\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1062\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1063\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1064\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1065\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1066\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1067\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1068\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-153\">G(s_{i+1}) = |s_{i+1} - s_i| - 1</script>. Thus, the dependency of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1069\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1070\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1071\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1072\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1073\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1074\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1075\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1076\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1077\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1078\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-154\">G(s_{i+1})</script> on <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1079\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1080\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1081\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1082\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1083\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1084\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1085\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-155\">G(s_i)</script> can be described by something like a ternary operator with three parameters <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1086\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1087\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1088\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1089\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1090\">a</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1091\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1092\">b</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1093\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-156\">(x, a, b)</script>: if the input value is less than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1094\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1095\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-157\">x</script>, return <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1096\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1097\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-158\">a</script>, otherwise return <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1098\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1099\">b</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-159\">b</script>. In this case, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1100\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1101\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1102\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1103\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1104\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1105\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1106\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1107\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1108\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1109\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1110\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1111\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1112\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1113\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1114\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1115\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1116\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-160\">x = |s_{i+1} - s_i|</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1117\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1118\">a</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1119\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1120\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1121\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1122\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1123\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1124\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1125\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1126\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1127\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1128\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1129\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1130\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1131\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1132\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1133\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-161\">a = |s_{i+1} - s_i|</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1134\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1135\">b</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1136\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1137\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1138\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1139\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1140\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1141\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1142\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1143\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1144\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1145\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1146\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1147\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1148\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1149\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1150\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1151\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1152\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-162\">b = |s_{i+1} - s_i| - 1</script>, and the input value is the previous <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1153\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1154\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1155\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1156\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1157\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1158\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1159\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-163\">G(s_i)</script>.</p><p>Now let's try to describe the dependency of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1160\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1161\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1162\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1163\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1164\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1165\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1166\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1167\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1168\">2</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1169\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-164\">G(s_{i+2})</script> on <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1170\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1171\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1172\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1173\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1174\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1175\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1176\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-165\">G(s_i)</script>. This is a combination of the ternary operator describing the dependency of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1177\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1178\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1179\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1180\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1181\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1182\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1183\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1184\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1185\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1186\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-166\">G(s_{i+1})</script> on <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1187\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1188\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1189\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1190\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1191\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1192\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1193\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-167\">G(s_i)</script> and the ternary operator describing the dependency of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1194\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1195\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1196\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1197\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1198\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1199\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1200\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1201\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1202\">2</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1203\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-168\">G(s_{i+2})</script> on <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1204\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1205\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1206\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1207\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1208\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1209\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1210\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1211\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1212\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1213\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-169\">G(s_{i+1})</script>. In fact, a combination of two ternary operators of this kind can also be represented as a ternary operator.</p><p>This allows us to build a segment tree for the following operation: on the segment <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1214\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1215\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1216\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1217\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1218\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1219\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-170\">[l, r]</script>, combine all the ternary operators describing the dependencies of the Grundy function values for the numbers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1220\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1221\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1222\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1223\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1224\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">∈</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1225\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1226\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1227\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1228\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1229\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-171\">s_i \\in [l, r]</script> from the previous ones (or from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1230\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1231\">0</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-172\">0</script> for <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1232\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1233\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1234\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-1235\" style=\"vertical-align: -0.4em;\">1</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-173\">s_1</script>). In the leaves of the segment tree, there will be individual ternary operators for the numbers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1236\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1237\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1238\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1239\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-174\">s_i</script> (or dummy elements), and in the internal nodes, there will be combinations of the ternary operators from the children. Then, to compute the value of the Grundy function for the number <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1240\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1241\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1242\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1243\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-175\">s_i</script>, a query to the segment tree should form a ternary operator describing the dependency of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1244\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1245\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1246\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1247\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1248\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1249\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1250\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-176\">G(s_i)</script> on <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1251\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1252\">G</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1253\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1254\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1255\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-177\">G(0)</script> and provide it with the input <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1256\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1257\">0</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-178\">0</script>.</p><p>For a number which is not in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1258\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1259\">S</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-179\">S</script>, the Grundy function can be easily computed using the largest value <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1260\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1261\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1262\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1263\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-180\">s_i</script> that does not exceed this number. To avoid handling unnecessary cases, we can also explicitly add <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1264\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1265\">0</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-181\">0</script> to the set <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1266\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1267\">S</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-182\">S</script>.</p><p>When adding/removing a number from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1268\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1269\">S</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-183\">S</script>, at most two leaves in the segment tree need to be changed, so each query is processed in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1270\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1271\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1272\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi\" id=\"MJXp-Span-1273\">log</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1274\" style=\"margin-left: 0em; margin-right: 0em;\"></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1275\">A</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1276\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-184\">O(\\log A)</script> time, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1277\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1278\">A</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-185\">A</script> is the maximum number for which we are interested in the Grundy function. Therefore, the entire solution works in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1279\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1280\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1281\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1282\">A</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1283\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1284\">q</span><span class=\"MJXp-mi\" id=\"MJXp-Span-1285\">log</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1286\" style=\"margin-left: 0em; margin-right: 0em;\"></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1287\">A</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1288\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-186\">O(A + q \\log A)</script> time.</p></div></div></div></div>"
}