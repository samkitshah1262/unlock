{
  "contestId": 2087,
  "index": "I",
  "title": "Hamiltonian Partition",
  "timeLimit": "4 seconds",
  "memoryLimit": "512 megabytes",
  "rating": null,
  "tags": [
    "*special",
    "*special"
  ],
  "statementHtml": "<p>You are given a directed acyclic graph with <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-1\">n</script> vertices and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-4\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mi\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Math-italic;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-2\">m</script> edges. The graph contains no cycles or multiple edges.</p>\n<p>You need to partition all the edges of this graph into Hamiltonian cycles (cycles that visit each of the <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-7\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-8\"><span class=\"mi\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-3\">n</script> vertices of the graph exactly once) such that each edge belongs to exactly one cycle. It is obvious that this is impossible for the original graph, so before partitioning, you must add the <span class=\"tex-font-style-bf\">minimum</span> number of edges to the graph so that such a partition exists.</p>\n<p>After adding edges, the graph may contain cycles and/or multiple edges, but it should still not have any self-loops.</p>",
  "inputSpecHtml": "<p>The first line contains two integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-10\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-11\"><span class=\"mi\" id=\"MathJax-Span-12\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-4\">n</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-13\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-14\"><span class=\"mi\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Math-italic;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-5\">m</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-16\" style=\"width: 6.929em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.252em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1005.2em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-17\"><span class=\"mn\" id=\"MathJax-Span-18\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-19\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-20\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-21\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-22\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">100</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-6\">2 \\le n \\le 100</script>; <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-23\" style=\"width: 8.823em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.659em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(0.869em, 1006.66em, 2.708em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-24\"><span class=\"mn\" id=\"MathJax-Span-25\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-26\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-27\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">m</span><span class=\"mo\" id=\"MathJax-Span-28\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mfrac\" id=\"MathJax-Span-29\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 2.438em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;\"><span style=\"position: absolute; clip: rect(3.304em, 1002.22em, 4.332em, -999.997em); top: -4.597em; left: 50%; margin-left: -1.134em;\"><span class=\"mrow\" id=\"MathJax-Span-30\"><span class=\"mi\" id=\"MathJax-Span-31\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-32\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-33\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-34\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">−</span><span class=\"mn\" id=\"MathJax-Span-35\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-36\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.358em, 1000.33em, 4.169em, -999.997em); top: -3.623em; left: 50%; margin-left: -0.16em;\"><span class=\"mn\" id=\"MathJax-Span-37\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(0.869em, 1002.44em, 1.247em, -999.997em); top: -1.296em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.438em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.085em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 2.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-7\">1 \\le m \\le \\frac{n(n-1)}{2}</script>).</p><p>The next <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-38\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-39\"><span class=\"mi\" id=\"MathJax-Span-40\" style=\"font-family: MathJax_Math-italic;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-8\">m</script> lines contain two integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-41\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-42\"><span class=\"msubsup\" id=\"MathJax-Span-43\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-44\" style=\"font-family: MathJax_Math-italic;\">x</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-45\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-9\">x_i</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-46\" style=\"width: 1.085em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.81em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-47\"><span class=\"msubsup\" id=\"MathJax-Span-48\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-49\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-50\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-10\">y_i</script> in the <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-51\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-52\"><span class=\"mi\" id=\"MathJax-Span-53\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-11\">i</script>-th line (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-54\" style=\"width: 7.741em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.847em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1005.85em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-55\"><span class=\"mn\" id=\"MathJax-Span-56\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-57\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-58\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-59\" style=\"font-family: MathJax_Math-italic;\">x</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-60\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-61\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-62\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-63\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-64\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-65\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-66\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-12\">1 \\le x_i, y_i \\le n</script>; <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-67\" style=\"width: 4.007em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.033em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1003.03em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-68\"><span class=\"msubsup\" id=\"MathJax-Span-69\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-70\" style=\"font-family: MathJax_Math-italic;\">x</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-71\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-72\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≠</span><span class=\"msubsup\" id=\"MathJax-Span-73\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-74\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-75\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-13\">x_i \\ne y_i</script>), representing a directed edge from vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-76\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-77\"><span class=\"msubsup\" id=\"MathJax-Span-78\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-79\" style=\"font-family: MathJax_Math-italic;\">x</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-80\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-14\">x_i</script> to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-81\" style=\"width: 1.085em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.81em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-82\"><span class=\"msubsup\" id=\"MathJax-Span-83\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-84\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-85\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-15\">y_i</script>.</p><p>Additional constraints on the input:</p><ul> <li> the given graph has no cycles or multiple edges. </li></ul>",
  "outputSpecHtml": "<p>In the first line, output a single integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-86\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-87\"><span class=\"mi\" id=\"MathJax-Span-88\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-16\">k</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-89\" style=\"width: 7.741em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.847em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1005.85em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-90\"><span class=\"mn\" id=\"MathJax-Span-91\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-92\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-93\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">k</span><span class=\"mo\" id=\"MathJax-Span-94\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-95\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-96\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"mi\" id=\"MathJax-Span-97\" style=\"font-family: MathJax_Math-italic; padding-left: 0.219em;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-17\">1 \\le k \\le n \\cdot m</script>) — the number of edges you add.</p><p>Then output <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-98\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-99\"><span class=\"mi\" id=\"MathJax-Span-100\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-18\">k</script> lines, in the <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-101\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-102\"><span class=\"mi\" id=\"MathJax-Span-103\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-19\">i</script>-th of which there should be two integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-104\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-105\"><span class=\"msubsup\" id=\"MathJax-Span-106\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-107\" style=\"font-family: MathJax_Math-italic;\">x</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-108\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-20\">x_i</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-109\" style=\"width: 1.085em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.81em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-110\"><span class=\"msubsup\" id=\"MathJax-Span-111\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-112\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-113\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-21\">y_i</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-114\" style=\"width: 7.741em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.847em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1005.85em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-115\"><span class=\"mn\" id=\"MathJax-Span-116\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-117\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-118\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-119\" style=\"font-family: MathJax_Math-italic;\">x</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-120\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-121\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-122\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-123\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-124\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-125\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-126\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-22\">1 \\le x_i, y_i \\le n</script>; <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-127\" style=\"width: 4.007em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.033em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1003.03em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-128\"><span class=\"msubsup\" id=\"MathJax-Span-129\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-130\" style=\"font-family: MathJax_Math-italic;\">x</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-131\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-132\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≠</span><span class=\"msubsup\" id=\"MathJax-Span-133\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-134\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-135\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-23\">x_i \\ne y_i</script>), denoting the start and end of the next edge.</p><p>Then in a single line, output a single integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-136\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-137\"><span class=\"mi\" id=\"MathJax-Span-138\" style=\"font-family: MathJax_Math-italic;\">c</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-24\">c</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-139\" style=\"width: 5.901em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.44em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.44em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-140\"><span class=\"mn\" id=\"MathJax-Span-141\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-142\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-143\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">c</span><span class=\"mo\" id=\"MathJax-Span-144\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-145\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-25\">1 \\le c \\le m</script>) — the number of Hamiltonian cycles into which you partition all the edges of the graph.</p><p>In the last line, output <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-146\" style=\"width: 3.466em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1002.6em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-147\"><span class=\"mi\" id=\"MathJax-Span-148\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mo\" id=\"MathJax-Span-149\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mi\" id=\"MathJax-Span-150\" style=\"font-family: MathJax_Math-italic; padding-left: 0.219em;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-26\">m+k</script> integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-151\" style=\"width: 8.931em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.767em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.572em, 1006.77em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-152\"><span class=\"msubsup\" id=\"MathJax-Span-153\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-154\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-155\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-156\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-157\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-158\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-159\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-160\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-161\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-162\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-163\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 2.167em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-164\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"texatom\" id=\"MathJax-Span-165\"><span class=\"mrow\" id=\"MathJax-Span-166\"><span class=\"mi\" id=\"MathJax-Span-167\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">m</span><span class=\"mo\" id=\"MathJax-Span-168\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">+</span><span class=\"mi\" id=\"MathJax-Span-169\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">k</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-27\">a_1, a_2, \\dots, a_{m+k}</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-170\" style=\"width: 5.901em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.44em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.44em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-171\"><span class=\"mn\" id=\"MathJax-Span-172\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-173\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-174\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-175\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-176\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-177\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-178\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">c</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-28\">1 \\le a_i \\le c</script>), where <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-179\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-180\"><span class=\"msubsup\" id=\"MathJax-Span-181\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-182\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-183\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-29\">a_i</script> is the Hamiltonian cycle to which you assign the <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-184\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-185\"><span class=\"mi\" id=\"MathJax-Span-186\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-30\">i</script>-th edge (the edges of the original graph are numbered from <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-187\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-188\"><span class=\"mn\" id=\"MathJax-Span-189\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-31\">1</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-190\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-191\"><span class=\"mi\" id=\"MathJax-Span-192\" style=\"font-family: MathJax_Math-italic;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-32\">m</script>, and the new ones are from <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-193\" style=\"width: 3.466em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1002.55em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-194\"><span class=\"mi\" id=\"MathJax-Span-195\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mo\" id=\"MathJax-Span-196\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-197\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-33\">m+1</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-198\" style=\"width: 3.466em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1002.6em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-199\"><span class=\"mi\" id=\"MathJax-Span-200\" style=\"font-family: MathJax_Math-italic;\">m</span><span class=\"mo\" id=\"MathJax-Span-201\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mi\" id=\"MathJax-Span-202\" style=\"font-family: MathJax_Math-italic; padding-left: 0.219em;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-34\">m+k</script>).</p><p>If there are multiple answers that minimize the number of added edges, output any of them.</p>",
  "noteHtml": "",
  "samples": [
    {
      "input": "3 21 22 3",
      "output": "1\n3 1\n1\n1 1 1"
    },
    {
      "input": "5 41 23 23 45 4",
      "output": "6\n2 3\n4 5\n5 1\n1 5\n2 1\n4 3\n2\n1 2 1 2 1 1 1 2 2 2"
    },
    {
      "input": "4 61 22 44 31 32 31 4",
      "output": "6\n3 1\n4 2\n3 1\n3 2\n2 4\n4 1\n3\n1 1 1 3 2 2 1 2 2 3 3 3"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2087/problem/I",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>Each Hamiltonian cycle will contain some edges from the original graph and some added edges. Let's first understand when a certain set of edges can be part of a Hamiltonian cycle.</p><p>Firstly, there should not be a pair of edges that enter or exit the same vertex. Secondly, there should not be cycles that do not include all vertices. In fact, these two requirements are sufficient — if they are met, all vertices of the graph are divided into separate paths that can be easily glued together into a Hamiltonian cycle.</p><p>This means that the edges of the given graph need to be divided into the minimum number of groups such that each group has at most one incoming/outgoing edge from each vertex, and there are no cycles (except for those which go through all vertices). However, the original graph is acyclic, so the second requirement is actually impossible to violate.</p><p>If we \"split\" the vertices by creating two parts and replacing each directed edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1289\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1290\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1291\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1292\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1293\">y</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1294\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-187\">(x,y)</script> with an edge between vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1295\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1296\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-188\">x</script> in the left part and vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1297\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1298\">y</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-189\">y</script> in the right part, then the requirement of \"at most one incoming/outgoing edge from each vertex in each group\" transforms into \"no vertex is incident to more than one edge\". This means that a group is a matching in a bipartite graph.</p><p>Now our task is to divide this bipartite graph into the minimum number of matchings. One might assume that the number of these matchings equals the maximum of the degrees of the vertices, and indeed this is the case, but finding such a division can be very challenging.</p><p>There is a well-known algorithm for coloring the edges of a bipartite graph with the minimum number of colors in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1299\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1300\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1301\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1302\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1303\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-1304\" style=\"vertical-align: 0.5em;\">3</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1305\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-190\">O(n^3)</script>, which I will describe at the end of this tutorial, but first, I will explain what to do if you do not know this algorithm.</p><p>Let's try to build the division greedily, choosing the maximum matching each time and removing it. However, not every maximum matching will suit us. For example:</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/e02b7a507a25f316b21b3f274980f672caccdf3c.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"> </center><p>If we choose the matching <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1306\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1307\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1308\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1309\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1310\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1311\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1312\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1313\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1314\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1315\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1316\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1317\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1318\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1319\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-191\">[(1, 2), (5, 4)]</script> in this graph, the remaining edges will have to be divided into two groups.</p><p>Let's try to work around this problem. I know at least two ways to do this.</p><p><span class=\"tex-font-style-bf\">Solution 1</span></p><p>The first method is as follows: let's try to find a matching that saturates all vertices of maximum degree (so that when it is removed, the maximum degree decreases by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1320\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1321\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-192\">1</script>). This can be done by searching for a flow with a lower bound on some edges. Even if we use the most basic maximum flow algorithm, the solution will work in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1322\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1323\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1324\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1325\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1326\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-1327\" style=\"vertical-align: 0.5em;\">4</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1328\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-193\">O(n^4)</script>: we will need to find the maximum flow in the network <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1329\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1330\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1331\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1332\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1333\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-194\">O(n)</script> times, the flow value is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1334\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1335\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1336\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1337\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1338\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-195\">O(n)</script> and the number of edges is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1339\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1340\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1341\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1342\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1343\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-1344\" style=\"vertical-align: 0.5em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1345\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-196\">O(n^2)</script>. Using Dinic's algorithm, this can be sped up to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1346\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1347\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1348\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1349\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1350\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1351\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mfrac\" id=\"MJXp-Span-1352\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1353\">11</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1354\">3</span></span></span></span></span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1355\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-197\">O(n^{\\frac{11}{3}})</script>.</p><p>However, this solution requires quite a bit of code, so I will describe an alternative approach.</p><p><span class=\"tex-font-style-bf\">Solution 2</span></p><p>As planned before, we will look for a maximum matching and remove it, but before that, we will transform the graph into a regular bipartite graph (we will add new edges, possibly multiple, so that all vertices' degrees are equal to the maximum).</p><p>In a regular bipartite graph, this greedy approach will actually work: using Hall's theorem, it can be proven that there is always a perfect matching in a regular bipartite graph, and by removing a perfect matching, we reduce the degrees of all vertices (and thus the maximum degree) by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1356\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1357\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-198\">1</script>. This solution will also work in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1358\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1359\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1360\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1361\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1362\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-1363\" style=\"vertical-align: 0.5em;\">4</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1364\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-199\">O(n^4)</script>.</p><p><span class=\"tex-font-style-bf\">Model solution</span></p><p>Now let's bring up the edge coloring algorithm for a bipartite graph in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1365\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1366\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1367\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1368\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1369\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-1370\" style=\"vertical-align: 0.5em;\">3</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1371\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-200\">O(n^3)</script> — this is the one used in the model solution. We start with a graph that has no edges and will add them one by one while maintaining a correct coloring. We will store the coloring as a matrix <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1372\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1373\">c</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1374\">o</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1375\">l</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1376\">o</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1377\">r</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-201\">color</script> of size <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1378\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1379\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1380\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">×</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1381\">d</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-202\">n \\times d</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1382\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1383\">c</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1384\">o</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1385\">l</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1386\">o</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1387\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1388\" style=\"margin-right: 0.05em;\">r</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1389\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1390\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1391\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1392\">j</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-203\">color_{i,j}</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1393\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1394\" style=\"margin-left: 0em; margin-right: 0.111em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1395\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-204\">-1</script> if vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1396\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1397\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-205\">i</script> has no incident edge of color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1398\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1399\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-206\">j</script>, or the index of the other end of such an edge if it exists (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1400\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1401\">d</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-207\">d</script> is the number of colors we use to color the edges — this is simply the maximum degree of a vertex).</p><p>When we add an edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1402\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1403\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1404\">a</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1405\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1406\">b</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1407\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-208\">(a,b)</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1408\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1409\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-209\">a</script> is a vertex in the left part and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1410\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1411\">b</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-210\">b</script> is a vertex in the right part, let's find a free color (a color in which no edge incident to the vertex is colored) for each of these vertices. Such a color will always be found because the number of edges incident to a vertex does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1412\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1413\">d</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-211\">d</script>. Let's say we found such a free color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1414\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1415\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1416\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1417\" style=\"vertical-align: -0.4em;\">a</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-212\">c_a</script> for vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1418\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1419\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-213\">a</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1420\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1421\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1422\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1423\" style=\"vertical-align: -0.4em;\">b</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-214\">c_b</script> for vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1424\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1425\">b</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-215\">b</script>.</p><p>If <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1426\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1427\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1428\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1429\" style=\"vertical-align: -0.4em;\">a</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1430\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1431\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1432\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1433\" style=\"vertical-align: -0.4em;\">b</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-216\">c_a = c_b</script>, we can immediately use this color for the edge. Otherwise, let's make color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1434\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1435\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1436\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1437\" style=\"vertical-align: -0.4em;\">a</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-217\">c_a</script> for vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1438\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1439\">b</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-218\">b</script> free.</p><p>Let's consider the edges having one of these two colors. Each vertex is incident to at most two such edges, and vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1440\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1441\">b</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-219\">b</script> is incident to at most one such edge (since color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1442\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1443\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1444\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1445\" style=\"vertical-align: -0.4em;\">b</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-220\">c_b</script> is free for this vertex). This means that vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1446\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1447\">b</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-221\">b</script> is the end of a path consisting of such edges, and the colors of the edges on this path alternate.</p><p>What will happen if we recolor all edges of color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1448\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1449\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1450\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1451\" style=\"vertical-align: -0.4em;\">a</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-222\">c_a</script> on this path to color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1452\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1453\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1454\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1455\" style=\"vertical-align: -0.4em;\">b</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-223\">c_b</script> and vice versa? For intermediate vertices, nothing will change. For vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1456\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1457\">b</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-224\">b</script>, color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1458\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1459\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1460\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1461\" style=\"vertical-align: -0.4em;\">a</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-225\">c_a</script> will become free, so we can color the added edge with it. The only vertex for which something might change is the other end of this path; let's call it vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1462\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1463\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-226\">x</script>. For it, one color was free before, and now another has become free.</p><p>But what if vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1464\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1465\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-227\">x</script> is vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1466\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1467\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-228\">a</script>, and we changed an edge of color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1468\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1469\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1470\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1471\" style=\"vertical-align: -0.4em;\">b</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-229\">c_b</script> to an edge of color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1472\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1473\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1474\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1475\" style=\"vertical-align: -0.4em;\">a</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-230\">c_a</script>, and now we cannot use color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1476\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1477\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1478\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1479\" style=\"vertical-align: -0.4em;\">a</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-231\">c_a</script> for it? If the graph was not bipartite, this could indeed happen (which is why this algorithm does not always find the optimal edge coloring for arbitrary graphs), but in a bipartite graph, this is impossible. If we consider the path from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1480\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1481\">b</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-232\">b</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1482\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1483\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-233\">x</script>, we transition through edges of color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1484\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1485\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1486\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1487\" style=\"vertical-align: -0.4em;\">a</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-234\">c_a</script> from the right part to the left, and through edges of color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1488\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1489\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1490\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1491\" style=\"vertical-align: -0.4em;\">b</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-235\">c_b</script> from the left to the right. Since vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1492\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1493\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-236\">a</script> is in the left part, we could only reach it through an edge of color <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1494\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1495\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1496\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1497\" style=\"vertical-align: -0.4em;\">a</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-237\">c_a</script>—and for vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1498\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1499\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-238\">a</script>, this color is free, so this is impossible.</p><p>This describes the idea of the algorithm. In the implementation, it is not necessary to explicitly search for a path using something like DFS or BFS; we can simply use a while loop that keeps track of which vertex we are at and which color we need to swap for it.</p><p>Each search for such an alternating path works in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1500\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1501\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1502\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1503\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1504\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-239\">O(n)</script>, and we run it at most <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1505\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1506\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1507\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1508\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1509\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-1510\" style=\"vertical-align: 0.5em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1511\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-240\">O(n^2)</script> times, so the solution works in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1512\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1513\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1514\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1515\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1516\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-1517\" style=\"vertical-align: 0.5em;\">3</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1518\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-241\">O(n^3)</script>.</p><p>In all three solutions, after dividing the edges into groups, we will also need to complete each group into a Hamiltonian cycle, but this remains as an exercise for the reader (this is one of the simplest parts of the problem).</p></div></div></div></div>"
}