{
  "contestId": 2087,
  "index": "D",
  "title": "Uppercase or Lowercase?",
  "timeLimit": "2 seconds",
  "memoryLimit": "512 megabytes",
  "rating": null,
  "tags": [
    "*special",
    "*special",
    "interactive"
  ],
  "statementHtml": "<p><span class=\"tex-font-style-it\">This is an interactive problem.</span></p>\n<p>In a certain database, there are <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-1\">n</script> handles stored in the form of a numbered list. You are interested in one specific handle <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-4\">h</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-4\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mi\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Math-italic;\">h</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-2\">h</script>, or more precisely, in its position in this list.</p>\n<p>You can ask the database for the position <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-5\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-6\">i</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-7\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-8\"><span class=\"mi\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Math-italic;\">i</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-3\">i</script> from the list, and it will return the handle at the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-7\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-8\">i</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-10\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-11\"><span class=\"mi\" id=\"MathJax-Span-12\" style=\"font-family: MathJax_Math-italic;\">i</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-4\">i</script>-th position.</p>\n<p>All handles are non-empty strings consisting of at most <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-9\"><span class=\"MJXp-mn\" id=\"MJXp-Span-10\">20</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-13\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-14\"><span class=\"mn\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Main;\">20</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-5\">20</script> lowercase Latin letters, <span class=\"tex-font-style-it\">except the first one</span> that can be either a lowercase or an uppercase Latin letter.</p>\n<p>You know that all handles are sorted in lexicographical order, but the problem is that it is unknown whether uppercase letters are considered less than lowercase ones. In other words, you do not know if it is true that all handles starting with uppercase letters come first, followed by those starting with lowercase letters — or vice versa, that all handles starting with lowercase letters come first, followed by those starting with uppercase letters.</p>\n<p>Lexicographical order is the order of standard string comparison, formally defined as follows:</p>\n<p>Due to restricted access to the database, you can make no more than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-35\"><span class=\"MJXp-mn\" id=\"MJXp-Span-36\">10</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-49\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-50\"><span class=\"mn\" id=\"MathJax-Span-51\" style=\"font-family: MathJax_Main;\">10</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-15\">10</script> queries to it. Determine the position of the handle you are interested in, knowing that it is definitely in the list.</p>",
  "inputSpecHtml": "<p>The first line contains the number <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-37\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-38\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-52\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-53\"><span class=\"mi\" id=\"MathJax-Span-54\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-16\">n</script> and the string <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-39\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-40\">h</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-55\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-56\"><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: MathJax_Math-italic;\">h</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-17\">h</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-41\"><span class=\"MJXp-mn\" id=\"MJXp-Span-42\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-43\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-44\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-45\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-46\">500</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-58\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-59\"><span class=\"mn\" id=\"MathJax-Span-60\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-61\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-62\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-63\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-64\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">500</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-18\">1 \\le n \\le 500</script>)&nbsp;— the total number of handles in the list and the handle you are searching for.</p><p>It is guaranteed that all handles are non-empty strings of no more than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-47\"><span class=\"MJXp-mn\" id=\"MJXp-Span-48\">20</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-65\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-66\"><span class=\"mn\" id=\"MathJax-Span-67\" style=\"font-family: MathJax_Main;\">20</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-19\">20</script> characters, consisting only of lowercase Latin letters, except the first letter that may be an uppercase letter.</p><p>It is also guaranteed that all handles are sorted, unique, and the given handle is in the list.</p></div><div><div class=\"section-title\">Interaction</div><p>To ask a question, output a string in the following format (without quotes): </p><ul> <li> \"<span class=\"tex-font-style-tt\">? i</span>\" (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-49\"><span class=\"MJXp-mn\" id=\"MJXp-Span-50\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-51\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-52\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-53\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-54\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-68\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-69\"><span class=\"mn\" id=\"MathJax-Span-70\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-71\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-72\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">i</span><span class=\"mo\" id=\"MathJax-Span-73\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-74\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-20\">1 \\le i \\le n</script>) </li></ul><p>The jury will return a string <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-55\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-56\">s</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-75\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-76\"><span class=\"mi\" id=\"MathJax-Span-77\" style=\"font-family: MathJax_Math-italic;\">s</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-21\">s</script>&nbsp;— the handle at the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-57\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-58\">i</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-78\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-79\"><span class=\"mi\" id=\"MathJax-Span-80\" style=\"font-family: MathJax_Math-italic;\">i</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-22\">i</script>-th position in the list.</p><p>When you are ready to print the answer, output a single string in the following format (without quotes): </p><ul> <li> \"<span class=\"tex-font-style-tt\">! i</span>\" (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-59\"><span class=\"MJXp-mn\" id=\"MJXp-Span-60\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-61\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-62\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-63\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-64\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-81\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-82\"><span class=\"mn\" id=\"MathJax-Span-83\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-84\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-85\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">i</span><span class=\"mo\" id=\"MathJax-Span-86\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-87\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-23\">1 \\le i \\le n</script>) </li></ul> and terminate the program. Printing the answer <span class=\"tex-font-style-bf\">does not</span> count as a query.<p>The interactor is not adaptive, which means that the list of handles in each test is fixed beforehand.</p><p>If your program asks more than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-65\"><span class=\"MJXp-mn\" id=\"MJXp-Span-66\">10</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-88\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-89\"><span class=\"mn\" id=\"MathJax-Span-90\" style=\"font-family: MathJax_Main;\">10</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-24\">10</script> queries (excluding printing the answer) or violates the format of the queries, the jury will respond with the string \"<span class=\"tex-font-style-tt\">-1</span>\". In this case, your program should terminate immediately to receive a verdict of <span class=\"tex-font-style-tt\">Wrong Answer</span>. Otherwise, you may receive an arbitrary verdict because your solution will continue to read from a closed stream.</p><p>After printing a query, do not forget to output a newline and flush the output. Otherwise, you may receive a verdict of <span class=\"tex-font-style-tt\">Idleness limit exceeded</span>. To do this, use <span class=\"tex-font-style-tt\">System.out.flush()</span>.</p>",
  "outputSpecHtml": "",
  "noteHtml": "<p>Note that spaces in examples are added only for improved readability. When checking solutions, the interactor will not output any empty lines.</p>",
  "samples": [
    {
      "input": "4 adedalic\n\nBleddest\n\nNeon\n\nadedalic\n\nawoo",
      "output": "? 1\n\n? 2\n\n? 3\n\n? 4\n\n! 3"
    },
    {
      "input": "6 tourist\n\njiangly\n\ntourist\n\nRadewoosh",
      "output": "? 1\n\n? 3\n\n? 6\n\n! 3"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2087/problem/D",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>Note that if the order of words was determined, we could solve it using a regular binary search, that needs <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-120\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-121\"><span class=\"MJXp-mo\" id=\"MJXp-Span-122\" style=\"margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;\"><span class=\"MJXp-right MJXp-scale7\" style=\"font-size: 1.978em; margin-left: -0.08em;\">⌈</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-123\"><span class=\"MJXp-mi\" id=\"MJXp-Span-124\" style=\"margin-right: 0.05em;\">log</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-125\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-126\" style=\"margin-left: 0em; margin-right: 0em;\"></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-127\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-128\">n</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-129\" style=\"margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;\"><span class=\"MJXp-right MJXp-scale7\" style=\"font-size: 1.978em; margin-left: -0.08em;\">⌉</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-24\">\\left\\lceil \\log_2{n} \\right\\rceil</script> queries (we will return to this later). In other words, for <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-130\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-131\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-132\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-133\">500</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">n \\le 500</script>, we will need no more than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-134\"><span class=\"MJXp-mn\" id=\"MJXp-Span-135\">9</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">9</script> queries. This means we have one query to spare.</p><p>So let's ask about the first position. If we receive a handle that starts with an uppercase letter, then either uppercase letters come before lowercase letters, or there are no handles that start with a lowercase letter at all. In both cases, we can say that uppercase letters are less than lowercase letters. If, however, we receive a handle that starts with a lowercase letter, we can similarly conclude that lowercase letters are less than uppercase letters.</p><p>Now, having spent one query, we have determined the relative order of the letters and can proceed to search for the desired handle using binary search.</p><p>To do this, let's maintain a semi-interval of the list <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-136\"><span class=\"MJXp-mo\" id=\"MJXp-Span-137\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-138\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-139\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-140\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-141\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">[l, r)</script>, about which we know that the handle <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-142\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-143\">h</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">h</script> is definitely located within it (in other words, we know that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-144\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-145\"><span class=\"MJXp-mi\" id=\"MJXp-Span-146\">h</span><span class=\"MJXp-mi\" id=\"MJXp-Span-147\">a</span><span class=\"MJXp-mi\" id=\"MJXp-Span-148\">n</span><span class=\"MJXp-mi\" id=\"MJXp-Span-149\">d</span><span class=\"MJXp-mi\" id=\"MJXp-Span-150\">l</span><span class=\"MJXp-mi\" id=\"MJXp-Span-151\">e</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-152\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-153\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-154\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-155\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-156\">h</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">\\mathrm{handle}[l] \\le h</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-157\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-158\">h</span><span class=\"MJXp-mo\" id=\"MJXp-Span-159\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-160\"><span class=\"MJXp-mi\" id=\"MJXp-Span-161\">h</span><span class=\"MJXp-mi\" id=\"MJXp-Span-162\">a</span><span class=\"MJXp-mi\" id=\"MJXp-Span-163\">n</span><span class=\"MJXp-mi\" id=\"MJXp-Span-164\">d</span><span class=\"MJXp-mi\" id=\"MJXp-Span-165\">l</span><span class=\"MJXp-mi\" id=\"MJXp-Span-166\">e</span><span class=\"MJXp-mo\" id=\"MJXp-Span-167\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi\" id=\"MJXp-Span-168\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-169\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">h < \\mathrm{handle[r]}</script>).</p><p>Initially, we start with the entire list <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-170\"><span class=\"MJXp-mo\" id=\"MJXp-Span-171\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-172\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-173\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-174\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-175\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-176\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-177\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">[1, n + 1)</script>. Now, as long as the length of the semi-interval <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-178\"><span class=\"MJXp-mo\" id=\"MJXp-Span-179\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-180\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-181\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-182\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-183\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-32\">[l, r)</script> is greater than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-184\"><span class=\"MJXp-mn\" id=\"MJXp-Span-185\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">1</script>, we still do not know exactly where our handle is located. Therefore, let's choose the midpoint of this interval <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-186\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-187\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-188\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mfrac\" id=\"MJXp-Span-189\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-190\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-191\">−</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-192\">l</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-193\">2</span></span></span></span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-34\">m = \\frac{r - l}{2}</script> and make a query at position <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-194\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-195\">m</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-35\">m</script>. If <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-196\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-197\"><span class=\"MJXp-mi\" id=\"MJXp-Span-198\">h</span><span class=\"MJXp-mi\" id=\"MJXp-Span-199\">a</span><span class=\"MJXp-mi\" id=\"MJXp-Span-200\">n</span><span class=\"MJXp-mi\" id=\"MJXp-Span-201\">d</span><span class=\"MJXp-mi\" id=\"MJXp-Span-202\">l</span><span class=\"MJXp-mi\" id=\"MJXp-Span-203\">e</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-204\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-205\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-206\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-207\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-208\">h</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-36\">\\mathrm{handle}[m] \\le h</script>, we can definitively say that our handle lies in the semi-interval <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-209\"><span class=\"MJXp-mo\" id=\"MJXp-Span-210\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-211\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-212\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-213\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-214\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-37\">[m, r)</script>. Otherwise, if <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-215\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-216\">h</span><span class=\"MJXp-mo\" id=\"MJXp-Span-217\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-218\"><span class=\"MJXp-mi\" id=\"MJXp-Span-219\">h</span><span class=\"MJXp-mi\" id=\"MJXp-Span-220\">a</span><span class=\"MJXp-mi\" id=\"MJXp-Span-221\">n</span><span class=\"MJXp-mi\" id=\"MJXp-Span-222\">d</span><span class=\"MJXp-mi\" id=\"MJXp-Span-223\">l</span><span class=\"MJXp-mi\" id=\"MJXp-Span-224\">e</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-225\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-226\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-227\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">h < \\mathrm{handle}[m]</script>, then the handle lies in the interval <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-228\"><span class=\"MJXp-mo\" id=\"MJXp-Span-229\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-230\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-231\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-232\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-233\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\">[l, m)</script>.</p><p>As soon as the length of the segment becomes <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-234\"><span class=\"MJXp-mn\" id=\"MJXp-Span-235\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">1</script>, we will know the exact position of the handle.</p><p>Since after each query the length of the semi-interval <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-236\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-237\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">n</script> becomes <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-238\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-239\"><span class=\"MJXp-mo\" id=\"MJXp-Span-240\" style=\"margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;\"><span class=\"MJXp-right MJXp-scale5\" style=\"font-size: 3em; margin-left: -0.18em;\">⌈</span></span><span class=\"MJXp-mfrac\" id=\"MJXp-Span-241\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-242\">n</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-243\">2</span></span></span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-244\" style=\"margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;\"><span class=\"MJXp-right MJXp-scale5\" style=\"font-size: 3em; margin-left: -0.18em;\">⌉</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\left\\lceil \\frac{n}{2} \\right\\rceil</script> in the worst case, we will need no more than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-245\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-246\"><span class=\"MJXp-mo\" id=\"MJXp-Span-247\" style=\"margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;\"><span class=\"MJXp-right MJXp-scale7\" style=\"font-size: 1.978em; margin-left: -0.08em;\">⌈</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-248\"><span class=\"MJXp-mi\" id=\"MJXp-Span-249\" style=\"margin-right: 0.05em;\">log</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-250\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-251\" style=\"margin-left: 0em; margin-right: 0em;\"></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-252\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-253\">n</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-254\" style=\"margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;\"><span class=\"MJXp-right MJXp-scale7\" style=\"font-size: 1.978em; margin-left: -0.08em;\">⌉</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\">\\left\\lceil \\log_2{n} \\right\\rceil</script> queries to reduce the segment to a length of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-255\"><span class=\"MJXp-mn\" id=\"MJXp-Span-256\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">1</script>.</p><p>To compare the responses to queries with the handle <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-257\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-258\">h</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">h</script>, it is convenient to write a special function that compares them, taking into account whether lowercase letters come before uppercase letters or vice versa.</p><p>P.S.: Binary search can also be written in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-259\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-260\"><span class=\"MJXp-mo\" id=\"MJXp-Span-261\" style=\"margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;\"><span class=\"MJXp-right MJXp-scale7\" style=\"font-size: 1.978em; margin-left: -0.08em;\">⌊</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-262\"><span class=\"MJXp-mi\" id=\"MJXp-Span-263\" style=\"margin-right: 0.05em;\">log</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-264\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-265\" style=\"margin-left: 0em; margin-right: 0em;\"></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-266\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-267\">n</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-268\" style=\"margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;\"><span class=\"MJXp-right MJXp-scale7\" style=\"font-size: 1.978em; margin-left: -0.08em;\">⌋</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-46\">\\left\\lfloor \\log_2{n} \\right\\rfloor</script>, but this was not required in the problem.</p></div></div></div></div>"
}